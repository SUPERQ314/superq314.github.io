<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>函数式编程</title>
      <link href="/posts/1690d21b/"/>
      <url>/posts/1690d21b/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>1、命令式编程  &#x3D;&gt;  2、面向对象编程  &#x3D;&gt;  3、函数式编程<br>考虑一个小功能：将数组最后一个元素大写，假设 log, head，reverse，toUpperCase 函数存在（我们通过 curry 可以很容易写出来）</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">命令式写法</button></li><li class="tab"><button type="button" data-href="#super-2">面向对象写法</button></li><li class="tab"><button type="button" data-href="#super-3">函数式组合——compose</button></li><li class="tab"><button type="button" data-href="#super-4">函数式组合——pipe</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><code>log(toUpperCase(head(reverse(arr))))</code></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">arr.<span class="title function_">reverse</span>()</span><br><span class="line">  .<span class="title function_">head</span>()</span><br><span class="line">  .<span class="title function_">toUpperCase</span>()</span><br><span class="line">  .<span class="title function_">log</span>()</span><br></pre></td></tr></table></figure><p>链式调用看起来顺眼多了，然而问题在于，原型链上可供我们链式调用的函数是有限的，而需求是无限的 ，这限制了我们的逻辑表现力。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p><code>const upperLastItem = compose(log, toUpperCase, head, reverse);</code><br>通过参数我们可以很清晰的看出发生了 uppderLastItem 做了什么，它完成了一套流水线，所有经过这条流水线的参数都会经历：reverse -&gt; head -&gt; toUpperCase-&gt; log 这些函数的加工，最后生成结果。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>很多函数库（Lodash，Ramda）中也提供了另一种组合方式：pipe（从左往右的组合）<br><code>const upperLastItem = R.pipe(reverse, head, toUppderCase, log);</code></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>对于箭头函数在函数式编程里面有一个高大上的名字，叫 lambda 表达式，对于这种匿名函数在学术上就是叫 lambda 表达式。</p><p>函数式编程</p><p>思维：着眼点是 <strong>函数</strong> ，而不是 <strong>过程</strong> ，强调的是如何通过函数的组合变换去解决问题，而不是通过写什么样的语句去解决问题。</p><p>函数式编程的目的</p><p>使用函数来 <strong>抽象作用在数据之上的控制流和操作</strong> ，从而在系统中<strong>消除副作用</strong>并<strong>减少对状态的改变。</strong></p><p>函数式编程的特点</p><ol><li>函数是“一等公民”</li></ol><blockquote><p>这是函数式编程得以实现的 <strong>前提</strong> ，因为我们基本的操作都是在操作函数。这个特性意味着函数与其他数据类型一样，处于平等地位，可以赋值给其他变量，也可以作为参数，传入另一个函数，或者作为别的函数的返回值。</p></blockquote><p>例如：<code>const convert2Obj = compose(genObj(&#39;name&#39;), capitalizeName)</code></p><ol start="2"><li>声明式编程</li></ol><blockquote><p>函数式编程大多时候都是在声明我需要做什么，而非怎么去做。这种编程风格称为 <a href="https://zh.wikipedia.org/zh-cn/%E5%AE%A3%E5%91%8A%E5%BC%8F%E7%B7%A8%E7%A8%8B%EF%BC%9Foldformat=true">声明式编程</a> 。这样有个好处是代码的可读性特别高，因为声明式代码大多都是接近自然语言的，同时，它解放了大量的人力，因为它不关心具体的实现，因此它可以把优化能力交给具体的实现，这也方便我们进行分工协作。</p></blockquote><p>React 是声明式的，只要描述你的 UI，接下来状态变化后 UI 如何更新，是 React 在运行时帮你处理的，而不是靠你自己去渲染和优化 diff 算法。</p><ol start="3"><li>惰性执行</li></ol><blockquote><p>所谓惰性执行指的是函数只在需要的时候执行，即不产生无意义的中间变量。像刚才的例子，函数式编程跟命令式编程最大的区别就在于几乎没有中间变量，它从头到尾都在写函数，只有在最后的时候才通过调用 <strong>convertName</strong> 产生实际的结果。</p></blockquote><ol start="4"><li>无状态和数据不可变</li></ol><p>这是函数式编程的核心概念：</p><p>· <strong>数据不可变：</strong> 它要求你所有的数据都是不可变的，这意味着如果你想修改一个对象，那你应该创建一个新的对象用来修改，而不是修改已有的对象。</p><p>· <strong>无状态：</strong> 主要是强调对于一个函数，不管你何时运行，它都应该像第一次运行一样，给定相同的输入，给出相同的输出，完全不依赖外部状态的变化。</p><p>为了实现这个目标，函数式编程提出函数应该具备的特性：没有副作用和纯函数。<br><img src="/image/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/1665327567706.png" alt="1665327567706"></p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">没有副作用（No Side Effects）</button></li><li class="tab"><button type="button" data-href="#super-2">纯函数 (pure functions)</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>副作用这个词我们可算听的不少，它的含义是：在完成函数主要功能之外完成的其他副要功能。在我们函数中最主要的功能当然是根据输入 <strong>返回结果</strong> ，而在函数中我们最常见的副作用就是 <strong>随意操纵外部变量</strong> 。由于 JS 中对象传递的是引用地址，哪怕我们用 <strong>const</strong> 关键词声明对象，它依旧是可以变的。而正是这个“漏洞”让我们有机会随意修改对象。</p><p>例如： <strong>map</strong> 函数的本来功能是将输入的数组根据一个函数转换，生成一个新的数组：</p><p><strong>map :: [a] -&gt; [b]</strong></p><p>而在 JS 中，我们经常可以看到下面这种对 <strong>map</strong> 的 “错误” 用法，把 <strong>map</strong> 当作一个循环语句，然后去直接修改数组中的值。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> list = [...];</span><br><span class="line"><span class="comment">// 修改 list 中的 type 和 age</span></span><br><span class="line">list.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    item.<span class="property">type</span> = <span class="number">1</span>;</span><br><span class="line">    item.<span class="property">age</span>++;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>这样函数最主要的输出功能没有了，变成了直接修改了外部变量，这就是它的副作用。而没有副作用的写法应该是：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> list = [...];</span><br><span class="line"><span class="comment">// 修改 list 中的 type 和 age</span></span><br><span class="line"><span class="keyword">const</span> newList = list.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> (&#123;...item, <span class="attr">type</span>: <span class="number">1</span>, <span class="attr">age</span>:item.<span class="property">age</span> + <span class="number">1</span>&#125;));</span><br></pre></td></tr></table></figure><p>保证函数没有副作用，一来能保证数据的不可变性，二来能避免很多因为共享状态带来的问题。当你一个人维护代码时候可能还不明显，但随着项目的迭代，项目参与人数增加，大家对同一变量的依赖和引用越来越多，这种问题会越来越严重。最终可能连维护者自己都不清楚变量到底是在哪里被改变而产生 Bug。</p><p>传递引用一时爽，代码重构火葬场</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>纯函数算是在“没有副作用” 的要求上再进一步了。</p><p>其实纯函数的概念很简单就是两点：</p><ol><li>不依赖外部状态（无状态）：** 函数的的运行结果不依赖全局变量，this 指针，IO 操作等。</li><li>没有副作用（数据不变）：** 不修改全局变量，不修改入参。</li></ol><p>所以纯函数才是真正意义上的“函数”， 它意味着 <strong>相同的输入，永远会得到相同的输出</strong> 。</p><p>以下几个函数都是不纯的，因为他们都依赖外部变量，试想一下，如果有人调用了 <strong>changeName</strong> 对 <strong>curUser</strong> 进行了修改，然后你在另外的地方调用了 <strong>saySth</strong> ，这样就会产生你预料之外的结果。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> curUser = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Peter&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">saySth</span> = str =&gt; curUser.<span class="property">name</span> + <span class="string">&#x27;: &#x27;</span> + str;   <span class="comment">// 引用了全局变量</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">changeName</span> = (<span class="params">obj, name</span>) =&gt; obj.<span class="property">name</span> = name;  <span class="comment">// 修改了输入参数</span></span><br><span class="line"><span class="title function_">changeName</span>(curUser, <span class="string">&#x27;Jay&#x27;</span>);  <span class="comment">// &#123; name: &#x27;Jay&#x27; &#125;</span></span><br><span class="line"><span class="title function_">saySth</span>(<span class="string">&#x27;hello!&#x27;</span>); <span class="comment">// Jay: hello!</span></span><br></pre></td></tr></table></figure><p>如果改成纯函数的写法会是怎么样呢？</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> curUser = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Peter&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">saySth</span> = (<span class="params">user, str</span>) =&gt; user.<span class="property">name</span> + <span class="string">&#x27;: &#x27;</span> + str;   <span class="comment">// 不依赖外部变量</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">changeName</span> = (<span class="params">user, name</span>) =&gt; (&#123;...user, name &#125;);  <span class="comment">// 未修改外部变量 </span></span><br><span class="line"><span class="keyword">const</span> newUser = <span class="title function_">changeName</span>(curUser, <span class="string">&#x27;Jay&#x27;</span>);  <span class="comment">// &#123; name: &#x27;Jay&#x27; &#125;</span></span><br><span class="line"><span class="title function_">saySth</span>(curUser, <span class="string">&#x27;hello!&#x27;</span>); <span class="comment">// Peter: hello!</span></span><br></pre></td></tr></table></figure><p>这样就没有之前说的那些问题了。</p><p>我们这么强调使用纯函数，纯函数的意义是什么？</p><ol><li>便于测试和优化：这个意义在实际项目开发中意义非常大，由于纯函数对于相同的输入永远会返回相同的结果，因此我们可以轻松断言函数的执行结果，同时也可以保证函数的优化不会影响其他代码的执行。这十分符合<strong>测试驱动开发</strong> TDD****的思想，这样产生的代码往往健壮性更强。</li><li>可缓存性：因为相同的输入总是可以返回相同的输出，因此，我们可以提前缓存函数的执行结果，有很多库有所谓的 <strong>memoize</strong> 函数，下面以一个简化版的 <strong>memoize</strong> 为例，这个函数就能缓存函数的结果，对于像 <strong>fibonacci</strong> 这种计算，就可以起到很好的缓存效果。</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">memoize</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> cache = &#123;&#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> key = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="variable language_">arguments</span>);</span><br><span class="line">        <span class="keyword">var</span> value = cache[key];</span><br><span class="line">        <span class="keyword">if</span>(!value) &#123;</span><br><span class="line">            value = [fn.<span class="title function_">apply</span>(<span class="literal">null</span>, <span class="variable language_">arguments</span>)];  <span class="comment">// 放在一个数组中，方便应对 undefined，null 等异常情况</span></span><br><span class="line">            cache[key] = value;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> value[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> fibonacci = <span class="title function_">memoize</span>(<span class="function"><span class="params">n</span> =&gt;</span> n &lt; <span class="number">2</span> ? <span class="attr">n</span>: <span class="title function_">fibonacci</span>(n - <span class="number">1</span>) + <span class="title function_">fibonacci</span>(n - <span class="number">2</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">fibonacci</span>(<span class="number">4</span>))  <span class="comment">// 执行后缓存了 fibonacci(2), fibonacci(3),  fibonacci(4)</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">fibonacci</span>(<span class="number">10</span>)) <span class="comment">// fibonacci(2), fibonacci(3),  fibonacci(4) 的结果直接从缓存中取出，同时缓存其他的</span></span><br></pre></td></tr></table></figure><ol start="3"><li>自文档化：由于纯函数没有副作用，所以其依赖很明确，因此更易于观察和理解（配合后面介绍的 [类型签名](#hindly-milner 类型签名）更佳)。</li><li>更少的Bug：使用纯函数意味着你的函数中 不存在指向不明的 this，不存在对全局变量的引用，不存在对参数的修改，这些共享状态往往是绝大多数 bug 的源头。</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>JS中$含义及用法</title>
      <link href="/posts/51b050d3/"/>
      <url>/posts/51b050d3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>$在JS中本身只是一个符号而异，在JS里什么也不是。但在JS的应用库jQuery中，将之做为一个自定义函数名了，这个函数是获取指定网页元素的函数。</p><p>在不用JQUERY的情况，一般会自定义一个$函数。即：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">$</span>(<span class="params">Nid</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="title class_">Nid</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以后不用每次使用document.getElementById(“ID名”)来获取元素，只用$(‘ID名’)即可。</p><p>三种具体用法：</p><ol><li>$()可以是$(expresion)</li></ol><blockquote><p>即css选择器、Xpath或html元素，也就是通过上述表达式来匹配目标元素。<br>比如：$(“a”)构造的这个对象，是用CSS选择器构建了一个jQuery对象——它选择了所有的<code>&lt;a/&gt;</code>这个标签。</p></blockquote><p>如：<code>$(&quot;a&quot;).click(function()&#123;...&#125;)</code><br>就是在点击页面上的任何一个链接时的触发事件。确切地说，就是jQuery用<a/>这个标签构建了一个对象$(“a”)，函数 click()是这个jQuery对象的一个（事件）方法。<br>比如有这样一段HTML代码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>one<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>two<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>three<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> <span class="attr">id</span>=<span class="string">&quot;test&quot;</span> <span class="attr">onClick</span>=<span class="string">&quot;jq()&quot;</span> &gt;</span>jQuery<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>而操作这段HTML的是如下一条语句：<br><code>alert($(&quot;div&gt;p&quot;).html());</code></p><p>$()中的是一个查询表达式，也就是用“div&gt;p”这样一个查询表达式构建了一个jQuery对象，然后的“html()”意思是显示其html内容，也就是上面HTML代码段的[two]。<br>再如： $(“<code>&lt;div&gt;&lt;p&gt;</code>Hello<code>&lt;/p&gt;&lt;/div&gt;</code>“).appendTo(“body”);<br>$()中的是一个字符串，用这样一段字串构建了jQuery对象，然后向<body/>中添加这一字串。  </p><ol start="2"><li>$()可以是$(element)<blockquote><p>即一个特定的DOM元素。如常用的DOM对象有document、location、form等。<br>如这样一行代码： <code>$(document).find(&quot;div&gt;p&quot;).html());</code></p></blockquote></li></ol><p>$()中的document是一个DOM元素，即在全文寻找带<code>&lt;p&gt;</code>的<code>&lt;div&gt;</code>元素，并显示<code>&lt;p&gt;</code>中的内容。 </p><ol start="3"><li>$()可以是$(function)<blockquote><p>即一个函数，它是$(document).ready()的一个速记方式。如常见的形式是这样的：<br><code>$(document).ready(function()&#123; alert(&quot;Hello world!&quot;); &#125;);</code></p></blockquote></li></ol><p>可变形作：<br><code>$(function()&#123; alert(&quot;Hello world!&quot;); &#125;);</code></p><p>对于选择HTML文档中的elements，jQuery有两种方法：<br>1）如$(“div&gt;ul a”)，它的意思是div标签中的ul标签中的a标签<br>2）用jQuery对象的几个方法（如方法find()、each()等） $(“#orderedlist).find(“li”) 就像 $(“#orderedlist li”). each()一样迭代了所有的li，而表达式中的“#”表示HTML中的ID，如上例中的“#orderedlist”就表示“ID为orderedlist所在的标签”。  **************************************************************** </p><p>2、XPath选择器 如：选择所有带有title 属性的链接，我们会这样写：$(‘a[@title]’)<br>[]里带@，说明[]里的是元素的属性；是个属性选择器<br>[]里没@，说明[]里的是元素的子孙。<br>在XPath中，要找一个“以…开头”的属性，用^&#x3D;，如找一个name属性是以mail开头的input元素，就用<br>$(‘input[@name^&#x3D;”mail”]’)<br>要找一个“以…结尾”的属性，要用$&#x3D; 要找一个“不头不尾”的属性，用*&#x3D;  </p><p>3、不属于上述的CSS和XPath的选择器，就是自定义的选择器了，用“:”表示，这里要用的就是:first，:last，:parent ，:hidden，:visible，:odd，:even，:not(‘xxx’)， “:eq(0)”（始于0)，:nth(n），:gt(0)，:lt(0)，:contains(“xxx”) 如：$(‘tr:not([th]):even’)意为<tr>元素的子孙中不含<th>的所有子孙的偶数项 </p><p>5、要直接访问DOM元素，可用get(0)的方法，如<br>$(‘#myelement’).get(0)<br>也可缩写成<br>$(‘#myelement’)[0]</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>lodash高阶函数</title>
      <link href="/posts/c123e559/"/>
      <url>/posts/c123e559/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="lodash-高阶函数"><a href="#lodash-高阶函数" class="headerlink" title="lodash 高阶函数"></a>lodash 高阶函数</h2><p>lodash 大家肯定不陌生，它是最流行的 JavaScript 库之一，透过函数式编程模式为开发者提供常用的函数。</p><p>其中有一些封装的高阶函数，让一些平平无奇的普通函数也能有相应的高阶功能。</p><p>举几个例子：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 防抖动</span></span><br><span class="line">_.<span class="title function_">debounce</span>(func, [wait=<span class="number">0</span>], [options=&#123;&#125;])</span><br><span class="line"></span><br><span class="line"><span class="comment">// 节流</span></span><br><span class="line">_.<span class="title function_">throttle</span>(func, [wait=<span class="number">0</span>], [options=&#123;&#125;])</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将一个断言函数结果取反</span></span><br><span class="line">_.<span class="title function_">negate</span>(predicate)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 柯里化函数</span></span><br><span class="line">_.<span class="title function_">curry</span>(func, [arity=func.<span class="property">length</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">// 部分应用</span></span><br><span class="line">_.<span class="title function_">partial</span>(func, [partials])</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回一个带记忆的函数</span></span><br><span class="line">_.<span class="title function_">memoize</span>(func, [resolver])</span><br><span class="line"></span><br><span class="line"><span class="comment">// 包装函数</span></span><br><span class="line">_.<span class="title function_">wrap</span>(value, [wrapper=identity])</span><br></pre></td></tr></table></figure><p>研究源码你就会发现，_.debounce 防抖、_.throttle 节流上面说过，_.curry 柯里化上面说过、_.partial 在“缓存传参”里说过、_.memoize 在“缓存计算”里也说过……</p><p>再举一个例子：</p><p>现在要求一个函数在达到 n 次之前，每次都正常执行，第 n 次不执行。</p><p>也是非常常见的业务场景！JavaScript 实现：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">before</span>(<span class="params">n, func</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> result,</span><br><span class="line">    count = n;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">...args</span>) &#123;</span><br><span class="line">        count = count - <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> (count &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            result = func.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (count &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            func = <span class="literal">undefined</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> fn= <span class="title function_">before</span>(<span class="number">3</span>,<span class="function">(<span class="params">x</span>)=&gt;</span><span class="variable language_">console</span>.<span class="title function_">log</span>(x))</span><br><span class="line"><span class="title function_">fn</span>(<span class="number">1</span>) <span class="comment">// 1</span></span><br><span class="line"><span class="title function_">fn</span>(<span class="number">2</span>) <span class="comment">// 2</span></span><br><span class="line"><span class="title function_">fn</span>(<span class="number">3</span>) <span class="comment">// 不执行</span></span><br></pre></td></tr></table></figure><p>反过来：函数只有到 n 次的时候才执行，n 之前的都不执行。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">after</span>(<span class="params">n, func</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> count = n || <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">...args</span>) &#123;</span><br><span class="line">        count = count - <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> (count &lt; <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> func.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> fn= <span class="title function_">after</span>(<span class="number">3</span>,<span class="function">(<span class="params">x</span>)=&gt;</span><span class="variable language_">console</span>.<span class="title function_">log</span>(x))</span><br><span class="line"><span class="title function_">fn</span>(<span class="number">1</span>) <span class="comment">// 不执行</span></span><br><span class="line"><span class="title function_">fn</span>(<span class="number">2</span>) <span class="comment">// 不执行</span></span><br><span class="line"><span class="title function_">fn</span>(<span class="number">3</span>) <span class="comment">// 3</span></span><br></pre></td></tr></table></figure><p>全是“闭包”、全是把参数“柯里化”。</p><p>细细体会，在控制台上敲一敲、改一改、跑一跑，下次或许你就可以自己写出这些有特定功能的高阶函数了。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>一道前端JS面试题</title>
      <link href="/posts/481a45e8/"/>
      <url>/posts/481a45e8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    getName = <span class="keyword">function</span> (<span class="params"></span>) &#123; alert (<span class="number">1</span>); &#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Foo</span>.<span class="property">getName</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123; alert (<span class="number">2</span>);&#125;;</span><br><span class="line"><span class="title class_">Foo</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getName</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123; alert (<span class="number">3</span>);&#125;</span><br><span class="line"><span class="keyword">var</span> getName = <span class="keyword">function</span> (<span class="params"></span>) &#123; alert (<span class="number">4</span>);&#125;;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getName</span>(<span class="params"></span>) &#123; alert (<span class="number">5</span>);&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 答案：</span></span><br><span class="line"><span class="title class_">Foo</span>.<span class="title function_">getName</span>();              <span class="comment">// 2</span></span><br><span class="line"><span class="title function_">getName</span>();                  <span class="comment">// 4</span></span><br><span class="line"><span class="title class_">Foo</span>().<span class="title function_">getName</span>();            <span class="comment">// 1</span></span><br><span class="line"><span class="title function_">getName</span>();                  <span class="comment">// 1</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Foo</span>.<span class="title function_">getName</span>();          <span class="comment">// 2</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Foo</span>().<span class="title function_">getName</span>();        <span class="comment">// 3</span></span><br><span class="line"><span class="keyword">new</span> <span class="keyword">new</span> <span class="title class_">Foo</span>().<span class="title function_">getName</span>();    <span class="comment">// 3</span></span><br></pre></td></tr></table></figure><p>此题涉及的知识点众多，包括变量定义提升、this指针指向、运算符优先级、原型、继承、全局变量污染、对象属性及原型属性优先级等等。</p><p>此题包含7小问，分别说下。</p><h2 id="第一问"><a href="#第一问" class="headerlink" title="第一问"></a>第一问</h2><p>代码部分，</p><p>首先定义了一个叫Foo的函数，<br>之后为Foo创建了一个叫getName的<strong>静态属性</strong>存储了一个匿名函数，<br>之后为Foo的<strong>原型对象</strong>新创建了一个叫getName的匿名函数。<br>之后又通过<strong>函数变量表达式</strong>创建了一个getName的函数，<br>最后再<strong>声明</strong>一个叫getName函数。</p><p>第一问的 Foo.getName 自然是访问Foo函数上存储的静态属性，自然是2。</p><h2 id="第二问"><a href="#第二问" class="headerlink" title="第二问"></a>第二问</h2><p>第二问，直接调用 getName 函数。既然是直接调用那么就是访问当前上文作用域内的叫getName的函数，所以跟1 2 3都没什么关系。</p><p>此处有两个坑，一是变量声明提升，二是函数表达式。</p><h3 id="变量声明提升"><a href="#变量声明提升" class="headerlink" title="变量声明提升"></a>变量声明提升</h3><p>即所有声明变量或声明函数都会被提升到当前函数的顶部。</p><h3 id="函数表达式"><a href="#函数表达式" class="headerlink" title="函数表达式"></a>函数表达式</h3><p> var getName 与 function getName 都是声明语句，区别在于 vargetName 是 <strong>函数表达式</strong> ，而 function getName 是 <strong>函数声明</strong> 。关于JS中的各种函数创建方式可以看 <a href="http://www.cnblogs.com/xxcanghai/p/4991870.html">大部分人都会做错的经典<strong>JS</strong>闭包面试题</a> 这篇文章有详细说明。</p><p>函数表达式最大的问题，在于js会将此代码拆分为两行代码分别执行。</p><p>原题中代码最终执行时的是：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    getName = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        alert (<span class="number">1</span>); </span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> getName;<span class="comment">//只提升变量声明</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//提升函数声明，覆盖var的声明</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getName</span>(<span class="params"></span>) &#123;</span><br><span class="line">    alert (<span class="number">5</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Foo</span>.<span class="property">getName</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123; alert (<span class="number">2</span>);&#125;;</span><br><span class="line"><span class="title class_">Foo</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getName</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123; alert (<span class="number">3</span>);&#125;;</span><br><span class="line">getName = <span class="keyword">function</span> (<span class="params"></span>) &#123; alert (<span class="number">4</span>);&#125;;<span class="comment">//最终的赋值再次覆盖function getName声明</span></span><br><span class="line"><span class="title function_">getName</span>();<span class="comment">//最终输出4</span></span><br></pre></td></tr></table></figure><h2 id="第三问"><a href="#第三问" class="headerlink" title="第三问"></a>第三问</h2><p>第三问的 Foo().getName(); 先执行了Foo函数，然后调用Foo函数的返回值对象的getName属性函数。</p><p>Foo函数的第一句  getName &#x3D; function () { alert (1); };  是一句函数赋值语句，注意它没有var声明，所以先向当前Foo函数作用域内寻找getName变量，没有。再向当前函数作用域上层，即外层作用域内寻找是否含有getName变量，找到了，也就是第二问中的alert(4)函数，将此变量的值赋值为 function(){alert(1)}。</p><p><strong>此处实际上是将外层作用域内的</strong>getName<strong>函数修改了。</strong></p><p>注意：此处若依然没有找到会一直向上查找到window对象，若window对象中也没有getName属性，就在window对象中创建一个getName变量。</p><p>之后Foo函数的返回值是this。</p><p><strong>简单</strong>的讲， <strong>this的指向是由所在函数的调用方式决定的</strong> 。而此处的直接调用方式，this指向window对象。</p><p>遂Foo函数返回的是window对象，相当于执行 window.getName() ，而window中的getName已经被修改为alert(1)，所以最终会输出1</p><p>此处考察了两个知识点，一个是变量作用域问题，一个是this指向问题。</p><h2 id="第四问"><a href="#第四问" class="headerlink" title="第四问"></a>第四问</h2><p>直接调用getName函数，相当于 window.getName() ，因为这个变量已经被Foo函数执行时修改了，遂结果与第三问相同，为1</p><h2 id="第五问"><a href="#第五问" class="headerlink" title="第五问"></a>第五问</h2><p>第五问 new Foo.getName(); ,此处考察的是js的运算符优先级问题。</p><p><strong>js运算符优先级:</strong></p><p><img src="file:///C:\Users\ADMINI~1\AppData\Local\Temp\ksohtml10956\wps1.jpg"></p><p>通过查上表可以得知点（.）的优先级高于new操作，遂相当于是:</p><p>new (Foo.getName)();</p><p>所以实际上将getName函数作为了构造函数来执行，遂弹出2。</p><h2 id="第六问"><a href="#第六问" class="headerlink" title="第六问"></a>第六问</h2><p>第六问 new Foo().getName() ，首先看运算符优先级括号高于new，实际执行为</p><p>(new Foo()).getName()</p><p>遂先执行Foo函数，而Foo此时作为构造函数却有返回值，所以这里需要说明下js中的构造函数返回值问题。</p><h3 id="构造函数的返回值"><a href="#构造函数的返回值" class="headerlink" title="构造函数的返回值"></a>构造函数的返回值</h3><p>在传统语言中，构造函数不应该有返回值，实际执行的返回值就是此构造函数的实例化对象。</p><p>而在js中构造函数可以有返回值也可以没有。</p><p>1、没有返回值则按照其他语言一样返回实例化对象。</p><p><img src="file:///C:\Users\ADMINI~1\AppData\Local\Temp\ksohtml10956\wps2.jpg"></p><p>2、若有返回值则检查其返回值是否为 <strong>引用类型</strong> 。如果是非引用类型，如基本类型（string,number,boolean,null,undefined）则与无返回值相同，实际返回其实例化对象。</p><p><img src="file:///C:\Users\ADMINI~1\AppData\Local\Temp\ksohtml10956\wps3.jpg"></p><p>3、若返回值是引用类型，则实际返回值为这个引用类型。</p><p><img src="file:///C:\Users\ADMINI~1\AppData\Local\Temp\ksohtml10956\wps4.jpg"></p><p>原题中，返回的是this，而this在构造函数中本来就代表当前实例化对象，遂最终Foo函数返回实例化对象。</p><p>之后调用实例化对象的getName函数，因为在Foo构造函数中没有为实例化对象添加任何属性，遂到当前对象的原型对象（prototype）中寻找getName，找到了。</p><p>遂最终输出3。</p><h2 id="第七问"><a href="#第七问" class="headerlink" title="第七问"></a>第七问</h2><p>第七问, new new Foo().getName(); 同样是运算符优先级问题。</p><p>最终实际执行为：</p><p>new ((new Foo()).getName)();</p><p>先初始化Foo的实例化对象，然后将其原型上的getName函数作为构造函数再次new。</p><p>遂最终结果为3</p><p>这里确实是(new Foo()).getName()，但是跟括号优先级高于成员访问没关系，实际上这里成员访问的优先级是最高的，因此先执行了 .getName，但是在进行左侧取值的时候， new Foo() 可以理解为两种运算：new 带参数（即 new Foo()）和函数调用（即 先 Foo() 取值之后再 new），而 new 带参数的优先级是高于函数调用的，因此先执行了 new Foo()，或得 Foo 类的实例对象，再进行了成员访问 .getName。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>网页设计</title>
      <link href="/posts/81984e4e/"/>
      <url>/posts/81984e4e/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>合格的网页应该包含</p><p>页面分为页头、菜单导航栏（可下拉）、中间内容板块、页脚四大部分；</p><p>所有页面相互超链接，可到三级页面，有5-10个页面组成；</p><p>页面样式风格统一布局显示正常，不错乱，使用div+css技术；</p><p>菜单美观、醒目，二级菜单可正常弹出与跳转；</p><p>要有JS特效，如定时切换和手动切换图片新闻；</p><p>页面中有多媒体元素，如gif、视频、音乐，表单技术的使用；</p><p>这个网页是模仿淘宝、京东等购物商场的布局，加上在本学期所学的内容，制作了七个关于“零食巴士”主题的页面，并将其定义为一个零食销售的购物网站。</p><p>index.html 是网站的首页，内置的链接有buycar.html、regist.html、login.html、product.html、personcenter.html 几乎能访问到所有的链接网页。</p><p>网页中head与footer可以通用到其他页面，节省了其他页面的编写时间。</p><p>product.html 是商品的详细页，中间为商品的详细信息介绍。</p><p>buycar.html 是购物车的界面，中间绘制了一张表格完成了购物商城的购物车。</p><p>login.html 是登录页面。</p><p>regist.html 是注册页面。</p><p>personcenter.html 是个人中心页面，中间为购买商品的一些情况。</p><p>information.html 是个人信息页面，中间为用户的个人信息。</p><p>food.html 美食的列表，第二个模板块。</p><p>Newidea.html 创意构想，第三个模板块</p><p>主要技术实现：</p><p>网页采用了纯html+css+jquery，在完成网页的过程中，顺便补充了jquery方面的知识，方便自己编写动画特效，发现相对于js，jquery封装之后的使用的确方便了许多，许多方面本来应该十分繁复的地方，jquery封装之后再进行使用就变得十分的轻便，而且解释起来也十分的方便。</p><p>整体的HTML，采用了网页互通，串成了一个整体。</p><p>CSS样式用的最多的是文字以及布局的一些设置，常常因为一个样式的大小位置调来调去。</p><p>视频演示：web前端大作业 零食商城设计【附完整源码和报告】.MP4</p><p>功能截图：</p><p>1.首页 （ index.html ）</p><p>本页面用了做了页头，中间，和页尾部分。其中包括了类似叮叮书店的js图片轮播技术，使用js技术将定位响应连接了起来，做成了类似多级菜单的效果，还有返回顶部并隐藏top键的js特效，根据老师的建议，不应该直接滑动到顶部而应该缓慢有个过程。</p><p>具体js实现：</p><p>在右边是详细介绍，分为了三个板块：商品属性、商品详情、商品评论。通过定义id以及a href 点击即可到达对应区域。</p><p>#商品详情 添加了网页截图所得到的的图片</p><p>#用户评论</p><p>运用了meter展示所占百分比，通过构建一张类似购物车的table，完成客</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CSS雪碧图</title>
      <link href="/posts/48ac2f57/"/>
      <url>/posts/48ac2f57/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="CSS雪碧"><a href="#CSS雪碧" class="headerlink" title="CSS雪碧"></a>CSS雪碧</h2><p>即 <code>CSS Sprite</code>，也叫 <code>CSS</code>精灵，是一种 <code>CSS</code>图像合并技术，该方法是将小图标和背景图像合并到一张图片上，然后利用 <code>CSS</code>的背景定位来显示需要显示的图片部分。</p><h2 id="实现原理"><a href="#实现原理" class="headerlink" title="实现原理"></a>实现原理</h2><p><code>CSS </code>雪碧的基本原理是把你的网站上用到的一些图片整合到一张单独的图片中，从而减少你的网站的 <code>HTTP </code>请求数量。该图片使用 <code>CSS </code>的 <code>background </code>和 <code>background-position </code>属性渲染，这也就意味着你的标签变得更加复杂了，图片是在 <code>CSS </code>中定义，而非 <code>img</code>标签。</p><ol><li>前期准备下载工具：css sprit（css精灵）<br><img src="/image/CSS%E9%9B%AA%E7%A2%A7%E5%9B%BE/1665064328704.png" alt="1665064328704"><br>百度云链接：<code>http://pan.baidu.com/s/1nuOZDqT</code></li><li>使用方法<br>下载，打开之后。</li><li>首先要切一些图片，不会切的话，移步：《前端ps切图方法，图文详细》</li><li>打开雪碧图，选择图片。<br><img src="/image/CSS%E9%9B%AA%E7%A2%A7%E5%9B%BE/1665064341241.png" alt="1665064341241"></li><li>添加完图片之后，会自动生成代码，需要排列一下图片：<br><img src="/image/CSS%E9%9B%AA%E7%A2%A7%E5%9B%BE/1665064387332.png" alt="1665064387332"><br>注意：排列图片的时候要注意各个图片之间留点空隙，不然使用的时候，会相互覆盖。</li><li>保存图片以及雪碧图css代码<br>保存雪碧图<br><img src="/image/CSS%E9%9B%AA%E7%A2%A7%E5%9B%BE/1665064443713.png" alt="1665064443713"><br>生成的雪碧图：<br><img src="/image/CSS%E9%9B%AA%E7%A2%A7%E5%9B%BE/1665064447657.png" alt="1665064447657"><br>保存雪碧图-css代码（因为软件没有到导出css代码的功能，所以要自己新建一个txt文件，放在雪碧图旁边，以后打开txt就知道图片在雪碧图的位置。）<br><img src="/image/CSS%E9%9B%AA%E7%A2%A7%E5%9B%BE/1665064455368.png" alt="1665064455368"></li></ol><h2 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h2><ul><li>减少加载网页图片时对服务器的请求次数<blockquote><p>可以合并多数背景图片和小图标，方便在任何位置使用，这样不同位置的请求只需要调用一个图片，从而减少对服务器的请求次数，降低服务器压力，同时提高了页面的加载速度，节约服务器的流量。</p></blockquote></li><li>提高页面的加载速度<blockquote><p>sprite 技术的其中一个好处是图片的加载时间(在有许多 sprite 时，单张图片的加载时间)。由所需图片拼成的一张 GIF 图片的尺寸会明显小于所有图片拼合前的大小。单张的 GIF 只有相关的一个色表，而单独分割的每一张 GIF 都有自己的一个色表，这就增加了总体的大小。因此，单独的一张 JPEG 或者 PNG sprite 在大小上非常可能比把一张图分成多张得来的图片总尺寸小。</p></blockquote></li><li>减少鼠标滑过的一些bug<blockquote><p>IE6不会主动预加载鼠标滑过即a:hover中的背景图片，所以，如果使用多张图片，鼠标滑过会出现闪白的现象。使用CSS雪碧，由于一张图片即可，所以不会出现这种现象。</p></blockquote></li></ul><h2 id="缺点："><a href="#缺点：" class="headerlink" title="缺点："></a>缺点：</h2><ul><li>CSS雪碧的最大问题是内存使用<blockquote><p>除非这个雪碧图片是被非常小心的组织，你就会最终使用大量的无用的空白。</p></blockquote></li><li>影响浏览器的缩放功能<blockquote><p>如果一个使用CSS雪碧的页面使用一些浏览器提供的整页缩放功能缩放了，浏览器就需要做一些额外的工作来纠正这些图片边缘的行为——基本上来说，是为了避免雪碧中相邻的图片被“露进来”。这对于小图片没有什么问题，但是对于大图片会是一个性能下降。</p></blockquote></li><li>拼图维护比较麻烦<blockquote><p>拼合这么多图片，需要耐心。同时还要时刻思考如何在使用这个图片是不会产生相互的影响。将又瘦又高的图片和又宽又矮的图片放到一起时，不容易操作。如果要修改雪碧中的一个图片，你就要修改整张图片，这无疑会增大工作量。</p></blockquote></li><li>使CSS的编写变得困难<blockquote><p>如果CSS雪碧足够复杂，则大大增加了CSS的代码量和难度，让维护和修改变得困难起来。</p></blockquote></li><li>CSS 雪碧调用的图片不能被打印<blockquote><p>CSS 雪碧调用的图片不能被打印，除非在@media中特别添加 print声明。</p></blockquote></li><li>错误得使用 Sprites 影响可访问性<blockquote><p>一些刚入门的开发人员会为了节省 HTTP 请求数(这是使用 CSS Sprite 一直强调的好处)而把所有的图片都当背景图片来处理 – 甚至是那些传达重要信息的图片。结果会导致一个缺乏可访问性的网站，也会降低 HTML 中 title 和 alt 的潜在益处。<br>因此，CSS sprite 本身没错，而且也不会引发可访问性问题(事实上，正确得使用会提高可访问性)。但是不分对错得过度使用 sprite 会阻碍具有可访问性和生产率方面的网页建设进程。</p></blockquote></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>co源码分析</title>
      <link href="/posts/b4573e17/"/>
      <url>/posts/b4573e17/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="知识储备"><a href="#知识储备" class="headerlink" title="知识储备"></a>知识储备</h2><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">Generator</button></li><li class="tab"><button type="button" data-href="#super-2">Promise</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><code>generator函数</code>是回调地狱的一种解决方案，跟 <code>promise</code>类似，但是却可以以同步的方式来书写代码，而避免了promise的链式调用。</p><p>它的执行过程在于调用生成器函数（function*）后，会返回一个iterator（迭代）对象，即Generator对象，但是它并不会立刻执行里面的代码。</p><p>它有几个方法，next(), throw()和return()。<br>调用next()方法后，它会找到第一个yield关键字（直到找到程序底部或者return语句），每次程序运行到yield关键字时，程序便会暂停，保存当前环境里面的变量的值，然后可以跳出当前运行环境去执行yield后面的代码，再把结果返回回来。</p><p>返回的结果是一个对象，类似于{value: ‘’, done: false}</p><ul><li>value表示本次yield后面执行之后返回的结果。如果是Promise实例，则是返回resolved后的值。</li><li>done表示迭代器是否执行完毕，若为true，则表示当前生成器函数已经产生了最后输出的值，即生成器函数已经返回。</li></ul><p>下面是一个简单的例子：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> gen = <span class="keyword">function</span>* () &#123;</span><br><span class="line">    <span class="keyword">let</span> index = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(index &lt; <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">yield</span> index++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;All done.&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> g = <span class="title function_">gen</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(g.<span class="property">constructor</span>);     <span class="comment">// output: GeneratorFunction &#123;&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(g.<span class="title function_">next</span>());          <span class="comment">// output: &#123; value: 0, done: false&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(g.<span class="title function_">next</span>());          <span class="comment">// output: &#123; value: 1, done: false&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(g.<span class="title function_">next</span>());          <span class="comment">// output: &#123; value: 2, done: false&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(g.<span class="title function_">next</span>());          <span class="comment">// output: &#123; value: &#x27;All done.&#x27;, done: true&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(g.<span class="title function_">next</span>());          <span class="comment">// output: &#123; value: undefined, done: true&#125;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><code>Promise对象</code>用于一个异步操作的最终完成（或失败）及其结果值的表示(简单点说就是处理异步请求）。</p><p>Promise核心就在于里面状态的变换，是rejected、resolved还是pending，还有就是原型链上的then()方法，它可以传递本次状态转换后返回的值。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="co源码分析"><a href="#co源码分析" class="headerlink" title="co源码分析"></a>co源码分析</h2><p>主要脉络</p><p> <strong>co函数调用后，返回一个Promise实例</strong> 。</p><blockquote><p>co的思想就是将一个传递进来的参数进行合法化，再通过转换成Promise实例返回出去。<br>如果参数fn是generator函数的话，里面还可以自动进行遍历，执行generator函数里面的yield关键字后面的内容，并返回结果，也就是不断地调用fn().next()方法，再通过传递返回的Promise实例resolved后的值，从而达到同步执行generator函数的效果。</p></blockquote><p>注意：<strong>co里面最主要的是要理解Promise实例和Generator对象，它们是co函数里面的程序自动遍历执行的关键</strong> 。</p><p>下面解释一下co模块里面的最重要的两部分，一个是generator函数的自动调用，另外一个是参数的Promise化。</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">co完整源码</button></li><li class="tab"><button type="button" data-href="#super-2">generator函数的自动调用</button></li><li class="tab"><button type="button" data-href="#super-3">参数Promise化(co中的toPromise的实现)</button></li><li class="tab"><button type="button" data-href="#super-4">着重来分析一下objectToPromise</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * slice() reference.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> slice = <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">slice</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Execute the generator function or a generator</span></span><br><span class="line"><span class="comment"> * and return a promise.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Function</span>&#125; <span class="variable">fn</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">Promise</span>&#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@api</span> <span class="variable">public</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">co</span>(<span class="params">gen</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> ctx = <span class="variable language_">this</span>;</span><br><span class="line">  <span class="keyword">var</span> args = slice.<span class="title function_">call</span>(<span class="variable language_">arguments</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// we wrap everything in a promise to avoid promise chaining,</span></span><br><span class="line">  <span class="comment">// which leads to memory leak errors.</span></span><br><span class="line">  <span class="comment">// see https://github.com/tj/co/issues/180</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> gen === <span class="string">&#x27;function&#x27;</span>) gen = gen.<span class="title function_">apply</span>(ctx, args);</span><br><span class="line">    <span class="keyword">if</span> (!gen || <span class="keyword">typeof</span> gen.<span class="property">next</span> !== <span class="string">&#x27;function&#x27;</span>) <span class="keyword">return</span> <span class="title function_">resolve</span>(gen);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">onFulfilled</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">Mixed</span>&#125; <span class="variable">res</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="type">Promise</span>&#125;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">onFulfilled</span>(<span class="params">res</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> ret;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        ret = gen.<span class="title function_">next</span>(res);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">reject</span>(e);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="title function_">next</span>(ret);</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">Error</span>&#125; <span class="variable">err</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="type">Promise</span>&#125;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">onRejected</span>(<span class="params">err</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> ret;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        ret = gen.<span class="keyword">throw</span>(err);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">reject</span>(e);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="title function_">next</span>(ret);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get the next value in the generator,</span></span><br><span class="line"><span class="comment">     * return a promise.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; <span class="variable">ret</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="type">Promise</span>&#125;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">next</span>(<span class="params">ret</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (ret.<span class="property">done</span>) <span class="keyword">return</span> <span class="title function_">resolve</span>(ret.<span class="property">value</span>);</span><br><span class="line">      <span class="keyword">var</span> value = toPromise.<span class="title function_">call</span>(ctx, ret.<span class="property">value</span>);</span><br><span class="line">      <span class="keyword">if</span> (value &amp;&amp; <span class="title function_">isPromise</span>(value)) <span class="keyword">return</span> value.<span class="title function_">then</span>(onFulfilled, onRejected);</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">onRejected</span>(<span class="keyword">new</span> <span class="title class_">TypeError</span>(<span class="string">&#x27;You may only yield a function, promise, generator, array, or object, &#x27;</span></span><br><span class="line">        + <span class="string">&#x27;but the following object was passed: &quot;&#x27;</span> + <span class="title class_">String</span>(ret.<span class="property">value</span>) + <span class="string">&#x27;&quot;&#x27;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Convert a `yield`ed value into a promise.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Mixed</span>&#125; <span class="variable">obj</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">Promise</span>&#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">toPromise</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!obj) <span class="keyword">return</span> obj;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_">isPromise</span>(obj)) <span class="keyword">return</span> obj;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_">isGeneratorFunction</span>(obj) || <span class="title function_">isGenerator</span>(obj)) <span class="keyword">return</span> co.<span class="title function_">call</span>(<span class="variable language_">this</span>, obj);</span><br><span class="line">  <span class="keyword">if</span> (<span class="string">&#x27;function&#x27;</span> == <span class="keyword">typeof</span> obj) <span class="keyword">return</span> thunkToPromise.<span class="title function_">call</span>(<span class="variable language_">this</span>, obj);</span><br><span class="line">  <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(obj)) <span class="keyword">return</span> arrayToPromise.<span class="title function_">call</span>(<span class="variable language_">this</span>, obj);</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_">isObject</span>(obj)) <span class="keyword">return</span> objectToPromise.<span class="title function_">call</span>(<span class="variable language_">this</span>, obj);</span><br><span class="line">  <span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Convert a thunk to a promise.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Function</span>&#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">Promise</span>&#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">thunkToPromise</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> ctx = <span class="variable language_">this</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">    fn.<span class="title function_">call</span>(ctx, <span class="keyword">function</span> (<span class="params">err, res</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="title function_">reject</span>(err);</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">arguments</span>.<span class="property">length</span> &gt; <span class="number">2</span>) res = slice.<span class="title function_">call</span>(<span class="variable language_">arguments</span>, <span class="number">1</span>);</span><br><span class="line">      <span class="title function_">resolve</span>(res);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Convert an array of &quot;yieldables&quot; to a promise.</span></span><br><span class="line"><span class="comment"> * Uses `Promise.all()` internally.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Array</span>&#125; <span class="variable">obj</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">Promise</span>&#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">arrayToPromise</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>(obj.<span class="title function_">map</span>(toPromise, <span class="variable language_">this</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Convert an object of &quot;yieldables&quot; to a promise.</span></span><br><span class="line"><span class="comment"> * Uses `Promise.all()` internally.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; <span class="variable">obj</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">Promise</span>&#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">objectToPromise</span>(<span class="params">obj</span>)&#123;</span><br><span class="line">  <span class="keyword">var</span> results = <span class="keyword">new</span> obj.<span class="title function_">constructor</span>(<span class="params"></span>);  <span class="comment">//Object.create()</span></span><br><span class="line">  <span class="keyword">var</span> keys = <span class="title class_">Object</span>.<span class="title function_">keys</span>(obj);  <span class="comment">//[&quot;a&quot;,&quot;b&quot;]</span></span><br><span class="line">  <span class="keyword">var</span> promises = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; keys.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">var</span> key = keys[i];   <span class="comment">//a   b</span></span><br><span class="line">    <span class="keyword">var</span> promise = toPromise.<span class="title function_">call</span>(<span class="variable language_">this</span>, obj[key]);</span><br><span class="line">    <span class="keyword">if</span> (promise &amp;&amp; <span class="title function_">isPromise</span>(promise)) <span class="title function_">defer</span>(promise, key);</span><br><span class="line">    <span class="keyword">else</span> results[key] = obj[key];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>(promises).<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> results;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Promise.resolve(4) Promise.resolve(5)  </span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">defer</span>(<span class="params">promise, key</span>) &#123;</span><br><span class="line">    <span class="comment">// predefine the key in the result</span></span><br><span class="line">    results[key] = <span class="literal">undefined</span>;   <span class="comment">//&#123;&#125;.a  &#123;&#125;.b</span></span><br><span class="line">    promises.<span class="title function_">push</span>(promise.<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">res</span>) &#123;</span><br><span class="line">      results[key] = res;</span><br><span class="line">    &#125;));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Check if `obj` is a promise.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; <span class="variable">obj</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">Boolean</span>&#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isPromise</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;function&#x27;</span> == <span class="keyword">typeof</span> obj.<span class="property">then</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Check if `obj` is a generator.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Mixed</span>&#125; <span class="variable">obj</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">Boolean</span>&#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isGenerator</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;function&#x27;</span> == <span class="keyword">typeof</span> obj.<span class="property">next</span> &amp;&amp; <span class="string">&#x27;function&#x27;</span> == <span class="keyword">typeof</span> obj.<span class="property">throw</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Check if `obj` is a generator function.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Mixed</span>&#125; <span class="variable">obj</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">Boolean</span>&#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isGeneratorFunction</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> constructor = obj.<span class="property">constructor</span>;</span><br><span class="line">  <span class="keyword">if</span> (!constructor) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">if</span> (<span class="string">&#x27;GeneratorFunction&#x27;</span> === constructor.<span class="property">name</span> || <span class="string">&#x27;GeneratorFunction&#x27;</span> === constructor.<span class="property">displayName</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">isGenerator</span>(constructor.<span class="property"><span class="keyword">prototype</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Check for plain object.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Mixed</span>&#125; <span class="variable">val</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">Boolean</span>&#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isObject</span>(<span class="params">val</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Object</span> == val.<span class="property">constructor</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * slice() reference.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> slice = <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">slice</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Execute the generator function or a generator</span></span><br><span class="line"><span class="comment"> * and return a promise.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Function</span>&#125; <span class="variable">fn</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">Promise</span>&#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@api</span> <span class="variable">public</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">co</span>(<span class="params">gen</span>) &#123;</span><br><span class="line">    <span class="comment">// 保存当前的执行环境</span></span><br><span class="line">    <span class="keyword">var</span> ctx = <span class="variable language_">this</span>;</span><br><span class="line">    <span class="comment">// 切割出函数调用时传递的参数</span></span><br><span class="line">    <span class="keyword">var</span> args = slice.<span class="title function_">call</span>(<span class="variable language_">arguments</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// we wrap everything in a promise to avoid promise chaining,</span></span><br><span class="line">    <span class="comment">// which leads to memory leak errors.</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 返回一个Promise实例</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">        <span class="comment">// 如果gen是一个函数，则返回一个新的gen函数的副本，里面绑定了this的指向，即ctx</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> gen === <span class="string">&#x27;function&#x27;</span>) gen = gen.<span class="title function_">apply</span>(ctx, args);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 如果gen不存在或者gen.next不是一个函数，就说明gen已经调用完成，那么直接可以resolve(gen)，返回Promise</span></span><br><span class="line">        <span class="keyword">if</span> (!gen || <span class="keyword">typeof</span> gen.<span class="property">next</span> !== <span class="string">&#x27;function&#x27;</span>) <span class="keyword">return</span> <span class="title function_">resolve</span>(gen);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 首次调用gen.next()函数，假如存在的话</span></span><br><span class="line">        <span class="title function_">onFulfilled</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> &#123;<span class="type">Mixed</span>&#125; <span class="variable">res</span></span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span> &#123;<span class="type">Promise</span>&#125;</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">onFulfilled</span>(<span class="params">res</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> ret;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">// 尝试着获取下一个yield后面代码执行后返回的值</span></span><br><span class="line">                ret = gen.<span class="title function_">next</span>(res);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="title function_">reject</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 处理结果</span></span><br><span class="line">            <span class="title function_">next</span>(ret);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> &#123;<span class="type">Error</span>&#125; <span class="variable">err</span></span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span> &#123;<span class="type">Promise</span>&#125;</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">onRejected</span>(<span class="params">err</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> ret;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">// 尝试抛出错误</span></span><br><span class="line">                ret = gen.<span class="keyword">throw</span>(err);</span><br><span class="line">            &#125; <span class="keyword">catch</span> **(e) &#123;</span><br><span class="line">                <span class="keyword">return</span> **<span class="title function_">reject</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 处理结果</span></span><br><span class="line">            <span class="title function_">next</span>(ret);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * Get the next value in the generator,</span></span><br><span class="line"><span class="comment">         * return a promise.</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; <span class="variable">ret</span></span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span> &#123;<span class="type">Promise</span>&#125;</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">// 这个next()函数是最为关键的一部分，里面几乎包含了generator自动调用实现的核心</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">next</span>(<span class="params">ret</span>) &#123;</span><br><span class="line">            <span class="comment">// 如果ret.done === true，证明generator函数已经执行完毕。即已经返回了值</span></span><br><span class="line">            <span class="keyword">if</span> (ret.<span class="property">done</span>) <span class="keyword">return</span> <span class="title function_">resolve</span>(ret.<span class="property">value</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 把ret.value转换成Promise对象继续调用</span></span><br><span class="line">            <span class="keyword">var</span> value = toPromise.<span class="title function_">call</span>(ctx, ret.<span class="property">value</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 如果存在，则把控制权交给onFulfilled和onRejected，实现递归调用</span></span><br><span class="line">            <span class="keyword">if</span> (value &amp;&amp; <span class="title function_">isPromise</span>(value)) <span class="keyword">return</span> value.<span class="title function_">then</span>(onFulfilled, onRejected);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 否则最后直接抛出错误</span></span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">onRejected</span>(<span class="keyword">new</span> <span class="title class_">TypeError</span>(<span class="string">&#x27;You may only yield a function, promise, generator, array, or object, &#x27;</span>+ <span class="string">&#x27;but the following object was passed: &quot;&#x27;</span> + <span class="title class_">String</span>(ret.<span class="property">value</span>) + <span class="string">&#x27;&quot;&#x27;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>对于以上代码中的onFulfilled和onRejected，可以把它们看成是co模块对于resolve和reject封装的加强版。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Convert a `yield`ed value into a promise.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Mixed</span>&#125; <span class="variable">obj</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">Promise</span>&#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">toPromise</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    <span class="comment">// 如果传入的 obj 是假值，返回这个假值 如 undefined , false, null</span></span><br><span class="line">    <span class="keyword">if</span> (!obj) <span class="keyword">return</span> obj;</span><br><span class="line">    <span class="comment">// 如果是 Promise 实例，返回这个 promise 实例</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">isPromise</span>(obj)) <span class="keyword">return</span> obj;</span><br><span class="line">    <span class="comment">// 如果是 generator 函数或者 一个generator</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">isGeneratorFunction</span>(obj) || <span class="title function_">isGenerator</span>(obj)) <span class="keyword">return</span> co.<span class="title function_">call</span>(<span class="variable language_">this</span>, obj);</span><br><span class="line">    <span class="comment">// 如果是 thunk 函数</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&#x27;function&#x27;</span> == <span class="keyword">typeof</span> obj) <span class="keyword">return</span> thunkToPromise.<span class="title function_">call</span>(<span class="variable language_">this</span>, obj);</span><br><span class="line">    <span class="comment">// 如果是一个数组</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(obj)) <span class="keyword">return</span> arrayToPromise.<span class="title function_">call</span>(<span class="variable language_">this</span>, obj);</span><br><span class="line">    <span class="comment">// 如果是一个 plain object</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">isObject</span>(obj)) <span class="keyword">return</span> objectToPromise.<span class="title function_">call</span>(<span class="variable language_">this</span>, obj);</span><br><span class="line">    <span class="comment">// 如果是原始值，则返回这个原始值。</span></span><br><span class="line">    <span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>toPromise的本质上就是通过判定参数的类型，然后再通过转移控制权给不同的参数处理函数，从而获取到期望返回的值。</p><p>关于参数的类型的判断，看一下源码就能理解了，比较简单。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Convert an object of &quot;yieldables&quot; to a promise.</span></span><br><span class="line"><span class="comment"> * Uses `Promise.all()` internally.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; <span class="variable">obj</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">Promise</span>&#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">objectToPromise</span>(<span class="params">obj</span>)&#123;</span><br><span class="line">    <span class="comment">// 定义一个和传入的对象一样构造器的空对象</span></span><br><span class="line">    <span class="keyword">var</span> results = <span class="keyword">new</span> obj.<span class="title function_">constructor</span>(<span class="params"></span>);</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// 获取对象的所有可以遍历的key（属性）</span></span><br><span class="line">    <span class="keyword">var</span> keys = <span class="title class_">Object</span>.<span class="title function_">keys</span>(obj);</span><br><span class="line">    <span class="comment">// 用于盛放 每个属性值生成的对应的 promise 实例</span></span><br><span class="line">    <span class="keyword">var</span> promises = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; keys.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> key = keys[i];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 对于数组的每一个项都调用一次toPromise方法，变成Promise对象</span></span><br><span class="line">        <span class="keyword">var</span> promise = toPromise.<span class="title function_">call</span>(<span class="variable language_">this</span>, obj[key]);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 如果里面是Promise对象的话，则取出e里面resolved后的值</span></span><br><span class="line">        <span class="keyword">if</span> (promise &amp;&amp; <span class="title function_">isPromise</span>(promise)) <span class="title function_">defer</span>(promise, key);</span><br><span class="line">        <span class="keyword">else</span> results[key] = obj[key];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 并行，按顺序返回结果，返回一个数组</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>(promises).<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 将 results 作为 onFulfilled 函数的参数</span></span><br><span class="line">        <span class="keyword">return</span> results;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 根据key来获取Promise实例resolved后的结果，从而push进结果数组results中</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">defer</span>(<span class="params">promise, key</span>) &#123;</span><br><span class="line">        <span class="comment">// predefine the key in the result</span></span><br><span class="line">        results[key] = <span class="literal">undefined</span>;</span><br><span class="line">        promises.<span class="title function_">push</span>(promise.<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">res</span>) &#123;</span><br><span class="line">            <span class="comment">// 定义promise 实例的 resolve 函数</span></span><br><span class="line">            results[key] = res;</span><br><span class="line">        &#125;));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上面理解的关键就在于把key遍历，如果key对应的value也是Promise对象的话，那么调用defer()方法来获取resolved后的值。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="编写自己的generator函数运行器"><a href="#编写自己的generator函数运行器" class="headerlink" title="编写自己的generator函数运行器"></a>编写自己的generator函数运行器</h2><p>通过以上的简单介绍，我们就可以尝试来写一个属于自己的generator函数运行器了，目标功能是能够自动运行function* 函数，并且里面的yield子句后面跟着的都是Promise实例。</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">具体代码(my-co.js)</button></li><li class="tab"><button type="button" data-href="#super-2">在test.js文件中调用</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// my-co.js</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = my-co;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> my-co = <span class="keyword">function</span> (<span class="params">gen</span>) &#123;</span><br><span class="line">    <span class="comment">// gen是一个具有Promise的生成器函数</span></span><br><span class="line">    <span class="keyword">const</span> g = <span class="title function_">gen</span>(); <span class="comment">// 迭代器</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 首次调用next</span></span><br><span class="line">    <span class="title function_">next</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">next</span>(<span class="params">val</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> ret = g.<span class="title function_">next</span>(val); <span class="comment">// 调用ret</span></span><br><span class="line">        <span class="keyword">if</span> (ret.<span class="property">done</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> ret.<span class="property">value</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (ret &amp;&amp; <span class="string">&#x27;function&#x27;</span> === <span class="keyword">typeof</span> ret.<span class="property">value</span>.<span class="property">then</span>) &#123;</span><br><span class="line">            ret.<span class="property">value</span>.<span class="title function_">then</span>( <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="comment">// 继续循环下去</span></span><br><span class="line">                <span class="keyword">return</span> <span class="title function_">next</span>(data); <span class="comment">// promise resolved</span></span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// test.jsconst</span></span><br><span class="line">myCo = <span class="built_in">require</span>(<span class="string">&#x27;./my-co&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> gen = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> data1 = <span class="keyword">yield</span> <span class="title function_">pro1</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;data1: &#x27;</span> + data1);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> data2 = <span class="keyword">yield</span> <span class="title function_">pro2</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;data2: &#x27;</span> + data2);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> data3 = <span class="keyword">yield</span> <span class="title function_">pro3</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;data3: &#x27;</span> + data3);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> data4 = <span class="keyword">yield</span> <span class="title function_">pro4</span>(data1 + <span class="string">&#x27;\n&#x27;</span> + data2 + <span class="string">&#x27;\n&#x27;</span> + data3);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;data4: &#x27;</span> + data4);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;All done.&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用myCo</span></span><br><span class="line"><span class="title function_">myCo</span>(gen);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 延迟两秒</span></span><br><span class="line">resolve<span class="keyword">function</span> <span class="title function_">pro1</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(resolve, <span class="number">2000</span>, <span class="string">&#x27;promise1 resolved&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 延迟一秒</span></span><br><span class="line">resolve<span class="keyword">function</span> <span class="title function_">pro2</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(resolve, <span class="number">1000</span>, <span class="string">&#x27;promise2 resolved&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 写入Hello World到./1.txt文件中</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">pro3</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        fs.<span class="title function_">appendFile</span>(<span class="string">&#x27;./1.txt&#x27;</span>, <span class="string">&#x27;Hello World\n&#x27;</span>, <span class="keyword">function</span>(<span class="params">err</span>) &#123;</span><br><span class="line">            <span class="title function_">resolve</span>(<span class="string">&#x27;write-1 success&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 写入content到./1.txt文件中</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">pro4</span>(<span class="params">content</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        fs.<span class="title function_">appendFile</span>(<span class="string">&#x27;./1.txt&#x27;</span>, content, <span class="keyword">function</span>(<span class="params">err</span>) &#123;</span><br><span class="line">            <span class="title function_">resolve</span>(<span class="string">&#x27;write-2 success&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>控制台输出结果：<br><code>// output data1: promise1 resolved data2: promise2 resolved data3: write-1 success data4: write-2 success</code><br>.&#x2F;1.txt文件内容：<br><code>Hello World promise1 resolved promise2 resolved write-1 success</code></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>虽然这个运行器很简单，后面只支持Promise实例，并且也不支持多种参数，但是却引导出了一个思路，促使我们思考怎么去展示我们的代码，还有就是很有效地避免了多重then，以 <strong>同步的方式来书写异步代码</strong> 。Promise解决的是回调地狱的问题（callback hell）,而Generator解决的是代码的书写方式。孰优孰劣，全在于个人意愿。</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>以上分析了co部分源码的精髓，讲到了co函数里面generator函数自动遍历执行的机制，还讲到了co里面最为关键的objectToPromise()方法。</p><p>在文章的后面我们编写了一个属于自己的generator函数遍历器，其中主要的是next()方法，它可以检测我们yield后面Promise操作是否完成。<br>如果generator的状态done还没有置为true，那么继续调用next(val)方法，并把上一次yield操作获取到的值传递下去。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>hexo更新方式</title>
      <link href="/posts/15858/"/>
      <url>/posts/15858/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="安装主题"><a href="#安装主题" class="headerlink" title="安装主题"></a>安装主题</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">git clone https:<span class="regexp">//gi</span>thub.com<span class="regexp">/litten/</span>hexo-theme-yilia.git themes/yilia</span><br></pre></td></tr></table></figure><h2 id="更新主题"><a href="#更新主题" class="headerlink" title="更新主题"></a>更新主题</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> themes/yilia</span><br><span class="line">git pull</span><br></pre></td></tr></table></figure><h2 id="自动更新"><a href="#自动更新" class="headerlink" title="自动更新"></a>自动更新</h2><p>使用cd命令进入博客根目录<br>常规操作，不做解释</p><p>更新插件和Hexo版本<br>npm update</p><h2 id="手动更新"><a href="#手动更新" class="headerlink" title="手动更新"></a>手动更新</h2><ol><li>使用cd命令进入博客根目录<br>常规操作，不做解释</li><li>检查插件更新<br>npm outdated</li><li>运行后可以检查Hexo和插件的最新版本<br><img src="/image/hexo%E6%9B%B4%E6%96%B0%E6%96%B9%E5%BC%8F/1664537849838.png" alt="1664537849838"></li><li>更改版本文件<br>修改根目录的package.json文件，将对应插件名称所对应的版本号更改为要更新的版本号。<br><img src="/image/hexo%E6%9B%B4%E6%96%B0%E6%96%B9%E5%BC%8F/1664537868070.png" alt="1664537868070"></li><li>开始更新<br>npm install –save</li><li>查看当前版本号<br>hexo version<br><img src="/image/hexo%E6%9B%B4%E6%96%B0%E6%96%B9%E5%BC%8F/1664537946133.png" alt="1664537946133"></li></ol><p>真实有效</p><p>升级方法：在主題目录下，进行 <code>git pull</code></p><h2 id="启用主题"><a href="#启用主题" class="headerlink" title="启用主题"></a>启用主题</h2><p>修改Hexo目录下的_config.yml配置文件中的theme属性，将其设置为butterfly。</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hexo</span> g <span class="comment"># 生成</span></span><br><span class="line">hexo s <span class="comment"># 启动本地web服务器</span></span><br></pre></td></tr></table></figure><p>现在打开<a href="http://localhost:4000/">http://localhost:4000/</a> ，会看到我们已经应用了一个新的主题。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>HTTP中get和post的区别</title>
      <link href="/posts/d73b0b5a/"/>
      <url>/posts/d73b0b5a/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Http定义了与服务器交互的不同方法，最基本的方法有4种，分别是GET，POST，PUT，DELETE。</p><p>URL全称是资源描述符，我们可以这样认为：一个URL地址，它用于描述一个网络上的资源，而HTTP中的GET，POST，PUT，DELETE就对应着对这个资源的查，改，增，删4个操作。</p><p>到这里，大家应该有个大概的了解了，GET一般用于获取&#x2F;查询资源信息，而POST一般用于更新资源信息。</p><p>1.根据HTTP规范，GET用于信息获取，而且应该是安全的和幂等的。</p><p>(1).所谓安全的意味着该操作用于获取信息而非修改信息。换句话说，GET请求一般不应产生副作用。就是说，它仅仅是获取资源信息，就像数据库查询一样，不会修改，增加数据，不会影响资源的状态。</p><p>*注意：这里安全的含义仅仅是指是非修改信息。</p><p>(2).幂等的意味着对同一URL的多个请求应该返回同样的结果。这里我再解释一下幂等这个概念：</p><p>幂等（idempotent、idempotence）是一个数学或计算机学概念，常见于抽象代数中。</p><p>幂等有一下几种定义：</p><p>对于单目运算，如果一个运算对于在范围内的所有的一个数多次进行该运算所得的结果和进行一次该运算所得的结果是一样的，那么我们就称该运算是幂等的。比如绝对值运算就是一个例子，在实数集中，有abs(a)&#x3D;abs(abs(a))。</p><p>对于双目运算，则要求当参与运算的两个值是等值的情况下，如果满足运算结果与参与运算的两个值相等，则称该运算幂等，如求两个数的最大值的函数，有在在实数集中幂等，即max(x,x)&#x3D;x。</p><p>看完上述解释后，应该可以理解GET幂等的含义了。</p><p>但在实际应用中，以上2条规定并没有这么严格。引用别人文章的例子：比如，新闻站点的头版不断更新。虽然第二次请求会返回不同的一批新闻，该操作仍然被认为是安全的和幂等的，因为它总是返回当前的新闻。从根本上说，如果目标是当用户打开一个链接时，他可以确信从自身的角度来看没有改变资源即可。</p><p>2.根据HTTP规范，POST表示可能修改变服务器上的资源的请求。继续引用上面的例子：还是新闻以网站为例，读者对新闻发表自己的评论应该通过POST实现，因为在评论提交后站点的资源已经不同了，或者说资源被修改了。</p><p>上面大概说了一下HTTP规范中GET和POST的一些原理性的问题。但在实际的做的时候，很多人却没有按照HTTP规范去做，导致这个问题的原因有很多，比如说：</p><p>1.很多人贪方便，更新资源时用了GET，因为用POST必须要到FORM（表单），这样会麻烦一点。</p><p>2.对资源的增，删，改，查操作，其实都可以通过GET&#x2F;POST完成，不需要用到PUT和DELETE。</p><p>3.另外一个是，早期的WebMVC框架设计者们并没有有意识地将URL当作抽象的资源来看待和设计，所以导致一个比较严重的问题是传统的WebMVC框架基本上都只支持GET和POST两种HTTP方法，而不支持PUT和DELETE方法。</p><p>*简单解释一下MVC：MVC本来是存在于Desktop程序中的，M是指数据模型，V是指用户界面，C则是控制器。使用MVC的目的是将M和V的实现代码分离，从而使同一个程序可以使用不同的表现形式。</p><p>以上3点典型地描述了老一套的风格（没有严格遵守HTTP规范），随着架构的发展，现在出现REST(RepresentationalStateTransfer)，一套支持HTTP规范的新风格，这里不多说了，可以参考《RESTfulWebServices》。</p><p>说完原理性的问题，我们再从表面现像上面看看GET和POST的区别：</p><p>1.GET请求的数据会附在URL之后（就是把数据放置在HTTP协议头中），以?分割URL和传输数据，参数之间以&amp;相连，如：login.action?name&#x3D;hyddd&amp;password&#x3D;idontknow&amp;verify&#x3D;%E4%BD%A0%E5%A5%BD。如果数据是英文字母&#x2F;数字，原样发送，如果是空格，转换为+，如果是中文&#x2F;其他字符，则直接把字符串用BASE64加密，得出如：%E4%BD%A0%E5%A5%BD，其中％XX中的XX为该符号以16进制表示的ASCII。</p><p>POST把提交的数据则放置在是HTTP包的包体中。</p><p>2.”GET方式提交的数据最多只能是1024字节，理论上POST没有限制，可传较大量的数据，IIS4中最大为80KB，IIS5中为100KB”？？！</p><p>以上这句是我从其他文章转过来的，其实这样说是错误的，不准确的：</p><p>(1).首先是”GET方式提交的数据最多只能是1024字节”，因为GET是通过URL提交数据，那么GET可提交的数据量就跟URL的长度有直接关系了。而实际上，URL不存在参数上限的问题，HTTP协议规范没有对URL长度进行限制。这个限制是特定的浏览器及服务器对它的限制。IE对URL长度的限制是2083字节(2K+35)。对于其他浏览器，如Netscape、FireFox等，理论上没有长度限制，其限制取决于操作系统的支持。</p><p>注意这是限制是整个URL长度，而不仅仅是你的参数值数据长度。</p><p>(2).理论上讲，POST是没有大小限制的，HTTP协议规范也没有进行大小限制，说“POST数据量存在80K&#x2F;100K的大小限制”是不准确的，POST数据是没有限制的，起限制作用的是服务器的处理程序的处理能力。</p><p>对于ASP程序，Request对象处理每个表单域时存在100K的数据长度限制。但如果使用Request.BinaryRead则没有这个限制。</p><p>由这个延伸出去，对于IIS6.0，微软出于安全考虑，加大了限制。我们还需要注意：</p><p>1).IIS6.0默认ASPPOST数据量最大为200KB，每个表单域限制是100KB。</p><p>2).IIS6.0默认上传文件的最大大小是4MB。</p><p>3).IIS6.0默认最大请求头是16KB。</p><p>IIS6.0之前没有这些限制。</p><p>所以上面的80K，100K可能只是默认值而已(注：关于IIS4和IIS5的参数，我还没有确认)，但肯定是可以自己设置的。由于每个版本的IIS对这些参数的默认值都不一样，具体请参考相关的IIS配置文档。</p><p>3.在ASP中，服务端获取GET请求参数用Request.QueryString，获取POST请求参数用Request.Form。在JSP中，用request.getParameter(&quot;XXXX&quot;)来获取，虽然jsp中也有request.getQueryString()方法，但使用起来比较麻烦，比如：传一个test.jsp?name&#x3D;hyddd&amp;password&#x3D;hyddd，用request.getQueryString()得到的是：name&#x3D;hyddd&amp;password&#x3D;hyddd。在PHP中，可以用$_GET和$_POST分别获取GET和POST中的数据，而$_REQUEST则可以获取GET和POST两种请求中的数据。值得注意的是，JSP中使用request和PHP中使用$_REQUEST都会有隐患，这个下次再写个文章总结。</p><p>4.POST的安全性要比GET的安全性高。注意：这里所说的安全性和上面GET提到的“安全”不是同个概念。上面“安全”的含义仅仅是不作数据修改，而这里安全的含义是真正的Security的含义，比如：通过GET提交数据，用户名和密码将明文出现在URL上，因为(1)登录页面有可能被浏览器缓存，(2)其他人查看浏览器的历史纪录，那么别人就可以拿到你的账号和密码了，除此之外，使用GET提交数据还可能会造成Cross-siterequestforgery攻击。</p><p>总结一下，Get是向服务器发索取数据的一种请求，而Post是向服务器提交数据的一种请求，在FORM（表单）中，Method默认为”GET”，实质上，GET和POST只是发送机制不同，并不是一个取一个发！</p><p>从<strong>数据包</strong>、<strong>编码方式</strong>、<strong>请求参数</strong>、<strong>收藏为书签</strong>、<strong>历史记录</strong>、<strong>安全性</strong>等几方面回答。</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/PMZOEonJxWeP0w7dibn7l3skTzywDDCoulHqEe98uNmf1Jcj0p5Wvj8sA2bAJeobXuPcXF7kuf9RUvuW9iabmrCA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><table><thead><tr><th>请求方式</th><th>GET</th><th>POST</th></tr></thead><tbody><tr><td>数据包</td><td>产生一个 <code>TCP</code>数据包</td><td>可能产生两个 <code>TCP</code>数据包</td></tr><tr><td>数据位置</td><td>query string</td><td>request body</td></tr><tr><td>编码方式</td><td>只能进行 <code>url</code>编码</td><td>支持多种编码方式</td></tr><tr><td>请求参数</td><td>把参数包含在 <code>url</code>中，用 <code>&amp;</code>连接起来</td><td>通过 <code>request body</code>传递参数</td></tr><tr><td>请求缓存</td><td>会被主动 <code>Cache</code></td><td>不会缓存,除非手动设置</td></tr><tr><td>收藏为书签</td><td>支持</td><td>不支持</td></tr><tr><td>历史记录</td><td>参数会被完整保留在浏览历史记录里</td><td>不会保留</td></tr><tr><td>参数数据类型</td><td><code>ASCII</code>的字符</td><td></td></tr><tr><td>语义</td><td>在服务器上查询数据并返回</td><td>增加新资源，修改已有资源</td></tr><tr><td>安全性</td><td>低于post</td><td></td></tr></tbody></table>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>compose和pipe函数</title>
      <link href="/posts/82dafe4d/"/>
      <url>/posts/82dafe4d/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">Compose函数</button></li><li class="tab"><button type="button" data-href="#super-2">Pipe函数</button></li><li class="tab"><button type="button" data-href="#super-3">链式调用</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>定义：为了便于连续执行方法，把调用传值整个过程封装成函数，即为compose函数。只需要告诉compose函数需要执行哪些方法，其会自动执行。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">compose</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// arguments</span></span><br><span class="line">    <span class="keyword">const</span> args = [].<span class="property">slice</span>.<span class="title function_">apply</span>(<span class="variable language_">arguments</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">num</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> _result = num;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        for(var i = args.length - 1; i &gt;= 0; i—) &#123;</span></span><br><span class="line"><span class="comment">            _result = args[i](_result);</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        return _result; </span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="comment">// 等价于</span></span><br><span class="line">        <span class="keyword">return</span> args.<span class="title function_">reduceRight</span>(<span class="function">(<span class="params">res, cb</span>) =&gt;</span> <span class="title function_">cb</span>(res), num); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">compose</span>(addThree, addTwo, minusOne, multiplyTwo)(<span class="number">10</span>);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>和compose函数功能一样，执行方向相反</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>用promise组成链式调用（此处和面向对象的链式调用有所区别）</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>reflect反射机制</title>
      <link href="/posts/41365fed/"/>
      <url>/posts/41365fed/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>MDN定义：<br>Reflect是一个内置的对象，用来提供方法去拦截JavaScript的操作。Reflect不是一个函数对象，所以它是不可构造的，也就是说它不是一个构造器，你不能通过 <code>new</code>操作符去新建或者将其作为一个函数去调用Reflect对象。Reflect的所有属性和方法都是静态的。</p></blockquote><p>反射机制指的是程序在运行时能够获取自身的信息。js 中的 apply 就是反射机制。</p><p><strong>Reflect API 汇总</strong><br>Reflect 提供了一套用于操作对象的 API（静态方法）</p><table><thead><tr><th><strong>handler⽅法</strong></th><th><strong>默认设置调⽤</strong></th><th><strong>作用</strong></th></tr></thead><tbody><tr><td>get</td><td>Reflect.get(target, name, receiver)</td><td>获得目标的身上某一特性的值</td></tr><tr><td>set</td><td>Reflect.set(target, name, value, receiver)</td><td>在目标上设定特性</td></tr><tr><td>has</td><td>Reflect.has(obj, name)</td><td>分辨一个目标是不是存有某一特性</td></tr><tr><td>deleteProperty</td><td>Reflect.deleteProperty(obj, name)</td><td>删掉目标上的特性</td></tr><tr><td>getProperty</td><td>Reflect.getPrototypeOf(obj)</td><td>获得特定目标原形的涵数</td></tr><tr><td>setProperty</td><td>Reflect.setPrototypeOf(obj, newProto)</td><td>设定或更改目标原形的涵数</td></tr><tr><td>isExtensible</td><td>Reflect.isExtensible(target)</td><td>分辨一个目标是不是可拓展（即是不是可以加上新的特性）</td></tr><tr><td>preventExtensions</td><td>Reflect.preventExtensions(target)</td><td>阻拦新特性加上到目标</td></tr><tr><td>getOwnPropertyDescriptor</td><td>Reflect.getOwnPropertyDescriptor(target, propertyKey)</td><td>获得给出特性的特性描述符</td></tr><tr><td>defineProperty</td><td>Reflect.defineProperty(target, propertyKey, attributes)</td><td>界定或改动一个目标的特性</td></tr><tr><td>ownKeys</td><td>Reflect.ownKeys()</td><td>回到由总体目标目标本身的特性键构成的二维数组</td></tr><tr><td>apply</td><td>Reflect.apply(func, thisArg, args)</td><td>对一个涵数开展启用实际操作，另外能够传到一个二维数组做为启用主要参数</td></tr><tr><td>construct</td><td>Reflect.construct(target, args)</td><td>对构造方法开展new实际操作，完成建立类的案例</td></tr><tr><td>preventExtensions</td><td>Reflect.preventExtensions()</td><td>阻拦新特性加上到目标</td></tr></tbody></table><p><strong>Reflect对象的作用&#x2F;优点</strong></p><ol><li>把实现反射机制的方法重新归结在一起并且简化操作，保持JS语意清晰和语法简单</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s = <span class="title class_">Symbol</span>(<span class="string">&#x27;foo&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> k = <span class="string">&#x27;bar&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> o = &#123; [s]: <span class="number">1</span>, [k]: <span class="number">1</span> &#125;;</span><br><span class="line"><span class="comment">// getOwnPropertyNames获取到String类型的key</span></span><br><span class="line"><span class="comment">// getOwnPropertySymbols获取到Symbol类型的key</span></span><br><span class="line"><span class="keyword">var</span> keys = <span class="title class_">Object</span>.<span class="title function_">getOwnPropertyNames</span>(o).<span class="title function_">concat</span>(<span class="title class_">Object</span>.<span class="title function_">getOwnPropertySymbols</span>(o));</span><br><span class="line"><span class="comment">// 使用Reflect的话：</span></span><br><span class="line"><span class="keyword">var</span> keys = <span class="title class_">Reflect</span>.<span class="title function_">ownKeys</span>(o);</span><br></pre></td></tr></table></figure><ol start="2"><li>补充一些Object对象没有的方法（如Reflect.apply）</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>(<span class="params">…rest</span>)&#123;</span><br><span class="line">  consloe.<span class="title function_">log</span>(rest);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`hello:`</span> + <span class="variable language_">this</span>.<span class="property">name</span>);</span><br><span class="line">&#125;</span><br><span class="line">fn.<span class="property">apply</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="comment">// 错误</span></span><br><span class="line">fn.<span class="title function_">apply</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line"><span class="comment">// 正确</span></span><br><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">apply</span>.<span class="title function_">call</span>(fn, &#123;<span class="attr">name</span>: <span class="string">`小明`</span>&#125;, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line"><span class="title class_">Reflect</span>.<span class="title function_">apply</span>(fn, &#123;<span class="attr">name</span>: <span class="string">`小明`</span>&#125;, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="attr">hello</span>: <span class="string">`小明`</span></span><br></pre></td></tr></table></figure><ol start="3"><li>让Object操作都变为函数行为，比如使用Reflect.has(obj, name)替换name in obj</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;<span class="attr">id</span>: <span class="number">1</span>&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="string">`id`</span> <span class="keyword">in</span> obj) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`ok`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = &#123;<span class="attr">id</span>: <span class="number">1</span>&#125;;</span><br><span class="line"><span class="keyword">if</span>(<span class="title class_">Reflect</span>.<span class="title function_">has</span>(obj, <span class="string">`id`</span>)) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`ok`</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>proxy</title>
      <link href="/posts/7372c9be/"/>
      <url>/posts/7372c9be/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Proxy是ES6中提供的新的API<br>proxy代理：在目标对象的前面设置一个拦截层，外界在访问这个对象的时候，必须经过拦截层。</p><blockquote><p>我们可以在拦截层做一些过滤或者是改写的操作。<br>语法<br><code>var proxy = new Proxy(target, handler);</code><br>Proxy 对象的所有用法，都是上面这种形式，不同的只是handler参数的写法。其中：</p></blockquote><ul><li>new Proxy() 表示生成一个 Proxy 实例</li><li>target 参数表示所要拦截的目标对象可以是一个object或者function</li><li>handler 参数也是一个对象，用来定制拦截行为;如果handler没有设置任何拦截，那就等同于直接通向原对象</li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> ES新特性 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ES6 </tag>
            
            <tag> Proxy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>generator生成器</title>
      <link href="/posts/8706750a/"/>
      <url>/posts/8706750a/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Generatror函数有两个特征：</p><ul><li>function关键字与函数名之间有一个星号</li><li>函数体内部使用yield语句，定义不同的内部状态</li></ul><p>生成器它能像迭代一样返回一个迭代器对象，然后调用 next 方法进行抽取。<br>Generator函数有多种理解角度。从语法上，可以把它理解成一个状态机，封装了多个内部状态。<br>执行Generator函数会返回一个遍历器对象，也就是说，Generator函数除了状态机，还是一个遍历器对象生成函数。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 生成器</span></span><br><span class="line"><span class="keyword">function</span>* <span class="title function_">createIterator</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 生成器能像正规函数那样被调用，但会返回一个迭代器</span></span><br><span class="line"><span class="keyword">let</span> iterator = <span class="title function_">createIterator</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>().<span class="property">value</span>); <span class="comment">// 1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>().<span class="property">value</span>); <span class="comment">// 2</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>().<span class="property">value</span>); <span class="comment">// 3</span></span><br></pre></td></tr></table></figure><p>　　在这个示例中，createlterator()前的星号表明它是一个生成器；yield关键字也是ES6的新特性，可以通过它来指定调用迭代器的next()方法时的返回值及返回顺序。生成迭代器后，连续3次调用它的next()方法返回3个不同的值，分别是1、2和3。生成器的调用过程与其他函数一样，最终返回的是创建好的迭代器<br>　　生成器函数最有趣的部分是，每当执行完一条yield语句后函数就会自动停止执行。举个例子，在上面这段代码中，执行完语句yield 1之后，函数便不再执行其他任何语句，直到再次调用迭代器的next()方法才会继续执行yield 2语句。生成器函数的这种中止函数执行的能力有很多有趣的应用<br>　　使用yield关键字可以返回任何值或表达式，所以可以通过生成器函数批量地给迭代器添加元素。例如，可以在循环中使用yield关键字</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> *<span class="title function_">createIterator</span>(<span class="params">items</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; items.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">yield</span> items[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> iterator = <span class="title function_">createIterator</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>()); <span class="comment">// &quot;&#123; value: 1, done: false &#125;&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>()); <span class="comment">// &quot;&#123; value: 2, done: false &#125;&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>()); <span class="comment">// &quot;&#123; value: 3, done: false &#125;&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>()); <span class="comment">// &quot;&#123; value: undefined, done: true &#125;&quot;</span></span><br><span class="line"><span class="comment">// 之后的所有调用</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>()); <span class="comment">// &quot;&#123; value: undefined, done: true &#125;&quot;</span></span><br></pre></td></tr></table></figure><p>　　在此示例中，给生成器函数createlterator()传入一个items数组，而在函数内部，for循环不断从数组中生成新的元素放入迭代器中，每遇到一个yield语句循环都会停止；每次调用迭代器的next()方法，循环会继续运行并执行下一条yield语句<br>　　生成器函数是ES6中的一个重要特性，可以将其用于所有支持函数使用的地方</p><h2 id="【使用限制】"><a href="#【使用限制】" class="headerlink" title="【使用限制】"></a>【使用限制】</h2><p>yield关键字只可在生成器内部使用，在其他地方使用会导致程序抛出错误</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> *<span class="title function_">createIterator</span>(<span class="params">items</span>) &#123;</span><br><span class="line">    items.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">item</span>) &#123;</span><br><span class="line">        <span class="comment">// 语法错误</span></span><br><span class="line">        <span class="keyword">yield</span> item + <span class="number">1</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>　　从字面上看，yield关键字确实在createlterator()函数内部，但是它与return关键字一样，二者都不能穿透函数边界。嵌套函数中的return语句不能用作外部函数的返回语句，而此处嵌套函数中的yield语句会导致程序抛出语法错误</p><h2 id="【生成器函数表达式】"><a href="#【生成器函数表达式】" class="headerlink" title="【生成器函数表达式】"></a>【生成器函数表达式】</h2><p>　　也可以通过函数表达式来创建生成器，只需在function关键字和小括号中间添加一个星号(*)即可</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> createIterator = <span class="keyword">function</span> *(items) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; items.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">yield</span> items[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> iterator = <span class="title function_">createIterator</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>()); <span class="comment">// &quot;&#123; value: 1, done: false &#125;&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>()); <span class="comment">// &quot;&#123; value: 2, done: false &#125;&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>()); <span class="comment">// &quot;&#123; value: 3, done: false &#125;&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>()); <span class="comment">// &quot;&#123; value: undefined, done: true &#125;&quot;</span></span><br><span class="line"><span class="comment">// 之后的所有调用</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>()); <span class="comment">// &quot;&#123; value: undefined, done: true &#125;&quot;</span></span><br></pre></td></tr></table></figure><p>　　在这段代码中，createlterator()是一个生成器函数表达式，而不是一个函数声明。由于函数表达式是匿名的，因此星号直接放在function关键字和小括号之间。此外，这个示例基本与前例相同，使用的也是for循环<br>　　[注意]不能用箭头函数来创建生成器</p><h2 id="【生成器对象的方法】"><a href="#【生成器对象的方法】" class="headerlink" title="【生成器对象的方法】"></a>【生成器对象的方法】</h2><p>　　由于生成器本身就是函数，因而可以将它们添加到对象中。例如，在ES5风格的对象字面量中，可以通过函数表达式来创建生成器</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = &#123;</span><br><span class="line">  <span class="attr">createIterator</span>: <span class="keyword">function</span> *(items) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; items.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">yield</span> items[i];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> iterator = o.<span class="title function_">createIterator</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</span><br></pre></td></tr></table></figure><p>　　也可以用ES6的函数方法的简写方式来创建生成器，只需在函数名前添加一个星号(*)</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = &#123;</span><br><span class="line">  *<span class="title function_">createIterator</span>(<span class="params">items</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; items.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">yield</span> items[i];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> iterator = o.<span class="title function_">createIterator</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</span><br></pre></td></tr></table></figure><p>　　这些示例使用了不同于之前的语法，但它们的功能实际上是等价的。在简写版本中，由于不使用function关键字来定义createlterator()方法，因此尽管可以在星号和方法名之间留白，但还是将星号紧贴在方法名之前</p><h2 id="【状态机】生成器的一个常用功能是生成状态机"><a href="#【状态机】生成器的一个常用功能是生成状态机" class="headerlink" title="【状态机】生成器的一个常用功能是生成状态机"></a>【状态机】生成器的一个常用功能是生成状态机</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> state = <span class="keyword">function</span>* () &#123;</span><br><span class="line">  <span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">    <span class="keyword">yield</span> <span class="string">&#x27;B&#x27;</span>;</span><br><span class="line">    <span class="keyword">yield</span> <span class="string">&#x27;C&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> status = <span class="title function_">state</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(status.<span class="title function_">next</span>().<span class="property">value</span>);<span class="comment">//&#x27;A&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(status.<span class="title function_">next</span>().<span class="property">value</span>);<span class="comment">//&#x27;B&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(status.<span class="title function_">next</span>().<span class="property">value</span>);<span class="comment">//&#x27;C&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(status.<span class="title function_">next</span>().<span class="property">value</span>);<span class="comment">//&#x27;A&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(status.<span class="title function_">next</span>().<span class="property">value</span>);<span class="comment">//&#x27;B&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="应用场景：通过yield-实现非线性迭代"><a href="#应用场景：通过yield-实现非线性迭代" class="headerlink" title="应用场景：通过yield*实现非线性迭代"></a>应用场景：通过yield*实现非线性迭代</h2><p>yield关键字后面可以跟随另一个generator对象或其他可迭代对象。<br>可以利用这个特性实现非线性结构的遍历</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">a</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">yield</span> ‘a1’</span><br><span class="line">  <span class="keyword">yield</span> ‘a2’</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span>* <span class="title function_">b</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">yield</span> ‘b1’</span><br><span class="line">  <span class="keyword">yield</span>* <span class="title function_">a</span>()</span><br><span class="line">  <span class="keyword">yield</span>* [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">  <span class="keyword">yield</span> ‘b2’</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> item <span class="keyword">of</span> <span class="title function_">b</span>())&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(item)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// b1 a1 a2 1 2 b2</span></span><br></pre></td></tr></table></figure><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">next</button></li><li class="tab"><button type="button" data-href="#super-2">throw</button></li><li class="tab"><button type="button" data-href="#super-3">return</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>ES6规范中规定迭代器必须有一个next方法，这个方法会返回一个对象，这个对象具有done和value两个属性，done表示当前迭代器内容是否已经执行完，执行完为true，否则为false，value表示当前步骤返回的值。在generator具体运用中，每次遇到yield关键字都会暂停执行，当调用迭代器的next时，会将yield后面表达式的值作为返回对象的value，比如上面生成器的执行结果如下:<br><img src="/image/generator%E7%94%9F%E6%88%90%E5%99%A8/1664795897786.png" alt="1664795897786"><br>我们可以看到第一次调next返回的就是第一个yeild后面表达式的值，也就是1。需要注意的是，整个迭代器目前暂停在了第一个yield这里，给变量a赋值都没执行，要调用下一个next的时候才会给变量a赋值，然后一直执行到第二个yield。那应该给a赋什么值呢？从代码来看，a的值应该是yield语句的返回值，但是yield本身是没有返回值的，或者说返回值是undefined，如果要给a赋值需要下次调next的时候手动传进去，我们这里传一个4，4就会作为上次yield的返回值赋给a:<br><img src="/image/generator%E7%94%9F%E6%88%90%E5%99%A8/1664795908411.png" alt="1664795908411"><br>可以看到第二个yield后面的表达式a + 2的值是6，这是因为我们传进去的4被作为上一个yield的返回值了，然后计算a + 2自然就是6了。<br>我们继续next，把这个迭代器走完：<br><img src="/image/generator%E7%94%9F%E6%88%90%E5%99%A8/1664795913662.png" alt="1664795913662"><br>上图是接着前面运行的，图中第一个next返回的value是NaN是因为我们调next的时候没有传参数，也就是说b为undefined，undefined + 3就为NaN了 。最后一个next其实是把函数体执行完了，这时候的value应该是这个函数return的值，但是因为我们没有写return，默认就是return undefined了，执行完后done会被置为true。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>迭代器还有个方法是throw，这个方法可以在函数体外部抛出错误，然后在函数里面捕获，还是上面那个例子:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">gen</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> a = <span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">let</span> b = <span class="keyword">yield</span> a + <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">yield</span> b + <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> itor = <span class="title function_">gen</span>();  </span><br></pre></td></tr></table></figure><p>我们这次不用next执行了，直接throw错误出来:<br><img src="/image/generator%E7%94%9F%E6%88%90%E5%99%A8/1664795946858.png" alt="1664795946858"><br>这个错误因为我们没有捕获，所以直接抛到最外层来了，我们可以在函数体里面捕获他，稍微改下:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">gen</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> a = <span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">let</span> b = <span class="keyword">yield</span> a + <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">yield</span> b + <span class="number">3</span>;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(e);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> itor = <span class="title function_">gen</span>();  </span><br></pre></td></tr></table></figure><p>然后再来throw下：<br><img src="/image/generator%E7%94%9F%E6%88%90%E5%99%A8/1664795968330.png" alt="1664795968330"><br>这个图可以看出来，错误在函数里里面捕获了，走到了catch里面，这里面只有一个console同步代码，整个函数直接就运行结束了，所以done变成true了，当然catch里面可以继续写yield然后用next来执行。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>迭代器还有个return方法，这个方法就很简单了，他会直接终止当前迭代器，将done置为true，这个方法的参数就是迭代器的value，还是上面的例子：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">gen</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> a = <span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">let</span> b = <span class="keyword">yield</span> a + <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">yield</span> b + <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> itor = <span class="title function_">gen</span>();</span><br></pre></td></tr></table></figure><p>这次我们直接调用return:<br><img src="/image/generator%E7%94%9F%E6%88%90%E5%99%A8/1664795994234.png" alt="1664795994234"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>iterator迭代器</title>
      <link href="/posts/a5155495/"/>
      <url>/posts/a5155495/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="遍历和迭代的区别"><a href="#遍历和迭代的区别" class="headerlink" title="遍历和迭代的区别"></a>遍历和迭代的区别</h2><p>迭代：从目标源依次按逐个抽取的方式来提取数据，其中目标源满足：</p><blockquote><p>1、有序的<br>2、连续的<br>遍历：没有这些要求，对于不同数据类型有着不同的遍历方式。</p></blockquote><h2 id="本质"><a href="#本质" class="headerlink" title="本质"></a>本质</h2><p>迭代器对象是一种接口，也可以说是一种规范。<br>为各种不同的数据结构提供统一的访问机制。<br>任何数据结构只要部署Iterator接口，就可以完成遍历操作。<br>本质上，就是一个指针对象。通过指针对象的next()，用来移动指针。</p><h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  [<span class="title class_">Symbol</span>.<span class="property">iterator</span>]:<span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ES6 规定，默认的 Iterator 接口部署在数据结构的Symbol.iterator属性上。<br>只要拥有了该属性，就能够用迭代器的方式进行遍历。</p></blockquote><h2 id="数组的Symbol-iterator属性"><a href="#数组的Symbol-iterator属性" class="headerlink" title="数组的Symbol.iterator属性"></a>数组的Symbol.iterator属性</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [&#123;<span class="attr">num</span>:<span class="number">1</span>&#125;, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">let</span> it = arr[<span class="title class_">Symbol</span>.<span class="property">iterator</span>]() <span class="comment">// 获取数组中的迭代器</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(it.<span class="title function_">next</span>()) <span class="comment">// &#123; value: Object &#123; num: 1 &#125;, done: false &#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(it.<span class="title function_">next</span>()) <span class="comment">// &#123; value: 2, done: false &#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(it.<span class="title function_">next</span>()) <span class="comment">// &#123; value: 3, done: false &#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(it.<span class="title function_">next</span>()) <span class="comment">// &#123; value: undefined, done: true &#125;</span></span><br></pre></td></tr></table></figure><h2 id="手动实现Symbol-iterator"><a href="#手动实现Symbol-iterator" class="headerlink" title="手动实现Symbol.iterator"></a>手动实现Symbol.iterator</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> make <span class="title class_">Iterator</span>(arr) &#123;</span><br><span class="line">  <span class="keyword">let</span> idx = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    next () &#123;</span><br><span class="line">      <span class="keyword">if</span>(idx &lt; arr.<span class="property">length</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="attr">value</span>: arr[idx++],</span><br><span class="line">          <span class="attr">done</span>: <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">value</span>: <span class="literal">undefined</span>,</span><br><span class="line">        <span class="attr">done</span>: <span class="literal">true</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="实现对象的自定义迭代器对象"><a href="#实现对象的自定义迭代器对象" class="headerlink" title="实现对象的自定义迭代器对象"></a>实现对象的自定义迭代器对象</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">b</span>: <span class="number">2</span>,</span><br><span class="line">  <span class="attr">c</span>: <span class="number">3</span>,</span><br><span class="line">  [<span class="title class_">Symbol</span>.<span class="property">iterator</span>] () &#123;</span><br><span class="line">    <span class="keyword">let</span> idx = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">let</span> mp = <span class="keyword">new</span> <span class="title class_">Map</span>([[‘a’, <span class="number">1</span>], [‘b’, <span class="number">2</span>], [’c’, <span class="number">3</span>]]);</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      next () &#123;</span><br><span class="line">        <span class="comment">// 获取键值对</span></span><br><span class="line">        <span class="keyword">let</span> mpEntries = […, mp.<span class="title function_">entries</span>()];</span><br><span class="line">        <span class="keyword">if</span>(idx &lt; arr.<span class="property">length</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">value</span>: mp[idx++],</span><br><span class="line">            <span class="attr">done</span>: <span class="literal">false</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="attr">value</span>: <span class="literal">undefined</span>,</span><br><span class="line">          <span class="attr">done</span>: <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Iterator接口"><a href="#Iterator接口" class="headerlink" title="Iterator接口"></a>Iterator接口</h2><p>iterator必须实现next方法，该方法每次被调用时返回一个迭代器结果。</p><ul><li>next()：被调用时返回一个iteratorResult对象</li><li>return()：被调用时返回一个iteratorResult对象，通常在调用者希望提前结束迭代时调用</li><li>throw()：被调用时返回一个iteratorResult对象，通常在调用者检测到错误时被调用</li></ul><h2 id="迭代器协议"><a href="#迭代器协议" class="headerlink" title="迭代器协议"></a>迭代器协议</h2><p>对象必须提供一个next()，执行该方法后 &#x3D;&gt; 要么返回迭代中的下一项，要么就引起一个Stopiteration异常，以终止迭代<br>next()返回一个对象，表示当前数据成员的信息。这个对象具有value和done两个属性</p><ul><li>value属性：迭代未完成时，返回当前位置的元素；迭代完成后，返回迭代器返回值或者缺省</li><li>done属性：一个布尔值，表示遍历是否结束，即是否还有必要再一次调用next()<br>  对于遍历器对象来说，done: false和value: undefined属性都是可以省略的。</li></ul><h2 id="遍历过程："><a href="#遍历过程：" class="headerlink" title="遍历过程："></a>遍历过程：</h2><ol><li>创建一个指针对象，指向当前数据结构的起始位置。</li><li>第一次调用指针对象的next方法，可以将指针指向数据结构的第一个成员。</li><li>第二次调用指针对象的next方法，指针就指向数据结构的第二个成员。</li><li>不断调用指针对象的next方法，直到它指向数据结构的结束位置。</li></ol><h2 id="迭代器的作用"><a href="#迭代器的作用" class="headerlink" title="迭代器的作用"></a>迭代器的作用</h2><ol><li>为各种数据结构，提供一个统一的、简便的访问接口</li><li>使得数据结构的成员能够按某种次序排列</li><li>ES6 创造了一种新的遍历命令for…of循环，Iterator 接口主要供for…of使用</li></ol><h2 id="原生具备-Iterator-接口的数据结构"><a href="#原生具备-Iterator-接口的数据结构" class="headerlink" title="原生具备 Iterator 接口的数据结构"></a>原生具备 Iterator 接口的数据结构</h2><p>可用<code>for..of</code>直接迭代出来的有:</p><ul><li><code>Array</code></li><li><code>Map</code></li><li><code>Set</code></li><li><code>String</code></li><li><code>TypedArray</code></li><li>函数的<code>arguments</code>（类数组对象）</li><li><code>DOM</code>中的<code>NodeList</code>（类数组对象）</li></ul><p>如果一个数据类型能迭代的话，会在原型上存在 Symbol(Symbol.iterator)方法</p><blockquote><p>总结：调用Symbol(Symbol.iterator)方法将会返回一个 迭代器对象，而这个迭代器对象具备 next() 方法，通过这个方法来实现逐步调用，同时每次调用的时候会返回一个对象，包括 value 和 done 两个属性，当value为 undefined，done 为 true 时迭代完成。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>跨域</title>
      <link href="/posts/58add7e9/"/>
      <url>/posts/58add7e9/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>跨域问题的解决方式<br>1、通过Jsonp<br>2、Document.domain + Iframe跨域<br>3、Iocation.hash + Iframe跨域<br>4、Window.name+Iframe跨域<br>5、PostMessage跨域<br>6、跨域资源共享（CORS）<br>7、nginx代理跨域<br>8、nodeJavaScripr中间代理跨域<br>9、WebSocket协议跨域</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>jQuery</title>
      <link href="/posts/3bf3e06d/"/>
      <url>/posts/3bf3e06d/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>jQuery<br>sass、less &#x3D;&gt; CSS预处理器<br>less：动态样式语言，给CSS赋予动态语言特性<br>动态语言特性：变量、继承、嵌套</p><p>跨域原因：<br>由于前后端分离 &#x3D;&gt; 前后端域名不一致 &#x3D;&gt; 出现跨越访问问题<br>同源策略 &#x3D;&gt; 只有协议 + 主机名 + 端口号相同（允许访问）</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ajax</title>
      <link href="/posts/c5a6a264/"/>
      <url>/posts/c5a6a264/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>AJAX &#x3D;&#x3D;&gt; 创建快速动态网页 &#x3D;&#x3D;&gt; 网页异步更新<br>核心：XMLHttpRequest对象<br>创建过程：</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhttp;</span><br><span class="line"><span class="keyword">if</span> (window.XMLHttpRequest) &#123;xhttp = <span class="keyword">new</span> <span class="type">XMLHttpRequest</span>;&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="comment">// code for IE5,IE6  </span></span><br><span class="line">  xhttp = <span class="keyword">new</span> <span class="type">ActiveXobject</span>(“Microsoft.XMLHTTP”);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Ajax使用过程（5个步骤）<br>1、创建XMLHTTPRequest对象<br>2、使用open方法创建http请求，并设置请求地址xhr.open(get&#x2F;post, url, asynchronous,true异步, false同步)<br>3、设置发送的数据，用send发送请求<br>4、注册事件（给Ajax设置事件）<br>5、获取响应并更新页面</p><p>AJAX的XMLHttpRequest对象方法</p><table><thead><tr><th align="center">方法</th><th>描述</th></tr></thead><tbody><tr><td align="center">new XMLHttpRequest()</td><td>创建新的XMLHttpRequest对象</td></tr><tr><td align="center">abort()</td><td>取消当前请求</td></tr><tr><td align="center">getAllResponseHeaders()</td><td>返回头部信息</td></tr><tr><td align="center">getResponseHeader()</td><td>返回特定的头部信息</td></tr><tr><td align="center">open(method, url, async, user, psw)</td><td>method：规定请求类型GET或POST<br />url：文件位置<br />async：true(异步)或false(同步)<br />user：可选的用户名<br />psw：可选的密码</td></tr><tr><td align="center">send()</td><td>将请求发送到服务器，用于GET 请求</td></tr><tr><td align="center">send(string)</td><td>将请求发送到服务器，用于POST 请求</td></tr><tr><td align="center">setRequestHeader()</td><td>向要发送的报头添加标签&#x2F;值对</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>class的继承</title>
      <link href="/posts/405302ea/"/>
      <url>/posts/405302ea/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>class的继承<br>JavaScript 实现继承是件麻烦事，构造函数继承有加上原型上的函数不能复用的问题；原型链继承又存在引用值属性的修改不独立的问题；组合继承又存在两次调用构造函数的问题，寄生组合继承，写起来又太麻烦了</p><p>class的继承围绕三点进行展开描述：extends实现继承，super()引用父类的构造函数，多重继承。<br>1、如何实现继承</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span>通过关键字<span class="keyword">extends</span>实现继承。具体操作步骤如下：</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Site</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">sitename</span> = name;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">present</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;我喜欢&#x27;</span> + <span class="variable language_">this</span>.<span class="property">sitename</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Runoob</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Site</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name, age</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(name);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">show</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">present</span>() + <span class="string">&#x27;, 它创建了 &#x27;</span> + <span class="variable language_">this</span>.<span class="property">age</span> + <span class="string">&#x27; 年。&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> noob = <span class="keyword">new</span> <span class="title class_">Runoob</span>(<span class="string">&quot;菜鸟教程&quot;</span>, <span class="number">5</span>);</span><br></pre></td></tr></table></figure><p>需要注意的点：</p><ul><li>子类必须在constructor方法中调用super方法<br>为什么必须要调用super方法呢？<br>这是因为这里的继承是先塑造父类，再塑造子类。也就是先将父类的东西都拿过来之后，再进行子类的添加。而super负责的就是将父类的东西拿过来。所以必须先调用super。</li><li>调用super之后才能使用this。也就是说在子类构造函数constructor里面，super函数要放在最上面。<br>为什么要这样呢？<br>刚才提到过，class的继承是先将父类拿过来再进行子类的添加，之前在讲借用构造函数实现继承的时候也提到过，如果想要给自身添加属性和方法，需要在调用call或者apply之后添加。否则如果存在同名属性，后面的会覆盖前面的。这里其实也是同样的道理。<br>2、super<br>class里面的super有两种使用方式，一种是当方法用，一种是当对象用。</li><li>当方法用<br>当方法用就像上面提到的，在constructor里面调用，负责将父类的实例属性拿过来。这个时候，super里面的this指向的是子类。<br>为什么这样呢？其实和借用构造函数实现继承是一样的，子类继承超类的实例属性时，就是通过call或者apply在子类调用超类构造函数。这个时候，this自然指向的就是子类。<br>还要注意一点 的是，其实上面也提到了，当方法用的时候，super必须放到constructor构造函数的最上层</li><li>当对象用<br>上一点说了，当方法用是为了将父类的实例属性继承过来(其实就是复制一份过来)。实例属性是拿到了，但方法呢，比如说有时候子类的方法想要调用父类的某个方法，这个时候要如何做？</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">name, age</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">age</span> = age</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">sayName</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Person&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="title function_">speak</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;speak&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Animal</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Person</span> &#123;</span><br><span class="line">    <span class="title function_">sayName</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">super</span>.<span class="title function_">sayName</span>() <span class="comment">// Person</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="title function_">speak</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">super</span>.<span class="title function_">speak</span>() <span class="comment">// speak</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> a = <span class="keyword">new</span> <span class="title class_">Animal</span>()</span><br><span class="line">a.<span class="title function_">sayName</span>()</span><br><span class="line"><span class="title class_">Animal</span>.<span class="title function_">speak</span>()</span><br></pre></td></tr></table></figure><p>这个时候，super作为对象的所用就体现出来了，通过它可以调用父类的方法(包括静态方法)。<br>注意，不同类型的方法要在不同类型的方法里面调用。有点绕，其实就是子类的静态方法里面通过super只能调用父类的静态方法，不能调用父类的原型方法。同理，子类的原型方法通过super也只能调用父类的原型方法，不能调用父类的静态方法。<br>有点像组合继承，super方法就是借用构造函数继承，继承实例属性，super对象就是原型链继承，继承原型上的属性和方法。也就是说super对象是无法访问父类的实例属性的。<br>那么还有一个问题，通过super调用父类的方法，那么该方法内的this指向的是谁呢？</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">name</span> = <span class="string">&#x27;Person&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">sayName</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Animal</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Person</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">super</span>()</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">name</span> = <span class="string">&#x27;Animal&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">sayName</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">super</span>.<span class="title function_">sayName</span>() <span class="comment">// Person</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/image/class%E7%9A%84%E7%BB%A7%E6%89%BF/1663857835921.png" alt="1663857835921"><br>结果就是，this指向的是当前类(子类)的实例。所以我们通过super对某个属性进行修改，修改的就是子类实例的属性。<br>3、多重继承<br>有些面向对象编程语言是支持多重继承(即一个子类继承多个父类)，如c++， py。java不支持多继承，但可以通过实现多接口或者内部类的方式实现类似的效果。es6的class继承本质上还是基于原型链的继承，所以也是不支持多继承的。但就像java那样，我们也可以通过其他方式达到相同或者类似的效果。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// class</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">type</span> = <span class="string">&#x27;Person&#x27;</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">age</span> = <span class="string">&#x27;18&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">sayName</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;说话&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">type</span> = <span class="string">&#x27;Animal&#x27;</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">age</span> = <span class="string">&#x27;19&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">eat</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;进食&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// mixin</span></span><br><span class="line"><span class="comment">// 多重继承 一个子类继承多个父类</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">mixin</span>(<span class="params">...mixins</span>) &#123;</span><br><span class="line">  <span class="keyword">class</span> <span class="title class_">Mix</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">let</span> mixin <span class="keyword">of</span> mixins) &#123;</span><br><span class="line">        <span class="comment">// 拷贝实例属性</span></span><br><span class="line">        <span class="title function_">copyProperties</span>(<span class="variable language_">this</span>, <span class="keyword">new</span> <span class="title function_">mixin</span>())</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> mixin <span class="keyword">of</span> mixins) &#123;</span><br><span class="line">    <span class="title function_">copyProperties</span>(<span class="title class_">Mix</span>, mixin) <span class="comment">// 拷贝静态属性</span></span><br><span class="line">    <span class="title function_">copyProperties</span>(<span class="title class_">Mix</span>.<span class="property"><span class="keyword">prototype</span></span>, mixin.<span class="property"><span class="keyword">prototype</span></span>) <span class="comment">// 拷贝原型属性</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Mix</span>&#125;<span class="keyword">function</span> <span class="title function_">copyProperties</span>(<span class="params">target, source</span>) &#123;</span><br><span class="line">  <span class="comment">// Reflect.ownKeys 返回所有属性key</span></span><br><span class="line">  <span class="comment">// Object.keys 返回属性key，不包括不可枚举属性</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> key <span class="keyword">of</span> <span class="title class_">Reflect</span>.<span class="title function_">ownKeys</span>(source)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (key !== <span class="string">&#x27;constructor&#x27;</span> &amp;&amp; key !== <span class="string">&#x27;prototype&#x27;</span> &amp;&amp; key !== <span class="string">&#x27;name&#x27;</span>) &#123;</span><br><span class="line">      <span class="comment">// Object.getOwnPropertyDescriptor 返回指定对象上一个自有属性对应的属性描述符。</span></span><br><span class="line">      <span class="comment">// 自有属性指的是直接赋予该对象的属性，不需要从原型链上进行查找的属性</span></span><br><span class="line">      <span class="comment">// 属性描述符指的是configurable、enumerable、writable、value这些</span></span><br><span class="line">      <span class="keyword">const</span> desc = <span class="title class_">Object</span>.<span class="title function_">getOwnPropertyDescriptor</span>(source, key)</span><br><span class="line">      <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(target, key, desc)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;&#125;<span class="keyword">class</span> <span class="title class_">Other</span> <span class="keyword">extends</span> <span class="title class_ inherited__">mixin</span>(<span class="title class_">Animal</span>, <span class="title class_">Person</span>) &#123;&#125;<span class="keyword">const</span> oo = <span class="keyword">new</span> <span class="title class_">Other</span>()</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(oo)</span><br></pre></td></tr></table></figure><p><img src="/image/class%E7%9A%84%E7%BB%A7%E6%89%BF/1663857864873.png" alt="1663857864873"><br>通过以上方式，也可以间接地实现类似多重继承的效果。</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> ES新特性 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 继承 </tag>
            
            <tag> ES6 </tag>
            
            <tag> class </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>class类</title>
      <link href="/posts/7ec024ea/"/>
      <url>/posts/7ec024ea/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>在es5中主要是通过构造函数方式和原型方式来定义一个类<br>在es6中可以通过class来定义类。<br>一个类只能拥有一个名为”constructor”构造函数，不能出现多个；<br>如果没有定义”constructor”构造函数，class会默认添加一个空的“constructor”构造函数。</p><h3 id="1、class类必须进行new调用，不能直接执行"><a href="#1、class类必须进行new调用，不能直接执行" class="headerlink" title="1、class类必须进行new调用，不能直接执行"></a>1、class类必须进行new调用，不能直接执行</h3><p>使用new调用类的构造函数会执行如下操作。<br>1.在内存中创建一个新对象；<br>2.这个新对象内部的[[Prototype]]指针被赋值为构造函数的prototype属性；<br>3.构造函数内部的this被赋值为这个新对象（即this指向新对象）；<br>4.执行构造函数内部的代码（给新对象添加属性）；<br>5.如果构造函数返回非空对象，则返回该对象；否则，返回刚创建的新对象；</p><h3 id="2、class类不存在变量提升"><a href="#2、class类不存在变量提升" class="headerlink" title="2、class类不存在变量提升"></a>2、class类不存在变量提升</h3><h3 id="3、class类无法遍历其实例原型链上的属性和方法"><a href="#3、class类无法遍历其实例原型链上的属性和方法" class="headerlink" title="3、class类无法遍历其实例原型链上的属性和方法"></a>3、class类无法遍历其实例原型链上的属性和方法</h3><p>不可枚举</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ES6</span> &#123;</span><br><span class="line"><span class="title function_">constructor</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line"><span class="title function_">newTest</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line"><span class="title function_">newTest2</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">keys</span>(<span class="title class_">ES6</span>.<span class="property"><span class="keyword">prototype</span></span>) <span class="comment">// [ ]</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">getOwnPropertyNames</span>(<span class="title class_">ES6</span>.<span class="property"><span class="keyword">prototype</span></span>)<span class="comment">// [&quot;constructor&quot;,&quot;newTest&quot;,&quot;newTest2&quot;]</span></span><br></pre></td></tr></table></figure><h3 id="4、new-target属性"><a href="#4、new-target属性" class="headerlink" title="4、new.target属性"></a>4、new.target属性</h3><p>es6为new命令引入了一个new.target属性，它会返回new命令作用于的那个构造函数。<br>如果不是通过new调用或Reflect.construct()调用的，new.target会返回undefined</p><h3 id="5、class类有static静态方法"><a href="#5、class类有static静态方法" class="headerlink" title="5、class类有static静态方法"></a>5、class类有static静态方法</h3><p>static静态方法只能通过类调用，不会出现在实例上；<br>静态方法包含 this 关键字，这个 this 指的是类，而不是实例<br>static声明的静态属性和方法都可以被子类继承。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">bar</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`this <span class="subst">$&#123;<span class="variable language_">this</span>&#125;</span>`</span>)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">baz</span>(); <span class="comment">// 此处的this指向类</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">baz</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;hello&#x27;</span>); <span class="comment">// 不会出现在实例中</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">baz</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;world&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> foo = <span class="keyword">new</span> <span class="title class_">Foo</span>();</span><br><span class="line">foo.<span class="title function_">bar</span>() <span class="comment">// undefined</span></span><br><span class="line">foo.<span class="title function_">baz</span>() <span class="comment">// world</span></span><br><span class="line"><span class="title class_">Foo</span>.<span class="title function_">bar</span>() <span class="comment">// this Foo hello </span></span><br></pre></td></tr></table></figure><p>getter 与 setter <br>在 class 内部可以使用 get 与 set 关键字，对某个属性设置存值函数和取值函数，拦截该属性的存取行为。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span> (test) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">test</span> = test || <span class="string">&#x27;默认值&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    get prop () &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">test</span></span><br><span class="line">    &#125;</span><br><span class="line">    set prop (value) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`setter prop value: <span class="subst">$&#123;value&#125;</span>`</span>)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">test</span> = value</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> p = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">p.<span class="property">prop</span> <span class="comment">// 1</span></span><br><span class="line">p.<span class="property">prop</span> = <span class="string">&#x27;2&#x27;</span> <span class="comment">// setter prop value: 2</span></span><br><span class="line">p.<span class="property">prop</span> <span class="comment">// 2</span></span><br></pre></td></tr></table></figure><p>默认严格模式<br>内部定义inside<br>立即执行<br>二次声明<br>实例无法调用static<br>static this指向类<br>继承包含static<br>Class内部只有静态方法，没有静态属性</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> ES新特性 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ES6 </tag>
            
            <tag> class </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>尾调用</title>
      <link href="/posts/44a5189f/"/>
      <url>/posts/44a5189f/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="尾调用"><a href="#尾调用" class="headerlink" title="尾调用"></a>尾调用</h2><p>定义：在执行某个函数时，如果最后一步是一个函数调用，并且被调用函数的返回值直接被函数返回，被称为尾调用。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">g</span>();<span class="comment">// 尾调用</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以下两种情况，都不属于尾调用。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 情况一</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params">x</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> y = <span class="title function_">g</span>(x);</span><br><span class="line"><span class="keyword">return</span> y;&#125;</span><br><span class="line"><span class="comment">// 情况二</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params">x</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">g</span>(x) + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="尾调用优化"><a href="#尾调用优化" class="headerlink" title="尾调用优化"></a>尾调用优化</h2><p>函数调用会在内存中形成一个”调用记录”，又称”调用帧”，保存调用位置和内部变量等信息。</p><ol><li>函数A内部调用函数B，那么在A的调用记录上方，会形成一个B的调用记录。</li><li>等到B运行结束，将结果返回到函数A，B的调用记录才会消失。</li><li>如果函数B内部还调用了函数C，那还有一个C的调用记录栈，以此类推。</li><li>所有的调用记录形成一个”调用栈”。<br><img src="/image/%E5%B0%BE%E8%B0%83%E7%94%A8/1663855333356.png" alt="1663855333356"><br>尾调用由于是函数的最后一步操作，所以不需要保留外层函数的调用记录，因为调用位置、内部变量等信息都不会再用到了，只要直接用内层函数的调用记录，取代外层函数的调用记录就可以了。<br>尾调用的要求</li><li>尾调用不需要访问当前stackframe中的变量，也就是没有闭包。</li><li>返回到尾调用处时，不用再做其他事情。</li><li>尾调用的返回值，直接返回给调用它所在函数的调用者。</li></ol><p>ES6的尾调用优化只在严格模式下开启，正常模式是无效的。</p><blockquote><p>因为在正常模式下，函数内部有两个变量，可以跟踪函数的调用栈。</p><ul><li>arguments：返回调用时函数的参数。</li><li>func.caller：返回调用当前函数的那个函数。<br>严格模式下开启尾调用优化，函数的调用栈会改写，从而会禁用这两个变量，所以尾调用模式仅在严格模式下生效。</li></ul></blockquote>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 函数式编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 尾调用 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>symbol</title>
      <link href="/posts/ecc836f9/"/>
      <url>/posts/ecc836f9/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Symbol<br>由于symbol值是唯一的，可以避免<strong>为对象添加属性时 属性名产生冲突</strong>。</p><p>共享Symbol<br>Symbol.for()：在不同的地方使用同一个symbol，用来当作不同对象的唯一标识符</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> uid = <span class="title class_">Symbol</span>.<span class="title function_">for</span>(<span class="string">&quot;uid&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> object = &#123;</span><br><span class="line">[uid]:<span class="string">&quot;12345&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(object[uid]);<span class="comment">// &quot;12345&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(uid);<span class="comment">// Symbol(uid)</span></span><br><span class="line"><span class="keyword">let</span> uid2 = <span class="title class_">Symbol</span>.<span class="title function_">for</span>(<span class="string">&quot;uid&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(uid === uid2);<span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(object[uid2]);<span class="comment">// &quot;12345&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(uid2);<span class="comment">// Symbol(uid)</span></span><br></pre></td></tr></table></figure><p>SymbolkeyFor()：查找和某个symbol关联的key值。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> uid = <span class="title class_">Symbol</span>.<span class="title function_">for</span>(<span class="string">&quot;uid&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Symbol</span>.<span class="title function_">keyFor</span>(uid));<span class="comment">// &quot;uid&quot;</span></span><br><span class="line"><span class="keyword">let</span> uid2 = <span class="title class_">Symbol</span>.<span class="title function_">for</span>(<span class="string">&quot;uid&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Symbol</span>.<span class="title function_">keyFor</span>(uid2));<span class="comment">// &quot;uid&quot;</span></span><br><span class="line"><span class="keyword">let</span> uid3 = <span class="title class_">Symbol</span>(<span class="string">&quot;uid&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Symbol</span>.<span class="title function_">keyFor</span>(uid3));<span class="comment">// undefined</span></span><br></pre></td></tr></table></figure><p>ObjectgetOwnPropertySymbols()：查找对象的symbol属性。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> id = <span class="title class_">Symbol</span>.<span class="title function_">for</span>(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> object = &#123;[id]:<span class="string">&#x27;123&#x27;</span>&#125;;</span><br><span class="line"><span class="keyword">let</span> symbols =0bject.<span class="title function_">getOwnPropertySymbols</span>(obiect);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(symbols.<span class="property">length</span>);<span class="comment">// 1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(symbols[<span class="number">0</span>]);<span class="comment">// Symbol(id)</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(object[symbols[<span class="number">0</span>]]);<span class="comment">// &#x27;123&#x27;</span></span><br></pre></td></tr></table></figure><p>es6的内置symbol<br>es6内置了11个symbol，叫well-known symbol,它们都是Symbol函数的属性，指向语言内部使用的方法或属性。通过它们可以更改语言的原生行为。<br><img src="/image/symbol/1663854576292.png" alt="1663854576292"></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> ES新特性 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ES6 </tag>
            
            <tag> Symbol </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>模板字面量</title>
      <link href="/posts/bb45ebf5/"/>
      <url>/posts/bb45ebf5/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>定义：允许嵌入表达式的字符串字面量，可以使用多行字符串和字符串插值功能。可以保留反引号内的空格和换行符。</p><blockquote><p>开始和结尾的空格换行符可以通过trim方法去除</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> str = <span class="string">`</span></span><br><span class="line"><span class="string">hello world`</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str)<span class="comment">// \nhello world</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str.<span class="title function_">trim</span>())<span class="comment">// hello world</span></span><br></pre></td></tr></table></figure><blockquote><p>严格意义上来说，模板字面量不是字符串，而是一种特殊的JavaScript表达式。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">`string text`</span></span><br><span class="line"></span><br><span class="line"><span class="string">`string text line 1</span></span><br><span class="line"><span class="string">string text line 2`</span></span><br><span class="line"></span><br><span class="line"><span class="string">`string text <span class="subst">$&#123;expression&#125;</span> string text`</span></span><br><span class="line">tag <span class="string">`string text <span class="subst">$&#123;expression&#125;</span> string text&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> multiLineStr = <span class="string">&#x27;&#x27;</span> + </span><br><span class="line">  <span class="string">`&lt;pre&gt;&#x27; + </span></span><br><span class="line"><span class="string">  `</span>    &lt;code <span class="keyword">class</span>=<span class="string">&quot;sb&quot;</span>&gt;<span class="title class_">This</span> is&lt;/code&gt;<span class="string">` +</span></span><br><span class="line"><span class="string">  `</span>    &lt;code <span class="keyword">class</span>=<span class="string">&quot;sb&quot;</span>&gt;a string&lt;/code&gt;<span class="string">&#x27; + </span></span><br><span class="line"><span class="string">  `    &lt;code class=&quot;sb&quot;&gt;with multiple&lt;/code&gt;&#x27;</span> + </span><br><span class="line">  <span class="string">`    &lt;code class=&quot;sb&quot;&gt;lines&lt;/code&gt;&#x27; + </span></span><br><span class="line"><span class="string">  `</span>    &lt;code <span class="keyword">class</span>=<span class="string">&quot;p&quot;</span>&gt;;&lt;/code&gt;<span class="string">&#x27; + </span></span><br><span class="line"><span class="string">  `&lt;/pre&gt;&#x27;</span>;</span><br></pre></td></tr></table></figure><p>支持所有合法的JavaScript表达式，包括函数调用等。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> getName = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&#x27;john&#x27;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`my name is <span class="subst">$&#123;getName()&#125;</span>`</span>);</span><br></pre></td></tr></table></figure><p>插值表达式支持嵌套</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> classes = <span class="string">`header <span class="subst">$&#123; isLargeScreen()</span></span></span><br><span class="line"><span class="subst"><span class="string">? <span class="string">``</span></span></span></span><br><span class="line"><span class="subst"><span class="string">: <span class="string">`icon-<span class="subst">$&#123;(isCollapsed? <span class="string">&#x27;expander`: &#x27;</span>collapser<span class="string">&#x27;)&#125;`&#125;`;</span></span></span></span></span></span><br></pre></td></tr></table></figure><h3 id="模板字面量-tagged-template"><a href="#模板字面量-tagged-template" class="headerlink" title="模板字面量:tagged template"></a>模板字面量:tagged template</h3><p>最前面可以跟一个函数，这个函数叫模板字符串的tag。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">tag</span>(<span class="params">literals, ...substitutions</span>) &#123;</span><br><span class="line">    <span class="comment">// return a string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>模板字面量:tagged template示例</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person = <span class="string">&#x27;Mike&#x27;</span>;</span><br><span class="line"><span class="keyword">let</span> age = <span class="number">28</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">myTag</span>(<span class="params">strings, personExp,ageExp</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> str0 = strings[<span class="number">0</span>]; <span class="comment">// &quot;that &quot;</span></span><br><span class="line">    <span class="keyword">let</span> str1 = strings[<span class="number">1</span>]; <span class="comment">// &quot; is a &quot;</span></span><br><span class="line">    <span class="comment">// 最后还有一项，不过它的值是空字符串 &#x27; &#x27;</span></span><br><span class="line">    <span class="comment">// let str2 =strings[2];</span></span><br><span class="line">    <span class="keyword">let</span> ageStr;</span><br><span class="line">    <span class="keyword">if</span> (ageExp &gt; <span class="number">99</span>) &#123;</span><br><span class="line">        ageStr = <span class="string">&#x27;centenarian&#x27;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        ageStr = <span class="string">&#x27;youngster&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> str0 + personExp + str1 + ageStr;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> output = myTag<span class="string">`that <span class="subst">$&#123;person&#125;</span> is a <span class="subst">$&#123;age&#125;</span>`</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(output); <span class="comment">// that Mike is a youngster</span></span><br></pre></td></tr></table></figure><h3 id="模板字面量-原始字符串值-raw-value"><a href="#模板字面量-原始字符串值-raw-value" class="headerlink" title="模板字面量:原始字符串值(raw value)"></a>模板字面量:原始字符串值(raw value)</h3><p>tag函数的第一个参数，还有一个raw属性，它的值是模板字符串被转义之前的值，也可以使用内置的 String.raw方法。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> message1 =<span class="string">`Multiline\nstring`</span>;</span><br><span class="line"><span class="title class_">Let</span> message2 = <span class="title class_">String</span>.<span class="property">raw</span><span class="string">`Multiline\nstring`</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(message1);<span class="comment">// &quot;Multiline</span></span><br><span class="line">                        <span class="comment">// string&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(message2);<span class="comment">// &quot;Multilinel\nstring&quot;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> ES新特性 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ES6 </tag>
            
            <tag> 模板字面量 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Modules</title>
      <link href="/posts/e10a7a4b/"/>
      <url>/posts/e10a7a4b/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="Modules语法-amp-特性"><a href="#Modules语法-amp-特性" class="headerlink" title="Modules语法&amp;特性"></a>Modules语法&amp;特性</h2><p>模块功能主要由两个命令构成：<code>export</code>和 <code>import</code>。<br>**<code>export</code>**命令：规定模块的对外接口<br>**<code>import</code>**命令：输入其他模块提供的功能</p><p>export命令</p><p>一个modules模块就是一个独立的文件。该文件内部的所有变量，外部无法获取到。</p><blockquote><p>如果希望外部能够读取模块内部的某个变量，就必须使用<strong>export</strong>关键字输出该变量。</p></blockquote><p>案例如下，一个JS文件使用<strong>export</strong>命令输出变量。</p><p>写法一</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// profile.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">var</span> firstName = <span class="string">&#x27;Michael&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">var</span> lastName = <span class="string">&#x27;Jackson&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">var</span> year = <span class="number">1958</span>;</span><br></pre></td></tr></table></figure><p>上面代码是<strong>profile.js</strong>文件，保存了用户信息。</p><blockquote><p>ES6 将其视为一个模块，里面用<strong>export</strong>命令对外部输出了三个变量。</p></blockquote><p>写法二</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// profile.js</span></span><br><span class="line"><span class="keyword">var</span> firstName = <span class="string">&#x27;Michael&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> lastName = <span class="string">&#x27;Jackson&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> year = <span class="number">1958</span>;</span><br><span class="line"><span class="keyword">export</span>  &#123; firstName, lastName, year &#125;;</span><br></pre></td></tr></table></figure><p>在<strong>export</strong>命令后面，使用大括号指定所要输出的一组变量。</p><blockquote><p>与写法一（直接放置在<strong>var</strong>语句前）等价</p></blockquote><blockquote><p>但是应该优先考虑使用写法二。</p></blockquote><blockquote><p>因为可以在脚本尾部，直接知道输出了哪些变量。</p></blockquote><p><strong>as</strong>关键字重命名</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">v1</span>(<span class="params"></span>) &#123; ... &#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">v2</span>(<span class="params"></span>) &#123; ... &#125;</span><br><span class="line"><span class="keyword">export</span> &#123;</span><br><span class="line">  v1 <span class="keyword">as</span> streamV1,</span><br><span class="line">  v2 <span class="keyword">as</span> streamV2,</span><br><span class="line">  v2 <span class="keyword">as</span> streamLatestVersion</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="import-命令"><a href="#import-命令" class="headerlink" title="import 命令"></a>import 命令</h2><p>使用<strong>export</strong>命令定义了模块的对外接口以后，其他 JS 文件就可以通过<strong>import</strong>命令加载这个模块。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; firstName, lastName, year &#125; <span class="keyword">from</span> <span class="string">&#x27;./profile.js&#x27;</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">setName</span>(<span class="params">element</span>) &#123;</span><br><span class="line">  element.<span class="property">textContent</span> = firstName + <span class="string">&#x27; &#x27;</span> + lastName;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上面代码的<strong>import</strong>命令，用于加载<strong>profile.js</strong>文件，并从中输入变量。</p><p><strong>import</strong>命令接受一对大括号，里面指定要从其他模块导入的变量名。</p><p>大括号里面的变量名，必须与被导入模块（<strong>profile.js</strong>）对外接口的名称相同。</p><p>如果想为输入的变量重新取一个名字，<strong>import</strong>命令要使用<strong>as</strong>关键字，将输入的变量重命名。</p><p><code>import &#123; lastName as surname &#125; from &#39;./profile.js&#39;;</code></p><p><img src="/image/Modules/1663853855311.png" alt="1663853855311"></p><p><img src="/image/Modules/1663853861302.png" alt="1663853861302"></p><p><img src="/image/Modules/1663853869366.png" alt="1663853869366"></p><p><img src="/image/Modules/1663853876561.png" alt="1663853876561"></p><p><img src="/image/Modules/1663853881292.png" alt="1663853881292"></p><p><img src="/image/Modules/1663853886119.png" alt="1663853886119"></p><h2 id="Modules特性"><a href="#Modules特性" class="headerlink" title="Modules特性"></a>Modules特性</h2><ul><li>以接口方式曝露，采用引用的方式;</li><li>Module中也可以import</li><li>模块中this是无意义，且模块单独一作用域，外部不可见</li><li>同一个模块被引用多次，只执行一次</li></ul><h2 id="Modules加载机制"><a href="#Modules加载机制" class="headerlink" title="Modules加载机制"></a>Modules加载机制</h2><p>1、异步加载 async</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;module&quot;</span> <span class="attr">src</span>=<span class="string">&quot;test.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--对于type=module的时候，默认异步加载 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 加载完成，渲染引擎就会中断渲染立即执行。此外，执行完成后，再恢复渲染 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;module&quot;</span> <span class="attr">src</span>=<span class="string">&quot;test.js&quot;</span> <span class="attr">async</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>2、延迟加载 defer</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;module&quot;</span> <span class="attr">src</span>=<span class="string">&quot;test.is&quot;</span> <span class="attr">defer</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Modules错误范例和正确实践"><a href="#Modules错误范例和正确实践" class="headerlink" title="Modules错误范例和正确实践"></a>Modules错误范例和正确实践</h2><p>Modules正确实践</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">var</span> b = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">export</span> &#123;a, b&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>)&#123;&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> &#123;&#125;;</span><br></pre></td></tr></table></figure><p>错误案例</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>)&#123;&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> &#123;&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">var</span> a = <span class="number">1</span>;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> ES新特性 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ES6 </tag>
            
            <tag> Modules模块 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>内容布局方式-rem适配布局</title>
      <link href="/posts/7436eeb6/"/>
      <url>/posts/7436eeb6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>rem适配布局——[混合布局]<br>rem是CSS的长度单位，相当于元素对的font-size的相对值<br>假如</p><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">html&#123;</span><br><span class="line">  font-size: 20px; </span><br><span class="line">&#125;</span><br><span class="line">=<span class="language-ruby">=&gt; 1rem = 20px</span></span><br></pre></td></tr></table></figure><p>rem会随着设备的大小变化而发生相应的改变<br>解决了流式布局和flex布局不能变化高度的问题</p><ol><li>rem + 媒体查询技术<br>&#x3D;&#x3D;&gt; 实现元素大小动态变化</li><li>rem + flexible.is（淘宝技术）<br>将页面的一行分成10份，可以快速布局<br>&#x3D;&#x3D;&gt; 实现元素大小动态变化</li></ol>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> CSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> rem适配布局 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Html-标签粗解</title>
      <link href="/posts/9044f2a4/"/>
      <url>/posts/9044f2a4/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><code>&lt;a&gt;&lt;/a&gt;</code><br>作用：</p><ul><li>另一个文档</li><li>文档内部</li><li>Email地址</li><li>电话号码</li></ul><p>属性</p><ul><li><code>href</code></li><li><code>target</code></li><li><code>download</code></li><li><code>hreflang</code></li><li><code>rel</code></li><li><code>rev</code></li><li><code>type</code></li><li><code>referrerpolicy</code></li></ul><p>target中属性值</p><ul><li>_self</li><li>_blank</li><li>_parent</li><li>_top</li></ul><p>举例：<br>创建锚点<br><code>&lt;a href=&quot;#&quot;&gt;×××&lt;/a&gt;</code><br>链接Email地址<br><code>&lt;a href=&quot;mailto:1078857679@qq.com&quot;&gt;×××&lt;/a&gt;</code><br>链接电话<br><code>&lt;a href=&quot;tel:15651005256&quot;&gt;×××&lt;/a&gt;</code><br>文件下载<br><code>&lt;a href=&quot;/keyboard-shortcuts.pdf&quot; download&gt;×××&lt;/a&gt;</code><br><code>&lt;blockquote&gt;&lt;/blockquote&gt;</code></p><ul><li>引用内容</li><li>属性<ul><li>cite<br><code>&lt;em&gt;&lt;/em&gt;</code><br>强调，需要用户着重阅读的内容</li></ul></li><li>默认斜体</li><li>可以嵌套<br><code>&lt;strong&gt;&lt;/strong&gt;</code><br>严重&#x2F;重要&#x2F;紧急的内容</li><li>标题、警告、注意事项、指示性内容</li><li>默认粗体</li><li>可以嵌套<br><code>&lt;span&gt;&lt;/span&gt;</code><br>无任何特殊含义</li><li>行内容器</li><li>样式<br><code>&lt;img&gt;</code><br>图像<br>属性</li><li>src</li><li>alt</li><li>width</li><li>height</li><li>srcset    宽度描述符</li><li>sizes<br>插入图片<br>picture容器 + source<br>source属性</li><li>srcset</li><li>type</li><li>sizes</li><li>media<br>图片热点<br>area属性</li><li>download</li><li>hreflang</li><li>rel</li><li>target</li><li>type</li><li>referrerpolicy<br><code>&lt;video&gt;&lt;/video&gt;</code><br>视频、影片、带字幕的音频<br>属性</li><li>src</li><li>width</li><li>height</li><li>poster</li><li>preload</li><li>autoplay</li><li>loop</li><li>muted</li><li>controls</li><li>crossorigin<br>内嵌标签<br>source</li><li>src</li><li>type<br>track</li><li>kind<ul><li>subtitles</li><li>captions</li><li>descriptions</li><li>chapters</li><li>metadata</li></ul></li><li>srcset</li><li>srclang</li><li>label</li><li>default<br><code>&lt;audio&gt;&lt;/audio&gt;</code><br>音频<br>属性</li><li>src</li><li>preload</li><li>autoplay</li><li>loop</li><li>muted</li><li>controls</li><li>crossorigin<br><code>&lt;iframe&gt;&lt;/iframe&gt;</code><br>内嵌的浏览上下文<br>另一个HTML页面嵌入到当前页面中<br>属性</li><li>src</li><li>width</li><li>height</li><li>name</li><li>sandbox<ul><li>allow-forms</li><li>allow-pointer-lock</li><li>allow-popups</li><li>allow-presentation</li><li>allow-same-origin</li><li>allow-scripts</li><li>allow-top-navigation<br><code>&lt;form&gt;&lt;/form&gt;</code><br>label<br>input<br>fieldset<br>select<br>textarea<br>button<br>output<br>object<br>meter<br>progressimg</li></ul></li><li>label<br>表单控件的标题</li><li>select<br>列表选择器</li><li>不加      默认单选</li><li>multiple  多选模式配置</li><li>size&#x3D;”4”  单选（四选一）</li></ul><p>状态禁用<br>选择器禁用<code>&lt;select disabled&gt;</code><br>选项禁用<code>&lt;option disabled&gt;</code><br>选项组禁用<code>&lt;optgroup disabled&gt;</code></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> Html </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Html </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>前端面试题</title>
      <link href="/posts/20802113/"/>
      <url>/posts/20802113/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h2><h3 id="语义话的目的是什么？"><a href="#语义话的目的是什么？" class="headerlink" title="语义话的目的是什么？"></a>语义话的目的是什么？</h3><p>语义化的主要目的可以概括为用正确的标签做正确的事</p><p>HTMl语义化可以让页面的内容结构化，以便于浏览器解析和搜索引擎解析，<br>并且提高了代码的可读性便于代码维护，</p><h3 id="HTML5新增元素"><a href="#HTML5新增元素" class="headerlink" title="HTML5新增元素"></a>HTML5新增元素</h3><p>Canvas绘图以及SVG绘图。<br>拖放（Drag and drop）API<br>语义化标签（header、nav、footer、article、section）<br>音频、视频（audio、video）API<br>地理定位（Geolocation）<br>本地离线存储（localStorage）,长期存储数据，关闭浏览器后不丢失。<br>会话储存（sessionStorage）,数据在关闭浏览器后自动删除。<br>表单控件（calendar、date、time、email、url、search）</p><h3 id="cookie与sessionStorage和localStorage的区别"><a href="#cookie与sessionStorage和localStorage的区别" class="headerlink" title="cookie与sessionStorage和localStorage的区别"></a>cookie与sessionStorage和localStorage的区别</h3><ul><li>保存方式<ul><li>cookie存放在客户的浏览器上。</li><li>session都在客户端中保存，不参与服务器通讯。</li></ul></li><li>生命周期<ul><li>cookie可设置失效时间</li><li>localStorage除非手动清除否则永久保存</li><li>sessionStorage关闭当前页面或浏览器后失效</li></ul></li><li>存储的大小<ul><li>cookie 4kb左右</li><li>session 5M</li></ul></li><li>易用性<ul><li>cookie需自己封装</li><li>session可以接受原生接口</li></ul></li></ul><p>因为cookie每次请求都会携带在http请求中,所以它的主要用来识别用户登录,localStorage可以用来跨页面传参,sessionStorage可以用来保留一些临时数据。</p><h2 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h2><h3 id="CSS有哪些基本的选择器，执行先后顺序？"><a href="#CSS有哪些基本的选择器，执行先后顺序？" class="headerlink" title="CSS有哪些基本的选择器，执行先后顺序？"></a>CSS有哪些基本的选择器，执行先后顺序？</h3><p>id选择器 &#x3D;&gt; #myId {}<br>类选择器 &#x3D;&gt; .myClass {}<br>标签选择器 &#x3D;&gt; p,h1 {}<br>后代选择器 &#x3D;&gt; div h1 {}<br>子选择器 &#x3D;&gt; div&gt;h1 {}<br>兄弟选择器(所有的兄弟) &#x3D;&gt; ul~h1 {}<br>相邻兄弟选择器 &#x3D;&gt; ul+h1 {}<br>属性选择器 &#x3D;&gt; li[name&#x3D;’sss’] {}<br>伪类选择器 &#x3D;&gt; h1:hover {}<br>伪元素选择器 &#x3D;&gt; h1::before{}<br>通配符选择器* &#x3D;&gt; * {}</p><p>!important&gt;内联样式（非选择器）&gt;ID选择器&gt;类选择器&gt;标签选择器&gt;通配符选择器（*）</p><h3 id="垂直水平居中方式有哪些？"><a href="#垂直水平居中方式有哪些？" class="headerlink" title="垂直水平居中方式有哪些？"></a>垂直水平居中方式有哪些？</h3><h3 id="常用布局方式有哪些？什么是盒模型？"><a href="#常用布局方式有哪些？什么是盒模型？" class="headerlink" title="常用布局方式有哪些？什么是盒模型？"></a>常用布局方式有哪些？什么是盒模型？</h3><h3 id="常用的块元素与行内元素有哪些？有什么特征"><a href="#常用的块元素与行内元素有哪些？有什么特征" class="headerlink" title="常用的块元素与行内元素有哪些？有什么特征"></a>常用的块元素与行内元素有哪些？有什么特征</h3><p>块元素：div、h1~h6、ul、li、table、p、br、form。<br>特征：独占一行，换行显示，可以设置宽高，可以嵌套块和行</p><p>行内元素：span、a、img、textarea、select、option、input。<br>特征：只有在行内显示，内容撑开宽、高，不可以设置宽、高（img、input、textarea等除外）。</p><h3 id="清除浮动"><a href="#清除浮动" class="headerlink" title="清除浮动"></a>清除浮动</h3><p>父级div定义overflow:hidden（如果父级元素有定位元素超出父级，超出部分会隐藏，）<br>给浮动元素父级增加标签（由于新增标签会造成不必要的渲染，不建议使用）<br>伪元素清除浮动：给浮动元素父级增加 .clearfix::after（content: ‘’; display: table;<br>clear: both;）（不会新增标签，不会有其他影响，）</p><h3 id="CSS3新特征"><a href="#CSS3新特征" class="headerlink" title="CSS3新特征"></a>CSS3新特征</h3><p>圆角（border-radius）<br>阴影（box-shadow）<br>文字特效(text-shadow)<br>线性渐变（gradient）<br>变换(transform)<br>更多的CSS选择器<br>更多背景设置（background）<br>色彩模式（rgba）<br>伪元素（::selection）<br>媒体查询（@media）<br>多栏布局（column）<br>图片边框（border-image）</p><h3 id="CSS中有哪些长度单位？"><a href="#CSS中有哪些长度单位？" class="headerlink" title="CSS中有哪些长度单位？"></a>CSS中有哪些长度单位？</h3><p>绝对长度单位：px<br>百分比: %<br>相对父元素字体大小单位: em<br>相对于根元素字体大小的单位: rem<br>相对于视口<em>宽度的百分比（100vw即视窗宽度的100%）: vw<br>相对于视口</em>高度的百分比（100vh即视窗高度的100%）: vh</p><h3 id="px、em、rem的区别"><a href="#px、em、rem的区别" class="headerlink" title="px、em、rem的区别"></a>px、em、rem的区别</h3><h3 id="display-none和visibility-hidden的区别"><a href="#display-none和visibility-hidden的区别" class="headerlink" title="display:none和visibility:hidden的区别"></a>display:none和visibility:hidden的区别</h3><p>display:none：隐藏元素，在文档布局中不在给它分配空间（从文档中移除），会引起回流（重排）<br>visibility:hidden: 隐藏元素，但是在文档布局中仍保留原来的空间（还在文档中），不会引起回流（重绘）</p><h3 id="用CSS-实现三角形"><a href="#用CSS-实现三角形" class="headerlink" title="用CSS 实现三角形"></a>用CSS 实现三角形</h3><h3 id="伪类和伪元素的区别"><a href="#伪类和伪元素的区别" class="headerlink" title="伪类和伪元素的区别"></a>伪类和伪元素的区别</h3><h3 id="什么是重绘，重排？如何解决？"><a href="#什么是重绘，重排？如何解决？" class="headerlink" title="什么是重绘，重排？如何解决？"></a>什么是重绘，重排？如何解决？</h3><h4 id="重绘（repaint-x2F-redraw）"><a href="#重绘（repaint-x2F-redraw）" class="headerlink" title="重绘（repaint&#x2F;redraw）"></a>重绘（repaint&#x2F;redraw）</h4><p>某个dom节点的颜色，背景颜色变了，字体大小，只影响自己，不影响其他元素。</p><p>注意：table及其内部元素可能需要多次计算才能确定好其在渲染树中节点的属性，比同等元素要多花两倍时间，这就是我们尽量避免使用table布局页面的原因之一。</p><h4 id="重排（回流-x2F-reflow-x2F-重构）"><a href="#重排（回流-x2F-reflow-x2F-重构）" class="headerlink" title="重排（回流&#x2F;reflow&#x2F;重构）"></a>重排（回流&#x2F;reflow&#x2F;重构）</h4><p>某个dom节点的宽高，布局，隐藏等发生改变，不仅自身发生了改变，而且其他元素也会受到影响随之发生改变。每个页面最少一次回流，就是页面第一次加载的时候。</p><h4 id="触发重排的原因"><a href="#触发重排的原因" class="headerlink" title="触发重排的原因"></a>触发重排的原因</h4><p>页面初始化渲染（无可避免）<br>添加或删除可见的DOM元素<br>元素尺寸的改变——大小，外边距；边框<br>浏览器窗口尺寸的变化<br>填充内容的改变，比如文本的改变或图片大小改变而引起的计算值宽度和高度的改变<br>读取某些元素属性：（offsetLeft&#x2F;Top&#x2F;Height&#x2F;Width,　clientTop&#x2F;Left&#x2F;Width&#x2F;Height,　scrollTop&#x2F;Left&#x2F;Width&#x2F;Height,　width&#x2F;height,　getComputedStyle(), currentStyle(IE))</p><blockquote><p>1.重绘不一定重排，但是重排一定会重绘<br>2.重绘和重排的成本都是非常高的，要尽量减少dom的增删改</p></blockquote><h4 id="如何解决"><a href="#如何解决" class="headerlink" title="如何解决"></a>如何解决</h4><p>不要直接操作样式，先设置好class，然后修改DOM的className;<br>position:absolute 与flex 不会导致重排<br>不要把DOM 节点的属性放在一个循环当成循环的变量；<br>需要动画的元素脱离文档流；<br>不使用table 布局，<br>尽量不修改影响范围比较大的DOM;<br>如果要多次添加DOM,先使用  document.createDocumentFragment() 创建一个盒子，完盒子里面先添加子元素，添加完成在插入元素中；</p><h3 id="transition-都有哪些过度属性？"><a href="#transition-都有哪些过度属性？" class="headerlink" title="transition 都有哪些过度属性？"></a>transition 都有哪些过度属性？</h3><h3 id="link和-import的区别？"><a href="#link和-import的区别？" class="headerlink" title="link和@import的区别？"></a>link和@import的区别？</h3><p>link属于html标签，而@import是css提供的。<br>页面被加载时，link会同时被加载，而@import引用的css会等到页面被加载完再加载的。<br>兼容性问题：@import只在IE5以上才能识别，而link是html标签，无兼容性问题。<br>权重问题:@import的权重要高于link。<br>DOM操作:DOM可以操作link中的样式，而不可以操作@import中的样式。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- html 文件 --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- link 方式，推荐 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> <span class="attr">href</span>=<span class="string">&quot;style.css&quot;</span> <span class="attr">media</span>=<span class="string">&quot;screen&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- @import 方式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> <span class="attr">media</span>=<span class="string">&quot;screen&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="keyword">@import</span> url(style.css);</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="常用的动画库有哪些？"><a href="#常用的动画库有哪些？" class="headerlink" title="常用的动画库有哪些？"></a>常用的动画库有哪些？</h3><h3 id="什么是BFC"><a href="#什么是BFC" class="headerlink" title="什么是BFC"></a>什么是BFC</h3><h3 id="href与src的区别"><a href="#href与src的区别" class="headerlink" title="href与src的区别"></a>href与src的区别</h3><h3 id="如何让-CSS-只在当前组件中起作用？"><a href="#如何让-CSS-只在当前组件中起作用？" class="headerlink" title="如何让 CSS 只在当前组件中起作用？"></a>如何让 CSS 只在当前组件中起作用？</h3><p>将当前组件的 <code>&lt;style&gt;</code>修改为 <code>&lt;style scoped&gt;</code>。</p><h2 id="JS"><a href="#JS" class="headerlink" title="JS"></a>JS</h2><h3 id="什么是闭包？"><a href="#什么是闭包？" class="headerlink" title="什么是闭包？"></a>什么是闭包？</h3><h3 id="call、apply、bind-作用和区别（改变this指向）"><a href="#call、apply、bind-作用和区别（改变this指向）" class="headerlink" title="call、apply、bind 作用和区别（改变this指向）"></a>call、apply、bind 作用和区别（改变this指向）</h3><h3 id="原型与原型链"><a href="#原型与原型链" class="headerlink" title="原型与原型链"></a>原型与原型链</h3><h3 id="JS基本数据类型"><a href="#JS基本数据类型" class="headerlink" title="JS基本数据类型"></a>JS基本数据类型</h3><h3 id="export和export-default的区别"><a href="#export和export-default的区别" class="headerlink" title="export和export default的区别"></a>export和export default的区别</h3><h3 id="箭头函数和普通函数的区别"><a href="#箭头函数和普通函数的区别" class="headerlink" title="箭头函数和普通函数的区别"></a>箭头函数和普通函数的区别</h3><ul><li>语法更加简洁、清晰，&#x3D;&gt;()</li><li>箭头函数是匿名函数，不能作为构造函数，不能使用new</li><li>箭头函数不能使用arguments，而用reat参数…解决</li><li>箭头函数没有自己的this,会捕获其所在的上下文的this值,并且不能通过call()和apply()来改变其this</li><li>箭头函数没有原型</li></ul><h3 id="GET和POST的区别"><a href="#GET和POST的区别" class="headerlink" title="GET和POST的区别"></a>GET和POST的区别</h3><h3 id="forEach和map的区别"><a href="#forEach和map的区别" class="headerlink" title="forEach和map的区别"></a>forEach和map的区别</h3><h3 id="对象的继承"><a href="#对象的继承" class="headerlink" title="对象的继承"></a>对象的继承</h3><p>常见的：<br>    原型链继承<br>    借用构造函数继承<br>    原型链 + 借用构造函数的组合继承（使用 call 或 applay 方法）<br>    ES6中class 的继承（class可以通过extends关键字实现继承）</p><h3 id="简述一下你理解的面向对象"><a href="#简述一下你理解的面向对象" class="headerlink" title="简述一下你理解的面向对象"></a>简述一下你理解的面向对象</h3><p>面向对象是基于万物皆对象这个哲学观点. 把一个对象抽象成类，具体上就是把一个对象的静态特征和动态特征抽象成属性和方法，也就是把一类事物的算法和数据结构封装在一个类之中,程序就是多个对象和互相之间的通信组成的。</p><p><strong>面向对象具有封装性,继承性,多态性。</strong></p><p>封装：隐蔽了对象内部不需要暴露的细节,使得内部细节的变动跟外界脱离,只依靠接口进行通信.封装性降低了编程的复杂性。<br>继承：使得新建一个类变得容易,一个类从派生类那里获得其非私有的方法和公用属性的繁琐工作交给了编译器。<br>多态：继承和实现接口和运行时的类型绑定机制所产生的多态，使得不同的类所产生的对象能够对相同的消息作出不同的反应,极大地提高了代码的通用性.。</p><h3 id="x3D-x3D-和-x3D-x3D-x3D-的区别"><a href="#x3D-x3D-和-x3D-x3D-x3D-的区别" class="headerlink" title="&#x3D;&#x3D; 和 &#x3D;&#x3D;&#x3D;的区别"></a>&#x3D;&#x3D; 和 &#x3D;&#x3D;&#x3D;的区别</h3><h3 id="数组有哪些方法？"><a href="#数组有哪些方法？" class="headerlink" title="数组有哪些方法？"></a>数组有哪些方法？</h3><h3 id="数组去重（笔试一般都会有）"><a href="#数组去重（笔试一般都会有）" class="headerlink" title="数组去重（笔试一般都会有）"></a>数组去重（笔试一般都会有）</h3><h3 id="JS中new操作符有什么用？"><a href="#JS中new操作符有什么用？" class="headerlink" title="JS中new操作符有什么用？"></a>JS中new操作符有什么用？</h3><p>创建临时对象，并将this指向临时对象<br>将构造函数的原型属性和方法挂载到新对象的__proto__(原型指针)上<br>return 临时对象</p><h3 id="JS获取HTML-DOM元素的方法"><a href="#JS获取HTML-DOM元素的方法" class="headerlink" title="JS获取HTML DOM元素的方法"></a>JS获取HTML DOM元素的方法</h3><p>通过ID获取（getElementById）<br>通过name属性（getElementsByName）<br>通过标签名（getElementsByTagName）<br>通过类名（getElementsByClassName）<br>获取html的方法（document.documentElement）<br>获取body的方法（document.body）<br>通过选择器获取一个元素（querySelector）<br>通过选择器获取一组元素（querySelectorAll）</p><h3 id="事件捕获和事件冒泡"><a href="#事件捕获和事件冒泡" class="headerlink" title="事件捕获和事件冒泡"></a>事件捕获和事件冒泡</h3><ul><li>事件捕获和事件冒泡主要解决了页面事件流的问题。页面的事件流经过了三个阶段，分别是事件捕获、目标阶段和事件冒泡阶段。</li><li>事件捕获是由外向内；而事件冒泡则是由内向外。</li><li>event.stopPropagation() 可以阻止事件流的进一步传播。</li><li>采用事件代理的方式，能够节省内存消耗，对于动态改变子元素的时候，也非常有利，避免了很多麻烦的步骤，比如重新绑定事件。（把子元素的事件委托给父元素来处理）</li></ul><h3 id="虚拟dom"><a href="#虚拟dom" class="headerlink" title="虚拟dom"></a>虚拟dom</h3><p>定义：虚拟DOM就是普通的js对象。用来描述真实dom结构的js对象，因为它不是真实的dom，所以才叫做虚拟dom。<br>作用：虚拟dom可以很好地跟踪当前dom状态，因为它会根据当前数据生成一个描述当前dom结构的虚拟dom，然后数据发生变化时，有生成一个新的虚拟dom，而两个虚拟dom恰好保存了变化前后的状态。然后通过diff算法，计算出当前两个虚拟dom之间的差异，得出一个更好的替换方案。</p><h3 id="排序方式"><a href="#排序方式" class="headerlink" title="排序方式"></a>排序方式</h3><p>冒泡排序：比较所有相邻元素,如果第一个比第二个大，则交换它们。<br>选择排序：找到数组中的最小值，选中它并将其放置在第一位。<br>插入排序：从第二个数开始往前比，比它大就往后排。<br>归并排序：把数组劈成两半，再递归地对数组进行“分”操作，直到分成一个个单独的数。<br>快速排序：从数组中任意选择一个基准，所有比基准小的元素放到基准前面，比基准大的元素放到基准的后面。</p><h3 id="数组操作方法会改变原数组"><a href="#数组操作方法会改变原数组" class="headerlink" title="数组操作方法会改变原数组"></a>数组操作方法会改变原数组</h3><p>会改变：push()，pop(),shift(),unshift() ,splice(),sort(),reverse()。<br>不变：concat(),split(),slice()。</p><h3 id="JS中substr（）、substring（）、slice（）、splice（）、split（）的区别与作用"><a href="#JS中substr（）、substring（）、slice（）、splice（）、split（）的区别与作用" class="headerlink" title="JS中substr（）、substring（）、slice（）、splice（）、split（）的区别与作用"></a>JS中substr（）、substring（）、slice（）、splice（）、split（）的区别与作用</h3><h3 id="JS有几种方法判断变量的类型？"><a href="#JS有几种方法判断变量的类型？" class="headerlink" title="JS有几种方法判断变量的类型？"></a>JS有几种方法判断变量的类型？</h3><p>typeof：</p><pre><code>判断基本数据类型，对于引用数据类型除了function返回’function‘，其余全部返回’object’。</code></pre><p>instanceof：</p><pre><code>区分引用数据类型，检测方法是检测的类型在当前实例的原型链上，用其检测出来的结果都是true，不太适合用于简单数据类型的检测，检测过程繁琐且对于简单数据类型中的undefined, null, symbol检测不出来。</code></pre><p>instanceof的实现原理：</p><pre><code>验证当前类的原型prototype是否会出现在实例的原型链__proto__上，只要在它的原型链上，则结果都为true。因此，instanceof 在查找的过程中会遍历左边变量的原型链，直到找到右边变量的 prototype，找到返回true，未找到返回false。</code></pre><p>constructor：</p><pre><code>检测引用数据类型，检测方法是获取实例的构造函数判断和某个类是否相同，如果相同就说明该数据是符合那个数据类型的，这种方法不会把原型链上的其他类也加入进来，避免了原型链的干扰。</code></pre><p>Object.prototype.toString.call()：</p><pre><code>适用于所有类型的判断检测，检测方法是Object.prototype.toString.call(数据) 返回的是该数据类型的字符串。(举例：字符串返回的是[object String])</code></pre><p>Object.prototype.toString.call原理：</p><pre><code>Object.prototype.toString 表示一个返回对象类型的字符串，call()方法可以改变this的指向，那么把Object.prototype.toString()方法指向不同的数据类型上面，返回不同的结果</code></pre><h3 id="null和undefined的区别？"><a href="#null和undefined的区别？" class="headerlink" title="null和undefined的区别？"></a>null和undefined的区别？</h3><p>null和undefined 区别为：undefined是表示变量声明过但并未赋过值，它是所有未赋值变量默认值；null表示一个变量将来可能指向一个对象，一般用于主动释放指向对象的引用。</p><h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h4><p>（1）undefined：是所有没有赋值变量的默认值，自动赋值<br>（2）null：主动释放一个变量引用的对象，表示一个变量不再指向任何对象地址</p><h4 id="null与undefined的异同点是什么呢？"><a href="#null与undefined的异同点是什么呢？" class="headerlink" title="null与undefined的异同点是什么呢？"></a>null与undefined的异同点是什么呢？</h4><p>共同点： 都是原始类型，保存在栈中变量本地<br>不同点：<br>（1）undefined——表示变量声明过但并未赋过值。<br>它是所有未赋值变量默认值。<br>例如：var a; &#x2F;&#x2F;a自动被赋值为undefined<br>（2）null——表示一个变量将来可能指向一个对象。<br>一般用于主动释放指向对象的引用。</p><h4 id="何时使用null"><a href="#何时使用null" class="headerlink" title="何时使用null?"></a>何时使用null?</h4><p>当使用完一个比较大的对象时，需要对其进行释放内存时，设置为null</p><h3 id="什么是跨域？及跨域解决方法"><a href="#什么是跨域？及跨域解决方法" class="headerlink" title="什么是跨域？及跨域解决方法"></a>什么是跨域？及跨域解决方法</h3><h3 id="防抖和节流的使用及区别"><a href="#防抖和节流的使用及区别" class="headerlink" title="防抖和节流的使用及区别"></a>防抖和节流的使用及区别</h3><h3 id="栈内存和堆内存的区别与原理"><a href="#栈内存和堆内存的区别与原理" class="headerlink" title="栈内存和堆内存的区别与原理"></a>栈内存和堆内存的区别与原理</h3><h3 id="深拷贝和浅拷贝的区别和与原理"><a href="#深拷贝和浅拷贝的区别和与原理" class="headerlink" title="深拷贝和浅拷贝的区别和与原理"></a>深拷贝和浅拷贝的区别和与原理</h3><h3 id="webpack是怎么打包的，babel又是什么"><a href="#webpack是怎么打包的，babel又是什么" class="headerlink" title="webpack是怎么打包的，babel又是什么"></a>webpack是怎么打包的，babel又是什么</h3><p>Webpack：把所有依赖打包成一个 bundle.js文件，通过代码分割成单元片段并按需加载。Webpack是以公共JS的形式来书写脚本的，但对AMD&#x2F;CMD的支持也很全面，方便旧项目进行代码迁移。<br>把项目当做一个整体，通过一个给定的主文件（如：index.js），Webpack将从这个文件开始找到项目的所有依赖文件，使用loaders处理它们，最后打包为一个（或多个）浏览器可识别的JavaScript文件。</p><p>babel将es6、es7、es8等语法转换成浏览器可识别的es5或es3语法。</p><h3 id="git-和-svn的区别"><a href="#git-和-svn的区别" class="headerlink" title="git 和 svn的区别"></a>git 和 svn的区别</h3><p>SVN是集中式版本控制系统，版本库是集中放在中央服务器的，首先要从中央服务器哪里得到最新的版本，干完活后，需要把自己做完的活推送到中央服务器。集中式版本控制系统是必须联网才能工作（如果在局域网还可以，带宽够大，速度够快，如果在互联网下，如果网速慢的话，就纳闷了）</p><p>Git是分布式版本控制系统，没有中央服务器的，每个人的电脑就是一个完整的版本库，这样，工作的时候就不需要联网了，因为版本都是在自己的电脑上。自己在电脑上改了文件A，其他人也在电脑上改了文件A，这时，只需把各自的修改推送给对方，就可以互相看到对方的修改了。</p><h3 id="webSocket"><a href="#webSocket" class="headerlink" title="webSocket"></a>webSocket</h3><p>webSocket： 可以让服务器主动向客户端发送消息，适合开发聊天室，多人游戏等协作应用。</p><p>WebSocket协议是基于TCP的一种新的网络协议。在 WebSocket API 中，浏览器和服务器只需要完成一次握手，两者之间就直接可以创建持久性的连接，并进行双向数据传输。</p><h3 id="require和import区别"><a href="#require和import区别" class="headerlink" title="require和import区别"></a>require和import区别</h3><ul><li><p>调用时间</p><p>require运行时调用，理论上可以运用在代码任何地，甚至不需要赋值给某个变量之后再使用。<br>lmport是编译时候调用，必须放在文件开头，而且使用格式也是确定的。</p></li><li><p>遵循规范</p><p>require 是 AMD规范引入方式<br>import是es6的一个语法标准，如果要兼容浏览器的话必须转化成es5的语法</p></li><li><p>本质<br>require是赋值过程，其实require 的结果就是对象、数字、字符串、函数等，再把require的结果赋值给某个变量。<br>import是解构过程。</p></li></ul><p>通过require 引入基础数据类型时，属于复制该变量。<br>通过require 引入复杂数据类型时，数据浅拷贝该对象。<br>出现模块之间的循环引用时,会输出已经执行的模块,而未执行的模块不输出(比较复杂）。CommonJS模块默认export的是一个对象，即使导出的是基础数据类型。</p><p>ES6 模块语法是 JavaScript 模块的标准写法，坚持使用这种写法，取代 Node.js 的 CommonJS 语法。<br>使用import取代require()。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// CommonJS 的写法</span></span><br><span class="line"><span class="keyword">const</span> moduleA = <span class="built_in">require</span>(<span class="string">&#x27;moduleA&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> func1 = moduleA.<span class="property">func1</span>;</span><br><span class="line"><span class="keyword">const</span> func2 = moduleA.<span class="property">func2</span>;</span><br><span class="line"><span class="comment">// ES6 的写法</span></span><br><span class="line"><span class="keyword">import</span> &#123; func1, func2 &#125; <span class="keyword">from</span> <span class="string">&#x27;moduleA&#x27;</span>;</span><br></pre></td></tr></table></figure><p>使用export取代module.exports。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// commonJS 的写法</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">React</span> = <span class="built_in">require</span>(<span class="string">&#x27;react&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">Breadcrumbs</span> = <span class="title class_">React</span>.<span class="title function_">createClass</span>(&#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`&lt;nav /&gt;`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title class_">Breadcrumbs</span>;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ES6 的写法</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Breadcrumbs</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`&lt;nav /&gt;`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Breadcrumbs</span>;</span><br></pre></td></tr></table></figure><h3 id="事件循环（Event-Loop）"><a href="#事件循环（Event-Loop）" class="headerlink" title="事件循环（Event Loop）"></a>事件循环（Event Loop）</h3><p>原因：JavaScript是单线程，所有任务需要排队，前一个任务结束，才会执行后一个任务。</p><p>所有任务可以分成两种，一种是同步任务（synchronous），另一种是异步任务（asynchronous）。<br>同步任务：在主线程上排队执行的任务，只有前一个任务执行完毕，才能执行后一个任务；<br>异步任务：不进入主线程、而进入”任务队列”的任务，只有”任务队列”通知主线程，某个异步任务可以执行了，该任务才会进入主线程执行。</p><p>同步和异步任务分别进入不同的执行环境， 先执行同步任务，把异步任务放入循环队列当中挂起，等待同步任务执行完，再执行队列中的异步任务。异步任务先执行微观任务，再执行宏观任务。一直这样循环，反复执行。</p><p>微任务：Promise.then、catch、finally、async&#x2F;await。<br>宏任务：整体代码 Script、UI 渲染、setTimeout、setInterval、Dom事件、ajax事件。</p><h3 id="宏任务、微任务是怎么执行的？"><a href="#宏任务、微任务是怎么执行的？" class="headerlink" title="宏任务、微任务是怎么执行的？"></a>宏任务、微任务是怎么执行的？</h3><p>执行顺序：先执行同步代码，遇到异步宏任务则将异步宏任务放入宏任务队列中，遇到异步微任务则将异步微任务放入微任务队列中，当所有同步代码执行完毕后，再将异步微任务从队列中调入主线程执行，微任务执行完毕后再将异步宏任务从队列中调入主线程执行，一直循环直至所有任务执行完毕。</p><h3 id="什么是单页面应用（SPA）"><a href="#什么是单页面应用（SPA）" class="headerlink" title="什么是单页面应用（SPA）"></a>什么是单页面应用（SPA）</h3><p>一个系统只加载一次资源，之后的操作交互、数据交互是通过路由、ajax来进行，页面并没有刷新。<br>在一个页面上集成多种功能，甚至整个系统就只有一个页面，所有的业务功能都是它的子模块，通过特定的方式挂接到主界面上。</p><p>优点：<br>前后端分离<br>良好的交互体验——用户不用刷新页面，页面显示流畅<br>减轻服务器压力——服务器只出数据<br>共用一套后端代码——多个客户端可共用一套后端代码<br>加载速度快,内容的改变不需要重新加载整个页面,对服务器压力小<br>缺点：<br>SEO难度高——数据渲染在前端进行<br>页面初次加载比较慢,页面复杂提高很多<br>多页面： 一个应用多个页面,页面跳转时整个页面都刷新,每次都请求一个新的页面<br>有点:SEO效果好</p><p>缺点： 页面切换慢,每次切换页面需要选择性的重新加载公共资源</p><h3 id="什么叫优雅降级和渐进增强？"><a href="#什么叫优雅降级和渐进增强？" class="headerlink" title="什么叫优雅降级和渐进增强？"></a>什么叫优雅降级和渐进增强？</h3><p>渐进增强（Progressive Enhancement）： 一开始就针对低版本浏览器进行构建页面，完成基本的功能，然后再针对高级浏览器进行效果、交互、追加功能达到更好的体验。<br>优雅降级（Graceful Degradation）： 一开始就构建站点的完整功能，然后针对浏览器测试和修复。</p><p>在传统软件开发中，经常会提到向上兼容和向下兼容的概念。渐进增强相当于向上兼容，而优雅降级相当于向下兼容。向下兼容指的是高版本支持低版本的或者说后期开发的版本支持和兼容早期开发的版本，向上兼容的很少。大多数软件都是向下兼容的。</p><p>二者区别：<br>1、优雅降级和渐进增强只是看待同种事物的两种观点。<br>2、优雅降级观点认为应该针对那些最高级、最完善的浏览器来设计网站。<br>3、渐进增强观点则认为应关注于内容本身。</p><h2 id="ES6新特性"><a href="#ES6新特性" class="headerlink" title="ES6新特性"></a>ES6新特性</h2><p>新增块级作用域let定义变量和const定义常量<br>变量的解构赋值<br>模板字符串 （‘${}’）<br>默认参数（key&#x3D;value）<br>箭头函数（&#x3D;&gt;）<br>扩展运算符（…）<br>模块（import&#x2F;export）<br>类（class&#x2F;extends）<br>Promise<br>Proxy<br>Symbol</p><h2 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h2><p>含义： 异步编程的一种解决方案，用来解决回调地狱。<br>三种状态： pending（进行中）、fulfilled（已成功）和rejected（已失败） （Promise对象的状态改变，只有两种可能：从pending变为fulfilled和从pending变为rejected。）</p><p>resolved函数作用：将Promise对象的状态从“未完成”变为“成功”（即从 pending 变为 resolved）。<br>reject函数的作用：将Promise对象的状态从“未完成”变为“失败”（即从 pending 变为 rejected）。</p><p>Promise实例生成以后，可以用then方法分别指定resolved状态和rejected状态的回调函数。<br>then: Promise 实例添加状态改变时的回调函数。可以接受两个回调函数作为参数。第一个回调函数是Promise对象的状态变为resolved时调用，第二个回调函数是Promise对象的状态变为rejected时调用。</p><p>缺点： 无法取消Promise，一旦新建它就会立即执行，无法中途取消。如果不设置回调函数，Promise内部抛出的错误，不会反应到外部。</p><h2 id="VUE"><a href="#VUE" class="headerlink" title="VUE"></a>VUE</h2><h3 id="MVVM、MVC-和-MVP-的区别是什么？各自有什么应用场景？"><a href="#MVVM、MVC-和-MVP-的区别是什么？各自有什么应用场景？" class="headerlink" title="MVVM、MVC 和 MVP 的区别是什么？各自有什么应用场景？"></a>MVVM、MVC 和 MVP 的区别是什么？各自有什么应用场景？</h3><p>MVC</p><ul><li>Model(模型)：负责从数据库中取数据</li><li>View(视图)：负责展示数据的地方</li><li>Controller(控制器)：用户交互的地方，例如点击事件</li><li>思想：Controller将Model的数据展示在View上</li></ul><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4636ebbfa25049179c27a6b5ab8bb308~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp" alt="image.png"></p><p>MVVM</p><ul><li>VM：也就是View-Model，做了两件事达到了数据的双向绑定<ul><li>一、将【模型】转化成【视图】，即将后端传递的数据转化成所看到的页面。实现的方式是：数据绑定。</li><li>二、将【视图】转化成【模型】，即将所看到的页面转化成后端的数据。实现的方式是：DOM 事件监听。</li></ul></li><li>思想：实现了 View 和 Model 的自动同步，也就是当 Model 的属性改变时，我们不用再自己手动操作 Dom 元素，来改变 View 的显示，而是改变属性后该属性对应 View 层显示会自动改变（对应Vue数据驱动的思想）</li></ul><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/aac31b27392b4b0e90ca2f67c64c59c2~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp" alt="image.png"></p><p>区别</p><p>整体看来，MVVM 比 MVC 精简很多，不仅简化了业务与界面的依赖，还解决了数据频繁更新的问题，不用再用选择器操作 DOM 元素。因为在 MVVM 中，View 不知道 Model 的存在，Model 和 ViewModel 也观察不到 View，这种低耦合模式提高代码的可重用性</p><h3 id="如何理解-Vue-是一个渐进式框架？"><a href="#如何理解-Vue-是一个渐进式框架？" class="headerlink" title="如何理解 Vue 是一个渐进式框架？"></a>如何理解 Vue 是一个渐进式框架？</h3><p>Vue是MVVM框架，但是不是严格符合MVVM，因为MVVM规定Model和View不能直接通信，而Vue的 <code>ref</code>可以做到这点</p><h3 id="Vue的优点？Vue的缺点？"><a href="#Vue的优点？Vue的缺点？" class="headerlink" title="Vue的优点？Vue的缺点？"></a>Vue的优点？Vue的缺点？</h3><p>优点：渐进式，组件化，轻量级，虚拟dom，响应式，单页面路由，数据与视图分开</p><p>缺点：单页面不利于seo，不支持IE8以下，首屏加载时间长</p><h3 id="Vue和React的异同点？"><a href="#Vue和React的异同点？" class="headerlink" title="Vue和React的异同点？"></a>Vue和React的异同点？</h3><p>相同点：</p><ul><li>使用虚拟dom</li><li>组件化开发</li><li>单向数据流(父子组件之间，不建议子修改父传递的数据)</li><li>支持服务端渲染</li></ul><p>不同点：</p><ul><li>React的JSX，Vue的template</li><li>数据变化，React手动(setState)，Vue自动(初始化已响应式处理，Object.defineProperty)</li><li>React单向绑定，Vue双向绑定</li><li>React的Redux，Vue的Vuex</li></ul><h3 id="Vue和JQuery的区别在哪？为什么放弃JQuery用Vue？"><a href="#Vue和JQuery的区别在哪？为什么放弃JQuery用Vue？" class="headerlink" title="Vue和JQuery的区别在哪？为什么放弃JQuery用Vue？"></a>Vue和JQuery的区别在哪？为什么放弃JQuery用Vue？</h3><ul><li>jQuery直接操作DOM，Vue不直接操作DOM，Vue的数据与视图是分开的，Vue只需要操作数据即可</li><li>在操作DOM频繁的场景里，jQuery的操作DOM行为是频繁的，而Vue利用虚拟DOM的技术，大大提高了更新DOM时的性能</li><li>Vue中不倡导直接操作DOM，开发者只需要把大部分精力放在数据层面上</li><li>Vue集成的一些库，大大提高开发效率，比如Vuex，Router等</li></ul><h3 id="数据双向绑定原理"><a href="#数据双向绑定原理" class="headerlink" title="数据双向绑定原理"></a>数据双向绑定原理</h3><p>通过数据劫持结合发布—订阅模式，通过Object.defineProperty()为各个属性定义get、set方法，在数据发生改变时给订阅者发布消息，触发相应的事件回调。</p><h3 id="vue生命周期"><a href="#vue生命周期" class="headerlink" title="vue生命周期"></a>vue生命周期</h3><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/892fde0e56324868921d0e924c84858a~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp" alt="image.png"></p><p>Vue 实例有一个完整的生命周期，也就是从开始创建、初始化数据、编译模板、挂载Dom→渲染、更新→渲染、卸载等一系列过程，我们称这是 Vue 的生命周期。通俗说就是 Vue 实例从创建到销毁的过程，就是生命周期。</p><ul><li><p>beforeCreate</p><p>创建前。此时，组件实例刚刚创建，还未进行数据观测和事件配置，拿不到任何数据。</p></li><li><p>created</p><p>创建完成。vue 实例已经完成了数据观测，属性和方法的计算(比如props、methods、data、computed和watch此时已经拿得到)，未挂载到DOM，不能访问到el属性，el属性，ref属性内容为空数组常用于简单的ajax请求，页面的初始化。</p></li><li><p>beforeMount</p><p>挂载前。挂在开始之前被调用，相关的render函数首次被调用（虚拟DOM）。编译模板，把data里面的数据和模板生成html，完成了el和data 初始化，注意此时还没有挂在html到页面上。</p></li><li><p>mounted</p><p>挂载完成。也就是模板中的HTML渲染到HTML页面中，此时可以通过DOM API获取到DOM节点，$ref属性可以访问常用于获取VNode信息和操作，ajax请求，mounted只会执行一次。</p></li><li><p>beforeUpdate</p><p>在数据更新之前被调用，发生在虚拟DOM重新渲染和打补丁之前，不会触发附加地重渲染过程。</p></li><li><p>updated</p><p>更新后。在由于数据更改导致地虚拟DOM重新渲染和打补丁之后调用，</p></li><li><p>beforeDestroy</p><p>销毁前。在实例销毁之前调用，实例仍然完全可用。（一般在这一步做一些重置的操作，比如清除掉组件中的定时器 和 监听的dom事件）</p></li><li><p>destroyed</p><p>销毁后。在实例销毁之后调用，调用后，vue实列指示的所有东西都会解绑，所有的事件监听器会被移除。<br>其他：</p></li><li><p>activated</p><p>在keep-alive组件激活时调用</p></li><li><p>deactivated</p><p>在keep-alive组件停用时调用</p></li></ul><h3 id="vuex的有哪些属性？用处是什么？"><a href="#vuex的有哪些属性？用处是什么？" class="headerlink" title="vuex的有哪些属性？用处是什么？"></a>vuex的有哪些属性？用处是什么？<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9566927e955c4d0ba19df942534e5b53~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp" alt="image.png"></h3><h3 id="为什么使用虚拟DOM-常问"><a href="#为什么使用虚拟DOM-常问" class="headerlink" title="为什么使用虚拟DOM(常问)"></a>为什么使用虚拟DOM(常问)</h3><p>创建真实DOM的代价高：真实的 DOM 节点 node 实现的属性很多，而 vnode 仅仅实现一些必要的属性，相比起来，创建一个 vnode 的成本比较低。<br>触发多次浏览器重绘及回流：使用 vnode ，相当于加了一个缓冲，让一次数据变动所带来的所有 node 变化，先在 vnode 中进行修改，然后 diff 之后对所有产生差异的节点集中一次对 DOM tree 进行修改，以减少浏览器的重绘及回流。<br>虚拟dom由于本质是一个js对象，因此天生具备跨平台的能力，可以实现在不同平台的准确显示。<br>Virtual DOM 在性能上的收益并不是最主要的，更重要的是它使得 Vue 具备了现代框架应有的高级特性。</p><h3 id="v-if-和-v-show的作用和区别"><a href="#v-if-和-v-show的作用和区别" class="headerlink" title="v-if 和 v-show的作用和区别"></a>v-if 和 v-show的作用和区别</h3><ul><li><code>v-if</code>：通过控制dom元素的删除和生成来实现显隐，每一次显隐都会使组件重新跑一遍生命周期，因为显隐决定了组件的生成和销毁</li><li><code>v-show</code>：通过控制dom元素的css样式来实现显隐，不会销毁</li><li>频繁或者大数量显隐使用 <code>v-show</code>，否则使用 <code>v-if</code></li></ul><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">无论v-<span class="built_in">show</span>的值为<span class="literal">true</span>或者<span class="literal">false</span>,元素都会存在于html页面中; 而v-<span class="keyword">if</span>的值为<span class="literal">true</span>时,元素才会存在于html页面中。</span><br><span class="line">v-<span class="built_in">show</span>指令是通过修改元素的<span class="built_in">display</span>属性来实现的。</span><br><span class="line">v-<span class="keyword">if</span>是动态地向DOM树内添加或者删除DOM元素,v-<span class="built_in">show</span>是通过设置DOM元素的<span class="built_in">display</span>样式属性控制显隐的。</span><br><span class="line">v-<span class="keyword">if</span>是<span class="string">&quot;真正的&quot;</span>条件渲染,因为它会确保在奇幻过程中条件快内的事件监听器和子组件适当的销毁和重建。</span><br><span class="line">v-<span class="keyword">if</span>也是惰性的,如果在初始渲染时条件为假,则什么也不做,直到条件第一次变为真时,才开始渲染条件块。</span><br><span class="line">v-<span class="built_in">show</span>不管初始条件是什么,元素总会背渲染,并且只是简单地基于css进行切换。</span><br><span class="line">一般来说,v-<span class="keyword">if</span>有更高的切换开销,而v-<span class="built_in">show</span>则有更高的初始渲染开销</span><br></pre></td></tr></table></figure><p>因此,如果需要非常频繁地切换,使用v-show比较好,如果在运行时条件不会改变时,用v-if比较好</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">切换时生命周期函数的执行</span><br><span class="line">v-<span class="keyword">if</span></span><br><span class="line">初始渲染</span><br><span class="line">初始值为<span class="keyword">false</span>时,不会渲染(所谓惰性),生命周期函数不会执行</span><br><span class="line">初始值为<span class="keyword">true</span>时,组件开始渲染,依次执行beforCreate,created,beforeMount,mounted等生命周期</span><br><span class="line"></span><br><span class="line">切换时</span><br><span class="line">从<span class="keyword">false</span>到<span class="keyword">true</span>:依次执行beforeCreate,created,beforeMount,moynted</span><br><span class="line">从<span class="keyword">true</span>到<span class="keyword">false</span>:依次执行beforeDestroy,destroyed</span><br><span class="line"></span><br><span class="line">v-<span class="keyword">show</span></span><br><span class="line">初始渲染</span><br><span class="line">无论初始状态为<span class="keyword">true</span>还是<span class="keyword">false</span>,组件都会渲染,依次执行beforeCreate,created,beforeMount,mounted</span><br><span class="line"></span><br><span class="line">切换</span><br><span class="line">基于css进行切换,对生命周期函数无影响.</span><br></pre></td></tr></table></figure><h3 id="Vue-2-x-模板中的指令是如何解析实现的？"><a href="#Vue-2-x-模板中的指令是如何解析实现的？" class="headerlink" title="Vue 2.x 模板中的指令是如何解析实现的？"></a>Vue 2.x 模板中的指令是如何解析实现的？</h3><h3 id="简要说明-Vue-2-x-的全链路运作机制？"><a href="#简要说明-Vue-2-x-的全链路运作机制？" class="headerlink" title="简要说明 Vue 2.x 的全链路运作机制？"></a>简要说明 Vue 2.x 的全链路运作机制？</h3><h3 id="Vue-里实现跨组件通信的方式有哪些？"><a href="#Vue-里实现跨组件通信的方式有哪些？" class="headerlink" title="Vue 里实现跨组件通信的方式有哪些？"></a>Vue 里实现跨组件通信的方式有哪些？</h3><h3 id="Vue-中响应式数据是如何做到对某个对象的深层次属性的监听的？"><a href="#Vue-中响应式数据是如何做到对某个对象的深层次属性的监听的？" class="headerlink" title="Vue 中响应式数据是如何做到对某个对象的深层次属性的监听的？"></a>Vue 中响应式数据是如何做到对某个对象的深层次属性的监听的？</h3><h3 id="用过vue的哪些组件？"><a href="#用过vue的哪些组件？" class="headerlink" title="用过vue的哪些组件？"></a>用过vue的哪些组件？</h3><p>1、vue-route<br>2、axios<br>3、vuex<br>4、Element UI<br>5、swiper<br>6、vue-echarts<br>7、vue-video-player<br>8、vue-photo-preview等等</p><h3 id="相同的路由组件如何重新渲染？"><a href="#相同的路由组件如何重新渲染？" class="headerlink" title="相同的路由组件如何重新渲染？"></a>相同的路由组件如何重新渲染？</h3><blockquote><p>开发人员经常遇到的情况是，多个路由解析为同一个Vue组件。问题是，Vue出于性能原因，默认情况下共享组件将不会重新渲染，如果你尝试在使用相同组件的路由之间进行切换，则不会发生任何变化。</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&quot;/a&quot;</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="title class_">MyComponent</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&quot;/b&quot;</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="title class_">MyComponent</span></span><br><span class="line">    &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><blockquote><p>如果依然想重新渲染，怎么办呢？可以使用 <code>key</code></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">router-view</span> <span class="attr">:key</span>=<span class="string">&quot;$route.path&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><h3 id="vue-router-的路由模式有？"><a href="#vue-router-的路由模式有？" class="headerlink" title="vue-router 的路由模式有？"></a>vue-router 的路由模式有？</h3><p>1、hash模式，用URL hash值来做路由，支持所有浏览器；该模式实现的路由，在通过链接后面添加““#”+路由名字”，触发 <code>hashchange</code>事件，实现路由切换<br>2、history模式，由h5提供的history对象实现，依赖H5 History API和服务器配置，通过 <code>pushState</code>和 <code>replaceState</code>切换url，实现路由切换，需要后端配合<br>3、abstract模式，支持所有JS运行环境，如Node服务器端，如果发现没有浏览器的API，路由会自动强制进入该模式。</p><h3 id="组件之间如何传值"><a href="#组件之间如何传值" class="headerlink" title="组件之间如何传值"></a>组件之间如何传值</h3><ul><li>Vue父子 组件之间传值<ul><li>子组件通过 <code>props</code>来接受数据</li><li>子组件通过 <code>$emit</code>来触发父组件的自定义事件（即传值）</li></ul></li><li>组件中可以使用 <code>$parent</code>和 <code>$children</code>获取到父组件实例和子组件实例，进而获取数据</li><li>使用 <code>$attrs</code>和 <code>$listeners</code>，在对一些组件进行二次封装时可以方便传值，例如A-&gt;B-&gt;C</li><li>使用 <code>$refs</code>获取组件实例，进而获取数据</li><li>使用 <code>Vuex</code>进行状态管理</li><li>使用 <code>eventBus</code>进行跨组件触发事件，进而传递数据</li><li>使用 <code>provide</code>和 <code>inject</code>，官方建议我们不要用这个，我在看 <code>ElementUI</code>源码时发现大量使用</li><li>使用浏览器本地缓存，例如 <code>localStorage</code></li></ul><h3 id="路由之间如何传参"><a href="#路由之间如何传参" class="headerlink" title="路由之间如何传参"></a>路由之间如何传参</h3><ul><li>通过router-link路由导航跳转传递<br><code>&lt;router-link to=</code>&#x2F;a&#x2F;${id}<code>&gt;routerlink传参&lt;/router-link&gt;</code></li><li>跳转时使用push方法拼接携带参数。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(&#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">`/getlist/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ul><li>通过路由属性中的name来确定匹配的路由，通过params来传递参数</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;Getlist&#x27;</span>,</span><br><span class="line">   <span class="attr">params</span>: &#123;</span><br><span class="line">     <span class="attr">id</span>: id</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;)</span><br></pre></td></tr></table></figure><ul><li>使用path来匹配路由，然后通过query来传递参数。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(&#123;</span><br><span class="line"> <span class="attr">path</span>: <span class="string">&#x27;/getlist&#x27;</span>,</span><br><span class="line">  <span class="attr">query</span>: &#123;</span><br><span class="line">    <span class="attr">id</span>: id</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><blockquote><p>注意：query有点像ajax中的get请求，而params像post请求。</p></blockquote><p>params在地址栏中不显示参数，刷新页面，参数丢失,<br>其余方法在地址栏中显示传递的参数，刷新页面，参数不丢失。</p><h3 id="VUEX"><a href="#VUEX" class="headerlink" title="VUEX"></a>VUEX</h3><p>原理：Vuex是专门为vue.js应用程序设计的状态管理工具。</p><p>1、state   保存vuex中的数据源，通过this.$store.state获取</p><p>2、getters用于监听state中的值的变化，返回计算后的结果。getter的返回值会根据它的依赖被缓存起来</p><p>3、mutations  是修改store中的值得唯一方式&#x2F;&#x2F;this.$store.commit(‘add’)</p><p>4、action 官方建议提交一个actions，在actions中提交mutations再去修改状态值。this.$store.dispatch(‘add’)</p><p>5、modules 模块化</p><h3 id="如何解决vuex页面刷新数据丢失问题？"><a href="#如何解决vuex页面刷新数据丢失问题？" class="headerlink" title="如何解决vuex页面刷新数据丢失问题？"></a>如何解决vuex页面刷新数据丢失问题？</h3><p>原因：因为vuex里的数据是保存在运行内存中的，当页面刷新时，页面会重新加载vue实例，vuex里面的数据就会被清空。<br>解决方法：将vuex中的数据直接保存到浏览器缓存中。（一般是用sessionStorage）</p><h3 id="computed和watch的区别？"><a href="#computed和watch的区别？" class="headerlink" title="computed和watch的区别？"></a>computed和watch的区别？</h3><p>computed值有缓存、触发条件是依赖值发生更改、 watch无缓存支持异步、监听数据变化</p><p>computed： 是计算属性，依赖其它属性值，并且computed 的值有缓存，只有它依赖的属性值发生改变，下一次获取 computed 的值时才会重新计算 computed 的值；</p><p>watch： 更多的是观察的作用，支持异步，类似于某些数据的监听回调 ，每当监听的数据变化时都会执行回调进行后续操作；</p><p>computed应用场景：需要进行数值计算，并且依赖于其它数据时，应该使用 computed，因为可以利用 computed 的缓存特性，避免每次获取值时，都要重新计算；</p><p>watch应用场景：需要在数据变化时执行异步或开销较大的操作时，应该使用 watch，使用 watch选项允许我们执行异步操作 ( 访问一个 API )，限制我们执行该操作的频率，并在我们得到最终结果前，设置中间状态。这些都是计算属性无法做到的。</p><ul><li><code>computed</code>是依赖已有的变量来计算一个目标变量，大多数情况都是 <code>多个变量</code>凑在一起计算出 <code>一个变量</code>，并且 <code>computed</code>具有 <code>缓存机制</code>，依赖值不变的情况下其会直接读取缓存进行复用，<code>computed</code>不能进行 <code>异步操作</code></li><li><code>watch</code>是监听某一个变量的变化，并执行相应的回调函数，通常是 <code>一个变量</code>的变化决定 <code>多个变量</code>的变化，<code>watch</code>可以进行 <code>异步操作</code></li><li>简单记就是：一般情况下 <code>computed</code>是 <code>多对一</code>，<code>watch</code>是 <code>一对多</code></li></ul><h3 id="computed如何实现传参？"><a href="#computed如何实现传参？" class="headerlink" title="computed如何实现传参？"></a>computed如何实现传参？</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// html</span></span><br><span class="line">&lt;div&gt;&#123;&#123; <span class="title function_">total</span>(<span class="number">3</span>) &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// js</span></span><br><span class="line"><span class="attr">computed</span>: &#123;</span><br><span class="line">    <span class="title function_">total</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">n</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> n * <span class="variable language_">this</span>.<span class="property">num</span></span><br><span class="line">         &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h3 id="watch有哪些属性，分别有什么用？"><a href="#watch有哪些属性，分别有什么用？" class="headerlink" title="watch有哪些属性，分别有什么用？"></a>watch有哪些属性，分别有什么用？</h3><p>当我们监听一个基本数据类型时：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">watch</span>: &#123;</span><br><span class="line">    value () &#123;</span><br><span class="line">        <span class="comment">// do something</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>当我们监听一个引用数据类型时：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">watch</span>: &#123;</span><br><span class="line">    <span class="attr">obj</span>: &#123;</span><br><span class="line">       handler () &#123; <span class="comment">// 执行回调</span></span><br><span class="line">           <span class="comment">// do something</span></span><br><span class="line">       &#125;,</span><br><span class="line">       <span class="attr">deep</span>: <span class="literal">true</span>, <span class="comment">// 是否进行深度监听</span></span><br><span class="line">       <span class="attr">immediate</span>: <span class="literal">true</span> <span class="comment">// 是否初始执行handler函数</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="watch的immediate属性有什么用？"><a href="#watch的immediate属性有什么用？" class="headerlink" title="watch的immediate属性有什么用？"></a>watch的immediate属性有什么用？</h3><blockquote><p>比如平时created时要请求一次数据，并且当搜索值改变，也要请求数据，我们会这么写：</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">created</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">getList</span>()</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">watch</span>: &#123;</span><br><span class="line">    <span class="title function_">searchInputValue</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">getList</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>使用 <code>immediate</code>完全可以这么写，当它为 <code>true</code>时，会初始执行一次</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">watch</span>: &#123;</span><br><span class="line">    <span class="attr">searchInputValue</span>:&#123;</span><br><span class="line">        <span class="attr">handler</span>: <span class="string">&#x27;getList&#x27;</span>,</span><br><span class="line">        <span class="attr">immediate</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="watch监听一个对象时，如何排除某些属性的监听"><a href="#watch监听一个对象时，如何排除某些属性的监听" class="headerlink" title="watch监听一个对象时，如何排除某些属性的监听"></a>watch监听一个对象时，如何排除某些属性的监听</h3><blockquote><p>下面代码是，params发生改变就重新请求数据，无论是a，b，c，d属性改变</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">params</span>: &#123;</span><br><span class="line">        <span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">b</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">c</span>: <span class="number">3</span>,</span><br><span class="line">        <span class="attr">d</span>: <span class="number">4</span></span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line"><span class="attr">watch</span>: &#123;</span><br><span class="line">    <span class="attr">params</span>: &#123;</span><br><span class="line">      <span class="attr">deep</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="title function_">handler</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">getList</span>;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><blockquote><p>但是如果我只想要a，b改变时重新请求，c，d改变时不重新请求呢？</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">keys</span>(<span class="variable language_">this</span>.<span class="property">params</span>)</span><br><span class="line">      .<span class="title function_">filter</span>(<span class="function">(<span class="params">_</span>) =&gt;</span> ![<span class="string">&quot;c&quot;</span>, <span class="string">&quot;d&quot;</span>].<span class="title function_">includes</span>(_)) <span class="comment">// 排除对c，d属性的监听</span></span><br><span class="line">      .<span class="title function_">forEach</span>(<span class="function">(<span class="params">_</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.$watch(<span class="function">(<span class="params">vm</span>) =&gt;</span> vm.<span class="property">params</span>[_], handler, &#123;</span><br><span class="line">          <span class="attr">deep</span>: <span class="literal">true</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">params</span>: &#123;</span><br><span class="line">        <span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">b</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">c</span>: <span class="number">3</span>,</span><br><span class="line">        <span class="attr">d</span>: <span class="number">4</span></span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line"><span class="attr">watch</span>: &#123;</span><br><span class="line">    <span class="attr">params</span>: &#123;</span><br><span class="line">      <span class="attr">deep</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="title function_">handler</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">getList</span>;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h3 id="route和router的区别"><a href="#route和router的区别" class="headerlink" title="route和router的区别"></a>route和router的区别</h3><p>route:是路由信息对象，包括“path,parms,hash,name“等路由信息参数。<br>router:是路由实例对象，包括了路由跳转方法，钩子函数等。</p><h3 id="vue中数据变了但是视图不跟新怎么解决？"><a href="#vue中数据变了但是视图不跟新怎么解决？" class="headerlink" title="vue中数据变了但是视图不跟新怎么解决？"></a>vue中数据变了但是视图不跟新怎么解决？</h3><p>vue不能检测以下变动的数组：</p><p>1、当你利用索引直接设置一个项时，vm.items[indexOfItem] &#x3D; newValue<br>2、当你修改数组的长度时，例如： vm.items.length &#x3D; newLength</p><p>对象属性的添加或删除</p><p>由于 Vue 会在初始化实例时对属性执行 getter&#x2F;setter 转化过程，所以属性必须在 data 对象上存在才能让 Vue 转换它，这样才能让它是响应的。</p><p>解决办法：</p><p>使用 Vue.set(object, key, value) 方法将响应属性添加到嵌套的对象上<br>Vue.set(vm.someObject, ‘b’, 2) 或者 this.$set(this.someObject,‘b’,2) （这也是全局 Vue.set 方法的别名）</p><p>异步更新队列</p><p>在最新的项目中遇到了这种情况，数据第一次获取到了，也渲染了，但是第二次之后数据只有在再一次渲染页面的时候更新，并不能实时更新。</p><p>Vue 异步执行 DOM 更新。只要观察到数据变化，Vue 将开启一个队列，并缓冲在同一事件循环中发生的所有数据改变。如果同一个 watcher 被多次触发，只会被推入到队列中一次。</p><p>解决办法：</p><p>可在数据变化之后立即使用 Vue.nextTick(callback)。这样回调函数在 DOM 更新完成后就会调用</p><h3 id="vue中data为什么是函数而不是对象？"><a href="#vue中data为什么是函数而不是对象？" class="headerlink" title="vue中data为什么是函数而不是对象？"></a>vue中data为什么是函数而不是对象？</h3><p>vue组件是可复用的vue实例，一个组件被创建好之后，就可能被用在各个地方，而组件不管被复用了多少次，组件中的data数据都应该是相互隔离，互不影响的.</p><p>基于这一理念，组件每复用一次，data数据就会被复制一次，之后，当某一处复用的地方组件内data数据被改变时，其他复用地方组件的data数据不受影响。</p><p>如果data是对象的话，每当被复用是，复用的对象和源对象都会指向同一个内存地址（浅拷贝），互相之间相互影响，所以要是函数</p><h3 id="vue中父子组件传值，父组件异步请求，子组件不能实时更新怎么解决？（vue中数据不能实时更新怎么解决？）"><a href="#vue中父子组件传值，父组件异步请求，子组件不能实时更新怎么解决？（vue中数据不能实时更新怎么解决？）" class="headerlink" title="vue中父子组件传值，父组件异步请求，子组件不能实时更新怎么解决？（vue中数据不能实时更新怎么解决？）"></a>vue中父子组件传值，父组件异步请求，子组件不能实时更新怎么解决？（vue中数据不能实时更新怎么解决？）</h3><p>首先了解父子组件生命周期执行顺序<br>加载渲染数据过程<br>父组件 beforeCreate<br>父组件 created<br>父组件 beforeMount<br>子组件 beforeCreate<br>子组件 created<br>子组件 beforeMount<br>子组件 mounted<br>父组件 mounted</p><p>原因：因为生命周期只会执行一次，数据是要等到异步请求以后才能拿到，那么子组件的mounted钩子执行的时候，还没有拿到父组件传递过来的数据，但是又必须要打印出来结果，那这样的话，就只能去打印props中的默认值空字符串了，所以打印的结果是一个空字符串。</p><p>解决办法：</p><p>1、使用v-if控制组件渲染的时机</p><p>初始还没拿到后端接口的异步数据的时候，不让组件渲染，等拿到的时候再去渲染组件。使用v-if&#x3D;”变量”去控制，初始让这个变量为false，这样的话，子组件就不会去渲染，等拿到数据的时候，再让这个变量变成true，</p><p>举例：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">isTrue</span>:<span class="literal">false</span> <span class="comment">// 初始为false</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="title function_">monted</span>(<span class="params"></span>)&#123;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$post</span>.<span class="property">a</span>.<span class="property">b</span>.<span class="property">c</span>.<span class="title function_">getData</span>(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(res.<span class="property">result</span>)&#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">isTrue</span> = <span class="literal">true</span></span><br><span class="line">       &#125;</span><br><span class="line">   &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2、使用watch监听数据的变化</p><p>举例：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">props</span>: &#123;</span><br><span class="line">  <span class="attr">tableData</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">Array</span>,</span><br><span class="line">    <span class="attr">default</span>: [],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">watch</span>: &#123;</span><br><span class="line">   <span class="title function_">tableData</span>(<span class="params">val</span>)&#123;</span><br><span class="line">       <span class="variable language_">console</span>.<span class="title function_">log</span>(val)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>3、使用VueX</p><h3 id="Vue-路由跳转方式"><a href="#Vue-路由跳转方式" class="headerlink" title="Vue 路由跳转方式"></a>Vue 路由跳转方式</h3><p>router-link 标签跳转<br>this.$router.push()<br>this.$router.replace()<br>this.$router.go(n)：（0：当前页，-1上一页，+1下一页，n代表整数）</p><h3 id="Vue-中-for循环为什么加-key？"><a href="#Vue-中-for循环为什么加-key？" class="headerlink" title="Vue 中 for循环为什么加 key？"></a>Vue 中 for循环为什么加 key？</h3><p>为了性能优化， 因为vue是虚拟DOM，更新DOM时用diff算法对节点进行一一比对，比如有很多li元素，要在某个位置插入一个li元素，但没有给li上加key，那么在进行运算的时候，就会将所有li元素重新渲染一遍，但是如果有key，那么它就会按照key一一比对li元素，只需要创建新的li元素，插入即可，不需要对其他元素进行修改和重新渲染。<br>key也不能是li元素的index，因为假设我们给数组前插入一个新元素，它的下标是0，那么和原来的第一个元素重复了，整个数组的key都发生了改变，这样就跟没有key的情况一样了。</p><h3 id="vue路由守卫有哪些？"><a href="#vue路由守卫有哪些？" class="headerlink" title="vue路由守卫有哪些？"></a>vue路由守卫有哪些？</h3><p>路由守卫分为三种 ——分别是：全局路由守卫、组件路由守卫、独享路由守卫。</p><p>全局守卫<br>全局守卫又分为全局前置守卫、和后置守卫</p><ol><li>router.beforeEach((to,from,next)&#x3D;&gt;{})</li></ol><p>回调函数中的参数，to：进入到哪个路由去，from：从哪个路由离开，next：函数，决定是否展示你要看到的路由页面。</p><p>从名字全局前置守卫不难理解，它是全局的，即对 整个单页应用（SPA） 中的所有路由都生效，所以当定义了全局的前置守卫，在进入每一个路由之前都会调用这个回调，那么如果你在回调中对路由的跳转条件判断出错，简单点就是死循环…因为你遗漏了某种路由跳转的情况，守卫会一直执行。所以在使用全局前置守卫的时候一定要判断清楚可能会出现的路由跳转的情况。</p><p>2.router.afterEach((to, from) &#x3D;&gt; {}）</p><p>只有两个参数，to：进入到哪个路由去，from：从哪个路由离。</p><p>理解了全局前置守卫，那么全局后置守卫也就那么一回事。全局后置守卫是整个单页应用中每一次路由跳转后都会执行其中的回调。所以多用于路由跳转后的相应页面操作，并不像全局前置守卫那样会在回调中进行页面的重定向或跳转。</p><p>组件内的守卫<br>组件路由守卫分为到达这个组件时，离开这个组件时</p><ol><li>beforeRouteEnter:(to,from,next)&#x3D;&gt;{}——到达</li></ol><p>to，from参数与上面使用方法一致。next回调函数略有不同。<br>1<br>2.beforeRouteUpdate:(to,from,next)&#x3D;&gt;{}——更新</p><ol start="3"><li>beforeRouteLeave:(to,from,next)&#x3D;&gt;{}——离开</li></ol><p>点击其他组件时，判断是否确认离开。确认执行next()；取消执行next(false)，留在当前页面。<br>1<br>路由独享的守卫</p><ol><li>beforeEnter:(to,from,next)&#x3D;&gt;{}</li></ol><p>与全局路由守卫用法一致，但是只能针对一个页面使用<br>1</p><h3 id="vue常⽤的修饰符"><a href="#vue常⽤的修饰符" class="headerlink" title="vue常⽤的修饰符"></a>vue常⽤的修饰符</h3><p>.stop:等统⼀JavaScript中的event.stopPropagation(),防⽌事件冒泡<br>.prevent:等同于JavaScript中的event。preventDefault(),防⽌执⾏预设的⾏为(如果事件可<br>取消，则取消该事件，⽽不停⽌事件的进⼀步传播)；<br>.capture:与事件冒泡的⽅向相反，事件捕获由外到内<br>.self:只会触发⾃⼰范围内的事件，不包含⼦元素；<br>.once:只会触发⼀次。</p><h3 id="vue的两个核⼼点"><a href="#vue的两个核⼼点" class="headerlink" title="vue的两个核⼼点"></a>vue的两个核⼼点</h3><p>数据驱动：ViewModel，保证数据和视图的⼀致性<br>组件系统：应⽤类UI可以看做全部是由组件树构成的</p><h3 id="delete和Vue-delete删除数组的区别"><a href="#delete和Vue-delete删除数组的区别" class="headerlink" title="delete和Vue.delete删除数组的区别"></a>delete和Vue.delete删除数组的区别</h3><p>delete只是被删除的元素变成了empty&#x2F;undefined其他的元素的键值还是不变。<br>Vue.delete直接删除了数组 改变了数组的键值</p><h3 id="vue常⽤的UI组件库"><a href="#vue常⽤的UI组件库" class="headerlink" title="vue常⽤的UI组件库"></a>vue常⽤的UI组件库</h3><p>Mint UI，element，VUX</p><h3 id="简单介绍一下-Element-UI-的框架设计？"><a href="#简单介绍一下-Element-UI-的框架设计？" class="headerlink" title="简单介绍一下 Element UI 的框架设计？"></a>简单介绍一下 Element UI 的框架设计？</h3><h3 id="Vue首页白屏是什么问题引起的？如何解决呢？"><a href="#Vue首页白屏是什么问题引起的？如何解决呢？" class="headerlink" title="Vue首页白屏是什么问题引起的？如何解决呢？"></a>Vue首页白屏是什么问题引起的？如何解决呢？</h3><h3 id="为什么data是个函数并且返回一个对象呢？"><a href="#为什么data是个函数并且返回一个对象呢？" class="headerlink" title="为什么data是个函数并且返回一个对象呢？"></a>为什么data是个函数并且返回一个对象呢？</h3><p><code>data</code>之所以是一个函数，是因为一个组件可能会多处调用，而每一次调用就会执行 <code>data函数</code>并返回新的数据对象，这样，可以避免多处调用之间的 <code>数据污染</code>。</p><h3 id="如何获取data中某一个数据的初始状态？"><a href="#如何获取data中某一个数据的初始状态？" class="headerlink" title="如何获取data中某一个数据的初始状态？"></a>如何获取data中某一个数据的初始状态？</h3><blockquote><p>在开发中，有时候需要拿初始状态去计算。例如</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">num</span>: <span class="number">10</span></span><br><span class="line">    &#125;,</span><br><span class="line"><span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">num</span> = <span class="number">1000</span></span><br><span class="line">  &#125;,</span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">howMuch</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 计算出num增加了多少，那就是1000 - 初始值</span></span><br><span class="line">        <span class="comment">// 可以通过this.$options.data().xxx来获取初始值</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1000</span> - <span class="variable language_">this</span>.<span class="property">$options</span>.<span class="title function_">data</span>().<span class="property">num</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h3 id="Vue的修饰符"><a href="#Vue的修饰符" class="headerlink" title="Vue的修饰符"></a>Vue的修饰符</h3><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5a1c911988f74cea91da79af3c6049c2~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp" alt="截屏2021-07-11 下午9.56.53.png"></p><h3 id="Vue的内部指令"><a href="#Vue的内部指令" class="headerlink" title="Vue的内部指令"></a>Vue的内部指令</h3><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d39d348e686b449e8931f5a85802e3c6~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp" alt="image.png"></p><h3 id="动态指令和参数使用过吗？"><a href="#动态指令和参数使用过吗？" class="headerlink" title="动态指令和参数使用过吗？"></a>动态指令和参数使用过吗？</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    ...</span><br><span class="line">    &lt;aButton @[someEvent]=<span class="string">&quot;handleSomeEvent()&quot;</span> :[someProps]=<span class="string">&quot;1000&quot;</span> /&gt;...</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    ...</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">data</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">return</span>&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            ...</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">someEvent</span>: someCondition ? <span class="string">&quot;click&quot;</span> : <span class="string">&quot;dbclick&quot;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">someProps</span>: someCondition ? <span class="string">&quot;num&quot;</span> : <span class="string">&quot;price&quot;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">methods</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="title function_">handleSomeEvent</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="comment">// handle some event</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;  </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="如何设置动态class，动态style？"><a href="#如何设置动态class，动态style？" class="headerlink" title="如何设置动态class，动态style？"></a>如何设置动态class，动态style？</h3><ul><li><p>动态class对象：</p><p><code>&lt;div :class=&quot;&#123; &#39;is-active&#39;: true, &#39;red&#39;: isRed &#125;&quot;&gt;&lt;/div&gt;</code></p></li><li><p>动态class数组：</p><p><code>&lt;div :class=&quot;[&#39;is-active&#39;, isRed ? &#39;red&#39; : &#39;&#39; ]&quot;&gt;&lt;/div&gt;</code></p></li><li><p>动态style对象：</p><p><code>&lt;div :style=&quot;&#123; color: textColor, fontSize: &#39;18px&#39; &#125;&quot;&gt;&lt;/div&gt;</code></p></li><li><p>动态style数组：</p></li></ul><p><code>&lt;div :style=&quot;[&#123; color: textColor, fontSize: &#39;18px&#39; &#125;, &#123; fontWeight: &#39;300&#39; &#125;]&quot;&gt;&lt;/div&gt;</code></p><h3 id="为什么v-if和v-for不建议用在同一标签？"><a href="#为什么v-if和v-for不建议用在同一标签？" class="headerlink" title="为什么v-if和v-for不建议用在同一标签？"></a>为什么v-if和v-for不建议用在同一标签？</h3><p>在Vue2中，<code>v-for</code>优先级是高于 <code>v-if</code>的，咱们来看例子</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div v-<span class="keyword">for</span>=<span class="string">&quot;item in [1, 2, 3, 4, 5, 6, 7]&quot;</span> v-<span class="keyword">if</span>=<span class="string">&quot;item !== 3&quot;</span>&gt;</span><br><span class="line">    &#123;&#123;item&#125;&#125;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>上面的写法是 <code>v-for</code>和 <code>v-if</code>同时存在，会先把7个元素都遍历出来，然后再一个个判断是否为3，并把3给隐藏掉，这样的坏处就是，渲染了无用的3节点，增加无用的dom操作，建议使用computed来解决这个问题：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;div v-<span class="keyword">for</span>=<span class="string">&quot;item in list&quot;</span>&gt;</span><br><span class="line">    &#123;&#123;item&#125;&#125;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"><span class="title function_">computed</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">list</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>].<span class="title function_">filter</span>(<span class="function"><span class="params">item</span> =&gt;</span> item !== <span class="number">3</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="State：定义了应用状态的数据结构，可以在这里设置默认的初始状态。"><a href="#State：定义了应用状态的数据结构，可以在这里设置默认的初始状态。" class="headerlink" title="* State：定义了应用状态的数据结构，可以在这里设置默认的初始状态。"></a>* State：定义了应用状态的数据结构，可以在这里设置默认的初始状态。</h3><ul><li>Getter：允许组件从 Store 中获取数据，mapGetters 辅助函数仅仅是将 store 中的 getter 映射到局部计算属性。</li><li>Mutation：是唯一更改 store 中状态的方法，且必须是同步函数。</li><li>Action：用于提交 mutation，而不是直接变更状态，可以包含任意异步操作。</li><li>Module：允许将单一的 Store 拆分为多个 store 且同时保存在单一的状态树中。</li></ul><h3 id="不需要响应式的数据应该怎么处理？"><a href="#不需要响应式的数据应该怎么处理？" class="headerlink" title="不需要响应式的数据应该怎么处理？"></a>不需要响应式的数据应该怎么处理？</h3><p>在我们的Vue开发中，会有一些数据，从始至终都 <code>未曾改变过</code>，这种 <code>死数据</code>，既然 <code>不改变</code>，那也就 <code>不需要对他做响应式处理</code>了，不然只会做一些无用功消耗性能，比如一些写死的下拉框，写死的表格数据，这些数据量大的 <code>死数据</code>，如果都进行响应式处理，那会消耗大量性能。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方法一：将数据定义在data之外</span></span><br><span class="line">data () &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">list1</span> = &#123; xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">list2</span> = &#123; xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">list3</span> = &#123; xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">list4</span> = &#123; xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">list5</span> = &#123; xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="comment">// 方法二：Object.freeze()</span></span><br><span class="line">data () &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">list1</span>: <span class="title class_">Object</span>.<span class="title function_">freeze</span>(&#123;xxxxxxxxxxxxxxxxxxxxxxxx&#125;),</span><br><span class="line">        <span class="attr">list2</span>: <span class="title class_">Object</span>.<span class="title function_">freeze</span>(&#123;xxxxxxxxxxxxxxxxxxxxxxxx&#125;),</span><br><span class="line">        <span class="attr">list3</span>: <span class="title class_">Object</span>.<span class="title function_">freeze</span>(&#123;xxxxxxxxxxxxxxxxxxxxxxxx&#125;),</span><br><span class="line">        <span class="attr">list4</span>: <span class="title class_">Object</span>.<span class="title function_">freeze</span>(&#123;xxxxxxxxxxxxxxxxxxxxxxxx&#125;),</span><br><span class="line">        <span class="attr">list5</span>: <span class="title class_">Object</span>.<span class="title function_">freeze</span>(&#123;xxxxxxxxxxxxxxxxxxxxxxxx&#125;),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="对象新属性无法更新视图，删除属性无法更新视图，为什么？怎么办？"><a href="#对象新属性无法更新视图，删除属性无法更新视图，为什么？怎么办？" class="headerlink" title="对象新属性无法更新视图，删除属性无法更新视图，为什么？怎么办？"></a>对象新属性无法更新视图，删除属性无法更新视图，为什么？怎么办？</h3><ul><li>原因：<code>Object.defineProperty</code>没有对对象的新属性进行属性劫持</li><li>对象新属性无法更新视图：使用 <code>Vue.$set(obj, key, value)</code>，组件中 <code>this.$set(obj, key, value)</code></li><li>删除属性无法更新视图：使用 <code>Vue.$delete(obj, key)</code>，组件中 <code>this.$delete(obj, key)</code></li></ul><h3 id="直接arr-index-x3D-xxx无法更新视图怎么办？为什么？怎么办？"><a href="#直接arr-index-x3D-xxx无法更新视图怎么办？为什么？怎么办？" class="headerlink" title="直接arr[index] &#x3D; xxx无法更新视图怎么办？为什么？怎么办？"></a>直接arr[index] &#x3D; xxx无法更新视图怎么办？为什么？怎么办？</h3><ul><li>原因：Vue没有对数组进行 <code>Object.defineProperty</code>的属性劫持，所以直接arr[index] &#x3D; xxx是无法更新视图的</li><li>使用数组的splice方法，<code>arr.splice(index, 1, item)</code></li><li>使用 <code>Vue.$set(arr, index, value)</code></li></ul><h3 id="为什么不建议用index做key，为什么不建议用随机数做key？"><a href="#为什么不建议用index做key，为什么不建议用随机数做key？" class="headerlink" title="为什么不建议用index做key，为什么不建议用随机数做key？"></a>为什么不建议用index做key，为什么不建议用随机数做key？</h3><p>举个例子：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">&lt;div v-<span class="keyword">for</span>=<span class="string">&quot;(item, index) in list&quot;</span> :key=<span class="string">&quot;index&quot;</span>&gt;&#123;&#123;item.<span class="property">name</span>&#125;&#125;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"><span class="attr">list</span>: [</span><br><span class="line">    &#123; <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>, <span class="attr">id</span>: <span class="string">&#x27;123&#x27;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">name</span>: <span class="string">&#x27;小红&#x27;</span>, <span class="attr">id</span>: <span class="string">&#x27;124&#x27;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">name</span>: <span class="string">&#x27;小花&#x27;</span>, <span class="attr">id</span>: <span class="string">&#x27;125&#x27;</span> &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">渲染为</span><br><span class="line">&lt;div key=<span class="string">&quot;0&quot;</span>&gt;小明&lt;/div&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&quot;1&quot;</span>&gt;</span>小红<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&quot;2&quot;</span>&gt;</span>小花<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">现在我执行 </span><br><span class="line">list.<span class="title function_">unshift</span>(&#123; <span class="attr">name</span>: <span class="string">&#x27;小林&#x27;</span>, <span class="attr">id</span>: <span class="string">&#x27;122&#x27;</span> &#125;)</span><br><span class="line"></span><br><span class="line">渲染为</span><br><span class="line">&lt;div key=<span class="string">&quot;0&quot;</span>&gt;小林&lt;/div&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&quot;1&quot;</span>&gt;</span>小明<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&quot;2&quot;</span>&gt;</span>小红<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&quot;3&quot;</span>&gt;</span>小花<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">新旧对比</span><br><span class="line"></span><br><span class="line">&lt;div key=<span class="string">&quot;0&quot;</span>&gt;小明&lt;<span class="regexp">/div&gt;  &lt;div key=&quot;0&quot;&gt;小林&lt;/</span>div&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&quot;1&quot;</span>&gt;</span>小红<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&quot;1&quot;</span>&gt;</span>小明<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&quot;2&quot;</span>&gt;</span>小花<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&quot;2&quot;</span>&gt;</span>小红<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">                         <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&quot;3&quot;</span>&gt;</span>小花<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">可以看出，如果用index做key的话，其实是更新了原有的三项，并新增了小花，虽然达到了渲染目的，但是损耗性能</span><br><span class="line"></span><br><span class="line">现在我们使用id来做key，渲染为</span><br><span class="line"></span><br><span class="line">&lt;div key=<span class="string">&quot;123&quot;</span>&gt;小明&lt;/div&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&quot;124&quot;</span>&gt;</span>小红<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&quot;125&quot;</span>&gt;</span>小花<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">现在我执行 list.<span class="title function_">unshift</span>(&#123; <span class="attr">name</span>: <span class="string">&#x27;小林&#x27;</span>, <span class="attr">id</span>: <span class="string">&#x27;122&#x27;</span> &#125;)，渲染为</span><br><span class="line"></span><br><span class="line">&lt;div key=<span class="string">&quot;122&quot;</span>&gt;小林&lt;/div&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&quot;123&quot;</span>&gt;</span>小明<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&quot;124&quot;</span>&gt;</span>小红<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&quot;125&quot;</span>&gt;</span>小花<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">新旧对比</span><br><span class="line"></span><br><span class="line">                           &lt;div key=<span class="string">&quot;122&quot;</span>&gt;小林&lt;/div&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&quot;123&quot;</span>&gt;</span>小明<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&quot;123&quot;</span>&gt;</span>小明<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&quot;124&quot;</span>&gt;</span>小红<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&quot;124&quot;</span>&gt;</span>小红<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&quot;125&quot;</span>&gt;</span>小花<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&quot;125&quot;</span>&gt;</span>小花<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">可以看出，原有的三项都不变，只是新增了小林这个人，这才是最理想的结果</span><br></pre></td></tr></table></figure><p>用 <code>index</code>和用 <code>随机数</code>都是同理，<code>随机数</code>每次都在变，做不到专一性，很 <code>渣男</code>，也很消耗性能，所以，拒绝 <code>渣男</code>，选择 <code>老实人</code></p><h3 id="nextTick的原理"><a href="#nextTick的原理" class="headerlink" title="nextTick的原理"></a>nextTick的原理</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> callbacks = []; <span class="comment">//回调函数</span></span><br><span class="line"><span class="keyword">let</span> pending = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">flushCallbacks</span>(<span class="params"></span>) &#123;</span><br><span class="line">    pending = <span class="literal">false</span>; <span class="comment">//把标志还原为false</span></span><br><span class="line">    <span class="comment">// 依次执行回调</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; callbacks.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        callbacks[i]();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> timerFunc; <span class="comment">//先采用微任务并按照优先级优雅降级的方式实现异步刷新</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="title class_">Promise</span> !== <span class="string">&quot;undefined&quot;</span>) &#123;</span><br><span class="line">    <span class="comment">// 如果支持promise</span></span><br><span class="line">    <span class="keyword">const</span> p = <span class="title class_">Promise</span>.<span class="title function_">resolve</span>();</span><br><span class="line">    timerFunc = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        p.<span class="title function_">then</span>(flushCallbacks);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="title class_">MutationObserver</span> !== <span class="string">&quot;undefined&quot;</span>) &#123;</span><br><span class="line">    <span class="comment">// MutationObserver 主要是监听dom变化 也是一个异步方法</span></span><br><span class="line">    <span class="keyword">let</span> counter = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">const</span> observer = <span class="keyword">new</span> <span class="title class_">MutationObserver</span>(flushCallbacks);</span><br><span class="line">    <span class="keyword">const</span> textNode = <span class="variable language_">document</span>.<span class="title function_">createTextNode</span>(<span class="title class_">String</span>(counter));</span><br><span class="line">    observer.<span class="title function_">observe</span>(textNode, &#123;</span><br><span class="line">        <span class="attr">characterData</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">    timerFunc = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    counter = (counter + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">    textNode.<span class="property">data</span> = <span class="title class_">String</span>(counter);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> setImmediate !== <span class="string">&quot;undefined&quot;</span>) &#123;</span><br><span class="line">    <span class="comment">// 如果前面都不支持 判断setImmediate</span></span><br><span class="line">    timerFunc = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">setImmediate</span>(flushCallbacks);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 最后降级采用setTimeout</span></span><br><span class="line">    timerFunc = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(flushCallbacks, <span class="number">0</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">nextTick</span>(<span class="params">cb</span>) &#123;</span><br><span class="line">    callbacks.<span class="title function_">push</span>(cb);</span><br><span class="line">    <span class="keyword">if</span> (!pending) &#123;</span><br><span class="line">        pending = <span class="literal">true</span>;</span><br><span class="line">        <span class="title function_">timerFunc</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="nextTick的用处"><a href="#nextTick的用处" class="headerlink" title="nextTick的用处"></a>nextTick的用处</h3><p>我举个例子，在vue中：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">name</span> = <span class="string">&#x27;林三心&#x27;</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">age</span> = <span class="number">18</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">gender</span> = <span class="string">&#x27;男&#x27;</span></span><br></pre></td></tr></table></figure><p>我们修改了三个变量，那问题来了，是每修改一次，DOM就更新一次吗？不是的，Vue采用的是 <code>异步更新</code>的策略，通俗点说就是，<code>同一事件循环内</code>多次修改，会 <code>统一</code>进行一次 <code>视图更新</code>，这样才能节省性能嘛</p><p>看懂了上面，那你应该也看得懂下面的例子了吧：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;div ref=<span class="string">&quot;testDiv&quot;</span>&gt;&#123;&#123;name&#125;&#125;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"><span class="attr">name</span>: <span class="string">&#x27;小林&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">name</span> = <span class="string">&#x27;林三心&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">testDiv</span>.<span class="property">innerHTML</span>) <span class="comment">// 这里是啥呢</span></span><br></pre></td></tr></table></figure><p>答案是“小林”，前面说了，Vue是 <code>异步更新</code>，所以数据一更新，视图却还没更新，所以拿到的还是上一次的旧视图数据，那么想要拿到最新视图数据怎么办呢？</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">name</span> = <span class="string">&#x27;林三心&#x27;</span></span><br><span class="line"><span class="variable language_">this</span>.$nextTick(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">testDiv</span>.<span class="property">innerHTML</span>) <span class="comment">// 林三心</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="Vue的SSR是什么？有什么好处？"><a href="#Vue的SSR是什么？有什么好处？" class="headerlink" title="Vue的SSR是什么？有什么好处？"></a>Vue的SSR是什么？有什么好处？</h3><ul><li><code>SSR</code>就是服务端渲染</li><li>基于 <code>nodejs serve</code>服务环境开发，所有 <code>html</code>代码在服务端渲染</li><li>数据返回给前端，然后前端进行“激活”，即可成为浏览器识别的html代码</li><li><code>SSR</code>首次加载更快，有更好的用户体验，有更好的seo优化，因为爬虫能看到整个页面的内容，如果是vue项目，由于数据还要经过解析，这就造成爬虫并不会等待你的数据加载完成，所以其实Vue项目的seo体验并不是很好</li></ul><h3 id="Vue响应式是怎么实现的？"><a href="#Vue响应式是怎么实现的？" class="headerlink" title="Vue响应式是怎么实现的？"></a>Vue响应式是怎么实现的？</h3><p>整体思路：数据劫持+观察者模式</p><p>对象内部通过 <code> defineReactive</code> 方法，使用 <code>Object.defineProperty</code> 将属性进行劫持（只会劫持已经存在的属性），数组则是通过重写数组方法来实现。当页面使用对应属性时，每个属性都拥有自己的 <code>dep</code>属性，存放他所依赖的 <code> watcher</code>（依赖收集），当属性变化后会通知自己对应的 <code> watcher</code> 去更新(派发更新)。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; arrayMethods &#125; = <span class="built_in">require</span>(<span class="string">&#x27;./array&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Observer</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">value</span>) &#123;</span><br><span class="line">        <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(value, <span class="string">&#x27;__ob__&#x27;</span>, &#123;</span><br><span class="line">            <span class="attr">value</span>: <span class="variable language_">this</span>,</span><br><span class="line">            <span class="attr">enumerable</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">writable</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">configurable</span>: <span class="literal">true</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">if</span>(<span class="title class_">Array</span>.<span class="title function_">isArray</span>(value)) &#123;</span><br><span class="line">            value.<span class="property">__proto__</span> = arrayMethods</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">observeArray</span>(value)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">walk</span>(value)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">walk</span>(<span class="params">data</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> keys = <span class="title class_">Object</span>.<span class="title function_">keys</span>(data)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; keys.<span class="property">length</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">const</span> key = keys[i]</span><br><span class="line">            <span class="keyword">const</span> value = data[key]</span><br><span class="line">            <span class="title function_">defineReactive</span>(data, key, value)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">observeArray</span>(<span class="params">items</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; items.<span class="property">length</span>; i++) &#123;</span><br><span class="line">            <span class="title function_">observe</span>(items[i])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">defineReactive</span>(<span class="params">data, key, value</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> childOb = <span class="title function_">observe</span>(value)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> dep = <span class="keyword">new</span> <span class="title class_">Dep</span>()</span><br><span class="line"></span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(data, key, &#123;</span><br><span class="line">        <span class="title function_">get</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;获取值&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> (<span class="title class_">Dep</span>.<span class="property">target</span>) &#123;</span><br><span class="line">                dep.<span class="title function_">depend</span>()</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (childOb) &#123;</span><br><span class="line">                    childOb.<span class="property">dep</span>.<span class="title function_">depend</span>()</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(value)) &#123;</span><br><span class="line">                        <span class="title function_">dependArray</span>(value)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> value</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="title function_">set</span>(<span class="params">newVal</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (newVal === value) <span class="keyword">return</span></span><br><span class="line">            <span class="title function_">observe</span>(newVal)</span><br><span class="line">            value = newVal</span><br><span class="line">            dep.<span class="title function_">notify</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">observe</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(value) === <span class="string">&#x27;[object Object]&#x27;</span> || <span class="title class_">Array</span>.<span class="title function_">isArray</span>(value)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Observer</span>(value)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">dependArray</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> e, i = <span class="number">0</span>, l = value.<span class="property">length</span>; i &lt; l; i++) &#123;</span><br><span class="line">        e = value[i]</span><br><span class="line"></span><br><span class="line">        e &amp;&amp; e.<span class="property">__ob__</span> &amp;&amp; e.<span class="property">__ob__</span>.<span class="property">dep</span>.<span class="title function_">depend</span>()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(e)) &#123;</span><br><span class="line">            <span class="title function_">dependArray</span>(e)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// array.js</span></span><br><span class="line"><span class="keyword">const</span> arrayProto = <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> arrayMethods = <span class="title class_">Object</span>.<span class="title function_">create</span>(arrayProto)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> methodsToPatch = [</span><br><span class="line">    <span class="string">&#x27;push&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;pop&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;shift&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;unshift&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;splice&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;reverse&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sort&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">methodsToPatch.<span class="title function_">forEach</span>(<span class="function"><span class="params">method</span> =&gt;</span> &#123;</span><br><span class="line">    arrayMethods[method] = <span class="keyword">function</span> (<span class="params">...args</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> result = arrayProto[method].<span class="title function_">apply</span>(<span class="variable language_">this</span>, args)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> ob = <span class="variable language_">this</span>.<span class="property">__ob__</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> inserted</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> (method) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;push&#x27;</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;unshift&#x27;</span>:</span><br><span class="line">                inserted = args</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;splice&#x27;</span>:</span><br><span class="line">                inserted = args.<span class="title function_">slice</span>(<span class="number">2</span>)</span><br><span class="line">            <span class="attr">default</span>:</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (inserted) ob.<span class="title function_">observeArray</span>(inserted)</span><br><span class="line"></span><br><span class="line">        ob.<span class="property">dep</span>.<span class="title function_">notify</span>()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="为什么只对对象劫持，而要对数组进行方法重写？"><a href="#为什么只对对象劫持，而要对数组进行方法重写？" class="headerlink" title="为什么只对对象劫持，而要对数组进行方法重写？"></a>为什么只对对象劫持，而要对数组进行方法重写？</h3><p>因为对象最多也就几十个属性，拦截起来数量不多，但是数组可能会有几百几千项，拦截起来非常耗性能，所以直接重写数组原型上的方法，是比较节省性能的方案</p><h3 id="Vue-set方法的原理"><a href="#Vue-set方法的原理" class="headerlink" title="Vue.set方法的原理"></a>Vue.set方法的原理</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">set</span>(<span class="params">target, key, val</span>) &#123;</span><br><span class="line">    <span class="comment">// 判断是否是数组</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(target)) &#123;</span><br><span class="line">        <span class="comment">// 判断谁大谁小</span></span><br><span class="line">        target.<span class="property">length</span> = <span class="title class_">Math</span>.<span class="title function_">max</span>(target.<span class="property">length</span>, key)</span><br><span class="line">        <span class="comment">// 执行splice</span></span><br><span class="line">        target.<span class="title function_">splice</span>(key, <span class="number">1</span>, val)</span><br><span class="line">        <span class="keyword">return</span> val</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> ob = target.<span class="property">__ob__</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果此对象没有不是响应式对象，直接设置并返回</span></span><br><span class="line">    <span class="keyword">if</span> (key <span class="keyword">in</span> target &amp;&amp; !(key <span class="keyword">in</span> target.<span class="property"><span class="keyword">prototype</span></span>) || !ob) &#123;</span><br><span class="line">        target[key] = val</span><br><span class="line">        <span class="keyword">return</span> val</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 否则，新增属性，并响应式处理</span></span><br><span class="line">    <span class="title function_">defineReactive</span>(target, key, val)</span><br><span class="line">    <span class="keyword">return</span> val</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Vue-delete方法的原理？"><a href="#Vue-delete方法的原理？" class="headerlink" title="Vue.delete方法的原理？"></a>Vue.delete方法的原理？</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">del</span> (target, key) &#123;</span><br><span class="line">    <span class="comment">// 判断是否为数组</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(target)) &#123;</span><br><span class="line">        <span class="comment">// 执行splice</span></span><br><span class="line">        target.<span class="title function_">splice</span>(key, <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> ob = target.<span class="property">__ob__</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 对象本身就没有这个属性，直接返回</span></span><br><span class="line">    <span class="keyword">if</span> (!(key <span class="keyword">in</span> target)) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 否则，删除这个属性</span></span><br><span class="line">    <span class="keyword">delete</span> target[key]</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 判断是否是响应式对象，不是的话，直接返回</span></span><br><span class="line">    <span class="keyword">if</span> (!ob) <span class="keyword">return</span></span><br><span class="line">    <span class="comment">// 是的话，删除后要通知视图更新</span></span><br><span class="line">    ob.<span class="property">dep</span>.<span class="title function_">notify</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="如果子组件改变props里的数据会发生什么"><a href="#如果子组件改变props里的数据会发生什么" class="headerlink" title="如果子组件改变props里的数据会发生什么"></a>如果子组件改变props里的数据会发生什么</h3><ul><li>改变的props数据是基本类型</li></ul><blockquote><p>如果修改的是基本类型，则会报错</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">props</span>: &#123;</span><br><span class="line">    <span class="attr">num</span>: <span class="title class_">Number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">created</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">num</span> = <span class="number">999</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/047859eda3bf47a5930dd0b28e842017~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp" alt="0458e2ff1538ee85d42953cec9a94ca.png"></p><ul><li>改变的props数据是引用类型</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">props</span>: &#123;</span><br><span class="line">    <span class="attr">item</span>: &#123;</span><br><span class="line">        <span class="attr">default</span>: <span class="function">() =&gt;</span> (&#123;&#125;),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">created</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 不报错，并且父级数据会跟着变</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">item</span>.<span class="property">name</span> = <span class="string">&#x27;sanxin&#x27;</span>;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// 会报错，跟基础类型报错一样</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">item</span> = <span class="string">&#x27;sss&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="props怎么自定义验证"><a href="#props怎么自定义验证" class="headerlink" title="props怎么自定义验证"></a>props怎么自定义验证</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">props</span>: &#123;</span><br><span class="line">    <span class="attr">num</span>: &#123;</span><br><span class="line">      <span class="attr">default</span>: <span class="number">1</span>,</span><br><span class="line">      <span class="attr">validator</span>: <span class="keyword">function</span> (<span class="params">value</span>) &#123;</span><br><span class="line">          <span class="comment">// 返回值为false则验证不通过，报错</span></span><br><span class="line">          <span class="keyword">return</span> [</span><br><span class="line">            <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span></span><br><span class="line">          ].<span class="title function_">indexOf</span>(value) !== -<span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h3 id="审查元素时发现data-v-xxxxx，这是啥？"><a href="#审查元素时发现data-v-xxxxx，这是啥？" class="headerlink" title="审查元素时发现data-v-xxxxx，这是啥？"></a>审查元素时发现data-v-xxxxx，这是啥？</h3><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ff63f90f2d924ff6b20622a2d05ba367~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp" alt="image.png"></p><blockquote><p>这是在标记vue文件中css时使用scoped标记产生的，因为要保证各文件中的css不相互影响，给每个component都做了唯一的标记，所以每引入一个component就会出现一个新的’data-v-xxx’标记</p></blockquote><h3 id="vue的hook的使用"><a href="#vue的hook的使用" class="headerlink" title="vue的hook的使用"></a>vue的hook的使用</h3><ul><li>同一组件中使用</li></ul><blockquote><p>这是我们常用的使用定时器的方式</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span>&#123;</span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="attr">timer</span>:<span class="literal">null</span>  </span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">mounted</span>(<span class="params"></span>)&#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">timer</span> = <span class="built_in">setInterval</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">      <span class="comment">//具体执行内容</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;1&#x27;</span>);</span><br><span class="line">    &#125;,<span class="number">1000</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">beforeDestory</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">timer</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">timer</span> = <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>上面做法不好的地方在于：得全局多定义一个timer变量，可以使用hook这么做：</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span>&#123;</span><br><span class="line">  <span class="attr">methods</span>:&#123;</span><br><span class="line">    <span class="title function_">fn</span>(<span class="params"></span>)&#123;</span><br><span class="line">      <span class="keyword">let</span> timer = <span class="built_in">setInterval</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="comment">//具体执行代码</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;1&#x27;</span>);</span><br><span class="line">      &#125;,<span class="number">1000</span>);</span><br><span class="line">      <span class="variable language_">this</span>.$once(<span class="string">&#x27;hook:beforeDestroy&#x27;</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">clearInterval</span>(timer);</span><br><span class="line">        timer = <span class="literal">null</span>;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>7.2 父子组件使用</li></ul><blockquote><p>如果子组件需要在mounted时触发父组件的某一个函数，平时都会这么写：</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//父组件</span></span><br><span class="line">&lt;rl-child @childMounted=<span class="string">&quot;childMountedHandle&quot;</span></span><br><span class="line">/&gt;</span><br><span class="line">method () &#123;</span><br><span class="line">  <span class="title function_">childMountedHandle</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// do something...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line"><span class="comment">// 子组件</span></span><br><span class="line">mounted () &#123;</span><br><span class="line">  <span class="variable language_">this</span>.$emit(<span class="string">&#x27;childMounted&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>使用hook的话可以更方便：</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//父组件</span></span><br><span class="line">&lt;rl-child @<span class="attr">hook</span>:mounted=<span class="string">&quot;childMountedHandle&quot;</span></span><br><span class="line">/&gt;</span><br><span class="line">method () &#123;</span><br><span class="line">  <span class="title function_">childMountedHandle</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// do something...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="provide和inject是响应式的吗？"><a href="#provide和inject是响应式的吗？" class="headerlink" title="provide和inject是响应式的吗？"></a>provide和inject是响应式的吗？</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 祖先组件</span></span><br><span class="line"><span class="title function_">provide</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">   <span class="comment">// keyName: &#123; name: this.name &#125;, // value 是对象才能实现响应式，也就是引用类型</span></span><br><span class="line">      <span class="attr">keyName</span>: <span class="variable language_">this</span>.<span class="property">changeValue</span> <span class="comment">// 通过函数的方式也可以[注意，这里是把函数作为value，而不是this.changeValue()]</span></span><br><span class="line">   <span class="comment">// keyName: &#x27;test&#x27; value 如果是基本类型，就无法实现响应式</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"><span class="title function_">data</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line"><span class="attr">name</span>:<span class="string">&#x27;张三&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">  <span class="title function_">changeValue</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = <span class="string">&#x27;改变后的名字-李四&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">  &#125;  </span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 后代组件</span></span><br><span class="line">  <span class="attr">inject</span>:[<span class="string">&#x27;keyName&#x27;</span>]</span><br><span class="line">  <span class="title function_">create</span>(<span class="params"></span>)&#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">keyName</span>) <span class="comment">// 改变后的名字-李四</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Vue的el属性和-mount优先级？"><a href="#Vue的el属性和-mount优先级？" class="headerlink" title="Vue的el属性和$mount优先级？"></a>Vue的el属性和$mount优先级？</h3><blockquote><p>比如下面这种情况，Vue会渲染到哪个节点上</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  router,</span><br><span class="line">  store,</span><br><span class="line">  <span class="attr">el</span>: <span class="string">&#x27;#app&#x27;</span>,</span><br><span class="line">  <span class="attr">render</span>: <span class="function"><span class="params">h</span> =&gt;</span> <span class="title function_">h</span>(<span class="title class_">App</span>)</span><br><span class="line">&#125;).$mount(<span class="string">&#x27;#ggg&#x27;</span>)</span><br></pre></td></tr></table></figure><blockquote><p>这是官方的一张图，可以看出 <code>el</code>和 <code>$mount</code>同时存在时，<code>el优先级</code> &gt; <code>$mount</code></p></blockquote><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/da6331091cb145459e0b543c76e9bfc6~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp" alt="image.png"></p><h3 id="自定义v-model"><a href="#自定义v-model" class="headerlink" title="自定义v-model"></a>自定义v-model</h3><blockquote><p>默认情况下，v-model 是 @input 事件侦听器和 :value 属性上的语法糖。但是，你可以在你的Vue组件中指定一个模型属性来定义使用什么事件和value属性——非常棒！</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="attr">default</span>: &#123;</span><br><span class="line">  <span class="attr">model</span>: &#123;</span><br><span class="line">    <span class="attr">event</span>: <span class="string">&#x27;change&#x27;</span>,</span><br><span class="line">    <span class="attr">prop</span>: <span class="string">&#x27;checked&#x27;</span>  </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="计算变量时，methods和computed哪个好？"><a href="#计算变量时，methods和computed哪个好？" class="headerlink" title="计算变量时，methods和computed哪个好？"></a>计算变量时，methods和computed哪个好？</h3><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><span class="template-variable">&#123;&#123;<span class="name">howMuch1</span>()&#125;&#125;</span><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><span class="template-variable">&#123;&#123;<span class="name">howMuch2</span>&#125;&#125;</span><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><span class="template-variable">&#123;&#123;<span class="name">index</span>&#125;&#125;</span><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">data: () &#123;</span></span><br><span class="line"><span class="language-xml">    return &#123;</span></span><br><span class="line"><span class="language-xml">         index: 0</span></span><br><span class="line"><span class="language-xml">       &#125;</span></span><br><span class="line"><span class="language-xml">     &#125;</span></span><br><span class="line"><span class="language-xml">methods: &#123;</span></span><br><span class="line"><span class="language-xml">    howMuch1() &#123;</span></span><br><span class="line"><span class="language-xml">        return this.num + this.price</span></span><br><span class="line"><span class="language-xml">    &#125;</span></span><br><span class="line"><span class="language-xml">  &#125;</span></span><br><span class="line"><span class="language-xml">computed: &#123;</span></span><br><span class="line"><span class="language-xml">    howMuch2() &#123;</span></span><br><span class="line"><span class="language-xml">        return this.num + this.price</span></span><br><span class="line"><span class="language-xml">    &#125;</span></span><br><span class="line"><span class="language-xml">  &#125;</span></span><br></pre></td></tr></table></figure><blockquote><p><code>computed</code>会好一些，因为computed会有 <code>缓存</code>。例如index由0变成1，那么会触发视图更新，这时候methods会重新执行一次，而computed不会，因为computed依赖的两个变量num和price都没变。</p></blockquote><h2 id="React"><a href="#React" class="headerlink" title="React"></a>React</h2><h3 id="react的生命周期"><a href="#react的生命周期" class="headerlink" title="react的生命周期"></a>react的生命周期</h3><p>生命周期是什么？<br>react 实例的生命周期，就是react实例从初始化，更新，到销毁的过程</p><p>react实例生命周期经历三个阶段<br>初始化阶段：完成从react组件创建到首次渲染的过程</p><p>更新阶段：当调用setState函数时，会引起组件的重新渲染</p><p>销毁阶段：完成组件的销毁</p><p>三个阶段分别对应的构造函数有<br>初始化阶段：<br>constructor<br>构造函数里，可以做状态的初始化，接收props的传值<br>componentWillMount： 在渲染前调用，相当于vue中的beforeMount</p><p>render<br>渲染函数，不要在这里修改数据。 vue中也有render函数。</p><p>componentDidMount<br>渲染完毕，在第一次渲染后调用。</p><p>运行中阶段（更新）<br>当组件的 props 或 state 发生变化时会触发更新（严谨的说，是只要调用了setState（）或者改变了props时）。组件更新的生命周期调用顺序如下：</p><p>shouldComponentUpdate<br>是否更新？ 需要返回true或者false。如果是false，那么组件就不会继续更新了。</p><p>componentWillUpdate<br>即将更新。<br>componentWillReceiveProps(nextProps)： 在组件接收到一个新的 prop (更新后)时被调用。<br>这个方法在初始化render时不会被调用。nextProps 是props的新值，而 this.props是旧值。</p><p>render<br>不要在这里修改数据</p><p>componentDidUpdate<br>在组件完成更新后立即调用。在初始化时不会被调用。 相当于vue中的updated</p><p>销毁阶段（卸载）<br>componentWillUnmount()<br>即将卸载，可以做一些组件相关的清理工作，例如取消计时器、网络请求等</p><h3 id="为什么虚拟DOM-会提高性能"><a href="#为什么虚拟DOM-会提高性能" class="headerlink" title="为什么虚拟DOM 会提高性能"></a>为什么虚拟DOM 会提高性能</h3><p> 首先，（虚拟DOM是什么） 虚拟DOM就是一个JavaScript对象。通过这个JavaScript对象来描述真实DOM</p><p> 如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">tagName</span>: <span class="string">&quot;p&quot;</span>,</span><br><span class="line">    <span class="attr">style</span>: <span class="string">&quot;width:200px;height: 100px;&quot;</span>,</span><br><span class="line">    <span class="attr">innerHTML</span>: <span class="string">&quot;我是p&quot;</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>其次，操作虚拟DOM，就是在操作javascript对象，所以，并不会引起页面的重绘和重排。而操作真实DOM是会引起页面的重绘和重排的。</p><h3 id="React的diff原理"><a href="#React的diff原理" class="headerlink" title="React的diff原理"></a>React的diff原理</h3><p>传统diff算法<br>需要遍历整棵树的节点然后进行比较，是一个深度递归的过程，运算复杂度常常是O(n^3)</p><p>react diff的优化策略<br>DOM节点跨层级的操作不做优化，因为很少这么做，这是针对的tree层级的策略；<br>对于同一个类的组件，会生成相似的树形结构，对于不同类的组件，生成不同的树形结构，这是针对conponent层级的策略；<br>对于同一级的子节点，拥有同层唯一的key值，来做删除、插入、移动的操作，这是针对element层级的策略；</p><h3 id="调用setState之后，发生了什么？"><a href="#调用setState之后，发生了什么？" class="headerlink" title="调用setState之后，发生了什么？"></a>调用setState之后，发生了什么？</h3><p>合并state<br>把传入setState（）里的参数对象和当前的state进行（属性）合并。 触发调和过程<br>（Reconciliation）</p><p>重新渲染组件<br>React 会以相对高效的方式根据新的状态构建 React 元素树并且着手重新渲染整个 UI 界面<br>React 会自动计算出新的树与老树的节点差异（用diff算法），然后根据差异对界面进行最小化重<br>渲染</p><h3 id="state和props的区别"><a href="#state和props的区别" class="headerlink" title="state和props的区别"></a>state和props的区别</h3><p>state是组件的状态，也叫组件内部的数据</p><p>props是组件的属性，也可以认为是外部给组件传入的数据</p><h3 id="React中的setState是同步执行还是异步执行？如果是异步的？怎么拿到执行后的state？"><a href="#React中的setState是同步执行还是异步执行？如果是异步的？怎么拿到执行后的state？" class="headerlink" title="React中的setState是同步执行还是异步执行？如果是异步的？怎么拿到执行后的state？"></a>React中的setState是同步执行还是异步执行？如果是异步的？怎么拿到执行后的state？</h3><p>setState是异步的。</p><p>如果要拿到修改后的状态，需要使用回调函数的方式，如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//改变状态后想做一些事情：</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">  属性名:属性值</span><br><span class="line">&#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//一般是用于在setState之后做一些操作</span></span><br><span class="line">  <span class="comment">//this.state == 修改之后的state</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="为什么不能直接用以下办法更新state"><a href="#为什么不能直接用以下办法更新state" class="headerlink" title="为什么不能直接用以下办法更新state"></a>为什么不能直接用以下办法更新state</h3><p>this.state.msg &#x3D; “hello”;</p><p>因为，这样不会引起组件的重新渲染，所以，数据修改后没法 呈现在页面上。</p><p>而调用setState()函数，会引起组件的重新渲染，这样更新的数据就会呈现在页面上。</p><h3 id="React-Class-组件有哪些周期函数？分别有什么作用？"><a href="#React-Class-组件有哪些周期函数？分别有什么作用？" class="headerlink" title="React Class 组件有哪些周期函数？分别有什么作用？"></a>React Class 组件有哪些周期函数？分别有什么作用？</h3><h3 id="React-Class-组件中请求可以在-componentWillMount-中发起吗？为什么？"><a href="#React-Class-组件中请求可以在-componentWillMount-中发起吗？为什么？" class="headerlink" title="React Class 组件中请求可以在 componentWillMount 中发起吗？为什么？"></a>React Class 组件中请求可以在 componentWillMount 中发起吗？为什么？</h3><h3 id="React-Class-组件和-React-Hook-的区别有哪些？"><a href="#React-Class-组件和-React-Hook-的区别有哪些？" class="headerlink" title="React Class 组件和 React Hook 的区别有哪些？"></a>React Class 组件和 React Hook 的区别有哪些？</h3><h3 id="React-中高阶函数和自定义-Hook-的优缺点？"><a href="#React-中高阶函数和自定义-Hook-的优缺点？" class="headerlink" title="React 中高阶函数和自定义 Hook 的优缺点？"></a>React 中高阶函数和自定义 Hook 的优缺点？</h3><h3 id="简要说明-React-Hook-中-useState-和-useEffect-的运行原理？"><a href="#简要说明-React-Hook-中-useState-和-useEffect-的运行原理？" class="headerlink" title="简要说明 React Hook 中 useState 和 useEffect 的运行原理？"></a>简要说明 React Hook 中 useState 和 useEffect 的运行原理？</h3><h3 id="React-如何发现重渲染、什么原因容易造成重渲染、如何避免重渲染？"><a href="#React-如何发现重渲染、什么原因容易造成重渲染、如何避免重渲染？" class="headerlink" title="React 如何发现重渲染、什么原因容易造成重渲染、如何避免重渲染？"></a>React 如何发现重渲染、什么原因容易造成重渲染、如何避免重渲染？</h3><h3 id="React-Hook-中-useEffect-有哪些参数，如何检测数组依赖项的变化？"><a href="#React-Hook-中-useEffect-有哪些参数，如何检测数组依赖项的变化？" class="headerlink" title="React Hook 中 useEffect 有哪些参数，如何检测数组依赖项的变化？"></a>React Hook 中 useEffect 有哪些参数，如何检测数组依赖项的变化？</h3><h3 id="React-的-useEffect-是如何监听数组依赖项的变化的？"><a href="#React-的-useEffect-是如何监听数组依赖项的变化的？" class="headerlink" title="React 的 useEffect 是如何监听数组依赖项的变化的？"></a>React 的 useEffect 是如何监听数组依赖项的变化的？</h3><h3 id="React-Hook-和闭包有什么关联关系？"><a href="#React-Hook-和闭包有什么关联关系？" class="headerlink" title="React Hook 和闭包有什么关联关系？"></a>React Hook 和闭包有什么关联关系？</h3><h3 id="React-中-useState-是如何做数据初始化的？"><a href="#React-中-useState-是如何做数据初始化的？" class="headerlink" title="React 中 useState 是如何做数据初始化的？"></a>React 中 useState 是如何做数据初始化的？</h3><h3 id="列举你常用的-React-性能优化技巧？"><a href="#列举你常用的-React-性能优化技巧？" class="headerlink" title="列举你常用的 React 性能优化技巧？"></a>列举你常用的 React 性能优化技巧？</h3>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 面试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VScode快捷键</title>
      <link href="/posts/af83e57c/"/>
      <url>/posts/af83e57c/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><table><thead><tr><th>col1</th><th>col2</th></tr></thead><tbody><tr><td>单词跳跃</td><td>Alt</td></tr><tr><td>单词选中</td><td>Alt+shift</td></tr><tr><td>注释</td><td>ctrl+’&#x2F;‘</td></tr><tr><td>代码块注释</td><td>Alt+shift+’A’</td></tr><tr><td>tab对齐</td><td>Alt+shift+’F’</td></tr><tr><td></td><td></td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> VScode </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>前沿知识</title>
      <link href="/posts/17615829/"/>
      <url>/posts/17615829/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>动态网页技术</p><ul><li>JSP</li><li>ASP</li><li>PHP</li></ul><p>MVC template：分层技术</p><p>平台兼容</p><p>&#x3D;&#x3D;&gt; prototype、jQuery、MooTools、Dojo、modernizer</p><p>UI组件化</p><p>&#x3D;&#x3D;&gt; Bindows、YUII、jQuery UI、Ext、Bootstrap、Semantic UI</p><p>分层模块化</p><p>&#x3D;&#x3D;&gt; JavaScript MVC、BackBone、Knockout、Vue、EmberJS、Angular、React</p><p>相对地址：</p><pre><code>当前目录./上一级目录../下一级./imgs</code></pre><p>绝对地址</p><p>引用地址</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>浏览器输入url回车之后发生了什么</title>
      <link href="/posts/d69b3681/"/>
      <url>/posts/d69b3681/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="url基本格式"><a href="#url基本格式" class="headerlink" title="url基本格式"></a>url基本格式</h2><p><code>http://user:pass@www.example.jp:80/dir/index.html?uid=1#ch1</code></p><blockquote><p>http:&#x2F;&#x2F;&#x3D;&#x3D;&gt;     协议，方案名（可忽略），<br>user:pass    &#x3D;&#x3D;&gt;     登录信息（认证）（可忽略）<br>@<a href="http://www.example.jp/">www.example.jp</a>&#x3D;&#x3D;&gt;     服务器地址（可忽略），表明服务器的ip&#x2F;域名与当前HTML所属的一致<br>:80&#x3D;&#x3D;&gt;     服务器的端口号（可忽略）1、http协议&#x3D;&gt;80端口号2、https协议&#x3D;&gt;443端口号<br>&#x2F;dir&#x2F;index.html&#x3D;&#x3D;&gt;     带层次的文件路径<br>?uid&#x3D;1&#x3D;&#x3D;&gt;     查询字符串<br>#ch1&#x3D;&#x3D;&gt;     片段标识符（用于页面内跳转）</p></blockquote><h2 id="大致流程"><a href="#大致流程" class="headerlink" title="大致流程"></a>大致流程</h2><ul><li>URL 解析</li><li>DNS 查询</li><li>TCP 连接</li><li>处理请求</li><li>接受响应</li><li>渲染页面</li><li>URL 解析</li><li>地址解析</li></ul><p>首先判断你输入的是一个合法的 URL 还是一个待搜索的关键词，并且根据你输入的内容进行自动完成、字符编码等操作。</p><p>HSTS</p><p>由于安全隐患，会使用 HSTS 强制客户端使用 HTTPS 访问页面。详见：你所不知道的 HSTS。</p><p>其他操作</p><p>浏览器还会进行一些额外的操作，比如安全检查、访问限制（之前国产浏览器限制 996.icu）。</p><p>检查缓存</p><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/What_happens_when_you_type_an_URL_in_the_browser_and_press_enter.png"></p><h2 id="DNS-查询"><a href="#DNS-查询" class="headerlink" title="DNS 查询"></a>DNS 查询</h2><p>基本步骤</p><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/What_happens_when_you_type_an_URL_in_the_browser_and_press_enter_baisc_process.png"></p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">浏览器缓存</button></li><li class="tab"><button type="button" data-href="#super-2">操作系统缓存</button></li><li class="tab"><button type="button" data-href="#super-3">路由器缓存</button></li><li class="tab"><button type="button" data-href="#super-4">ISP DNS 缓存</button></li><li class="tab"><button type="button" data-href="#super-5">根域名服务器查询</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>浏览器会先检查是否在缓存中，没有则调用系统库函数进行查询。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>操作系统也有自己的 DNS 缓存，但在这之前，会向检查域名是否存在本地的 Hosts 文件里，没有则向 DNS 服务器发送查询请求。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>路由器也有自己的缓存。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>ISP DNS 就是在客户端电脑上设置的首选 DNS 服务器，它们在大多数情况下都会有缓存。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p>在前面所有步骤没有缓存的情况下，本地 DNS 服务器会将请求转发到互联网上的根域，下面这个图很好的诠释了整个流程：<br><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/What_happens_when_you_type_an_URL_in_the_browser_and_press_enter_dns.png"></p><blockquote><p>根域名服务器：维基百科<br>需要注意的点</p></blockquote><ol><li>递归方式：一路查下去中间不返回，得到最终结果才返回信息（浏览器到本地 DNS 服务器的过程）</li><li>迭代方式，就是本地 DNS 服务器到根域名服务器查询的方式。</li><li>什么是 DNS 劫持</li><li>前端 dns-prefetch 优化</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="TCP-连接"><a href="#TCP-连接" class="headerlink" title="TCP 连接"></a>TCP 连接</h2><p>TCP&#x2F;IP 分为四层，在发送数据时，每层都要对数据进行封装：<br><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/What_happens_when_you_type_an_URL_in_the_browser_and_press_enter_tcp.png"></p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">应用层：发送 HTTP 请求</button></li><li class="tab"><button type="button" data-href="#super-2">传输层：TCP 传输报文</button></li><li class="tab"><button type="button" data-href="#super-3">网络层：IP 协议查询 Mac 地址</button></li><li class="tab"><button type="button" data-href="#super-4">链路层：以太网协议</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>在前面的步骤我们已经得到服务器的 IP 地址，浏览器会开始构造一个 HTTP 报文，其中包括：</p><ul><li>请求报头（Request Header）：请求方法、目标地址、遵循的协议等等</li><li>请求主体（其他参数）</li></ul><p>其中需要注意的点：</p><ul><li>浏览器只能发送 GET、POST 方法，而打开网页使用的是 GET 方法</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>传输层会发起一条到达服务器的 TCP 连接，为了方便传输，会对数据进行分割（以报文段为单位），并标记编号，方便服务器接受时能够準确地还原报文信息。<br>在建立连接前，会先进行 TCP 三次握手。</p><blockquote><p>关于 TCP&#x2F;IP 三次握手，网上已经有很多段子和图片生动地描述了。<br>相关知识点：</p><ol><li>SYN 泛洪攻击</li></ol></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>将数据段打包，并加入源及目标的 IP 地址，并且负责寻找传输路线。</p><p>判断目标地址是否与当前地址处于同一网络中，是的话直接根据 Mac 地址发送，否则使用路由表查找下一跳地址，以及使用 ARP 协议查询它的 Mac 地址。</p><blockquote><p>注意：在 OSI 参考模型中 ARP 协议位于链路层，但在 TCP&#x2F;IP 中，它位于网络层。</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">以太网协议</button></li><li class="tab"><button type="button" data-href="#super-2">Mac 地址</button></li><li class="tab"><button type="button" data-href="#super-3">广播</button></li><li class="tab"><button type="button" data-href="#super-4">服务器接受请求</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>根据以太网协议将数据分为以 “帧” 为单位的数据包，每一帧分为两个部分：</p><ul><li>标头：数据包的发送者、接受者、数据类型</li><li>数据：数据包具体内容</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>以太网规定了连入网络的所有设备都必须具备 “网卡” 接口，数据包都是从一块网卡传递到另一块网卡，网卡的地址就是 Mac 地址。每一个 Mac 地址都是独一无二的，具备了一对一的能力。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>发送数据的方法很原始，直接把数据通过 ARP 协议，向本网络的所有机器发送，接收方根据标头信息与自身 Mac 地址比较，一致就接受，否则丢弃。</p><p>注意：接收方回应是单播。</p><blockquote><p>相关知识点：</p><ol><li>ARP 攻击</li></ol></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>接受过程就是把以上步骤逆转过来，参见上图。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="服务器处理请求"><a href="#服务器处理请求" class="headerlink" title="服务器处理请求"></a>服务器处理请求</h2><p>大致流程</p><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/What_happens_when_you_type_an_URL_in_the_browser_and_press_enter_1.png"></p><p>HTTPD</p><p>最常见的 HTTPD 有 Linux 上常用的 Apache 和 Nginx，以及 Windows 上的 IIS。</p><p>它会监听得到的请求，然后开启一个子进程去处理这个请求。</p><p>处理请求</p><p>接受 TCP 报文后，会对连接进行处理，对 HTTP 协议进行解析（请求方法、域名、路径等），并且进行一些验证：</p><ul><li>验证是否配置虚拟主机</li><li>验证虚拟主机是否接受此方法</li><li>验证该用户可以使用该方法（根据 IP 地址、身份信息等）</li></ul><p>重定向</p><p>假如服务器配置了 HTTP 重定向，就会返回一个 301永久重定向响应，浏览器就会根据响应，重新发送 HTTP 请求（重新执行上面的过程）。</p><blockquote><p>关于更多：详见这篇文章</p></blockquote><p>URL 重写</p><p>然后会查看 URL 重写规则，如果请求的文件是真实存在的，比如图片、html、css、js 文件等，则会直接把这个文件返回。</p><p>否则服务器会按照规则把请求重写到 一个 REST 风格的 URL 上。</p><p>然后根据动态语言的脚本，来决定调用什么类型的动态文件解释器来处理这个请求。</p><p>以 PHP 语言的 MVC 框架举例，它首先会初始化一些环境的参数，根据 URL 由上到下地去匹配路由，然后让路由所定义的方法去处理请求。</p><h2 id="浏览器接受响应"><a href="#浏览器接受响应" class="headerlink" title="浏览器接受响应"></a>浏览器接受响应</h2><p>浏览器接收到来自服务器的响应资源后，会对资源进行分析。</p><p>首先查看 Response header，根据不同状态码做不同的事（比如上面提到的重定向）。</p><p>如果响应资源进行了压缩（比如 gzip），还需要进行解压。</p><p>然后，对响应资源做缓存。</p><p>接下来，根据响应资源里的 MIME 类型去解析响应内容（比如 HTML、Image 各有不同的解析方式）。</p><h2 id="渲染页面"><a href="#渲染页面" class="headerlink" title="渲染页面"></a>渲染页面</h2><p>浏览器内核</p><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/What_happens_when_you_type_an_URL_in_the_browser_and_press_enter_broswer.png"></p><p>不同的浏览器内核，渲染过程也不完全相同，但大致流程都差不多。</p><p>基本流程</p><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/What_happens_when_you_type_an_URL_in_the_browser_and_press_enter_2.png"></p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">HTML 解析</button></li><li class="tab"><button type="button" data-href="#super-2">CSS 解析</button></li><li class="tab"><button type="button" data-href="#super-3">渲染树</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>首先要知道浏览器解析是从上往下一行一行地解析的。</p><p>解析的过程可以分为四个步骤：</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">1. 解码（encoding）</button></li><li class="tab"><button type="button" data-href="#super-2">2. 预解析（pre-parsing）</button></li><li class="tab"><button type="button" data-href="#super-3">3.1 符号化（Tokenization）</button></li><li class="tab"><button type="button" data-href="#super-4">3.2 构建树（tree construction）</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>传输回来的其实都是一些二进制字节数据，浏览器需要根据文件指定编码（例如 UTF-8）转换成字符串，也就是 HTML 代码。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>预解析做的事情是提前加载资源，减少处理时间，它会识别一些会请求资源的属性，比如img标签的src属性，并将这个请求加到请求队列中。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>符号化是词法分析的过程，将输入解析成符号，HTML 符号包括，开始标签、结束标签、属性名和属性值。</p><p>它通过一个状态机去识别符号的状态，比如遇到&lt;，&gt;状态都会产生变化。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><blockquote><p>注意：符号化和构建树是并行操作的，也就是说只要解析到一个开始标签，就会创建一个 DOM 节点。</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>在上一步符号化中，解析器获得这些标记，然后以合适的方法创建DOM对象并把这些符号插入到DOM对象中。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Web page parsing<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Web page parsing<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>This is an example Web page.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/What_happens_when_you_type_an_URL_in_the_browser_and_press_enter_html.png"></p><p>浏览器容错进制</p><p>你从来没有在浏览器看过类似” 语法无效” 的错误，这是因为浏览器去纠正错误的语法，然后继续工作。</p><p>事件</p><p>当整个解析的过程完成以后，浏览器会通过DOMContentLoaded事件来通知DOM解析完成。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>一旦浏览器下载了 CSS，CSS 解析器就会处理它遇到的任何 CSS，根据语法规范解析出所有的 CSS 并进行标记化，然后我们得到一个规则表。</p><h2 id="各个过程都使用了哪些协议"><a href="#各个过程都使用了哪些协议" class="headerlink" title="各个过程都使用了哪些协议"></a>各个过程都使用了哪些协议</h2><p><img src="https://pic3.zhimg.com/80/v2-8c33715beb25959e046b67ac23746dae_720w.jpg" alt="img"></p><h2 id="DNS-域名解析过程"><a href="#DNS-域名解析过程" class="headerlink" title="DNS 域名解析过程"></a>DNS 域名解析过程</h2><blockquote><p>★ DNS，英文全称是<strong>domain name system</strong>，域名解析系统，是<strong>域名</strong>和<strong>IP地址</strong>相互映射的一个分布式数据库。</p><p>作用：根据域名查找对应的IP地址。</p></blockquote><p>DNS的解析过程如下图：</p><p><img src="https://pic3.zhimg.com/80/v2-d2ec98abedf62400562a05893901665a_720w.jpg"></p><p>假设要查询<strong><a href="http://www.baidu.com/">http://www.baidu.com</a></strong>的IP地址:</p><ol><li>查找浏览器的缓存,寻找<strong><a href="http://www.baidu.com/">http://www.baidu.com</a></strong>对应的IP地址，找到就直接返回；否则进行下一步。</li><li>将请求发往给本地DNS服务器，如果找到，直接返回；否则进行下一步；</li><li>本地DNS服务器向<strong>根域名服务器</strong>发送请求，根域名服务器返回负责 <code>.com</code>的顶级域名服务器的IP地址的列表。</li><li>本地DNS服务器再向其中一个负责 <code>.com</code>的顶级域名服务器发送一个请求，返回负责 <code>.baidu</code>的权威域名服务器的IP地址列表。</li><li>本地DNS服务器再向其中一个权威域名服务器发送一个请求，返回<strong><strong><a href="http://www.baidu.com/">http://www.baidu.com</a></strong></strong>所对应的IP地址。<img src="https://mmbiz.qpic.cn/mmbiz_png/PMZOEonJxWeP0w7dibn7l3skTzywDDCouE8Qtw0sO8NxUUiauUcG7M7Phbw6eJ4uEibHib0K7KK9uEcwmg2XVTuPcw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></li></ol><h2 id="CSS-匹配规则"><a href="#CSS-匹配规则" class="headerlink" title="CSS 匹配规则"></a>CSS 匹配规则</h2><p>在匹配一个节点对应的 CSS 规则时，是按照从右到左的顺序的，例如：div p { font-size :14px }会先寻找所有的p标签然后判断它的父元素是否为div。</p><p>所以我们写 CSS 时，尽量用 id 和 class，千万不要过度层叠。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>其实这就是一个 DOM 树和 CSS 规则树合并的过程。</p><blockquote><p>注意：渲染树会忽略那些不需要渲染的节点，比如设置了display:none的节点。</p></blockquote><p>计算</p><p>通过计算让任何尺寸值都减少到三个可能之一：auto、百分比、px，比如把rem转化为px。</p><p>级联</p><p>浏览器需要一种方法来确定哪些样式才真正需要应用到对应元素，所以它使用一个叫做specificity的公式，这个公式会通过：</p><ol><li>标签名、class、id</li><li>是否内联样式</li><li>!important</li></ol><p>然后得出一个权重值，取最高的那个。</p><p>渲染阻塞</p><p>当遇到一个script标签时，DOM 构建会被暂停，直至脚本完成执行，然后继续构建 DOM 树。</p><p>但如果 JS 依赖 CSS 样式，而它还没有被下载和构建时，浏览器就会延迟脚本执行，直至 CSS Rules 被构建。</p><p>所有我们知道：</p><ul><li>CSS 会阻塞 JS 执行</li><li>JS 会阻塞后面的 DOM 解析</li></ul><p>为了避免这种情况，应该以下原则：</p><ul><li>CSS 资源排在 JavaScript 资源前面</li><li>JS 放在 HTML 最底部，也就是 <code>&lt;/body&gt;</code>前</li></ul><p>另外，如果要改变阻塞模式，可以使用 defer 与 async，详见：这篇文章</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">佈局与绘製</button></li><li class="tab"><button type="button" data-href="#super-2">合并渲染层</button></li><li class="tab"><button type="button" data-href="#super-3">回流与重绘</button></li><li class="tab"><button type="button" data-href="#super-4">JavaScript 编译执行</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>确定渲染树种所有节点的几何属性，比如：位置、大小等等，最后输入一个盒子模型，它能精准地捕获到每个元素在屏幕内的准确位置与大小。</p><p>然后遍历渲染树，调用渲染器的 paint() 方法在屏幕上显示其内容。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>把以上绘制的所有图片合并，最终输出一张图片。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>回流 (reflow)</p><p>当浏览器发现某个部分发现变化影响了佈局时，需要倒回去重新渲染，会从html标签开始递归往下，重新计算位置和大小。</p><p>reflow 基本是无法避免的，因为当你滑动一下鼠标、resize 窗口，页面就会产生变化。</p><p>重绘 (repaint)</p><p>改变了某个元素的背景色、文字颜色等等不会影响周围元素的位置变化时，就会发生重绘。</p><p>每次重绘后，浏览器还需要合并渲染层并输出到屏幕上。</p><p>回流的成本要比重绘高很多，所以我们应该尽量避免产生回流。</p><p>比如：</p><ul><li>display:none 会触发回流，而 visibility:hidden 只会触发重绘。</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>大致流程</p><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/What_happens_when_you_type_an_URL_in_the_browser_and_press_enter_3.png"></p><p>可以分为三个阶段：</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">词法分析</button></li><li class="tab"><button type="button" data-href="#super-2">预编译</button></li><li class="tab"><button type="button" data-href="#super-3">执行</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>JS 脚本加载完毕后，会首先进入语法分析阶段，它首先会分析代码块的语法是否正确，不正确则抛出 “语法错误”，停止执行。</p><p>几个步骤：</p><ul><li>分词，例如将var a &#x3D; 2，，分成var、a、&#x3D;、2这样的词法单元。</li><li>解析，将词法单元转换成抽象语法树（AST）。</li><li>代码生成，将抽象语法树转换成机器指令。</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>JS 有三种运行环境：</p><ul><li>全局环境</li><li>函数环境</li><li>eval</li></ul><p>每进入一个不同的运行环境都会创建一个对应的执行上下文，根据不同的上下文环境，形成一个函数调用栈，栈底永远是全局执行上下文，栈顶则永远是当前执行上下文。</p><p>创建执行上下文</p><p>创建执行上下文的过程中，主要做了以下三件事：</p><ul><li>创建变量对象<ul><li>参数、函数、变量</li></ul></li><li>建立作用域链<ul><li>确认当前执行环境是否能访问变量</li></ul></li><li>确定 This 指向</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>JS 线程</p><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/What_happens_when_you_type_an_URL_in_the_browser_and_press_enter_7.png"></p><p>虽然 JS 是单线程的，但实际上参与工作的线程一共有四个：</p><blockquote><p>其中三个只是协助，只有 JS 引擎线程是真正执行的</p></blockquote><ul><li>JS 引擎线程：也叫 JS 内核，负责解析执行 JS 脚本程序的主线程，例如 V8 引擎</li><li>事件触发线程：属于浏览器内核线程，主要用于控制事件，例如鼠标、键盘等，当事件被触发时，就会把事件的处理函数推进事件队列，等待 JS 引擎线程执行</li><li>定时器触发线程：主要控制setInterval和setTimeout，用来计时，计时完毕后，则把定时器的处理函数推进事件队列中，等待 JS 引擎线程。</li><li>HTTP 异步请求线程：通过 XMLHttpRequest 连接后，通过浏览器新开的一个线程，监控 readyState 状态变更时，如果设置了该状态的回调函数，则将该状态的处理函数推进事件队列中，等待 JS 引擎线程执行。</li></ul><p>注：浏览器对同一域名的併发连接数是有限的，通常为 6 个。</p><p>宏任务</p><p>分为：</p><ul><li>同步任务：按照顺序执行，只有前一个任务完成后，才能执行后一个任务</li><li>异步任务：不直接执行，只有满足触发条件时，相关的线程将该异步任务推进任务队列中，等待 JS 引擎主线程上的任务执行完毕时才开始执行，例如异步 Ajax、DOM 事件，setTimeout 等。</li></ul><p>微任务</p><p>微任务是 ES6 和 Node 环境下的，主要 API 有：Promise，process.nextTick。</p><p>微任务的执行在宏任务的同步任务之后，在异步任务之前。</p><p><img src="https://gd4ark-1258805822.cos.ap-guangzhou.myqcloud.com/images/20190822185002.png"></p><p>代码例子</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;1&#x27;</span>); <span class="comment">// 宏任务 同步</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;2&#x27;</span>); <span class="comment">// 宏任务 异步</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;3&#x27;</span>); <span class="comment">// 宏任务 同步</span></span><br><span class="line">    <span class="title function_">resolve</span>();</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;4&#x27;</span>) <span class="comment">// 微任务</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;5&#x27;</span>) <span class="comment">// 宏任务 同步</span></span><br></pre></td></tr></table></figure><p>以上代码输出顺序为：1,3,5,4,2</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="页面加载过程"><a href="#页面加载过程" class="headerlink" title="页面加载过程"></a>页面加载过程</h3><ul><li>浏览器根据DNS服务器得到域名的IP地址</li><li>向这个IP的机器发送HTTP请求</li><li>服务器收到、处理并返回HTTP请求</li><li>浏览器得到返回内容（其实就是一堆HTML格式的字符串，因为只有HTML格式浏览器才能正确解析，这是W3C标准的要求）</li></ul><h3 id="浏览器渲染过程"><a href="#浏览器渲染过程" class="headerlink" title="浏览器渲染过程"></a>浏览器渲染过程</h3><ol><li>浏览器在接收到服务器返回的 <code>html</code>页面后</li><li><code>html</code>经过 <code>HTML parser</code>解析为 <code>DOM tree</code>(浏览器会把 <code>HTML</code>结构字符串解析转换 <code>DOM</code>树形结构）</li><li><code>CSS</code>规则经过 <code>CSS</code>解析器解析为 <code>style Rules</code>（<code>CSSOM tree</code>）</li><li>遇到 <code>javascript</code>会通过 <code>DOM API</code>和 <code>CSSDOM API</code>来操作 <code>DOM Tree</code>和 <code>CSS Rule Tree</code></li><li>解析完成后，浏览器引擎会整合 <code>DOM Tree</code> 和 <code>CSS Rule Tree</code> 来构造 <code>Rendering Tree</code>（渲染树）</li><li>渲染树构建完成后，由 <strong>“布局（layout）”</strong> 进行处理，即确定每个节点在屏幕上的确切显示位置以及样式</li><li>最后一步，进行 <strong>“绘制（painting）”</strong> ，遍历渲染树，并用UI后端层，将每一个节点绘制出来。</li><li>显示到浏览器上<br>流程图：<br><img src="/image/CSS-%E8%87%AA%E5%AD%A6%E4%B9%8B%E8%B7%AF/1663896906579.png" alt="1663896906579"><br><img src="https://img-blog.csdnimg.cn/9eefaafe2d9d4d969afb324e0d484aa1.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5Yia5aW95Lit5oSP5ZGA,size_19,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li></ol><p>简而言之：构建DOM tree + 构建CSSOM tree -&gt; 构建render tree -&gt; 布局 -&gt; 绘制</p><ul><li>Layout布局（文档流、盒模型、计算大小和位置等）</li><li>Paint绘制（把边框、颜色、文字颜色、阴影等画出来）</li><li>Composite合成（根据层叠关系展示画面）</li></ul><h3 id="影响DOM树构建的因素（js和css）"><a href="#影响DOM树构建的因素（js和css）" class="headerlink" title="影响DOM树构建的因素（js和css）"></a>影响DOM树构建的因素（js和css）</h3><p>CSS不会阻塞DOM的解析，但是会影响JAVAScript的运行，javaSscript会阻止DOM树的解析，最终css（CSSOM）会影响DOM树的渲染，也可以说最终会影响渲染树的生成。</p><p>javascript对DOM树构建和渲染是如何造成影响的，分成三种类型：<br>1、JavaScript脚本在html页面中<br>2、html页面中引入javaScript文件<br>3、html页面中有css样式</p><p>渲染效率与下面三点有关：</p><blockquote><ol><li>css选择器的查询定位效率</li><li>浏览器的渲染模式和算法</li><li>要进行渲染内容的大小</li></ol></blockquote><h3 id="影响DOM树构建的因素"><a href="#影响DOM树构建的因素" class="headerlink" title="影响DOM树构建的因素"></a>影响DOM树构建的因素</h3><ul><li><code>HTML</code>响应流被阻塞在网络中</li><li>有加载未完成的脚本</li><li>遇到 <code>&lt;script&gt;</code>, 但是此时还有未加载完的样式文件</li></ul><p>页面更新三种方式<br><img src="/image/CSS-%E8%87%AA%E5%AD%A6%E4%B9%8B%E8%B7%AF/1663897182217.png" alt="1663897182217"><br>打个比方，假设毛坯房有五层，你对毛坯房的第四层感到不满意，这下可惨了第五层了，由于第五层是后面的楼层，你第四层拆了重做，第五层也要拆了重做。<br><img src="/image/CSS-%E8%87%AA%E5%AD%A6%E4%B9%8B%E8%B7%AF/1663897186576.png" alt="1663897186576"><br>再打个比方,你对第四层的粉刷不满意,想换个颜色,这个时候只要在原来的基础上再粉刷一遍就行了,不涉及拆房子<br><img src="/image/CSS-%E8%87%AA%E5%AD%A6%E4%B9%8B%E8%B7%AF/1663897190736.png" alt="1663897190736"><br>最后打个比方，就是摆放家具位置而已</p>]]></content>
      
      
      <categories>
          
          <category> 计算机基础 </category>
          
          <category> 组成原理 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 组成原理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>chrome调试</title>
      <link href="/posts/363f0cc9/"/>
      <url>/posts/363f0cc9/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>打开调试器F12,或者点击鼠标右键，选择检查或检查属性</p><p>Elements[元素]：这里就是html和css了，我们经常在这里进行样式css调试</p><p>Console[控制台]：这里是打印器，可以理解为一个记录日志，所有的报错信息会在这里体现</p><ul><li>查看信息</li><li>运行脚本</li></ul><p>Sources[源代码]：这里是断点调试，也就是debugger，不明的话在你的js里面打上一个debugger试试就知道了，方便按步执行代码，找出代码在那一步出的错</p><ul><li>调试脚本</li><li>查看变量</li><li>查看堆栈</li><li>其他资源调试</li></ul><p>Network[网络]：这里是http请求的调试器，在这里可以查看所有的http请求，包括你的请求头，请求路径，请求参数，后台返回的数据还有请求的状态等等</p><ul><li>查看页面所有资源请求</li><li>查看单独资源信息</li><li>过滤和排序信息</li></ul><p>Performance[性能]：</p><p>Memory[内存]：</p><p>application[应用程序]：这里就是我们说的浏览器缓存了，存放着缓存的数据，缓存分两种</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> 语法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> chrome调试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vue实现网易云音乐</title>
      <link href="/posts/378022d8/"/>
      <url>/posts/378022d8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="技术基础"><a href="#技术基础" class="headerlink" title="技术基础"></a>技术基础</h2><p>Vue(2.5) + vuex + vue-router + vue-axios +better-scroll + Scss + ES6</p><h2 id="目的"><a href="#目的" class="headerlink" title="目的"></a>目的</h2><p>开发一款移动端webAPP，</p><p>UI界面参考安卓版的网易云音乐，</p><p>flex布局适配常见移动端</p><h2 id="技术栈"><a href="#技术栈" class="headerlink" title="技术栈"></a>技术栈</h2><h3 id="前端"><a href="#前端" class="headerlink" title="前端"></a>前端</h3><p>Vue：用于构建用户界面的 MVVM 框架</p><p>vue-router：为单页面应用提供的路由系统，使用了 Lazy Loading Routes 技术来实现异步加载优化性能</p><p>vuex：Vue 集中状态管理，在多个组件共享某些状态时非常便捷</p><p>vue-lazyload：实现图片懒加载，节省用户流量，优化页面加载速度</p><p>better-scroll：解决移动端各种滚动场景需求的插件，使移动端滑动体验更加流畅</p><p>SCSS：css 预编译处理器</p><p>ES6：ECMAScript 新一代语法，模块化、解构赋值、Promise、Class 等方法非常好用</p><h3 id="后端"><a href="#后端" class="headerlink" title="后端"></a>后端</h3><p>Node.js：利用 Express 搭建的本地测试服务器</p><p>vue-axios：用来请求后端 API 音乐数据</p><p>NeteaseCloudMusicApi：网易云音乐 NodeJS 版 API，提供音乐数据</p><h3 id="其他工具"><a href="#其他工具" class="headerlink" title="其他工具"></a>其他工具</h3><p>vue-cli：Vue 脚手架工具，快速初始化项目代码</p><p>eslint：代码风格检查工具，帮助我们规范代码书写（一定要养成良好的代码规范）</p><p>iconfont ：阿里巴巴图标库，</p><p>fastclick ：消除 click 移动游览器 300ms 的延时</p><h2 id="实现功能"><a href="#实现功能" class="headerlink" title="实现功能"></a>实现功能</h2><p>初始加载页面、播放器内核、轮播图（新歌首发、MV首发等）、每日推荐、推荐歌单（左右滑屏）、热榜页面、歌手页面、歌单详情、歌手详情、排行榜详情、搜索页面、播放列表、用户中心等等功能。</p><h3 id="推荐页面"><a href="#推荐页面" class="headerlink" title="推荐页面"></a>推荐页面</h3><p>推荐页分成三个部分，分别是 banner 轮播图、推荐歌单、推荐歌曲，数据都是使用 axios 请求 API 获取得到的，图片都使用 vue-lazyload 实现懒加载。</p><ol><li>轮播图 ：使用 better-scroll 实现，具体可以看这里 Slide 。点击跳转方面只实现歌曲和歌单的跳转，因为暂时只实现了这两个功能。</li><li>推荐歌单，推荐歌曲 ：使用 vuex 管理数据，方便组件之间的数据交互（播放器播放歌曲）。因为数据上还有播放数量，所以就顺便也加上去了。</li></ol><h3 id="排行榜页面"><a href="#排行榜页面" class="headerlink" title="排行榜页面"></a>排行榜页面</h3><p>同样是通过 API 获取到排行榜的数据，但是因为 API 获取到的是排行榜中所有歌曲的数据，所以难免在加载速度上有点慢，后期再看能不能优化一下，加载的慢毕竟太影响用户体验了，别的就没什么了。</p><h3 id="歌手页面"><a href="#歌手页面" class="headerlink" title="歌手页面"></a>歌手页面</h3><p>实现歌手列表的左右联动（这个需要理解理解），因为之前已经写过和这个有关的博客，所以就不多写了，具体可以看我之前的这个笔记移动端字母索引导航。</p><h3 id="歌曲列表组件"><a href="#歌曲列表组件" class="headerlink" title="歌曲列表组件"></a>歌曲列表组件</h3><p>用来显示歌曲列表，在很多的地方都进行了复用，例如：歌单详情页、排行榜详情页、歌手详情页、搜索结果、用户中心等等。</p><ol><li>歌单详情页  ： 通过歌单的 ID 来获取歌单中的歌曲数据，然后还做了一些体验上面的交互，比如上滑显示状态栏然后将状态栏标题变为歌单名，具体可以尝试一下就知道了。</li></ol><p>然后就是复用歌曲列表组建来显示歌曲。</p><ol start="2"><li>排行榜详情、歌手详情  ： 和歌单详情基本上没有什么区别，除了 UI 界面方面有细微的改动（根据不同的内容作出不同的优化）。</li><li>搜索功能</li></ol><p>实现功能：搜索歌手、歌单、歌曲、热门搜索、数据节流、上拉刷新、保存搜索记录。</p><p>通过关键字请求 API 获取搜索数据，显示歌手、歌单、歌曲。</p><p>实现了上刷新，因为搜索可以设置请求数据的条数，所以可以用来实现上刷新的功能。</p><p>通过节流函数实现数据节流，通过 localstorage 存储搜索数据。</p><ol start="4"><li>用户中心 ：将在本地存储的数据显示出来，方便用户使用，后期准备添加更多功能。</li></ol><h3 id="播放器"><a href="#播放器" class="headerlink" title="播放器"></a>播放器</h3><p>最最最重要的组件，毕竟是个音乐播放器，不能放歌那啥都是扯淡了。</p><p>实现功能：顺序播放、单曲循环、随机播放、收藏等。</p><p>播放、暂停使用 HTML5 的 audio 实现。</p><p>数据、播放状态、播放历史、习惯歌曲等方面使用了 vuex 来进行管理，因为数据太多，组件直接传递的话是会死人的，所以还是老老实实的用 vuex 吧，数据之前的传递真的很方便。</p><p>图标使用 iconfont 阿里巴巴图标库，中间的唱片旋转动画使用了 animation 实现。</p><p>歌词部分获取到网易的歌词数据，然后使用第三方库 lyric-parser 进行处理。实现显示歌词、拖动进度条歌词同步滚动、歌词跟随歌曲进度高亮。</p><p>通过 localstorage 存储喜欢歌曲、播放历史数据。</p><p>audio 标签在移动端不能够自动播放的问题</p><p>电脑端是没有这个问题的，这个问题真的是让我很头大，最后是用了很鬼畜的方法解决了（使用 addEventListener 监听 touchend 事件，然后在回调函数中让 audio 播放一次，具体看 App.vue 文件，注释有写）。</p><h3 id="播放列表"><a href="#播放列表" class="headerlink" title="播放列表"></a>播放列表</h3><p>显示和管理当前播放歌曲，可以用来删除列表中的歌曲、以及选择播放歌曲。</p><h2 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h2><ol><li>优化排行榜加载速度</li><li>优化重复代码</li><li>增加歌曲评论</li><li>增加 MV、电台 功能</li></ol>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> Vue </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>创建vue项目过程</title>
      <link href="/posts/d76ff8ff/"/>
      <url>/posts/d76ff8ff/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="启动运行vue-js项目（维护他人的项目）的方法"><a href="#启动运行vue-js项目（维护他人的项目）的方法" class="headerlink" title="启动运行vue.js项目（维护他人的项目）的方法"></a>启动运行vue.js项目（维护他人的项目）的方法</h2><h3 id="安装cnpm"><a href="#安装cnpm" class="headerlink" title="安装cnpm"></a>安装cnpm</h3><p>由于npm有些资源被屏蔽或者是国外资源的原因，经常会导致用npm安装依赖包的时候失败，所以还需要npm的国内镜像—cnpm<br>在命令行中输入</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install <span class="literal">-g</span> cnpm <span class="literal">--registry</span>=http://registry.npm.taobao.org</span><br></pre></td></tr></table></figure><h3 id="安装webpack"><a href="#安装webpack" class="headerlink" title="安装webpack"></a>安装webpack</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install webpack <span class="literal">-g</span></span><br></pre></td></tr></table></figure><p>webpack是一款模块加载器兼打包工具，它能把各种资源，例如JS（含JSX）、coffee、样式（含less&#x2F;sass）、图片等都作为模块来使用和处理。 webpack 的核心是 依赖分析,把依赖分析出来了，其他都是细枝末节。</p><h3 id="安装vue-cli"><a href="#安装vue-cli" class="headerlink" title="安装vue-cli"></a>安装vue-cli</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm install vue<span class="literal">-cli</span> <span class="literal">-g</span></span><br></pre></td></tr></table></figure><p>vue-cli是vue.js的脚手架，用于自动生成vue.js+webpack的项目模板，这个过程会耗时十几秒，等走完就好；好了，到此整个环境就搭建好了</p><h3 id="cd-x2F-项目名称"><a href="#cd-x2F-项目名称" class="headerlink" title="cd &#x2F;项目名称"></a>cd &#x2F;项目名称</h3><p>下面就是运行项目了，cd &#x2F;项目名称，进入项目。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ShopApp</span><br></pre></td></tr></table></figure><h3 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h3><p>进入项目之后安装依赖，安装成功</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure><p>注意：在这一步可能会出现这样的错误；因为你打开的是别人的项目，项目之中肯定有 node_modules模块，那么先删除掉，在执行npm install命令</p><h3 id="启动项目"><a href="#启动项目" class="headerlink" title="启动项目"></a>启动项目</h3><p>一切准备就绪，启动项目</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br></pre></td></tr></table></figure><h3 id="自动启动浏览器就会打开项目了"><a href="#自动启动浏览器就会打开项目了" class="headerlink" title="自动启动浏览器就会打开项目了"></a>自动启动浏览器就会打开项目了</h3><p>在浏览器中输入<a href="http://localhost:8080/#/%EF%BC%9B%E8%BF%9B%E5%85%A5%E9%A1%B9%E7%9B%AE%E9%A6%96%E9%A1%B5">http://localhost:8080/#/；进入项目首页</a></p><p>若是要访问其他页面，直接在#后面加上组件名称即可：例如<a href="http://localhost:8080/#/adjustIntegral">http://localhost:8080/#/adjustIntegral</a></p><h3 id="属性选择"><a href="#属性选择" class="headerlink" title="属性选择"></a>属性选择</h3><p>创建vue项目<br>指令：vue create vue-music-next<br>1、Manually select features<br>2、Babel、Router、VueX、CSS Pre-processors、Linter&#x2F;Formatter<br>3、3.x<br>4、Y<br>5、Sass<br>6、ESLint + Standard config<br>7、Lint on save<br>8、In package.json<br>9、Y<br>10、use npm</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> Vue </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>拓展内容-自学之路</title>
      <link href="/posts/4463c232/"/>
      <url>/posts/4463c232/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>HTTP理论、交互通信原理、服务端http服务器搭建、MIME、报文端口、监听抓包、网络业务模型、代理缓存、cookie session 鉴权认证、安全加密、Token、JWT、oauth、session管理、RESTful接口设计、协商合约、资源标识等原理规则性知识，</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> 拓展内容 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>WebStorage</title>
      <link href="/posts/3ad36bbc/"/>
      <url>/posts/3ad36bbc/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h1><h2 id="Cookie概述"><a href="#Cookie概述" class="headerlink" title="Cookie概述"></a>Cookie概述</h2><p>Cookie 是服务器提供的一种用于维护会话状态信息的数据，通过服务器发送到浏览器，浏览器保存在本地，当下一次有同源的请求时，将保存的Cookie值添加到请求头部，发送给服务端。这可以用来实现记录用户登录状态等功能。<br>服务器端可以使用Set-Cookie的响应头部来配置Cookie信息。</p><p>当 web 服务器向浏览器发送 web 页面时，在连接关闭后，服务端不会记录用户的信息</p><p>Cookie 的作用就是用于解决 “如何记录客户端的用户信息”：</p><p>当用户访问 web 页面时，它的名字可以记录在 cookie 中。<br>在用户下一次访问该页面时，可以在 cookie 中读取用户访问记录。<br>Cookie 以名&#x2F;值对形式存储，如下所示：<br><code>username=zhangsan</code><br>当浏览器从服务器上请求 web 页面时， 属于该页面的 cookie 会被添加到该请求中，服务端通过这种方式来获取用户的信息。</p><p>Cookie是服务器提供的一种用于维护会话状态信息的数据Cookie一般可以存储4k大小的数据，并且只能够被同源的网页所共享访问。<br>一条Cookie包括了5个属性值expires、domain、path、secure、HttpOnly，其中：</p><ul><li>expires指定了Cookie失效的时间</li><li>domain是域名，path是路径，domain和path一起限制了Cookie能够被哪些url访问。</li><li>secure规定了Cookie只能在确保安全的情况下传输</li><li>HttpOnly规定了这个Cookie只能被服务器访问，不能使用 JavaScript脚本访问。<br>在发生XHR的跨域请求的时候，即使是同源下的Cookie,也不会被自动添加到请求头部除非显示地规定。</li></ul><p>JavaScript 可以使用 document.cookie 属性来创建 、读取、及删除 Cookie。</p><h2 id="Cookie创建"><a href="#Cookie创建" class="headerlink" title="Cookie创建"></a>Cookie创建</h2><p>JavaScript 中，创建 cookie 如下所示：<br><code>document.cookie = &quot;username=zhangsan&quot;;</code><br>您还可以为 cookie 添加一个过期时间（以 UTC 或 GMT 时间）。默认情况下，cookie 在浏览器关闭时删除。<br><code>document.cookie = &quot;username=zhangsan; expires=Thu, 18 Dec 2043 12:00:00 GMT&quot;;</code><br>您可以使用 path 参数告诉浏览器 cookie 的路径。默认情况下，cookie 属于当前页面。<br><code>document.cookie = &quot;username=zhangsan; expires=Thu, 18 Dec 2043 12:00:00 GMT; path=/&quot;;</code></p><h2 id="Cookie读取"><a href="#Cookie读取" class="headerlink" title="Cookie读取"></a>Cookie读取</h2><p>JavaScript 中，读取 cookie 如下所示：</p><p>document.cookie 将以字符串的方式返回所有的 cookie，类型格式： cookie1&#x3D;value; cookie2&#x3D;value; cookie3&#x3D;value;</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="property">cookie</span> = <span class="string">&quot;username=zhangsan&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> cookies = <span class="variable language_">document</span>.<span class="property">cookie</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(cookies);</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/img_convert/7f5f050ac3395ad2d8e04a83f52b9f17.png" alt="image-20201023124113003"></p><h2 id="Cookie修改"><a href="#Cookie修改" class="headerlink" title="Cookie修改"></a>Cookie修改</h2><p>JavaScript 中，修改 cookie 如下所示：</p><p>使用 document.cookie 将旧的 cookie 将被覆盖就是修改。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="property">cookie</span> = <span class="string">&quot;username=zhangsan&quot;</span>;</span><br><span class="line"><span class="variable language_">document</span>.<span class="property">cookie</span> = <span class="string">&quot;username=lisi&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> cookies = <span class="variable language_">document</span>.<span class="property">cookie</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(cookies);</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/img_convert/fe094b63b05824c69ed5147e180b298b.png" alt="image-20201023124645689"></p><h2 id="Cookie删除"><a href="#Cookie删除" class="headerlink" title="Cookie删除"></a>Cookie删除</h2><p>JavaScript 中，删除 cookie 如下所示：</p><p>删除 cookie 非常简单，您只需要设置 expires 参数为以前的时间即可，如下所示，设置为 Thu, 01 Jan 1970 00:00:00 GMT:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="property">cookie</span> = <span class="string">&quot;username=zhangsan&quot;</span>;</span><br><span class="line"><span class="variable language_">document</span>.<span class="property">cookie</span> = <span class="string">&quot;username=; expires=Thu, 01 Jan 1970 00:00:00 GMT&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> cookies = <span class="variable language_">document</span>.<span class="property">cookie</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(cookies);</span><br></pre></td></tr></table></figure><h2 id="Cookie值设置函数"><a href="#Cookie值设置函数" class="headerlink" title="Cookie值设置函数"></a>Cookie值设置函数</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * Cookie值设置函数</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> cname     cookie名称</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> cvalue    cookie值</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> exdays    过期天数</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">setCookie</span>(<span class="params">cname, cvalue, exdays</span>) &#123;</span><br><span class="line"><span class="keyword">var</span> d = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">d.<span class="title function_">setTime</span>(d.<span class="title function_">getTime</span>() + (exdays * <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span>));</span><br><span class="line"><span class="keyword">var</span> expires = <span class="string">&quot;expires=&quot;</span> + d.<span class="title function_">toGMTString</span>();</span><br><span class="line"><span class="variable language_">document</span>.<span class="property">cookie</span> = cname + <span class="string">&quot;=&quot;</span> + cvalue + <span class="string">&quot;; &quot;</span> + expires;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Cookie值获取函数"><a href="#Cookie值获取函数" class="headerlink" title="Cookie值获取函数"></a>Cookie值获取函数</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * Cookie值获取函数</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> cname     cookie名称</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@returns</span> &#123;<span class="type">string</span>&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getCookie</span>(<span class="params">cname</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> name = cname + <span class="string">&quot;=&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> ca = <span class="variable language_">document</span>.<span class="property">cookie</span>.<span class="title function_">split</span>(<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; ca.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> c = ca[i].<span class="title function_">trim</span>();</span><br><span class="line">        <span class="keyword">if</span> (c.<span class="title function_">indexOf</span>(name) == <span class="number">0</span>) </span><br><span class="line">            <span class="keyword">return</span> c.<span class="title function_">substring</span>(name.<span class="property">length</span>, c.<span class="property">length</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="WebStorage"><a href="#WebStorage" class="headerlink" title="WebStorage"></a>WebStorage</h1><h2 id="WebStorage概述"><a href="#WebStorage概述" class="headerlink" title="WebStorage概述"></a>WebStorage概述</h2><p>WebStorage是HTML5中本地存储的解决方案之一，在HTML5的WebStorage概念引入之前除去IE User Data、Flash Cookie、Google Gears等看名字就不靠谱的解决方案，浏览器兼容的本地存储方案只有使用Cookie。有同学可能会问，既然有了Cookie本地存储，为什么还要引入WebStorage的概念？那就要说一说Cookie的缺陷了：</p><p>数据大小：作为存储容器，Cookie的大小限制在4KB左右这是非常坑爹的，尤其对于现在复杂的业务逻辑需求，4KB的容量除了存储一些配置字段还简单单值信息，对于绝大部分开发者来说真的不知指望什么了。<br>安全性问题：由于在HTTP请求中的Cookie是明文传递的（HTTPS不是），带来的安全性问题还是很大的。<br>网络负担：我们知道Cookie会被附加在每个HTTP请求中，在HttpRequest和HttpResponse的header中都是要被传输的，所以无形中增加了一些不必要的流量损失。<br>虽然WebStorage是HTML5新增的本地存储解决方案之一，但并不是为了取代Cookie而制定的标准，Cookie作为HTTP协议的一部分用来处理客户端和服务器通信是不可或缺的，session正是依赖于实现的客户端状态保持。WebStorage的意图在于解决本来不应该Cookie做，却不得不用Cookie的本地存储的应用场景。</p><h2 id="WebStorage分类"><a href="#WebStorage分类" class="headerlink" title="WebStorage分类"></a>WebStorage分类</h2><p>Web Storage又分为两种： sessionStorage 和localStorage ，即这两个是Storage的一个实例。从字面意思就可以很清楚的看出来，sessionStorage将数据保存在session中，浏览器关闭也就没了；而localStorage则一直将数据保存在客户端本地； 不管是sessionStorage，还是localStorage，使用的API都相同。</p><p>localStorage和sessionStorage只能存储字符串类型，对于复杂的对象可以使用ECMAScript提供的JSON对象的stringify和parse来处理，低版本IE可以使用json2.js</p><h2 id="localStorage方法"><a href="#localStorage方法" class="headerlink" title="localStorage方法"></a>localStorage方法</h2><p>对象介绍：</p><p>localStorage在本地永久性存储数据，除非显式将其删除或清空。</p><p>常见方法：</p><p>保存单个数据：localStorage.setItem(key,value);<br>读取单个数据：localStorage.getItem(key);<br>删除单个数据：localStorage.removeItem(key);<br>删除所有数据：localStorage.clear();<br>获取某个索引的key：localStorage.key(index);<br>案例演示：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 保存数据</span></span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;username&quot;</span>, <span class="string">&quot;zhangsan&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 读取单个数据</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;username&quot;</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;===============&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除单个数据</span></span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">removeItem</span>(<span class="string">&quot;username&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;username&quot;</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;===============&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 保存两个数据</span></span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;age&quot;</span>, <span class="number">18</span>);</span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;sex&quot;</span>, <span class="string">&quot;男&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;age=&quot;</span> + <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;age&quot;</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;sex=&quot;</span> + <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;sex&quot;</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;===============&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用for-in循环来迭代localStorage中的键值对、属性和方法：</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> <span class="variable language_">localStorage</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(key + <span class="string">&quot;=&quot;</span> + <span class="variable language_">localStorage</span>[key]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;===============&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用for循环来迭代localStorage中的键值对：</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">localStorage</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">var</span> key = <span class="variable language_">localStorage</span>.<span class="title function_">key</span>(i);</span><br><span class="line">    <span class="keyword">var</span> value = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(key);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(key + <span class="string">&quot;=&quot;</span> + value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;===============&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除所有数据</span></span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">clear</span>();</span><br></pre></td></tr></table></figure><p>控制台：<br><img src="https://img-blog.csdnimg.cn/img_convert/61686f1b890e4aed66a29ca7b99fb017.png" alt="image-20201023220221557"></p><h2 id="sessionStorage方法"><a href="#sessionStorage方法" class="headerlink" title="sessionStorage方法"></a>sessionStorage方法</h2><p>对象介绍：</p><p>sessionStorage对象存储特定于某个对话的数据，也就是它的生命周期为当前窗口或标签页，一旦窗口或标签页被永久关闭了，那么所有通过sessionStorage存储的数据也就被清空了。存储在sessionStorage中的数据可以跨越页面刷新而存在，同时如果浏览器支持，浏览器崩溃并重启之后依然可以使用（注意：Firefox和Weblit都支持，IE则不行）。</p><p>因为sessionStorage对象绑定于某个服务器会话，所以当文件在本地运行的时候是不可用的。存储在sessionStorage中的数据只能由最初给对象存储数据的页面访问到，所以对多页面应用有限制。</p><p>不同浏览器写入数据方法略有不同。Firefox和Webkit实现了同步写入，所以添加到存储空间中的数据是立刻被提交的。而IE的实现则是异步写入数据，所以在设置数据和将数据实际写入磁盘之间可能有一些延迟。</p><p>常见方法：</p><p>保存单个数据：sessionStorage.setItem(key,value);<br>读取单个数据：sessionStorage.getItem(key);<br>删除单个数据：sessionStorage.removeItem(key);<br>删除所有数据：sessionStorage.clear();<br>获取某个索引的key：sessionStorage.key(index);<br>案例演示：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 保存数据</span></span><br><span class="line">sessionStorage.<span class="title function_">setItem</span>(<span class="string">&quot;username&quot;</span>, <span class="string">&quot;zhangsan&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 读取单个数据</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(sessionStorage.<span class="title function_">getItem</span>(<span class="string">&quot;username&quot;</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;===============&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除单个数据</span></span><br><span class="line">sessionStorage.<span class="title function_">removeItem</span>(<span class="string">&quot;username&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(sessionStorage.<span class="title function_">getItem</span>(<span class="string">&quot;username&quot;</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;===============&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 保存两个数据</span></span><br><span class="line">sessionStorage.<span class="title function_">setItem</span>(<span class="string">&quot;age&quot;</span>, <span class="number">18</span>);</span><br><span class="line">sessionStorage.<span class="title function_">setItem</span>(<span class="string">&quot;sex&quot;</span>, <span class="string">&quot;男&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;age=&quot;</span> + sessionStorage.<span class="title function_">getItem</span>(<span class="string">&quot;age&quot;</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;sex=&quot;</span> + sessionStorage.<span class="title function_">getItem</span>(<span class="string">&quot;sex&quot;</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;===============&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用for-in循环来迭代sessionStorage中的键值对、属性和方法：</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> sessionStorage) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(key + <span class="string">&quot;=&quot;</span> + sessionStorage[key]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;===============&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用for循环来迭代sessionStorage中的键值对：</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; sessionStorage.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">var</span> key = sessionStorage.<span class="title function_">key</span>(i);</span><br><span class="line">    <span class="keyword">var</span> value = sessionStorage.<span class="title function_">getItem</span>(key);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(key + <span class="string">&quot;=&quot;</span> + value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;===============&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除所有数据</span></span><br><span class="line">sessionStorage.<span class="title function_">clear</span>();</span><br></pre></td></tr></table></figure><p>控制台：</p><p><img src="https://img-blog.csdnimg.cn/img_convert/1325a4d3c63e875d47b815eae84a29ac.png" alt="image-20201023220326391"></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>JSON</title>
      <link href="/posts/5d92c8f1/"/>
      <url>/posts/5d92c8f1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="JSON概述"><a href="#JSON概述" class="headerlink" title="JSON概述"></a>JSON概述</h2><p>JSON：JavaScript Object Notation（JavaScript 对象标记法），它是一种存储和交换数据的语法。</p><p>当数据在浏览器与服务器之间进行交换时，这些数据只能是文本，JSON 属于文本并且我们能够把任何 JavaScript 对象转换为 JSON，然后将 JSON 发送到服务器。我们也能把从服务器接收到的任何 JSON 转换为 JavaScript 对象。以这样的方式，我们能够把数据作为 JavaScript 对象来处理，无需复杂的解析和转译。</p><h2 id="JSON语法"><a href="#JSON语法" class="headerlink" title="JSON语法"></a>JSON语法</h2><p>在json中，每一个数据项，都是由一个<strong>键值对</strong>（也即<strong>名值对</strong>）组成的，但是<strong>键</strong>必须是字符串，且由双引号包围，而值必须是以下数据类型之一：</p><ul><li>字符串（在 JSON 中，字符串值必须由双引号编写）</li><li>数字</li><li>对象（JSON 对象）</li><li>数组</li><li>布尔</li><li>null</li></ul><p>JSON 的值不可以是以下数据类型之一：</p><ul><li>函数</li><li>日期</li><li>undefined</li></ul><p>因为 JSON 语法由 JavaScript 对象标记法衍生而来，所以很少需要其它额外的软件来处理 JavaScript 中的 JSON。</p><p>通过 JavaScript，您能够创建对象并向其分配数据，就像这样：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;zhangsan&quot;</span>, <span class="string">&quot;age&quot;</span>: <span class="number">62</span>, <span class="string">&quot;city&quot;</span>: <span class="string">&quot;BeiJing&quot;</span>&#125;;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person);</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/img_convert/d3060f7c44592e4b2e269ec2f290155a.png" alt="image-20201023091704109"></p><h2 id="JSON数据类型"><a href="#JSON数据类型" class="headerlink" title="JSON数据类型"></a>JSON数据类型</h2><h3 id="JSON-字符串"><a href="#JSON-字符串" class="headerlink" title="JSON 字符串"></a>JSON 字符串</h3><p>JSON 中的字符串必须用双引号包围。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;John&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="JSON-数字"><a href="#JSON-数字" class="headerlink" title="JSON 数字"></a>JSON 数字</h3><p>JSON 中的数字必须是整数或浮点数。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;age&quot;</span>: <span class="number">30</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="JSON-对象"><a href="#JSON-对象" class="headerlink" title="JSON 对象"></a>JSON 对象</h3><p>JSON 中的值可以是对象，JSON 中作为值的对象必须遵守与 JSON 对象相同的规则。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;employee&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Bill Gates&quot;</span>, </span><br><span class="line">        <span class="string">&quot;age&quot;</span>: <span class="number">62</span>, </span><br><span class="line">        <span class="string">&quot;city&quot;</span>: <span class="string">&quot;Seattle&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="JSON-数组"><a href="#JSON-数组" class="headerlink" title="JSON 数组"></a>JSON 数组</h3><p>JSON 中的值可以是数组。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;employees&quot;</span>: [<span class="string">&quot;Bill&quot;</span>, <span class="string">&quot;Steve&quot;</span>, <span class="string">&quot;David&quot;</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="JSON-布尔"><a href="#JSON-布尔" class="headerlink" title="JSON 布尔"></a>JSON 布尔</h3><p>JSON 中的值可以是 true&#x2F;false。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;sale&quot;</span>: <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="JSON-null"><a href="#JSON-null" class="headerlink" title="JSON null"></a>JSON null</h3><p>JSON 中的值可以是 null。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;middlename&quot;</span>: <span class="literal">null</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="JSON字符串转JS对象"><a href="#JSON字符串转JS对象" class="headerlink" title="JSON字符串转JS对象"></a>JSON字符串转JS对象</h2><p>JSON.parse()：可以将以JSON字符串转换为JS对象，它需要一个JSON字符串作为参数，会将该字符串转换为JS对象并返回</p><p>语法：<code>JSON.parse(text[, reviver])</code><br>参数：</p><ul><li>text：被解析的字符串</li><li>reviver（不常用）：规定原始value的改造规则<br>返回值：JavaScript值或对象</li></ul><p>案例演示：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> jsonStr = <span class="string">&#x27;&#123;&quot;name&quot;:&quot;孙悟空&quot;,&quot;age&quot;:18,&quot;gender&quot;:&quot;男&quot;&#125;&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> obj = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(jsonStr);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj);</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/img_convert/75043196321febfa7ff2044a01c36251.png" alt="image-20201023093124404"></p><p>注意 ：JSON这个对象在IE7及以下的浏览器中不支持，所以在这些浏览器中调用时会报错</p><h2 id="JS对象转JSON字符串"><a href="#JS对象转JSON字符串" class="headerlink" title="JS对象转JSON字符串"></a>JS对象转JSON字符串</h2><p>JSON.stringify()：可以将一个JS对象转换为JSON字符串，需要一个js对象作为参数，会返回一个JSON字符串</p><p>语法：<code>JSON.parse(value[, replacer[, space]])</code><br>参数：</p><ul><li>value：被解析的字符串</li><li>reviver（不常用）：规定原始value的改造规则，可以是函数、数组、NULL<br>-space：缩进用的字符串，可以是数字（&lt;&#x3D;10）、字符串、NULL<br>返回值：JavaScript值或对象</li></ul><p>案例演示：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;猪八戒&quot;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">28</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&quot;男&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> jsonStr = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(obj);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(jsonStr);</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/img_convert/f7dc872335de8f09109ea0c9b9f798b4.png" alt="image-20201023093346336"></p><p>注意 ：JSON这个对象在IE7及以下的浏览器中不支持，所以在这些浏览器中调用时会报错</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>基础</title>
      <link href="/posts/20dbfd00/"/>
      <url>/posts/20dbfd00/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>underscorejs源码分析</title>
      <link href="/posts/5c631237/"/>
      <url>/posts/5c631237/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="java的Stream流式编程"><a href="#java的Stream流式编程" class="headerlink" title="java的Stream流式编程"></a>java的Stream流式编程</h2><ul><li>流式处理<br>流是一系列数据项，一次只生成一项。程序可以从输入流中一个一个读取数据项，然后以同样的方式将数据项写入输出流。一个程序的输出流很可能是另一个程序的输入流。</li><li>流的特点<br>元素序列——就像集合一样，流也提供了一个接口，可以访问特定元素类型的一组有序值。集合讲的是数据，流讲的是计算。<br><code>menu.stream().filter(d -&gt; getCalories &gt; 300).map(Dish::getName);</code></li><li>数据处理操作<br>流的数据处理功能支持类似于数据库的操作，以及函数式编程语言中的常用操作，如filter、map、reduce、find、match、sort等。流操作可以顺序执行，也可并行执行。</li></ul><h2 id="Underscore结构"><a href="#Underscore结构" class="headerlink" title="Underscore结构"></a>Underscore结构</h2><h3 id="作用域包裹"><a href="#作用域包裹" class="headerlink" title="作用域包裹"></a>作用域包裹</h3><p>与其他第三库一样，Underscore 也通过<strong>立即执行函数</strong>来包裹自己的业务逻辑。</p><p>目的</p><ul><li>避免全局污染：所有库的逻辑，库所定义和使用的变量全部被封装到了该函数的作用域中。</li><li>隐私保护：但凡在立即执行函数中声明的函数、变量等，除非是自己想暴露，否则绝无可能在外部获得。</li></ul><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span> <span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// ...执行逻辑</span></span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><h3 id="对象"><a href="#对象" class="headerlink" title="_对象"></a>_对象</h3><p>underscore 有下划线的意思，所以 underscore 通过一个下划线变量 _ 来标识自身。</p><p>注意：<br>_是一个函数对象，之后所有的 api 都会被挂载到这个到对象上，如 _.each, _.map 等</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> _ = <span class="keyword">function</span> (<span class="params">obj</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (obj <span class="keyword">instanceof</span> _) &#123;</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!(<span class="variable language_">this</span> <span class="keyword">instanceof</span> _)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title function_">_</span>(obj);   </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_wrapped</span> = obj;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="面向对象风格支持"><a href="#面向对象风格支持" class="headerlink" title="面向对象风格支持"></a>面向对象风格支持</h2><h3 id=""><a href="#" class="headerlink" title="_()"></a>_()</h3><p>虽然Underscore推崇函数式编程，但也支持面向对象风格的函数调用，仅需要通过 _() 来包裹对象即可。</p><p>当我们进行如下调用时：<br><code>_([2,3,4])</code><br>会创建一个新的underscore对象（从而能够调用underscore提供的方法），并在this._wrapped中存储传入的数据。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> _ = <span class="keyword">function</span> (<span class="params">obj</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (obj <span class="keyword">instanceof</span> _) &#123;</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!(<span class="variable language_">this</span> <span class="keyword">instanceof</span> _)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title function_">_</span>(obj);   </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_wrapped</span> = obj;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="mixin"><a href="#mixin" class="headerlink" title="mixin"></a>mixin</h2><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 源码</span></span><br><span class="line"><span class="literal">_</span>.mixin = <span class="function"><span class="keyword">function</span> </span>(obj) &#123;</span><br><span class="line">    <span class="literal">_</span>.each(<span class="literal">_</span>.<span class="keyword">function</span>(obj), <span class="function"><span class="keyword">function</span></span>(name) &#123;</span><br><span class="line">        <span class="keyword">var</span> func = <span class="literal">_</span>[name] = obj[name];</span><br><span class="line">        <span class="literal">_</span>.prototype[name] = <span class="function"><span class="keyword">function</span> </span>() &#123;</span><br><span class="line">            <span class="keyword">var</span> args = [<span class="built_in">this</span>._wrapped];</span><br><span class="line">            push.apply(args, arguments);</span><br><span class="line">            <span class="keyword">return</span> chain(<span class="built_in">this</span>, func.apply(..., args));</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">_</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>mixin（混入）模式是增加代码复用度的一个广泛使用的设计模式。<br>_.mixin(obj)：为 underscore 对象混入 obj 具有的功能。</p><h2 id="链接式调用"><a href="#链接式调用" class="headerlink" title="链接式调用"></a>链接式调用</h2><h3 id="链接式调用-1"><a href="#链接式调用-1" class="headerlink" title="链接式调用"></a>链接式调用</h3><ul><li>jQuery链接式调用。<br><code>$(&#39;.div&#39;).css(&#39;color&#39;, &#39;red&#39;).show();</code></li><li>想要实现链式调用，通常我们会在支持链式调用的函数中返回对象本身。<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="variable constant_">RULES</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="attr">add</span>: <span class="keyword">function</span> (<span class="params">x</span>) &#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(x);<span class="keyword">return</span> <span class="variable language_">this</span>;&#125;,</span><br><span class="line">    <span class="attr">mult</span>: <span class="keyword">function</span> (<span class="params">y</span>) &#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(y);<span class="keyword">return</span> <span class="variable language_">this</span>;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="variable constant_">RULES</span>.<span class="title function_">add</span>(<span class="number">4</span>).<span class="title function_">mult</span>(<span class="number">5</span>);</span><br></pre></td></tr></table></figure></li><li>但是，这样做并不优雅，这需要我们手动地在函数中添加 return this 语句。更好的做法是我们创建一个通用函数，它能为指定的对象方法增加链式调用机制。</li></ul><h3 id="chain"><a href="#chain" class="headerlink" title="_.chain()"></a>_.chain()</h3><ul><li><em>.chain(obj)：为 underscore 对象的方法增加链式调用能力。</em></li><li>.chain 源码如下:<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">_.<span class="property">chain</span> = <span class="keyword">function</span> (<span class="params">obj</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> instance = <span class="title function_">_</span>(obj);</span><br><span class="line">    instance.<span class="property">_chain</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>underscore 还提供了一个帮助函数 result，该函数将会判断方法调用结果，如果该方法的调用者被标识了需要链化，则链化当前的方法执行结果。<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> chainResult = <span class="keyword">function</span> (<span class="params">instance, obj</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> instance.<span class="property">_chain</span> ? <span class="title function_">_</span>(obj).<span class="property">chain</span>:obj;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 函数式编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> underscoreJS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>自定义404界面</title>
      <link href="/posts/b850b6c9/"/>
      <url>/posts/b850b6c9/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="找到你中意的404页面"><a href="#找到你中意的404页面" class="headerlink" title="找到你中意的404页面"></a>找到你中意的404页面</h3><p>推荐一款：<a href="https://404.life/">https://404.life</a></p><p>预览保存，如果你看到其他喜欢的页面如何F12扒页面我就不教咯~</p><h3 id="hexo配置"><a href="#hexo配置" class="headerlink" title="hexo配置"></a>hexo配置</h3><h4 id="把css和js放在博客下"><a href="#把css和js放在博客下" class="headerlink" title="把css和js放在博客下"></a>把css和js放在博客下</h4><p>我是放在这儿的，你也可以放在github，用jsd加速。</p><p><img src="https://img-blog.csdnimg.cn/20200518185047670.png" alt="在这里插入图片描述"></p><h4 id="新建404-html"><a href="#新建404-html" class="headerlink" title="新建404.html"></a>新建404.html</h4><p>路径是在：<code>博客\source\404.html</code>，它和 <code>_post</code>同级。<br>修改页面内容。（注意css的引用路径）</p><p><img src="https://img-blog.csdnimg.cn/20200518185231776.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="设置404跳过渲染：-config-yml"><a href="#设置404跳过渲染：-config-yml" class="headerlink" title="设置404跳过渲染：_config.yml"></a>设置404跳过渲染：_config.yml</h4><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">skip_render: ##跳过指定渲染，忽略文章skip_render: <span class="string">&quot;_posts/hello-world.md&quot;</span></span><br><span class="line">  - <span class="number">404.</span>html</span><br></pre></td></tr></table></figure><p>页面效果：</p><p><img src="https://img-blog.csdnimg.cn/20200518185317300.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><blockquote><p>tips:butterfly主题可以关掉默认的404页面</p><p><img src="https://img-blog.csdnimg.cn/20200518185455559.png" alt="在这里插入图片描述"></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
          <category> 魔改 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> 魔改 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>友链页面优化</title>
      <link href="/posts/70a6e009/"/>
      <url>/posts/70a6e009/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><ul><li>默认：</li></ul><p><img src="https://img-blog.csdnimg.cn/20200423113224158.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ul><li>优化：</li></ul><p><img src="https://img-blog.csdnimg.cn/20200423113308946.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>参考链接：<a href="https://www.antmoe.com/posts/a811d614/index.html">Hexo关于Butterfly的一些小修改</a></p><h3 id="修改-themes-Butterfly-layout-flink-pug渲染样式"><a href="#修改-themes-Butterfly-layout-flink-pug渲染样式" class="headerlink" title="修改 themes\Butterfly\layout\flink.pug渲染样式"></a>修改 <code>themes\Butterfly\layout\flink.pug</code>渲染样式</h3><p>（ctrl+&#x2F;注释掉原来的内容，将下面添加进去：）</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># page</span><br><span class="line">  .flink  # article-container</span><br><span class="line">    each i <span class="keyword">in</span> site.data.links</span><br><span class="line">      h2= i.class_name</span><br><span class="line">      .post-cards</span><br><span class="line">        .md-links</span><br><span class="line">          each item <span class="keyword">in</span> i.link_list</span><br><span class="line">            .md-links-item(<span class="built_in">style</span>= item.<span class="built_in">color</span> ? `--primary-<span class="built_in">color</span>:$&#123;item.<span class="built_in">color</span>&#125;;<span class="built_in">border</span>-<span class="built_in">width</span>:$&#123;item.<span class="built_in">width</span>&#125;;<span class="built_in">border</span>-<span class="built_in">style</span>:$&#123;item.<span class="built_in">style</span>&#125;;<span class="built_in">animation</span>: $&#123;item.custom&#125; $&#123;item.<span class="built_in">time</span>&#125; infinite alternate; <span class="built_in">background</span>:$&#123;item.<span class="built_in">background</span>&#125;` : &#x27;<span class="built_in">border</span>-<span class="built_in">width</span>:<span class="number">0px</span>;<span class="built_in">border</span>-<span class="built_in">style</span>:solid;<span class="built_in">animation</span>: link_custom <span class="number">0s</span> infinite alternate;<span class="built_in">background</span>:<span class="number">0</span>&#x27;)</span><br><span class="line">              a.customcolor(href=item.link  <span class="built_in">title</span>=item.name target=<span class="string">&quot;_blank&quot;</span> rel=item.<span class="built_in">remove</span> ? <span class="string">&quot;external nofollow&quot;</span> : <span class="string">&quot;&quot;</span> <span class="built_in">style</span>=item.namecolor ? `--namecolor:$&#123;item.namecolor&#125;` : &#x27;&#x27;)</span><br><span class="line">                <span class="keyword">if</span> theme.lazyload.enable</span><br><span class="line">                  img.lazyload(data-src=item.avatar onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.lodding_bg.flink) + `&#x27;` alt=item.name,<span class="built_in">style</span>=item.rotate ? `--primary-rotate:$&#123;item.rotate&#125;;--autotime:$&#123;item.autotime&#125;;` : &#x27;--primary-rotate:<span class="number">0deg</span>&#x27; class=item.autorotate ? `$&#123;item.autorotate&#125;` : &#x27;&#x27;)</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                  img(src=item.avatar onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.lodding_bg.flink) + `&#x27;` alt=item.name )</span><br><span class="line">                .md-links-<span class="built_in">title</span>= item.name</span><br><span class="line">                .md-links-des= item.descr</span><br><span class="line">    != page.<span class="built_in">content</span></span><br><span class="line">  <span class="keyword">if</span> page.comments !== <span class="literal">false</span></span><br><span class="line">    include includes/comments/index.pug</span><br></pre></td></tr></table></figure><h3 id="添加css样式，外链"><a href="#添加css样式，外链" class="headerlink" title="添加css样式，外链"></a>添加css样式，外链</h3><p>（ctrl+F全局搜索 css: ，并添加外链 ）</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- https:<span class="regexp">//</span>cdn.jsdelivr.net<span class="regexp">/gh/</span>sviptzk<span class="regexp">/HexoStaticFile@master/</span>Hexo<span class="regexp">/css/</span>flink.min.css</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2020042311371055.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="使用方法："><a href="#使用方法：" class="headerlink" title="使用方法："></a>使用方法：</h3><p>在link.yml里写：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">姓名</span></span><br><span class="line"><span class="attr">link:</span> <span class="string">地址</span></span><br><span class="line"><span class="attr">avatar:</span> <span class="string">头像</span></span><br><span class="line"><span class="attr">descr:</span> <span class="string">描述</span></span><br><span class="line"><span class="comment"># 边框大小 默认为0</span></span><br><span class="line"><span class="attr">width:</span> <span class="string">0px</span></span><br><span class="line"><span class="comment"># 边框样式 默认 solid</span></span><br><span class="line"><span class="attr">style:</span> <span class="string">solid</span></span><br><span class="line"><span class="comment"># 边框颜色 默认淡蓝色 #49b1f5</span></span><br><span class="line"><span class="attr">color:</span> <span class="string">&quot;#49b1f5&quot;</span></span><br><span class="line"><span class="comment"># 自动旋转 可选值 flash（闪现） link_custom（单色呼吸灯） link_custom1（彩色呼吸灯）</span></span><br><span class="line"><span class="attr">custom:</span> <span class="string">link_custom</span></span><br><span class="line"><span class="comment"># 动画时长设定，默认为0</span></span><br><span class="line"><span class="attr">time:</span> <span class="string">4s</span></span><br><span class="line"><span class="comment"># name的颜色</span></span><br><span class="line"><span class="attr">namecolor:</span> <span class="string">&quot;#ff6699&quot;</span></span><br><span class="line"><span class="comment"># descr的颜色</span></span><br><span class="line"><span class="attr">descolor:</span> <span class="string">&quot;#ff6699&quot;</span></span><br><span class="line"><span class="comment"># 背景颜色</span></span><br><span class="line"><span class="attr">background:</span> <span class="number">0</span></span><br><span class="line"><span class="comment"># 鼠标悬停旋转角度</span></span><br><span class="line"><span class="attr">rotate:</span> <span class="string">360deg</span></span><br><span class="line"><span class="comment"># 自动旋转 latuo左旋转 rauto右旋转</span></span><br><span class="line"><span class="attr">autorotate:</span> <span class="string">&quot;lauto&quot;</span></span><br><span class="line"><span class="comment"># 旋转的周期（时长）</span></span><br><span class="line"><span class="attr">autotime:</span> <span class="string">0s</span></span><br><span class="line"><span class="comment">#移除此链接的权重 0为否 非0为移除</span></span><br><span class="line"><span class="attr">remove:</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
          <category> 魔改 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> 魔改 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>添加天气小部件</title>
      <link href="/posts/2d504c96/"/>
      <url>/posts/2d504c96/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="效果预览"><a href="#效果预览" class="headerlink" title="效果预览"></a>效果预览</h2><p>电脑端<br><img src="https://img-blog.csdnimg.cn/img_convert/7f5f29b374a476be60a5bdc97aa9d0c9.png"><br>手机端<br><img src="https://img-blog.csdnimg.cn/img_convert/30f3b2d2d678c6ea3afede3b51de3552.png"></p><h2 id="具体步骤"><a href="#具体步骤" class="headerlink" title="具体步骤"></a>具体步骤</h2><h3 id="申请天气API"><a href="#申请天气API" class="headerlink" title="申请天气API"></a>申请天气API</h3><p>国内天气API有多种，此处推荐和风天气，如果第一次使用和风天气</p><p>首先，在官网注册账号，<a href="https://id.qweather.com/#/register?redirect=https%3A%2F%2Fconsole.qweather.com">点击进入</a><br><img src="https://img-blog.csdnimg.cn/img_convert/0ef8012a413fb671007f3df28c642249.png" alt="img"></p><p>申请账号并登录后，到和风天气开发平台创建一个简约插件，<a href="https://widget.qweather.com/create-simple">点击进入</a><br><img src="https://img-blog.csdnimg.cn/img_convert/d4133d6ab5b989d8c1298dcf6f129ab2.png" alt="img"></p><p>  配置插件的相关属性，首先，您应该为您的插件取一个名字，内容属性均可以自定义。</p><p>注意：为了确保天气小部件的正常显示，这里选择固定在浏览器中，具体位置后续在调节。<br><img src="https://img-blog.csdnimg.cn/img_convert/fbd29cde597ca0071fe9efa5e78968e4.png" alt="img"></p><p>设置完成后，点击下面的生成代码即可，生成的代码如下。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;he-plugin-simple&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable constant_">WIDGET</span> = &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;CONFIG&quot;</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;modules&quot;</span>: <span class="string">&quot;01234&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;background&quot;</span>: <span class="string">&quot;5&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;tmpColor&quot;</span>: <span class="string">&quot;FF9900&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;tmpSize&quot;</span>: <span class="string">&quot;16&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;cityColor&quot;</span>: <span class="string">&quot;4A86E8&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;citySize&quot;</span>: <span class="string">&quot;16&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;aqiColor&quot;</span>: <span class="string">&quot;FF9900&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;aqiSize&quot;</span>: <span class="string">&quot;16&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;weatherIconSize&quot;</span>: <span class="string">&quot;24&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;alertIconSize&quot;</span>: <span class="string">&quot;18&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;padding&quot;</span>: <span class="string">&quot;10px 10px 10px 10px&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;shadow&quot;</span>: <span class="string">&quot;0&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;language&quot;</span>: <span class="string">&quot;auto&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;fixed&quot;</span>: <span class="string">&quot;true&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;vertical&quot;</span>: <span class="string">&quot;top&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;horizontal&quot;</span>: <span class="string">&quot;left&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;left&quot;</span>: <span class="string">&quot;10&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;top&quot;</span>: <span class="string">&quot;10&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;key&quot;</span>: <span class="string">&quot;个人key&quot;</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="添加div"><a href="#添加div" class="headerlink" title="添加div"></a>添加div</h3><p>打开个人博客所在文件夹，在 <code>...\themes\butterfly\layout\includes\header</code>目录下的 <code>nav.pug</code>文件中添加以下内容。</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">div</span> <span class="built_in">id</span>=<span class="string">&quot;he-plugin-simple&quot;</span>&gt;&lt;/<span class="keyword">div</span>&gt;</span><br></pre></td></tr></table></figure><blockquote><p>也可以写成这种形式 <code>#he-plugin-simple</code></p></blockquote><h3 id="添加weather-js"><a href="#添加weather-js" class="headerlink" title="添加weather.js"></a>添加weather.js</h3><p>打开个人博客所在文件夹，在 <code>...\themes\butterfly\source\js</code>目录下添加 <code>weather.js</code>文件，并填入以下内容。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">WIDGET</span> = &#123;</span><br><span class="line">  <span class="string">&quot;CONFIG&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;modules&quot;</span>: <span class="string">&quot;01234&quot;</span>,</span><br><span class="line">    <span class="string">&quot;background&quot;</span>: <span class="string">&quot;5&quot;</span>,</span><br><span class="line">    <span class="string">&quot;tmpColor&quot;</span>: <span class="string">&quot;4A86E8&quot;</span>,</span><br><span class="line">    <span class="string">&quot;tmpSize&quot;</span>: <span class="string">&quot;16&quot;</span>,</span><br><span class="line">    <span class="string">&quot;cityColor&quot;</span>: <span class="string">&quot;FF9900&quot;</span>,</span><br><span class="line">    <span class="string">&quot;citySize&quot;</span>: <span class="string">&quot;16&quot;</span>,</span><br><span class="line">    <span class="string">&quot;aqiColor&quot;</span>: <span class="string">&quot;4A86E8&quot;</span>,</span><br><span class="line">    <span class="string">&quot;aqiSize&quot;</span>: <span class="string">&quot;16&quot;</span>,</span><br><span class="line">    <span class="string">&quot;weatherIconSize&quot;</span>: <span class="string">&quot;24&quot;</span>,</span><br><span class="line">    <span class="string">&quot;alertIconSize&quot;</span>: <span class="string">&quot;18&quot;</span>,</span><br><span class="line">    <span class="string">&quot;padding&quot;</span>: <span class="string">&quot;0px 0px 0px 0px&quot;</span>,</span><br><span class="line">    <span class="string">&quot;shadow&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;language&quot;</span>: <span class="string">&quot;auto&quot;</span>,</span><br><span class="line">    <span class="string">&quot;fixed&quot;</span>: <span class="string">&quot;true&quot;</span>,</span><br><span class="line">    <span class="string">&quot;vertical&quot;</span>: <span class="string">&quot;center&quot;</span>,</span><br><span class="line">    <span class="string">&quot;horizontal&quot;</span>: <span class="string">&quot;center&quot;</span>,</span><br><span class="line">    <span class="string">&quot;left&quot;</span>: <span class="string">&quot;125&quot;</span>,</span><br><span class="line">    <span class="string">&quot;top&quot;</span>: <span class="string">&quot;20&quot;</span>,</span><br><span class="line">    <span class="string">&quot;key&quot;</span>: <span class="string">&quot;你的key&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Inject引入"><a href="#Inject引入" class="headerlink" title="Inject引入"></a>Inject引入</h3><p>在配置文件 <code>_config.butterfly</code>的 <code>inject</code>属性中引入以下代码。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">-`&lt;script</span> <span class="string">src=&quot;https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0&quot;&gt;&lt;/script&gt;`</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">`&lt;script</span> <span class="string">async</span> <span class="string">src=&quot;/js/weather.js&quot;&gt;&lt;/script&gt;`</span></span><br></pre></td></tr></table></figure><p>即为</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Inject</span></span><br><span class="line"><span class="comment"># Insert the code to head (before &#x27;&lt;/head&gt;&#x27; tag) and the bottom (before &#x27;&lt;/body&gt;&#x27; tag)</span></span><br><span class="line"><span class="comment"># 插入代码到头部 &lt;/head&gt; 之前 和 底部 &lt;/body&gt; 之前</span></span><br><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="string">-`&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;//at.alicdn.com/t/font_3332915_ymmoy7wnkg.css&quot;&gt;`</span></span><br><span class="line">    <span class="string">-`&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;themes/butterfly/source/css/iconfont.css&quot;&gt;`</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="comment"># -`&lt;script src=&quot;xxxx&quot;&gt;&lt;/script&gt;`</span></span><br><span class="line">    <span class="string">-`&lt;script</span> <span class="string">src=&quot;https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0&quot;&gt;&lt;/script&gt;`</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&#x27;`&lt;div class=&quot;aplayer no-destroy&quot; data-id=&quot;60198&quot; data-server=&quot;netease&quot; data-type=&quot;playlist&quot; data-fixed=&quot;true&quot; data-mini=&quot;true&quot; data-autoplay=&quot;true&quot; data-listfolded=&quot;true&quot;&gt;` `&lt;/div&gt;`&#x27;</span></span><br><span class="line">    <span class="string">-`&lt;script</span> <span class="string">async</span> <span class="string">src=&quot;/js/weather.js&quot;&gt;&lt;/script&gt;`</span></span><br></pre></td></tr></table></figure><h3 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h3><p>在终端输入</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hexo clean</span></span><br><span class="line"><span class="attribute">hexo g</span></span><br><span class="line"><span class="attribute">hexo s</span></span><br></pre></td></tr></table></figure><ul><li>运行博客后，调试<code>left</code>和<code>top</code>属性，使天气小部件显示在合适位置。</li><li>前端调试后，记修改<code>weather.js</code>文件中的<code>left</code>、<code>top</code>属性。</li></ul>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
          <category> 魔改 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> 魔改 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>代码性能指标</title>
      <link href="/posts/e7ba911d/"/>
      <url>/posts/e7ba911d/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="健壮性"><a href="#健壮性" class="headerlink" title="健壮性"></a>健壮性</h2><p>定义：代码抗击风险的能力</p><p>目的：</p><ul><li>避免和程序无关的因素，导致代码报错</li><li>快速给出问题反馈</li><li>不至于因为非必要性bug，而导致程序执行中断</li></ul><p>做法</p><ul><li>参数做好默认值，做好检测</li><li>程序做好意外情况处理</li></ul><h2 id="可读性"><a href="#可读性" class="headerlink" title="可读性"></a>可读性</h2><p>定义：代码阅读起来很清楚</p><p>目的</p><ul><li>代码结构清晰</li><li>便于他人阅读</li></ul><p>方法</p><ul><li>优化丑陋结构<ul><li>if-else分支过长&#x3D;&#x3D;&gt; 策略模式、状态</li><li>分支嵌套</li><li>回调地狱 &#x3D;&#x3D;&gt; promise、async</li></ul></li><li>遵循命令规范<ul><li>常量名<strong>全部大写</strong></li><li>类名的<strong>首字母大写</strong></li><li>局部变量名以<strong>下划线开头</strong></li></ul></li><li>及时进行注释</li></ul><h2 id="可复用性"><a href="#可复用性" class="headerlink" title="可复用性"></a>可复用性</h2><p>定义：重复利用</p><p>目的</p><ul><li>无需重复书写</li><li>减少代码量</li></ul><p>做法：</p><ul><li>桥接模式</li><li>享元模式</li><li>函数式编程</li><li>低耦合，高内聚</li></ul><h2 id="可扩展性"><a href="#可扩展性" class="headerlink" title="可扩展性"></a>可扩展性</h2><p>定义：</p><p>对于以后的变更，代码无需进行大规模的改动</p><p>做法：</p><ul><li>留出扩展接口</li><li>模块低耦合，高内聚</li><li>良好的模块组织</li><li>良好的扩展方案</li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 函数式编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 代码性能指标 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>控制流程</title>
      <link href="/posts/fc724bce/"/>
      <url>/posts/fc724bce/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="for-x2F-for-…-of-…-x2F-for-…-in-…-x2F-forEach"><a href="#for-x2F-for-…-of-…-x2F-for-…-in-…-x2F-forEach" class="headerlink" title="for()&#x2F;for (… of …)&#x2F;for (… in …)&#x2F;forEach"></a>for()&#x2F;for (… of …)&#x2F;for (… in …)&#x2F;forEach</h2><ol><li>for()</li><li>for (variable of iterable)</li></ol><blockquote><p>遍历的是：<strong>iterable元素值</strong><br>适用遍历可迭代(数组Array、Map、Set、String、arguments对象、Nodelist对象)。<br>不能遍历对象，因为没有迭代器对象。</p></blockquote><ol start="3"><li>for (variable in object)</li></ol><blockquote><p>遍历的是：<strong>object键名</strong>，其为<strong>字符串型</strong>，不能直接进行几何运算<br>以<strong>任意顺序</strong>遍历一个对象的除Symbol以外的可枚举属性（包括<strong>其原型对象</strong>、<strong>其本身属性值</strong>）。<br>适合遍历<strong>对象</strong></p></blockquote><ol start="4"><li>arr.forEach(function(value, index, oObj) {});</li></ol><blockquote><p>不能遍历对象<br>总结：</p></blockquote><ul><li>for循环：可以中断（return、break）；</li><li>for in ：适用于<strong>纯对象</strong>的遍历，并且只能输出可枚举属性，不能中断（break、return）；</li><li>forEach：适用于<strong>需要知道索引值</strong>的数组遍历，但是不能中断（return、break）；</li><li>for of ：适用于<strong>无需知道索引值</strong>的数组遍历，因为可以中断（return、break）。另外对于其他字符串、类数组、类型数组的迭代，for of也更适用；</li></ul><h2 id="短路运算"><a href="#短路运算" class="headerlink" title="短路运算"></a>短路运算</h2><p>原理：当有多个表达式（值），左边的表达式的值可以确定结果时，就不再继续运算右边的表达式的值<br>逻辑与&amp;&amp;</p><p>逻辑或||</p><h2 id="位运算"><a href="#位运算" class="headerlink" title="位运算"></a>位运算</h2><p>按位与(AND) &amp;<br>按位或(OR) |<br>按位异或(XOR) ^<br>按位非(NOT) ~<br>左移（Left shift）&lt;&lt;<br>有符号右移&gt;&gt;<br>无符号右移&gt;&gt;&gt;</p><h3 id="位运算符在js中的妙用"><a href="#位运算符在js中的妙用" class="headerlink" title="位运算符在js中的妙用"></a>位运算符在js中的妙用</h3><h4 id="1-判断奇偶性——-amp-运算符"><a href="#1-判断奇偶性——-amp-运算符" class="headerlink" title="1. 判断奇偶性——&amp;运算符"></a>1. 判断奇偶性——&amp;运算符</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 偶数 &amp; 1 = 0</span></span><br><span class="line"><span class="comment">// 奇数 &amp; 1 = 1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span> &amp; <span class="number">1</span>)    <span class="comment">// 0</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span> &amp; <span class="number">1</span>)    <span class="comment">// 1</span></span><br></pre></td></tr></table></figure><h4 id="2-取整——-、-gt-gt-、-lt-lt-、-gt-gt-gt-、-运算符"><a href="#2-取整——-、-gt-gt-、-lt-lt-、-gt-gt-gt-、-运算符" class="headerlink" title="2. 取整——~、&gt;&gt;、&lt;&lt;、&gt;&gt;&gt;、|运算符"></a>2. 取整——~、&gt;&gt;、&lt;&lt;、&gt;&gt;&gt;、|运算符</h4><p>相当于使用Math.floor()</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(~~ <span class="number">6.83</span>)    <span class="comment">// 6</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">6.83</span> &gt;&gt; <span class="number">0</span>)  <span class="comment">// 6</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">6.83</span> &lt;&lt; <span class="number">0</span>)  <span class="comment">// 6</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">6.83</span> | <span class="number">0</span>)   <span class="comment">// 6</span></span><br><span class="line"><span class="comment">// &gt;&gt;&gt;不可对负数取整</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">6.83</span> &gt;&gt;&gt; <span class="number">0</span>)   <span class="comment">// 6</span></span><br></pre></td></tr></table></figure><h4 id="3-值交换-必须是整数-——-运算符"><a href="#3-值交换-必须是整数-——-运算符" class="headerlink" title="3. 值交换(必须是整数)——^运算符"></a>3. 值交换(必须是整数)——^运算符</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">5</span></span><br><span class="line"><span class="keyword">var</span> b = <span class="number">8</span></span><br><span class="line">a ^= b</span><br><span class="line">b ^= a</span><br><span class="line">a ^= b</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a)   <span class="comment">// 8</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b)   <span class="comment">// 5</span></span><br><span class="line"><span class="comment">// 等价于</span></span><br><span class="line">[a, b] = [b, a] <span class="comment">// ES6解构赋值</span></span><br></pre></td></tr></table></figure><h4 id="4-得2的次方——1-lt-lt-num运算符"><a href="#4-得2的次方——1-lt-lt-num运算符" class="headerlink" title="4. 得2的次方——1 &lt;&lt; num运算符"></a>4. 得2的次方——1 &lt;&lt; num运算符</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> &lt;&lt; <span class="number">2</span>  <span class="comment">// 4, 即 2的2次方</span></span><br><span class="line"><span class="number">1</span> &lt;&lt; <span class="number">10</span> <span class="comment">// 1024, 即 2的10次方</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 但是要注意使用场景, 非1的数字，会改变首位的正负</span></span><br><span class="line">a = <span class="number">2e9</span>;   <span class="comment">// 2000000000</span></span><br><span class="line">a &lt;&lt; <span class="number">1</span>;    <span class="comment">// -294967296</span></span><br></pre></td></tr></table></figure><h4 id="5-判断值是否相等——-运算符"><a href="#5-判断值是否相等——-运算符" class="headerlink" title="5. 判断值是否相等——^运算符"></a>5. 判断值是否相等——^运算符</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (a !== <span class="number">1171</span>) &#123;...&#125;;  </span><br><span class="line"><span class="comment">// 等价于 </span></span><br><span class="line"><span class="keyword">if</span> (a ^ <span class="number">1171</span>) &#123;...&#125;;  </span><br></pre></td></tr></table></figure><h4 id="6-n-是-2-的整数幂——n-amp-n-1-x3D-0"><a href="#6-n-是-2-的整数幂——n-amp-n-1-x3D-0" class="headerlink" title="6. n 是 2 的整数幂——n &amp; (n - 1) &#x3D; 0"></a>6. n 是 2 的整数幂——n &amp; (n - 1) &#x3D; 0</h4><h4 id="7-判断数组中某项是否存在——按位取反"><a href="#7-判断数组中某项是否存在——按位取反" class="headerlink" title="7. 判断数组中某项是否存在——按位取反(~)"></a>7. 判断数组中某项是否存在——按位取反(~)</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 利用有且仅有-1取反为0,即~-1 === 0</span></span><br><span class="line"><span class="keyword">if</span>(~arr.<span class="title function_">indexof</span>(item)) &#123;</span><br><span class="line">    <span class="comment">// TODO</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 等价于</span></span><br><span class="line"><span class="keyword">if</span>(arr.<span class="title function_">indexof</span>(item) &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="comment">// TODO</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="三目运算"><a href="#三目运算" class="headerlink" title="三目运算"></a>三目运算</h2><p>基本语法为: expression ? sentence1 : sentence2</p><h2 id="filter-过滤"><a href="#filter-过滤" class="headerlink" title="filter()过滤"></a>filter()过滤</h2><p>filter(item, i, arr)：数组过滤器，参数接收一个函数，数组的每一项经过函数过滤，返回一个符合过滤条件的新数组<br>函数接收三个参数：</p><ul><li>item （当前遍历的数组项）</li><li>i （当前项索引）</li><li>arr （调用filter数组本身）</li></ul><h3 id="1-过滤出数组中大于5的数"><a href="#1-过滤出数组中大于5的数" class="headerlink" title="1.过滤出数组中大于5的数"></a>1.过滤出数组中大于5的数</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>]</span><br><span class="line"><span class="keyword">var</span> myarr=arr.<span class="title function_">filter</span>(<span class="function"><span class="params">v</span> =&gt;</span> v&gt;<span class="number">5</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(myarr);             <span class="comment">//输出[6,7]</span></span><br></pre></td></tr></table></figure><h3 id="2-通过filter判断数组中是否存在某个值"><a href="#2-通过filter判断数组中是否存在某个值" class="headerlink" title="2.通过filter判断数组中是否存在某个值"></a>2.通过filter判断数组中是否存在某个值</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>]</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="title function_">filter</span>(<span class="function"><span class="params">v</span> =&gt;</span> v==<span class="number">5</span>).<span class="property">length</span>==<span class="number">0</span>?<span class="string">&quot;不存在&quot;</span>:<span class="string">&quot;存在&quot;</span>)<span class="comment">//输出存在</span></span><br></pre></td></tr></table></figure><h3 id="3-去掉空数组空字符串、undefined、null"><a href="#3-去掉空数组空字符串、undefined、null" class="headerlink" title="3.去掉空数组空字符串、undefined、null"></a>3.去掉空数组空字符串、undefined、null</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr=[<span class="string">&quot;&quot;</span>,<span class="literal">undefined</span>,<span class="literal">null</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line"><span class="keyword">var</span> myarr=arr.<span class="title function_">filter</span>(<span class="function"><span class="params">v</span> =&gt;</span> v)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(myarr)<span class="comment">//输出[1,2,3]</span></span><br></pre></td></tr></table></figure><h2 id="去重"><a href="#去重" class="headerlink" title="去重"></a>去重</h2><h3 id="利用ES6-Set去重（ES6中最常用）"><a href="#利用ES6-Set去重（ES6中最常用）" class="headerlink" title="利用ES6 Set去重（ES6中最常用）"></a>利用ES6 Set去重（ES6中最常用）</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">unique</span> (arr) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Array</span>.<span class="title function_">from</span>(<span class="keyword">new</span> <span class="title class_">Set</span>(arr))</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">1</span>,<span class="string">&#x27;true&#x27;</span>,<span class="string">&#x27;true&#x27;</span>,<span class="literal">true</span>,<span class="literal">true</span>,<span class="number">15</span>,<span class="number">15</span>,<span class="literal">false</span>,<span class="literal">false</span>,<span class="literal">undefined</span>,<span class="literal">undefined</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="title class_">NaN</span>,<span class="title class_">NaN</span>,<span class="string">&#x27;NaN&#x27;</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,&#123;&#125;,&#123;&#125;];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">unique</span>(arr))</span><br><span class="line"><span class="comment">// [1, &quot;true&quot;, true, 15, false, undefined, null, NaN, &quot;NaN&quot;, 0, &quot;a&quot;, &#123;&#125;, &#123;&#125;]</span></span><br><span class="line"><span class="comment">// &#123;&#125;没有去重</span></span><br></pre></td></tr></table></figure><p>不考虑兼容性，这种去重的方法代码最少。这种方法还无法去掉“{}”空对象，后面的高阶方法会添加去掉重复“{}”的方法。</p><h3 id="利用for嵌套for，然后splice去重（ES5中最常用）"><a href="#利用for嵌套for，然后splice去重（ES5中最常用）" class="headerlink" title="利用for嵌套for，然后splice去重（ES5中最常用）"></a>利用for嵌套for，然后splice去重（ES5中最常用）</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 双层循环，外层循环元素，内层循环时比较值。值相同时，则删去这个值。</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">unique</span>(<span class="params">arr</span>) &#123;        </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> j=i+<span class="number">1</span>; j&lt;arr.<span class="property">length</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(arr[i]==arr[j]) &#123;         <span class="comment">//第一个等同于第二个，splice方法删除第二个</span></span><br><span class="line">                arr.<span class="title function_">splice</span>(j,<span class="number">1</span>);</span><br><span class="line">                j--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">1</span>,<span class="string">&#x27;true&#x27;</span>,<span class="string">&#x27;true&#x27;</span>,<span class="literal">true</span>,<span class="literal">true</span>,<span class="number">15</span>,<span class="number">15</span>,<span class="literal">false</span>,<span class="literal">false</span>,<span class="literal">undefined</span>,<span class="literal">undefined</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="title class_">NaN</span>,<span class="title class_">NaN</span>,<span class="string">&#x27;NaN&#x27;</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,&#123;&#125;,&#123;&#125;];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">unique</span>(arr))</span><br><span class="line"><span class="comment">// [1, &quot;true&quot;, 15, false, undefined, NaN, NaN, &quot;NaN&quot;, &quot;a&quot;, &#123;…&#125;, &#123;…&#125;]   </span></span><br><span class="line"><span class="comment">// NaN和&#123;&#125;没有去重，两个null直接消失了</span></span><br></pre></td></tr></table></figure><h3 id="利用indexOf去重"><a href="#利用indexOf去重" class="headerlink" title="利用indexOf去重"></a>利用indexOf去重</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 新建一个空的结果数组，for 循环原数组，判断结果数组是否存在当前元素，如果有相同的值则跳过，不相同则push进数组。</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">unique</span>(<span class="params">arr</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title class_">Array</span>.<span class="title function_">isArray</span>(arr)) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;type error!&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> array = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (array .<span class="title function_">indexOf</span>(arr[i]) === -<span class="number">1</span>) &#123;</span><br><span class="line">            array .<span class="title function_">push</span>(arr[i])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> array;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">1</span>,<span class="string">&#x27;true&#x27;</span>,<span class="string">&#x27;true&#x27;</span>,<span class="literal">true</span>,<span class="literal">true</span>,<span class="number">15</span>,<span class="number">15</span>,<span class="literal">false</span>,<span class="literal">false</span>,<span class="literal">undefined</span>,<span class="literal">undefined</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="title class_">NaN</span>,<span class="title class_">NaN</span>,<span class="string">&#x27;NaN&#x27;</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,&#123;&#125;,&#123;&#125;];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">unique</span>(arr))</span><br><span class="line"><span class="comment">// [1, &quot;true&quot;, true, 15, false, undefined, null, NaN, NaN, &quot;NaN&quot;, 0, &quot;a&quot;, &#123;…&#125;, &#123;…&#125;]  </span></span><br><span class="line"><span class="comment">// NaN、&#123;&#125;没有去重</span></span><br></pre></td></tr></table></figure><h3 id="利用includes"><a href="#利用includes" class="headerlink" title="利用includes"></a>利用includes</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">unique</span>(<span class="params">arr</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title class_">Array</span>.<span class="title function_">isArray</span>(arr)) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;type error!&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> array =[];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>( !array.<span class="title function_">includes</span>( arr[i]) ) &#123;    <span class="comment">// includes 检测数组是否有某个值</span></span><br><span class="line">            array.<span class="title function_">push</span>(arr[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> array</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">1</span>,<span class="string">&#x27;true&#x27;</span>,<span class="string">&#x27;true&#x27;</span>,<span class="literal">true</span>,<span class="literal">true</span>,<span class="number">15</span>,<span class="number">15</span>,<span class="literal">false</span>,<span class="literal">false</span>, <span class="literal">undefined</span>,<span class="literal">undefined</span>, <span class="literal">null</span>,<span class="literal">null</span>, <span class="title class_">NaN</span>, <span class="title class_">NaN</span>,<span class="string">&#x27;NaN&#x27;</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;a&#x27;</span>,&#123;&#125;,&#123;&#125;];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">unique</span>(arr))</span><br><span class="line"><span class="comment">// [1, &quot;true&quot;, true, 15, false, undefined, null, NaN, &quot;NaN&quot;, 0, &quot;a&quot;, &#123;…&#125;, &#123;…&#125;]   </span></span><br><span class="line"><span class="comment">// &#123;&#125;没有去重</span></span><br></pre></td></tr></table></figure><h3 id="利用sort"><a href="#利用sort" class="headerlink" title="利用sort()"></a>利用sort()</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 利用sort()排序方法，然后根据排序后的结果进行遍历及相邻元素比对。</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">unique</span>(<span class="params">arr</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title class_">Array</span>.<span class="title function_">isArray</span>(arr)) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;type error!&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    arr = arr.<span class="title function_">sort</span>()</span><br><span class="line">    <span class="keyword">var</span> arrry= [arr[<span class="number">0</span>]];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (arr[i] !== arr[i-<span class="number">1</span>]) &#123;</span><br><span class="line">            arrry.<span class="title function_">push</span>(arr[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arrry;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">1</span>,<span class="string">&#x27;true&#x27;</span>,<span class="string">&#x27;true&#x27;</span>,<span class="literal">true</span>,<span class="literal">true</span>,<span class="number">15</span>,<span class="number">15</span>,<span class="literal">false</span>,<span class="literal">false</span>,<span class="literal">undefined</span>,<span class="literal">undefined</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="title class_">NaN</span>,<span class="title class_">NaN</span>,<span class="string">&#x27;NaN&#x27;</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,&#123;&#125;,&#123;&#125;];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">unique</span>(arr))</span><br><span class="line"><span class="comment">// [0, 1, 15, &quot;NaN&quot;, NaN, NaN, &#123;…&#125;, &#123;…&#125;, &quot;a&quot;, false, null, true, &quot;true&quot;, undefined]  </span></span><br><span class="line"><span class="comment">// NaN、&#123;&#125;没有去重</span></span><br></pre></td></tr></table></figure><h3 id="利用对象的属性不能相同的特点进行去重（这种数组去重的方法有问题，不建议用，有待改进）"><a href="#利用对象的属性不能相同的特点进行去重（这种数组去重的方法有问题，不建议用，有待改进）" class="headerlink" title="利用对象的属性不能相同的特点进行去重（这种数组去重的方法有问题，不建议用，有待改进）"></a>利用对象的属性不能相同的特点进行去重（这种数组去重的方法有问题，不建议用，有待改进）</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">unique</span>(<span class="params">arr</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title class_">Array</span>.<span class="title function_">isArray</span>(arr)) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;type error!&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> arrry= [];</span><br><span class="line">    <span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!obj[arr[i]]) &#123;</span><br><span class="line">            arrry.<span class="title function_">push</span>(arr[i])</span><br><span class="line">            obj[arr[i]] = <span class="number">1</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            obj[arr[i]]++</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arrry;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">1</span>,<span class="string">&#x27;true&#x27;</span>,<span class="string">&#x27;true&#x27;</span>,<span class="literal">true</span>,<span class="literal">true</span>,<span class="number">15</span>,<span class="number">15</span>,<span class="literal">false</span>,<span class="literal">false</span>,<span class="literal">undefined</span>,<span class="literal">undefined</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="title class_">NaN</span>,<span class="title class_">NaN</span>,<span class="string">&#x27;NaN&#x27;</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,&#123;&#125;,&#123;&#125;];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">unique</span>(arr))</span><br><span class="line"><span class="comment">// [1, &quot;true&quot;, 15, false, undefined, null, NaN, 0, &quot;a&quot;, &#123;…&#125;]  </span></span><br><span class="line"><span class="comment">// 两个true直接去掉了，NaN和&#123;&#125;去重</span></span><br></pre></td></tr></table></figure><h3 id="利用hasOwnProperty"><a href="#利用hasOwnProperty" class="headerlink" title="利用hasOwnProperty"></a>利用hasOwnProperty</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 利用hasOwnProperty 判断是否存在对象属性</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">unique</span>(<span class="params">arr</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line">    <span class="keyword">return</span> arr.<span class="title function_">filter</span>(<span class="keyword">function</span>(<span class="params">item, index, arr</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> obj.<span class="title function_">hasOwnProperty</span>(<span class="keyword">typeof</span> item + item) ? <span class="literal">false</span> : (obj[<span class="keyword">typeof</span> item + item] = <span class="literal">true</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">1</span>,<span class="string">&#x27;true&#x27;</span>,<span class="string">&#x27;true&#x27;</span>,<span class="literal">true</span>,<span class="literal">true</span>,<span class="number">15</span>,<span class="number">15</span>,<span class="literal">false</span>,<span class="literal">false</span>,<span class="literal">undefined</span>,<span class="literal">undefined</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="title class_">NaN</span>,<span class="title class_">NaN</span>,<span class="string">&#x27;NaN&#x27;</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,&#123;&#125;,&#123;&#125;];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">unique</span>(arr))</span><br><span class="line"><span class="comment">// [1, &quot;true&quot;, true, 15, false, undefined, null, NaN, &quot;NaN&quot;, 0, &quot;a&quot;, &#123;…&#125;]   </span></span><br><span class="line"><span class="comment">// 所有的都去重了</span></span><br></pre></td></tr></table></figure><h3 id="利用filter"><a href="#利用filter" class="headerlink" title="利用filter"></a>利用filter</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">unique</span>(<span class="params">arr</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> arr.<span class="title function_">filter</span>(<span class="keyword">function</span>(<span class="params">item, index, arr</span>) &#123;</span><br><span class="line">        <span class="comment">//当前元素，在原始数组中的第一个索引==当前索引值，否则返回当前元素</span></span><br><span class="line">        <span class="keyword">return</span> arr.<span class="title function_">indexOf</span>(item, <span class="number">0</span>) === index;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">1</span>,<span class="string">&#x27;true&#x27;</span>,<span class="string">&#x27;true&#x27;</span>,<span class="literal">true</span>,<span class="literal">true</span>,<span class="number">15</span>,<span class="number">15</span>,<span class="literal">false</span>,<span class="literal">false</span>,<span class="literal">undefined</span>,<span class="literal">undefined</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="title class_">NaN</span>,<span class="title class_">NaN</span>,<span class="string">&#x27;NaN&#x27;</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,&#123;&#125;,&#123;&#125;];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">unique</span>(arr))</span><br><span class="line"><span class="comment">// [1, &quot;true&quot;, true, 15, false, undefined, null, &quot;NaN&quot;, 0, &quot;a&quot;, &#123;…&#125;, &#123;…&#125;]</span></span><br></pre></td></tr></table></figure><h3 id="利用递归去重"><a href="#利用递归去重" class="headerlink" title="利用递归去重"></a>利用递归去重</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">unique</span>(<span class="params">arr</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> array= arr;</span><br><span class="line">    <span class="keyword">var</span> len = array.<span class="property">length</span>;</span><br><span class="line"></span><br><span class="line">    array.<span class="title function_">sort</span>(<span class="keyword">function</span>(<span class="params">a,b</span>)&#123;   <span class="comment">//排序后更加方便去重</span></span><br><span class="line">        <span class="keyword">return</span> a - b;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">loop</span>(<span class="params">index</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(index &gt;= <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span>(array[index] === array[index-<span class="number">1</span>]) &#123;</span><br><span class="line">                array.<span class="title function_">splice</span>(index,<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="title function_">loop</span>(index - <span class="number">1</span>);    <span class="comment">//递归loop，然后数组去重</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">loop</span>(len-<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> array;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">1</span>,<span class="string">&#x27;true&#x27;</span>,<span class="string">&#x27;true&#x27;</span>,<span class="literal">true</span>,<span class="literal">true</span>,<span class="number">15</span>,<span class="number">15</span>,<span class="literal">false</span>,<span class="literal">false</span>,<span class="literal">undefined</span>,<span class="literal">undefined</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="title class_">NaN</span>,<span class="title class_">NaN</span>,<span class="string">&#x27;NaN&#x27;</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,&#123;&#125;,&#123;&#125;];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">unique</span>(arr))</span><br><span class="line"><span class="comment">// [1, &quot;a&quot;, &quot;true&quot;, true, 15, false, 1, &#123;…&#125;, null, NaN, NaN, &quot;NaN&quot;, 0, &quot;a&quot;, &#123;…&#125;, undefined]</span></span><br></pre></td></tr></table></figure><h3 id="利用Map数据结构去重"><a href="#利用Map数据结构去重" class="headerlink" title="利用Map数据结构去重"></a>利用Map数据结构去重</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一个空Map数据结构，遍历需要去重的数组，把数组的每一个元素作为key存到Map中。由于Map中不会出现相同的key值，所以最终得到的就是去重后的结果。</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">arrayNonRepeatfy</span>(<span class="params">arr</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> map = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line">    <span class="keyword">let</span> array = <span class="keyword">new</span> <span class="title class_">Array</span>();  <span class="comment">// 数组用于返回结果</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(map .<span class="title function_">has</span>(arr[i])) &#123;  <span class="comment">// 如果有该key值</span></span><br><span class="line">            map .<span class="title function_">set</span>(arr[i], <span class="literal">true</span>); </span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">            map .<span class="title function_">set</span>(arr[i], <span class="literal">false</span>);   <span class="comment">// 如果没有该key值</span></span><br><span class="line">            array .<span class="title function_">push</span>(arr[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> array ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">1</span>,<span class="string">&#x27;true&#x27;</span>,<span class="string">&#x27;true&#x27;</span>,<span class="literal">true</span>,<span class="literal">true</span>,<span class="number">15</span>,<span class="number">15</span>,<span class="literal">false</span>,<span class="literal">false</span>,<span class="literal">undefined</span>,<span class="literal">undefined</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="title class_">NaN</span>,<span class="title class_">NaN</span>,<span class="string">&#x27;NaN&#x27;</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,&#123;&#125;,&#123;&#125;];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">unique</span>(arr))</span><br><span class="line"><span class="comment">// [1, &quot;a&quot;, &quot;true&quot;, true, 15, false, 1, &#123;…&#125;, null, NaN, NaN, &quot;NaN&quot;, 0, &quot;a&quot;, &#123;…&#125;, undefined]</span></span><br></pre></td></tr></table></figure><h3 id="利用reduce-includes"><a href="#利用reduce-includes" class="headerlink" title="利用reduce+includes"></a>利用reduce+includes</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">unique</span>(<span class="params">arr</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> arr.<span class="title function_">reduce</span>(<span class="function">(<span class="params">prev,cur</span>) =&gt;</span> prev.<span class="title function_">includes</span>(cur) ? prev : [...prev,cur],[]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">1</span>,<span class="string">&#x27;true&#x27;</span>,<span class="string">&#x27;true&#x27;</span>,<span class="literal">true</span>,<span class="literal">true</span>,<span class="number">15</span>,<span class="number">15</span>,<span class="literal">false</span>,<span class="literal">false</span>,<span class="literal">undefined</span>,<span class="literal">undefined</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="title class_">NaN</span>,<span class="title class_">NaN</span>,<span class="string">&#x27;NaN&#x27;</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,&#123;&#125;,&#123;&#125;];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">unique</span>(arr));</span><br><span class="line"><span class="comment">// [1, &quot;true&quot;, true, 15, false, undefined, null, NaN, &quot;NaN&quot;, 0, &quot;a&quot;, &#123;…&#125;, &#123;…&#125;]</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 控制流程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 位运算 </tag>
            
            <tag> 去重 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>promise</title>
      <link href="/posts/9b0c2390/"/>
      <url>/posts/9b0c2390/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a href="https://juejin.cn/post/6844904077537574919">45道Promise面试题</a></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">async1</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;1&#x27;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">await</span> <span class="title function_">async2</span>());</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;2&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">async2</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;3&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">setTimeout</span>( <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;4&#x27;</span>);</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Promise</span>( <span class="keyword">function</span> (<span class="params">resolve</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;5&#x27;</span>);</span><br><span class="line">        <span class="title function_">resolve</span>();</span><br><span class="line">    &#125;).<span class="title function_">then</span>( <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;6&#x27;</span>) </span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="title function_">async1</span>();</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>( <span class="keyword">function</span> (<span class="params">resolve</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;7&#x27;</span>);</span><br><span class="line">    <span class="title function_">resolve</span>();</span><br><span class="line">&#125;).<span class="title function_">then</span>( <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;8&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;9&#x27;</span>);</span><br></pre></td></tr></table></figure><p>答案：<code>1 3 7 9 0 2 8 4 5 6</code></p><blockquote><p>从setTimeout开始执行，setTimeout是宏任务，回调进入任务队列；<br>async1执行，打印出1，执行async2，打印出3，因为async2返回值是promise，阻塞await之后的代码；<br>new Promise是同步代码，打印出来7，then回调进入微任务队列，console.log(‘9’)是同步代码，打印出来9；<br>因此，第一轮打印的是 1 3 7 9，继续async1中阻塞的代码，打印出0 2，<br>检查微任务队列，打印出8；<br>进入setTimeout的宏任务，打印出同步代码4 5，then回调进微任务队列，执行栈空，检查微任务队列，打印出6。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Promise</span></span><br><span class="line">.<span class="title function_">resolve</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">.<span class="title function_">then</span>(<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">.<span class="title function_">then</span>(<span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="string">&#x27;c&#x27;</span>))</span><br><span class="line">.<span class="title function_">then</span>(<span class="variable language_">console</span>.<span class="property">log</span>)</span><br></pre></td></tr></table></figure><p>答案：<code>a</code></p><blockquote><p>根据Promise A+规范，then方法的参数不是函数则忽略</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Promise</span>.<span class="title function_">resolve</span>(&#123;</span><br><span class="line">    <span class="attr">then</span>:  <span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;d&#x27;</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>答案：<code>a</code></p><blockquote><p>“如果 then 是一个函数，则调用它”，打印出来a，但是这个thenable不能决议，所以Promise.resolve({ then: function(){ console.log(‘a’); }})一直是pending状态，then(() &#x3D;&gt; { console.log(‘d’); })不会执行。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Promise</span>.<span class="title function_">resolve</span>(&#123;</span><br><span class="line">    <span class="attr">then</span>:  <span class="keyword">function</span> (<span class="params">fullfill</span>)&#123;</span><br><span class="line">        <span class="title function_">fullfill</span>(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;c&#x27;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;d&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;).<span class="title function_">then</span>(</span><br><span class="line">    <span class="function">(<span class="params">d</span>) =&gt;</span> &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(d); &#125;,</span><br><span class="line">    <span class="function">(<span class="params">err</span>) =&gt;</span> &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>); &#125;,</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>答案：<code>b a</code></p><blockquote><p>据规范2.3.3中“如果 then 是一个函数，则调用它”，打印出来b，thenable里fullfill执行之后promise为resolve的状态，value为a（参考规范对thenable的决议说明），then( (d) &#x3D;&gt; { console.log(d); }, (err) &#x3D;&gt; { console.log(err.message); }, )中执行onFulfilled，打印出a。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="number">3</span>).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;c&#x27;</span>);</span><br><span class="line">&#125;, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;d&#x27;</span>;</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">d</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;d&#x27;</span>), <span class="function">(<span class="params">e</span>) =&gt;</span> &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;e&#x27;</span>)&#125;)</span><br></pre></td></tr></table></figure><p>答案：<code>a b d</code></p><blockquote><p>参考promise的错误处理。</p></blockquote><p>Promise在resolve语句后抛出错误能否被捕获？</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>( <span class="keyword">function</span> (<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">    <span class="title function_">resolve</span>(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line">&#125;)</span><br><span class="line">.<span class="title function_">then</span>(<span class="variable language_">console</span>.<span class="property">log</span>)</span><br><span class="line">.<span class="title function_">catch</span>(<span class="variable language_">console</span>.<span class="property">log</span>);</span><br></pre></td></tr></table></figure><p>答案：能</p><blockquote><p>不能，promise只能决议一次。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> * <span class="title function_">gen</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="keyword">yield</span> <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">    <span class="keyword">var</span> b = <span class="keyword">yield</span> a + <span class="string">&#x27;b&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> g = <span class="title function_">gen</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(g.<span class="title function_">next</span>());</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(g.<span class="title function_">next</span>(<span class="string">&#x27;c&#x27;</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(g.<span class="title function_">next</span>());</span><br></pre></td></tr></table></figure><p>答案：<code>&#123;value: &quot;a&quot;, done: false&#125; &#123;value: &quot;cb&quot;, done: false&#125; &#123;value: undefined, done: true&#125;</code></p><blockquote><p>next带的参数会作为上次yield的值。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> * <span class="title function_">gen1</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">    <span class="keyword">yield</span> <span class="string">&#x27;b&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> * <span class="title function_">gen2</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">yield</span>* <span class="title function_">gen1</span>();</span><br><span class="line">    <span class="keyword">yield</span> <span class="string">&#x27;c&#x27;</span>;</span><br><span class="line">    <span class="keyword">yield</span> <span class="string">&#x27;d&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> * <span class="title function_">gen3</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">gen1</span>();</span><br><span class="line">    <span class="keyword">yield</span> <span class="string">&#x27;c&#x27;</span>;</span><br><span class="line">    <span class="keyword">yield</span> <span class="string">&#x27;d&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> g2 = <span class="title function_">gen2</span>();</span><br><span class="line"><span class="keyword">const</span> g3 = <span class="title function_">gen3</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> v <span class="keyword">of</span> g2) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> v <span class="keyword">of</span> g3) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(v);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>答案：<code>a b c d c d</code></p><blockquote><p>参考yield*迭代器委托。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">geneP</span>(<span class="params">d1,d2</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>( <span class="keyword">function</span> (<span class="params">resolve, reject</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (+<span class="keyword">new</span> <span class="title class_">Date</span>() &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="title function_">resolve</span>(d1);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="title function_">reject</span>(d2);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> * <span class="title function_">gen</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="title function_">geneP</span>(<span class="string">&#x27;yes&#x27;</span>,<span class="string">&#x27;no&#x27;</span>);</span><br><span class="line">    <span class="keyword">yield</span> <span class="title function_">geneP</span>(<span class="string">&#x27;y&#x27;</span>,<span class="string">&#x27;n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">run</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> g = <span class="title function_">fn</span>();</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">next</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> result = g.<span class="title function_">next</span>();</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(result.<span class="property">value</span>);</span><br><span class="line">        <span class="keyword">if</span> (result.<span class="property">done</span>)  <span class="keyword">return</span> ;</span><br><span class="line">        result.<span class="property">value</span>.<span class="title function_">then</span>(next);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">next</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">run</span>(gen);</span><br></pre></td></tr></table></figure><p>答案：<code>Promise &#123;</code><resolved><code>: &quot;yes&quot;&#125; Promise &#123;</code><resolved><code>: &quot;y&quot;&#125;</code></p><blockquote><p>run是结合promise实现的简单的执行器，geneP的返回值是Promise对象，所以应该打印出promise。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> JS面试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Promise </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>手写Promise</title>
      <link href="/posts/953054e4/"/>
      <url>/posts/953054e4/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a href="https://juejin.cn/post/6945319439772434469#heading-6">手写promise实现过程</a></p><p><a href="https://github.com/leocoder351/my-promise">leocoder351&#x2F;my-promise</a></p><p><a href="https://juejin.cn/post/6924188714419634190">看懂此文，手写十种Promise！</a></p><p>QPromise的实现过程</p><p><strong>观察者模式</strong>：收集依赖 -&gt; 触发通知 -&gt; 取出依赖执行</p><p>Promise的调用过程：基于<strong>观察者模式</strong>，执行顺序是then收集依赖 -&gt; 异步触发resolve -&gt; resolve执行依赖。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 新建 QPromise.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Promise/A+规定的三种状态</span></span><br><span class="line"><span class="comment">// 定义三个常量来表示</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PENDING</span> = <span class="string">&quot;pending&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">FULFILLED</span> = <span class="string">&quot;fulfilled&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">REJECTED</span> = <span class="string">&quot;rejected&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 新建 QPromise 类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">QPromise</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">executor</span>) &#123;</span><br><span class="line">        <span class="comment">// executor是一个执行器，进入会立即执行</span></span><br><span class="line">        <span class="comment">// 传入resolve和reject方法</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="title function_">executor</span>(<span class="variable language_">this</span>.<span class="property">resolve</span>, <span class="variable language_">this</span>.<span class="property">reject</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            <span class="comment">// 如果有错误，就直接执行reject</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">reject</span>(error);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 存储状态的变量，初始值是pending</span></span><br><span class="line">    status = <span class="variable constant_">PENDING</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 成功之后的值</span></span><br><span class="line">    value = <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">//失败之后的原因</span></span><br><span class="line">    reason = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 数组-存储-成功回调函数</span></span><br><span class="line">    <span class="comment">// onFulfilledCallback = null;</span></span><br><span class="line">    onFulfilledCallbacks = [];</span><br><span class="line">    <span class="comment">// 数组-存储-失败回调函数</span></span><br><span class="line">    <span class="comment">// onRejectedCallback = null;</span></span><br><span class="line">    onRejectedCallbacks = [];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// resolve和reject为什么要用箭头函数？</span></span><br><span class="line">    <span class="comment">// 如果直接调用的话，普通函数this指向的是window或者undefined</span></span><br><span class="line">    <span class="comment">// 用箭头函数就可以让this指向当前实例对象</span></span><br><span class="line">    <span class="comment">// 更改成功后的状态</span></span><br><span class="line">    resolve = <span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 只有状态是等待，才执行状态修改</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">status</span> === <span class="variable constant_">PENDING</span>) &#123;</span><br><span class="line">            <span class="comment">// 状态修改为“已成功”</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">status</span> = <span class="variable constant_">FULFILLED</span>;</span><br><span class="line">            <span class="comment">// 保存成功之后的值</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">value</span> = value;</span><br><span class="line">            <span class="comment">// 判断成功回调函数是否存在，如果存在就调用</span></span><br><span class="line">            <span class="keyword">while</span>(<span class="variable language_">this</span>.<span class="property">onFulfilledCallbacks</span>.<span class="property">length</span>) &#123;</span><br><span class="line">                <span class="comment">// Array.shift() 取出数组第一个元素，然后（）调用，shift不是纯函数，取出后，数组将失去该元素，直到数组为空</span></span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">onFulfilledCallbacks</span>.<span class="title function_">shift</span>()(value);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// 更改失败后的状态</span></span><br><span class="line">    reject = <span class="function">(<span class="params">reason</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 只有状态是等待，才执行状态修改</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">status</span> === <span class="variable constant_">PENDING</span>) &#123;</span><br><span class="line">            <span class="comment">// 状态修改为“已失败”</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">status</span> = <span class="variable constant_">REJECTED</span>;</span><br><span class="line">            <span class="comment">// 保存失败之后的原因</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">reason</span> = reason;</span><br><span class="line">            <span class="comment">// 判断失败回调函数是否存在，如果存在就调用</span></span><br><span class="line">            <span class="keyword">while</span>(<span class="variable language_">this</span>.<span class="property">onRejectedCallbacks</span>.<span class="property">length</span>) &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">onRejectedCallbacks</span>.<span class="title function_">shift</span>()(reason);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">then</span>(<span class="params">onFulfilled, onRejected</span>) &#123;</span><br><span class="line">        <span class="comment">// 如果不传，就使用默认函数</span></span><br><span class="line">        <span class="keyword">const</span> realOnFulfilled = <span class="keyword">typeof</span> onFulfilled === <span class="string">&#x27;function&#x27;</span> ? <span class="attr">onFulfilled</span>:<span class="function"><span class="params">value</span> =&gt;</span> value;</span><br><span class="line">        <span class="keyword">const</span> realOnRejected = <span class="keyword">typeof</span> onRejected === <span class="string">&#x27;function&#x27;</span> ? <span class="attr">onRejected</span>:<span class="function"><span class="params">reason</span> =&gt;</span> &#123;<span class="keyword">throw</span> reason&#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 为了链式调用这里直接创建一个 MyPromise，并在后面 return 出去</span></span><br><span class="line">        <span class="keyword">const</span> promise2 = <span class="keyword">new</span> <span class="title class_">QPromise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> <span class="title function_">fulfilledMicroMask</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">                <span class="comment">// 创建一个微任务等待promise2完成初始化</span></span><br><span class="line">                <span class="title function_">queueMicrotask</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        <span class="comment">// 获取调用-成功回调函数的执行结果</span></span><br><span class="line">                        <span class="keyword">const</span> x = <span class="title function_">realOnFulfilled</span>(<span class="variable language_">this</span>.<span class="property">value</span>);</span><br><span class="line">                        <span class="comment">// 传入resolvePromise集中处理</span></span><br><span class="line">                        <span class="title function_">resolvePromise</span>(promise2, x, resolve, reject);</span><br><span class="line">                    &#125; <span class="keyword">catch</span>(error) &#123;</span><br><span class="line">                        <span class="title function_">reject</span>(error);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);   </span><br><span class="line">            &#125;</span><br><span class="line">  </span><br><span class="line">            <span class="keyword">const</span> <span class="title function_">rejectedMicroMask</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">                <span class="comment">// 创建一个微任务等待promise2完成初始化</span></span><br><span class="line">                <span class="title function_">queueMicrotask</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        <span class="comment">// 获取调用-成功回调函数的执行结果</span></span><br><span class="line">                        <span class="keyword">const</span> x = <span class="title function_">realOnRejected</span>(<span class="variable language_">this</span>.<span class="property">reason</span>);</span><br><span class="line">                        <span class="comment">// 传入resolvePromise集中处理</span></span><br><span class="line">                        <span class="title function_">resolvePromise</span>(promise2, x, resolve, reject);</span><br><span class="line">                    &#125; <span class="keyword">catch</span>(error) &#123;</span><br><span class="line">                        <span class="title function_">reject</span>(error);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125; </span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">status</span> === <span class="variable constant_">FULFILLED</span>) &#123;</span><br><span class="line">                <span class="title function_">fulfilledMicroMask</span>();</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">status</span> === <span class="variable constant_">REJECTED</span>) &#123;</span><br><span class="line">                <span class="title function_">rejectedMicroMask</span>();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// 因为不知道后面状态的变化情况，所以将成功回调和失败回调存储起来</span></span><br><span class="line">                <span class="comment">// 等到执行成功/失败函数的时候再传递</span></span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">onFulfilledCallbacks</span>.<span class="title function_">push</span>(fulfilledMicroMask);</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">onRejectedCallbacks</span>.<span class="title function_">push</span>(rejectedMicroMask);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">return</span> promise2;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// resolve 静态方法</span></span><br><span class="line">    <span class="keyword">static</span> <span class="title function_">resolve</span>(<span class="params">parameter</span>) &#123;</span><br><span class="line">        <span class="comment">// 如果传入 QPromise 就直接返回</span></span><br><span class="line">        <span class="keyword">if</span>(parameter <span class="keyword">instanceof</span> <span class="title class_">QPromise</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> parameter;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 转成常规方式</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">QPromise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">resolve</span>(parameter);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// reject 静态方法</span></span><br><span class="line">    <span class="keyword">static</span> <span class="title function_">reject</span>(<span class="params">reason</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">QPromise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">reject</span>(reason);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">resolvePromise</span>(<span class="params">promise, x, resolve, reject</span>) &#123;</span><br><span class="line">    <span class="comment">// 如果相等了，说明return的是自己，抛出类型错误并返回</span></span><br><span class="line">    <span class="keyword">if</span>(promise === x) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">TypeError</span>(<span class="string">&#x27;The promise and the return value are the same&#x27;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">typeof</span> x === <span class="string">&#x27;function&#x27;</span> || <span class="keyword">typeof</span> x === <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">        <span class="comment">// x 为 null 直接返回，走后面的逻辑会报错</span></span><br><span class="line">        <span class="keyword">if</span>(x === <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">resolve</span>(x);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> then;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 把 x.then 赋值给 then </span></span><br><span class="line">            then = x.<span class="property">then</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            <span class="comment">// 如果取 x.then 的值时抛出错误 error ，则以 error 为据因拒绝 promise</span></span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">reject</span>(error);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 如果 then 是函数</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">typeof</span> then === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">let</span> called = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                then.<span class="title function_">call</span>(</span><br><span class="line">                    <span class="comment">// this 指向 x</span></span><br><span class="line">                    x,</span><br><span class="line">                    <span class="comment">// 如果 resolvePromise 以值 y 为参数被调用，则运行 [[Resolve]](promise, y)</span></span><br><span class="line">                    <span class="function"><span class="params">y</span> =&gt;</span> &#123;</span><br><span class="line">                        <span class="comment">// 如果 resolvePromise 和 rejectPromise 均被调用，</span></span><br><span class="line">                        <span class="comment">// 或者被同一参数调用了多次，则优先采用首次调用并忽略剩下的调用</span></span><br><span class="line">                        <span class="comment">// 实现这条需要前面加一个变量 called</span></span><br><span class="line">                        <span class="keyword">if</span>(called) <span class="keyword">return</span>;</span><br><span class="line">                        called = <span class="literal">true</span>;</span><br><span class="line">                        <span class="title function_">resolvePromise</span>(promise, y, resolve, reject);</span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="comment">// 如果 rejectPromise 以据因 z 为参数被调用，则以据因 z 拒绝 promise</span></span><br><span class="line">                    <span class="function"><span class="params">z</span> =&gt;</span> &#123;</span><br><span class="line">                        <span class="keyword">if</span>(called) <span class="keyword">return</span>;</span><br><span class="line">                        called = <span class="literal">true</span>;</span><br><span class="line">                        <span class="title function_">reject</span>(z);</span><br><span class="line">                    &#125;</span><br><span class="line">                );</span><br><span class="line">            &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">                <span class="comment">// 如果调用 then 方法抛出了异常 error：</span></span><br><span class="line">                <span class="comment">// 如果 resolvePromise 或 rejectPromise 已经被调用，直接返回</span></span><br><span class="line">                <span class="keyword">if</span> (called) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 否则以 error 为据因拒绝 promise</span></span><br><span class="line">                <span class="title function_">reject</span>(error);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 如果then不是函数，以x为参数执行promise</span></span><br><span class="line">            <span class="title function_">resolve</span>(x);</span><br><span class="line">        &#125; </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 如果 x 不为对象或者函数，以 x 为参数执行 promise</span></span><br><span class="line">        <span class="title function_">resolve</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title class_">QPromise</span>.<span class="property">defer</span> = <span class="title class_">QPromise</span>.<span class="property">deferred</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> result = &#123;&#125;;</span><br><span class="line">    result.<span class="property">promise</span> = <span class="keyword">new</span> <span class="title class_">QPromise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">        result.<span class="property">resolve</span> = resolve;</span><br><span class="line">        result.<span class="property">reject</span> = reject;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title class_">QPromise</span>;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> ES新特性 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ES6 </tag>
            
            <tag> Promise </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>布局及应用代码</title>
      <link href="/posts/24fb3039/"/>
      <url>/posts/24fb3039/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="实现上中下三行布局，顶部和底部最小高度是100px，中间自适应"><a href="#实现上中下三行布局，顶部和底部最小高度是100px，中间自适应" class="headerlink" title="实现上中下三行布局，顶部和底部最小高度是100px，中间自适应?"></a>实现上中下三行布局，顶部和底部最小高度是100px，中间自适应?</h3><h3 id="如何判断一个元素-CSS-样式溢出，从而可以选择性的加-title-或者-Tooltip"><a href="#如何判断一个元素-CSS-样式溢出，从而可以选择性的加-title-或者-Tooltip" class="headerlink" title="如何判断一个元素 CSS 样式溢出，从而可以选择性的加 title 或者 Tooltip?"></a>如何判断一个元素 CSS 样式溢出，从而可以选择性的加 title 或者 Tooltip?</h3><h3 id="如何让-CSS-元素左侧自动溢出（…-溢出在左侧）"><a href="#如何让-CSS-元素左侧自动溢出（…-溢出在左侧）" class="headerlink" title="如何让 CSS 元素左侧自动溢出（… 溢出在左侧）"></a>如何让 CSS 元素左侧自动溢出（… 溢出在左侧）</h3><h3 id="用纯CSS创建一个三角形的原理是什么？"><a href="#用纯CSS创建一个三角形的原理是什么？" class="headerlink" title="用纯CSS创建一个三角形的原理是什么？"></a>用纯CSS创建一个三角形的原理是什么？</h3><p><a href="https://www.cnblogs.com/L-xmin/p/13269181.html">CSS 边框的基础使用</a></p><p><img src="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200709092043512-112476183.png" alt="img"></p><h3 id="元素居中"><a href="#元素居中" class="headerlink" title="元素居中"></a>元素居中</h3><a href="/posts/2afbcfa6/" title="居中">居中</a><h3 id="满屏品字布局"><a href="#满屏品字布局" class="headerlink" title="满屏品字布局"></a>满屏品字布局</h3><p>涉及知识点：</p><ol><li>解决上下两行占总高50%</li><li>上面的‘口’居中布局，<code>margin:0 auto</code></li><li>下面两个‘口’左右布局，<code>float:left;width:50%</code></li></ol><p>无非就是综合了各种布局的使用，代码放于文末</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;./css/style.css&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>满屏品字布局<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- header水平居中 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;header&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- main中的元素左右布局 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;main&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;left&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;right&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">* &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 重点是html的height也得是100% */</span></span><br><span class="line"><span class="selector-tag">html</span>,</span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.header</span> &#123;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#fae3d9</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.main</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.main</span> <span class="selector-class">.left</span> &#123;</span><br><span class="line">    <span class="attribute">float</span>: left;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#bbded6</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.main</span> <span class="selector-class">.right</span> &#123;</span><br><span class="line">    <span class="attribute">float</span>: left;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#8ac6d1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="有一个高度自适应的div，里面有两个div，一个高度100px，希望另一个填满剩下的高度"><a href="#有一个高度自适应的div，里面有两个div，一个高度100px，希望另一个填满剩下的高度" class="headerlink" title="有一个高度自适应的div，里面有两个div，一个高度100px，希望另一个填满剩下的高度"></a>有一个高度自适应的div，里面有两个div，一个高度100px，希望另一个填满剩下的高度</h3><p>思路：在div上方留出100px的padding，想方设法将A覆盖掉这100px的padding。<br>三种方法，代码放于文末。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span><span class="attr">media</span>=<span class="string">&quot;screen and (max-width: 500px)&quot;</span> <span class="attr">href</span>=<span class="string">&quot;./css/style.css&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>有一个高度自适应的div，里面有两个div，一个高度100px，希望另一个填满剩下的高度(三种方案)<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;A&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;B&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">html</span>,</span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*方案一*/</span></span><br><span class="line"><span class="selector-class">.outer</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">100px</span> <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.A</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">margin</span>: -<span class="number">100px</span> <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#BBE8F2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.B</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#D9C666</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*方案二*/</span></span><br><span class="line"><span class="selector-class">.outer</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">100px</span> <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.A</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#BBE8F2</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.B</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#D9C666</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*方案三*/</span></span><br><span class="line"><span class="selector-class">.outer</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.A</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#BBE8F2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.B</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#D9C666</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="固定宽高的块级盒子"><a href="#固定宽高的块级盒子" class="headerlink" title="固定宽高的块级盒子"></a>固定宽高的块级盒子</h3><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">absolute + 负 margin</button></li><li class="tab"><button type="button" data-href="#super-2">absolute + margin auto</button></li><li class="tab"><button type="button" data-href="#super-3">absolute + calc</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@m2/img/css-baisc-review-fixed-width-height-way-1.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@m2/img/css-baisc-review-fixed-width-height-way-2.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@m2/img/css-baisc-review-fixed-width-height-way-3.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="不固定宽高的块级盒子"><a href="#不固定宽高的块级盒子" class="headerlink" title="不固定宽高的块级盒子"></a>不固定宽高的块级盒子</h3><p>这里列了 6 种方法，其中的两种 line-height 和 writing-mode 方案看后让我惊唿：还有这种操作？学到了学到了。</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">absolute + transform</button></li><li class="tab"><button type="button" data-href="#super-2">line-height + vertical-align</button></li><li class="tab"><button type="button" data-href="#super-3">writing-mode</button></li><li class="tab"><button type="button" data-href="#super-4">table-cell</button></li><li class="tab"><button type="button" data-href="#super-5">flex</button></li><li class="tab"><button type="button" data-href="#super-6">grid</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@m2/img/css-baisc-review-not-fixed-width-height-way-1.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@m2/img/css-baisc-review-not-fixed-width-height-way-2.png" alt="640"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@m2/img/css-baisc-review-not-fixed-width-height-way-3.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@m2/img/css-baisc-review-not-fixed-width-height-way-4.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@m2/img/css-baisc-review-not-fixed-width-height-way-5.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-6"><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@m2/img/css-baisc-review-not-fixed-width-height-way-6.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="常用布局"><a href="#常用布局" class="headerlink" title="常用布局"></a>常用布局</h3><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">两栏布局（边栏定宽主栏自适应）</button></li><li class="tab"><button type="button" data-href="#super-2">三栏布局（两侧栏定宽主栏自适应）</button></li><li class="tab"><button type="button" data-href="#super-3">多列等高布局</button></li><li class="tab"><button type="button" data-href="#super-4">三行布局（头尾定高主栏自适应）</button></li><li class="tab"><button type="button" data-href="#super-5">super 5</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>针对以下这些方案写了几个示例：<a href="https://codepen.io/bulandent/pen/JjbqxbM">两栏布局（边栏定宽主栏自适应） (codepen.io)</a></p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">float + overflow（BFC 原理）</button></li><li class="tab"><button type="button" data-href="#super-2">float + margin</button></li><li class="tab"><button type="button" data-href="#super-3">flex</button></li><li class="tab"><button type="button" data-href="#super-4">grid</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@m2/img/css-basic-review-two-column-layout-way-2.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@m2/img/css-basic-review-two-column-layout-way-3.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@m2/img/css-basic-review-two-column-layout-way-1.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@m2/img/css-basic-review-two-column-layout-way-4.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>针对以下这些方案写了几个示例：<a href="https://codepen.io/bulandent/pen/abBrXrj">三栏布局（两侧边栏定宽主栏自适应） (codepen.io)</a></p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">圣杯布局</button></li><li class="tab"><button type="button" data-href="#super-2">双飞翼布局</button></li><li class="tab"><button type="button" data-href="#super-3">float + overflow（BFC 原理）</button></li><li class="tab"><button type="button" data-href="#super-4">flex</button></li><li class="tab"><button type="button" data-href="#super-5">grid</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@m2/img/css-basic-review-three-column-layout-way-1.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@m2/img/css-basic-review-three-column-layout-way-2.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@m2/img/css-basic-review-three-column-layout-way-4.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@m2/img/css-basic-review-three-column-layout-way-3.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@m2/img/css-basic-review-three-column-layout-way-5.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>结合示例阅读更佳：<a href="https://codepen.io/bulandent/pen/jOVogdj">多列等高布局 (codepen.io)</a></p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">padding + 负 margin</button></li><li class="tab"><button type="button" data-href="#super-2">设置父级背景图片</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@m2/img/css-basic-review-more-column-layout-way-2.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@m2/img/css-basic-review-more-column-layout-way-1.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>列了 4 种方法，都是基于如下的 HTML 和 CSS 的，结合示例阅读效果更佳：<a href="https://codepen.io/bulandent/pen/yLVdpvr">三行布局（头尾固定主栏自适应） (codepen.io)</a></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layout&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">header</span>&gt;</span><span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">main</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">main</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">footer</span>&gt;</span><span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">html</span>,</span><br><span class="line"><span class="selector-tag">body</span>,</span><br><span class="line"><span class="selector-class">.layout</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">header</span>, </span><br><span class="line"><span class="selector-tag">footer</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">main</span> &#123;</span><br><span class="line">    <span class="attribute">overflow-y</span>: auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">calc</button></li><li class="tab"><button type="button" data-href="#super-2">absolute</button></li><li class="tab"><button type="button" data-href="#super-3">flex</button></li><li class="tab"><button type="button" data-href="#super-4">grid</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@m2/img/css-basic-review-three-coulum-calc.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@m2/img/css-basic-review-three-coulum-flex.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@m2/img/css-basic-review-three-coulum-absolute.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@m2/img/css-basic-review-three-coulum-grid.png" alt="图片"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>1、固定布局<br>一列水平居中布局margin: 0 auto;<br>两列布局（浮动）float: left&#x2F;right;<br>三列布局（浮动）float: left&#x2F;right;<br>  注：三个子元素的width之和 &lt; 父元素的width<br>2、自适应宽度布局（使用百分比而不是固定值来确定元素大小）<br>两列布局（左侧定宽，右侧自适应）<br>1、浮动法<br>基本思路：<br>1、左侧设置固定宽度并设置浮动float: left;<br>2、右侧不设置宽度，只设置左侧边距（margin-left） &#x3D; 左侧栏的宽度 + 左右侧间距<br>2、定位法<br>基本思路：<br>1、父元素设置为positive:relative<br>2、左栏设置固定宽度，设置为绝对定位positive: absolute;<br>3、右栏设置相对定位positive: relative;（使其遮盖左侧栏）<br>4、右栏设置左边距，边距值（margin-left） &#x3D; 左侧栏宽度<br>三列布局（中间自适应）<br>1、浮动法<br>基本思路：<br>1、左侧和右侧都设置固定宽度并设置浮动float: left;<br>2、中间栏设置左右边距，边距值 &#x3D; 左右栏的宽度（margin: 0 300px;）<br>2、定位法<br>基本思路：<br>1、父元素设置为positive:relative;<br>2、左右栏设置固定宽度，设置为绝对定位positive: absolute;<br>3、中间栏设置相对定位positive: relative;（使其遮盖左右侧栏）<br>4、中间栏设置左右边距，对应左右侧栏的宽度值<br>3、响应式布局<br>PC上固定宽度，手机上不固定（混合布局）</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> CSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 布局 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常见的兼容性问题</title>
      <link href="/posts/b0c141a7/"/>
      <url>/posts/b0c141a7/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="一：不同浏览器的标签默认的外补丁和内补丁不同"><a href="#一：不同浏览器的标签默认的外补丁和内补丁不同" class="headerlink" title="一：不同浏览器的标签默认的外补丁和内补丁不同"></a>一：不同浏览器的标签默认的外补丁和内补丁不同</h3><p>问题症状：随便写几个标签，不加样式控制的情况下，各自的margin 和padding差异较大。</p><p>碰到频率:100%</p><p>解决方案：CSS里 *{margin:0;padding:0;}</p><p>备注：这个是最常见的也是最易解决的一个浏览器兼容性问题，几乎所有的CSS文件开头都会用通配符*来设置各个标签的内外补丁是0。</p><h3 id="二：块属性标签float后，又有横行的margin情况下，在IE6显示margin比设置的大"><a href="#二：块属性标签float后，又有横行的margin情况下，在IE6显示margin比设置的大" class="headerlink" title="二：块属性标签float后，又有横行的margin情况下，在IE6显示margin比设置的大"></a>二：块属性标签float后，又有横行的margin情况下，在IE6显示margin比设置的大</h3><p>问题症状:常见症状是IE6中后面的一块被顶到下一行</p><p>碰到频率：90%（稍微复杂点的页面都会碰到，float布局最常见的浏览器兼容问题）</p><p>解决方案：在float的标签样式控制中加入 display:inline;将其转化为行内属性</p><p>备注：我们最常用的就是div+CSS布局了，而div就是一个典型的块属性标签，横向布局的时候我们通常都是用div float实现的，横向的间距设置如果用margin实现，这就是一个必然会碰到的兼容性问题。</p><h3 id="三：设置较小高度标签（一般小于10px），在IE6，IE7，遨游中高度超出自己设置高度"><a href="#三：设置较小高度标签（一般小于10px），在IE6，IE7，遨游中高度超出自己设置高度" class="headerlink" title="三：设置较小高度标签（一般小于10px），在IE6，IE7，遨游中高度超出自己设置高度"></a>三：设置较小高度标签（一般小于10px），在IE6，IE7，遨游中高度超出自己设置高度</h3><p>问题症状：IE6、7和遨游里这个标签的高度不受控制，超出自己设置的高度</p><p>碰到频率：60%</p><p>解决方案：给超出高度的标签设置overflow:hidden;或者设置行高line-height 小于你设置的高度。</p><p>备注：这种情况一般出现在我们设置小圆角背景的标签里。出现这个问题的原因是IE8之前的浏览器都会给标签一个最小默认的行高的高度。即使你的标签是空的，这个标签的高度还是会达到默认的行高。</p><h3 id="四：行内属性标签，设置display-block后采用float布局，又有横行的margin的情况，IE6间距bug"><a href="#四：行内属性标签，设置display-block后采用float布局，又有横行的margin的情况，IE6间距bug" class="headerlink" title="四：行内属性标签，设置display:block后采用float布局，又有横行的margin的情况，IE6间距bug"></a>四：行内属性标签，设置display:block后采用float布局，又有横行的margin的情况，IE6间距bug</h3><p>问题症状：IE6里的间距比超过设置的间距</p><p>碰到几率：20%</p><p>解决方案 ： 在display:block;后面加入display:inline;display:table;</p><p>备注：行内属性标签，为了设置宽高，我们需要设置display:block;(除了input标签比较特殊)。在用float布局并有横向的margin后，在IE6下，他就具有了块属性float后的横向margin的bug。不过因为它本身就是行内属性标签，所以我们再加上display:inline的话，它的高宽就不可设了。这时候我们还需要在display:inline后面加入display:talbe。</p><h3 id="五：图片默认有间距"><a href="#五：图片默认有间距" class="headerlink" title="五：图片默认有间距"></a>五：图片默认有间距</h3><p>问题症状：几个img标签放在一起的时候，有些浏览器会有默认的间距，加了问题一中提到的通配符也不起作用。</p><p>碰到几率：20%</p><p>解决方案：使用float属性为img布局</p><p>备注 ： 因为img标签是行内属性标签，所以只要不超出容器宽度，img标签都会排在一行里，但是部分浏览器的img标签之间会有个间距。去掉这个间距使用float是正道。（我的一个学生使用负margin，虽然能解决，但负margin本身就是容易引起浏览器兼容问题的用法，所以我禁止他们使用）</p><h3 id="六：标签最低高度设置min-height不兼容"><a href="#六：标签最低高度设置min-height不兼容" class="headerlink" title="六：标签最低高度设置min-height不兼容"></a>六：标签最低高度设置min-height不兼容</h3><p>问题症状：因为min-height本身就是一个不兼容的CSS属性，所以设置min-height时不能很好的被各个浏览器兼容</p><p>碰到几率：5%</p><p>解决方案：如果我们要设置一个标签的最小高度200px，需要进行的设置为：{min-height:200px; height:auto !important; height:200px; overflow:visible;}</p><p>备注：在B&#x2F;S系统前端开时，有很多情况下我们又这种需求。当内容小于一个值（如300px）时。容器的高度为300px；当内容高度大于这个值时，容器高度被撑高，而不是出现滚动条。这时候我们就会面临这个兼容性问题。</p><h3 id="七：透明度的兼容CSS设置"><a href="#七：透明度的兼容CSS设置" class="headerlink" title="七：透明度的兼容CSS设置"></a>七：透明度的兼容CSS设置</h3><p>一般在ie中用的是filter:alpha(opacity&#x3D;0);这个属性来设置div或者是块级元素的透明度，而在firefox中，一般就是直接使用opacity:0,对于兼容的，一般的做法就是在书写css样式的将2个都写上就行，就能实现兼容</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> CSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 兼容性 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CSS3</title>
      <link href="/posts/e859d7a7/"/>
      <url>/posts/e859d7a7/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="CSS3"><a href="#CSS3" class="headerlink" title="CSS3"></a>CSS3</h2><h3 id="CSS3新增伪类有那些"><a href="#CSS3新增伪类有那些" class="headerlink" title="CSS3新增伪类有那些?"></a>CSS3新增伪类有那些?</h3><p><a href="https://www.cnblogs.com/L-xmin/p/12386238.html">CSS-伪元素和伪类（思维导图）</a></p><p>p:first-of-type 选择属于其父元素的第一个出现的p<br>p:last-of-type 选择属于其父元素最后一个出现的p</p><p>p:only-of-type 选择属于其父元素唯一的p元素<br>p:only-child 选择属于其父元素的唯一子元素（没有任何兄弟元素的p元素）</p><p>p:nth-child(2) 选择属于其父元素的第二个子元素</p><p>:enabled :disabled 表单控件的禁用状态。<br>:checked 单选框或复选框被选中。</p><h3 id="CSS3新特性"><a href="#CSS3新特性" class="headerlink" title="CSS3新特性"></a>CSS3新特性</h3><p><a href="http://caibaojian.com/css3/">CSS3参考手册属性列表</a>（链接中紫色链接表示该属性在CSS3有修改或者增加了新的属性值；橙色链接表示该属性是CSS3新增属性 ）</p><p>下面列出容易记的几个</p><ol><li>【媒体查询】（@media (min-width:600px)）</li><li>【嵌入web字体】（@font-face）</li><li>【过渡】（transition）与【动画】（animation）</li><li>【阴影】box-shadow</li><li>【边框】创建圆角（border-radius）、边框图片（border-image）</li><li>【背景】背景图片尺寸（background-size）、背景图片定位（background-origin）、背景裁剪（background-clip）、多重背景（background-image:url(1.jpg),url(2.jpg);）</li><li>【文字】允许长单词换行（word-wrap:break-word）、文字阴影（text-shadow）</li><li>【颜色】rgba和透明度opacity</li><li>【渐变】线性渐变（gradient）</li><li>【布局】flex、grid、多栏布局</li><li>【盒模型】box-sizing</li></ol>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> CSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>层叠上下文</title>
      <link href="/posts/203b7907/"/>
      <url>/posts/203b7907/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="层叠上下文的定义"><a href="#层叠上下文的定义" class="headerlink" title="层叠上下文的定义"></a>层叠上下文的定义</h2><p>层叠上下文，是 HTML 中一个三维的概念。在 CSS2.1 规范中，每个盒模型的位置是三维的，分别是平面画布上的 <code>X轴</code>，<code>Y轴</code>以及表示层叠的 <code>Z轴</code>。一般情况下，元素在页面上沿 <code>X轴Y轴</code>平铺，我们察觉不到它们在 <code>Z轴</code>上的层叠关系。而一旦元素发生堆叠，这时就能发现某个元素可能覆盖了另一个元素或者被另一个元素覆盖。</p><h2 id="层叠上下文的形成条件"><a href="#层叠上下文的形成条件" class="headerlink" title="层叠上下文的形成条件"></a>层叠上下文的形成条件</h2><p>文档中的层叠上下文由满足以下任意一个条件的元素形成：</p><ul><li>文档根元素（<code>&lt;html&gt;</code>）；</li><li><code>position</code> 值为 <code>absolute</code>（绝对定位）或 <code>relative</code>（相对定位）且 <code>z-index</code> 值不为 <code>auto</code> 的元素；</li><li><code>position</code> 值为 <code>fixed</code>（固定定位）或 <code>sticky</code>（粘滞定位）的元素；</li><li><code>flex(flex)</code> 容器的子元素，且 <code>z-index</code> 值不为 <code>auto</code>；</li><li><code>grid(grid)</code> 容器的子元素，且 <code>z-index</code> 值不为 <code>auto</code>；</li><li><code>opacity</code> 属性值小于 <code>1</code> 的元素</li><li><code>mix-blend-mode</code> 属性值不为 <code>normal</code> 的元素；</li><li>以下任意属性值不为 <code>none</code> 的元素：<ul><li><code>transform</code></li><li><code>filter</code></li><li><code>backdrop-filter</code></li><li><code>perspective</code></li><li><code>clip-path</code></li><li><code>mask</code> &#x2F; <code>mask-image</code> &#x2F; <code>mask-border</code></li></ul></li><li><code>isolation</code> 属性值为 <code>isolate</code> 的元素；</li><li><code>will-change</code> 值设定了任一属性而该属性在 <code>non-initial</code>值时会创建层叠上下文的元素</li><li><code>contain</code> 属性值为 <code>layout</code>、<code>paint</code> 或包含它们其中之一的合成值（比如 <code>contain: strict</code>、<code>contain: content</code>）的元素</li></ul><h2 id="层叠等级"><a href="#层叠等级" class="headerlink" title="层叠等级"></a>层叠等级</h2><ul><li>在同一个层叠上下文中，描述的是该层叠上下文中的层叠上下文元素在 <code>Z轴</code>上的上下顺序。</li><li>在普通元素中，描述的是这些普通元素在 <code>Z轴</code>上的上下顺序。</li></ul><h2 id="比较层叠等级的方法"><a href="#比较层叠等级的方法" class="headerlink" title="比较层叠等级的方法"></a>比较层叠等级的方法</h2><ol><li>普通元素的层叠等级优先由其所在的层叠上下文决定。</li><li>层叠等级的比较只有在当前层叠上下文元素中才有意义。不同层叠上下文中比较层叠等级是没有意义的。</li></ol><h2 id="层叠顺序"><a href="#层叠顺序" class="headerlink" title="层叠顺序"></a>层叠顺序</h2><p><img src="https://ask.qcloudimg.com/http-save/6552462/9cb5g7jw6l.png?imageView2/2/w/1620"></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> CSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 层叠上下文 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>闭包</title>
      <link href="/posts/f9636392/"/>
      <url>/posts/f9636392/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a><strong>定义</strong></h2><p><strong>一个函数内部的函数</strong>，一个内部函数在包含他们的外部函数之外可以被调用。</p><blockquote><p>即，外部作用域可以访问内部作用域中的变量</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">outter</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> private= <span class="string">&quot;I am private&quot;</span>;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">show</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(private);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> show;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ref = <span class="title function_">outter</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(private); <span class="comment">// 尝试直接访问private会报错：private is not defined</span></span><br><span class="line"><span class="title function_">ref</span>();                <span class="comment">// 打印I am private</span></span><br></pre></td></tr></table></figure><blockquote><p>调用outter函数，产生了一组变量：private和show。<br>最后返回show()，由于ref是show的引用，因此可以在函数体外部调用show，而show又可以访问到private。</p></blockquote><p>最常见的创建方式：一个函数内部创建另一个函数，创建的函数可以访问到当前函数的局部变量。</p><p>闭包的本质：作用域链上的一个特殊的应用。</p><h2 id="闭包生命周期"><a href="#闭包生命周期" class="headerlink" title="闭包生命周期"></a>闭包生命周期</h2><p>（1）产生：在嵌套内部函数定义执行完时就产生了（不是在调用）<br>（2）死亡：在嵌套的内部函数成为垃圾对象时</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fn1</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//此时闭包就已经产生了（函数提升，内部函数对象已经创建了）</span></span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">2</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">fn2</span>(<span class="params"></span>) &#123;</span><br><span class="line">        a++</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(a)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// var fn2 = function () &#123;</span></span><br><span class="line">    <span class="comment">//     a++</span></span><br><span class="line">    <span class="comment">//     console.log(a)</span></span><br><span class="line">    <span class="comment">//&#125; 闭包在此句完成才产生</span></span><br><span class="line">    <span class="keyword">return</span> fn2</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> f = <span class="title function_">fn1</span>() <span class="comment">//执行外部函数 指向fn2，导致fn2不释放</span></span><br><span class="line"><span class="title function_">f</span>() <span class="comment">//3 执行内部函数</span></span><br><span class="line"><span class="title function_">f</span>() <span class="comment">//4 执行内部函数</span></span><br><span class="line">f = <span class="literal">null</span> <span class="comment">// 闭包死亡（包含闭包的函数对象成为垃圾对象）</span></span><br></pre></td></tr></table></figure><h2 id="闭包用途"><a href="#闭包用途" class="headerlink" title="闭包用途"></a><strong>闭包用途</strong></h2><ol><li>使我们在函数外部能够访问到函数内部的变量。通过使用闭包，我们可以通过在外部调用闭包函数，从而在外部访问到函数内部的变量，可以使用这种方法来创建私有变量。</li><li>使已经运行结束的函数上下文中的变量对象继续留在内存中，因为闭包函数保留了这个变量对象的引用，所以这个变量对象不会被回收。</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.将函数作为另一个函数的返回值</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">a</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> n = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">add</span>(<span class="params"></span>) &#123;</span><br><span class="line">        n++;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> add;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a1 = <span class="title function_">a</span>(); <span class="comment">// 注意：函数名只是一个标识（指向函数的指针），而()才是执行函数；</span></span><br><span class="line"><span class="title function_">a1</span>();    <span class="comment">//1</span></span><br><span class="line"><span class="title function_">a1</span>();    <span class="comment">//2  第二次调用n变量还在内存中</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.将函数作为实参传递给另一个函数调用</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showDelay</span>(<span class="params">msg, time</span>) &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">alert</span>(msg)</span><br><span class="line">    &#125;, time)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">showDelay</span>(<span class="string">&#x27;atguigu&#x27;</span>,<span class="number">2000</span>)</span><br></pre></td></tr></table></figure><h2 id="闭包应用"><a href="#闭包应用" class="headerlink" title="闭包应用"></a><strong>闭包应用</strong></h2><p>定义JS模块：具有特定功能的js文件</p><blockquote><p>将所有的数据和功能封装在一个函数内部（私有的）<br>只向外暴露一个包含n个方法的对象或函数<br>模块的使用者，只需要通过模块暴露的对象调用方法来实现对应的功能</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">myModule</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//私有数据</span></span><br><span class="line">    <span class="keyword">var</span> msg = <span class="string">&#x27;My atguigu&#x27;</span></span><br><span class="line">    <span class="comment">//操作数据的函数</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">doSomething</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;doSomething()&#x27;</span> + msg.<span class="property">toUpperCase</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">doOtherting</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;doOtherting()&#x27;</span> + msg.<span class="property">toLowerCase</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//向外暴露对象（给外部使用的方法）</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">doSomething</span>: doSomething,</span><br><span class="line">        <span class="attr">doOtherthing</span>:doOtherting</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="keyword">var</span> <span class="variable language_">module</span> = <span class="title function_">myModule</span>()</span><br><span class="line"><span class="variable language_">module</span>.<span class="title function_">doSomething</span>()</span><br><span class="line"><span class="variable language_">module</span>.<span class="title function_">doOtherthing</span>()</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span>(<span class="params"><span class="variable language_">window</span></span>) &#123;</span><br><span class="line">    <span class="comment">//私有数据</span></span><br><span class="line">    <span class="keyword">var</span> msg = <span class="string">&#x27;My atguigu&#x27;</span></span><br><span class="line">    <span class="comment">//操作数据的函数</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">doSomething</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;doSomething()&#x27;</span> + msg.<span class="property">toUpperCase</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">doOtherting</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;doOtherting()&#x27;</span> + msg.<span class="property">toLowerCase</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//向外暴露对象（给外部使用的方法）    window.myModule = &#123;</span></span><br><span class="line">        <span class="attr">doSomething</span>: doSomething,</span><br><span class="line">        <span class="attr">doOtherthing</span>:doOtherting</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)(<span class="variable language_">window</span>)myModule.<span class="title function_">doSomething</span>()</span><br><span class="line">mymodule.<span class="title function_">doOtherthing</span>()</span><br></pre></td></tr></table></figure><h2 id="闭包优缺点"><a href="#闭包优缺点" class="headerlink" title="闭包优缺点"></a><strong>闭包优缺点</strong></h2><p>闭包的特性</p><ol><li>闭包一般是函数嵌套函数;</li><li>闭包内部函数可以访问外部函数的变量;</li><li>闭包的参数和变量在使用后不会被垃圾回收机</li></ol><p>优点</p><ol><li>变量可长期驻扎在内存中</li><li>保护函数内部的变量的安全性，避免全局变量的污染</li><li>私有成员的存在</li></ol><p>缺点</p><ol><li>由于闭包会使得函数中的变量都被保存在内存中，使得内存消耗很大，是常存内存，会增加内存的使用量，若使用不当，很容易引起内存泄露;</li><li>内存空间浪费对问题，这个内存浪费不仅因为它常驻内存，更重要的是对闭包的使用不当会造成无效内存的产生;</li><li>闭包会在父函数外部，改变父函数内部变量的值，如果把父函数当作对象使用，把闭包当作它的公用方法，把内部变量当作它的私有属性，这时一定不要随便改变父函数内部变量的值，否则会引起严重的问题。</li><li>由于闭包自己的局部活动对象和依赖到的活动对象都会被包含在它自身的作用域链里面，所以它的体量往往是比普通函数大很多，性能消耗大:</li></ol><ul><li>常见的内存泄露<ul><li>意外的全局变量</li><li>没有及时清理的计时器或回调函数</li><li>脱离DOM的引用</li><li>闭包</li></ul></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//意外的全局变量</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn1</span>(<span class="params"></span>) &#123;</span><br><span class="line">  a = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//没有及时清理的计时器或回调函数</span></span><br><span class="line"><span class="keyword">var</span> intervalId = <span class="built_in">setInterval</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123; <span class="comment">//启动循环定时器后不清理</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;------&#x27;</span>)</span><br><span class="line">&#125;,<span class="number">1000</span>)</span><br><span class="line"><span class="comment">//clearInterval(intervalId)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//闭包</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn1</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">fn2</span>(<span class="params"></span>) &#123;</span><br><span class="line">        a++</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(a)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> fn2</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> f = <span class="title function_">fn1</span>()</span><br><span class="line"><span class="title function_">f</span>()</span><br><span class="line"><span class="comment">//f = null</span></span><br></pre></td></tr></table></figure><p>解决问题</p><ul><li>能不用闭包就不用</li><li>及时释放</li></ul><h2 id="闭包-立即执行函数的应用：封装（信息隐藏）"><a href="#闭包-立即执行函数的应用：封装（信息隐藏）" class="headerlink" title="闭包 + 立即执行函数的应用：封装（信息隐藏）"></a>闭包 + 立即执行函数的应用：封装（信息隐藏）</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = (<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> name = ‘<span class="title class_">John</span>’;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="title function_">getName</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> name;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)();</span><br><span class="line"><span class="comment">// 只能通过getName方法访问</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="title function_">getName</span>());<span class="comment">// John</span></span><br><span class="line"><span class="comment">// 无法直接访问obj.name</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">name</span>);<span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 函数式编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 闭包 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>作用域链</title>
      <link href="/posts/de6d0944/"/>
      <url>/posts/de6d0944/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="作用域链"><a href="#作用域链" class="headerlink" title="作用域链"></a>作用域链</h3><ul><li>多个上下级关系的作用域形成的链，它的方向是从下向上的(从内到外)，查找变量时就是沿着作用域链来查找的。</li><li>函数内部可以访问外部数据，从而形成了作用域链，但是外部没办法访问函数内部的数据</li><li>以<strong>链式查找方式</strong>取值</li></ul><p>查找规则：</p><ol><li>在当前作用域下的执行上下文中查找对应的属性，如果有直接返回，否则进入2</li><li>在上一级作用域的执行上下文中查找对应的属性，如果有直接返回，否则进入3</li><li>再次执行2的相同操作，直到全局作用域，如果还找不到就抛出找不到的ReferenceError异常</li></ol><blockquote><p>作用域链的本质：指向变量对象的指针列表。</p><p>变量对象：包含执行环境中所有变量和函数的对象</p><p>作用域链的前端：始终都是当前执行上下文的变量对象。</p><p>全局执行上下文的变量对象（也就是全局对象）：始终是作用域链的最后一个对象。</p></blockquote><p>详细资料可以参考：</p><p><a href="https://link.juejin.cn/?target=http://cavszhouyou.top/JavaScript%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E4%B9%8B%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%93%BE.html" title="http://cavszhouyou.top/JavaScript%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E4%B9%8B%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%93%BE.html">《JavaScript 深入理解之作用域链》</a></p><p><a href="https://juejin.cn/post/6844904126216830984" title="https://juejin.cn/post/6844904126216830984">「前端料包」深究JavaScript作用域（链）知识点和闭包</a></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 函数式编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 作用域链 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>执行上下文栈</title>
      <link href="/posts/dec4cd8f/"/>
      <url>/posts/dec4cd8f/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>（1）在全局代码执行前，JS引擎就会创建一个栈来存储管理所有的执行上下文对象<br>（2）在全局执行上下文（window）确定后，将其添加到栈中（压栈）<br>（3）在函数执行上下文创建后，将其添加到栈中（压栈）<br>（4）在当前函数执行完后，将栈顶的对象移除（出栈）<br>（5）当所有的代码执行完后，栈中只剩下window</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 函数式编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 执行上下文 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>执行上下文</title>
      <link href="/posts/18bcf77b/"/>
      <url>/posts/18bcf77b/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="代码分类（位置）"><a href="#代码分类（位置）" class="headerlink" title="代码分类（位置）"></a>代码分类（位置）</h3><ul><li>全局代码</li><li>函数（局部）代码</li></ul><h3 id="全局执行上下文"><a href="#全局执行上下文" class="headerlink" title="全局执行上下文"></a>全局执行上下文</h3><p>在执行全局代码前将window确定为全局执行上下文<br>对全局数据进行预处理<br>var定义的全局变量 &#x3D;&#x3D;&gt;underfined，添加为window的属性<br>function声明的全局函数 &#x3D;&#x3D;&gt; 赋值（fun），添加为window的方法<br>this &#x3D;&#x3D;&gt; 赋值（window）</p><h3 id="函数执行上下文"><a href="#函数执行上下文" class="headerlink" title="函数执行上下文"></a>函数执行上下文</h3><p>在调用函数，准备执行函数体之前，创建对应的函数执行上下文对象<br>对局部数据进行预处理<br>形参变量 &gt; 赋值（实参）&gt; 添加为执行上下文的属性<br>argument &#x3D;&#x3D;&gt;赋值（实参列表），添加为执行上下文的属性<br>var定义的局部变量 &#x3D;&#x3D;&gt; undefined，添加为执行上下文的属性<br>function声明的函数 &#x3D;&#x3D;&gt;赋值（fun），添加为执行上下文的方法<br>this &#x3D;&#x3D;&gt; 赋值（调用函数的对象）<br>开始执行函数体代码</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 函数式编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 执行上下文 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>原型链</title>
      <link href="/posts/bf8cf30/"/>
      <url>/posts/bf8cf30/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="原型链"><a href="#原型链" class="headerlink" title="原型链"></a>原型链</h2><p>原型链:自定义构造函数</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">  <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">name</span> =<span class="string">&#x27;john&#x27;</span>; </span><br><span class="line">  <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">age</span>=<span class="number">23</span>;</span><br><span class="line">  <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayName</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">name</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> p1=<span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line"><span class="keyword">const</span> p2=<span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">p1.<span class="title function_">sayName</span>(); <span class="comment">// &#x27;john&#x27;</span></span><br><span class="line">p2.<span class="title function_">sayName</span>(); <span class="comment">// &#x27;john&#x27;</span></span><br><span class="line"><span class="title function_">alert</span>(p1.<span class="property">sayName</span>===p2.<span class="property">sayName</span>); <span class="comment">// true</span></span><br><span class="line"><span class="title function_">alert</span>(p1.<span class="property">sayName</span> === <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayName</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p><img src="/image/%E5%8E%9F%E5%9E%8B%E9%93%BE/1663856245905.png" alt="1663856245905"><br><img src="/image/%E5%8E%9F%E5%9E%8B%E9%93%BE/1663856269997.png" alt="1663856269997"></p><ul><li>访问一个对象的属性值<ul><li>先在自身属性中查找，找到返回</li><li>如果没有，再沿着 _ _ proto _ _ 这条链向上查找，找到返回</li><li>如果最终没找到，返回underfined</li></ul></li><li>别名：隐式原型链</li><li>作用：查找对象的属性（方法）</li></ul><h3 id="构造函数-x2F-原型实例对象的关系"><a href="#构造函数-x2F-原型实例对象的关系" class="headerlink" title="构造函数&#x2F;原型实例对象的关系"></a>构造函数&#x2F;原型实例对象的关系</h3><p><img src="https://img-blog.csdnimg.cn/ddd25448c2a74557aa9e4a62377ac0fa.png" alt="在这里插入图片描述"></p><h3 id="构造函数-x2F-原型实例对象的关系-1"><a href="#构造函数-x2F-原型实例对象的关系-1" class="headerlink" title="构造函数&#x2F;原型实例对象的关系"></a>构造函数&#x2F;原型实例对象的关系</h3><p><img src="https://img-blog.csdnimg.cn/42db4263f2634325b0f331f49a8b17c1.png" alt="在这里插入图片描述"></p><h3 id="相关问题"><a href="#相关问题" class="headerlink" title="相关问题"></a>相关问题</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.函数的显示原型指向的对象默认时空Object实例对象（但Object不满足）</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Fn</span>.<span class="property"><span class="keyword">prototype</span></span> <span class="keyword">instanceof</span> <span class="title class_">Object</span>) <span class="comment">//true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span> <span class="keyword">instanceof</span> <span class="title class_">Object</span>) <span class="comment">// false</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span> <span class="keyword">instanceof</span> <span class="title class_">Object</span>) <span class="comment">// true</span></span><br><span class="line"><span class="comment">//2.所有函数都是Function的实例（包含Function）</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Function</span>.<span class="property">__protp__</span> === <span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>) <span class="comment">// true</span></span><br><span class="line"><span class="comment">//3.Object的原型对象是原型链尽头</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">__proto__</span>) <span class="comment">//null</span></span><br></pre></td></tr></table></figure><h2 id="原型链属性问题"><a href="#原型链属性问题" class="headerlink" title="原型链属性问题"></a>原型链属性问题</h2><ol><li>读取对象的属性值时：会自动到原型链中查找</li><li>设置对象的属性值时：不会查找原型链，如果当前对象中没有此属性，直接添加此属性并设置其值</li><li>方法一般定义在原型中，属性一般通过构造函数定义在对象本身上</li></ol><h2 id="操作对象属性"><a href="#操作对象属性" class="headerlink" title="操作对象属性"></a>操作对象属性</h2><h3 id="查询属性"><a href="#查询属性" class="headerlink" title="查询属性"></a>查询属性</h3><p>查询属性会沿着对象的原型链一级一级往上查询，直到找到目标属性或者原型是null的对象为止。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>) &#123;&#125; </span><br><span class="line">  <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span> =&#123; </span><br><span class="line">    <span class="attr">name</span>:<span class="string">&#x27;John&#x27;</span>, </span><br><span class="line">    <span class="attr">age</span>: <span class="number">23</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> p1 =<span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">p1.<span class="property">from</span> =<span class="string">&#x27;china&#x27;</span></span><br><span class="line"><span class="title function_">alert</span>(p1.<span class="property">age</span>);</span><br><span class="line"><span class="title function_">alert</span>(p1.<span class="property">from</span>);</span><br><span class="line"><span class="title function_">alert</span>(p1.<span class="property">toString</span>);</span><br></pre></td></tr></table></figure><h3 id="添加属性"><a href="#添加属性" class="headerlink" title="添加属性"></a>添加属性</h3><p>首先检测对象是否允许添加属性，如果允许，则在原始对象上创建属性或者更改已有的属性。添加属性操作不会修改原型链。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">  <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span> = &#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&#x27;John&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>:<span class="number">23</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> p1 =<span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">p1.<span class="property">from</span> =<span class="string">&#x27;China&#x27;</span>;<span class="comment">// 只在p1上面添加了from属性</span></span><br><span class="line"><span class="comment">// 不会修改Person.prototype</span></span><br></pre></td></tr></table></figure><h4 id="添加属性：只读属性"><a href="#添加属性：只读属性" class="headerlink" title="添加属性：只读属性"></a>添加属性：只读属性</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &#x27;use strict&#x27;;</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">  <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span> =&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;John&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>:<span class="number">23</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(<span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>, <span class="string">&#x27;from&#x27;</span>,&#123;</span><br><span class="line">  <span class="attr">writable</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">value</span>:<span class="string">&#x27;China&#x27;</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">p1.<span class="property">from</span> =<span class="string">&#x27;America&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p1.<span class="property">from</span>);<span class="comment">// &#x27;China&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="添加属性：属性在原型上已存在"><a href="#添加属性：属性在原型上已存在" class="headerlink" title="添加属性：属性在原型上已存在"></a>添加属性：属性在原型上已存在</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">  <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span> =<span class="number">1</span>&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;John&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>:<span class="number">23</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line"><span class="keyword">const</span> p2 =<span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">p1.<span class="property">name</span> =<span class="string">&#x27;Hunt&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p1.<span class="property">name</span>); <span class="comment">// &#x27;Hunt&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p2.<span class="property">name</span>); <span class="comment">// &#x27;John&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="添加属性：setter"><a href="#添加属性：setter" class="headerlink" title="添加属性：setter"></a>添加属性：setter</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span> =&#123;</span><br><span class="line">  <span class="attr">firstName</span>: <span class="string">&#x27;John&#x27;</span>,</span><br><span class="line">  <span class="attr">lastName</span>:<span class="string">&#x27;Smith&#x27;</span>,</span><br><span class="line">  <span class="keyword">set</span> <span class="title function_">fullName</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> names = value.<span class="title function_">split</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">firstName</span> =names[<span class="number">0</span>];</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">lastName</span> =names[<span class="number">1</span>];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> p1 =<span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">p1.<span class="property">fullName</span> = <span class="string">&#x27;Nicholas Cage&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p1.<span class="property">firstName</span>); <span class="comment">// &#x27;Nicholas&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="删除属性"><a href="#删除属性" class="headerlink" title="删除属性"></a>删除属性</h3><p>delete运算符只能删除对象的自身属性，不能删除从原型继承而来的属性。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">  <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span> = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;John&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>:<span class="number">23</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> p1 =<span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">p1.<span class="property">fullName</span> = <span class="string">&#x27;John Smith&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p1.<span class="property">name</span>,p1.<span class="property">fullName</span>); <span class="comment">// &#x27;John&#x27; &#x27;John Smith&#x27; delete p1.name;</span></span><br><span class="line"><span class="keyword">delete</span> p1.<span class="property">fullName</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p1.<span class="property">name</span>, p1.<span class="property">fullName</span>);<span class="comment">// &#x27;John&#x27; undefined</span></span><br></pre></td></tr></table></figure><h3 id="检测属性"><a href="#检测属性" class="headerlink" title="检测属性"></a>检测属性</h3><p>可以通过in hasOwnPropertypropertyIsEnumerable等方法来检测属性是否存在。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> o = &#123;<span class="attr">x</span>: <span class="number">1</span>&#125;;</span><br><span class="line"><span class="title function_">alert</span>(<span class="string">&#x27;x&#x27;</span> <span class="keyword">in</span> o); <span class="comment">// true</span></span><br><span class="line"><span class="title function_">alert</span>(<span class="string">&#x27;y&#x27;</span> <span class="keyword">in</span> o); <span class="comment">// false</span></span><br><span class="line"><span class="title function_">alert</span>(<span class="string">&#x27;toString&#x27;</span> <span class="keyword">in</span> o); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> o = &#123;<span class="attr">x</span>: <span class="number">1</span>&#125;;</span><br><span class="line"><span class="title function_">alert</span>(o.<span class="title function_">hasOwnProperty</span>(<span class="string">&#x27;x&#x27;</span>)); <span class="comment">// true</span></span><br><span class="line"><span class="title function_">alert</span>(o.<span class="title function_">hasOwnProperty</span>(<span class="string">&#x27;y&#x27;</span>)); <span class="comment">// false</span></span><br><span class="line"><span class="title function_">alert</span>(o.<span class="title function_">hasOwnProperty</span>(<span class="string">&#x27;toString&#x27;</span>)); <span class="comment">// false</span></span><br></pre></td></tr></table></figure><h4 id="检测属性-propertyIsEnumerable"><a href="#检测属性-propertyIsEnumerable" class="headerlink" title="检测属性:propertyIsEnumerable"></a>检测属性:propertyIsEnumerable</h4><p>是hasOwnProperty的增强版，是自身属性并且是可枚举时才返回true</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> o = &#123;<span class="attr">x</span>: <span class="number">1</span>&#125;;</span><br><span class="line"><span class="title function_">alert</span>(o.<span class="title function_">propertyIsEnumerable</span>(<span class="string">&#x27;x&#x27;</span>)); <span class="comment">// true</span></span><br><span class="line"><span class="title function_">alert</span>(o.<span class="title function_">propertyIsEnumerable</span>(<span class="string">&#x27;y&#x27;</span>)); <span class="comment">// false</span></span><br><span class="line"><span class="title function_">alert</span>(<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">propertyIsEnumerable</span>(<span class="string">&#x27;toString&#x27;</span>)); <span class="comment">// false</span></span><br></pre></td></tr></table></figure><h4 id="检测属性-一个不易觉察的坑"><a href="#检测属性-一个不易觉察的坑" class="headerlink" title="检测属性:一个不易觉察的坑"></a>检测属性:一个不易觉察的坑</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> o = &#123;<span class="attr">x</span>: <span class="number">1</span>&#125;;</span><br><span class="line"><span class="keyword">if</span> (o.<span class="property">x</span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="literal">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> o = &#123;<span class="attr">x</span>: <span class="number">1</span>&#125;;</span><br><span class="line"><span class="keyword">if</span> (o.<span class="property">x</span> !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="literal">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="枚举属性"><a href="#枚举属性" class="headerlink" title="枚举属性"></a>枚举属性</h3><p>可以使用for&#x2F;in、Object.keys、Object.getOwnPropertyNames来枚举对象的属性。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">  <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span> = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;John&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>:<span class="number">23</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> p1=<span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">p1.<span class="property">fullName</span> = <span class="string">&#x27;John Smith&#x27;</span>;</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(p1, <span class="string">&#x27;from&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">value</span>:<span class="string">&#x27;china&#x27;</span>,</span><br><span class="line">  <span class="attr">enumerable</span>: <span class="literal">false</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> p <span class="keyword">in</span> p1) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(p);<span class="comment">// &#x27;fullName&#x27;, &#x27;name&#x27;, &#x27;age&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">keys</span>(p1)); <span class="comment">// [&quot;fullName&quot;] </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">getOwnPropertyNames</span>(p1));<span class="comment">// [&quot;fullName&quot;,&quot;from&quot;]</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 函数式编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 原型链 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>样式与选择器</title>
      <link href="/posts/3158911a/"/>
      <url>/posts/3158911a/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>css样式声明（定义）由两部分组成，形式如下：<br><code>选择器&#123; 样式；&#125;</code><br>“选择器”指明了{}中的“样式”的作用对象，也就是“样式”作用于网页中的哪些元素。</p><h3 id="基本选择器"><a href="#基本选择器" class="headerlink" title="基本选择器"></a>基本选择器</h3><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">标签</button></li><li class="tab"><button type="button" data-href="#super-2">属性选择</button></li><li class="tab"><button type="button" data-href="#super-3">类（.class）</button></li><li class="tab"><button type="button" data-href="#super-4">ID（#id）</button></li><li class="tab"><button type="button" data-href="#super-5">分级（单个）</button></li><li class="tab"><button type="button" data-href="#super-6">组合（多个）</button></li><li class="tab"><button type="button" data-href="#super-7">伪类</button></li><li class="tab"><button type="button" data-href="#super-8">伪元素</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>对应html代码中的标签。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>[att~&#x3D;val]<br>代表一个有att属性且值是一个由空格字符间隔的单词列表，其中之一恰好是“val”的元素。例如：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[class~=<span class="string">&#x27;title&#x27;</span>]</span> &#123;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;article title&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span> // 选择这个</span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;article content&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure><p>[att^&#x3D;val]<br>选择att属性的值以val开头（包括val）的元素。例如：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[class|=<span class="string">&#x27;CN&#x27;</span>]</span> &#123;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;CN-title&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span> // 选择这个</span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;EN-title&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure><p>[att$&#x3D;val]<br>选择att属性的值以val结尾（包括val）的元素。例如：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[class$=<span class="string">&#x27;special&#x27;</span>]</span> &#123;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;article test-special&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span> // 选择这个</span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;article normal&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>允许以一种独立于文档元素的方式来指定样式。<br>同一个类选择器可以指定给不同的多个元素。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>使用元素 id 作为标示来指定样式。<br>ID 选择器前面有一个 # 号。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p>以空格分隔，只作用在一个选择器上。<br>只作用a的class-p1的选择器上</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="comment">/* 类选择器a中的 类选择器class-p1*/</span></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.a</span> <span class="selector-class">.class-p1</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: orange;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;a&quot;</span>&gt;</span></span><br><span class="line">    滚开</span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;p1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;class-p1&quot;</span>&gt;</span></span><br><span class="line">    我是谁？</span><br><span class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-6"><p>以逗号进行分隔，作用在多个选择器上。<br><code>.class-p1, .class-p2{ color: orange; }</code></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-7"><p>伪类：存在 <code>DOM</code>文档中，逻辑上存在，但在 <code>DOM</code>文档树中无需标识。</p><p><img src="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200414223219420-1210069826.png" alt="img"></p><p>用于向某些选择器添加特殊的效果。</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">链接伪类</button></li><li class="tab"><button type="button" data-href="#super-2">结构伪类</button></li><li class="tab"><button type="button" data-href="#super-3">UI元素状态伪类</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><code>&lt;a&gt;&lt;/a&gt;</code>此标签的伪类选择器有顺序，顺序具体如下：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">a</span><span class="selector-pseudo">:link</span> &#123;<span class="attribute">color</span>: <span class="number">#FF0000</span>&#125;        <span class="comment">/* 未访问的链接 */</span></span><br><span class="line"><span class="selector-tag">a</span><span class="selector-pseudo">:visited</span> &#123;<span class="attribute">color</span>: <span class="number">#00FF00</span>&#125;    <span class="comment">/* 已访问的链接 */</span></span><br><span class="line"><span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;<span class="attribute">color</span>: <span class="number">#FF00FF</span>&#125;    <span class="comment">/* 鼠标移动到链接上移入效果 */</span></span><br><span class="line"><span class="selector-tag">a</span><span class="selector-pseudo">:active</span> &#123;<span class="attribute">color</span>: <span class="number">#0000FF</span>&#125;    <span class="comment">/* 用户点击链接后的效果 */</span></span><br></pre></td></tr></table></figure><p>可以简洁记忆：l v h a 记住四个属性的首字母即可。<br>注意：如果不按顺序编写此伪类标签无效。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><table><thead><tr><th align="center">结构伪类选择器</th><th>功能描述</th></tr></thead><tbody><tr><td align="center">E:first-child</td><td>选择所有元素，且E元素是其父元素中第一个</td></tr><tr><td align="center">E:last-child</td><td>选择所有元素，且E元素是其父元素中最后一个</td></tr><tr><td align="center">E:root</td><td>选择E元素所在文档的根元素。HTML中，根元素始终是html</td></tr><tr><td align="center">E F:nth-child(n)</td><td>选择父元素E的第n个子元素F。<br />n可以是整数(1，2，3)、关键字(even，odd)，n值起始值为1，而不是0</td></tr><tr><td align="center">E F:nth-last-child(n)</td><td>选择父元素E的倒数第n个子元素F</td></tr><tr><td align="center">E:nth-of-type(n)</td><td>选择所有在父元素内的第n个E元素</td></tr><tr><td align="center">E:nth-last-of-type(n)</td><td>选择所有在父元素内的倒数第n个E元素</td></tr><tr><td align="center">E:first-of-type</td><td>选择所有在父元素内具有指定类型的第一个E元素，与E:nth-of-type(1)等同</td></tr><tr><td align="center">E:last-of-type</td><td>选择所有在父元素内具有指定类型的最后一个E元素，与E:nth-last-of-type(1)等同</td></tr><tr><td align="center">E:only-child</td><td>选择元素，且E元素是父元素的唯一子元素，没有别的元素</td></tr><tr><td align="center">E:only-of-type</td><td>选择元素，且E元素是父元素中唯一类型的子元素。即多个子元素都是E元素</td></tr><tr><td align="center">E:empty</td><td>选择没有子元素的E元素，而且E元素也不包含任何文本节点</td></tr><tr><td align="center">E:before</td><td>选择E元素，在E元素之前插入内容</td></tr><tr><td align="center">E:after</td><td>选择E元素，在E元素之后插入内容</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><table><thead><tr><th align="center">UI元素状态伪类选择器</th><th>功能描述</th></tr></thead><tbody><tr><td align="center">E:checked</td><td>选择所有选中的表单元素。例如复选框、单选框</td></tr><tr><td align="center">E:enabled</td><td>匹配所有启用的表单元素</td></tr><tr><td align="center">E:disabled</td><td>匹配所有禁用的表单元素</td></tr><tr><td align="center">E:focus</td><td>匹配所有获得光标焦点时的表单元素</td></tr><tr><td align="center">E:read-write</td><td>选择处于非只读状态的E元素</td></tr><tr><td align="center">E:read-only</td><td>匹配处于只读状态的E元素</td></tr><tr><td align="center">E:valid</td><td>匹配E元素诸如required、pattern等属性所指定的检查或元素内容符合元素的规定格式时的样式</td></tr><tr><td align="center">E:invalid</td><td>匹配E元素诸如required、pattern等属性所指定的检查或元素内容不符合元素的规定格式时的样式</td></tr><tr><td align="center">E:required</td><td>选择允许使用required属性并已使用该属性的input、select和textarea元素</td></tr><tr><td align="center">E:optional</td><td>选择允许使用required属性但未使用该属性的input、select以及textarea元素</td></tr><tr><td align="center">E::selection</td><td>选择被用户选取的E元素部分。使用两个冒号:: 是伪元素</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-8"><p>伪元素可以创建一些文档语言无法创建的虚拟元素。</p><ul><li><code>::before</code> 在某个元素之前插入一些内容</li><li><code>::after</code> 在某个元素之后插入一些内容<ul><li>需要配合 <code>content: &#39;&#39;</code>使用</li></ul></li><li><code>::first-line</code> 为某个元素的第一行文字使用样式</li><li><code>::first-letter</code> 为某个元素中的文字的首字母或字使用样式</li><li><code>::selection</code> 用于被用户选中的内容<br><a href="https://img2020.cnblogs.com/blog/1019981/202003/1019981-20200330192148472-787117900.png"><img src="https://img2020.cnblogs.com/blog/1019981/202003/1019981-20200330192148472-787117900.png" alt="img"></a></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="通配符选择器（-）"><a href="#通配符选择器（-）" class="headerlink" title="通配符选择器（*）"></a>通配符选择器（*）</h3><p>CSS2 引入了一种新的简单选择器 - 通配选择器，显示为一个星号（*）。该选择器可以与任何元素匹配，就像是一个通配符。<br><code>* &#123; color: red; &#125;</code>：可以使文档中的每个元素都为红色</p><h3 id="层次选择器"><a href="#层次选择器" class="headerlink" title="层次选择器"></a>层次选择器</h3><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">后代选择器（A B）</button></li><li class="tab"><button type="button" data-href="#super-2">子代选择器（A > B）</button></li><li class="tab"><button type="button" data-href="#super-3">相邻兄弟选择器（A + B）</button></li><li class="tab"><button type="button" data-href="#super-4">通用兄弟选择器（A ~ B）</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>可以定义后代选择器来创建一些规则，使这些规则在某些文档结构中起作用，而在另外一些结构中不起作用。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>与后代选择器相比，子元素选择器只能选择作为某元素子元素的元素。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><table><thead><tr><th align="center">层次选择器</th><th align="center">类型</th><th>功能描述</th></tr></thead><tbody><tr><td align="center">A B</td><td align="center">后代选择器</td><td>B元素被包含A元素内，是其子&#x2F;孙级元素</td></tr><tr><td align="center">A &gt; B</td><td align="center">子代选择器</td><td>B元素被包含A元素内，是其子级元素</td></tr><tr><td align="center">A + B</td><td align="center">相邻兄弟选择器</td><td>B元素与A元素同级，并紧随其后</td></tr><tr><td align="center">A ~ B</td><td align="center">通用兄弟选择器</td><td>B元素与A元素同级，是其身后任一个</td></tr></tbody></table><h3 id="样式优先级"><a href="#样式优先级" class="headerlink" title="样式优先级"></a>样式优先级</h3><p>内联样式 &gt;  css选择器样式 &gt; link 引入的样式</p><h3 id="选择器优先级"><a href="#选择器优先级" class="headerlink" title="选择器优先级"></a>选择器优先级</h3><p>作用：浏览器根据优先级来决定给元素应用哪个样式。</p><p>!important &gt; 行内（内联） &gt; id 选择器 &gt; 类选择器 &#x3D; 属性选择器 &#x3D; 伪类选择器 &gt; 标签选择器 &gt; 通配符选择器 &gt; 继承样式</p><p><a href="https://gitee.com/souyunku/NewDevBooks/blob/master/jump/super-jump/word?word=%E7%AE%97%E6%B3%95">权重算法</a>：</p><p>（0，0，0，0）&#x3D;&#x3D;&gt;</p><blockquote><p>第一个 0 对应的是 <code>!important</code> 的个数<br>第二个 0 对应的是 <code>id</code> 选择器的个数<br>第三个 0 对应的类选择器的个数<br>第四个 0 对应的是标签选择器的个数<br>这就是当前选择器的权重。</p></blockquote><p>比较：<br>先从第一个 0 开始比较，如果第一个 0 大，那么说明这个选择器的权重高，如果第一个相同，比较第二个，依次类推</p><ul><li><code>!important</code>声明的样式优先级最高，如果冲突再进行计算</li><li>虽然 <code>!important</code>无敌和 <code>style</code>一人之下，但都应尽量避免使用</li><li>如果优先级相同，则选择最后出现的样式</li><li>继承得到的样式的优先级最低</li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> CSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 样式/选择器 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="移动端特效"><a href="#移动端特效" class="headerlink" title="移动端特效"></a>移动端特效</h2><p><a href="https://link.juejin.cn/?target=https://www.bilibili.com/video/BV1Sy4y1C7ha?p=331" title="https://www.bilibili.com/video/BV1Sy4y1C7ha?p=331">www.bilibili.com/video/BV1Sy…</a></p><h3 id="触屏事件"><a href="#触屏事件" class="headerlink" title="触屏事件"></a>触屏事件</h3><p>移动端浏览器兼容性较好，不需要考虑JS的兼容性问题，可放心食用原生js</p><p>移动端也独特的地方，比如：<strong>触屏事件touch（触屏事件）</strong> ，Android和IOS都有</p><p> <strong>touch对象代表一个触摸点</strong> 。触摸点可能是手指，也可能是触摸笔。触屏事件可响应用户对屏幕或触控板的操作</p><p>常见的触屏事件：</p><table><thead><tr><th>触屏touch事件</th><th>说明</th></tr></thead><tbody><tr><td>touchstart</td><td>触摸到DOM元素时触发</td></tr><tr><td>touchmove</td><td>在DOM元素上滑动时触发</td></tr><tr><td>touchend</td><td>在DOM元素上移开时触发</td></tr></tbody></table>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>本地存储</title>
      <link href="/posts/5cb41814/"/>
      <url>/posts/5cb41814/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="本地存储"><a href="#本地存储" class="headerlink" title="本地存储"></a>本地存储</h2><h3 id="本地存储特性"><a href="#本地存储特性" class="headerlink" title="本地存储特性"></a>本地存储特性</h3><p>特性：</p><ul><li>数据存储在用户浏览器中</li><li>设置、读取方便、页面刷新不会丢失数据</li><li>容量较大，sessionStorage约5M、localStorage约20M</li><li>只能存储字符串，可以将对象JSON.stringify()编码后存储</li></ul><h3 id="sessionStorage"><a href="#sessionStorage" class="headerlink" title="sessionStorage"></a>sessionStorage</h3><p>sessionStorage：</p><ul><li>生命周期为关闭浏览器窗口（关闭浏览器窗口消失）</li><li>在同一个窗口（页面）下数据可共享</li><li>以键值对的形式存储使用</li></ul><p>存储数据：<code>sessionStorage.setItem(key, value)</code></p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">set.add<span class="constructor">EventListener(&#x27;<span class="params">click</span>&#x27;, <span class="params">function</span> ()</span> &#123;</span><br><span class="line">    var <span class="keyword">val</span> = inputBox.value</span><br><span class="line">    sessionStorage.set<span class="constructor">Item(&#x27;<span class="params">userName</span>&#x27;, <span class="params">val</span>)</span></span><br><span class="line">    sessionStorage.set<span class="constructor">Item(&#x27;<span class="params">password</span>&#x27;, <span class="params">val</span>)</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>获取数据：<code>sessionStorage.getItem(key)</code></p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">get.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(sessionStorage.getItem(<span class="string">&#x27;userName&#x27;</span>));</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>删除数据：<code>sessionStorage.removeItem(key)</code></p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">remove</span>.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span></span> &#123;</span><br><span class="line">    sessionStorage.removeItem(<span class="string">&#x27;userName&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>删除所有数据：<code>sessionStorage.clear()</code></p><figure class="highlight scilab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">del.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> &#123;</span></span><br><span class="line">    sessionStorage.<span class="keyword">clear</span>()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="localStorage"><a href="#localStorage" class="headerlink" title="localStorage"></a>localStorage</h3><p>localStorage：</p><ul><li>生命周期永久生效，除非手动删除，否则关闭页面也会存在</li><li>可以多窗口（页面）共享（同一浏览器）</li></ul><p>存储数据：<code>localStorage.setItem(key, value)</code></p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">set.add<span class="constructor">EventListener(&#x27;<span class="params">click</span>&#x27;, <span class="params">function</span> ()</span> &#123;</span><br><span class="line">    var <span class="keyword">val</span> = inputBox.value</span><br><span class="line">    localStorage.set<span class="constructor">Item(&#x27;<span class="params">userName</span>&#x27;, <span class="params">val</span>)</span></span><br><span class="line">    localStorage.set<span class="constructor">Item(&#x27;<span class="params">password</span>&#x27;, <span class="params">val</span>)</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>获取数据：<code>localStorage.getItem(key)</code></p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">get.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(localStorage.getItem(<span class="string">&#x27;userName&#x27;</span>));</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>删除数据：<code>localStorage.removeItem(key)</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">remove.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">localStorage</span>.<span class="title function_">removeItem</span>(<span class="string">&#x27;userName&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>删除所有数据：<code>localStorage.clear()</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">del.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">localStorage</span>.<span class="title function_">clear</span>()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>PC端网页特效</title>
      <link href="/posts/b70e4979/"/>
      <url>/posts/b70e4979/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="元素偏移量-offset系列"><a href="#元素偏移量-offset系列" class="headerlink" title="元素偏移量 offset系列"></a>元素偏移量 offset系列</h3><p>offset：偏移量，使用offset系列相关属性可动态的得到该元素的位置（偏移量）、大小等</p><ul><li>获得元素距离带有定位的父元素的位置</li><li>获得元素自身的大小（宽高）</li><li>注意：但会的数值都不带单位</li></ul><h4 id="offset系列常用属性"><a href="#offset系列常用属性" class="headerlink" title="offset系列常用属性"></a>offset系列常用属性</h4><table><thead><tr><th>offset系列属性</th><th>说明</th></tr></thead><tbody><tr><td>element.offsetParent</td><td>返回该元素带有定位的父元素，如果父元素没有定位，则返回body</td></tr><tr><td>element.offsetTop</td><td>返回元素相对带有定位的父元素上方的偏移</td></tr><tr><td>element.offsetLeft</td><td>返回元素相对带有定位的父元素左边框的偏移量</td></tr><tr><td>element.offsetWidth</td><td>返回自身包括padding、边框、内容的宽度，返回数值不带单位</td></tr><tr><td>element.offsetHeight</td><td>返回自身包括padding、边框、内容的高度，返回数值不带单位</td></tr></tbody></table><h4 id="offsetLeft-、offsetTop"><a href="#offsetLeft-、offsetTop" class="headerlink" title="offsetLeft 、offsetTop"></a>offsetLeft 、offsetTop</h4><p><a href="https://link.juejin.cn/?target=https://www.bilibili.com/video/BV1Sy4y1C7ha?p=288" title="https://www.bilibili.com/video/BV1Sy4y1C7ha?p=288">www.bilibili.com/video/BV1Sy…</a></p><p>offsetLeft 、offsetTop返回元素相对于带有定位的父元素上方&#x2F;左边的偏移，如果父级没有定位，则以body为准距离上方&#x2F;左方的距离是多少</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    * &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.father</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: red;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin-left</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.son</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: <span class="built_in">rgb</span>(<span class="number">51</span>, <span class="number">61</span>, <span class="number">197</span>);</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin-left</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;father&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;son&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> father = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.father&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> son = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.son&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(father.<span class="property">offsetTop</span>); <span class="comment">// 0</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(father.<span class="property">offsetLeft</span>); <span class="comment">// 100 因为father  margin-left: 100px; 距离左侧100的距离</span></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 如果父级没有加定位 是 0 110 ，加了定位是 0 10</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(son.<span class="property">offsetTop</span>); </span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(son.<span class="property">offsetLeft</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h4 id="offsetWidth、offsetHeight"><a href="#offsetWidth、offsetHeight" class="headerlink" title="offsetWidth、offsetHeight"></a>offsetWidth、offsetHeight</h4><p>offsetWidth、offsetHeight 返回自身包括padding、边框、内容的宽度&#x2F;高度，返回数值不带单位</p><p>当盒子没有宽度时，盒子随之浏览器窗口大小变化而变化，offsetWidth、offsetHeight可以动态的获取盒子的大小</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">.test &#123;</span><br><span class="line">    width: 100px;</span><br><span class="line">    height: 100px;</span><br><span class="line">    padding: 10px;</span><br><span class="line">    border: 10px solid pink;</span><br><span class="line">    background-color: red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;test&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> test = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.test&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(test.<span class="property">offsetWidth</span>); <span class="comment">// 140 offsetWidth = width + padding + border </span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(test.<span class="property">offsetHeight</span>); <span class="comment">// 140</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h4 id="offsetParent"><a href="#offsetParent" class="headerlink" title="offsetParent"></a>offsetParent</h4><p>offsetParent 返回该元素带有定位的父元素，如果父元素没有定位，则返回body</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">div <span class="keyword">class</span>=<span class="string">&quot;father&quot;</span>&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;son&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/div&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-handlebars"><span class="language-xml"></span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">    console.log(son.offsetParent); // div class=&quot;father&quot;&gt;<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;son&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span></span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(son.<span class="property">parentNode</span>);<span class="comment">// </span></span><br><span class="line">&lt;/script&gt;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p>offsetParent 和 parentNode的区别：</p><ul><li>offsetParent：返回带有定位的父级，没有没有一直往上找，直到body</li><li>parentNode：不管有没有定位，返回其父级</li></ul><h4 id="offset-和-style-的区别"><a href="#offset-和-style-的区别" class="headerlink" title="offset 和 style 的区别"></a>offset 和 style 的区别</h4><p><a href="https://link.juejin.cn/?target=https://www.bilibili.com/video/BV1Sy4y1C7ha?p=290&spm_id_from=pageDriver" title="https://www.bilibili.com/video/BV1Sy4y1C7ha?p=290&amp;spm_id_from=pageDriver">www.bilibili.com/video/BV1Sy…</a></p><table><thead><tr><th>offset</th><th>style</th></tr></thead><tbody><tr><td>offset可得到任意样式表中的样式值</td><td>style只能得到行内样式表中的样式值</td></tr><tr><td>offset系列获得的数值没有单位</td><td>style.width 获得的时带单位的字符串</td></tr><tr><td>offsetWidth包含 padding + border + width</td><td>style.width 不包含padding + border</td></tr><tr><td>offsetWidth 等属性是只读属性，只能获取不能赋值（不能修改）</td><td>style.width 是可读写属性，可获取也可赋值修改</td></tr><tr><td>所以，想要获取元素大小位置：offset</td><td>所以：想要修改元素的值：style</td></tr></tbody></table><h4 id="鼠标在盒子内的坐标（案例）"><a href="#鼠标在盒子内的坐标（案例）" class="headerlink" title="鼠标在盒子内的坐标（案例）"></a>鼠标在盒子内的坐标（案例）</h4><p>案例分析：</p><p>1、在盒子内移动，得到鼠标距离盒子左右的距离（盒子添加mousemove鼠标移动事件）</p><p>2、首先，得到鼠标在页面中的坐标（e.pageX e.pageY）</p><p>3、其次，盒子在页面中的距离（box.offsetLeft box.offsetTop）</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    * &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.box</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">500px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">500px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin</span>: <span class="number">0</span> auto;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: red;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> box = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.box&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    box.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> x = e.<span class="property">pageX</span> - <span class="variable language_">this</span>.<span class="property">offsetLeft</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> y = e.<span class="property">pageY</span> - <span class="variable language_">this</span>.<span class="property">offsetTop</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(box.<span class="property">offsetLeft</span>, box.<span class="property">offsetTop</span>);</span></span><br><span class="line"><span class="language-javascript">        box.<span class="property">innerHTML</span> = <span class="string">&#x27;x坐标是：&#x27;</span> + x + <span class="string">&#x27;y坐标是：&#x27;</span> + y</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h4 id="拖拉拽（案例）"><a href="#拖拉拽（案例）" class="headerlink" title="拖拉拽（案例）"></a>拖拉拽（案例）</h4><p><a href="https://link.juejin.cn/?target=https://www.bilibili.com/video/BV1Sy4y1C7ha?p=293" title="https://www.bilibili.com/video/BV1Sy4y1C7ha?p=293">www.bilibili.com/video/BV1Sy…</a></p><p>拖拉拽的原理：鼠标按下（mousedown） + 鼠标移动（mousemove） + 松开鼠标（mouseup）</p><p>案例分析：</p><p>1、拖拉拽过程：鼠标移动过程中，获得最新的值，再赋值给盒子的left和top值，div就可以跟着鼠标移动</p><p>2、鼠标在页面的坐标 - 鼠标在盒子内的坐标 &#x3D; 盒子移动时的坐标</p><p>3、鼠标按下：得到鼠标在盒子中的坐标</p><p>4、鼠标移动：盒子的坐标 &#x3D; 鼠标坐标 - 盒子坐标 。注意移动事件要写在鼠标按下的事件里面</p><p>5、鼠标松开：停止拖拽，解除鼠标移动事件</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    * &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.box</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: red;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> box = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.box&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 1.当鼠标按下，获取鼠标再盒子内的坐标</span></span></span><br><span class="line"><span class="language-javascript">    box.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousedown&#x27;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 鼠标在盒子内的坐标 = 鼠标在页面中的坐标 - 盒子在页面中的坐标</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> x = e.<span class="property">pageX</span> - box.<span class="property">offsetLeft</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> y = e.<span class="property">pageY</span> - box.<span class="property">offsetTop</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(e.<span class="property">pageX</span>, e.<span class="property">pageY</span>, box.<span class="property">offsetLeft</span>, box.<span class="property">offsetTop</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 2.鼠标移动的时候，把鼠标在页面中的坐标，减去鼠标在盒子内的坐标，得到盒子的left和top值</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, move)</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">function</span> <span class="title function_">move</span>(<span class="params">e</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            box.<span class="property">style</span>.<span class="property">left</span> = e.<span class="property">pageX</span> - x + <span class="string">&#x27;px&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">            box.<span class="property">style</span>.<span class="property">top</span> = e.<span class="property">pageY</span> - y + <span class="string">&#x27;px&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 3.鼠标松开，移除鼠标移动事件</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseup&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">document</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, move)</span></span><br><span class="line"><span class="language-javascript">        &#125;)</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h4 id="放大镜效果（案例）"><a href="#放大镜效果（案例）" class="headerlink" title="放大镜效果（案例）"></a>放大镜效果（案例）</h4><p><a href="https://link.juejin.cn/?target=https://www.bilibili.com/video/BV1Sy4y1C7ha?p=297" title="https://www.bilibili.com/video/BV1Sy4y1C7ha?p=297">www.bilibili.com/video/BV1Sy…</a></p><ul><li>整个案例分为三个模块</li><li>鼠标经过小图片盒子，黄色遮挡层和大图片盒子显示；鼠标离开两个盒子隐藏<ul><li>鼠标经过：mouseover</li><li>鼠标离开：mouseout</li><li>显示隐藏：display:block display:none</li></ul></li><li>黄色的遮挡层跟随鼠标移动<ul><li>把鼠标坐标给遮挡曾不合适，因为遮挡层的坐标以父盒子为准</li><li>首先，获得鼠标在盒子的坐标</li><li>其次，把数值给遮挡层的 left 和 top 值</li><li>此时，用到鼠标移动事件，但是还是在小图片盒子内移动</li><li>为了使鼠标在遮罩层的中间，需要减去遮罩层宽高的一半 offsetWidth、offsetHeight获取盒子的宽高</li><li>遮挡层不能超过小盒子的范围（如果小于0，就把坐标设置为0）</li><li>遮挡层最大的移动距离：小图片盒子宽度 减去 遮挡层盒子宽度</li></ul></li><li>移动黄色遮挡层，大图片跟随移动<ul><li>求大图片移动的公式：大图片移动距离 &#x3D; 遮挡层移动的距离 * 大图片最大移动距离 &#x2F; 遮挡层最大移动距离</li><li><a href="https://link.juejin.cn/?target=https://www.bilibili.com/video/BV1Sy4y1C7ha?p=299" title="https://www.bilibili.com/video/BV1Sy4y1C7ha?p=299">www.bilibili.com/video/BV1Sy…</a></li></ul></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.box</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">502px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">285px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.mask</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">display</span>: none;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">top</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">150px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">150px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: <span class="built_in">rgb</span>(<span class="number">235</span>, <span class="number">238</span>, <span class="number">82</span>, <span class="number">0.4</span>);</span></span><br><span class="line"><span class="language-css">        <span class="comment">/* 鼠标经过变成移动的样式 */</span></span></span><br><span class="line"><span class="language-css">        <span class="attribute">cursor</span>: move;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.enlarge</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">display</span>: none;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">top</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">left</span>: <span class="number">510px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">285px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.enlarge</span> <span class="selector-tag">img</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">top</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;./img/大数据热点图.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;img1&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;mask&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;enlarge&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;./img/大数据热点图.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;img2&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> box = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.box&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> mask = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.mask&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> enlarge = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.enlarge&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> img1 = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.img1&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 鼠标经过显示遮罩层和大图片盒子</span></span></span><br><span class="line"><span class="language-javascript">    box.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseover&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        mask.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;block&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">        enlarge.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;block&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 鼠标经过隐藏遮罩层和大图片盒子</span></span></span><br><span class="line"><span class="language-javascript">    box.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseout&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        mask.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;none&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">        enlarge.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;none&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// </span></span></span><br><span class="line"><span class="language-javascript">    box.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 先计算出鼠标在盒子内的坐标</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> x = e.<span class="property">pageX</span> - box.<span class="property">offsetLeft</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> y = e.<span class="property">pageY</span> - box.<span class="property">offsetTop</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// console.log(x,y);</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 把鼠标在盒子内的坐标赋值给遮罩层的left和top值</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 为了使鼠标在遮罩层的中间，需要减去遮罩层宽高的一半 offsetWidth、offsetHeight获取盒子的宽高</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> maskX = x - mask.<span class="property">offsetWidth</span> / <span class="number">2</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> maskY = y - mask.<span class="property">offsetHeight</span> / <span class="number">2</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 遮挡层最大的移动距离：小图片盒子宽度 减去 遮挡层盒子宽度</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> maskXMax = box.<span class="property">offsetWidth</span> - mask.<span class="property">offsetWidth</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> maskYMax = box.<span class="property">offsetHeight</span> - mask.<span class="property">offsetHeight</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// console.log(maskXMax, maskYMax);</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (maskX &lt; <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            maskX = <span class="number">0</span></span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (maskX &gt;= maskXMax) &#123;</span></span><br><span class="line"><span class="language-javascript">            maskX = maskXMax</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (maskY &lt; <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            maskY = <span class="number">0</span></span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (maskY &gt;= maskYMax) &#123;</span></span><br><span class="line"><span class="language-javascript">            maskY = maskYMax</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        mask.<span class="property">style</span>.<span class="property">left</span> = maskX + <span class="string">&#x27;px&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">        mask.<span class="property">style</span>.<span class="property">top</span> = maskY + <span class="string">&#x27;px&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 大图片移动距离 = 遮挡层移动的距离 * 大图片最大移动距离 / 遮挡层最大移动距离</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 大图</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> img2 = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.img2&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 大图片最大移动的距离</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> enlargeMax = img2.<span class="property">offsetWidth</span> - enlarge.<span class="property">offsetWidth</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 大突破的移动距离</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> enlargeX = maskX * enlargeMax / maskXMax;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> enlargeY = maskY * enlargeMax / maskYMax;</span></span><br><span class="line"><span class="language-javascript">        img2.<span class="property">style</span>.<span class="property">left</span> = -enlargeX + <span class="string">&#x27;px&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">        img2.<span class="property">style</span>.<span class="property">top</span> = -enlargeY + <span class="string">&#x27;px&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h3 id="元素可视区-client-系列"><a href="#元素可视区-client-系列" class="headerlink" title="元素可视区 client 系列"></a>元素可视区 client 系列</h3><p>client 就是客户端，client 系列的相关属性来获取元素可视区的相关信息。</p><p>通过client系列的相关属性可动态的得到该元素的边框大小、元素大小等</p><table><thead><tr><th>client系列</th><th>说明</th></tr></thead><tbody><tr><td>element.clientTop</td><td>返回元素上边框的大小</td></tr><tr><td>element.clientLeft</td><td>返回元素左边框的大小</td></tr><tr><td>element.clientWidth</td><td>返回自身包括padding、内容的宽度，不含边框，返回的数值不带单位</td></tr><tr><td>element.clientHeight</td><td>返回自身包括padding、内容的高度，不含边框，返回的数值不带单位</td></tr></tbody></table><h4 id="立即执行函数"><a href="#立即执行函数" class="headerlink" title="立即执行函数"></a>立即执行函数</h4><p>立即执行函数：不需要调用，立马能够自己执行的函数，也可以传递参数</p><p>立即执行函数最大的作用：独立创建了一个作用域，里面所有的变量都是局部变量，不会有命名冲突的情况</p><p>两种写法语法：</p><ul><li>(function(){})()</li></ul><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">   <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="number">2</span>) <span class="comment">// 2</span></span><br><span class="line">&#125;)(); <span class="comment">// 第二个小括号可看做是调用该函数</span></span><br><span class="line"></span><br><span class="line">(<span class="keyword">function</span>(<span class="params">a</span>)&#123;</span><br><span class="line">   <span class="built_in">console</span>.<span class="built_in">log</span>(a); <span class="comment">// 1</span></span><br><span class="line">&#125;)(<span class="number">1</span>); <span class="comment">// 也可以传参</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><ul><li>(function(){}())</li></ul><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="number">3</span>); <span class="comment">// 3</span></span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line">(<span class="keyword">function</span> <span class="title function_">sum</span>(<span class="params">a</span>) &#123; <span class="comment">// 函数有名字也不影响</span></span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(a); <span class="comment">// 4</span></span><br><span class="line">&#125;(<span class="number">3</span>));</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h3 id="元素滚动-scroll-系列"><a href="#元素滚动-scroll-系列" class="headerlink" title="元素滚动 scroll 系列"></a>元素滚动 scroll 系列</h3><p>scroll：滚动事件，使用scroll系列的相关属性可动态的得到该元素的大小、滚动的距离等</p><table><thead><tr><th>scroll系列属性</th><th>说明（返回数值都不带单位）</th></tr></thead><tbody><tr><td>element.scrollTop</td><td>返回被卷去的上册距离</td></tr><tr><td>element.scrollLeft</td><td>返回被卷去的左侧距离</td></tr><tr><td>element.scrollWidth</td><td>返回自身实际的宽度，不含边框</td></tr><tr><td>element.scrollHeight</td><td>返回自身实际的高度，不含边框</td></tr></tbody></table><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">// 示例</span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">div</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">overflow</span>: auto;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    文字文字文字文字文字文字</span><br><span class="line">    文字文字文字文字文字文字</span><br><span class="line">    文字文字文字文字文字文字</span><br><span class="line">    文字文字文字文字文字文字</span><br><span class="line">    文字文字文字文字文字文字</span><br><span class="line">    文字文字文字文字文字文字</span><br><span class="line">    文字文字文字文字文字文字</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> div = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;div&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"><span class="comment">// scroll 滚动事件，当滚动条发生变化时，会触发该事件</span></span></span><br><span class="line"><span class="language-javascript">    div.<span class="title function_">addEventListener</span>(<span class="string">&#x27;scroll&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(div.<span class="property">scrollTop</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h3 id="offset、client、scroll总结"><a href="#offset、client、scroll总结" class="headerlink" title="offset、client、scroll总结"></a>offset、client、scroll总结</h3><p>三个系列都可返回元素的大小，返回值都不带单位</p><table><thead><tr><th>三个系列大小对比</th><th>作用</th></tr></thead><tbody><tr><td>element.offsetWidth</td><td>返回自身包括padding、边框、内容区的宽度</td></tr><tr><td>element.clientWidth</td><td>返回自身包括padding、内容区的库纳杜</td></tr><tr><td>element.scrollWidth</td><td>返回自身实际的宽度，不含边框（包含了文字超出的部分）</td></tr></tbody></table><p>区别：</p><ul><li>offsetWidth 包含了边框</li><li>clientWidth 值返回元素的高度，但是如果元素内容超过了盒子的大小，则用scrollWidth可得到超出</li></ul><p>三个系列的主要用法：</p><ul><li><strong>offset系列</strong>常用于获取元素位置（ <strong>offsetLeft、offsetTop</strong> ）</li><li><strong>client系列</strong>常用于获取元素大小（ <strong>clientWidth、clientHeight</strong> ）</li><li><strong>scroll系列</strong>常用于获取滚动距离（ <strong>scrollTop、scrollLeft</strong> ）</li></ul><p>注意：页面滚动距离通过window.pageXOffset获得</p><h3 id="mouseenter-和-mouseover区别（面试题）"><a href="#mouseenter-和-mouseover区别（面试题）" class="headerlink" title="mouseenter 和 mouseover区别（面试题）"></a>mouseenter 和 mouseover区别（面试题）</h3><p>mouseenter 和 mouseover都是鼠标移动到元素上会触发的事件</p><p>区别：</p><ul><li>mouseenter 鼠标经过只有自身盒子触发，不会冒泡</li><li>mousrover 鼠标经过自身盒子会触发，经过子盒子也会触发</li><li>跟mouseenter搭配鼠标离开mouseleave同样不会冒泡</li></ul><h3 id="动画函数封装"><a href="#动画函数封装" class="headerlink" title="动画函数封装"></a>动画函数封装</h3><p>核心原理：通过定时器setInterval()不断移动盒子位置</p><h4 id="盒子移动动画（案例）"><a href="#盒子移动动画（案例）" class="headerlink" title="盒子移动动画（案例）"></a>盒子移动动画（案例）</h4><p>案例分析：</p><ul><li>获取盒子当前位置</li><li>让盒子在当前位置上加上一个移动距离</li><li>利用定时器不断重复这个操作</li><li>加一个结束定时器的条件</li><li>注意此元素需要添加定位，才能使用element.style.left</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    * &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.box</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: red;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> box = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.box&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> timer = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// window.innerWidth 当前设备的宽度</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (box.<span class="property">offsetLeft</span> &gt;= <span class="variable language_">window</span>.<span class="property">innerWidth</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 如果需要停止动画：停止动画的本质是  移除定时器</span></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// clearInterval(timer);</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 如果想让动画移动到设备宽度就从头开始移动，则将left设置为0</span></span></span><br><span class="line"><span class="language-javascript">            box.<span class="property">style</span>.<span class="property">left</span> = <span class="number">0</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        box.<span class="property">style</span>.<span class="property">left</span> = box.<span class="property">offsetLeft</span> + <span class="number">5</span> + <span class="string">&#x27;px&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;, <span class="number">30</span>)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h4 id="动画效果封装"><a href="#动画效果封装" class="headerlink" title="动画效果封装"></a>动画效果封装</h4><p>此方法需要传递两个参数：动画的对象、目标位置</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 动画的对象obj, 目标位置target</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">animate</span>(<span class="params">obj, target</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> timer = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (obj.<span class="property">offsetLeft</span> &gt;= target) &#123;</span><br><span class="line">            <span class="comment">// 如果需要停止动画：停止动画的本质是  移除定时器</span></span><br><span class="line">            <span class="comment">// clearInterval(timer);</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 如果想让动画移动到设备宽度就从头开始移动，则将left设置为0</span></span><br><span class="line">            obj.<span class="property">style</span>.<span class="property">left</span> = <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        obj.<span class="property">style</span>.<span class="property">left</span> = obj.<span class="property">offsetLeft</span> + <span class="number">5</span> + <span class="string">&#x27;px&#x27;</span>;</span><br><span class="line">    &#125;, <span class="number">30</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">animate</span>(box, <span class="variable language_">window</span>.<span class="property">innerWidth</span>)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p>优化方案：<a href="https://link.juejin.cn/?target=https://www.bilibili.com/video/BV1Sy4y1C7ha?p=311" title="https://www.bilibili.com/video/BV1Sy4y1C7ha?p=311">www.bilibili.com/video/BV1Sy…</a></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">//</span> 优化</span><br><span class="line"><span class="keyword">function</span> animate(obj, target, callback) &#123;</span><br><span class="line">    <span class="regexp">//</span> 如果需要某个条件才动画，比如点击按钮动画执行，需要先清除一次定时器，</span><br><span class="line">    <span class="regexp">//</span> 以防按钮不断点击，元素移动的速度越来越快，因为开启了太多的定时器</span><br><span class="line">    <span class="regexp">//</span> clearInterval(obj.timer); <span class="regexp">//</span> 先清除以前的定时器，只保留当前的一个定时器</span><br><span class="line">    obj.timer = setInterval(() =&gt; &#123;</span><br><span class="line">        <span class="regexp">//</span> 步长写在定时器里面</span><br><span class="line">        <span class="regexp">//</span> 把步长值改为整数,不要出现小数的问题</span><br><span class="line">        <span class="regexp">//</span> var step = Math.ceil((target - obj.offsetLeft) / <span class="number">10</span>);</span><br><span class="line">        var step = (target - obj.offsetLeft) / <span class="number">10</span>;</span><br><span class="line">        step = step &gt; <span class="number">0</span> ? Math.ceil(step) : Math.floor(step)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (obj.offsetLeft == target) &#123;</span><br><span class="line">            <span class="regexp">//</span> 如果需要停止动画：停止动画的本质是  移除定时器</span><br><span class="line">            clearInterval(obj.timer);</span><br><span class="line"></span><br><span class="line">            <span class="regexp">//</span> 如果想让动画移动到设备宽度就从头开始移动，则将left设置为<span class="number">0</span></span><br><span class="line">            <span class="regexp">//</span> obj.style.left = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">            <span class="regexp">//</span> 回调函数写在定时器里面</span><br><span class="line">            <span class="keyword">if</span> (callback) &#123;</span><br><span class="line">                <span class="regexp">//</span> 调用传递进来的回调函数</span><br><span class="line">                callback();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="regexp">//</span> 把每次加<span class="number">1</span> 这个步长值改为一个慢慢变小的值,步长公式:(目标值 - 现在的位置) / <span class="number">10</span></span><br><span class="line">        obj.style.left = obj.offsetLeft + step + <span class="string">&#x27;px&#x27;</span>;</span><br><span class="line">    &#125;, <span class="number">30</span>)</span><br><span class="line">&#125;</span><br><span class="line">animate(box, <span class="number">500</span>, <span class="keyword">function</span> () &#123;</span><br><span class="line">    <span class="regexp">//</span> 动画执行完毕后,执行回调函数, 此处代码调用</span><br><span class="line">    box.style.backgroundColor = <span class="string">&#x27;blue&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h3 id="常见网页特效案例"><a href="#常见网页特效案例" class="headerlink" title="常见网页特效案例"></a>常见网页特效案例</h3><h4 id="banner轮播"><a href="#banner轮播" class="headerlink" title="banner轮播"></a>banner轮播</h4><p>案例分析：</p><ul><li>鼠标经过（mouseover、mouseenter）轮播模块，左右按钮显示，鼠标离开（mouseout、mouseleave）左右按钮隐藏<ul><li>mouseover 鼠标经过自身盒子会触发，经过子盒子也会触发 ，对应mouseout</li><li>mouseenter 鼠标经过只有自身盒子触发，不会冒泡，对应mouseleave</li><li>显示隐藏按钮display</li></ul></li><li>动态生成导航小圆点<ul><li>核心思路：导航小圆点要跟图片张数一致</li><li>先得到ul里面图片的张数（图片放在li里面，li的个数也就是图片的个数）ul.children.length</li><li>循环动态生成小圆圈（小圆圈放在ol里面）</li><li>创建节点createElemeny(‘li’)</li><li>插入节点 ol.appendChild(li)</li><li>把ol里面的第一个li设置类名为current：表示选中的效果以及表示展示的是第一张图片 ol.children[0].className &#x3D; ‘current’</li><li>给导航小圆点添加点击事件：<strong>排他思想</strong> 干掉其他的li，留下当前点击的li</li></ul></li><li>点击右侧按钮播放下一张图片原理： 点击右侧按钮一次，图片往左播放一张，以此类推。左侧按钮同理<ul><li>声明一个变量num，点击一次，自增1，让这个变量 乘以 图片宽度，就是ul的滚动距离</li><li>图片无缝滚动原理（滚动到最后一张，循环滚动）：把ul第一个li复制一份放到ul的最后面，当图片滚动到复制的最后一张时，让ul快速的，不做动画的跳到最左侧：left为0</li><li>同时num赋值为0，重新开始滚动图片</li></ul></li><li>图片播放的同时，导航小圆点跟随一起变化<ul><li>简单的做法：声明一个变量cricle，每次点击自增1。注意：左侧按钮也需要这个变量，因为要声明全局变量</li><li>但是因为前面克隆了一张图片，现在图片多了一张，而小圆点的个数是之前图片的数量，所以必须加一个判断条件</li><li>如果cricle &#x3D;&#x3D; 之前图片的数量，就重新复原为cricle &#x3D; 0</li></ul></li><li>点击导航小圆点，播放相应的图片<ul><li>点击导航小圆点是ul在移动，而不是ul里面的li（要提前给ul加定位）</li><li>滚动图片的核心算法：点击某个小圆点，就让图片滚动，<strong>导航小圆点的索引号乘以图片的宽度</strong>作为ul移动的距离</li></ul></li><li>鼠标不经过轮播图，轮播图也会自动轮播图片<ul><li>定时器</li><li>自动播放轮播图，实际上类似点击了右侧按钮</li><li>此时使用手动调用右侧按钮点击事件 next.click()</li><li>鼠标经过banner，停止定时器</li><li>鼠标离开banner，开启定时器</li></ul></li></ul><h4 id="带有动画的返回顶部"><a href="#带有动画的返回顶部" class="headerlink" title="带有动画的返回顶部"></a>带有动画的返回顶部</h4><p>滚动窗口至文档中的特定位置：window.scroll(x,y)</p><p>页面滚动了多少：window.pageYOffset</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">btn.addEventlistener(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span>()&#123;</span><br><span class="line">    <span class="regexp">//</span> 里面的x,y不跟单位，直接写数字即可</span><br><span class="line"><span class="regexp">//</span> window.scroll(<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">    animate(window, <span class="number">0</span>); <span class="regexp">//</span> 因为是窗口滚动，所以对象是window</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> animate(obj, target, callback) &#123;</span><br><span class="line">    <span class="regexp">//</span> 如果需要某个条件才动画，比如点击按钮动画执行，需要先清除一次定时器，</span><br><span class="line">    <span class="regexp">//</span> 以防按钮不断点击，元素移动的速度越来越快，因为开启了太多的定时器</span><br><span class="line">    clearInterval(obj.timer); <span class="regexp">//</span> 先清除以前的定时器，只保留当前的一个定时器</span><br><span class="line">    obj.timer = setInterval(() =&gt; &#123;</span><br><span class="line">        <span class="regexp">//</span> 步长写在定时器里面</span><br><span class="line">        <span class="regexp">//</span> 把步长值改为整数,不要出现小数的问题</span><br><span class="line">        <span class="regexp">//</span> var step = Math.ceil((target - obj.offsetLeft) / <span class="number">10</span>);</span><br><span class="line">        var step = (target - window.pageYOffset) / <span class="number">10</span>;</span><br><span class="line">        step = step &gt; <span class="number">0</span> ? Math.ceil(step) : Math.floor(step)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (window.pageYOffset == target) &#123;</span><br><span class="line">            <span class="regexp">//</span> 如果需要停止动画：停止动画的本质是  移除定时器</span><br><span class="line">            clearInterval(obj.timer);</span><br><span class="line"></span><br><span class="line">            <span class="regexp">//</span> 如果想让动画移动到设备宽度就从头开始移动，则将left设置为<span class="number">0</span></span><br><span class="line">            <span class="regexp">//</span> obj.style.left = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">            <span class="regexp">//</span> 回调函数写在定时器里面</span><br><span class="line">            <span class="regexp">//</span> <span class="keyword">if</span> (callback) &#123;</span><br><span class="line">            <span class="regexp">//</span>     <span class="regexp">//</span> 调用传递进来的回调函数</span><br><span class="line">            <span class="regexp">//</span>     callback();</span><br><span class="line">            <span class="regexp">//</span> &#125;</span><br><span class="line">            callback &amp;&amp; callback();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="regexp">//</span> 把每次加<span class="number">1</span> 这个步长值改为一个慢慢变小的值,步长公式:(目标值 - 现在的位置) / <span class="number">10</span></span><br><span class="line">        <span class="regexp">//</span> obj.style.left = obj.offsetLeft + step + <span class="string">&#x27;px&#x27;</span>;</span><br><span class="line">        window.scroll(<span class="number">0</span>,window.pageYOffset + step)</span><br><span class="line">    &#125;, <span class="number">30</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JS高级事件</title>
      <link href="/posts/de26697a/"/>
      <url>/posts/de26697a/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="事件高级"><a href="#事件高级" class="headerlink" title="事件高级"></a>事件高级</h2><h3 id="注册（绑定）事件的方式"><a href="#注册（绑定）事件的方式" class="headerlink" title="注册（绑定）事件的方式"></a>注册（绑定）事件的方式</h3><p>给元素添加事件，称为<strong>注册事件</strong>或者<strong>绑定事件</strong></p><p>注册事件的两种方式：</p><ul><li>传统的方式</li><li>方法监听注册方式</li></ul><h4 id="传统注册方式"><a href="#传统注册方式" class="headerlink" title="传统注册方式"></a>传统注册方式</h4><p>传统注册方式：</p><ul><li>利用on开头的事件 onclick</li><li><code>&lt;button onclick=&#39;alert(&#39;99&#39;)&#39;&gt;&lt;/button&gt;</code></li><li><code>btn.onclick = function()&#123;&#125;</code></li><li>特点：注册事件的唯一性</li><li>同一个元素同一个事件只能设置一个处理函数，后面注册的处理函数会覆盖前面注册的处理函数</li></ul><h4 id="方法监听注册方式"><a href="#方法监听注册方式" class="headerlink" title="方法监听注册方式"></a>方法监听注册方式</h4><p>方法监听注册方式：</p><ul><li>W3C标准 推荐方式</li><li><strong>addEventListener()</strong> 方法</li><li>IE9之前的IE不支持此方法，可用attachEvent() （不提倡用此方法）代替</li><li>特点：<strong>同一个元素同一个事件可注册（绑定）多个监听器（处理函数function(){}）</strong></li><li>按照绑定的顺序依次执行</li></ul><h4 id="addEventListener-事件监听方式"><a href="#addEventListener-事件监听方式" class="headerlink" title="addEventListener 事件监听方式"></a>addEventListener 事件监听方式</h4><p>语法：<code>eventTarget.addEventListener(type, listener[, useCapture])</code> 将指定的监听器绑定到eventTarget（目标对象）上，当该对象触发指定的事件时，就会执行事件处理函数。</p><p>该方法接收三个参数：</p><ul><li>type：事件类型字符串（要加引号）。比如：click、mouseover等，注意这里不需要带on</li><li>listener：事件处理函数，事件发生时，会调用该函数</li><li>useCapture：是否阻止冒泡，可选参数，布尔值，默认是false</li></ul><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 示例</span></span><br><span class="line">&lt;button&gt;按钮&lt;/button&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> btn = document.querySelector(<span class="string">&#x27;button&#x27;</span>);</span><br><span class="line">btn.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">&#x27;按钮&#x27;</span>);</span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h3 id="删除事件（事件解绑）"><a href="#删除事件（事件解绑）" class="headerlink" title="删除事件（事件解绑）"></a>删除事件（事件解绑）</h3><h4 id="传统注册事件的事件解绑"><a href="#传统注册事件的事件解绑" class="headerlink" title="传统注册事件的事件解绑"></a>传统注册事件的事件解绑</h4><p>传统注册事件的事件解绑：<code>eventTarget.onclick = null;</code></p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 示例 只能点击一次，点完第一次 btn.onclick = null  事件解绑</span></span><br><span class="line">&lt;button&gt;按钮&lt;/button&gt;</span><br><span class="line">btn.onclick = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">&#x27;按钮&#x27;</span>);</span><br><span class="line">    btn.onclick = <span class="literal">null</span></span><br><span class="line">&#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h4 id="方法监听注册方式-1"><a href="#方法监听注册方式-1" class="headerlink" title="方法监听注册方式"></a>方法监听注册方式</h4><p>方法监听注册方式：<code>eventTarget.removeEventListener(type, listener[, useCapture])</code></p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 示例</span></span><br><span class="line">&lt;button&gt;按钮&lt;/button&gt;</span><br><span class="line"><span class="keyword">var</span> btn = document.querySelector(<span class="string">&#x27;button&#x27;</span>);</span><br><span class="line">btn.addEventListener(<span class="string">&#x27;click&#x27;</span>, fn) <span class="comment">// 里面的fn  调用不需要加 小括号</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">&#x27;按钮&#x27;</span>);</span><br><span class="line">    btn.removeEventListener(<span class="string">&#x27;click&#x27;</span>, fn)</span><br><span class="line">&#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p>注意：removeEventListener 方法解除事件绑定，必须告诉他解除哪个处理函数，前面绑定的函数可单独写出来</p><h3 id="DOM事件流（重要）"><a href="#DOM事件流（重要）" class="headerlink" title="DOM事件流（重要）"></a>DOM事件流（重要）</h3><p><a href="https://link.juejin.cn/?target=https://www.bilibili.com/video/BV1Sy4y1C7ha?p=252&spm_id_from=pageDriver" title="https://www.bilibili.com/video/BV1Sy4y1C7ha?p=252&amp;spm_id_from=pageDriver">www.bilibili.com/video/BV1Sy…</a></p><p>事件流：描述的是从页面中接收事件的顺序</p><p>事件发生时会在元素节点之间按照特定的顺序传播，这个传播的过程称为 <strong>DOM事件流</strong> （ <strong>DOM事件流：事件传播的过程</strong> ）</p><p>DOM事件流分为三个阶段：</p><ul><li>捕获阶段：网景最早提出，由DOM最顶层节点开始，然后逐级向下传播到最具体的元素接收的过程</li><li>当前目标阶段</li><li>冒泡阶段：IE最早提出，事件开始时由具体的元素接收，然后逐级向上传播到DOM最顶层节点的过程</li></ul><p>注意：</p><ul><li>JS代码中，只能执行捕获或者冒泡其中的一个阶段</li><li>onclick、attachEvent只能得到冒泡阶段</li><li>addEventListener(type, listener[, useCapture]) 第三个参数如果是true，表示事件捕获阶段调用事件处理程序；如果是false（不写默认是false），表示事件冒泡阶段调用事件处理程序</li><li>在实际开发中，很少使用事件捕获，更关注事件冒泡</li><li>有些事件是没有冒泡的。比如：onblur、onfocus、onmouseenter、onmouseleave</li></ul><h3 id="事件对象"><a href="#事件对象" class="headerlink" title="事件对象"></a>事件对象</h3><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;button&gt;按钮&lt;/button&gt;</span><br><span class="line"><span class="keyword">var</span> btn = document.querySelector(<span class="string">&#x27;button&#x27;</span>);</span><br><span class="line">btn.onclick = <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(event);</span><br><span class="line">&#125;</span><br><span class="line">btn.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span>(<span class="params">event</span>)&#123;</span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(event);</span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><ul><li>event 就是一个事件对象，写在侦听函数的小括号里面，当形参来看</li><li>事件对象只有有了事件才会存在，它是系统自动创建的，不需要我们传递参数</li><li>事件对象：是事件的一系列相关数据的集合，跟事件相关的。比如：鼠标点击，里面包含了鼠标的相关信息（鼠标坐标等）；如果是键盘事件，里面则包含的是键盘事件相关的信息（比如判断用户按下了哪个键）</li><li>事件对象简单理解：事件发生后，跟事件相关的一系列信息数据的集合都放在这个对象里面，这个对象就是事件对象event，它有很多属性和方法</li><li>事件对象可自己命名。比如：event、evt、e（常用）</li><li>事件对象由兼容性问题。IE6&#x2F;7&#x2F;8通过window.event</li></ul><p>事件对象兼容性写法：</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">btn.onclick = <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">    e = e || window.event;</span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(e);</span><br><span class="line">&#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h3 id="e-target-和-this-的区别"><a href="#e-target-和-this-的区别" class="headerlink" title="e.target 和 this 的区别"></a>e.target 和 this 的区别</h3><p>e.target 返回的是触发事件的对象（元素）</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;<span class="number">123</span>&lt;/div&gt;</span><br><span class="line"><span class="keyword">var</span> div = document.querySelector(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">div.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(e.target); <span class="comment">// &lt;div&gt;123&lt;/div&gt;</span></span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(this);<span class="comment">// &lt;div&gt;123&lt;/div&gt;</span></span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p>区别：</p><ul><li>e.target 返回的是触发事件的对象（元素），this返回的是绑定事件的对象（元素）</li><li>e.target 点击了哪个元素，就返回哪个元素；this 哪个元素绑定了，就返回哪个元素</li></ul><h3 id="阻止默认行为"><a href="#阻止默认行为" class="headerlink" title="阻止默认行为"></a>阻止默认行为</h3><p>组织默认行为，比如：让链接不跳转，让提交按钮不提交</p><p><a href="https://link.juejin.cn/?target=https://www.bilibili.com/video/BV1Sy4y1C7ha?p=255&spm_id_from=pageDriver" title="https://www.bilibili.com/video/BV1Sy4y1C7ha?p=255&amp;spm_id_from=pageDriver">www.bilibili.com/video/BV1Sy…</a></p><h3 id="阻止事件冒泡"><a href="#阻止事件冒泡" class="headerlink" title="阻止事件冒泡"></a>阻止事件冒泡</h3><p>事件冒泡：事件开始时由具体的元素接收，然后逐级向上传播到DOM最顶层节点的过程</p><p>阻止事件冒泡：</p><ul><li>标准写法（推荐）：利用事件对象里面stopPropagation()方法</li><li>非标准写法：IE6-8 利用事件对象cancelBubble属性</li></ul><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 示例</span></span><br><span class="line">btn.add<span class="constructor">EventListener(&#x27;<span class="params">click</span>&#x27;, <span class="params">function</span> (<span class="params">e</span>)</span> &#123;</span><br><span class="line">    e.stop<span class="constructor">Propagation()</span>; <span class="comment">// 阻止事件冒泡</span></span><br><span class="line">    e.cancelBubble = <span class="literal">true</span> <span class="comment">// 阻止事件冒泡</span></span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h3 id="事件委托（代理、委派）"><a href="#事件委托（代理、委派）" class="headerlink" title="事件委托（代理、委派）"></a>事件委托（代理、委派）</h3><p><strong>事件委托的原理：不是每个子节点单独设置事件监听器，而是事件监听器设置在父节点上，然后利用冒泡原理影响每个子节点</strong></p><p>事件委托的作用：只操作一次DOM，提高了程序的性能</p><p>下面案例：给ul绑定点击事件，然后利用事件对象的target来找到当前所点击的li，因为点击li，事件会冒泡到ul上，ul有注册事件，就会触发事件监听器</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> &lt;ul&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>111<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>222<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>333<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">&lt;/ul&gt;</span><br><span class="line"><span class="keyword">var</span> ul = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;ul&#x27;</span>);</span><br><span class="line">ul.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="comment">// alert(&#x27;弹框~~&#x27;);</span></span><br><span class="line">    <span class="comment">// e.target 可得到点击的对象</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(e.<span class="property">target</span>);</span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h3 id="鼠标事件对象"><a href="#鼠标事件对象" class="headerlink" title="鼠标事件对象"></a>鼠标事件对象</h3><p>获取鼠标在页面中的坐标</p><p>event对象代表事件的状态，跟事件相关的一系列信息的集合。</p><p>鼠标事件：MouseEvent</p><h4 id="获取鼠标的坐标"><a href="#获取鼠标的坐标" class="headerlink" title="获取鼠标的坐标"></a>获取鼠标的坐标</h4><table><thead><tr><th>鼠标事件对象</th><th>说明</th></tr></thead><tbody><tr><td>e.clientX</td><td>返回鼠标相对于浏览器窗口可视区的x坐标</td></tr><tr><td>e.clientY</td><td>返回鼠标相对于浏览器窗口可视区的y坐标</td></tr><tr><td>e.pageX</td><td>返回鼠标相对于文档页面的x坐标 IE9+支持</td></tr><tr><td>e.pageY</td><td>返回鼠标相对于文档页面的y坐标 IE9+支持</td></tr><tr><td>e.screenX</td><td>返回鼠标相对于电脑屏幕的X坐标</td></tr><tr><td>e.screenY</td><td>返回鼠标相对于电脑屏幕的y坐标</td></tr></tbody></table><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 示例</span></span><br><span class="line">document.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span>(<span class="params">e</span>)&#123;</span><br><span class="line">    <span class="comment">// 1.client 鼠标在可视区的x和y坐标</span></span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(e.clientX);</span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(e.clientY);</span><br><span class="line">    <span class="comment">// 2.page 鼠标在页面文档的x和y坐标</span></span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(e.pageX);</span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(e.pageY);</span><br><span class="line">    <span class="comment">// 3.screen 鼠标在电脑屏幕的x和y坐标</span></span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(e.screenX);</span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(e.screenY);</span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h4 id="跟随鼠标移动的div（案例）"><a href="#跟随鼠标移动的div（案例）" class="headerlink" title="跟随鼠标移动的div（案例）"></a>跟随鼠标移动的div（案例）</h4><p>案例分析：</p><p>1、鼠标不断的移动，使用鼠标移动事件：mousemove</p><p>2、在页面中移动，给document注册事件</p><p>3、div要移动距离，而且不占位置，使用绝对定位即可</p><p>4、核心原理：每次鼠标移动，都会获得最新的鼠标坐标，把这个x和y坐标作为图片的top和left值就可移动图片</p><figure class="highlight gml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">div</span> &#123;</span><br><span class="line">    width: <span class="number">100</span>px;</span><br><span class="line">    height: <span class="number">100</span>px;</span><br><span class="line">    background-color: red;</span><br><span class="line">    position: absolute;</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="keyword">div</span>&gt;&lt;/<span class="keyword">div</span>&gt;</span><br><span class="line"><span class="keyword">var</span> <span class="keyword">div</span> = document.querySelector(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line"><span class="comment">// mousemove 只要鼠标移动1px，就会触发这个事件</span></span><br><span class="line">document.addEventListener(<span class="string">&#x27;mousemove&#x27;</span>, <span class="keyword">function</span> (e) &#123;</span><br><span class="line">    <span class="comment">// e.pageX e.pageY 鼠标在页面文档的x和y坐标</span></span><br><span class="line">    <span class="keyword">var</span> <span class="variable language_">x</span> = e.pageX;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable language_">y</span> = e.pageY;</span><br><span class="line">    <span class="comment">// console.log(x, y);</span></span><br><span class="line">    <span class="comment">// 拼接单位px</span></span><br><span class="line">    <span class="keyword">div</span>.style.left = <span class="variable language_">x</span> - <span class="number">50</span> + <span class="string">&#x27;px&#x27;</span>;</span><br><span class="line">    <span class="keyword">div</span>.style.top = <span class="variable language_">y</span> - <span class="number">50</span> + <span class="string">&#x27;px&#x27;</span>;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h3 id="键盘事件"><a href="#键盘事件" class="headerlink" title="键盘事件"></a>键盘事件</h3><h4 id="keyup、keydown、keypress"><a href="#keyup、keydown、keypress" class="headerlink" title="keyup、keydown、keypress"></a>keyup、keydown、keypress</h4><table><thead><tr><th>键盘事件</th><th>说明</th></tr></thead><tbody><tr><td>onkeyup</td><td>某个键盘按键被松开时触发</td></tr><tr><td>onkeydown</td><td>某个键盘按键被按下时触发</td></tr><tr><td>onkeypress</td><td>某个键盘按键被按下时触发，但是不识别功能键，比如ctrl、shift、箭头等</td></tr></tbody></table><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 示例</span></span><br><span class="line">document.addEventListener(<span class="string">&#x27;keyup&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">&#x27;弹起~&#x27;</span>);</span><br><span class="line">&#125;)</span><br><span class="line">document.addEventListener(<span class="string">&#x27;keydown&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">&#x27;按下~&#x27;</span>);</span><br><span class="line">&#125;)</span><br><span class="line">document.addEventListener(<span class="string">&#x27;keypress&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">&#x27;按下keypress~&#x27;</span>);</span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p>注意：</p><ul><li>传统方式需要加on，addEventListener不需要加on</li><li>onkeypress和前两个的区别是：不识别功能键。比如ctrl、左右箭头、shift等</li><li>三个执行顺序：keydown -&gt; keypress -&gt; keyup</li></ul><h4 id="keyCode判断用户按下哪个键"><a href="#keyCode判断用户按下哪个键" class="headerlink" title="keyCode判断用户按下哪个键"></a>keyCode判断用户按下哪个键</h4><p>键盘事件对象中的keyCode属性可用得到相应键的ASCII码值</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">document.addEventListener(<span class="string">&#x27;keyup&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line"> <span class="built_in">console</span>.<span class="built_in">log</span>(e.keyCode);</span><br><span class="line">&#125;)</span><br><span class="line">document.addEventListener(<span class="string">&#x27;keydown&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(e.keyCode);</span><br><span class="line">&#125;)</span><br><span class="line">document.addEventListener(<span class="string">&#x27;keypress&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">   <span class="built_in">console</span>.<span class="built_in">log</span>(e.keyCode);</span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p>注意：</p><ul><li>keyup 和 keydown事件不区分大小写，a 和 A 得到的ASCII码值都是65</li><li>keypress 事件区分大小写，a 97 ，A 65</li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> JS高级事件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JS高级事件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JS浏览器对象</title>
      <link href="/posts/3a160893/"/>
      <url>/posts/3a160893/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 高阶对象 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JS浏览器对象 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>函数柯里化（curry）</title>
      <link href="/posts/d56cb4fa/"/>
      <url>/posts/d56cb4fa/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>参考文章：<br><a href="https://github.com/mqyqingfeng/Blog/issues/42">《JavaScript专题之函数柯里化》</a></p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">lambda演算 = 接收一个参数</button></li><li class="tab"><button type="button" data-href="#super-2">lambda演算 + 柯里化写法 = 接收多个参数</button></li><li class="tab"><button type="button" data-href="#super-3">lambda演算 + 柯里化写法 + JavaScript</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><code>lambda x. ( lambda y. plus x y )</code></p><blockquote><p>把函数自身作为输入参数或输出返回值，也就是【高阶函数】的定义。</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params">a</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">b</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> a + b</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">add</span>(<span class="number">1</span>)(<span class="number">2</span>)</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="百变柯里化"><a href="#百变柯里化" class="headerlink" title="百变柯里化"></a>百变柯里化</h2><p>柯里化 &#x3D; 闭包 + 递归</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">1. 引入外部变量arr，不符合纯函数的特性</button></li><li class="tab"><button type="button" data-href="#super-2">2. 符合纯函数特性</button></li><li class="tab"><button type="button" data-href="#super-3">3. 避免以 ‘( )’ 空括号结尾，改进为隐式转换 .toString 写法</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = []</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">addCurry</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> arg = <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">slice</span>.<span class="title function_">call</span>(<span class="variable language_">arguments</span>); <span class="comment">// 递归获取后续参数</span></span><br><span class="line">  arr = arr.<span class="title function_">concat</span>(arg);</span><br><span class="line">  <span class="keyword">if</span> (arg.<span class="property">length</span> === <span class="number">0</span>) &#123; <span class="comment">// 如果参数为空，则判断递归结束</span></span><br><span class="line">    <span class="keyword">return</span> arr.<span class="title function_">reduce</span>(<span class="function">(<span class="params">a,b</span>)=&gt;</span>&#123;<span class="keyword">return</span> a+b&#125;) <span class="comment">// 求和</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> addCurry;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">addCurry</span>(<span class="number">1</span>)(<span class="number">2</span>)(<span class="number">3</span>)()</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">addCurry</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> arr = [...<span class="variable language_">arguments</span>]</span><br><span class="line">  <span class="keyword">let</span> fn = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable language_">arguments</span>.<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> arr.<span class="title function_">reduce</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a + b)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      arr.<span class="title function_">push</span>(...<span class="variable language_">arguments</span>)</span><br><span class="line">      <span class="keyword">return</span> fn</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> fn</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">addCurry</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> arr = [...<span class="variable language_">arguments</span>]</span><br><span class="line">  <span class="comment">// 利用闭包的特性收集所有参数值</span></span><br><span class="line">  <span class="keyword">var</span> fn = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    arr.<span class="title function_">push</span>(...<span class="variable language_">arguments</span>);</span><br><span class="line">    <span class="keyword">return</span> fn;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">// 利用 toString 隐式转换</span></span><br><span class="line">  fn.<span class="property">toString</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> arr.<span class="title function_">reduce</span>(<span class="keyword">function</span> (<span class="params">a, b</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> a + b;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> fn;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="函数柯里化的实现"><a href="#函数柯里化的实现" class="headerlink" title="函数柯里化的实现"></a>函数柯里化的实现</h3><p>定义：</p><ol><li>将使用多个参数的函数转换成一个单一参数（初始函数的第一个参数）的函数</li><li>返回接受余下的参数且返回结果的新函数。</li></ol><p>意义：</p><ol><li>有时不方便传入参数</li><li>有些方法调用起来，参数已经固定了</li></ol><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">简单实现方法</button></li><li class="tab"><button type="button" data-href="#super-2">完整实现方法</button></li><li class="tab"><button type="button" data-href="#super-3">es6实现方法</button></li><li class="tab"><button type="button" data-href="#super-4">bind实现方法</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><ul><li>柯里化函数会接收到固定参数，然后再柯里化函数内部，返回一个新函数，接收剩余参数。</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">aCurry</span>(<span class="params">num1</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">num2</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(num1, num2);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">aCurry</span>(<span class="number">1</span>)(<span class="number">2</span>);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">curry</span>(<span class="params">fn, args</span>) &#123;</span><br><span class="line">  <span class="comment">// 获取函数需要的参数长度</span></span><br><span class="line">  <span class="keyword">let</span> length = fn.<span class="property">length</span>;</span><br><span class="line">  args = args || [];</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> subArgs = args.<span class="title function_">slice</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="comment">// 拼接得到现有的所有参数</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">arguments</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      subArgs.<span class="title function_">push</span>(<span class="variable language_">arguments</span>[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 判断参数的长度是否已经满足函数所需参数的长度</span></span><br><span class="line">    <span class="keyword">if</span> (subArgs.<span class="property">length</span> &gt;= length) &#123;</span><br><span class="line">      <span class="comment">// 如果满足，执行函数</span></span><br><span class="line">      <span class="keyword">return</span> fn.<span class="title function_">apply</span>(<span class="variable language_">this</span>, subArgs);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 如果不满足，递归返回柯里化的函数，等待参数的传入</span></span><br><span class="line">      <span class="keyword">return</span> curry.<span class="title function_">call</span>(<span class="variable language_">this</span>, fn, subArgs);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// es6 实现</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">curry</span>(<span class="params">fn, ...args</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> fn.<span class="property">length</span> &lt;= args.<span class="property">length</span> ? <span class="title function_">fn</span>(...args) : curry.<span class="title function_">bind</span>(<span class="literal">null</span>, fn, ...args);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">myBind</span>() = <span class="keyword">function</span> (<span class="params">thisArg</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="variable language_">this</span> !== <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> _self = <span class="variable language_">this</span>;</span><br><span class="line">  <span class="keyword">var</span> args = <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">slice</span>.<span class="title function_">call</span>(<span class="variable language_">arguments</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> _self.<span class="title function_">apply</span>(thisArg, args.<span class="title function_">concat</span>(<span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">slice</span>.<span class="title function_">all</span>(<span class="variable language_">arguments</span>)));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="柯里化的应用场景"><a href="#柯里化的应用场景" class="headerlink" title="柯里化的应用场景"></a>柯里化的应用场景</h2><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">缓存传参</button></li><li class="tab"><button type="button" data-href="#super-2">缓存判断</button></li><li class="tab"><button type="button" data-href="#super-3">缓存计算</button></li><li class="tab"><button type="button" data-href="#super-4">缓存函数</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>柯里化最基础的用法是缓存传参。<br>场景需求：<br>已知一个 ajax 函数，它有 3 个参数 url、data、callback</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">ajax</span>(<span class="params">url, data, callback</span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>不用柯里化是怎样减少传参的呢？<br>通常是以下这样，写死参数位置的方式来减少传参：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">ajaxTest1</span>(<span class="params">data, callback</span>) &#123;</span><br><span class="line">  <span class="title function_">ajax</span>(<span class="string">&#x27;http://www.test.com/test1&#x27;</span>, data, callback);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>而通过柯里化，则是这样：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">ajax</span>(<span class="params">url, data, callback</span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> ajaxTest2 = <span class="title function_">partial</span>(ajax,<span class="string">&#x27;http://www.test.com/test2&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="title function_">ajaxTest2</span>(data,callback)</span><br></pre></td></tr></table></figure><p>其中 partial 函数是这样写的：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">partial</span>(<span class="params">fn, ...presetArgs</span>) &#123; <span class="comment">// presetArgs 是需要先被绑定下来的参数</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">partiallyApplied</span>(<span class="params">...laterArgs</span>) &#123; <span class="comment">//  ...laterArgs 是后续参数</span></span><br><span class="line">    <span class="keyword">let</span> allArgs =presetArgs.<span class="title function_">concat</span>(laterArgs) <span class="comment">// 收集到一起</span></span><br><span class="line">    <span class="keyword">return</span> fn.<span class="title function_">apply</span>(<span class="variable language_">this</span>, allArgs) <span class="comment">// 传给回调函数 fn</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>柯里化固定参数的好处在：复用了原本的 ajax 函数，并在原有基础上做了修改，取其精华，弃其糟粕，封装原有函数之后，就能为我所用。<br>并且  partial 函数不止对 ajax 函数有作用，对于其它想减少传参的函数同样适用。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>场景需求：<br>假设有一个 handleOption 函数，当符合条件 ‘A’，执行语句：console.log(‘A’)；不符合时，则执行语句：console.log(‘others’)<br>转为代码即：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">handleOption</span> = (<span class="params">param</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span>(param === <span class="string">&#x27;A&#x27;</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;others&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>现在的问题是：我们每次调用 handleOption(‘A’)，都必须要走完 if…else… 的判断流程。比如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">handleOption</span> = (<span class="params">param</span>) =&gt;&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;每次调用 handleOption 都要执行 if...else...&#x27;</span>)</span><br><span class="line">  <span class="keyword">if</span>(param === <span class="string">&#x27;A&#x27;</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;others&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">handleOption</span>(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line"><span class="title function_">handleOption</span>(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line"><span class="title function_">handleOption</span>(<span class="string">&#x27;A&#x27;</span>)</span><br></pre></td></tr></table></figure><p>控制台打印：<br><img src="/image/%E5%87%BD%E6%95%B0%E6%9F%AF%E9%87%8C%E5%8C%96/1665063375065.png" alt="1665063375065"><br>有没有什么办法，多次调用 handleOption(‘A’)，却只走一次 if…else…？<br>答案是：柯里化。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> handleOption = (<span class="function">(<span class="params">param</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;从始至终只用执行一次 if...else...&#x27;</span>)</span><br><span class="line">  <span class="keyword">if</span>(param === <span class="string">&#x27;A&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">()=&gt;</span><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">()=&gt;</span><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;others&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> tmp = <span class="title function_">handleOption</span>(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="title function_">tmp</span>()</span><br><span class="line"><span class="title function_">tmp</span>()</span><br><span class="line"><span class="title function_">tmp</span>()</span><br></pre></td></tr></table></figure><p>控制台打印：<br><img src="/image/%E5%87%BD%E6%95%B0%E6%9F%AF%E9%87%8C%E5%8C%96/1665063384578.png" alt="1665063384578"><br>这样的场景是有实战意义的，当我们做前端兼容时，经常要先判断是来源于哪个环境，再执行某个方法。比如说在 firefox 和 chrome 环境下，添加事件监听是 addEventListener 方法，而在 IE 下，添加事件是 attachEvent 方法；如果每次绑定这个监听，都要判断是来自于哪个环境，那肯定是很费劲。我们通过上述封装的方法，可以做到 一处判断，多次使用。<br>把 ‘A’ 条件先固定下来，也可叫“缓存下来”，后续的函数执行将不再传 ‘A’ 这个参数，实打实的：把多参数转化为单参数，逐个传递。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>我们再设想这样一个场景，现在有一个函数是来做大数计算的：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">calculateFn</span> = (<span class="params">num</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> startTime = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;num;i++)&#123;&#125; <span class="comment">// 大数计算</span></span><br><span class="line">  <span class="keyword">const</span> endTime = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(endTime - startTime)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;Calculate big numbers&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">calculateFn</span>(<span class="number">10_000_000_000</span>)</span><br></pre></td></tr></table></figure><p>这是一个非常耗时的函数，复制代码在控制台看看，需要 8s+<br>如果业务代码中需要多次用到这个大数计算结果，多次调用 calculateFn(10_000_000_000) 肯定是不明智的，太费时。<br>一般的做法就是声明一个全局变量，把运算结果保存下来:<br>比如 const resNums &#x3D; calculateFn(10_000_000_000)<br>如果有多个大数运算呢？沿着这个思路，即声名多个变量：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> resNumsA = <span class="title function_">calculateFn</span>(<span class="number">10_000_000_000</span>)</span><br><span class="line"><span class="keyword">const</span> resNumsB = <span class="title function_">calculateFn</span>(<span class="number">20_000_000_000</span>)</span><br><span class="line"><span class="keyword">const</span> resNumsC = <span class="title function_">calculateFn</span>(<span class="number">30_000_000_000</span>)</span><br></pre></td></tr></table></figure><p>我们讲就是说：奥卡姆剃刀原则 —— 如无必要、勿增实体。<br>申明这么多全局变量，先不谈占内存、占命名空间这事，就把 calculateFn() 函数的参数和声名的常量名一一对应，都是一个麻烦事。<br>有没有什么办法？只用函数，不增加多个全局常量，就实现多次调用，只计算一次？<br>答案是：柯里化。<br>代码如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">cached</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> cacheObj = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="literal">null</span>); <span class="comment">// 创建一个对象</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">cachedFn</span> (str) &#123; <span class="comment">// 返回回调函数</span></span><br><span class="line">    <span class="keyword">if</span> ( !cacheObj [str] ) &#123; <span class="comment">// 在对象里面查询，函数结果是否被计算过</span></span><br><span class="line">      <span class="keyword">let</span> result = <span class="title function_">fn</span>(str);</span><br><span class="line">      cacheObj [str] = result; <span class="comment">// 没有则要执行原函数，并把计算结果缓存起来</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cacheObj [str] <span class="comment">// 被缓存过，直接返回</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">calculateFn</span> = (<span class="params">num</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;计算即缓存&quot;</span>)</span><br><span class="line">  <span class="keyword">const</span> startTime = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;num;i++)&#123;&#125; <span class="comment">// 大数计算</span></span><br><span class="line">  <span class="keyword">const</span> endTime = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(endTime - startTime) <span class="comment">// 耗时</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;Calculate big numbers&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> cashedCalculate = <span class="title function_">cached</span>(calculateFn) </span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">cashedCalculate</span>(<span class="number">10_000_000_000</span>)) <span class="comment">// 计算即缓存 // 9944 // Calculate big numbers</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">cashedCalculate</span>(<span class="number">10_000_000_000</span>)) <span class="comment">// Calculate big numbers</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">cashedCalculate</span>(<span class="number">20_000_000_000</span>)) <span class="comment">// 计算即缓存 // 22126 // Calculate big numbers</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">cashedCalculate</span>(<span class="number">20_000_000_000</span>)) <span class="comment">// Calculate big numbers</span></span><br></pre></td></tr></table></figure><p>这样只用通过一个 cached 缓存函数的处理，所有的大数计算都能保证：输入参数相同的情况下，全局只用计算一次，后续可直接使用更加语义话的函数调用来得到之前计算的结果。<br>此处也是柯里化的应用，在 cached 函数中先传需要处理的函数参数，后续再传入具体需要操作得值，将多参转化为单个参数逐一传入。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>柯里化的思想不仅可以缓存判断条件，缓存计算结果、缓存传参，还能缓存“函数”。<br>设想，我们有一个数字 7 要经过两个函数的计算，先乘以 10 ，再加 100，写法如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> multi10 = <span class="keyword">function</span>(<span class="params">x</span>) &#123; <span class="keyword">return</span> x * <span class="number">10</span>; &#125;</span><br><span class="line"><span class="keyword">const</span> add100 = <span class="keyword">function</span>(<span class="params">x</span>) &#123; <span class="keyword">return</span> x + <span class="number">100</span>; &#125;</span><br><span class="line"><span class="title function_">add100</span>(<span class="title function_">multi10</span>(<span class="number">7</span>))</span><br></pre></td></tr></table></figure><p>用柯里化处理后，即变成：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> multi10 = <span class="keyword">function</span>(<span class="params">x</span>) &#123; <span class="keyword">return</span> x * <span class="number">10</span>; &#125;</span><br><span class="line"><span class="keyword">const</span> add100 = <span class="keyword">function</span>(<span class="params">x</span>) &#123; <span class="keyword">return</span> x + <span class="number">100</span>; &#125;</span><br><span class="line"><span class="keyword">const</span> compose = <span class="keyword">function</span>(<span class="params">f,g</span>) &#123; </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">x</span>) &#123; </span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">f</span>(<span class="title function_">g</span>(x))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">compose</span>(add100, multi10)(<span class="number">7</span>)</span><br></pre></td></tr></table></figure><p>前者写法有两个传参是写在一起的，而后者则逐一传参。把最后的执行函数改写：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> compute = <span class="title function_">compose</span>(add100, multi10)</span><br><span class="line"><span class="title function_">compute</span>(<span class="number">7</span>)</span><br></pre></td></tr></table></figure><p>所以，这里的柯里化直接把函数处理给缓存了，当声明 compute 变量时，并没有执行操作，只是为了拿到 ()&#x3D;&gt; f(g(x))，最后执行 compute(7)，才会执行整个运算；</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="函数式编程的优点"><a href="#函数式编程的优点" class="headerlink" title="函数式编程的优点"></a>函数式编程的优点</h2><ul><li><p><strong>代码简洁，开发快速</strong></p><blockquote><p>函数式编程大量使用函数的组合，函数的复用率很高，减少了代码的重复，因此程序比较短，开发速度较快。Paul Graham 在《黑客与画家》一书中写道：同样功能的程序，极端情况下，Lisp 代码的长度可能是 C 代码的二十分之一。</p></blockquote></li><li><p><strong>接近自然语言，易于理解</strong></p><blockquote><p>函数式编程大量使用声明式代码，基本都是接近自然语言的，加上它没有乱七八糟的循环，判断的嵌套，因此特别易于理解。</p></blockquote></li><li><p><strong>易于”并发编程”</strong></p><blockquote><p>函数式编程没有副作用，所以函数式编程不需要考虑“死锁”（Deadlock），所以根本不存在“锁”线程的问题。</p></blockquote></li><li><p><strong>更少的出错概率</strong></p><blockquote><p>因为每个函数都很小，而且相同输入永远可以得到相同的输出，因此测试很简单，同时函数式编程强调使用纯函数，没有副作用，因此也很少出现奇怪的 Bug。</p></blockquote></li></ul><h2 id="函数式编程的缺陷"><a href="#函数式编程的缺陷" class="headerlink" title="函数式编程的缺陷"></a>函数式编程的缺陷</h2><ul><li><p><strong>性能</strong></p><blockquote><p>函数式编程相对于指令式编程，性能绝对是一个短板，因为它往往会对一个方法进行过度包装，从而产生上下文切换的性能开销。同时，在 JS 这种非函数式语言中，函数式的方式必然会比直接写语句指令慢（引擎会针对很多指令做特别优化）。就拿原生方法 map 来说，它就要比纯循环语句实现迭代慢 8 倍。</p></blockquote></li><li><p><strong>资源占用</strong></p><blockquote><p>在 JS 中为了实现对象状态的不可变，往往会创建新的对象，因此，它对垃圾回收（Garbage Collection）所产生的压力远远超过其他编程方式。这在某些场合会产生十分严重的问题。</p></blockquote></li><li><p><strong>递归陷阱</strong></p><blockquote><p>在函数式编程中，为了实现迭代，通常会采用递归操作，为了减少递归的性能开销，我们往往会把递归写成尾递归形式，以便让解析器进行优化。但是众所周知，JS 是不支持尾递归优化的（虽然 ES6 中将尾递归优化作为了一个规范，但是真正实现的少之又少，传送门）<br>因此，在性能要求很严格的场合，函数式编程其实并不是太合适的选择。</p></blockquote></li></ul><p>我们完全可以在日常工作中将函数式编程作为一种辅助手段，在条件允许的前提下，借鉴函数式编程中的思路，例如：</p><ul><li>多使用纯函数减少副作用的影响。</li><li>使用柯里化增加函数适用率。</li><li>使用 Pointfree 编程风格，减少无意义的中间变量，让代码更且可读性。</li><li>……</li></ul><h2 id="实践经验"><a href="#实践经验" class="headerlink" title="实践经验"></a>实践经验</h2><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">柯里化中把要操作的数据放到最后</button></li><li class="tab"><button type="button" data-href="#super-2">函数组合中函数要求单输入</button></li><li class="tab"><button type="button" data-href="#super-3">函数组合的 Debug</button></li><li class="tab"><button type="button" data-href="#super-4">多参考 Ramda</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>因为我们的输出通常是需要操作的数据，这样当我们固定了之前的参数（我们可以称为配置）后，可以变成一个单元函数，直接被函数组合使用，这也是其他的函数式语言遵循的规范：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> split = <span class="title function_">curry</span>(<span class="function">(<span class="params">x, str</span>) =&gt;</span> str.<span class="title function_">split</span>(x));</span><br><span class="line"><span class="keyword">const</span> join = <span class="title function_">curry</span>(<span class="function">(<span class="params">x, arr</span>) =&gt;</span> arr.<span class="title function_">join</span>(x));</span><br><span class="line"><span class="keyword">const</span> replaceSpaceWithComma = <span class="title function_">compose</span>(<span class="title function_">join</span>(<span class="string">&#x27;,&#x27;</span>), <span class="title function_">split</span>(<span class="string">&#x27; &#x27;</span>));</span><br><span class="line"><span class="keyword">const</span> replaceCommaWithDash = <span class="title function_">compose</span>(<span class="title function_">join</span>(<span class="string">&#x27;-&#x27;</span>), <span class="title function_">split</span>(<span class="string">&#x27;,&#x27;</span>));</span><br></pre></td></tr></table></figure><p>但是如果有些函数没遵循这个约定，我们的函数该如何组合？当然也不是没办法，很多库都提供了占位符的概念，例如 Ramda 提供了一个占位符号（R.__）。假设我们的 split 把 str 放在首位</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> split = <span class="title function_">curry</span>(<span class="function">(<span class="params">str, x</span>) =&gt;</span> str.<span class="title function_">split</span>(x));</span><br><span class="line"><span class="keyword">const</span> replaceSpaceWithComma = <span class="title function_">compose</span>(<span class="title function_">join</span>(<span class="string">&#x27;,&#x27;</span>), <span class="title function_">split</span>(R.<span class="property">__</span>, <span class="string">&#x27; &#x27;</span>));</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>函数组合有个使用要点，就是中间的函数一定是单输入的，这个很好理解，之前也说过了，因为函数的输出都是单个的（数组也只是一个元素）。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>当遇到函数出错的时候怎么办？我们想知道在哪个环节出错了，这时候，我们可以借助一个辅助函数 trace，它会临时输出当前阶段的结果。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> trace = <span class="title function_">curry</span>(<span class="function">(<span class="params">tip, x</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(tip, x);</span><br><span class="line">  <span class="keyword">return</span> x;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">const</span> lastUppder = <span class="title function_">compose</span>(toUpperCase, head, <span class="title function_">trace</span>(<span class="string">&#x27;after reverse&#x27;</span>), reverse);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>现有的函数式编程工具库很多，Lodash&#x2F;fp 也提供了，但是不是很推荐使用 Lodash&#x2F;fp 的函数库，因为它的很多函数把需要处理的参数放在了首位（ 例如 map）这不符合我们之前说的最佳实践。<br>这里推荐使用 Ramda，它应该是目前最符合函数式编程的工具库，它里面的所有函数都是 curry 的，而且需要操作的参数都是放在最后的。上述的 split，join，replace 这些基本的都在 Ramda 中可以直接使用，它一共提供了 200 多个超实用的函数，合理使用可以大大提高你的编程效率（目前我的个人经验来说，我需要的功能它 90%都提供了）。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 函数式编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 函数柯里化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据类型判断方法</title>
      <link href="/posts/198fa1b/"/>
      <url>/posts/198fa1b/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">typeof</button></li><li class="tab"><button type="button" data-href="#super-2">instanceof</button></li><li class="tab"><button type="button" data-href="#super-3">.constructor</button></li><li class="tab"><button type="button" data-href="#super-4">instanceof、constructor的注意事项</button></li><li class="tab"><button type="button" data-href="#super-5">Object.prototype.toString.call()</button></li><li class="tab"><button type="button" data-href="#super-6">duck-typing</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>可用于判断<strong>基本数据类型</strong></p><p>对于原始数据类型来说，除了null都可以显示正确的类型</p><ul><li>对于null，返回object<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// null 的数据类型被 typeof 解释为object</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="literal">null</span>);            <span class="comment">// object</span></span><br></pre></td></tr></table></figure></li><li>除了function以外的引用类型，都会返回object</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>可用于判断<strong>引用数据类型</strong><br>instanceof实现原理</p><blockquote><p>内部机制是测试构造函数的 prototype 属性是否出现在对象原型链中的任何位置。</p></blockquote><p>实现 instanceof：</p><blockquote><ol><li>首先获取类型的原型</li><li>然后获得对象的原型</li><li>然后一直循环判断对象的原型是否等于类型的原型，直到对象原型为 null，因为原型链最终为 null</li></ol></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">myInstanceof</span>(<span class="params">left, right</span>) &#123;</span><br><span class="line">  <span class="comment">// 1.1 如果是基本数据类型</span></span><br><span class="line">  <span class="keyword">const</span> baseType = [<span class="string">&#x27;string&#x27;</span>, <span class="string">&#x27;number&#x27;</span>, <span class="string">&#x27;boolean&#x27;</span>, <span class="string">&#x27;undefined&#x27;</span>, <span class="string">&#x27;symblo&#x27;</span>]</span><br><span class="line">  <span class="keyword">if</span> (baseType.<span class="title function_">includes</span>(<span class="keyword">typeof</span> left)) <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 1.2 如果是引用类型</span></span><br><span class="line">  <span class="keyword">let</span> _prototype = right.<span class="property"><span class="keyword">prototype</span></span></span><br><span class="line">  left = left.<span class="property">proto</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 2. 迭代</span></span><br><span class="line">  <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (left === <span class="literal">null</span> || left === <span class="literal">undefined</span>) <span class="comment">//直至最后一个，__proto__为null，即(Object.prptptype.__prpto__ = null)</span></span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>  </span><br><span class="line">    <span class="keyword">if</span> (_prototype === left)</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>  </span><br><span class="line">    left = left.<span class="property">proto</span> <span class="comment">//该层未找到，继续往上找</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>((<span class="number">2</span>).<span class="property">constructor</span> === <span class="title class_">Number</span>); <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>((<span class="literal">true</span>).<span class="property">constructor</span> === <span class="title class_">Boolean</span>); <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>((<span class="string">&#x27;str&#x27;</span>).<span class="property">constructor</span> === <span class="title class_">String</span>); <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(([]).<span class="property">constructor</span> === <span class="title class_">Array</span>); <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>((<span class="keyword">function</span>(<span class="params"></span>) &#123;&#125;).<span class="property">constructor</span> === <span class="title class_">Function</span>); <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>((&#123;&#125;).<span class="property">constructor</span> === <span class="title class_">Object</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>constructor在某些场景下失效</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">更改对象原型</button></li><li class="tab"><button type="button" data-href="#super-2">有原型时失效</button></li><li class="tab"><button type="button" data-href="#super-3">多重继承时失效</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>创建了一个对象，并更改它的原型，<strong>constructor</strong>就无法做出准确的判断</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Fn</span>(<span class="params"></span>) &#123;&#125;;</span><br><span class="line"><span class="title class_">Fn</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="keyword">new</span> <span class="title class_">Array</span>();</span><br><span class="line"><span class="keyword">var</span> f = <span class="keyword">new</span> <span class="title class_">Fn</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(f.<span class="property">constructor</span> === <span class="title class_">Fn</span>);    <span class="comment">// false</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(f.<span class="property">constructor</span> === <span class="title class_">Array</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Foo</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"><span class="title class_">Foo</span>.<span class="property"><span class="keyword">prototype</span></span> = &#123;</span><br><span class="line"><span class="attr">method1</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title function_">alert</span>(<span class="keyword">new</span> <span class="title class_">Foo</span>().<span class="property">constructor</span>.<span class="property">name</span>); <span class="comment">// Object</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">a</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">b</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">b.<span class="property"><span class="keyword">prototype</span></span> = <span class="keyword">new</span> <span class="title function_">a</span>(); <span class="comment">// b 继承 a</span></span><br><span class="line"><span class="keyword">let</span> f = <span class="keyword">new</span> <span class="title function_">b</span>();</span><br><span class="line"><span class="title function_">alert</span>(f.<span class="property">constructor</span> === b); <span class="comment">// false</span></span><br><span class="line"><span class="title function_">alert</span>(f.<span class="property">constructor</span> === a); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p><code>constructor</code> 和 <code>instanceof</code> 作为两种检测数据类型的方法，仍然存在一些漏洞</p><blockquote><p>由于每一个 <code>frame</code>都有自己的一套执行环境，跨 <code>frame</code>实例化的对象彼此并不共享原型链，通过 <code>instanceof</code>操作符和 <code>constructor</code>属性检测的方法会失败。<br><code>instanceof</code>和 <code>constructor</code>不可跨 <code>frame</code><br>需要在同个 <code>frame</code>中才有效。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建iframe并添加到DOM中</span></span><br><span class="line"><span class="keyword">var</span> iframe = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;iframe&#x27;</span>);<span class="comment">// 创建iframe</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(iframe);<span class="comment">// 将创建的iframe添加到body中</span></span><br><span class="line">xArray = <span class="variable language_">window</span>.<span class="property">frames</span>[<span class="variable language_">window</span>.<span class="property">frames</span>.<span class="property">length</span> -<span class="number">1</span>].<span class="property">Array</span>;</span><br><span class="line"><span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="title function_">xArray</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>); <span class="comment">// 声明数组[1, 2, 3]</span></span><br><span class="line"><span class="title function_">alert</span>(arr <span class="keyword">instanceof</span> <span class="title class_">Array</span>); <span class="comment">// false</span></span><br><span class="line"><span class="title function_">alert</span>(arr.<span class="property">constructor</span> === <span class="title class_">Array</span>); <span class="comment">// false</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p>使用 <code>Object</code> 对象的原型方法 <code>toString</code> ，使用 <code>call</code> 进行狸猫换太子</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a.<span class="title function_">call</span>(<span class="number">2</span>));             <span class="comment">// [object Number]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a.<span class="title function_">call</span>(<span class="literal">true</span>));          <span class="comment">// [object Boolean]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a.<span class="title function_">call</span>(<span class="string">&#x27;str&#x27;</span>));         <span class="comment">// [object String]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a.<span class="title function_">call</span>([]));            <span class="comment">// [object Array]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a.<span class="title function_">call</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;));  <span class="comment">// [object Function]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a.<span class="title function_">call</span>(&#123;&#125;));            <span class="comment">// [object Object]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a.<span class="title function_">call</span>(<span class="literal">undefined</span>));     <span class="comment">// [object Undefined]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a.<span class="title function_">call</span>(<span class="literal">null</span>));          <span class="comment">// [object Null]</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-6"><p>只检测特定的属性，如果存在，则认为是该类型</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">isArray</span>(<span class="params">object</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> object != <span class="literal">null</span> &amp;&amp; <span class="keyword">typeof</span> object === <span class="string">&#x27;object&#x27;</span> &amp;&amp; <span class="string">&#x27;splice&#x27;</span> <span class="keyword">in</span> object &amp;&amp; <span class="string">&#x27;join&#x27;</span> <span class="keyword">in</span> object;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isArray</span>(<span class="params">arr</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> !!arr &amp;&amp; arr.<span class="property">constructor</span> == <span class="title class_">Array</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p><img src="/image/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%88%A4%E6%96%AD%E6%96%B9%E6%B3%95/1663680446396.png" alt="1663680446396"></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> ECMAScript基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据类型 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据类型转换方式</title>
      <link href="/posts/7af85a27/"/>
      <url>/posts/7af85a27/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="数据类型的转换方式"><a href="#数据类型的转换方式" class="headerlink" title="数据类型的转换方式"></a>数据类型的转换方式</h3><p>在 JS 中，类型转换只有三种情况，分别是：</p><ul><li><p>转换为布尔值</p><ul><li><table><thead><tr><th>方式</th><th>说明</th><th>示例</th></tr></thead><tbody><tr><td>Boolean()</td><td>其他类型转换成布尔值（强制转换）</td><td>Boolean(‘true’)</td></tr></tbody></table></li></ul></li><li><p>转换为数值型</p><ul><li><table><thead><tr><th>方式</th><th>说明</th><th>示例</th></tr></thead><tbody><tr><td>parseInt()</td><td>将string型转换成整型数值型</td><td>parseInt(‘28’)</td></tr><tr><td>parseFloat()</td><td>将string型转换成浮点数数值型</td><td>parseFloat(‘28.12’)</td></tr><tr><td>Number()</td><td>将string型转换成数值型（强制转换）</td><td>Number(‘12’)</td></tr><tr><td>算术运算符（- * &#x2F;）</td><td>利用算术运算隐式转换为数值型</td><td>let s &#x3D; ‘abc’-0;<br />console.log(s);</td></tr></tbody></table></li></ul></li><li><p>转换为字符串</p><ul><li><table><thead><tr><th>方式</th><th>说明</th><th>示例</th></tr></thead><tbody><tr><td>.toString()</td><td>转换成字符串</td><td>var num&#x3D;1;<br />alert(num.toString());</td></tr><tr><td>String()</td><td>转换成字符串（强制转换）</td><td>var num&#x3D;1;<br />alert(String(num));</td></tr><tr><td><code>+</code>号拼接字符串</td><td>任意类型和字符串拼接，<br />结果都是字符串</td><td>let s &#x3D; 4 + ‘px’ + 5;<br />console.log(s);</td></tr></tbody></table></li><li><code>null</code>和 <code>underfined</code>没有 <code>.toString</code>方法</li><li>Number类型的toString()方法还支持第二个参数，指定要转换的进制。<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> n = <span class="number">20</span>;</span><br><span class="line"><span class="title function_">alert</span>(n.<span class="title function_">toString</span>(<span class="number">2</span>));<span class="comment">// 转成二进制“10100”</span></span><br><span class="line"><span class="title function_">alert</span>(n.<span class="title function_">toString</span>(<span class="number">8</span>)); <span class="comment">// 转成八进制“24&quot;</span></span><br><span class="line"><span class="title function_">alert</span>(n.<span class="title function_">toString</span>(<span class="number">16</span>));<span class="comment">// 转成十六进制“14”</span></span><br></pre></td></tr></table></figure></li></ul></li></ul><p>Number类型转换为字符串还有三个方法:toFixed()、toExponential()和toPrecision()。</p><p><img src="/image/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E6%96%B9%E5%BC%8F/1663643268887.png" alt="1663643268887"></p><p><img src="/image/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E6%96%B9%E5%BC%8F/1663643277903.png" alt="1663643277903"></p><p><img src="/image/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E6%96%B9%E5%BC%8F/1663643282601.png" alt="1663643282601"></p><p>相等性(&#x3D;&#x3D;)</p><p>&#x3D;&#x3D;运算符会有类型转换，&#x3D;&#x3D;&#x3D;运算符不会进行类型转换。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">alert</span>(<span class="literal">null</span> == <span class="literal">undefined</span>);<span class="comment">// 相等</span></span><br><span class="line"><span class="title function_">alert</span>(<span class="string">&#x27;0&#x27;</span>== <span class="number">0</span>); <span class="comment">// 在比较之前，字符串转换成数值</span></span><br><span class="line"><span class="title function_">alert</span>(<span class="number">0</span> == <span class="literal">false</span>);<span class="comment">// 在比较之前，布尔转换成数值</span></span><br><span class="line"><span class="title function_">alert</span>(<span class="string">&#x27;0&#x27;</span>== <span class="literal">false</span>);<span class="comment">// 在比较之前，字符串和布尔都转换成数值</span></span><br></pre></td></tr></table></figure><p><img src="file:///C:\Users\ADMINI~1\AppData\Local\Temp\ksohtml12776\wps1.jpg"><img src="/image/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E6%96%B9%E5%BC%8F/1663643680447.png" alt="1663643680447"></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> ECMAScript基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据类型 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ES8新特性</title>
      <link href="/posts/c0488f0a/"/>
      <url>/posts/c0488f0a/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="async-函数"><a href="#async-函数" class="headerlink" title="async 函数"></a>async 函数</h2><p>async 函数的语法：</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">async</span> function <span class="title">fn</span>()</span>&#123;&#125;</span><br></pre></td></tr></table></figure><p>async 函数的返回值：</p><p>返回的结果不是一个 Promise 类型的对象，返回的结果就是成功 Promise 对象<br>返回的结果如果是一个 Promise 对象，具体需要看执行resolve方法还是reject方法<br>抛出错误，返回的结果是一个失败的 Promise<br>async 函数的演示：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//async 函数</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">resolve</span>(<span class="string">&#x27;成功的数据&#x27;</span>);</span><br><span class="line">        <span class="comment">// reject(&quot;失败的错误&quot;);</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;<span class="keyword">const</span> result = <span class="title function_">fn</span>();<span class="comment">//调用 then 方法</span></span><br><span class="line">result.<span class="title function_">then</span>(<span class="function"><span class="params">value</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(value);</span><br><span class="line">&#125;, <span class="function"><span class="params">reason</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">warn</span>(reason);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="await-表达式"><a href="#await-表达式" class="headerlink" title="await 表达式"></a>await 表达式</h2><p>async 和 await 两种语法结合可以让异步代码像同步代码一样</p><p>await 表达式的注意事项：</p><p>await 必须写在 async 函数中<br>await 右侧的表达式一般为 promise 对象<br>await 返回的是 promise 成功的值<br>await 的 promise 失败了, 就会抛出异常, 需要通过 try…catch 捕获处理<br>await 表达式的语法演示：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建 promise 对象</span></span><br><span class="line"><span class="keyword">const</span> p = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">resolve</span>(<span class="string">&quot;用户数据&quot;</span>);</span><br><span class="line">    <span class="comment">//reject(&quot;失败啦!&quot;);</span></span><br><span class="line">&#125;)<span class="comment">//await 要放在 async 函数中.</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fun</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> result = <span class="keyword">await</span> p;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="comment">//调用函数</span></span><br><span class="line"><span class="title function_">fun</span>();</span><br></pre></td></tr></table></figure><p>await 表达式的案例演示：async与await封装AJAX请求</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 发送 AJAX 请求, 返回的结果是 Promise 对象</span></span><br><span class="line"><span class="keyword">function</span> send<span class="constructor">AJAX(<span class="params">url</span>)</span> &#123;</span><br><span class="line">    return <span class="keyword">new</span> <span class="constructor">Promise((<span class="params">resolve</span>, <span class="params">reject</span>)</span> =&gt; &#123;</span><br><span class="line">        <span class="comment">//1. 创建对象</span></span><br><span class="line">        const x = <span class="keyword">new</span> <span class="constructor">XMLHttpRequest()</span>;</span><br><span class="line">        <span class="comment">//2. 初始化</span></span><br><span class="line">        x.<span class="keyword">open</span>(&#x27;GET&#x27;, url);</span><br><span class="line">        <span class="comment">//3. 发送</span></span><br><span class="line">        x.send<span class="literal">()</span>;</span><br><span class="line">        <span class="comment">//4. 事件绑定</span></span><br><span class="line">        x.onreadystatechange = <span class="keyword">function</span> <span class="literal">()</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (x.readyState<span class="operator"> === </span><span class="number">4</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (x.status &gt;= <span class="number">200</span><span class="operator"> &amp;&amp; </span>x.status &lt; <span class="number">300</span>) &#123;</span><br><span class="line">                    resolve(x.response);<span class="comment">//成功</span></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    reject(x.status);<span class="comment">//失败</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;<span class="comment">// async 与 await 测试</span></span><br><span class="line">async <span class="keyword">function</span> <span class="keyword">fun</span><span class="literal">()</span> &#123;</span><br><span class="line">    <span class="comment">//发送 AJAX 请求 1</span></span><br><span class="line">    <span class="keyword">let</span> joke = await send<span class="constructor">AJAX(<span class="string">&quot;https://api.apiopen.top/getJoke&quot;</span>)</span>;</span><br><span class="line">    <span class="comment">//发送 AJAX 请求 2</span></span><br><span class="line">    <span class="keyword">let</span> tianqi = await send<span class="constructor">AJAX(&#x27;<span class="params">https</span>:<span class="operator">/</span><span class="operator">/</span><span class="params">www</span>.<span class="params">tianqiapi</span>.<span class="params">com</span><span class="operator">/</span><span class="params">api</span><span class="operator">/</span>?<span class="params">version</span>=<span class="params">v1</span>&amp;<span class="params">city</span>=%E5%8C%97%E4%BA%AC&amp;<span class="params">appid</span>=23941491&amp;<span class="params">appsecret</span>=TXoD5e8P&#x27;)</span>    console.log(joke);</span><br><span class="line">    console.error(tianqi);<span class="comment">//为了区别数据，我这里用红色的error输出</span></span><br><span class="line">&#125;<span class="comment">// 调用函数</span></span><br><span class="line"><span class="keyword">fun</span><span class="literal">()</span>;</span><br></pre></td></tr></table></figure><h2 id="对象方法拓展"><a href="#对象方法拓展" class="headerlink" title="对象方法拓展"></a>对象方法拓展</h2><p>Object.keys()方法返回一个给定对象的所有可枚举键值的数组<br>Object.values()方法返回一个给定对象的所有可枚举属性值的数组<br>Object.entries()方法返回一个给定对象自身可遍历属性 [key,value] 的数组</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//声明对象</span></span><br><span class="line"><span class="keyword">const</span> person = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">20</span></span><br><span class="line">&#125;;<span class="comment">//获取对象所有的键</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">keys</span>(person));</span><br><span class="line"><span class="comment">//获取对象所有的值</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">values</span>(person));</span><br><span class="line"><span class="comment">//获取对象所有的键值对数组</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">entries</span>(person));</span><br><span class="line"><span class="comment">//创建 Map</span></span><br><span class="line"><span class="keyword">const</span> m = <span class="keyword">new</span> <span class="title class_">Map</span>(<span class="title class_">Object</span>.<span class="title function_">entries</span>(person));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(m.<span class="title function_">get</span>(<span class="string">&quot;name&quot;</span>));</span><br></pre></td></tr></table></figure><p>Object.getOwnPropertyDescriptors方法返回指定对象所有自身属性的描述对象</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//声明对象</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">person</span> = &#123;</span><br><span class="line">    name: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">    age: <span class="number">20</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//对象属性的描述对象</span></span><br><span class="line">console.<span class="title function_ invoke__">log</span>(Object.<span class="title function_ invoke__">getOwnPropertyDescriptors</span>(person));<span class="comment">//声明对象</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">obj</span> = Object.<span class="title function_ invoke__">create</span>(<span class="literal">null</span>, &#123;</span><br><span class="line">    <span class="attr">name</span>: &#123;</span><br><span class="line">        //设置值</span><br><span class="line">        <span class="attr">value</span>: <span class="string">&quot;李四&quot;</span>,</span><br><span class="line">        //属性特性</span><br><span class="line">        <span class="attr">writable</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">configurable</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">enumerable</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">age</span>: &#123;</span><br><span class="line">        //设置值</span><br><span class="line">        <span class="attr">value</span>: <span class="number">21</span>,</span><br><span class="line">        //属性特性</span><br><span class="line">        <span class="attr">writable</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">configurable</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">enumerable</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//对象属性的描述对象</span></span><br><span class="line">console.<span class="title function_ invoke__">log</span>(Object.<span class="title function_ invoke__">getOwnPropertyDescriptors</span>(obj));</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> ES新特性 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ES新特性 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ES9新特性</title>
      <link href="/posts/2f8ae434/"/>
      <url>/posts/2f8ae434/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="对象拓展"><a href="#对象拓展" class="headerlink" title="对象拓展"></a>对象拓展</h2><p>Rest 参数与 spread 扩展运算符在 ES6 中已经引入，不过 ES6 中只针对于数组，在 ES9 中为对象提供了像数组一样的 rest 参数和扩展运算符</p><h3 id="对象展开"><a href="#对象展开" class="headerlink" title="对象展开"></a>对象展开</h3><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">connect</span><span class="params">(&#123;host, port, <span class="rest_arg">...user</span>&#125;)</span> &#123;</span><br><span class="line">    console.log(host);</span><br><span class="line">    console.log(port);</span><br><span class="line">    console.log(user);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">connect(&#123;</span><br><span class="line">    host: <span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">    port: <span class="number">3306</span>,</span><br><span class="line">    username: <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">    password: <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">    type: <span class="string">&#x27;master&#x27;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="对象合并"><a href="#对象合并" class="headerlink" title="对象合并"></a>对象合并</h3><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> skillOne = &#123;</span><br><span class="line">    q: <span class="string">&#x27;天音波&#x27;</span></span><br><span class="line">&#125;<span class="comment">;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> skillTwo = &#123;</span><br><span class="line">    w: <span class="string">&#x27;金钟罩&#x27;</span></span><br><span class="line">&#125;<span class="comment">;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> skillThree = &#123;</span><br><span class="line">    e: <span class="string">&#x27;天雷破&#x27;</span></span><br><span class="line">&#125;<span class="comment">;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> skillFour = &#123;</span><br><span class="line">    r: <span class="string">&#x27;猛龙摆尾&#x27;</span></span><br><span class="line">&#125;<span class="comment">;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mangseng = &#123;...skillOne, ...skillTwo, ...skillThree, ...skillFour&#125;<span class="comment">;</span></span><br><span class="line">console.<span class="built_in">log</span>(mangseng)<span class="comment">;</span></span><br></pre></td></tr></table></figure><h2 id="正则表达式拓展"><a href="#正则表达式拓展" class="headerlink" title="正则表达式拓展"></a>正则表达式拓展</h2><h3 id="命名捕获分组"><a href="#命名捕获分组" class="headerlink" title="命名捕获分组"></a>命名捕获分组</h3><p>ES9 允许命名捕获组使用符号 ?<code>&lt;name&gt;</code> ，这样获取捕获结果可读性更强。使用数组下标不好吗？的确不好，因为如果一旦你想要获取的元素一旦增加，数组下标就改变了，所以建议使用命名捕获分组</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">let str = &#x27;&lt;a href=<span class="string">&quot;https://www.baidu.com&quot;</span>&gt;打开百度，你就知道！&lt;/a&gt;&#x27;;</span><br><span class="line">const reg = /&lt;a href=<span class="string">&quot;(?&lt;url&gt;.*)&quot;</span>&gt;(?&lt;<span class="built_in">text</span>&gt;.*)&lt;\/a&gt;/;</span><br><span class="line">const <span class="literal">result</span> = reg.exec(str);</span><br><span class="line">console.<span class="built_in">log</span>(<span class="literal">result</span>.groups.url);</span><br><span class="line">console.<span class="built_in">log</span>(<span class="literal">result</span>.groups.<span class="built_in">text</span>);</span><br></pre></td></tr></table></figure><h3 id="正向断言"><a href="#正向断言" class="headerlink" title="正向断言"></a>正向断言</h3><p>ES9 支持正向断言，通过对匹配结果后面的内容进行判断，对匹配进行筛选。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//声明字符串</span></span><br><span class="line"><span class="keyword">let</span> str = <span class="string">&quot;订单编号开始123456789订单编号结束&quot;</span>;</span><br><span class="line"><span class="comment">//正向断言</span></span><br><span class="line"><span class="keyword">const</span> reg = <span class="regexp">/\d+(?=订单编号结束)/</span>;<span class="comment">//也就是说数字的后边一定要跟着 订单编号结束</span></span><br><span class="line"><span class="keyword">const</span> result = reg.<span class="title function_">exec</span>(str);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br></pre></td></tr></table></figure><h3 id="反向断言"><a href="#反向断言" class="headerlink" title="反向断言"></a>反向断言</h3><p>ES9 支持反向断言，通过对匹配结果前面的内容进行判断，对匹配进行筛选。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//声明字符串</span></span><br><span class="line"><span class="keyword">let</span> str = <span class="string">&quot;订单编号开始123456789订单编号结束&quot;</span>;</span><br><span class="line"><span class="comment">//正向断言</span></span><br><span class="line"><span class="keyword">const</span> reg = <span class="regexp">/(?&lt;=订单编号开始)\d+/</span>;<span class="comment">//也就是说数字的前边一定要跟着 订单编号开始</span></span><br><span class="line"><span class="keyword">const</span> result = reg.<span class="title function_">exec</span>(str);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br></pre></td></tr></table></figure><h3 id="dotAll模式"><a href="#dotAll模式" class="headerlink" title="dotAll模式"></a>dotAll模式</h3><p>正则表达式中点 . 匹配除回车外的任何单字符，标记 s 改变这种行为，允许行终止符出现，也就是dotAll模式</p><figure class="highlight bnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">let str = </span><br><span class="line">`<span class="attribute">&lt;ul&gt;</span></span><br><span class="line">     <span class="attribute">&lt;li&gt;</span></span><br><span class="line">         <span class="attribute">&lt;a&gt;</span>肖生克的救赎<span class="attribute">&lt;/a&gt;</span></span><br><span class="line">         <span class="attribute">&lt;p&gt;</span>上映日期: 1994-09-10<span class="attribute">&lt;/p&gt;</span></span><br><span class="line">         <span class="attribute">&lt;/li&gt;</span></span><br><span class="line">     <span class="attribute">&lt;li&gt;</span></span><br><span class="line">         <span class="attribute">&lt;a&gt;</span>阿甘正传<span class="attribute">&lt;/a&gt;</span></span><br><span class="line">         <span class="attribute">&lt;p&gt;</span>上映日期: 1994-07-06<span class="attribute">&lt;/p&gt;</span></span><br><span class="line">     <span class="attribute">&lt;/li&gt;</span></span><br><span class="line"><span class="attribute">&lt;/ul&gt;</span>`;</span><br><span class="line"></span><br><span class="line">//声明正则</span><br><span class="line">const reg = /<span class="attribute">&lt;li&gt;</span>.*?<span class="attribute">&lt;a&gt;</span>(.*?)<span class="attribute">&lt;\/a&gt;</span>.*?<span class="attribute">&lt;p&gt;</span>(.*?)<span class="attribute">&lt;\/p&gt;</span>/gs;</span><br><span class="line"></span><br><span class="line">// 执行匹配</span><br><span class="line">let result;</span><br><span class="line">let data = [];</span><br><span class="line">while (result = reg.exec(str)) &#123;</span><br><span class="line">    data.push(&#123;title: result[1], time: result[2]&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//输出结果</span><br><span class="line">console.log(data);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> ES新特性 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ES新特性 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ES10新特性</title>
      <link href="/posts/ec010a4e/"/>
      <url>/posts/ec010a4e/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="对象方法拓展"><a href="#对象方法拓展" class="headerlink" title="对象方法拓展"></a>对象方法拓展</h2><p>Object.fromEntries()方法是Object.entries()的逆操作，用于将一个键值对数组转为对象。</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ES6：Map</span></span><br><span class="line"><span class="comment">//ES10：Object.fromEntries</span></span><br><span class="line"><span class="keyword">const</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line">m.<span class="keyword">set</span>(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;张三&quot;</span>);</span><br><span class="line">m.<span class="keyword">set</span>(<span class="string">&quot;age&quot;</span>, <span class="number">20</span>);</span><br><span class="line"><span class="keyword">const</span> result = <span class="built_in">Object</span>.fromEntries(m);</span><br><span class="line">console.log(result);<span class="comment">//ES8：Object.entries</span></span><br><span class="line"><span class="keyword">const</span> arr = <span class="built_in">Object</span>.entries(result);</span><br><span class="line">console.log(arr);</span><br></pre></td></tr></table></figure><h2 id="字符串方法拓展"><a href="#字符串方法拓展" class="headerlink" title="字符串方法拓展"></a>字符串方法拓展</h2><figure class="highlight openscad"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">let</span> <span class="built_in">str</span> = <span class="string">&quot;   iloveyou   &quot;</span>;</span><br><span class="line">console.<span class="built_in">log</span>(<span class="built_in">str</span>.trimStart());<span class="comment">//只去除前边的空格</span></span><br><span class="line">console.<span class="built_in">log</span>(<span class="built_in">str</span>.trimEnd());<span class="comment">//只去除后边的空格</span></span><br></pre></td></tr></table></figure><h2 id="数组方法拓展"><a href="#数组方法拓展" class="headerlink" title="数组方法拓展"></a>数组方法拓展</h2><p>flat() 方法会按照一个可指定的深度递归遍历数组，并将所有元素与遍历到的子数组中的元素合并为一个新数组返回，说白了就是将多维数组转化为低维数组。</p><figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, [<span class="number">5</span>, <span class="number">6</span>]];</span><br><span class="line">console.<span class="built_in">log</span>(arr1.<span class="keyword">flat</span>());</span><br><span class="line"><span class="keyword">const</span> arr2 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, [<span class="number">5</span>, <span class="number">6</span>, [<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]]];</span><br><span class="line">console.<span class="built_in">log</span>(arr2.<span class="keyword">flat</span>());</span><br><span class="line">console.<span class="built_in">log</span>(arr2.<span class="keyword">flat</span>(<span class="number">1</span>));<span class="comment">//参数为深度是一个数字</span></span><br><span class="line">console.<span class="built_in">log</span>(arr2.<span class="keyword">flat</span>(<span class="number">2</span>));<span class="comment">//参数为深度是一个数字</span></span><br></pre></td></tr></table></figure><p>flatMap() 方法首先使用映射函数映射每个元素，然后将结果压缩成一个新数组。它与 map 连着深度值为1的 flat 几乎相同，但 flatMap 通常在合并成一种方法的效率稍微高一些。</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(arr1.<span class="built_in">map</span>(<span class="function"><span class="params">x</span> =&gt;</span> x * <span class="number">2</span>));<span class="keyword">var</span> arr2 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(arr2.flatMap(<span class="function"><span class="params">x</span> =&gt;</span> x * <span class="number">2</span>));</span><br></pre></td></tr></table></figure><h2 id="Symbol属性拓展"><a href="#Symbol属性拓展" class="headerlink" title="Symbol属性拓展"></a>Symbol属性拓展</h2><p>Symbol.prototype.description用来读取Symbol的描述值</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建 Symbol</span></span><br><span class="line"><span class="keyword">let</span> s = <span class="title class_">Symbol</span>(<span class="string">&quot;张三&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(s.<span class="property">description</span>);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> ES新特性 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ES新特性 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ES11新特性</title>
      <link href="/posts/3c36170/"/>
      <url>/posts/3c36170/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="class-私有属性"><a href="#class-私有属性" class="headerlink" title="class 私有属性"></a>class 私有属性</h2><p>私有属性只能在class中访问</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="comment">//公有属性</span></span><br><span class="line">    name;</span><br><span class="line">    <span class="comment">//私有属性</span></span><br><span class="line">    <span class="meta">#age;</span></span><br><span class="line">    <span class="meta">#weight;    <span class="comment">//构造方法</span></span></span><br><span class="line">    <span class="built_in">constructor</span>(name, age, weight) &#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.<span class="meta">#age = age;</span></span><br><span class="line">        <span class="keyword">this</span>.<span class="meta">#weight = weight;</span></span><br><span class="line">    &#125;    <span class="comment">//普通方法</span></span><br><span class="line">    <span class="built_in">intro</span>() &#123;</span><br><span class="line">        console.<span class="built_in">log</span>(<span class="keyword">this</span>.name);</span><br><span class="line">        console.<span class="built_in">log</span>(<span class="keyword">this</span>.<span class="meta">#age);</span></span><br><span class="line">        console.<span class="built_in">log</span>(<span class="keyword">this</span>.<span class="meta">#weight);</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//实例化</span></span><br><span class="line"><span class="type">const</span> girl = <span class="keyword">new</span> <span class="built_in">Person</span>(<span class="string">&quot;小可爱&quot;</span>, <span class="number">18</span>, <span class="string">&quot;45kg&quot;</span>);</span><br><span class="line">girl.<span class="built_in">intro</span>();</span><br></pre></td></tr></table></figure><h2 id="Promise-allSettled"><a href="#Promise-allSettled" class="headerlink" title="Promise.allSettled"></a>Promise.allSettled</h2><p>该Promise.allSettled()方法返回一个在所有给定的promise都已经fulfilled或rejected后的promise，并带有一个对象数组，每个对象表示对应的promise结果。当您有多个彼此不依赖的异步任务成功完成时，或者您总是想知道每个promise的结果时，通常使用它。</p><p>相比之下，Promise.all() 更适合彼此相互依赖或者在其中任何一个reject时立即结束。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//声明两个promise对象</span></span><br><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">resolve</span>(<span class="string">&quot;商品数据 - 1&quot;</span>);</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;);<span class="keyword">const</span> p2 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// resolve(&quot;商品数据 - 2&quot;);</span></span><br><span class="line">        <span class="title function_">reject</span>(<span class="string">&quot;出错啦!&quot;</span>);</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;);<span class="comment">//调用 allsettled 方法</span></span><br><span class="line"><span class="keyword">const</span> result1 = <span class="title class_">Promise</span>.<span class="title function_">allSettled</span>([p1, p2]);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result1);<span class="comment">//调用 all 方法</span></span><br><span class="line"><span class="keyword">const</span> result2 = <span class="title class_">Promise</span>.<span class="title function_">all</span>([p1, p2]);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result2);</span><br></pre></td></tr></table></figure><h2 id="字符串方法扩展"><a href="#字符串方法扩展" class="headerlink" title="字符串方法扩展"></a>字符串方法扩展</h2><p>String.prototype.matchAll() 方法返回一个包含所有匹配正则表达式的结果及分组捕获组的迭代器。</p><figure class="highlight bnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">let str =</span><br><span class="line">`<span class="attribute">&lt;ul&gt;</span></span><br><span class="line">    <span class="attribute">&lt;li&gt;</span></span><br><span class="line">        <span class="attribute">&lt;a&gt;</span>肖生克的救赎<span class="attribute">&lt;/a&gt;</span></span><br><span class="line">        <span class="attribute">&lt;p&gt;</span>上映日期: 1994-09-10<span class="attribute">&lt;/p&gt;</span></span><br><span class="line">    <span class="attribute">&lt;/li&gt;</span></span><br><span class="line">    <span class="attribute">&lt;li&gt;</span></span><br><span class="line">        <span class="attribute">&lt;a&gt;</span>阿甘正传<span class="attribute">&lt;/a&gt;</span></span><br><span class="line">        <span class="attribute">&lt;p&gt;</span>上映日期: 1994-07-06<span class="attribute">&lt;/p&gt;</span></span><br><span class="line">    <span class="attribute">&lt;/li&gt;</span></span><br><span class="line"><span class="attribute">&lt;/ul&gt;</span>`;</span><br><span class="line"></span><br><span class="line">//声明正则</span><br><span class="line">const reg = /<span class="attribute">&lt;li&gt;</span>.*?<span class="attribute">&lt;a&gt;</span>(.*?)<span class="attribute">&lt;\/a&gt;</span>.*?<span class="attribute">&lt;p&gt;</span>(.*?)<span class="attribute">&lt;\/p&gt;</span>/sg;</span><br><span class="line"></span><br><span class="line">//调用方法</span><br><span class="line">const result = str.matchAll(reg);</span><br><span class="line">for (let v of result) &#123;</span><br><span class="line">    console.log(v);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="可选链操作符"><a href="#可选链操作符" class="headerlink" title="可选链操作符"></a>可选链操作符</h2><p>当我们要使用传进来的一个属性值的时候，我们不知道这个属性值到底有没有传，我们可以使用&amp;&amp;运算符一级一级判断，就像这样 const dbHost &#x3D; config &amp;&amp; config.db &amp;&amp; config.db.host;但是这样会显得很麻烦，所以在ES11 中就提供了可选链操作符，它就简化了代码，变成了这样 const dbHost &#x3D; config?.db?.host; 另一方面，即使用户没有传入这个属性，我们用了也不会报错，而是undefined</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">connect</span>(<span class="params">config</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// const dbHost = config &amp;&amp; config.db &amp;&amp; config.db.host;</span></span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">dbHost</span> = config?.db?.host;</span><br><span class="line">    console.<span class="title function_ invoke__">log</span>(dbHost);</span><br><span class="line">&#125;<span class="title function_ invoke__">connect</span>(&#123;</span><br><span class="line">    <span class="attr">db</span>: &#123;</span><br><span class="line">        <span class="attr">host</span>: <span class="string">&quot;192.168.1.100&quot;</span>,</span><br><span class="line">        <span class="attr">username</span>: <span class="string">&quot;root&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">cache</span>: &#123;</span><br><span class="line">        <span class="attr">host</span>: <span class="string">&quot;192.168.1.200&quot;</span>,</span><br><span class="line">        <span class="attr">username</span>: <span class="string">&quot;admin&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="动态-import"><a href="#动态-import" class="headerlink" title="动态 import"></a>动态 import</h2><p>以前我们import 导入模块是在一开始的时候就全部导入了，这样在模块很多的时候，会显得网页速度加载很慢，在ES11中就提供了一种动态import，案例演示如下：</p><p>m1.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//分别暴露</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> school = <span class="string">&quot;华北理工大学&quot;</span>;<span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">study</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;我们要学习！&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>index.html</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;btn&quot;</span>&gt;</span>点击我，加载m1.js模块 <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 在这里写JavaScript代码，因为JavaScript是由上到下执行的 --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;module&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> btn = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;btn&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    btn.<span class="property">onclick</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">import</span>(<span class="string">&quot;./m1.js&quot;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">module</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">module</span>.<span class="title function_">study</span>();</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="BigInt类型"><a href="#BigInt类型" class="headerlink" title="BigInt类型"></a>BigInt类型</h2><p>BigInt数据类型的目的是比Number数据类型支持的范围更大的整数值。在对大整数执行数学运算时，以任意精度表示整数的能力尤为重要。使用BigInt，整数溢出将不再是问题。</p><p>此外，可以安全地使用更加准确时间戳，大整数ID等，而无需使用变通方法。 它就是JS 第二个数字数据类型，也将是 JS 第8种基本数据类型：</p><ul><li>Boolean</li><li>Null</li><li>Undefined</li><li>Number</li><li>BigInt</li><li>String</li><li>Symbol</li><li>Object</li></ul><p>对于学过其它语言的程序员来说，JS中缺少显式整数类型常常令人困惑。许多编程语言支持多种数字类型，如浮点型、双精度型、整数型和双精度型，但JS却不是这样。在JS中，按照IEEE 754-2008标准的定义，所有数字都以双精度64位浮点格式表示。</p><p>在此标准下，无法精确表示的非常大的整数将自动四舍五入。确切地说，JS 中的Number类型只能安全地表示-9007199254740991 (-(2^53-1)) 和9007199254740991(2^53-1)之间的整数，任何超出此范围的整数值都可能失去精度。</p><p>如何定义BigInt？需要在数字的后边加上一个n，例如;</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">let n <span class="operator">=</span> <span class="number">521</span>n<span class="comment">;</span></span><br></pre></td></tr></table></figure><p>我们接下来演示一下，大整数运算的效果：</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">let <span class="built_in">max</span> = <span class="built_in">Number</span>.MAX_SAFE_INTEGER;<span class="built_in">console</span>.<span class="built_in">log</span>(<span class="built_in">max</span>);</span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(<span class="built_in">max</span> + <span class="number">1</span>);</span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(<span class="built_in">max</span> + <span class="number">2</span>);<span class="built_in">console</span>.<span class="built_in">log</span>(BigInt(<span class="built_in">max</span>));</span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(BigInt(<span class="built_in">max</span>) + BigInt(<span class="number">1</span>));</span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(BigInt(<span class="built_in">max</span>) + BigInt(<span class="number">2</span>));</span><br></pre></td></tr></table></figure><h2 id="globalThis"><a href="#globalThis" class="headerlink" title="globalThis"></a>globalThis</h2><p>全局属性 globalThis 包含全局的 this 值，类似于全局对象（global object）。</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(globalThis);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> ES新特性 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ES新特性 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ES7新特性</title>
      <link href="/posts/3143d487/"/>
      <url>/posts/3143d487/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="数组方法扩展"><a href="#数组方法扩展" class="headerlink" title="数组方法扩展"></a>数组方法扩展</h2><p>Array.prototype.includes：此方法用来检测数组中是否包含某个元素，返回布尔类型值<br>语法：<code>arr.includes(searchElement[, fromIndex]);</code></p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const mingzhu = [<span class="string">&quot;西游记&quot;</span>, <span class="string">&quot;红楼梦&quot;</span>, <span class="string">&quot;三国演义&quot;</span>, <span class="string">&quot;水浒传&quot;</span>];</span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(mingzhu.<span class="built_in">includes</span>(<span class="string">&quot;西游记&quot;</span>));</span><br></pre></td></tr></table></figure><h2 id="幂运算"><a href="#幂运算" class="headerlink" title="幂运算"></a>幂运算</h2><p>** 操作符的作用和 Math.pow 的作用是一样，请看代码：</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(<span class="number">2</span> ** <span class="number">10</span>);</span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(Math.<span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">10</span>));</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> ES新特性 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ES新特性 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>高阶语法</title>
      <link href="/posts/d21f8ebb/"/>
      <url>/posts/d21f8ebb/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="编程规范"><a href="#编程规范" class="headerlink" title="编程规范"></a>编程规范</h3><p>面向过程：先做这个，再做那个，然后做…</p><ul><li>优点：易维护、易复用、易扩展，由于面向对象有封装、继承，多态性的特性，可以设计出低耦合的系统，使系统更加灵活、更加易干维护</li><li>缺点:性能比面向过程低</li></ul><p>面向对象：把功能组织成对象，然后相关操作作为对象的方法</p><ul><li>优点:性能比面向对象高，适合跟硬件联系很紧密的东西，例如单片机就采用的面向过程编程。</li><li>缺点:没有面向对象易维护、易复用、易扩展</li></ul><p>函数式编程：把功能分解为一系列独立的函数，通过函数间互相调用来完成功能</p><p>函数式编程的要求：</p><ul><li>保证纯函数</li></ul><blockquote><p>一个函数的返回结果只依赖于他的参数，同样的输入必定有同样的输出</p></blockquote><ul><li>减少函数副作用</li></ul><blockquote><p>函数副作用就是函数，会影响外部的数据，如果全局变量</p></blockquote><p>函数式编程执行后会遇到的问题</p><ul><li>值得传递写起来不方便</li></ul><blockquote><p>我们如果要连续的执行一系列函数，并且传递计算某个值，会写起来很难受</p></blockquote><ul><li>连续调用写 起来很麻烦</li></ul><blockquote><p>需要连续调用一系列函数，写起来很麻烦</p></blockquote><p>compose函数</p><p>pipe函数</p><p>链式调用</p><h3 id="高阶函数"><a href="#高阶函数" class="headerlink" title="高阶函数"></a>高阶函数</h3><p>定义：该函数可以接受另外一个函数作为参数</p><p>常见高阶函数</p><ul><li>forEach和Map</li><li>reduce</li><li>filter</li></ul><h3 id="函数的内部属性"><a href="#函数的内部属性" class="headerlink" title="函数的内部属性#"></a>函数的内部属性<a href="https://www.cnblogs.com/L-xmin/p/12587583.html#3866412403">#</a></h3><h4 id="arguments、arguments-callee"><a href="#arguments、arguments-callee" class="headerlink" title="arguments、arguments.callee#"></a>arguments、arguments.callee<a href="https://www.cnblogs.com/L-xmin/p/12587583.html#519971951">#</a></h4><p>arguments的主要用途是保存函数参数，这个对象还有一个叫callee的属性，该属性是一个指针，指向拥有这个arguments对象的函数。例子：</p><pre class="highlighter-hljs" highlighted="true"><div data-tips="复制代码" class="esa-clipboard-button" data-clipboard-target="#copy_target_21">Copy</div><code class="language-javascript highlighter-hljs hljs" id="copy_target_21">function factorial(num)&#123;    if(num <= 1)&#123;        return 1;    &#125;else&#123;        //return num*factorial(num-1)        return num*arguments.callee(num-1)     &#125;&#125;</code></pre><p>在这个重写后的factorial()函数的函数体内，没有再引用函数名factorial。这样，无论引用函数时使用的是什么名字，都可以保证正常完成递归调用。</p><h4 id="this"><a href="#this" class="headerlink" title="this#"></a>this<a href="https://www.cnblogs.com/L-xmin/p/12587583.html#1606077909">#</a></h4><p>this引用的是函数据以执行的环境对象——或者也可以说是this值（当在网页的全局作用域中调用函数时，this对象引用的就是window）。示例：</p><pre class="highlighter-hljs" highlighted="true"><div data-tips="复制代码" class="esa-clipboard-button" data-clipboard-target="#copy_target_22">Copy</div><code class="language-javascript highlighter-hljs hljs" id="copy_target_22">window.color = "red"var o = &#123;color: "blue"&#125;function sayColor() &#123;    alert(this.color)&#125;sayColor();  //redo.sayColor = sayColor;o.sayColor();  //blue</code></pre><blockquote><p>牢记：函数的名字仅仅是一个包含指针的变量而已。因此，即使是在不同的环境中执行，全局的sayColor()函数与o.sayColor()指向的仍然是同一个函数。</p></blockquote><h4 id="caller"><a href="#caller" class="headerlink" title="caller#"></a>caller<a href="https://www.cnblogs.com/L-xmin/p/12587583.html#3539028445">#</a></h4><p>这个属性中保存着边勇当前函数的函数的引用。如果是在全局作用域中调用当前函数，它的值为null。</p><h3 id="函数属性和方法"><a href="#函数属性和方法" class="headerlink" title="函数属性和方法#"></a>函数属性和方法<a href="https://www.cnblogs.com/L-xmin/p/12587583.html#1351354110">#</a></h3><p>ECMAScript中的函数是对象，因此也有属性和方法。每个函数都包含两个属性：length和prototype。</p><h4 id="length"><a href="#length" class="headerlink" title="length#"></a>length<a href="https://www.cnblogs.com/L-xmin/p/12587583.html#1691935948">#</a></h4><p>length属性表示函数希望接收的命名参数的个数。</p><h4 id="prototype"><a href="#prototype" class="headerlink" title="prototype#"></a>prototype<a href="https://www.cnblogs.com/L-xmin/p/12587583.html#3883409599">#</a></h4><p>在ECMAScript核心所定义的全部属性中，最耐人寻味的就要数prototype属性了。</p><p>对于ECMAScript中的引用类型而言，prototype是保存它们所有实例方法的真正所在。诸如toString()和valueOf()等方法实际上都保存在prototype名下，只不过通过各自对象的实例访问罢了。</p><p>在创建自定义引用类型以及实现继承时，prototype属性是极为重要的。（第六章详细介绍）</p><p>在ECMAScript5中，prototype属性是不可枚举的，因此使用for-in无法发现。</p><h4 id="apply-和call"><a href="#apply-和call" class="headerlink" title="apply()和call()#"></a>apply()和call()<a href="https://www.cnblogs.com/L-xmin/p/12587583.html#3360086194">#</a></h4><p>每个函数都包含两个非继承而来的方法：apply()和call()。这两个方法的用途都是 <strong>在特定的作用域中调用函数</strong> ，实际上等于设置函数体内this对象的值。</p><p>首先，apply()方法接受两个参数：一个是在其中运行函数的作用域，另一个是参数数组。其中，第二个参数可以是Array的实例，也可以是arguments对象。例如：</p><pre class="highlighter-hljs" highlighted="true"><div data-tips="复制代码" class="esa-clipboard-button" data-clipboard-target="#copy_target_23">Copy</div><code class="language-javascript highlighter-hljs hljs" id="copy_target_23">function sum(num1,num2)&#123;    return num1 + num2;&#125;function callSum1(num1,num2)&#123;  //传入arguments对象    return sum.apply(this,arguments)&#125;function callSum2(num1,num2)&#123;    return sum.apply(this,[num1,num2])  //传入数组&#125;alert(callSum1(10,10))  //20alert(callSum2(10,10))  //20</code></pre><p>这个例子中，callSum1()在执行sum()函数时传入了this作为this值（因为实在全局作用域中调用的，所以传入的就是window对象）和arguments对象。</p><p>call()方法与apply()方法的作用相同，区别仅在于接受参数的方式不同。call()方法第一个参数是this值，不同的是其余参数都直接传给函数。即传递给函数的参数必须逐个列出来。例子：</p><pre class="highlighter-hljs" highlighted="true"><div data-tips="复制代码" class="esa-clipboard-button" data-clipboard-target="#copy_target_24">Copy</div><code class="language-javascript highlighter-hljs hljs" id="copy_target_24">function sum(num1,num2)&#123;    return num1 + num2;&#125;function callSum1(num1,num2)&#123;  //传入arguments对象    return sum.call(this,num1,num2)&#125;alert(callSum1(10,10))  //20</code></pre><p>它们真正强大的地方是能够扩充函数来一运行的作用域，好处就是对象不需要与方法有任何耦合关系。例子：</p><pre class="highlighter-hljs" highlighted="true"><div data-tips="复制代码" class="esa-clipboard-button" data-clipboard-target="#copy_target_25">Copy</div><code class="language-javascript highlighter-hljs hljs" id="copy_target_25">window.color = "red"var o = &#123;color:"blue"&#125;function sayColor()&#123;    alert(this.color)&#125;sayColor()  //redsayColor.call(this)  //redsayColor.call(window)  //redsayColor.call(o)  //blue</code></pre><h4 id="bind"><a href="#bind" class="headerlink" title="bind()#"></a>bind()<a href="https://www.cnblogs.com/L-xmin/p/12587583.html#1156779762">#</a></h4><p>这个方法会创建一个函数实例，其this值会被绑定到传给bind()函数的值。例子：</p><pre class="highlighter-hljs" highlighted="true"><div data-tips="复制代码" class="esa-clipboard-button" data-clipboard-target="#copy_target_26">Copy</div><code class="language-javascript highlighter-hljs hljs" id="copy_target_26">window.color = "red"var o = &#123;color:"blue"&#125;function sayColor()&#123;    alert(this.color)&#125;var objectSayColor = sayColor.bind(o)objectSayColor()  //blue</code></pre><p>在这里，sayColor()调用bind()并传入对象，创建了objectSayColor()函数。objectSayColor()函数的this值等于o，因此即使是在全局作用域中调用这个函数，也会看到”blue”。</p><h3 id="继承方法"><a href="#继承方法" class="headerlink" title="继承方法#"></a>继承方法<a href="https://www.cnblogs.com/L-xmin/p/12587583.html#3380564621">#</a></h3><p>toLocaleString()和toString()方法始终返回函数的代码。</p><p>补充：toString()方法返回函数代码本身，以前会省略注释和空格。ES6开始就不会了</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ES新特性 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BOM</title>
      <link href="/posts/f3d3ee5b/"/>
      <url>/posts/f3d3ee5b/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="BOM概述"><a href="#BOM概述" class="headerlink" title="BOM概述"></a>BOM概述</h3><p> <strong>BOM：浏览器对象模型</strong> ，它提供了独立于内容而与 <strong>浏览器窗口进行交互的对象</strong> ，其核心对象时window</p><p>DOM和BOM的区别：</p><table><thead><tr><th>DOM</th><th>BOM</th></tr></thead><tbody><tr><td>文档对象模型</td><td>浏览器对象模型</td></tr><tr><td>DOM就是把文档当作一个对象来看待</td><td>BOM把浏览器当作一个对象来看待</td></tr><tr><td>DOM的顶级对象是document</td><td>BOM的顶级对象是window</td></tr><tr><td>DOM主要学习的是操作页面元素</td><td>BOM学习的是浏览器窗口交互的一些对象</td></tr><tr><td>DOM是W3C标准规范</td><td>BOM是浏览器厂商在各自浏览器上定义的，兼容性较差</td></tr></tbody></table><p>BOM比DOM更大，BOM包含DOM</p><p>常见的BOM对象如下：</p><ul><li>Window：代表的是整个浏览器的窗口，同时window也是网页中的全局对象</li><li>Navigator：代表的当前浏览器的信息，通过该对象可以来识别不同的浏览器</li><li>Location：代表当前浏览器的地址栏信息，通过Location可以获取地址栏信息，或者操作浏览器跳转页面</li><li>History：代表浏览器的历史记录，可以通过该对象来操作浏览器的历史记录，由于隐私原因，该对象不能获取到具体的历史记录，只能操作浏览器向前或向后翻页，而且该操作只在当次访问时有效</li><li>Screen：代表用户的屏幕的信息，通过该对象可以获取到用户的显示器的相关的信息</li></ul><h3 id="页面加载事件"><a href="#页面加载事件" class="headerlink" title="页面加载事件"></a>页面加载事件</h3><p>语法（两种）：</p><ul><li>传统：window.onload &#x3D; function(){}</li><li>方法：window.addEventListener(‘load’, function(){})</li></ul><p>window.onload 是窗口（页面）加载事件，当文档内容完全加载完成之后（包括图像、文字</p><p>css等），会触发该事件，就调用处理函数。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">window</span>.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript"> <span class="comment">// js代码</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>注意：</p><ul><li>有了window.onload就可以把JS代码写在页面元素的任何地方，因为onload是等页面内容全部加载完毕再去执行处理函数的</li><li>window.onload传统注册事件方式只能写一个，如果有多个，后面的会覆盖前面的，以最后一个为准</li><li>如果使用addEventListener，则没有限制</li></ul><h3 id="调整浏览器窗口大小事件"><a href="#调整浏览器窗口大小事件" class="headerlink" title="调整浏览器窗口大小事件"></a>调整浏览器窗口大小事件</h3><p>语法：<code>window.onresize = function()&#123;&#125;</code>或者 <code>window.addEventListener(&#39;resize&#39;, function()&#123;&#125;)</code></p><p>window.onresize 是调整浏览器窗口大小时加载的事件，当触发时就调用处理函数</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">window.addEventListener(<span class="string">&#x27;resize&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">&#x27;窗口尺寸变化了&#x27;</span>);</span><br><span class="line">     <span class="built_in">console</span>.<span class="built_in">log</span>(window.innerWidth); <span class="comment">// 当前屏幕的宽度</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>注意：</p><ul><li>只要窗口大小发生变化，就会触发这个事件</li><li>可利用这个事件完成响应式布局，配合 <code>window.innerWidth</code>获取当前屏幕的宽度</li></ul><h3 id="定时器"><a href="#定时器" class="headerlink" title="定时器"></a>定时器</h3><p>两种定时器：</p><ul><li>setTimeout()</li><li>setInterval()</li></ul><h4 id="setTimeout-定时器"><a href="#setTimeout-定时器" class="headerlink" title="setTimeout() 定时器"></a>setTimeout() 定时器</h4><p>语法：</p><p><code>window.setTimeout(回调函数， [延迟的毫秒数])</code></p><p>作用：用于设置一个定时器，该定时器会在定时器到期后执行回调函数，只执行一次就结束</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 示例一</span></span><br><span class="line">setTimeout(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">&#x27;2秒到了&#x27;</span>);</span><br><span class="line">&#125;, <span class="number">2000</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 示例二</span></span><br><span class="line">setTimeout(callback, <span class="number">2000</span>)</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">callback</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">&#x27;2秒到了&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意：</p><ul><li>这个window在调用时可省略</li><li>延时的事件单位时毫秒（1000ms &#x3D; 1s），可省略，如果省略为0，则立即调用</li></ul><h4 id="clearTimeout-清除定时器"><a href="#clearTimeout-清除定时器" class="headerlink" title="clearTimeout() 清除定时器"></a>clearTimeout() 清除定时器</h4><p>语法：</p><p><code>window.clearTimeout(timeout ID)</code></p><p>clearTimeout()方法可取消setTimeout()建立的定时器</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 示例</span></span><br><span class="line">&lt;button&gt; 按钮 &lt;/button&gt;</span><br><span class="line"><span class="keyword">var</span> timer = <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;2秒到了&#x27;</span>);</span><br><span class="line">&#125;, <span class="number">2000</span>)</span><br><span class="line"><span class="keyword">var</span> btn = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;button&#x27;</span>);</span><br><span class="line">btn.<span class="property">onclick</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">// 清除定时器</span></span><br><span class="line">    <span class="built_in">clearTimeout</span>(timer);</span><br><span class="line">&#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h4 id="setInterval-定时器"><a href="#setInterval-定时器" class="headerlink" title="setInterval() 定时器"></a>setInterval() 定时器</h4><p>语法：<code>window.setInterval(回调函数,[间隔的毫秒数])</code></p><p>setInterval() 方法重复调用一个函数，每隔一段时间（设置的间隔时间），就去调用一次</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">setInterval(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">&#x27;111&#x27;</span>);</span><br><span class="line">&#125;, <span class="number">1000</span>)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p>注意：</p><ul><li>这个window在调用时可省略</li><li>延时的事件单位时毫秒（1000ms &#x3D; 1s），可省略，如果省略为0，则立即调用</li></ul><h4 id="clearInterval-清除定时器"><a href="#clearInterval-清除定时器" class="headerlink" title="clearInterval 清除定时器"></a>clearInterval 清除定时器</h4><p>语法：<code>window.clearInterval(interval ID)</code></p><p>clearInterval() 方法清除通过setInterval创建的定时器</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 示例</span></span><br><span class="line">&lt;button&gt; 按钮&lt;/button&gt;</span><br><span class="line"><span class="keyword">var</span> timer = <span class="built_in">setInterval</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;2秒到了&#x27;</span>);</span><br><span class="line">&#125;, <span class="number">2000</span>)</span><br><span class="line"><span class="keyword">var</span> btn = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;button&#x27;</span>);</span><br><span class="line">btn.<span class="property">onclick</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">// 清除定时器</span></span><br><span class="line">    <span class="built_in">clearInterval</span>(timer);</span><br><span class="line">&#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h4 id="倒计时（案例）"><a href="#倒计时（案例）" class="headerlink" title="倒计时（案例）"></a>倒计时（案例）</h4><p>案例分析：</p><p>1、因为时间是不断变化的，因此需要定时器来自动变化（setInterval）</p><p>2、三个盒子里面分别存放时、分、秒</p><p>3、三个盒子利用innerHTML放入计算出来的时、分、秒</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;div <span class="keyword">class</span>=<span class="string">&quot;hour&quot;</span>&gt;&lt;/div&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;minute&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;second&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> hour = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.hour&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> minute = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.minute&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> second = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.second&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> inputTime = +<span class="keyword">new</span> <span class="title class_">Date</span>(<span class="string">&#x27;2022-6-5 18:00:00&#x27;</span>)</span><br><span class="line"><span class="title function_">countDown</span>(); <span class="comment">// 先调用一次时间函数，防止页面刷新出现空白的情况</span></span><br><span class="line"><span class="comment">// 开启定时器，每隔一秒调用一次</span></span><br><span class="line"><span class="built_in">setInterval</span>(countDown, <span class="number">1000</span>)</span><br><span class="line"><span class="comment">// 计算 倒计时 时间的函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">countDown</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> nowTime = +<span class="keyword">new</span> <span class="title class_">Date</span>(); <span class="comment">// 括号内为空，则返回的是当前时间的总毫秒数</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 输入的时间 - 现在时间的总毫秒，再除以1000将毫秒转换为秒 */</span></span><br><span class="line">    <span class="keyword">var</span> times = (inputTime - nowTime) / <span class="number">1000</span>; <span class="comment">// times 是剩余时间的总秒数，1s = 1000ms</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> h = <span class="built_in">parseInt</span>(times / <span class="number">60</span> / <span class="number">60</span> % <span class="number">24</span>); <span class="comment">// 小时</span></span><br><span class="line">    <span class="keyword">var</span> m = <span class="built_in">parseInt</span>(times / <span class="number">60</span> % <span class="number">60</span>);<span class="comment">// 分钟</span></span><br><span class="line">    <span class="keyword">var</span> s = <span class="built_in">parseInt</span>(times % <span class="number">60</span>); <span class="comment">// 秒数</span></span><br><span class="line"></span><br><span class="line">    h = h &lt; <span class="number">10</span> ? <span class="string">&#x27;0&#x27;</span> + h : h;</span><br><span class="line">    m = m &lt; <span class="number">10</span> ? <span class="string">&#x27;0&#x27;</span> + m : m;</span><br><span class="line">    s = s &lt; <span class="number">10</span> ? <span class="string">&#x27;0&#x27;</span> + s : s;</span><br><span class="line"></span><br><span class="line">    hour.<span class="property">innerHTML</span> = h;</span><br><span class="line">    minute.<span class="property">innerHTML</span> = m;</span><br><span class="line">    second.<span class="property">innerHTML</span> = s;</span><br><span class="line">&#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h3 id="Window对象"><a href="#Window对象" class="headerlink" title="Window对象"></a>Window对象</h3><h4 id="弹出框"><a href="#弹出框" class="headerlink" title="弹出框"></a>弹出框</h4><h5 id="警告框"><a href="#警告框" class="headerlink" title="警告框"></a>警告框</h5><h5 id="确认框"><a href="#确认框" class="headerlink" title="确认框"></a>确认框</h5><h5 id="提示框"><a href="#提示框" class="headerlink" title="提示框"></a>提示框</h5><h4 id="定时事件"><a href="#定时事件" class="headerlink" title="定时事件"></a>定时事件</h4><h5 id="延时器"><a href="#延时器" class="headerlink" title="延时器"></a>延时器</h5><h5 id="定时器-1"><a href="#定时器-1" class="headerlink" title="定时器"></a>定时器</h5><h4 id="常用窗口属性"><a href="#常用窗口属性" class="headerlink" title="常用窗口属性"></a>常用窗口属性</h4><h4 id="其它窗口方法"><a href="#其它窗口方法" class="headerlink" title="其它窗口方法"></a>其它窗口方法</h4><h3 id="location-对象"><a href="#location-对象" class="headerlink" title="location 对象"></a>location 对象</h3><p>window对象提供了一个 <strong>location属性</strong> ，用于 <strong>获取或设置窗体的URL</strong> ，并且可以用于 <strong>解析URL</strong> 。</p><p>因为这个属性返回的是一个对象，所以这个属性也称为<strong>location对象</strong></p><h4 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h4><p> <strong>URL：统一资源定位符</strong> ，是互联网上标准资源的地址</p><p>互联网上每个文件都有一个唯一的URL，它包含的信息指出文件的位置以及浏览器应该怎么处理它</p><p>URL的一般语法格式为：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">protocol:<span class="regexp">//</span>host[:port]<span class="regexp">/path/</span>[?query]<span class="comment">#fragment</span></span><br><span class="line">https:<span class="regexp">//</span>www.bilibili.com<span class="regexp">/video/</span>BV1Sy4y1C7ha?p=<span class="number">281</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><table><thead><tr><th>组成</th><th>说明</th></tr></thead><tbody><tr><td>protocol</td><td>通信协议。常用：http、ftp、maito等</td></tr><tr><td>host</td><td>主机（域名）<a href="https://link.juejin.cn/?target=www.bilibili.com" title="www.bilibili.com">www.bilibili.com</a></td></tr><tr><td>port</td><td>端口号，可选，省略时使用方案的默认端口 。如：http默认端口号为80</td></tr><tr><td>path</td><td>路径。由零个或多个’&#x2F;‘符号隔开的字符串，一般用啦表示主机上的一个目录或文件地址</td></tr><tr><td>query</td><td>参数。以键值对的形式，通过&amp;符号分隔开</td></tr><tr><td>fragment</td><td>片段 #后面内容，常见于链接 锚点</td></tr></tbody></table><h4 id="location-对象常见的属性"><a href="#location-对象常见的属性" class="headerlink" title="location 对象常见的属性"></a>location 对象常见的属性</h4><table><thead><tr><th>location对象</th><th>返回值</th></tr></thead><tbody><tr><td>location.href</td><td>获取或设置 整个URL</td></tr><tr><td>location.host</td><td>返回主机（域名）<a href="https://link.juejin.cn/?target=www.bilibili.com" title="www.bilibili.com">www.bilibili.com</a></td></tr><tr><td>location.port</td><td>返回端口号。如果没有端口号，返回空字符串</td></tr><tr><td>location.pathname</td><td>返回路径</td></tr><tr><td>location.search</td><td>返回参数</td></tr><tr><td>location.hash</td><td>返回片段 #后面内容 常见于链接 锚点</td></tr></tbody></table><p>记住：location.href 获取或设置 整个URL 、 location.search 返回参数</p><h4 id="5秒后跳转页面（案例）"><a href="#5秒后跳转页面（案例）" class="headerlink" title="5秒后跳转页面（案例）"></a>5秒后跳转页面（案例）</h4><p>获取当前URL：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> btn = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;button&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    btn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(location.<span class="property">href</span>); <span class="comment">//  file:///E:/practice/css/img/location.html</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 修改url地址，当按钮点击时，则会跳转到修改过后的地址</span></span></span><br><span class="line"><span class="language-javascript">        location.<span class="property">href</span> = <span class="string">&#x27;https://www.baidu.com/&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p>5秒后跳转页面：</p><p>案例分析：</p><p>1、利用定时器做倒计时效果</p><p>2、时间到了，就跳转页面，使用location.href</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> p = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;p&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> timer = <span class="number">5</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (timer == <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            location.<span class="property">href</span> = <span class="string">&#x27;https://www.baidu.com/&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            p.<span class="property">innerHTML</span> = timer + <span class="string">&#x27;秒后跳转到百度页面&#x27;</span></span></span><br><span class="line"><span class="language-javascript">            timer--;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;, <span class="number">1000</span>)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h4 id="获取URL参数（案例）"><a href="#获取URL参数（案例）" class="headerlink" title="获取URL参数（案例）"></a>获取URL参数（案例）</h4><p>案例分析：</p><p>1、第一个登录页面，里面由提交表单，action提交到index.html页面</p><p>2、第二个页面，可以使用第一个页面的参数，这样实现了一个数据不同页面之间的传递效果</p><p>3、第二个页面之所有可以使用第一个页面的数据，是利用了URL里面的location.search参数</p><p>4、第二个页面中，需要把这个参数提取</p><p>5、第一步去掉问好? 利用substr</p><p>6、第二步利用&#x3D;等号分隔键和值 split(‘&#x3D;’)</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">//</span> --login.html</span><br><span class="line">&lt;form action=<span class="string">&quot;index.html&quot;</span>&gt;</span><br><span class="line">    用户名：&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;username&quot;</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;登录&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> --index.html</span><br><span class="line">&lt;div&gt;&lt;/div&gt;</span><br><span class="line">script&gt;</span><br><span class="line">    console.log(location.search); <span class="regexp">//</span> ?username=andy</span><br><span class="line">    <span class="regexp">//</span> <span class="number">1</span>.去掉？问号 substr(<span class="string">&#x27;起始位置&#x27;</span>， 截取几个字符)</span><br><span class="line">    <span class="regexp">//</span> 从字符串的第二个元素开始截取，substr()方法如果不写截取几个字符，默认后面的全部截取</span><br><span class="line">    var params = location.search.substr(<span class="number">1</span>);  <span class="regexp">//</span> params = username=andy</span><br><span class="line">soncole.log(params); <span class="regexp">//</span>  username=andy</span><br><span class="line"></span><br><span class="line">    <span class="regexp">//</span> <span class="number">2</span>.利用=等号 把字符串分割为数组  split(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">    var arr = params.split(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">    console.log(arr); <span class="regexp">//</span>  [<span class="string">&#x27;username&#x27;</span>, <span class="string">&#x27;andy&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    var div = document.querySelector(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">    div.innerHTML = arr[<span class="number">1</span>] + <span class="string">&#x27; 欢迎您！&#x27;</span></span><br><span class="line">&lt;/script&gt;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h4 id="location-常见方法"><a href="#location-常见方法" class="headerlink" title="location 常见方法"></a>location 常见方法</h4><table><thead><tr><th>location方法</th><th>返回值</th></tr></thead><tbody><tr><td>location.assign()</td><td>跟href一样，可以跳转页面（也称为重定向页面），记录浏览历史，可以后退页面</td></tr><tr><td>location.replace()</td><td>替换当前页面，因为不记录历史，所以不能后退页面</td></tr><tr><td>location.reload()</td><td>重新加载页面，相当于刷新按钮，或者F5。如果参数为true，强制刷新你ctrl+F5</td></tr></tbody></table><h3 id="navigator-对象"><a href="#navigator-对象" class="headerlink" title="navigator 对象"></a>navigator 对象</h3><p><strong>navigator</strong>对象：包含有关浏览器的信息</p><p>它有很多属性，最常用的是 <strong>userAgent</strong> ，该属性可以<strong>返回由客户机发送服务器的user-agent头部的值</strong></p><p>前端代码可以判断用户在哪个终端（PC端、移动端等）打开页面，实现跳转</p><p><a href="https://link.juejin.cn/?target=https://www.bilibili.com/video/BV1Sy4y1C7ha?p=285" title="https://www.bilibili.com/video/BV1Sy4y1C7ha?p=285">www.bilibili.com/video/BV1Sy…</a></p><h3 id="history-对象"><a href="#history-对象" class="headerlink" title="history 对象"></a>history 对象</h3><p><a href="https://link.juejin.cn/?target=https://www.bilibili.com/video/BV1Sy4y1C7ha?p=286&spm_id_from=pageDriver" title="https://www.bilibili.com/video/BV1Sy4y1C7ha?p=286&amp;spm_id_from=pageDriver">www.bilibili.com/video/BV1Sy…</a></p><p>window 对象提供了一个history对象，与浏览器历史记录进行交互</p><p>history对象包含用户（在浏览器窗口中）访问过的URL</p><table><thead><tr><th>history对象方法</th><th>说明</th></tr></thead><tbody><tr><td>back()</td><td>可以后退页面功能</td></tr><tr><td>forward()</td><td>前进页面功能</td></tr><tr><td>go(参数)</td><td>前进后退功能。参数如果是1，则前进1个页面；如果参数是-1，则后退1个页面</td></tr></tbody></table><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// 示例</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;index.html&#x27;</span>&gt;</span>点击去首页<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span>&gt;</span>前进<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> btn = <span class="variable language_">document</span>.<span class="title function_">querySelectot</span>(<span class="string">&#x27;button&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">btn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        history.<span class="title function_">forward</span>(); <span class="comment">// </span></span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="Screen对象"><a href="#Screen对象" class="headerlink" title="Screen对象"></a>Screen对象</h3><h4 id="Screen对象描述"><a href="#Screen对象描述" class="headerlink" title="Screen对象描述"></a>Screen对象描述</h4><h4 id="Screen对象属性"><a href="#Screen对象属性" class="headerlink" title="Screen对象属性"></a>Screen对象属性</h4>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> BOM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DOM</title>
      <link href="/posts/f75e92e9/"/>
      <url>/posts/f75e92e9/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="DOM基本介绍"><a href="#DOM基本介绍" class="headerlink" title="DOM基本介绍"></a>DOM基本介绍</h3><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">DOM概述</button></li><li class="tab"><button type="button" data-href="#super-2">节点概述</button></li><li class="tab"><button type="button" data-href="#super-3">文档节点</button></li><li class="tab"><button type="button" data-href="#super-4">元素节点</button></li><li class="tab"><button type="button" data-href="#super-5">属性节点</button></li><li class="tab"><button type="button" data-href="#super-6">文本节点</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>DOM：文档对象模型（Document Object Model，简称DOM），是W3C组织推荐的处理可扩展标记语言（HTML或XML）的标准<strong>编程接口</strong>。</p><p>W3C定义了一系列的DOM接口，通过这些DOM接口可改变网页的内容、结构、样式</p><p>DOM中的专有名词：</p><ul><li>文档：一个页面就是一个文档，DOM中使用document表示</li><li>元素：页面中的所有标签都是元素，DOM中使用element表示</li><li>节点：网页中的所有内容都是节点（标签、属性、文本、注释等），DOM中使用node表示</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>节点——Node，是构成网页的最基本的单元，网页中的每一个部分都可以称为是一个节点。<br>比如：html标签、属性、文本、注释、整个文档等都是一个节点。<br>虽然都是节点，但是实际上它们的具体类型是不同的。<br>节点的类型不同，属性和方法也都不尽相同。<br>常用节点分为四类：</p><ul><li>文档节点：整个HTML文档</li><li>元素节点：HTML文档中的HTML标签</li><li>属性节点：元素的属性</li><li>文本节点：HTML标签中的文本内容</li></ul><p><img src="https://img-blog.csdnimg.cn/img_convert/6c58b926da64501f486305b5afe3d9f8.png" alt="image-20201019115515595"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>文档节点（Document）代表的是整个HTML文档，网页中的所有节点都是它的子节点。</p><p>document对象作为window对象的属性存在的，不用获取可以直接使用。</p><p>通过该对象，可以在整个文档访问内查找节点对象，并可以通过该对象创建各种节点对象。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>HTML中的各种标签都是元素节点（Element），这也是我们最常用的一个节点。</p><p>浏览器会将页面中所有的标签都转换为一个元素节点， 我们可以通过document的方法来获取元素节点。</p><p>例如：document.getElementById()，根据id属性值获取一个元素节点对象。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p>属性节点（Attribute）表示的是标签中的一个一个的属 性，这里要注意的是属性节点并非是元素节点的子节点，而是元素节点的一部分。可以通过元素节点来获取指定的属性节点。</p><p>例如：元素节点.getAttributeNode(“属性名”)，根据元素节点的属性名获取一个属性节点对象。</p><p>注意：我们一般不使用属性节点。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-6"><p>文本节点（Text）表示的是HTML标签以外的文本内容，任意非HTML的文本都是文本节点，它包括可以字面解释的纯文本内容。文本节点一般是作为元素节点的子节点存在的。获取文本节点时，一般先要获取元素节点，在通过元素节点获取文本节点。</p><p>例如：<code>元素节点.firstChild;</code>，获取元素节点的第一个子节点，一般为文本节点。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="查找并获取元素"><a href="#查找并获取元素" class="headerlink" title="查找并获取元素"></a>查找并获取元素</h3><p>DOM中获取页面中元素的几种方式：</p><ul><li>根据ID获取——document.getElementById(id)</li><li>根据标签名获取——document.getElementsByTagName(name)</li><li>通过HTML5新增的方法获取<ul><li>document.getElementsByClassName(name)</li><li>document.querySelector(CSS选择器)</li><li>document.querySelectorAll(CSS选择器)</li></ul></li><li>特殊元素获取</li></ul><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">根据ID获取 getElementById()</button></li><li class="tab"><button type="button" data-href="#super-2">根据标签名获取 getElementsByTagName()</button></li><li class="tab"><button type="button" data-href="#super-3">H5新增方法</button></li><li class="tab"><button type="button" data-href="#super-4">获取body和HTML元素</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>getElementById()：匹配特定ID的元素</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 语法</span></span><br><span class="line"><span class="keyword">var</span> element = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(id);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 示例</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;time&#x27;</span>&gt;</span>2022-6-1<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="keyword">var</span> timeId = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;time&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(timeId) <span class="comment">// &lt;div id=&quot;time&quot;&gt;2022-6-1&lt;/div&gt;</span></span><br></pre></td></tr></table></figure><p>注意：</p><ul><li>返回一个元素对象</li><li>返回值：返回一个匹配到ID的DOM Element对象，若在当前Document下没有找到，则返回null</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>getElementsByTagName()：返回带有指定标签名的 <strong>对象的集合</strong> （以伪数组的形式存储的）</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>2022-01-01 1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>2022-01-01 2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>2022-01-01 3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>2022-01-01 4<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>2022-01-01 5<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">&lt;/ul&gt;</span><br><span class="line"><span class="keyword">var</span> lis = <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;li&#x27;</span>); <span class="comment">// 选中所有相同的标签</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(lis);       <span class="comment">// 指定标签名的对象合集  以伪数组的方式存储</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(lis[<span class="number">0</span>]);    <span class="comment">// &lt;li&gt;2022-01-01 1&lt;/li&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 遍历</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; lis.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(lis[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意：</p><ul><li>getElementsByTagName()：获取指定标签名的对象合集，以伪数组的方式存储（可使用数组的部分方法）</li><li>可用for遍历元素对象<ul><li>如果页面中只有一个li，返回的依然是伪数组的形式</li><li>如果页面中没有该元素，返回的是一个空的伪数组</li></ul></li></ul><p>获取某个元素（父元素）内部所有指定标签名的子元素：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;ol id=<span class="string">&#x27;ol&#x27;</span>&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>2022-01-01 1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>2022-01-01 2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>2022-01-01 3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>2022-01-01 4<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>2022-01-01 5<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">&lt;/ol&gt;</span><br><span class="line"><span class="comment">// 先获取父元素，再获取父元素中的指定标签名</span></span><br><span class="line"><span class="keyword">var</span> ol = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;ol&#x27;</span>)</span><br><span class="line"><span class="keyword">var</span> ollis = ol.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;li&#x27;</span>)</span><br></pre></td></tr></table></figure><p>注意：父元素必须是<strong>单个对象（必须指明是哪一个元素对象）</strong> ，获取的时候不包括父元素自己</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>H5新增的方法不兼容IE9以下的浏览器（不考虑兼容性和移动端可使用）</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">getElementsByClassName()</button></li><li class="tab"><button type="button" data-href="#super-2">querySelector('选择器')</button></li><li class="tab"><button type="button" data-href="#super-3">querySelectorAll('选择器')</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>根据类名获取某些元素集合</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;div <span class="keyword">class</span>=<span class="string">&quot;box&quot;</span>&gt;盒子&lt;/div&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span>盒子<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="keyword">var</span> boxs = <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&#x27;box&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(boxs); <span class="comment">// 伪数组的方式存储</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>根据指定选择器，返回第一个元素对象</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;div <span class="keyword">class</span>=<span class="string">&quot;box&quot;</span>&gt;盒子 <span class="number">1</span>&lt;/div&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span>盒子 2<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;nav&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>产品<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="comment">// 类选择器</span></span><br><span class="line"><span class="keyword">var</span> box = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.box&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(box); <span class="comment">// &lt;div class=&quot;box&quot;&gt;盒子 1&lt;/div&gt;</span></span><br><span class="line"><span class="comment">// ID选择器</span></span><br><span class="line"><span class="keyword">var</span> nav = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#nav&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(nav); <span class="comment">// </span></span><br><span class="line"><span class="comment">// 标签选择器</span></span><br><span class="line"><span class="keyword">var</span> li = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;li&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(li); <span class="comment">// &lt;li&gt;首页&lt;/li&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>根据指定选择器返回所有元素对象的集合</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;div <span class="keyword">class</span>=<span class="string">&quot;box&quot;</span>&gt;盒子 <span class="number">1</span>&lt;/div&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span>盒子 2<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;nav&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>产品<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 选择所有的.box （类选择器）</span></span><br><span class="line"><span class="keyword">var</span> allBox = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.box&#x27;</span>);  <span class="comment">// 以伪数组的方式存储</span></span><br><span class="line"><span class="keyword">var</span> allLi = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;li&#x27;</span>)</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">获取body元素</button></li><li class="tab"><button type="button" data-href="#super-2">获取HTML元素</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> body = <span class="variable language_">document</span>.<span class="property">body</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(body);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> html = <span class="variable language_">document</span>.<span class="property">documentElement</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(html)  </span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="操作元素"><a href="#操作元素" class="headerlink" title="操作元素"></a>操作元素</h3><p>JavaScript的DOM操作可改变网页内容、结构、样式，可利用DOM操作元素来改变元素里面的内容、属性等</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">改变元素内容</button></li><li class="tab"><button type="button" data-href="#super-2">改变元素属性</button></li><li class="tab"><button type="button" data-href="#super-3">改变表单属性</button></li><li class="tab"><button type="button" data-href="#super-4">改变样式属性</button></li><li class="tab"><button type="button" data-href="#super-5">H5自定义属性</button></li><li class="tab"><button type="button" data-href="#super-6">获取自定义属性值 getAttribute()</button></li><li class="tab"><button type="button" data-href="#super-7">自定义属性的操作（设置、移除属性）</button></li><li class="tab"><button type="button" data-href="#super-8">操作元素总结</button></li><li class="tab"><button type="button" data-href="#super-9">全选与取消全选（案例）</button></li><li class="tab"><button type="button" data-href="#super-10">tab栏切换（案例）</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>共同点：</p><ul><li>innerText和innerHTML都可修改页面内容</li></ul><p>区别：</p><ul><li>innerText 不识别html标签</li><li>innerHTML识别html标签</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> div = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">div.<span class="property">innerText</span> = <span class="string">&#x27;&lt;strong&gt;今天是：&lt;strong&gt;2020年&#x27;</span>; <span class="comment">// 不识别html标签，页面会显示&lt;strong&gt;</span></span><br><span class="line">div.<span class="property">innerHTML</span> = <span class="string">&#x27;&lt;strong&gt;今天是：&lt;/strong&gt;2020年&#x27;</span>;<span class="comment">// 识别html标签，“今天是：”加粗显示</span></span><br></pre></td></tr></table></figure><ul><li>innerText 非标准（老版本火狐不支持），innerHTML W3C标准（推荐）</li><li>这两个属性可读写（可获取元素里面的内容）</li><li>innerText 去除html标签，同时空格和换行也会去掉</li><li>innerHTML 保留html标签，同时保留空格和换行</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>元素节点.属性 &#x3D; new value<br>改变 HTML 元素的属性值。</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var a <span class="operator">=</span> document.getElementById(<span class="string">&quot;a&quot;</span>)<span class="comment">;</span></span><br><span class="line">a.href<span class="operator">=</span><span class="string">&quot;https://www.baidu.com&quot;</span><span class="comment">;</span></span><br><span class="line">console.log(a)<span class="comment">;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>利用DON可用操作表单元素的属性：</p><blockquote><p>type、value、checked、selected、disabled</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;button&gt;按钮&lt;/button&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&quot;输入。。。&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">var btn = document.querySelector(&#x27;button&#x27;);</span></span><br><span class="line"><span class="language-xml">var input = document.querySelector(&#x27;input&#x27;)</span></span><br><span class="line"><span class="language-xml">btn.onclick = function () &#123;</span></span><br><span class="line"><span class="language-xml">    input.value = &#x27;999&#x27;;</span></span><br><span class="line"><span class="language-xml">    // this指向事件函数的调用者 btn</span></span><br><span class="line"><span class="language-xml">    // disabled 被点击之后，不能再使用</span></span><br><span class="line"><span class="language-xml">    this.disabled = true</span></span><br><span class="line"><span class="language-xml">&#125;</span></span><br><span class="line"><span class="language-xml"></span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>可通过JavaScript修改元素的大小、颜色、位置等样式</p><p>element. <strong>style</strong> ：<strong>行内样式操作</strong></p><p>element. <strong>className</strong> ：<strong>类名样式操作</strong></p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">行内样式操作</button></li><li class="tab"><button type="button" data-href="#super-2">类名样式操作</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// element.style：行内样式操作</span></span><br><span class="line">&lt;div&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> div = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line"><span class="comment">// 鼠标经过时的样式</span></span><br><span class="line">div.<span class="property">onmouseover</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// div.style.backgroundColor = &#x27;#f90&#x27; // 可用this this指向事件函数的调用者</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">backgroundColor</span> = <span class="string">&#x27;#f90&#x27;</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">width</span> = <span class="string">&#x27;500px&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 鼠标离开时的样式</span></span><br><span class="line">div.<span class="property">onmouseout</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">backgroundColor</span> = <span class="string">&#x27;red&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意：</p><ul><li>JS里面的样式采用驼峰命名法。比如：backgroundColor、fontSize</li><li>js修改style样式操作，产生的是行内样式，权重比较高</li><li>如果样式少，或者简单的情况下使用（多的情况下，使用className）</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// element.className：类名样式操作</span></span><br><span class="line">.change&#123;</span><br><span class="line">    background-color:<span class="meta">#f90;</span></span><br><span class="line">    width:<span class="number">500</span>px;</span><br><span class="line">    height: <span class="number">500</span>px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;<span class="keyword">div</span> <span class="keyword">class</span>=<span class="string">&#x27;div-style&#x27;</span>&gt;&lt;/<span class="keyword">div</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="built_in">var</span> <span class="keyword">div</span> = document.querySelector(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line"><span class="comment">// 鼠标经过时的样式</span></span><br><span class="line"><span class="keyword">div</span>.onmouseover = function () &#123;</span><br><span class="line">   <span class="keyword">this</span>.className = <span class="string">&#x27;change&#x27;</span>; <span class="comment">// 可以理解为：给他添加个类名</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意：</p><ul><li>可以理解为：提前写好样式，给他添加个这个类名</li><li>适合样式多或功能负责的情况</li><li>className 会直接更改元素的类名，会覆盖原先的类名，如果想要保留原先的类名，做法：</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">className</span> = <span class="string">&#x27;原先的类名  改变后的类名&#x27;</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">className</span> = <span class="string">&#x27;div-style  change&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p>自定义属性的目的：为了保存并使用数据，有些数据可保存到页面中，不必保存到数据库中</p><p>自定义属性获取属性是通过：getAttribute(‘属性’)</p><p>但是有些自定义属性很容易引起歧义，不容易判断元素是内置属性还是自定义属性</p><p>H5新增的自定义属性（不考虑兼容性问题）：</p><ul><li>H5规定自定义属性data-开头作为属性名，并且赋值。比如：<code>&lt;div data-index = &#39;1&#39;&gt;&lt;/div&gt;</code></li><li>通过setAttribute(‘属性’)自定义属性。比如：<code>div.setAttribute(&#39;data-time&#39;, 20)</code></li><li>获取自定义属性的值getAttribute。比如：<code>div.getAttribute(&#39;data-time&#39;)</code></li><li>dataset 是一个集合，里面存放了所有以data开头的自定义属性。<ul><li>示例：<br><code>console.log(div.dataset.index)</code> 打印data-开头 index的自定义属性，<br><code>console.log(div.dataset)</code>打印所有以data开头的自定义属性</li><li><code>div.dataset[&#39;index&#39;]</code> 打印data开头 index的自定义属性</li><li>dataset 兼容性差 IE11才兼容</li></ul></li><li>如果自定义属性里面有多个-连接的单词，获取自定义属性时，需要采取驼峰命名法。<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 自定义属性里面有多个-连接的单词，获取自定义属性时，需要采取驼峰命名法</span></span><br><span class="line">&lt;div data-list-name=<span class="string">&#x27;andy&#x27;</span>&gt;&lt;/div&gt;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(div.<span class="property">dataset</span>.<span class="property">listName</span>); <span class="comment">// andy</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(div.<span class="property">dataset</span>[<span class="string">&#x27;listName&#x27;</span>]); <span class="comment">// andy</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-6"><p>自定义属性：程序员自己添加的属性，称为自定义属性</li></p></ul><p>获取元素的属性值：</p><ul><li>element.属性</li><li>element.getAttribute(‘属性’)</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 示例</span></span><br><span class="line">&lt;div id=<span class="string">&#x27;demo&#x27;</span>&gt;&lt;div&gt;</span><br><span class="line"><span class="keyword">var</span> div = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(div.<span class="property">id</span>); <span class="comment">// demo </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(div.<span class="title function_">getAttribute</span>(<span class="string">&#x27;id&#x27;</span>)); <span class="comment">// demo</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p>区别：</p><ul><li>element.属性：获取内置属性值（元素本身自带的属性）</li><li>element.getAttribute(‘属性’)：主要获取自定义的属性（标准的），程序员自定义的属性</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-7"><p><strong>设置属性的值</strong></p><ul><li>element.属性 &#x3D; ‘值’ 设置内置属性值<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 示例</span></span><br><span class="line">&lt;div id=<span class="string">&#x27;demo&#x27;</span> <span class="keyword">class</span>=<span class="string">&#x27;div1&#x27;</span> index=<span class="string">&#x27;1&#x27;</span> &gt;&lt;div&gt;</span><br><span class="line"><span class="keyword">var</span> div = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">div.<span class="property">id</span> = <span class="string">&#x27;test&#x27;</span>;</span><br><span class="line">div.<span class="property">className</span> = <span class="string">&#x27;test1&#x27;</span></span><br></pre></td></tr></table></figure></li><li>element.setAttribute(‘属性’, ‘值’) ：主要针对自定义属性<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 示例</span></span><br><span class="line">&lt;div id=<span class="string">&#x27;demo&#x27;</span> <span class="keyword">class</span>=<span class="string">&#x27;div1&#x27;</span> index=<span class="string">&#x27;1&#x27;</span> &gt;&lt;div&gt;</span><br><span class="line"><span class="keyword">var</span> div = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">div.<span class="title function_">setAttribute</span>(<span class="string">&#x27;index&#x27;</span>, <span class="number">2</span>);</span><br><span class="line">div.<span class="title function_">setAttribute</span>(<span class="string">&#x27;class&#x27;</span>, <span class="string">&#x27;footer&#x27;</span>)</span><br></pre></td></tr></table></figure></li></ul><p><strong>移除属性 removeAttribute(属性)：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">div.<span class="title function_">removeAttribute</span>(<span class="string">&#x27;index&#x27;</span>)</span><br><span class="line"><span class="comment">// 移除后</span></span><br><span class="line">&lt;div id=<span class="string">&#x27;demo&#x27;</span> <span class="keyword">class</span>=<span class="string">&#x27;div1&#x27;</span> &gt;&lt;div&gt;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-8"><p>操作元素：</p><ul><li>操作元素内容<ul><li>innerText</li><li>innerHTML</li></ul></li><li>操作常见元素属性<ul><li>src、href、title、alt等</li></ul></li><li>操作表单元素属性<ul><li>type、value、disabled等</li></ul></li><li>操作元素样式属性<ul><li>element.style</li><li>className<button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-9"><p>案例分析：</li></p></ul></li></ul><p>1、全选取消全选的做法：让下面的复选框的checked属性 跟随 全选按钮即可（循环下面的复选框，将其checked属性改为和全选按钮一样）</p><p>2、下面的复选框需要全部选中，上面的全选才能选中：给下面的所有复选框绑定点击事件，每次点击，都要循环一下查看下面所有的复选框是否都选中，如果存在一个没选选中，则全选按钮不选中。设置一个变量，来控制是否选中</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">全选：&lt;input type=<span class="string">&quot;checkbox&quot;</span>&gt;</span><br><span class="line">&lt;div id=&quot;checkboxContent&quot;&gt;</span><br><span class="line">    篮球&lt;input type=&quot;checkbox&quot;&gt;</span><br><span class="line">    足球&lt;input type=&quot;checkbox&quot;&gt;</span><br><span class="line">    排球&lt;input type=&quot;checkbox&quot;&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">var allCheckbox = document.querySelector(&#x27;input&#x27;)</span><br><span class="line">// 选择ID为checkboxContent下所有的input标签的元素集合</span><br><span class="line">var inputs = document.getElementById(&#x27;checkboxContent&#x27;).getElementsByTagName(&#x27;input&#x27;)</span><br><span class="line"></span><br><span class="line">// 当全选框选中时，其他的复选框全部选中</span><br><span class="line">allCheckbox.onclick = function () &#123;</span><br><span class="line">    // this.checked 复选框是选中状态为true，未选中为fasle</span><br><span class="line">    // this指向调用事件函数的allCheckbox</span><br><span class="line">    // console.log(this.checked);</span><br><span class="line">    for (var i = 0; i &lt; inputs.length; i++) &#123;</span><br><span class="line">        // 循环其他的复选框，把其它的状态改为和全选的状态一样</span><br><span class="line">        inputs[i].checked = this.checked; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 给下面的所有复选框绑定点击事件，每次点击，都要循环一下查看下面所有的复选框是否都选中，如果存在一个没选中，则全选按钮不选中</span><br><span class="line">// 变量 flag 控制全选按钮是否选中</span><br><span class="line">for (var i = 0; i &lt; inputs.length; i++) &#123;</span><br><span class="line">    inputs[i].onclick = function () &#123;</span><br><span class="line">        // flag 控制全选按钮是否选中</span><br><span class="line">        var flag = true;</span><br><span class="line">        // 每次点击下面的复选框，都要循环检查其他的按钮是否全被选中</span><br><span class="line">        for (var i = 0; i &lt; inputs.length; i++) &#123;</span><br><span class="line">            if (!inputs[i].checked) &#123;</span><br><span class="line">                flag = false;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        allCheckbox.checked = flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-10"><p>案例分析：</p><p>1、tab切换有两个大模块</p><p>2、上面的模块选项卡，点击某一个，当前这个的背景颜色变成红色，其余的不变，可用修改类名的方式</p><p>3、下面的模块内容，会随着上面的选项卡变化而变化，所以下面的模块变化写在点击事件里面</p><p>4、规律：下面的模块显示内容和上面的选项卡一一对应，相匹配</p><p>5、核心思路：给上面的tab_list里面的所有小li添加自定义属性（setAttribute），属性值从0开始编号</p><p>6、当点击tab_list里面的某个小li，让tab_con里面对应序号的内容显示，其余隐藏</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;div <span class="keyword">class</span>=<span class="string">&quot;tab_list&quot;</span>&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;current&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>4<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>5<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line">&lt;/div&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;tab_con&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;display: block;&quot;</span>&gt;</span>111<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>222<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>333<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>444<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>555<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> tab_list = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.tab_list&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> lis = tab_list.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;li&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> items = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.tab_con&#x27;</span>).<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line"><span class="comment">// 循环绑定事件</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; lis.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="comment">// 给五个li设置索引号 </span></span><br><span class="line">    lis[i].<span class="title function_">setAttribute</span>(<span class="string">&#x27;data-index&#x27;</span>, i)</span><br><span class="line">    lis[i].<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 上面的模块选项卡，点击某一个，当前这个的背景颜色变成红色，其余的不变，可用修改类名的方式</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; lis.<span class="property">length</span>; i++) &#123;</span><br><span class="line">            <span class="comment">// 清除所有li的class 这个类</span></span><br><span class="line">            lis[i].<span class="property">className</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 只留下当前点击的那个，给他添加上类（样式）</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">className</span> = <span class="string">&#x27;current&#x27;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 点击切换时，显示的内容模块</span></span><br><span class="line">        <span class="keyword">var</span> index = <span class="variable language_">this</span>.<span class="title function_">getAttribute</span>(<span class="string">&#x27;data-index&#x27;</span>)</span><br><span class="line">        <span class="comment">// 先把所有的隐藏</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; items.<span class="property">length</span>; i++) &#123;</span><br><span class="line">            items[i].<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;none&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 只留下当前的要显示的内容（和上对应的内容）</span></span><br><span class="line">        items[index].<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;block&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="操作节点"><a href="#操作节点" class="headerlink" title="操作节点"></a>操作节点</h3><p>页面中的所有内容都是节点（标签、属性、文本、注释等），在DOM中，节点使用node来表示</p><p>HTML DOM树中的所有节点均可以通过JavaScript进行访问，所有HTML元素（节点）均可被修改、创建、删除</p><p>一般的节点至少拥有：<strong>nodeType（节点类型）</strong> 、<strong>nodeName（节点名称）</strong> 、<strong>nodeValue（节点值）</strong> 三个基本属性</p><p>nodeType（节点类型）：</p><ul><li>元素节点 nodeType 为 1</li><li>属性节点 nodeType 为 2</li><li>文本节点 nodeType 为 3（文本节点包括：文字、空格、换行）</li></ul><p>在实际开发中，节点操作主要操作的是<strong>元素节点</strong></p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">父节点/元素</button></li><li class="tab"><button type="button" data-href="#super-2">子节点/元素</button></li><li class="tab"><button type="button" data-href="#super-3">首/尾 节点/元素</button></li><li class="tab"><button type="button" data-href="#super-4">兄弟节点/元素</button></li><li class="tab"><button type="button" data-href="#super-5">创建/添加/删除/替换/拷贝节点</button></li><li class="tab"><button type="button" data-href="#super-6">三种动态创建元素的区别</button></li><li class="tab"><button type="button" data-href="#super-7">导航栏（父子节点案例）</button></li><li class="tab"><button type="button" data-href="#super-8">留言板（创建/添加/删除节点案例）</button></li><li class="tab"><button type="button" data-href="#super-9">动态生成表格（综合案例）</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">父节点</button></li><li class="tab"><button type="button" data-href="#super-2">父元素</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>语法：<br><code>node.parentNode</code> 返回指定子节点的父节点</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 示例</span></span><br><span class="line">&lt;div <span class="keyword">class</span>=<span class="string">&#x27;box&#x27;</span>&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&#x27;font&#x27;</span>&gt;</span>文字文字<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line">&lt;/div&gt;</span><br><span class="line"><span class="comment">// 父节点</span></span><br><span class="line"><span class="keyword">var</span> font = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.font&#x27;</span>);</span><br><span class="line"><span class="comment">// var box = document.querySelector(&#x27;.box&#x27;) // 以前的写法</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(font.<span class="property">parentNode</span>); <span class="comment">// font.parentNode 可以直接获取子节点font的父节点</span></span><br></pre></td></tr></table></figure><p>注意：</p><ul><li>node.parentNode 得到的是离子节点最近的父节点</li><li>如果指定的节点找不到父节点，则返回为null</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>元素节点.parentElement<br>返回元素的父元素</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">子节点</button></li><li class="tab"><button type="button" data-href="#super-2">子元素</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>语法：parentNode.childNodes<br>返回包含指定节点的子节点（包含：元素节点、文本节点等）的集合，该集合为即使更新的集合</p><p>如果只想要获得里面的元素节点，则需要专门处理，一般不提倡用childNodes</p><p>推荐使用：<code>parentNode.children</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>4<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>5<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">&lt;/ul&gt;</span><br><span class="line"><span class="keyword">var</span> ul = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;ul&#x27;</span>);</span><br><span class="line"><span class="comment">// var li = document.querySelector(&#x27;li&#x27;); // 以前的写法</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ul.<span class="property">children</span>); <span class="comment">// ul.children 可以直接获取父节点ul下的所有子节点</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>元素节点.children返回元素的一个子元素的集合（不包含空白文本Text节点）。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">首/尾节点</button></li><li class="tab"><button type="button" data-href="#super-2">首/尾元素</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>parentNode.firstElementChild ：返回第一个子元素节点，找不到返回null<br>parentNode.lastElementChild：返回最后一个子元素节点，找不到返回null</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>11<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>22<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>33<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">&lt;/ul&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ul = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;ul&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ul.<span class="property">firstElementChild</span>); <span class="comment">// 第一个子元素节点： &lt;li&gt;11&lt;/li&gt;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ul.<span class="property">lastElementChild</span>); <span class="comment">// 最后一个子元素节点： &lt;li&gt;33&lt;/li&gt;</span></span><br></pre></td></tr></table></figure><p>注意：这两个方法有兼容性问题，IE9以上才支持</p><p>实际开发的写法，<strong>既没有兼容性问题，又能返回第一个和最后一个子元素：</strong></p><p>ul.children[ol.children.length - 1 ] ：获取最后一个子元素（父节点所有子节点的长度减1，则是元素的下标），不管子元素增加减少，都可以</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ul.children 返回ul下面所有的子节点，再用children[0]数组的方式取第一个子节点</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ul.<span class="property">children</span>[<span class="number">0</span>]); <span class="comment">// 第一个子元素节点： &lt;li&gt;11&lt;/li&gt;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ul.<span class="property">children</span>[<span class="number">2</span>]); <span class="comment">// 最后一个子元素节点： &lt;li&gt;33&lt;/li&gt;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( ul.<span class="property">children</span>[ol.<span class="property">children</span>.<span class="property">length</span> - <span class="number">1</span> ]); <span class="comment">// 最后一个子元素节点： &lt;li&gt;33&lt;/li&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>元素节点.firstChild返回元素的第一个子节点（包含空白文本Text节点）。<br>元素节点.lastChild返回元素的最后一个子节点（包含空白文本Text节点）。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">兄弟节点</button></li><li class="tab"><button type="button" data-href="#super-2">兄弟元素</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>元素节点.previousSibling返回某个元素紧接之前节点（包含空白文本Text节点）。<br>元素节点.nextSibling返回某个元素紧接之后节点（包含空白文本Text节点）。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>语法：</p><ul><li><code>node.nextElementSibling</code> 返回下一个兄弟元素节点，找不到返回null</li><li><code>node.previousElementSibling</code> 返回下一个兄弟元素节点，找不到返回null</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;div&lt;/div&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span>span<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="keyword">var</span> div = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(div.<span class="property">nextElementSibling</span>); <span class="comment">// &lt;span&gt;span&lt;/span&gt;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(div.<span class="property">previousElementSibling</span>); <span class="comment">// null</span></span><br></pre></td></tr></table></figure><p>注意：这两个方法有兼容性问题，IE9以上才支持</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">创建节点</button></li><li class="tab"><button type="button" data-href="#super-2">添加节点</button></li><li class="tab"><button type="button" data-href="#super-3">删除节点</button></li><li class="tab"><button type="button" data-href="#super-4">替换节点</button></li><li class="tab"><button type="button" data-href="#super-5">拷贝节点</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>语法：</p><ul><li><p>创建节点：因为这些元素原先是不存在的，是根据需要动态生成的，所以也称为<strong>动态创建元素节点</strong></p><ul><li><p><code>document.createElement(&#39;tagName&#39;)</code></p><ul><li>创建由tagName指定的HTML元素</li></ul></li><li><p><code>document.createDocumentFragment()</code></p><ul><li>创建一个DOM片段</li></ul></li><li><p><code>document.createTextNode() </code></p><ul><li>创建一个文本节点</li></ul></li></ul></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><ul><li><p>添加节点</p><ul><li><code>node.appendChild(child)</code><ul><li>将一个节点添加到指定父节点的子节点列表的 <strong>末尾</strong> （node：父级，child子级）</li></ul></li><li><code>node.insertBefore(child, 指定元素)</code><ul><li>将一个节点添加到父节点的指定子节点<strong>前面</strong></li></ul></li></ul></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><ul><li><p>删除节点</p><ul><li>语法：<code>node.removeChild(child)</code> 从父节点中删除一个子节点，返回删除的节点</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 示例</span></span><br><span class="line">&lt;button&gt;删除&lt;/button&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>11<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>22<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="comment">// 1.获取元素</span></span><br><span class="line"><span class="keyword">var</span> ul = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;ul&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> btn = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;button&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.删除元素  node.removeChild(child)</span></span><br><span class="line"><span class="comment">// ul.removeChild(ul.children[0])</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.点击按钮依次删除子节点</span></span><br><span class="line">btn.<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">     <span class="comment">// 如果父节点下没有子节点了，按钮禁用，还有子节点则可以继续删除</span></span><br><span class="line">    ul.<span class="property">children</span>.<span class="property">length</span> == <span class="number">0</span> ?  <span class="variable language_">this</span>.<span class="property">disabled</span> = <span class="literal">true</span> :  ul.<span class="title function_">removeChild</span>(ul.<span class="property">children</span>[<span class="number">0</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><ul><li><p>替换节点</p><ul><li>replaceChild(new,old)</li></ul></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><ul><li><p>拷贝节点</p><ul><li>语法：node.cloneNode() 返回调用该方法的节点的一个副本，也成为克隆节点&#x2F;拷贝节点</li></ul></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>22<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>33<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>44<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">&lt;/ul&gt;</span><br><span class="line"><span class="keyword">var</span> ul = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;ul&#x27;</span>);</span><br><span class="line"><span class="comment">// 复制ul下面第一个孩子li的节点</span></span><br><span class="line"><span class="keyword">var</span> lili = ul.<span class="property">children</span>[<span class="number">0</span>].<span class="title function_">cloneNode</span>(<span class="literal">true</span>)</span><br><span class="line"><span class="comment">// 添加到ul下的li列表的末尾</span></span><br><span class="line">ul.<span class="title function_">appendChild</span>(lili)</span><br><span class="line"><span class="comment">// 添加到ul下的li列表的第一个li的前面</span></span><br><span class="line">ul.<span class="title function_">insertBefore</span>(lili, ul.<span class="property">children</span>[<span class="number">0</span>])</span><br></pre></td></tr></table></figure><p>注意：</p><ul><li><p>如果括号内的参数为<strong>空</strong>或者为 <strong>false</strong> ，则是 <strong>浅拷贝</strong> ，只克隆复制节点本身，<strong>只复制标签不复制里面的内容</strong></p></li><li><p>如果括号内为 <strong>true</strong> ，则是 <strong>深拷贝</strong> ，<strong>复制里面的标签和内容</strong></p></li><li><p>查找节点</p><ul><li>getElementById();</li><li>getElementsByName();</li><li>getElementsByTagName();</li><li>getElementsByClassName();</li><li>querySelector();</li><li>querySelectorAll();</li></ul></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-6"><ul><li>document.write()（了解）：直接将内容写入页面的内容流。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 例如：点击按钮在文档中写入一个内容是123的div,按钮点击之后，文档重绘，其他的内容都没有了，只有这个123的div</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;&lt;div&gt;123&lt;/div&gt;&#x27;</span>)</span><br></pre></td></tr></table></figure><ul><li>element.innerHTML：创建元素</li><li>document.createElement()：创建元素</li></ul><p>区别：</p><ul><li>document.write() 正常下是没有问题的，但是当文档流执行完毕，则它会导致页面全部重绘（原来的内容就没有了）</li><li>innerHTML 是将内容写入某个DOM节点，不会导致页面全部重绘</li><li>innerHTML 创建多个元素效率更高（不要拼接字符串，采取数组push形式拼接，再转换成字符），结构稍微复杂</li><li>createElement() 创建多个元素效率稍微低一点，但是结构更清晰</li></ul><p>总结：不同浏览器下，innerHTML效率比createElement高</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-7"><p>案例分析：<br>1、导航栏里面的li都要鼠标经过的效果，所以需要循环绑定鼠标事件<br>2、核心元素：当鼠标经过li里面的第二个孩子ul显示，当鼠标离开，ul隐藏</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul <span class="keyword">class</span>=<span class="string">&quot;nav&quot;</span>&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span>&gt;</span>首 页<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span>&gt;</span>首页内容<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span>&gt;</span>首页内容<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span>&gt;</span>首页内容<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span>&gt;</span>微 博<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span>&gt;</span>微博内容<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span>&gt;</span>微博内容<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span>&gt;</span>微博内容<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">&lt;/ul&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> nav = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.nav&#x27;</span>)</span><br><span class="line"><span class="keyword">var</span> lis = nav.<span class="property">children</span>; <span class="comment">// 得到nav下面的子li</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; lis.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    lis[i].<span class="property">onmouseover</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">children</span>[<span class="number">1</span>].<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;block&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    lis[i].<span class="property">onmouseout</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">children</span>[<span class="number">1</span>].<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-8"><p>核心思路：点击按钮之后，就动态创建一个li，添加到ul里面</p><p>创建li的同时，把文本域里面的值通过li.innerHTML赋值给li</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;textarea name=<span class="string">&quot;&quot;</span> id=<span class="string">&quot;&quot;</span> cols=<span class="string">&quot;30&quot;</span> rows=<span class="string">&quot;10&quot;</span>&gt;&lt;/textarea&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">button</span>&gt;</span>添加<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> btn = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;button&#x27;</span>)</span><br><span class="line"><span class="keyword">var</span> ul = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;ul&#x27;</span>)</span><br><span class="line"><span class="keyword">var</span> text = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;textarea&#x27;</span>)</span><br><span class="line">btn.<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (text.<span class="property">value</span> == <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&#x27;您还没有输入留言~&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// 终止操作</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 创建元素节点</span></span><br><span class="line">        <span class="keyword">var</span> li = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;li&#x27;</span>)</span><br><span class="line">        <span class="comment">// 现有li 才能赋值</span></span><br><span class="line">        <span class="comment">// console.log(text.value); // 留言的内容</span></span><br><span class="line">        li.<span class="property">innerHTML</span> = text.<span class="property">value</span> + <span class="string">&quot;&lt;a href=&#x27;javascript:;&#x27;&gt;删除&lt;/a&gt;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 添加元素节点 insertBefore 添加的元素永远在一个行</span></span><br><span class="line">        ul.<span class="title function_">insertBefore</span>(li, ul.<span class="property">children</span>[<span class="number">0</span>])</span><br><span class="line">        <span class="comment">// 添加留言完成之后，清空原来输入框的内容</span></span><br><span class="line">        text.<span class="property">value</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 删除元素节点 删除的是当前链接的父节点</span></span><br><span class="line">        <span class="keyword">var</span> <span class="keyword">as</span> = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="keyword">as</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">as</span>[i].<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                <span class="comment">// node.removeChild(child) 删除的是li  当前a所在的li  this.parentNode</span></span><br><span class="line">                <span class="comment">// li 的父节点是ul ul.removeChild()</span></span><br><span class="line">                ul.<span class="title function_">removeChild</span>(<span class="variable language_">this</span>.<span class="property">parentNode</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-9"><p>案例分析：<br>1、因为里面的数据是动态的，需要js动态生成。先模拟数据，定义好相应的数据，数据采取数组对象的形式存储<br>2、所有的数据都是放在tbody里面的行里面<br>3、因为行很多，需要循环创建多个行（多少人创建多少行）<br>4、每一个行里面有多个单元格（对应里面的数据），需要使用循环创建多个单元格，并且把数据存入里面（双重for循环）<br>5、最后一列单元格是删除，需要单独创建单元格<br>6、点击a删除当前a所在的行（链接的父级的父级） node.removeChild(child)，当前a的父级是列，列的父级是行，删除一整行： this.parentNode.parentNode</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(k <span class="keyword">in</span> obj)&#123;</span><br><span class="line">    <span class="comment">// k 得到的是属性名</span></span><br><span class="line">    <span class="comment">// obj[k] 得到的是属性值</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 动态生成表格案例</span></span><br><span class="line">&lt;table cellspacing=<span class="string">&quot;0&quot;</span>&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">thead</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>姓名<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>科目<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>成绩<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">tbody</span>&gt;</span><span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span></span><br><span class="line">&lt;/table&gt;</span><br><span class="line"><span class="comment">// 1.先准备数据</span></span><br><span class="line"><span class="keyword">var</span> datas = [</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;王权&#x27;</span>,</span><br><span class="line">        <span class="attr">subject</span>: <span class="string">&#x27;JavaScript&#x27;</span>,</span><br><span class="line">        <span class="attr">score</span>: <span class="number">100</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;沉稳五&#x27;</span>,</span><br><span class="line">        <span class="attr">subject</span>: <span class="string">&#x27;JavaScript&#x27;</span>,</span><br><span class="line">        <span class="attr">score</span>: <span class="number">90</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;灵梦&#x27;</span>,</span><br><span class="line">        <span class="attr">subject</span>: <span class="string">&#x27;JavaScript&#x27;</span>,</span><br><span class="line">        <span class="attr">score</span>: <span class="number">80</span></span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"><span class="comment">// 2.往tbody里面创建行：多少人创建多少行，通过数组的长度创建几行</span></span><br><span class="line"><span class="keyword">var</span> tbody = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;tbody&#x27;</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; datas.<span class="property">length</span>; i++) &#123; <span class="comment">// 外面的for循环决定多少行</span></span><br><span class="line">    <span class="comment">// 创建tr行</span></span><br><span class="line">    <span class="keyword">var</span> tr = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;tr&#x27;</span>);</span><br><span class="line">    <span class="comment">// 在父节点tbody下添加子节点tr</span></span><br><span class="line">    tbody.<span class="title function_">appendChild</span>(tr)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3.行里面创建单元格 td，单元格的数量取决于对象里面的属性个数 ，得到数组对象属性个数，也就是单元格列的个数</span></span><br><span class="line">    <span class="comment">// for循环遍历对象（每个datas数组里面的元素对象都要遍历一遍，得到每一个元素对象属性的个数）</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> k <span class="keyword">in</span> datas[i]) &#123; <span class="comment">// 里面的for循环决定多少列 td</span></span><br><span class="line">        <span class="comment">// 创建单元格列</span></span><br><span class="line">        <span class="keyword">var</span> td = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;td&#x27;</span>);</span><br><span class="line">        <span class="comment">// 把对象里面的属性值给td  </span></span><br><span class="line">        td.<span class="property">innerHTML</span> = datas[i][k];</span><br><span class="line">        <span class="comment">// 单元格放在行里面</span></span><br><span class="line">        tr.<span class="title function_">appendChild</span>(td);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 4.创建删除的单元格</span></span><br><span class="line">    <span class="keyword">var</span> td = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;td&#x27;</span>);</span><br><span class="line">    <span class="comment">// 给删除的单元格添加删除的文字</span></span><br><span class="line">    td.<span class="property">innerHTML</span> = <span class="string">&quot;&lt;a href=&#x27;#&#x27;&gt;删 除&lt;/a&gt;&quot;</span></span><br><span class="line">    <span class="comment">// 将删除的单元格放入行中</span></span><br><span class="line">    tr.<span class="title function_">appendChild</span>(td)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 5.删除单元格操作</span></span><br><span class="line"><span class="keyword">var</span> <span class="keyword">as</span> = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="keyword">as</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">as</span>[i].<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 点击a删除当前a所在的行（链接的父级的父级） node.removeChild(child)</span></span><br><span class="line">        <span class="comment">// 当前a的父级是列，列的父级是行，删除一整行： this.parentNode.parentNode</span></span><br><span class="line">        tbody.<span class="title function_">removeChild</span>(<span class="variable language_">this</span>.<span class="property">parentNode</span>.<span class="property">parentNode</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="文档事件"><a href="#文档事件" class="headerlink" title="文档事件"></a>文档事件</h3><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">事件概述</button></li><li class="tab"><button type="button" data-href="#super-2">窗口事件</button></li><li class="tab"><button type="button" data-href="#super-3">表单事件</button></li><li class="tab"><button type="button" data-href="#super-4">键盘事件</button></li><li class="tab"><button type="button" data-href="#super-5">常见鼠标事件</button></li><li class="tab"><button type="button" data-href="#super-6">媒体事件</button></li><li class="tab"><button type="button" data-href="#super-7">其它事件</button></li><li class="tab"><button type="button" data-href="#super-8">事件冒泡</button></li><li class="tab"><button type="button" data-href="#super-9">事件委派</button></li><li class="tab"><button type="button" data-href="#super-10">事件绑定</button></li><li class="tab"><button type="button" data-href="#super-11">事件传播</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>JavaScript可创建动态页面，事件是可被JavaScript侦测到的行为</p><p>事件三要素：</p><ul><li>事件源：被触发的对象（谁触发的事件）</li><li>事件类型：如何触发。比如：鼠标点击，鼠标经过、键盘按下</li><li>事件处理程序：通过函数赋值的方式 完成</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 示例</span></span><br><span class="line">&lt;button id=<span class="string">&quot;btn&quot;</span>&gt;按钮&lt;/button&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> btn = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;btn&#x27;</span>)</span><br><span class="line">btn.<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&#x27;点击&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>由窗口触发该事件 (同样适用于 <body> 标签)：<br><code>window.方法 = 事件</code></p><table><thead><tr><th align="center">属性</th><th>描述</th></tr></thead><tbody><tr><td align="center">onblur</td><td>当窗口失去焦点时运行脚本。</td></tr><tr><td align="center">onfocus</td><td>当窗口获得焦点时运行脚本。</td></tr><tr><td align="center">onload</td><td>当文档加载之后运行脚本。</td></tr><tr><td align="center">onresize</td><td>当调整窗口大小时运行脚本。</td></tr><tr><td align="center">onstorage</td><td>当 Web Storage 区域更新时（存储空间中的数据发生变化时）运行脚本。</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>表单事件在HTML表单中触发 (适用于所有 HTML 元素，但该HTML元素需在form表单内)：</p><table><thead><tr><th align="center">属性</th><th>描述</th></tr></thead><tbody><tr><td align="center">onblur</td><td>当元素失去焦点时运行脚本。</td></tr><tr><td align="center">onfocus</td><td>当元素获得焦点时运行脚本。</td></tr><tr><td align="center">onchange</td><td>当元素改变时运行脚本。</td></tr><tr><td align="center">oninput</td><td>当元素获得用户输入时运行脚本。</td></tr><tr><td align="center">oninvalid</td><td>当元素无效时运行脚本。</td></tr><tr><td align="center">onselect</td><td>当选取元素时运行脚本。</td></tr><tr><td align="center">onsubmit</td><td>当提交表单时运行脚本。</td></tr></tbody></table><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> textInput = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;text&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 当文本框获取焦点，文本框背景为红色 */</span></span><br><span class="line">textInput.<span class="property">onfocus</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">background</span> = <span class="string">&quot;red&quot;</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p><code>window.方法 = 事件</code></p><p>通过键盘触发事件，类似用户的行为：</p><table><thead><tr><th align="center">属性</th><th>描述</th></tr></thead><tbody><tr><td align="center">onkeydown</td><td>当按下按键时运行脚本。</td></tr><tr><td align="center">onkeyup</td><td>当松开按键时运行脚本。</td></tr><tr><td align="center">onkeypress</td><td>当按下并松开按键时运行脚本。</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><table><thead><tr><th align="center">鼠标事件</th><th>触发条件</th></tr></thead><tbody><tr><td align="center"><strong>onclick</strong></td><td><strong>鼠标点击左键触发</strong></td></tr><tr><td align="center">ondblclick</td><td>鼠标双击左键触发</td></tr><tr><td align="center"><strong>onmouseover</strong></td><td><strong>鼠标经过触发</strong></td></tr><tr><td align="center">onmouseout</td><td>鼠标离开触发</td></tr><tr><td align="center">onmouseenter</td><td>当鼠标指针移至元素之上时运行脚本，可以阻止冒泡</td></tr><tr><td align="center">onmouseleave</td><td>当鼠标指针移出元素时运行脚本，可以阻止冒泡</td></tr><tr><td align="center"><strong>onfocus</strong></td><td><strong>获取鼠标焦点触发</strong></td></tr><tr><td align="center">onblur</td><td>失去鼠标焦点触发</td></tr><tr><td align="center">onmousewheel</td><td>当转动鼠标滚轮时运行脚本</td></tr><tr><td align="center">onscroll</td><td>当滚动元素的滚动条时运行脚本</td></tr><tr><td align="center">onmousemove</td><td>鼠标移动触发</td></tr><tr><td align="center">onmouseup</td><td>鼠标弹起触发</td></tr><tr><td align="center">onmousedown</td><td>鼠标按下触发</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-6"><p>通过视频（videos），图像（images）或音频（audio） 触发该事件。</p><table><thead><tr><th align="center">属性</th><th>描述</th></tr></thead><tbody><tr><td align="center">onabort</td><td>当发生中止事件时运行脚本。</td></tr><tr><td align="center">oncanplay</td><td>当媒介能够开始播放但可能因缓冲而需要停止时运行脚本。</td></tr><tr><td align="center">oncanplaythrough</td><td>当媒介能够无需因缓冲而停止即可播放至结尾时运行脚本。</td></tr><tr><td align="center">ondurationchange</td><td>当媒介长度改变时运行脚本。</td></tr><tr><td align="center">onemptied</td><td>当媒介资源元素突然为空时（网络错误、加载错误等）运行脚本。</td></tr><tr><td align="center">onended</td><td>当媒介已抵达结尾时运行脚本。</td></tr><tr><td align="center">onerror</td><td>当在元素加载期间发生错误时运行脚本。</td></tr><tr><td align="center">onloadeddata</td><td>当加载媒介数据时运行脚本。</td></tr><tr><td align="center">onloadedmetadata</td><td>当媒介元素的持续时间以及其它媒介数据已加载时运行脚本。</td></tr><tr><td align="center">onloadstart</td><td>当浏览器开始加载媒介数据时运行脚本。</td></tr><tr><td align="center">onpause</td><td>当媒介数据暂停时运行脚本。</td></tr><tr><td align="center">onplay</td><td>当媒介数据将要开始播放时运行脚本。</td></tr><tr><td align="center">onplaying</td><td>当媒介数据已开始播放时运行脚本。</td></tr><tr><td align="center">onprogress</td><td>当浏览器正在取媒介数据时运行脚本。</td></tr><tr><td align="center">onratechange</td><td>当媒介数据的播放速率改变时运行脚本。</td></tr><tr><td align="center">onreadystatechange</td><td>当就绪状态（ready-state）改变时运行脚本。</td></tr><tr><td align="center">onseeked</td><td>当媒介元素的定位属性不再为真且定位已结束时运行脚本。</td></tr><tr><td align="center">onseeking</td><td>当媒介元素的定位属性为真且定位已开始时运行脚本。</td></tr><tr><td align="center">onstalled</td><td>当取回媒介数据过程中（延迟）存在错误时运行脚本。</td></tr><tr><td align="center">onsuspend</td><td>当浏览器已在取媒介数据但在取回整个媒介文件之前停止时运行脚本。</td></tr><tr><td align="center">ontimeupdate</td><td>当媒介改变其播放位置时运行脚本。</td></tr><tr><td align="center">onvolumechange</td><td>当媒介改变音量亦或当音量被设置为静音时运行脚本。</td></tr><tr><td align="center">onwaiting</td><td>当媒介已停止播放但打算继续播放时运行脚本</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-7"><table><thead><tr><th align="center">属性</th><th>描述</th></tr></thead><tbody><tr><td align="center">onshow</td><td>当 <menu> 元素在上下文显示时触发</td></tr><tr><td align="center">ontoggle</td><td>当用户打开或关闭 <details> 元素时触发</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-8"><p>事件的冒泡（Bubble）：所谓的冒泡指的就是事件的向上传导，当后代元素上的事件被触发时，其祖先元素的相同事件也会被触发，在开发中大部分情况冒泡都是有用的，如果不希望发生事件冒泡可以通过事件对象来取消冒泡。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-9"><p>我们希望只绑定一次事件，即可应用到多个的元素上，即使元素是后添加的，我们可以尝试将其绑定给元素的共同的祖先元素，也就是事件的委派。事件的委派，是指将事件统一绑定给元素的共同的祖先元素，这样当后代元素上的事件触发时，会一直冒泡到祖先元素，从而通过祖先元素的响应函数来处理事件。事件委派是利用了事件冒泡，通过委派可以减少事件绑定的次数，提高程序的性能。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-10"><p>我们以前绑定事件代码只能一个事件绑定一个函数，那我们要是想一个事件对应多个函数，并且不存在兼容性的问题该如何解决呢？</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-11"><p>事件的传播：关于事件的传播网景公司和微软公司有不同的理解</p><p>微软公司认为事件应该是由内向外传播，也就是当事件触发时，应该先触发当前元素上的事件，然后再向当前元素的祖先元素上传播，也就说事件应该在冒泡阶段执行。</p><p>网景公司认为事件应该是由外向内传播的，也就是当前事件触发时，应该先触发当前元素的最外层的祖先元素的事件，然后在向内传播给后代元素。</p><p>W3C综合了两个公司的方案，将事件传播分成了三个阶段：<br>1.捕获阶段：在捕获阶段时从最外层的祖先元素，向目标元素进行事件的捕获，但是默认此时不会触发事件<br>2.目标阶段：事件捕获到目标元素，捕获结束开始在目标元素上触发事件<br>3.冒泡阶段：事件从目标元素向它的祖先元素传递，依次触发祖先元素上的事件</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DOM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JS自定义对象</title>
      <link href="/posts/72f2429a/"/>
      <url>/posts/72f2429a/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="函数对象"><a href="#函数对象" class="headerlink" title="函数对象"></a>函数对象</h2><h3 id="call-和apply"><a href="#call-和apply" class="headerlink" title="call()和apply()"></a>call()和apply()</h3><p>call()和apply()这两个方法都是函数对象的方法，需要通过函数对象来调用，当对函数调用call()和apply()都会调用函数执行，在调用call()和apply()可以将一个对象指定为第一个参数，此时这个对象将会成为函数执行时的this，call()方法可以将实参在对象之后依次传递，apply()方法需要将实参封装到一个数组中统一传递，如下演示：</p><p>call()方法演示：</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">function <span class="function"><span class="title">fun</span><span class="params">(a, b)</span></span> &#123;</span><br><span class="line">    console.log(<span class="string">&quot;a = &quot;</span> + a);</span><br><span class="line">    console.log(<span class="string">&quot;b = &quot;</span> + b);</span><br><span class="line">    console.log(<span class="string">&quot;fun = &quot;</span> + <span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    name: <span class="string">&quot;obj&quot;</span>,</span><br><span class="line">    sayName: function () &#123;</span><br><span class="line">        console.log(<span class="keyword">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">fun</span><span class="params">(<span class="number">2</span>, <span class="number">3</span>)</span></span>;</span><br><span class="line">console.log(<span class="string">&quot;===============&quot;</span>);</span><br><span class="line"><span class="keyword">fun</span>.call(obj, <span class="number">2</span>, <span class="number">3</span>);</span><br></pre></td></tr></table></figure><p>注意：默认fun()函数调用，this指向的是window对象，你可以使用call()调用函数，在调用的时候传入一个对象，这个对象就是this所指向的对象，也就是说，可以自己指定this的指向，然后从第二个参数开始，实参将会依次传递</p><p>apply()方法演示：</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">function <span class="function"><span class="title">fun</span><span class="params">(a, b)</span></span> &#123;</span><br><span class="line">    console.log(<span class="string">&quot;a = &quot;</span> + a);</span><br><span class="line">    console.log(<span class="string">&quot;b = &quot;</span> + b);</span><br><span class="line">    console.log(<span class="string">&quot;fun = &quot;</span> + <span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    name: <span class="string">&quot;obj&quot;</span>,</span><br><span class="line">    sayName: function () &#123;</span><br><span class="line">        console.log(<span class="keyword">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">fun</span><span class="params">(<span class="number">2</span>, <span class="number">3</span>)</span></span>;</span><br><span class="line">console.log(<span class="string">&quot;===============&quot;</span>);</span><br><span class="line"><span class="keyword">fun</span>.apply(obj, [<span class="number">2</span>, <span class="number">3</span>]);</span><br></pre></td></tr></table></figure><p>注意：默认fun()函数调用，this指向的是window对象，你可以使用apply()调用函数，在调用的时候传入一个对象，这个对象就是this所指向的对象，也就是说，可以自己指定this的指向，然后从第二个参数开始，需要制定一个实参数组进行参数传递</p><h3 id="this指向"><a href="#this指向" class="headerlink" title="this指向"></a>this指向</h3><p>以函数形式调用时，this永远都是window<br>以方法的形式调用时，this是调用方法的对象<br>以构造函数的形式调用时，this是新创建的那个对象<br>使用call和apply调用时，this是传入的那个指定对象</p><h3 id="arguments参数"><a href="#arguments参数" class="headerlink" title="arguments参数"></a>arguments参数</h3><p>在调用函数时，浏览器每次都会传递进两个隐含的参数：</p><p>函数的上下文对象： this<br>封装实参的对象： arguments<br>this对象我们已经学习过了，那arguments对象是什么呢？</p><p>arguments是一个类数组对象，它也可以通过索引来操作数据，也可以获取长度，在调用函数时，我们所传递的实参都会在arguments中保存，比如：arguments.length 可以用来获取实参的长度，我们即使不定义形参，也可以通过arguments来使用实参，只不过比较麻烦，例如：</p><p>arguments[0]：表示第一个实参<br>arguments[1]：表示第二个实参<br>…<br>它里边有一个属性叫做callee，这个属性对应一个函数对象，就是当前正在指向的函数的对象。</p><p>arguments对象演示：</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">function <span class="function"><span class="title">fun</span><span class="params">(a, b)</span></span> &#123;</span><br><span class="line">    <span class="comment">// 通过下标获取第一个参数</span></span><br><span class="line">    console.log(arguments[<span class="number">0</span>]);</span><br><span class="line">    <span class="comment">// 通过下标获取第二个参数</span></span><br><span class="line">    console.log(arguments[<span class="number">1</span>]);</span><br><span class="line">    <span class="comment">// 获取实参的个数</span></span><br><span class="line">    console.log(arguments.length);</span><br><span class="line">    <span class="comment">// 看看它的函数对象</span></span><br><span class="line">    console.log(arguments.callee);</span><br><span class="line">    console.log(arguments.callee == <span class="function"><span class="keyword">fun</span>);</span></span><br><span class="line">&#125;<span class="function"><span class="title">fun</span><span class="params">(<span class="string">&quot;Hello&quot;</span>, <span class="string">&quot;World&quot;</span>)</span></span>;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 高阶对象 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JS自定义对象 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>原型</title>
      <link href="/posts/263f3be4/"/>
      <url>/posts/263f3be4/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="⭐理解原型对象"><a href="#⭐理解原型对象" class="headerlink" title="⭐理解原型对象"></a>⭐理解原型对象</h3><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">构造函数的prototype属性——显式原型</button></li><li class="tab"><button type="button" data-href="#super-2">原型对象的constructor属性</button></li><li class="tab"><button type="button" data-href="#super-3">实例对象的__proto__属性——隐式原型</button></li><li class="tab"><button type="button" data-href="#super-4">构造函数、原型对象、实例对象的关系</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>只要创建一个新函数，就会为该函数创建一个prototype属性，这个属性指向函数的原型对象object。<br>对于构造函数来说，prototype是作为构造函数的属性，指向构造函数的原型对象。</p><p>对于对象实例来说，prototype是对象实例的原型对象。所以prototype即是属性，又是对象。</p><blockquote><p><code>person1.__proto__</code>即为person1实例的原型对象</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">person1.<span class="property">__proto__</span> === <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>  </span><br><span class="line"><span class="comment">// 为true</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(person1) == <span class="title class_">Person</span>.<span class="property">protoytype</span>   </span><br><span class="line"><span class="comment">// 为true</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(person1).<span class="property">name</span>         </span><br><span class="line"><span class="comment">// 输出&#x27;Nicholas&#x27;</span></span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">isPrototypeOf</span>(person1)       </span><br><span class="line"><span class="comment">// 为true</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>在默认情况下，所有原型对象都会自动获得一个constructor（构造函数）属性，这个属性包含一个指向prototype属性所在函数的指针。</p><blockquote><p>即Person.prototype.constructor指向Person。</p><p>通过这个构造函数，可以为原型对象添加其他属性和方法。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//原型对象中由一个属性constructor，它指向函数对象</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Fun</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> === <span class="title class_">Fun</span>) </span><br><span class="line"><span class="comment">//true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Date</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> === <span class="title class_">Date</span>) </span><br><span class="line"><span class="comment">//true</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> o = &#123;&#125;;</span><br><span class="line"><span class="title function_">alert</span>(o.<span class="property">_proto__</span>); <span class="comment">// Object.prototype</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = &#123;<span class="attr">x</span>: <span class="number">1</span>&#125;;</span><br><span class="line"><span class="keyword">let</span> o = &#123;</span><br><span class="line">    <span class="attr">__proto__</span>: a</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title function_">alert</span>(<span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(o) === a); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>创建了自定义的构造函数之后，其原型对象默认只会取得constructor属性，至于其他方法，则都是从Object继承而来。当创建一个新实例后，该实例的内部将包含一个指针（内部属性 <code>[[Prototype]]</code>）指向构造函数的原型对象。脚本中没有标准的方式访问[[Prototype]]，但在Firefox、Safari和Chrome在每个对象上都支持一个属性 <code>__proto__</code>。</p><p>注意：这连接存在于实例与构造函数的原型对象之间，而非实例与构造函数之间。</p><p><a href="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200430215620331-779497907.png"><img src="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200430215620331-779497907.png" alt="img"></a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="原型与in操作符"><a href="#原型与in操作符" class="headerlink" title="原型与in操作符"></a>原型与in操作符</h3><p>两种方式使用in操作符：单独使用、在for-in中使用。</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">单独使用</button></li><li class="tab"><button type="button" data-href="#super-2">for-in</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>单独使用时，<code>&quot;name&quot; in person1</code>无论该属性存在于实例还是原型中，都会返回true。和 <code>.hasOwnProperty</code>不同。可以两者结合判断具体存在于实例还是原型中。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>返回的是所有能够通过对象访问的、可枚举的属性。包括实例中的和原型中的属性。屏蔽了不可枚举的属性（即将[[Enumerable]]标记的属性）的实例属性也会在for-in中循环返回。因为根据规定，所有开发人员定义的属性都是可枚举的——只有在IE8及更早版本例外。</p><blockquote><p>理解：屏蔽了不可枚举的属性（即将[[Enumerable]]标记的属性）的实例属性：<br><a href="https://img2020.cnblogs.com/blog/1019981/202003/1019981-20200329162209788-286753116.png"><img src="https://img2020.cnblogs.com/blog/1019981/202003/1019981-20200329162209788-286753116.png"></a></p></blockquote><p><a href="https://img2020.cnblogs.com/blog/1019981/202003/1019981-20200329162827445-1857997317.png"><img src="https://img2020.cnblogs.com/blog/1019981/202003/1019981-20200329162827445-1857997317.png"></a></p><p>要取得对象上 <strong>所有可枚举的实例属性</strong> ,，可以使用ECMAScript5的Object.keys()方法。</p><p><a href="https://img2020.cnblogs.com/blog/1019981/202003/1019981-20200329162657396-1302113693.png"><img src="https://img2020.cnblogs.com/blog/1019981/202003/1019981-20200329162657396-1302113693.png"></a></p><p>如果想要得到所有实例属性，无论是否可以枚举，都可以使用 <code>Object.getOwnPropertyNames()</code></p><p><a href="https://img2020.cnblogs.com/blog/1019981/202003/1019981-20200329163250028-1386071882.png"><img src="https://img2020.cnblogs.com/blog/1019981/202003/1019981-20200329163250028-1386071882.png"></a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="更简单的原型语法"><a href="#更简单的原型语法" class="headerlink" title="更简单的原型语法"></a>更简单的原型语法</h3><p><a href="https://img2020.cnblogs.com/blog/1019981/202003/1019981-20200329164043628-1256517702.png"><img src="https://img2020.cnblogs.com/blog/1019981/202003/1019981-20200329164043628-1256517702.png"></a></p><p>在这里构造函数的prototype属性不再指向原型对象，而是指向了一个新对象。此时constructor属性不再指向Person了。这里的修改本质上是完全重写了默认的prototype对象，因此constructor属性也变成了新对象的constructor属性（指向Object构造函数），不再指向Person。此时：</p><p><a href="https://img2020.cnblogs.com/blog/1019981/202003/1019981-20200329164617489-1058591707.png"><img src="https://img2020.cnblogs.com/blog/1019981/202003/1019981-20200329164617489-1058591707.png"></a></p><p>用 <code>Object.defineProperty(,)</code>constructor指向修改回Person</p><p><a href="https://img2020.cnblogs.com/blog/1019981/202003/1019981-20200329164804414-1187336567.png"><img src="https://img2020.cnblogs.com/blog/1019981/202003/1019981-20200329164804414-1187336567.png"></a></p><h3 id="原型的动态性"><a href="#原型的动态性" class="headerlink" title="原型的动态性"></a>原型的动态性</h3><p>由于在原型中查找值的过程是一次搜索，因此我们对原型对象所做的任何修改都能立即从实例上反映出来——即使先创建了实例后修改原型也照样如此。但不能重写整个原型对象：</p><p>记住：实例中的指针仅指向原型，而不指向构造函数（第二遍强调！！！）</p><p><a href="https://img2020.cnblogs.com/blog/1019981/202003/1019981-20200329165822090-883603341.png"><img src="https://img2020.cnblogs.com/blog/1019981/202003/1019981-20200329165822090-883603341.png"></a></p><h3 id="原生对象的原型"><a href="#原生对象的原型" class="headerlink" title="原生对象的原型"></a>原生对象的原型</h3><p>原型模式的重要性仅体现在创建自定义类型方面，就连所有原生的引用类型，都是采用这种模式。例子：</p><p>在Array.prototype中可以找到sort()方法</p><p>在String.prototype中可以找到substring()方法</p><p>通过原生对象的原型，不仅可以取得所有默认方法的引用，而且也可以定义新方法。例子：</p><p><a href="https://img2020.cnblogs.com/blog/1019981/202003/1019981-20200329170444105-656754825.png"><img src="https://img2020.cnblogs.com/blog/1019981/202003/1019981-20200329170444105-656754825.png"></a></p><p><a href="https://img2020.cnblogs.com/blog/1019981/202003/1019981-20200329170611666-766580019.png"><img src="https://img2020.cnblogs.com/blog/1019981/202003/1019981-20200329170611666-766580019.png"></a></p><h3 id="原型对象的问题"><a href="#原型对象的问题" class="headerlink" title="原型对象的问题"></a>原型对象的问题</h3><p>1.省略了为构造函数传递初始化参数这一环节，结果所有实例在默认情况下都取得想通的属性值。</p><p>2.共享属性对于函数合适，对于包含基本类型的属性也说得过去，但对于包含引用类型的属性来说，问题突出。实例一般都是要有属于自己的全部属性的，因此很少有人单独使用原型模式。</p><h3 id="原型方法"><a href="#原型方法" class="headerlink" title="原型方法"></a>原型方法</h3><h4 id="获取对象的原型属性Object-getPrototypeOf-somebj"><a href="#获取对象的原型属性Object-getPrototypeOf-somebj" class="headerlink" title="获取对象的原型属性Object.getPrototypeOf(somebj)"></a>获取对象的原型属性Object.getPrototypeOf(somebj)</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> o = &#123;&#125;;</span><br><span class="line"><span class="title function_">alert</span>(<span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(o) === <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> a = <span class="keyword">new</span> <span class="title class_">Array</span>();</span><br><span class="line"><span class="title function_">alert</span>(0bject.<span class="title function_">getPrototypeOf</span>(a) === <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>); <span class="comment">// true </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p = &#123;<span class="attr">x</span>: <span class="number">1</span>， <span class="attr">y</span>: <span class="number">2</span>&#125;;</span><br><span class="line"><span class="keyword">let</span> q = 0bject.<span class="title function_">create</span>(p);</span><br><span class="line"><span class="title function_">alert</span>(0bject.<span class="title function_">getPrototypeOf</span>(q) === p); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><h4 id="设置对象的原型属性Object-setPrototypeOf-obj-prototype"><a href="#设置对象的原型属性Object-setPrototypeOf-obj-prototype" class="headerlink" title="设置对象的原型属性Object.setPrototypeOf(obj,prototype)"></a>设置对象的原型属性Object.setPrototypeOf(obj,prototype)</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = &#123;<span class="attr">x</span>: <span class="number">1</span>&#125;; </span><br><span class="line"><span class="keyword">let</span> o = &#123;&#125;;</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">setPrototypeOf</span>(o，a);</span><br><span class="line"><span class="title function_">alert</span>(<span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(o) === a); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> o = &#123;&#125;;</span><br><span class="line"><span class="comment">// TypeError: Object prototype may only be an Object or null: 123 </span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">setPrototypeOf</span>(o，<span class="number">123</span>);</span><br></pre></td></tr></table></figure><h4 id="检测是否为某个对象的原型someObj-isPrototypeOf-another0bj"><a href="#检测是否为某个对象的原型someObj-isPrototypeOf-another0bj" class="headerlink" title="检测是否为某个对象的原型someObj.isPrototypeOf(another0bj)"></a>检测是否为某个对象的原型someObj.isPrototypeOf(another0bj)</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = &#123;<span class="attr">x</span>: <span class="number">1</span>&#125;;</span><br><span class="line"><span class="keyword">let</span> o =0bject.<span class="title function_">create</span>(a);</span><br><span class="line"><span class="title function_">alert</span>(a.<span class="title function_">isPrototypeOf</span>(o)); <span class="comment">// true</span></span><br><span class="line"><span class="title function_">alert</span>(<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">isPrototypeOf</span>(o)); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><h4 id="对象中的super关键字指向该对象的原型。"><a href="#对象中的super关键字指向该对象的原型。" class="headerlink" title="对象中的super关键字指向该对象的原型。"></a>对象中的super关键字指向该对象的原型。</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj1 = &#123;</span><br><span class="line">    <span class="title function_">method1</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;method 1&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> obj2 = &#123;</span><br><span class="line">    <span class="title function_">method1</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">super</span>.<span class="title function_">method1</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">setPrototypeOf</span>(obj2，obj1);</span><br><span class="line"><span class="title function_">alert</span>(obj2.<span class="title function_">method1</span>()); <span class="comment">// &#x27;method 1&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="/image/%E5%8E%9F%E5%9E%8B/1663855931637.png" alt="1663855931637"></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 函数式编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 原型 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>块级格式化上下文BFC</title>
      <link href="/posts/9c0bf13f/"/>
      <url>/posts/9c0bf13f/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="BFC定义"><a href="#BFC定义" class="headerlink" title="BFC定义"></a>BFC定义</h2><p>块级格式化上下文，简单的来说，<strong>BFC就是创建一个div盒子或者给已存在的盒子激活BFC，盒子内部的元素布局不影响盒子外部的元素。</strong></p><blockquote><p>BFC是一个独立的布局环境，其中的元素布局是不受外界的影响，并且在一个BFC中，块盒与行盒（行盒由一行中所有的内联元素所组成）都会垂直的沿着其父元素的边框排列。</p></blockquote><blockquote><p>BFC内部的元素和外部的元素绝对不会互相影响，因此， 当BFC外部存在浮动时，它不会影响BFC内部Box的布局，BFC会通过变窄，而不与浮动有重叠。同样的，当BFC内部有浮动时，为了不影响外部元素的布局，BFC计算高度时会包括浮动的高度。避免margin重叠也是这样的一个道理。</p></blockquote><h2 id="布局规则（作用）"><a href="#布局规则（作用）" class="headerlink" title="布局规则（作用）"></a>布局规则（作用）</h2><ul><li>内部的Box会在垂直方向，一个接一个地放置。</li><li>Box垂直方向的距离由margin决定。属于同一个BFC的两个相邻Box的margin会发生重叠。可解决margin重叠<strong>（示例1：margin重叠）</strong></li><li>每个盒子（块盒与行盒）的margin box的左边，与包含块border box的左边相接触(对于从左往右的格式化，否则相反)。即使存在浮动也是如此。</li><li>BFC区域不会与float重叠。<strong>（示例2：使用float，浮动元素和非浮动元素重叠）</strong></li><li>BFC就是页面上的一个隔离的独立容器，容器里面的子元素不会影响到外面的元素。反之也如此。</li><li>计算BFC的高度时，浮动元素也参与计算。<strong>（示例3：使用float高度塌陷）</strong></li></ul><h2 id="创建BFC方式"><a href="#创建BFC方式" class="headerlink" title="创建BFC方式"></a>创建BFC方式</h2><ul><li>根元素，html标签就是一个BFC</li><li>float：none以外的属性值。如：left、right</li><li>overflow：visible以外的属性值。如：hidden、auto、 scroll</li><li>position：absolute、fixed这两个属性值（只有这两个可以）</li><li>dispaly：inline-block、flex、inline-flex、table-cell、table-caption这些属性值（block不行）</li></ul><h2 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h2><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">示例1 解决margin重叠</button></li><li class="tab"><button type="button" data-href="#super-2">示例2 解决使用float时浮动元素和非浮动元素重叠</button></li><li class="tab"><button type="button" data-href="#super-3">示例3 解决使用float时容器高度塌陷</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><blockquote><p>根据BFC规则2：Box垂直方向的距离由margin决定。属于同一个BFC的两个相邻Box的margin会发生重叠。</p></blockquote><p><a href="https://img2020.cnblogs.com/blog/1019981/202005/1019981-20200526162408362-1156935528.png"><img src="https://img2020.cnblogs.com/blog/1019981/202005/1019981-20200526162408362-1156935528.png"></a></p><p>因此，我们可以为其中一个p创建一个盒子，并使用创建BFC的方法（四个中的任意一个都可以）激活它成为一个BFC。</p><p><a href="https://img2020.cnblogs.com/blog/1019981/202005/1019981-20200526163218748-206023761.png"><img src="https://img2020.cnblogs.com/blog/1019981/202005/1019981-20200526163218748-206023761.png"></a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><blockquote><p>根据浮动元素的特点2：非浮动元素几乎当浮动盒子根本不存在一样该怎么布局怎么布局不会被影响。会导致浮顶元素与非浮动元素重叠 <a href="https://www.cnblogs.com/L-xmin/p/12952682.html">本博客 float的几点要素</a></p></blockquote><p><a href="https://img2020.cnblogs.com/blog/1019981/202005/1019981-20200526170453477-131138767.png"><img src="https://img2020.cnblogs.com/blog/1019981/202005/1019981-20200526170453477-131138767.png"></a></p><blockquote><p>根据BFC规则4：BFC的区域不会与float box重叠。</p></blockquote><p>我们让right单独成为一个BFC就不会与浮动元素重叠。</p><p><a href="https://img2020.cnblogs.com/blog/1019981/202005/1019981-20200526171219860-1660029398.png"><img src="https://img2020.cnblogs.com/blog/1019981/202005/1019981-20200526171219860-1660029398.png"></a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><blockquote><p>根据浮动元素特点1：1.浮动盒子会脱离文文档流，不会在占用空间。</p></blockquote><p>容器内部的两个孩子都是浮动的，不占空间。因此容器就不会被撑开，导致了塌陷。</p><p><a href="https://img2020.cnblogs.com/blog/1019981/202005/1019981-20200526171547090-1691093875.png"><img src="https://img2020.cnblogs.com/blog/1019981/202005/1019981-20200526171547090-1691093875.png"></a></p><blockquote><p>根据BFC规则6：计算BFC的高度时，浮动元素也参与计算。</p></blockquote><p>因此我们给父节点激活BFC。对于后续的开发，可能不是很清楚当时为什么使用overflow。所以你最好添加一些注释来解释为什么这样做。</p><p><a href="https://img2020.cnblogs.com/blog/1019981/202005/1019981-20200526171857651-1770804108.png"><img src="https://img2020.cnblogs.com/blog/1019981/202005/1019981-20200526171857651-1770804108.png" alt="img"></a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> CSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> BFC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常见空、行内、块内、行内块级元素</title>
      <link href="/posts/a241b8cb/"/>
      <url>/posts/a241b8cb/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><div class="tabs" id=""><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#-1">空（void）元素</button></li><li class="tab"><button type="button" data-href="#-2">常见行内元素</button></li><li class="tab"><button type="button" data-href="#-3">常见块级元素</button></li><li class="tab"><button type="button" data-href="#-4">行内块级元素</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><p><code>&lt;br&gt;</code>      &#x2F;&#x2F; 换行<br><code>&lt;hr&gt;</code> <br><code>&lt;input&gt;</code> <br><code>&lt;link&gt;</code><br><code>&lt;meta&gt;</code><br><code>&lt;img&gt;</code></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-2"><p><code>&lt;a&gt;&lt;/a&gt;</code><br><code>&lt;span&gt;&lt;/span&gt;</code><br><code>&lt;textarea&gt;&lt;/textarea&gt;</code></p><p><code>&lt;b&gt;&lt;/b&gt;</code><br><code>&lt;del&gt;&lt;/del&gt;</code><br><code>&lt;em&gt;&lt;/em&gt;</code><br><code>&lt;i&gt;&lt;/i&gt;</code><br><code>&lt;strong&gt;&lt;/strong&gt;</code><br><code>&lt;sup&gt;&lt;/sup&gt;</code><br><code>&lt;sub&gt;&lt;/sub&gt;</code></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-3"><p><code>&lt;header&gt;&lt;/header&gt;</code><br><code>&lt;nav&gt;&lt;/nav&gt;</code><br><code>&lt;address&gt;&lt;/address&gt;</code><br><code>&lt;footer&gt;&lt;/footer&gt;</code><br><code>&lt;form&gt;&lt;/form&gt;</code></p><p><code>&lt;div&gt;&lt;/div&gt;</code><br><code>&lt;h1-6&gt;&lt;/h1-6&gt;</code><br><code>&lt;p&gt;&lt;/p&gt;</code><br><code>&lt;hr/&gt;</code></p><p><code>&lt;ul&gt;&lt;/ul&gt;</code><br><code>&lt;ol&gt;&lt;/ol&gt;</code><br><code>&lt;li&gt;&lt;/li&gt;</code><br><code>&lt;dl&gt;&lt;/dl&gt;</code><br><code>&lt;dt&gt;&lt;/dt&gt;</code><br><code>&lt;dd&gt;&lt;/dd&gt;</code></p><p><code>&lt;tr&gt;&lt;/tr&gt;</code><br><code>&lt;td&gt;&lt;/td&gt;</code><br><code>&lt;table&gt;&lt;/table&gt;</code></p><p><code>&lt;pre&gt;&lt;/pre&gt;</code><br><code>&lt;blockquote&gt;&lt;/blockquote&gt;</code></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-4"><p><code>&lt;img/&gt;</code><br><code>&lt;input/&gt;</code><br><code>&lt;select&gt;&lt;/select&gt;</code></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> Html </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Html </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>居中</title>
      <link href="/posts/2afbcfa6/"/>
      <url>/posts/2afbcfa6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="▶水平居中"><a href="#▶水平居中" class="headerlink" title="▶水平居中"></a>▶水平居中</h2><h3 id="内联元素"><a href="#内联元素" class="headerlink" title="内联元素"></a>内联元素</h3><p>text-align的用法解释：设置块级元素内文本（准确的说是内联元素）的水平对齐方式。因此要设置在父级元素上</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#container</span> &#123;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="块级元素"><a href="#块级元素" class="headerlink" title="块级元素"></a>块级元素</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 固定宽度 */</span></span><br><span class="line"><span class="selector-id">#center</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 固定宽度 */</span></span><br><span class="line"><span class="selector-id">#container</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">1000px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">1000px</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;   <span class="comment">/* 父相对定位 */</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#center</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;      <span class="comment">/* 子绝对定位 */</span>  </span><br><span class="line">    <span class="attribute">left</span>: <span class="number">50%</span>;               <span class="comment">/* 定位到父元素的一半的宽度位置  50%是相对于container的width计算*/</span></span><br><span class="line">    <span class="attribute">margin-left</span>: -<span class="number">250px</span>;    <span class="comment">/* 向左移动自身宽度的一半 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*宽度未知*/</span></span><br><span class="line"><span class="selector-id">#container</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#center</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">50%</span>;                     <span class="comment">/* 定位到父元素的一半的宽度位置  50%是相对于container的width计算*/</span></span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateX</span>(-<span class="number">50%</span>);   <span class="comment">/* 向左移动自身的一半 50%相对于自身宽度计算*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="flexbox布局"><a href="#flexbox布局" class="headerlink" title="flexbox布局"></a>flexbox布局</h3><p><a href="https://www.cnblogs.com/L-xmin/p/12705013.html">弹性布局(flex)详解</a></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#container</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: row;      <span class="comment">/* 主轴x */</span></span><br><span class="line">    <span class="attribute">justify-content</span>: center;  <span class="comment">/* 主轴x居中 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#container</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: column;   <span class="comment">/* 主轴y */</span></span><br><span class="line">    <span class="attribute">align-items</span>: center;      <span class="comment">/* 副轴x居中 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="▶垂直居中"><a href="#▶垂直居中" class="headerlink" title="▶垂直居中"></a>▶垂直居中</h2><h3 id="内联元素-1"><a href="#内联元素-1" class="headerlink" title="内联元素"></a>内联元素</h3><p><a href="https://www.zhangxinxu.com/wordpress/2009/11/css%e8%a1%8c%e9%ab%98line-height%e7%9a%84%e4%b8%80%e4%ba%9b%e6%b7%b1%e5%85%a5%e7%90%86%e8%a7%a3%e5%8f%8a%e5%ba%94%e7%94%a8/">css行高line-height的一些深入理解及应用</a></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#center</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">12px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="块级元素-1"><a href="#块级元素-1" class="headerlink" title="块级元素"></a>块级元素</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 固定高度，做法效仿水平居中 */</span></span><br><span class="line"><span class="selector-id">#container</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#center</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">margin-top</span>: -<span class="number">50px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 高度未知，做法效仿水平居中 */</span></span><br><span class="line"><span class="selector-id">#container</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#center</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">50%</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="flexbox布局-1"><a href="#flexbox布局-1" class="headerlink" title="flexbox布局"></a>flexbox布局</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#container</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: row;    <span class="comment">/* 主轴X */</span></span><br><span class="line">    <span class="attribute">align-items</span>: center;     <span class="comment">/* 辅轴Y居中对齐 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#container</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: column;    <span class="comment">/* 主轴Y */</span></span><br><span class="line">    <span class="attribute">justify-content</span>: center;   <span class="comment">/* 主轴Y居中对齐 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="利用伪元素"><a href="#利用伪元素" class="headerlink" title="利用伪元素"></a>利用伪元素</h3><p>即在父容器内放一个100%高度的伪元素，让文本和伪元素垂直对齐，从而达到垂直居中的目的。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.ghost-center</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.ghost-center</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&quot; &quot;</span>;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">1%</span>;</span><br><span class="line">    <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.ghost-center</span> <span class="selector-tag">p</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">20rem</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="▶水平垂直居中"><a href="#▶水平垂直居中" class="headerlink" title="▶水平垂直居中"></a>▶水平垂直居中</h2><h3 id="块级元素-2"><a href="#块级元素-2" class="headerlink" title="块级元素"></a>块级元素</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;wrapper&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 利用定位和margin，这个就不是简简单单设置margin: auto;就可以了 */</span></span><br><span class="line"><span class="selector-id">#container</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">1000px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">1000px</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#center</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">margin</span>: auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 固定宽高，结合了水平和垂直的代码 */</span></span><br><span class="line"><span class="selector-id">#container</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">1000px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">1000px</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#center</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">margin</span>: -<span class="number">50px</span> <span class="number">0</span> <span class="number">0</span> -<span class="number">50px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 宽高未知，结合了水平和垂直的代码 */</span></span><br><span class="line"><span class="selector-id">#container</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#center</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>, -<span class="number">50%</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="display-flex"><a href="#display-flex" class="headerlink" title="display: flex"></a>display: flex</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 主轴副轴都居中 */</span></span><br><span class="line"><span class="selector-id">#container</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>; /必须有高度/</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="浮动元素水平居中"><a href="#浮动元素水平居中" class="headerlink" title="浮动元素水平居中"></a>浮动元素水平居中</h3><p>除了以下两种，还看到有在父级元素外面加个爷爷元素，使父级元素在爷爷那里居中的方法解决的。</p><p><a href="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708165459689-582641273.png"><img src="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708165459689-582641273.png"></a></p><h3 id="屏幕上水平垂直居中"><a href="#屏幕上水平垂直居中" class="headerlink" title="屏幕上水平垂直居中"></a>屏幕上水平垂直居中</h3><p>屏幕上水平垂直居中十分常用，常规的登录及注册页面都需要用到。要保证较好的兼容性，还需要用到表布局。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.outer</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">display</span>: table;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.middle</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">display</span>: table-cell;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">vertical-align</span>: middle;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.inner</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin</span>: <span class="number">0</span> auto;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background</span>: <span class="number">#2b2b2b</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">padding</span>: <span class="number">2rem</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">max-width</span>: <span class="number">320px</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;middle&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">p</span>&gt;</span>水平垂直居中<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> CSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 布局 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>内容布局方式</title>
      <link href="/posts/d5b120e2/"/>
      <url>/posts/d5b120e2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>Flexbox是CSS3提供的用于布局的一套新属性</p><p>为了应对行内块级元素inline-block、浮动float和表格table产生的问题而生的。</p><p>其包含针对容器（弹性容器，flex container）和针对其直接子元素（弹性项，flex item）的两类属性。</p><p>Flexbox可以控制的弹性项有：方向、主轴与辅轴上的对齐与分布、大小（基于内容及可用空间）、顺序</p></blockquote><p>推荐一个超棒的网站：<a href="https://the-echoplex.net/flexyboxes/">Flex Boxes代码生成器</a></p><h2 id="🌸CSS3弹性盒新旧演变"><a href="#🌸CSS3弹性盒新旧演变" class="headerlink" title="🌸CSS3弹性盒新旧演变"></a>🌸CSS3弹性盒新旧演变</h2><p><a href="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415195733429-1134097193.png"><img src="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415195733429-1134097193.png"></a></p><h2 id="🌸浏览器支持与语法"><a href="#🌸浏览器支持与语法" class="headerlink" title="🌸浏览器支持与语法"></a>🌸浏览器支持与语法</h2><p>Flexbox已经得到主流浏览器较新版本的广泛支持。对于某些需要兼容的旧版本浏览器里（例如IE10及更早版本的Webkit浏览器），只要调整一下语法或提供商前缀，基本上也没问题。</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">display: -ms-flexbox;    <span class="regexp">/* IE浏览器 /</span></span><br><span class="line">display: -webkit-box;    <span class="regexp">/ Safari，Chrome /</span></span><br><span class="line">display: -moz-box;       <span class="regexp">/ Firefox */</span></span><br><span class="line">display: flex;</span><br></pre></td></tr></table></figure><h2 id="🌸属性速览"><a href="#🌸属性速览" class="headerlink" title="🌸属性速览"></a>🌸属性速览</h2><p><a href="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415174939859-1101509000.png"><img src="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415174939859-1101509000.png"></a></p><h2 id="🌸设置在flex盒子上"><a href="#🌸设置在flex盒子上" class="headerlink" title="🌸设置在flex盒子上"></a>🌸设置在flex盒子上</h2><h3 id="display-flex-以及-display-inline-flex"><a href="#display-flex-以及-display-inline-flex" class="headerlink" title="display: flex; 以及 display: inline-flex;"></a>display: flex; 以及 display: inline-flex;</h3><p>这行代码也相当于声明了flex-direction：row</p><p><code>display: inline-flex;</code> &#x2F;&#x2F; 空间无剩余</p><h3 id="flex-flow-复合属性"><a href="#flex-flow-复合属性" class="headerlink" title="flex-flow 复合属性"></a>flex-flow 复合属性</h3><blockquote><p>flex-flow: [ flex-direction ] || [ flex-wrap ]</p></blockquote><h3 id="flex-direction-主轴方向"><a href="#flex-direction-主轴方向" class="headerlink" title="flex-direction 主轴方向"></a>flex-direction 主轴方向</h3><p><a href="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415161347279-2013881275.png"><img src="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415161347279-2013881275.png"></a></p><h3 id="flex-wrap-单行-x2F-多行（堆叠方向）"><a href="#flex-wrap-单行-x2F-多行（堆叠方向）" class="headerlink" title="flex-wrap 单行&#x2F;多行（堆叠方向）"></a>flex-wrap 单行&#x2F;多行（堆叠方向）</h3><p><a href="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415174311787-728204020.png"><img src="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415174311787-728204020.png"></a></p><h3 id="justify-content-项目在主轴上的对齐方式"><a href="#justify-content-项目在主轴上的对齐方式" class="headerlink" title="justify-content 项目在主轴上的对齐方式"></a>justify-content 项目在主轴上的对齐方式</h3><p><a href="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415161151486-1932020889.png"><img src="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415161151486-1932020889.png"></a></p><p><strong>补充1. space-between</strong><br>第一个元素的边界与行的主起始位置的边界对齐，最后一个元素的边界与行的主结束位置的边距对齐，剩余的弹性盒项目则平均分布。</p><blockquote><p>如果最左边的剩余空间是负数，或该行只有一个子元素，则该值等效于’flex-start’</p></blockquote><p><strong>补充2. space-around</strong><br>两端保留子元素与子元素之间间距大小的一半。</p><blockquote><p>如果最左边的剩余空间是负数，或该行只有一个弹性盒项目，则该值等效于’center’</p></blockquote><p><strong>补充3. 设置margin</strong></p><p><a href="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415175853594-132499567.png"><img src="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415175853594-132499567.png"></a></p><h3 id="align-items-项目在交叉轴上的对齐方式"><a href="#align-items-项目在交叉轴上的对齐方式" class="headerlink" title="align-items 项目在交叉轴上的对齐方式"></a>align-items 项目在交叉轴上的对齐方式</h3><p>当增加Flex容器自身高度或者其中某一项的高度时：</p><p><a href="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415163511824-568105621.png"><img src="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415163511824-568105621.png"></a></p><p>对齐个别项：align-self（这是针对子项设置的属性）</p><h3 id="align-content"><a href="#align-content" class="headerlink" title="align-content"></a>align-content</h3><p>适用于：多行的弹性盒模型容器。该属性对单行弹性盒子模型无效。（即：带有 flex-wrap: nowrap）。</p><p><a href="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415163525452-1075840579.png"><img src="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415163525452-1075840579.png"></a></p><h2 id="🌸设置在flex盒子里的项目上"><a href="#🌸设置在flex盒子里的项目上" class="headerlink" title="🌸设置在flex盒子里的项目上"></a>🌸设置在flex盒子里的项目上</h2><h3 id="flex-复合属性"><a href="#flex-复合属性" class="headerlink" title="flex 复合属性"></a>flex 复合属性</h3><blockquote><p>flex: none | [ flex-grow ] || [ flex-shrink ] || [ flex-basis ]</p></blockquote><h3 id="flex-grow-项目的放大比例"><a href="#flex-grow-项目的放大比例" class="headerlink" title="flex-grow 项目的放大比例"></a>flex-grow 项目的放大比例</h3><p>在通过flex-basis为每一项设置了首选大小之后，如果还有剩余空间，该系数表示如何处理。</p><p>默认值为0，如果没有显示定义该属性，是不会拥有分配剩余空间权利的。</p><h3 id="flex-shrink-项目的缩小比例"><a href="#flex-shrink-项目的缩小比例" class="headerlink" title="flex-shrink 项目的缩小比例"></a>flex-shrink 项目的缩小比例</h3><p>当项目宽度总和超过容器宽度时，Flexbox会按照flex-shrink属性来决定如何收缩它们。</p><blockquote><p>flex-shrink的默认值为1，如果没有显示定义该属性，将会自动按照默认值1在所有因子相加之后计算比率来进行空间收缩。<br>某项的收缩空间大小 &#x3D; （本项shrink本项basis）&#x2F; （所有项的shrinkbasis之和）* 超出的空间大小</p></blockquote><h3 id="flex-basis-项目占据的主轴空间（分配多余空间之前）"><a href="#flex-basis-项目占据的主轴空间（分配多余空间之前）" class="headerlink" title="flex-basis 项目占据的主轴空间（分配多余空间之前）"></a>flex-basis 项目占据的主轴空间（分配多余空间之前）</h3><p>默认值：auto</p><p>控制项目在主轴方向上，经过修正之前的“首选”大小（width或height）。可以是长度值、比分比（相对容器的主轴而言），也可以是关键字auto</p><p>关键字auto的意思是这个项目可以从对应的属性（width或height）那里获得主尺寸——如果设置了响应属性的话。如果没有注尺寸，那么项目就根据其内容确定大小，有点类似浮动元素或行内块。</p><h3 id="align-self-设置单个项目不同于其余项目的对齐方式"><a href="#align-self-设置单个项目不同于其余项目的对齐方式" class="headerlink" title="align-self 设置单个项目不同于其余项目的对齐方式"></a>align-self 设置单个项目不同于其余项目的对齐方式</h3><p>比 align-items 多了个 auto 属性值，其它一样。</p><p>如果’align-self’的值为’auto’，则其计算值为元素的父元素的’align-items’值，如果其没有父元素，则计算值为’stretch’。</p><h3 id="order"><a href="#order" class="headerlink" title="order"></a>order</h3><p>用整数值来定义排列顺序，数值小的排在前面。可以为负值。</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> CSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> flex </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CSS属性继承</title>
      <link href="/posts/4a2f482e/"/>
      <url>/posts/4a2f482e/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>继承方式：</p><ul><li>initial（初始）&#x3D;&#x3D;&gt; 初始默认值，在规范中定义</li><li>inherit（继承）&#x3D;&#x3D;&gt; 继承父元素的属性值</li><li>unset（未设置）&#x3D;&#x3D;&gt; 重置为未设置的状态，将表现为initial或inherit</li></ul><h2 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h2><p><a href="http://caibaojian.com/css3/css3-quicksearch.htm">CSS3速查表</a>，这里面列出了所有新增的属性以及新增或者修改的属性值</p><p><a href="http://caibaojian.com/css3/properties/index.htm">css参考手册</a>，很好地一个常用网站</p><h2 id="CSS定位（不可继承）"><a href="#CSS定位（不可继承）" class="headerlink" title="CSS定位（不可继承）"></a>CSS定位（不可继承）</h2><p><a href="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708141339466-241712496.png"><img src="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708141339466-241712496.png"></a></p><h2 id="CSS布局（仅visibility可继承）"><a href="#CSS布局（仅visibility可继承）" class="headerlink" title="CSS布局（仅visibility可继承）"></a>CSS布局（仅visibility可继承）</h2><p><a href="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708141354619-1389204675.png"><img src="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708141354619-1389204675.png"></a></p><h2 id="CSS尺寸（不可继承）"><a href="#CSS尺寸（不可继承）" class="headerlink" title="CSS尺寸（不可继承）"></a>CSS尺寸（不可继承）</h2><p><a href="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708141410522-1534764225.png"><img src="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708141410522-1534764225.png"></a></p><h2 id="CSS外边距margin（不可继承）"><a href="#CSS外边距margin（不可继承）" class="headerlink" title="CSS外边距margin（不可继承）"></a>CSS外边距margin（不可继承）</h2><p><a href="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708141423044-784512809.png"><img src="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708141423044-784512809.png"></a></p><h2 id="CSS内边距padding（不可继承）"><a href="#CSS内边距padding（不可继承）" class="headerlink" title="CSS内边距padding（不可继承）"></a>CSS内边距padding（不可继承）</h2><p><a href="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708141450772-627107226.png"><img src="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708141450772-627107226.png"></a></p><h2 id="CSS边框（不可继承）"><a href="#CSS边框（不可继承）" class="headerlink" title="CSS边框（不可继承）"></a>CSS边框（不可继承）</h2><p><a href="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708141543955-940329188.png"><img src="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708141543955-940329188.png"></a></p><h2 id="CSS背景（不可继承）"><a href="#CSS背景（不可继承）" class="headerlink" title="CSS背景（不可继承）"></a>CSS背景（不可继承）</h2><p><a href="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708141608116-934613348.png"><img src="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708141608116-934613348.png"></a></p><h2 id="CSS颜色（仅color可继承）"><a href="#CSS颜色（仅color可继承）" class="headerlink" title="CSS颜色（仅color可继承）"></a>CSS颜色（仅color可继承）</h2><p><a href="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708141623993-1965328958.png"><img src="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708141623993-1965328958.png"></a></p><h2 id="CSS字体（全都可以继承）"><a href="#CSS字体（全都可以继承）" class="headerlink" title="CSS字体（全都可以继承）"></a>CSS字体（全都可以继承）</h2><p><a href="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708142822912-298243340.png"><img src="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708142822912-298243340.png"></a></p><h2 id="CSS文本（除了vertical-align，其它都可继承）"><a href="#CSS文本（除了vertical-align，其它都可继承）" class="headerlink" title="CSS文本（除了vertical-align，其它都可继承）#"></a>CSS文本（除了vertical-align，其它都可继承）<a href="https://www.cnblogs.com/L-xmin/p/13266592.html#2172176612">#</a></h2><p><a href="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708142845987-499174270.png"><img src="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708142845987-499174270.png"></a></p><h2 id="CSS文本装饰（部分可继承）"><a href="#CSS文本装饰（部分可继承）" class="headerlink" title="CSS文本装饰（部分可继承）"></a>CSS文本装饰（部分可继承）</h2><p><a href="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708142958177-850341900.png"><img src="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708142958177-850341900.png"></a></p><h2 id="CSS书写模式（除unicode-bidi）"><a href="#CSS书写模式（除unicode-bidi）" class="headerlink" title="CSS书写模式（除unicode-bidi）#"></a>CSS书写模式（除unicode-bidi）<a href="https://www.cnblogs.com/L-xmin/p/13266592.html#2524032270">#</a></h2><p><a href="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708143057906-1896869853.png"><img src="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708143057906-1896869853.png"></a></p><h2 id="CSS列表（全都可以继承）"><a href="#CSS列表（全都可以继承）" class="headerlink" title="CSS列表（全都可以继承）"></a>CSS列表（全都可以继承）</h2><p><a href="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708143213668-474131506.png"><img src="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708143213668-474131506.png"></a></p><h2 id="CSS表格（（除table-layout）"><a href="#CSS表格（（除table-layout）" class="headerlink" title="CSS表格（（除table-layout）"></a>CSS表格（（除table-layout）</h2><p><a href="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708143226175-818627219.png"><img src="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708143226175-818627219.png"></a></p><h2 id="CSS内容（仅quotes可继承）"><a href="#CSS内容（仅quotes可继承）" class="headerlink" title="CSS内容（仅quotes可继承）"></a>CSS内容（仅quotes可继承）</h2><p><a href="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708143249331-2007034601.png"><img src="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708143249331-2007034601.png"></a></p><h2 id="CSS用户界面（仅zoom和cursor可继承）"><a href="#CSS用户界面（仅zoom和cursor可继承）" class="headerlink" title="CSS用户界面（仅zoom和cursor可继承）"></a>CSS用户界面（仅zoom和cursor可继承）</h2><p><a href="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708143316889-639579109.png"><img src="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708143316889-639579109.png"></a></p><h2 id="CSS多列（不可继承）"><a href="#CSS多列（不可继承）" class="headerlink" title="CSS多列（不可继承）"></a>CSS多列（不可继承）</h2><p><a href="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708143335566-1520346271.png"><img src="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708143335566-1520346271.png"></a></p><h2 id="CSS弹性盒（新）（不可继承）"><a href="#CSS弹性盒（新）（不可继承）" class="headerlink" title="CSS弹性盒（新）（不可继承）"></a>CSS弹性盒（新）（不可继承）</h2><p><a href="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708143410383-318685595.png"><img src="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708143410383-318685595.png"></a></p><h2 id="CSS3变换（Transform）（不可继承）"><a href="#CSS3变换（Transform）（不可继承）" class="headerlink" title="CSS3变换（Transform）（不可继承）"></a>CSS3变换（Transform）（不可继承）</h2><p><a href="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708143442466-1950804005.png"><img src="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708143442466-1950804005.png"></a></p><h2 id="过渡Transition（不可继承）"><a href="#过渡Transition（不可继承）" class="headerlink" title="过渡Transition（不可继承）"></a>过渡Transition（不可继承）</h2><p><a href="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708143500135-349298880.png"><img src="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708143500135-349298880.png"></a></p><h2 id="动画（不可继承）"><a href="#动画（不可继承）" class="headerlink" title="动画（不可继承）"></a>动画（不可继承）</h2><p><a href="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708143522856-1408573172.png"><img src="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200708143522856-1408573172.png" alt="img"></a></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> CSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 继承 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>规范CSS的命名和书写</title>
      <link href="/posts/dadb628e/"/>
      <url>/posts/dadb628e/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="⭐CSS书写顺序"><a href="#⭐CSS书写顺序" class="headerlink" title="⭐CSS书写顺序"></a>⭐CSS书写顺序</h2><p>1.布局定位属性：<code>position</code>、<code>display</code>、<code>float</code>、<code>left</code>、<code>top</code>、<code>right</code>、<code>bottom</code>、<code>overflow</code>、<code>clear</code>、<code>z-index</code><br>2.自身大小属性：<code>width</code>、<code>height</code>、<code>padding</code>、<code>border</code>、<code>margin</code>、<code>background</code><br>3.文本样式：<code>font-family</code>、<code>font-style</code>、<code>font-weight</code>、<code>font-varient</code>、<code>color</code><br>4.文本属性：<code>text-align</code>、<code>vertical-align</code>、<code>text-wrap</code>、<code>text-transform</code>、<code>text-indent</code>、<code>text-decoration</code>、<code>line-height</code>、<code>letter-spacing</code>、<code>word-spacing</code>、<code>white-space</code>、<code>text-overflow</code>等<br>6.其他：<code>animation</code>、<code>transition</code>等<br><a href="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415133810849-531952416.png"><img src="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415133810849-531952416.png" alt="img"></a></p><h2 id="不要随意使用id选择器"><a href="#不要随意使用id选择器" class="headerlink" title="不要随意使用id选择器"></a>不要随意使用id选择器</h2><p>id在JS是唯一的，不能多次使用，而使用class类选择器却可以重复使用，另外id的优先级优先与class，所以id应该按需使用，而不能滥用。　</p><h2 id="使用CSS缩写属性"><a href="#使用CSS缩写属性" class="headerlink" title="使用CSS缩写属性"></a>使用CSS缩写属性</h2><p>比如 <code>padding</code>、<code>margin</code>、<code>font</code>等等<br><a href="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415135139422-683450207.png"><img src="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415135139422-683450207.png"></a></p><h2 id="去掉小数点前的-0"><a href="#去掉小数点前的-0" class="headerlink" title="去掉小数点前的 0"></a>去掉小数点前的 <code>0</code></h2><p><a href="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415135205188-122330220.png"><img src="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415135205188-122330220.png"></a></p><h2 id="16进制颜色代码尽量缩写"><a href="#16进制颜色代码尽量缩写" class="headerlink" title="16进制颜色代码尽量缩写"></a>16进制颜色代码尽量缩写</h2><p><a href="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415135214599-1545791733.png"><img src="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415135214599-1545791733.png"></a></p><h2 id="命名简写"><a href="#命名简写" class="headerlink" title="命名简写"></a>命名简写</h2><p><a href="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415135200098-211166850.png"><img src="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415135200098-211166850.png"></a></p><h2 id="连字符CSS选择器命名规范"><a href="#连字符CSS选择器命名规范" class="headerlink" title="连字符CSS选择器命名规范"></a>连字符CSS选择器命名规范</h2><ol><li>长名称或词组可以使用中横线 <code>-</code> 来为选择器命名。　　</li><li>不建议使用 <code>_</code>下划线来命名CSS选择器，为什么呢?　　<ul><li>输入的时候少按一个shift键;　</li><li>浏览器兼容问题 (比如使用_tips的选择器命名，在IE6是无效的)　　</li><li>能良好区分JavaScript变量命名(JS变量命名是用 <code>_</code>)<br><a href="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415135229177-2085552021.png"><img src="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415135229177-2085552021.png"></a></li></ul></li></ol><h2 id="为选择器添加状态前缀"><a href="#为选择器添加状态前缀" class="headerlink" title="为选择器添加状态前缀"></a>为选择器添加状态前缀</h2><p>有时候可以给选择器添加一个表示状态的前缀，让语义更明了，比如下图是添加了“.is-”前缀：</p><p><a href="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415134554364-1023346548.png"><img src="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415134554364-1023346548.png"></a></p><h2 id="常用的CSS命名规则"><a href="#常用的CSS命名规则" class="headerlink" title="常用的CSS命名规则"></a>常用的CSS命名规则</h2><p><a href="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415135955800-1758214142.png"><img src="https://img2020.cnblogs.com/blog/1019981/202004/1019981-20200415135955800-1758214142.png" alt="img"></a></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> CSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JS面试手写代码</title>
      <link href="/posts/873aef40/"/>
      <url>/posts/873aef40/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="手写防抖和节流"><a href="#手写防抖和节流" class="headerlink" title="手写防抖和节流"></a>手写防抖和节流</h2><a href="/posts/100fa4c9/" title="防抖与节流">防抖与节流</a><h2 id="实现Promise（⭐）"><a href="#实现Promise（⭐）" class="headerlink" title="实现Promise（⭐）"></a>实现Promise（⭐）</h2><h2 id="实现generator的自动执行器"><a href="#实现generator的自动执行器" class="headerlink" title="实现generator的自动执行器"></a>实现generator的自动执行器</h2><h2 id="手写通用事件绑定和事件代理"><a href="#手写通用事件绑定和事件代理" class="headerlink" title="手写通用事件绑定和事件代理"></a>手写通用事件绑定和事件代理</h2><h2 id="手写ajax"><a href="#手写ajax" class="headerlink" title="手写ajax"></a>手写ajax</h2><h2 id="手写JsonP"><a href="#手写JsonP" class="headerlink" title="手写JsonP"></a>手写JsonP</h2><h2 id="实现函数柯里化"><a href="#实现函数柯里化" class="headerlink" title="实现函数柯里化"></a>实现函数柯里化</h2><h2 id="路由Hash"><a href="#路由Hash" class="headerlink" title="路由Hash"></a>路由Hash</h2><h2 id="路由History5"><a href="#路由History5" class="headerlink" title="路由History5"></a>路由History5</h2><h2 id="实现Array-reduce"><a href="#实现Array-reduce" class="headerlink" title="实现Array.reduce()"></a>实现Array.reduce()</h2><h2 id="实现Array-flat-以及数组展平"><a href="#实现Array-flat-以及数组展平" class="headerlink" title="实现Array.flat() 以及数组展平"></a>实现Array.flat() 以及数组展平</h2><h2 id="数组去重"><a href="#数组去重" class="headerlink" title="数组去重"></a>数组去重</h2><h2 id="Object-is"><a href="#Object-is" class="headerlink" title="Object.is()"></a>Object.is()</h2><h2 id="实现JSon-stringfy和JSON-parse"><a href="#实现JSon-stringfy和JSON-parse" class="headerlink" title="实现JSon.stringfy和JSON.parse"></a>实现JSon.stringfy和JSON.parse</h2><h2 id="JavaScript中的拷贝函数"><a href="#JavaScript中的拷贝函数" class="headerlink" title="JavaScript中的拷贝函数"></a>JavaScript中的拷贝函数</h2>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> JS面试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JS手写代码 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>内容布局方式-float</title>
      <link href="/posts/b1b6556a/"/>
      <url>/posts/b1b6556a/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="元素浮动的特点"><a href="#元素浮动的特点" class="headerlink" title="元素浮动的特点"></a>元素浮动的特点</h3><ol><li>元素设置float会脱离文档流，不会再占用空间</li><li>非浮动元素几乎不受float元素影响</li><li>非浮动元素中的文本内容会记住float元素的大小，并在排布时避开它，为其留出响应的空间</li></ol><h3 id="浮动的意义"><a href="#浮动的意义" class="headerlink" title="浮动的意义"></a>浮动的意义</h3><p>浮动的意义原本仅是用来让<strong>文字环绕</strong>在图片周围而已。</p><p><img src="https://segmentfault.com/img/remote/1460000015097515" alt="原始效果" title="原始效果"></p><p><img src="https://segmentfault.com/img/remote/1460000015097516" alt="图片浮动以后的效果" title="图片浮动以后的效果"></p><p>通过上图可以看到，设置图片左浮动可以将图片 <strong>从正常文档流中抽取出来</strong> ，后面的元素会忽略浮动元素原来的位置，所以可以看到以块元素显示的span标签插入到了图片下面， <strong>但是</strong> ，我们发现文字却不会嵌入到图片下面，因为这就是 <strong>浮动最纯粹的意义–让文字环绕在图片周围</strong>。</p><p><strong>PS: 如果想让文字也插入到浮动元素下面，可以通过设置绝对定位来实现。</strong></p><h3 id="浮动的作用"><a href="#浮动的作用" class="headerlink" title="浮动的作用"></a>浮动的作用</h3><ul><li>两栏：顶部条</li><li>三栏：内容区</li><li>四栏：导航</li><li>平均布局：产品展示区</li></ul><p>因为浮动可以让块状元素并排显示，所以经常用来做导航栏，内容分块栏等布局。</p><p><img src="https://segmentfault.com/img/remote/1460000015097517" alt="导航栏" title="导航栏"></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// html代码</span><br><span class="line"><span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">&quot;section2&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>产品中心<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>服务中心<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>新闻中心<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>客户见证<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>招贤纳士<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// css代码</span><br><span class="line"><span class="selector-class">.section2</span> <span class="selector-tag">li</span> &#123;</span><br><span class="line">  <span class="attribute">list-style</span>: none;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#1249c3</span>;</span><br><span class="line">  <span class="attribute">border-right</span>: <span class="number">1px</span> solid <span class="number">#a0a2a2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.section2</span> <span class="selector-tag">li</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="清除浮动的理由-解决高度塌陷问题"><a href="#清除浮动的理由-解决高度塌陷问题" class="headerlink" title="清除浮动的理由(解决高度塌陷问题)"></a>清除浮动的理由(解决高度塌陷问题)</h3><p><img src="https://segmentfault.com/img/remote/1460000015097518" alt="未清除浮动" title="未清除浮动"></p><p>通过上图可以看到，当三个板块左浮动以后，因为它们脱离了正常文档流，所以它们的父元素ul在不设置高度的情况下，无法被子元素撑开(能够看到背景色是因为我设置了ul的padding为10px)，所以当你在后边新增元素的时候，自然会排在ul后边，也就是插入到了3个浮动的板块下面。<br><strong>这并不是我们想要的，这就是要清除浮动的原因。</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// html代码</span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>互动板块 li<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>学习板块 li<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>留言板块 li<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      我是本应该包裹在3个板块外面的父元素ul</span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;new&quot;</span>&gt;</span>我是跟在ul后面的新div<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">// css代码</span><br><span class="line"><span class="selector-tag">ul</span> &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#b7db05</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">ul</span> <span class="selector-tag">li</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#e3e3e3</span>;</span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.new</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#1be751</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="如何清除浮动"><a href="#如何清除浮动" class="headerlink" title="如何清除浮动"></a>如何清除浮动</h3><p>清除浮动本质：浏览器在非浮动元素的上方添加足够大的外边距，从而将元素的上边沿垂直向下移动到浮动元素的下方。</p><h4 id="方法1：给父级元素定义高度height"><a href="#方法1：给父级元素定义高度height" class="headerlink" title="方法1：给父级元素定义高度height"></a>方法1：给父级元素定义高度height</h4><p>原理：给父级定义固定高度（height），能解决父级无法获取高度得问题<br>优点：代码简洁<br>缺点：高度被固定死了，是适合内容固定不变的模块（不推荐使用）</p><h4 id="方法2：新增一个空元素并设置clear-both"><a href="#方法2：新增一个空元素并设置clear-both" class="headerlink" title="方法2：新增一个空元素并设置clear: both"></a>方法2：新增一个空元素并设置clear: both</h4><p>原理：在最后一个浮动的 li 元素后边新增一个空的块状元素div，并设置clear: both;以清除所有浮动。</p><p>优点：浏览器支持好</p><p>缺点：多出了很多空的p标签，如果页面中浮动模块多的话，就会出现很多的空置p了，这样感觉视乎不是太令人满意（不推荐使用）</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// html代码</span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>互动板块 li<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>学习板块 li<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>留言板块 li<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  我是本应该包裹在3个板块外面的父元素ul</span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;clear:both;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span>        // 新增代码</span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;new&quot;</span>&gt;</span>我是跟在ul后面的新div<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://segmentfault.com/img/remote/1460000015097519" alt="清除浮动 - 最后一个浮动元素后边新增空div" title="清除浮动 - 最后一个浮动元素后边新增空div"></p><p> <strong>效果</strong> ： ul后边的div元素确实可以在浮动元素下边排列，并且设置margin、padding等也是针对浮动元素的下边框。<br> <strong>缺点</strong> ： 多出了一个冗余标签，并没有任何结构意义。</p><h4 id="方法3：让父级元素也一并浮起来"><a href="#方法3：让父级元素也一并浮起来" class="headerlink" title="方法3：让父级元素也一并浮起来"></a>方法3：让父级元素也一并浮起来</h4><p>这样做可以初步解决当前的浮动问题。但是也让父级浮动起来了，又会产生新的浮动问题。 不推荐使用</p><h4 id="方法4：父级元素定义-display-table"><a href="#方法4：父级元素定义-display-table" class="headerlink" title="方法4：父级元素定义 display: table"></a>方法4：父级元素定义 display: table</h4><p>原理：将p属性强制变成表格<br>缺点：会产生新的未知问题（不推荐使用）</p><h4 id="方法5：设置父元素为overflow-hidden或者overflow-auto。"><a href="#方法5：设置父元素为overflow-hidden或者overflow-auto。" class="headerlink" title="方法5：设置父元素为overflow: hidden或者overflow: auto。"></a>方法5：设置父元素为overflow: hidden或者overflow: auto。</h4><p>原理：这个方法的关键在于触发了BFC。在IE6中还需要触发 hasLayout（zoom：1）<br>优点：代码简介，不存在结构和语义化问题<br>缺点：无法显示需要溢出的元素（亦不太推荐使用）</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// css代码</span><br><span class="line"><span class="selector-tag">ul</span> &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#e7a5b8</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://segmentfault.com/img/remote/1460000015097520" alt="清除浮动 - 父元素设置overflow" title="清除浮动 - 父元素设置overflow"></p><p> <strong>效果</strong> ： 对于ul后面的元素来说，它们可以在浮动元素下边依次排列了。<br> <strong>缺点</strong> ： 采用这种overflow方法时可能会对采用定位position的元素产生影响，因为在ul的范围内，超出的部分将会被隐藏，所以如果定位元素处在ul超出的范围内，那么会被隐藏。</p><h4 id="方法6：父级元素定义伪类-after-和-zoom"><a href="#方法6：父级元素定义伪类-after-和-zoom" class="headerlink" title="方法6：父级元素定义伪类:after 和 zoom"></a>方法6：父级元素定义伪类:after 和 zoom</h4><p>采用伪类方法，在最后一个浮动元素的后边，添加clear: both。</p><p>原理：IE8以上和非IE浏览器才支持:after，原理和方法2有点类似，zoom(IE专有属性)可解决ie6,ie7浮动问题<br>优点：结构和语义化完全正确，代码量也适中，可重复利用率（建议定义公共类）<br>缺点：代码不是非常简洁（极力推荐使用）</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// css代码</span><br><span class="line"><span class="selector-tag">ul</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="attribute">clear</span>: both;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://segmentfault.com/img/remote/1460000015097521" alt="清除浮动 - 伪类after" title="清除浮动 - 伪类after"></p><p><img src="https://segmentfault.com/img/remote/1460000015097522" alt="浏览器解析" title="浏览器解析"></p><p> <strong>效果</strong> ： 很好的清除了浮动带来的影响，并且没有附加作用，也没有新增无语义的标签。<br> <strong>缺点</strong> ： 暂时还没发现。</p><h3 id="float会修改元素的display值"><a href="#float会修改元素的display值" class="headerlink" title="float会修改元素的display值"></a>float会修改元素的display值</h3><p>由于float意味着使用块布局，它在某些情况下会修改display 值的计算值：</p><p><a href="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200710121645462-1496337156.png"><img src="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200710121645462-1496337156.png" alt="img"></a></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> CSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> float </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>函数重载</title>
      <link href="/posts/eefc49a4/"/>
      <url>/posts/eefc49a4/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p><strong>重载</strong>是指函数或者方法有相同的名称，但是参数个数或类型不相同的情形，这样的同名不同参的函数或者方法之间，互相称之为重载函数或方法。</p><h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><h3 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h3><p>我们有一个people对象</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">var people</span> = &#123;</span><br><span class="line">  values: [<span class="string">&#x27;Dean Edwards&#x27;</span>, <span class="string">&#x27;Sam Stephenson&#x27;</span>, <span class="string">&#x27;Alex Russell&#x27;</span>, <span class="string">&#x27;Dean Tom&#x27;</span>]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>想要实现一个find方法，不传参数的时候，输出所有名字，只传1个参数的时候，输出所有fristName和参数相同的名字，传2个参数的时候，输出所有firstName和lastName和2个参数分别相同的名字。</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">people.find();                          <span class="regexp">//</span> [<span class="string">&quot;Dean Edwards&quot;</span>, <span class="string">&quot;Sam Stephenson&quot;</span>, <span class="string">&quot;Alex Russell&quot;</span>, <span class="string">&quot;Dean Tom&quot;</span>]</span><br><span class="line">people.find(<span class="string">&#x27;Dean&#x27;</span>);                    <span class="regexp">//</span> [<span class="string">&quot;Dean Edwards&quot;</span>, <span class="string">&quot;Dean Tom&quot;</span>]</span><br><span class="line">people.find(<span class="string">&#x27;Dean&#x27;</span>, <span class="string">&#x27;Edwards&#x27;</span>);            <span class="regexp">//</span> [<span class="string">&quot;Dean Edwards&quot;</span>]</span><br></pre></td></tr></table></figure><h3 id="利用arguments和switch实现重载"><a href="#利用arguments和switch实现重载" class="headerlink" title="利用arguments和switch实现重载"></a>利用arguments和switch实现重载</h3><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">people.<span class="built_in">find</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  switch (arguments.<span class="built_in">length</span>) &#123;</span><br><span class="line">    case <span class="number">0</span>:</span><br><span class="line">      <span class="keyword">return</span> this.values;</span><br><span class="line"></span><br><span class="line">    case <span class="number">1</span>:</span><br><span class="line">      <span class="keyword">return</span> this.values.<span class="built_in">filter</span>(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> firstName = arguments[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">return</span> value.<span class="built_in">indexOf</span>(firstName) !== <span class="number">-1</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">    case <span class="number">2</span>:</span><br><span class="line">      <span class="keyword">return</span> this.values.<span class="built_in">filter</span>(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> fullName = <span class="string">`<span class="subst">$&#123;arguments[<span class="number">0</span>]&#125;</span> <span class="subst">$&#123;arguments[<span class="number">1</span>]&#125;</span>`</span>;</span><br><span class="line">        <span class="keyword">return</span> value.<span class="built_in">indexOf</span>(fullName) !== <span class="number">-1</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(people.<span class="built_in">find</span>());                 <span class="comment">// [&quot;Dean Edwards&quot;, &quot;Sam Stephenson&quot;, &quot;Alex Russell&quot;, &quot;Dean Tom&quot;]</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(people.<span class="built_in">find</span>(<span class="string">&#x27;Dean&#x27;</span>));           <span class="comment">// [&quot;Dean Edwards&quot;, &quot;Dean Tom&quot;]</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(people.<span class="built_in">find</span>(<span class="string">&#x27;Dean&#x27;</span>, <span class="string">&#x27;Edwards&#x27;</span>));   <span class="comment">// [&quot;Dean Edwards&quot;]</span></span><br></pre></td></tr></table></figure><h3 id="利用arguments和闭包实现重载"><a href="#利用arguments和闭包实现重载" class="headerlink" title="利用arguments和闭包实现重载"></a>利用arguments和闭包实现重载</h3><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">addMethod</span> (<span class="params">object, name, fn</span>) &#123;</span><br><span class="line">  <span class="comment">// 把前一次添加的方法存在一个临时变量old中</span></span><br><span class="line">  <span class="keyword">var</span> old = object[name];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 重写object[name]方法</span></span><br><span class="line">  object[name] = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (fn.<span class="built_in">length</span> === arguments.<span class="built_in">length</span>) &#123;</span><br><span class="line">      <span class="comment">// 如果调用object[name]方法时，如果实参和形参个数一致，则直接调用</span></span><br><span class="line">      <span class="keyword">return</span> fn.apply(this, arguments);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">typeof</span> old === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">      <span class="comment">// 如果实参形参不一致，判断old是否是函数，如果是，就调用old</span></span><br><span class="line">      <span class="keyword">return</span> old.apply(this, arguments);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">addMethod(people, <span class="string">&#x27;find&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> this.values;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">addMethod(people, <span class="string">&#x27;find&#x27;</span>, <span class="keyword">function</span>(<span class="params">firstName</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> this.values.<span class="built_in">filter</span>(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> value.<span class="built_in">indexOf</span>(firstName) !== <span class="number">-1</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">addMethod(people, <span class="string">&#x27;find&#x27;</span>, <span class="keyword">function</span>(<span class="params">firstName, lastName</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> this.values.<span class="built_in">filter</span>(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> fullName = <span class="string">`<span class="subst">$&#123;firstName&#125;</span> <span class="subst">$&#123;lastName&#125;</span>`</span>;</span><br><span class="line">    <span class="keyword">return</span> value.<span class="built_in">indexOf</span>(fullName) !== <span class="number">-1</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(people.<span class="built_in">find</span>());                     <span class="comment">// [&quot;Dean Edwards&quot;, &quot;Sam Stephenson&quot;, &quot;Alex Russell&quot;, &quot;Dean Tom&quot;]</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(people.<span class="built_in">find</span>(<span class="string">&#x27;Dean&#x27;</span>));               <span class="comment">// [&quot;Dean Edwards&quot;, &quot;Dean Tom&quot;]</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(people.<span class="built_in">find</span>(<span class="string">&#x27;Dean&#x27;</span>, <span class="string">&#x27;Edwards&#x27;</span>));    <span class="comment">// [&quot;Dean Edwards&quot;]</span></span><br></pre></td></tr></table></figure><p>这里addMethod(object, name, fn)方法是核心。我们着重分析一下为什么这里会有闭包，可以保存上一个注册的函数。</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> addMethod (<span class="keyword">object</span>, <span class="type">name</span>, fn) &#123;</span><br><span class="line">  // <span class="keyword">object</span>, <span class="type">name</span>, fn是传入的<span class="number">3</span>个参数</span><br><span class="line">  var <span class="built_in">old</span> = <span class="keyword">object</span>[<span class="type">name</span>];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">object</span>[<span class="type">name</span>] = <span class="keyword">function</span> () &#123;</span><br><span class="line">    // 这里对<span class="built_in">old</span>和fn进行了引用</span><br><span class="line">    <span class="keyword">if</span> (fn.length === arguments.length) &#123;</span><br><span class="line">      <span class="keyword">return</span> fn.apply(this, arguments);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (typeof <span class="built_in">old</span> === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">old</span>.apply(this, arguments);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>object是另外一个引用对象，它的一个方法中引用了old和fn，所以对于addMethod来说，它的局部变量在addMethod函数执行完后，仍然被另外的变量所引用，导致它的 <strong>执行环境无法销毁，所以产生了闭包</strong> 。</p><p>因此，每次调用addMethod，都会有一个执行环境保存着当时的old和fn，所以在调用people.find()的时候可以找到当时注入的fn，实现函数重载。</p><h3 id="利用Proxy和arguments实现重载"><a href="#利用Proxy和arguments实现重载" class="headerlink" title="利用Proxy和arguments实现重载"></a>利用Proxy和arguments实现重载</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> proxy = <span class="keyword">new</span> <span class="title class_">Proxy</span>(people, &#123;</span><br><span class="line">  <span class="attr">get</span>: <span class="keyword">function</span> (<span class="params">target, key, receiver</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (key === <span class="string">&#x27;find&#x27;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="variable language_">arguments</span>.<span class="property">length</span>) &#123;</span><br><span class="line">          <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">values</span>;</span><br><span class="line">  </span><br><span class="line">          <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">values</span>.<span class="title function_">filter</span>(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">              <span class="keyword">var</span> firstName = <span class="variable language_">arguments</span>[<span class="number">0</span>];</span><br><span class="line">              <span class="keyword">return</span> value.<span class="title function_">indexOf</span>(firstName) !== -<span class="number">1</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line">            &#125;);</span><br><span class="line">  </span><br><span class="line">          <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">values</span>.<span class="title function_">filter</span>(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">              <span class="keyword">var</span> fullName = <span class="string">`<span class="subst">$&#123;<span class="variable language_">arguments</span>[<span class="number">0</span>]&#125;</span> <span class="subst">$&#123;<span class="variable language_">arguments</span>[<span class="number">1</span>]&#125;</span>`</span>;</span><br><span class="line">              <span class="keyword">return</span> value.<span class="title function_">indexOf</span>(fullName) !== -<span class="number">1</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Reflect</span>.<span class="title function_">get</span>(target , key , receiver);</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="attr">set</span>: <span class="keyword">function</span> (<span class="params">target, key, value, receiver</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Reflect</span>.<span class="title function_">set</span>(target, key, value, receiver);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(proxy.<span class="title function_">find</span>());                     <span class="comment">// [&quot;Dean Edwards&quot;, &quot;Sam Stephenson&quot;, &quot;Alex Russell&quot;, &quot;Dean Tom&quot;]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(proxy.<span class="title function_">find</span>(<span class="string">&#x27;Dean&#x27;</span>));               <span class="comment">// [&quot;Dean Edwards&quot;, &quot;Dean Tom&quot;]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(proxy.<span class="title function_">find</span>(<span class="string">&#x27;Dean&#x27;</span>, <span class="string">&#x27;Edwards&#x27;</span>));   <span class="comment">// [&quot;Dean Edwards&quot;]</span></span><br></pre></td></tr></table></figure><p>这样写其实感觉有点画蛇添足了，就当成是另外一种思路吧。</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>JavaScript可以实现函数重载，主要有两种思想：</p><ol><li>利用arguments类数组来判断接收参数的个数</li><li>利用闭包保存以前注册进来的同名函数</li></ol>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 函数式编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 函数重载 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>队列</title>
      <link href="/posts/b6c47025/"/>
      <url>/posts/b6c47025/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="一、定义"><a href="#一、定义" class="headerlink" title="一、定义"></a>一、定义</h2><p><strong>队列</strong>是遵循FIFO（First In First Out，先进先出）原则的一组有序的项。队列在尾部添加新元素，并从顶部移除元素。最新添加的元素必须排在队列的末尾。</p><h2 id="二、队列的实现"><a href="#二、队列的实现" class="headerlink" title="二、队列的实现"></a>二、队列的实现</h2><h3 id="2-1-普通队列"><a href="#2-1-普通队列" class="headerlink" title="2.1 普通队列"></a>2.1 普通队列</h3><p>创建普通队列类：</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Queue类</span></span><br><span class="line">function Queue () &#123;</span><br><span class="line">  <span class="keyword">this</span>.items = [];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">this</span>.enqueue = enqueue;</span><br><span class="line">  <span class="keyword">this</span>.dequeue = dequeue;</span><br><span class="line">  <span class="keyword">this</span>.front = front;</span><br><span class="line">  <span class="keyword">this</span>.isEmpty = isEmpty;</span><br><span class="line">  <span class="keyword">this</span>.size = size;</span><br><span class="line">  <span class="keyword">this</span>.clear = clear;</span><br><span class="line">  <span class="keyword">this</span>.print = print;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>队列里面有一些声明的辅助方法：</p><ul><li>enqueue(element)：向队列尾部添加新项</li><li>dequeue()：移除队列的第一项（即排在队列最前面的项），并返回被移除的元素</li><li>front()：返回队列中第一个元素，队列不做任何变动，和Stack的peek()方法类似</li><li>isEmpty()：如果队列中不包含任何元素，返回true，否则返回false</li><li>size()：返回队列包含的元素个数，与数组的length属性类似</li><li>print()：打印队列中的元素</li><li>clear()：清空整个队列</li></ul><p>下面来实现这些辅助方法：</p><figure class="highlight qml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 向队列尾部添加元素</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">enqueue</span> (<span class="params">element</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.items.push(element);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 移除队列的第一个元素，并返回被移除的元素</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dequeue</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.items.shift();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回队列的第一个元素</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">front</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.items[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断是否为空队列</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isEmpty</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.items.length === <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取队列的长度</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">size</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.items.length;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 清空队列</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clear</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.items = [];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 打印队列里的元素</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">print</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.items.toString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>创建普通队列实例进行测试：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">//</span> 创建Queue实例</span><br><span class="line">var queue = new Queue();</span><br><span class="line"></span><br><span class="line">console.log(queue.isEmpty());     <span class="regexp">//</span> true</span><br><span class="line">queue.enqueue(<span class="string">&quot;John&quot;</span>);            <span class="regexp">//</span> undefined</span><br><span class="line">queue.enqueue(<span class="string">&quot;Jack&quot;</span>);            <span class="regexp">//</span> undefined</span><br><span class="line">queue.enqueue(<span class="string">&quot;Camila&quot;</span>);          <span class="regexp">//</span> undefined</span><br><span class="line">queue.print();                    <span class="regexp">//</span> <span class="string">&quot;John,Jack,Camila&quot;</span></span><br><span class="line">console.log(queue.size());        <span class="regexp">//</span> <span class="number">3</span></span><br><span class="line">console.log(queue.isEmpty());     <span class="regexp">//</span> false</span><br><span class="line">queue.dequeue();                  <span class="regexp">//</span> <span class="string">&quot;John&quot;</span></span><br><span class="line">queue.dequeue();                  <span class="regexp">//</span> <span class="string">&quot;Jack&quot;</span></span><br><span class="line">queue.print();                    <span class="regexp">//</span> <span class="string">&quot;Camila&quot;</span></span><br><span class="line">queue.clear();                    <span class="regexp">//</span> undefined</span><br><span class="line">console.log(queue.size());        <span class="regexp">//</span> <span class="number">0</span></span><br></pre></td></tr></table></figure><h3 id="2-2-优先队列"><a href="#2-2-优先队列" class="headerlink" title="2.2 优先队列"></a>2.2 优先队列</h3><h3 id="2-2-1-定义"><a href="#2-2-1-定义" class="headerlink" title="2.2.1 定义"></a>2.2.1 定义</h3><p>普通队列的添加和移除只依赖于先后顺序，先来的先添加，后来的后添加，然后按照先后顺序依次从队列移除。</p><p>但是，还有一种队列叫 <strong>优先队列</strong> ，元素的添加和移除是依赖优先级的。</p><h3 id="2-2-2-分类"><a href="#2-2-2-分类" class="headerlink" title="2.2.2 分类"></a>2.2.2 分类</h3><p><strong>优先队列</strong>分为两类：</p><ol><li><strong>最小优先队列</strong></li><li><strong>最大优先队列</strong></li></ol><p><strong>最小优先队列</strong>是把优先级的值最小的元素被放置到队列的最前面（代表最高的优先级）。比如有四个元素：”John”, “Jack”, “Camila”, “Tom”，他们的优先级值分别为4，3，2，1。</p><p>那么<strong>最小优先队列排序</strong>应该为： <strong>“Tom”，”Camila”，”Jack”，”John”</strong> 。</p><p><strong>最大优先队列</strong>正好相反，把优先级值最大的元素放置在队列的最前面，以上面的为例，最大优先队列排序应该为： <strong>“John”, “Jack”, “Camila”, “Tom”</strong> 。</p><h3 id="2-2-2-实现"><a href="#2-2-2-实现" class="headerlink" title="2.2.2 实现"></a>2.2.2 实现</h3><p>实现一个优先队列，有两种选项：</p><ol><li>设置优先级，根据优先级正确添加元素，然后和普通队列一样正常移除</li><li>设置优先级，和普通队列一样正常按顺序添加，然后根据优先级移除</li></ol><p>这里最小优先队列和最大优先队列我都采用第一种方式实现，大家可以尝试一下第二种。</p><p>所以我只重写enqueue()方法和print()方法，其他方法和上面的普通队列完全相同。完整代码见<a href="https://link.segmentfault.com/?enc=f74iKZK1hOzni+os1RhsPQ==.2Yy4oS0V0gPCT/R6MOL2CJy0e29QqAdWy8UeNizDv7DkwuzgJd74l0TPYsBvE1zR">我的github</a>。</p><p> <strong>实现最小优先队列</strong> ：</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义最小优先队列</span></span><br><span class="line">function MinPriorityQueue () &#123;</span><br><span class="line">  <span class="keyword">this</span>.items = [];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">this</span>.enqueue = enqueue;</span><br><span class="line">  <span class="keyword">this</span>.dequeue = dequeue;</span><br><span class="line">  <span class="keyword">this</span>.front = front;</span><br><span class="line">  <span class="keyword">this</span>.isEmpty = isEmpty;</span><br><span class="line">  <span class="keyword">this</span>.size = size;</span><br><span class="line">  <span class="keyword">this</span>.clear = clear;</span><br><span class="line">  <span class="keyword">this</span>.print = print;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> <strong>实现最小优先队列enqueue()方法和print()方法</strong> ：</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 优先队列添加元素，要根据优先级判断在队列中的插入顺序</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">enqueue</span> (<span class="params">element, priority</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> queueElement = &#123;</span><br><span class="line">    <span class="attr">element</span>: element,</span><br><span class="line">    <span class="attr">priority</span>: priority</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (this.<span class="built_in">isEmpty</span>()) &#123;</span><br><span class="line">    this.items.<span class="built_in">push</span>(queueElement);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> added = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; this.size(); i++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (queueElement.priority &lt; this.items[i].priority) &#123;</span><br><span class="line">        this.items.<span class="built_in">splice</span>(i, <span class="number">0</span>, queueElement);</span><br><span class="line">        added = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">break</span> ;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!added) &#123;</span><br><span class="line">      this.items.<span class="built_in">push</span>(queueElement);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 打印队列里的元素</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">print</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> strArr = [];</span><br><span class="line"></span><br><span class="line">  strArr = this.items.<span class="built_in">map</span>(<span class="keyword">function</span> (<span class="params">item</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;item.element&#125;</span>-&gt;<span class="subst">$&#123;item.priority&#125;</span>`</span>;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.<span class="built_in">log</span>(strArr.toString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最小优先队列测试：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">//</span> 创建最小优先队列minPriorityQueue实例</span><br><span class="line">var minPriorityQueue = new MinPriorityQueue();</span><br><span class="line"></span><br><span class="line">console.log(minPriorityQueue.isEmpty());     <span class="regexp">//</span> true</span><br><span class="line">minPriorityQueue.enqueue(<span class="string">&quot;John&quot;</span>, <span class="number">1</span>);         <span class="regexp">//</span> undefined</span><br><span class="line">minPriorityQueue.enqueue(<span class="string">&quot;Jack&quot;</span>, <span class="number">3</span>);         <span class="regexp">//</span> undefined</span><br><span class="line">minPriorityQueue.enqueue(<span class="string">&quot;Camila&quot;</span>, <span class="number">2</span>);       <span class="regexp">//</span> undefined</span><br><span class="line">minPriorityQueue.enqueue(<span class="string">&quot;Tom&quot;</span>, <span class="number">3</span>);          <span class="regexp">//</span> undefined</span><br><span class="line">minPriorityQueue.print();                    <span class="regexp">//</span> <span class="string">&quot;John-&gt;1,Camila-&gt;2,Jack-&gt;3,Tom-&gt;3&quot;</span></span><br><span class="line">console.log(minPriorityQueue.size());        <span class="regexp">//</span> <span class="number">4</span></span><br><span class="line">console.log(minPriorityQueue.isEmpty());     <span class="regexp">//</span> false</span><br><span class="line">minPriorityQueue.dequeue();                  <span class="regexp">//</span> &#123;element: <span class="string">&quot;John&quot;</span>, priority: <span class="number">1</span>&#125;</span><br><span class="line">minPriorityQueue.dequeue();                  <span class="regexp">//</span> &#123;element: <span class="string">&quot;Camila&quot;</span>, priority: <span class="number">2</span>&#125;</span><br><span class="line">minPriorityQueue.print();                    <span class="regexp">//</span> <span class="string">&quot;Jack-&gt;3,Tom-&gt;3&quot;</span></span><br><span class="line">minPriorityQueue.clear();                    <span class="regexp">//</span> undefined</span><br><span class="line">console.log(minPriorityQueue.size());        <span class="regexp">//</span> <span class="number">0</span></span><br></pre></td></tr></table></figure><p><strong>实现最大优先队列</strong></p><p>最大优先队列只要将优先级的判断改为大于号”&gt;”就可以了：</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 最大优先队列MaxPriorityQueue类</span></span><br><span class="line">function MaxPriorityQueue () &#123;</span><br><span class="line">  <span class="keyword">this</span>.items = [];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">this</span>.enqueue = enqueue;</span><br><span class="line">  <span class="keyword">this</span>.dequeue = dequeue;</span><br><span class="line">  <span class="keyword">this</span>.front = front;</span><br><span class="line">  <span class="keyword">this</span>.isEmpty = isEmpty;</span><br><span class="line">  <span class="keyword">this</span>.size = size;</span><br><span class="line">  <span class="keyword">this</span>.clear = clear;</span><br><span class="line">  <span class="keyword">this</span>.print = print;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 优先队列添加元素，要根据优先级判断在队列中的插入顺序</span></span><br><span class="line">function enqueue (element, priority) &#123;</span><br><span class="line">  <span class="keyword">var</span> queueElement = &#123;</span><br><span class="line">    element: element,</span><br><span class="line">    priority: priority</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.isEmpty()) &#123;</span><br><span class="line">    <span class="keyword">this</span>.items.push(queueElement);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> added = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.items.length; i++) &#123;</span><br><span class="line">      <span class="comment">// 注意，只需要将这里改为大于号就可以了</span></span><br><span class="line">      <span class="keyword">if</span> (queueElement.priority &gt; <span class="keyword">this</span>.items[i].priority) &#123;</span><br><span class="line">        <span class="keyword">this</span>.items.splice(i, <span class="number">0</span>, queueElement);</span><br><span class="line">        added = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">break</span> ;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!added) &#123;</span><br><span class="line">      <span class="keyword">this</span>.items.push(queueElement);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最大优先队列测试：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">//</span> 创建最大优先队列maxPriorityQueue实例</span><br><span class="line">var maxPriorityQueue = new MaxPriorityQueue();</span><br><span class="line"></span><br><span class="line">console.log(maxPriorityQueue.isEmpty());     <span class="regexp">//</span> true</span><br><span class="line">maxPriorityQueue.enqueue(<span class="string">&quot;John&quot;</span>, <span class="number">1</span>);         <span class="regexp">//</span> undefined</span><br><span class="line">maxPriorityQueue.enqueue(<span class="string">&quot;Jack&quot;</span>, <span class="number">3</span>);         <span class="regexp">//</span> undefined</span><br><span class="line">maxPriorityQueue.enqueue(<span class="string">&quot;Camila&quot;</span>, <span class="number">2</span>);       <span class="regexp">//</span> undefined</span><br><span class="line">maxPriorityQueue.enqueue(<span class="string">&quot;Tom&quot;</span>, <span class="number">3</span>);          <span class="regexp">//</span> undefined</span><br><span class="line">maxPriorityQueue.print();                    <span class="regexp">//</span> <span class="string">&quot;Jack-&gt;3,Tom-&gt;3,Camila-&gt;2,John-&gt;1&quot;</span></span><br><span class="line">console.log(maxPriorityQueue.size());        <span class="regexp">//</span> <span class="number">4</span></span><br><span class="line">console.log(maxPriorityQueue.isEmpty());     <span class="regexp">//</span> false</span><br><span class="line">maxPriorityQueue.dequeue();                  <span class="regexp">//</span> &#123;element: <span class="string">&quot;Jack&quot;</span>, priority: <span class="number">3</span>&#125;</span><br><span class="line">maxPriorityQueue.dequeue();                  <span class="regexp">//</span> &#123;element: <span class="string">&quot;Tom&quot;</span>, priority: <span class="number">3</span>&#125;</span><br><span class="line">maxPriorityQueue.print();                    <span class="regexp">//</span> <span class="string">&quot;Camila-&gt;2,John-&gt;1&quot;</span></span><br><span class="line">maxPriorityQueue.clear();                    <span class="regexp">//</span> undefined</span><br><span class="line">console.log(maxPriorityQueue.size());        <span class="regexp">//</span> <span class="number">0</span></span><br></pre></td></tr></table></figure><h2 id="2-3-循环队列"><a href="#2-3-循环队列" class="headerlink" title="2.3 循环队列"></a>2.3 循环队列</h2><p>还有一种队列实现叫做 <strong>循环队列</strong> 。</p><p>循环队列的一个例子就是 <strong>击鼓传花游戏（Hot Potato）</strong> 。在这个游戏中，孩子们围城一个圆圈，击鼓的时候把花尽快的传递给旁边的人。某一时刻击鼓停止，这时花在谁的手里，谁就退出圆圈直到游戏结束。重复这个过程，直到只剩一个孩子（胜者）。</p><p>下面我们在普通队列的基础上，实现一个模拟的击鼓传花游戏：</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 实现击鼓传花</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hotPotato</span> (<span class="params">nameList, num</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> queue = <span class="keyword">new</span> Queue();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; nameList.<span class="built_in">length</span>; i++) &#123;</span><br><span class="line">    queue.enqueue(nameList[i]);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> eliminated = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (queue.size() &gt; <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="comment">// 循环num次，队首出来去到队尾</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; num; i++) &#123;</span><br><span class="line">      queue.enqueue(queue.dequeue());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 循环num次过后，移除当前队首的元素</span></span><br><span class="line">    eliminated = queue.dequeue();</span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">`<span class="subst">$&#123;eliminated&#125;</span>在击鼓传花中被淘汰！`</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 最后只剩一个元素</span></span><br><span class="line">  <span class="keyword">return</span> queue.dequeue();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试</span></span><br><span class="line"><span class="keyword">var</span> nameList = [<span class="string">&quot;John&quot;</span>, <span class="string">&quot;Jack&quot;</span>, <span class="string">&quot;Camila&quot;</span>, <span class="string">&quot;Ingrid&quot;</span>, <span class="string">&quot;Carl&quot;</span>];</span><br><span class="line"><span class="keyword">var</span> winner = hotPotato(nameList, <span class="number">10</span>);</span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">`最后的胜利者是：<span class="subst">$&#123;winner&#125;</span>`</span>);</span><br></pre></td></tr></table></figure><p>执行结果为：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">//</span> John在击鼓传花中被淘汰！</span><br><span class="line"><span class="regexp">//</span> Ingrid在击鼓传花中被淘汰！ </span><br><span class="line"><span class="regexp">//</span> Jack在击鼓传花中被淘汰！</span><br><span class="line"><span class="regexp">//</span> Camila在击鼓传花中被淘汰！</span><br><span class="line"><span class="regexp">//</span> 最后的胜利者是：Carl</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> ECMAScript基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 队列 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>栈</title>
      <link href="/posts/1f4ac2fb/"/>
      <url>/posts/1f4ac2fb/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="一、定义"><a href="#一、定义" class="headerlink" title="一、定义"></a>一、定义</h2><h3 id="1-1-背景"><a href="#1-1-背景" class="headerlink" title="1.1 背景"></a>1.1 背景</h3><p>对于数组，可以在任意位置上删除或添加元素。</p><p>然而，有时候还需要一种在添加或删除元素时有更多控制的数据结构。</p><p>有两种数据结构类似于数组，但在添加和删除元素时更为可控。</p><p>它们就是 <strong>栈和队列</strong> 。</p><h3 id="1-2-概念"><a href="#1-2-概念" class="headerlink" title="1.2 概念"></a>1.2 概念</h3><p><strong>栈</strong>是一种遵循后进先出（LIFO）原则的有序集合。新添加的或待删除的元素都保存在栈的末尾，称作 <strong>栈顶</strong> ，另一端就叫 <strong>栈底</strong> 。</p><p>在栈里，新元素都靠近栈顶，旧元素都接近栈底。</p><p>栈也被用在编程语言的编译器和内存中保存变量、方法调用等，比如函数的调用栈。</p><h2 id="二、栈的实现"><a href="#二、栈的实现" class="headerlink" title="二、栈的实现"></a>二、栈的实现</h2><h3 id="2-1-创建一个类来表示栈"><a href="#2-1-创建一个类来表示栈" class="headerlink" title="2.1 创建一个类来表示栈"></a>2.1 创建一个类来表示栈</h3><p>这里用构造函数的形式来书写。</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Stack类</span></span><br><span class="line"><span class="function">function <span class="title">Stack</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.items = [];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">this</span>.push = push;</span><br><span class="line">  <span class="keyword">this</span>.pop = pop;</span><br><span class="line">  <span class="keyword">this</span>.peek = peek;</span><br><span class="line">  <span class="keyword">this</span>.isEmpty = isEmpty;</span><br><span class="line">  <span class="keyword">this</span>.clear = clear;</span><br><span class="line">  <span class="keyword">this</span>.size = size;</span><br><span class="line">  <span class="keyword">this</span>.print = print;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>栈里面有一些声明的方法：</p><ul><li>push(element)：添加一个（或几个）新元素到栈顶</li><li>pop()：移除栈顶的元素，同时返回被移除的元素</li><li>peek()：返回栈顶的元素，不对栈做任何修改</li><li>isEmpty()：如果栈里没有任何元素就返回true，否则返回false</li><li>clear()：移除栈里的所有元素</li><li>size()：返回栈里的元素个数</li></ul><h3 id="2-2-实现栈中的辅助方法"><a href="#2-2-实现栈中的辅助方法" class="headerlink" title="2.2 实现栈中的辅助方法"></a>2.2 实现栈中的辅助方法</h3><figure class="highlight qml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 添加新元素到栈顶</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">push</span> (<span class="params">element</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.items.push(element);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 移除栈顶元素，同时返回被移除的元素</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pop</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.items.pop();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 查看栈顶元素</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">peek</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.items[<span class="keyword">this</span>.items.length - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断是否为空栈</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isEmpty</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.items.length === <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 清空栈</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clear</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.items = [];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 查询栈的长度</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">size</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.items.length;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 打印栈里的元素</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">print</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.items.toString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-3-创建实例进行测试"><a href="#2-3-创建实例进行测试" class="headerlink" title="2.3 创建实例进行测试"></a>2.3 创建实例进行测试</h3><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建Stack实例</span></span><br><span class="line"><span class="keyword">var</span> stack = <span class="keyword">new</span> Stack();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(stack.<span class="built_in">isEmpty</span>());     <span class="comment">// true</span></span><br><span class="line">stack.<span class="built_in">push</span>(<span class="number">5</span>);                    <span class="comment">// undefined</span></span><br><span class="line">stack.<span class="built_in">push</span>(<span class="number">8</span>);                    <span class="comment">// undefined</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(stack.peek());        <span class="comment">// 8</span></span><br><span class="line">stack.<span class="built_in">push</span>(<span class="number">11</span>);                   <span class="comment">// undefined</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(stack.size());        <span class="comment">// 3</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(stack.<span class="built_in">isEmpty</span>());     <span class="comment">// false</span></span><br><span class="line">stack.<span class="built_in">push</span>(<span class="number">15</span>);                   <span class="comment">// undefined</span></span><br><span class="line">stack.<span class="built_in">pop</span>();                      <span class="comment">// 15</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(stack.size());        <span class="comment">// 3</span></span><br><span class="line">stack.print();                    <span class="comment">// 5,8,11</span></span><br><span class="line">stack.clear();                    <span class="comment">// undefined</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(stack.size());        <span class="comment">// 0</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> ECMAScript基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 栈 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>链表</title>
      <link href="/posts/2362a8ea/"/>
      <url>/posts/2362a8ea/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="一、定义"><a href="#一、定义" class="headerlink" title="一、定义"></a>一、定义</h2><h3 id="1-1-概念"><a href="#1-1-概念" class="headerlink" title="1.1 概念"></a>1.1 概念</h3><p>要存储多个元素，数组（或列表）可能是最常用的数据结构，它提供了一个便利的 <strong>[]</strong> 语法来访问它的元素。</p><p>然而，这种数据结构有一个缺点：（在大多数强类型语言中）数组的大小是固定的，需要预先分配，从数组的起点或中间插入或移除项的成本很高，因为需要移动元素。<br><strong>（注意：在JavaScript中数组的大小随时可变，不需要预先定义长度）</strong></p><p><strong>链表</strong>存储有序的元素集合，但不同于数组，链表中的元素在内存中并不是连续放置的。每个元素由一个存储元素本身的节点和一个指向下一个元素的引用（也称指针或链接）组成。</p><p>相对于传统的数组，链表的一个好处在于，添加或删除元素的时候不需要移动其他元素。然而，链表需要使用指针，因此实现链表时需要额外注意。数组的另一个细节是可以直接访问任何位置的元素，而想要访问链表中间的一个元素，需要从起点（表头）开始迭代列表直到找到所需的元素。</p><h3 id="1-2-分类"><a href="#1-2-分类" class="headerlink" title="1.2 分类"></a>1.2 分类</h3><p> <strong>链表最常用的有三类</strong> ：</p><ol><li>单向链表</li><li>双向链表</li><li>循环链表</li></ol><h2 id="二、链表的实现"><a href="#二、链表的实现" class="headerlink" title="二、链表的实现"></a>二、链表的实现</h2><h3 id="2-1-单向链表"><a href="#2-1-单向链表" class="headerlink" title="2.1 单向链表"></a>2.1 单向链表</h3><p>创建单向链表类：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 单向链表</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">SinglyLinkedList</span> () &#123;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">Node</span> (element) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">element</span> = element;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">next</span> = <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> length = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">var</span> head = <span class="literal">null</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">append</span> = <span class="keyword">function</span> (<span class="params">element</span>) &#123;&#125;;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">insert</span> = <span class="keyword">function</span> (<span class="params">position, element</span>) &#123;&#125;;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">removeAt</span> = <span class="keyword">function</span> (<span class="params">position</span>) &#123;&#125;;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">remove</span> = <span class="keyword">function</span> (<span class="params">element</span>) &#123;&#125;;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">indexOf</span> = <span class="keyword">function</span> (<span class="params">element</span>) &#123;&#125;;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">isEmpty</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">size</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">getHead</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">toString</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">print</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>SinglyLinkedList需要一个辅助类Node。Node类表示要加入链表的项。它包含一个element属性，即要添加到链表的值，以及一个next属性，即指向链表中下一个节点项的指针。</p><p>链表里面有一些声明的辅助方法：</p><ul><li>append(element)：向链表尾部添加新项</li><li>insert(position, element)：向链表的特定位置插入一个新的项</li><li>removeAt(position)：从链表的特定位置移除一项</li><li>remove(element)：从链表中移除一项</li><li>indexOf(element)：返回元素在链表中的索引。如果链表中没有该元素则返回-1</li><li>isEmpty()：如果链表中不包含任何元素，返回true，如果链表长度大于0，返回false</li><li>size()：返回链表包含的元素个数，与数组的length属性类似</li><li>getHead()：返回链表的第一个元素</li><li>toString()：由于链表使用了Node类，就需要重写继承自JavaScript对象默认的toString()方法，让其只输出元素的值</li><li>print()：打印链表的所有元素</li></ul><p>下面我们来一一实现这些辅助方法：</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 向链表尾部添加一个新的项</span></span><br><span class="line"><span class="keyword">this</span>.append = function (element) &#123;</span><br><span class="line">  <span class="keyword">var</span> node = new Node(element);</span><br><span class="line">  <span class="keyword">var</span> currentNode = head;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 判断是否为空链表</span></span><br><span class="line">  <span class="keyword">if</span> (currentNode === <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="comment">// 空链表</span></span><br><span class="line">    head = node;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 从head开始一直找到最后一个node</span></span><br><span class="line">    <span class="keyword">while</span> (currentNode.next) &#123;</span><br><span class="line">      <span class="comment">// 后面还有node</span></span><br><span class="line">      currentNode = currentNode.next;</span><br><span class="line">    &#125;</span><br><span class="line">    currentNode.next = node;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  length++;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 向链表特定位置插入一个新的项</span></span><br><span class="line"><span class="keyword">this</span>.insert = function (position, element) &#123;</span><br><span class="line">  <span class="keyword">if</span> (position &lt; <span class="number">0</span> &amp;&amp; position &gt; length) &#123;</span><br><span class="line">    <span class="comment">// 越界</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> node = new Node(element);</span><br><span class="line">    <span class="keyword">var</span> index = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> currentNode = head;</span><br><span class="line">    <span class="keyword">var</span> previousNode;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (position === <span class="number">0</span>) &#123;</span><br><span class="line">      node.next = currentNode;</span><br><span class="line">      head = node;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">while</span> (index &lt; position) &#123;</span><br><span class="line">        index++;</span><br><span class="line">        previousNode = currentNode;</span><br><span class="line">        currentNode = currentNode.next; </span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      previousNode.next = node;</span><br><span class="line">      node.next = currentNode;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    length++;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 从链表的特定位置移除一项</span></span><br><span class="line"><span class="keyword">this</span>.removeAt = function (position) &#123;</span><br><span class="line">  <span class="keyword">if</span> (position &lt; <span class="number">0</span> &amp;&amp; position &gt;= length || length === <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// 越界</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> currentNode = head;</span><br><span class="line">    <span class="keyword">var</span> index = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> previousNode;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (position === <span class="number">0</span>) &#123;</span><br><span class="line">      head = currentNode.next;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">while</span> (index &lt; position) &#123;</span><br><span class="line">        index++;</span><br><span class="line">        previousNode = currentNode;</span><br><span class="line">        currentNode = currentNode.next;</span><br><span class="line">      &#125;</span><br><span class="line">      previousNode.next = currentNode.next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    length--;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 从链表的特定位置移除一项</span></span><br><span class="line"><span class="keyword">this</span>.removeAt = function (position) &#123;</span><br><span class="line">  <span class="keyword">if</span> (position &lt; <span class="number">0</span> &amp;&amp; position &gt;= length || length === <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// 越界</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> currentNode = head;</span><br><span class="line">    <span class="keyword">var</span> index = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> previousNode;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (position === <span class="number">0</span>) &#123;</span><br><span class="line">      head = currentNode.next;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">while</span> (index &lt; position) &#123;</span><br><span class="line">        index++;</span><br><span class="line">        previousNode = currentNode;</span><br><span class="line">        currentNode = currentNode.next;</span><br><span class="line">      &#125;</span><br><span class="line">      previousNode.next = currentNode.next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    length--;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 从链表中移除指定项</span></span><br><span class="line"><span class="keyword">this</span>.remove = function (element) &#123;</span><br><span class="line">  <span class="keyword">var</span> index = <span class="keyword">this</span>.indexOf(element);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.removeAt(index);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回元素在链表的索引，如果链表中没有该元素则返回-1</span></span><br><span class="line"><span class="keyword">this</span>.indexOf = function (element) &#123;</span><br><span class="line">  <span class="keyword">var</span> currentNode = head;</span><br><span class="line">  <span class="keyword">var</span> index = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (currentNode) &#123;</span><br><span class="line">    <span class="keyword">if</span> (currentNode.element === element) &#123;</span><br><span class="line">      <span class="keyword">return</span> index;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    index++;</span><br><span class="line">    currentNode = currentNode.next;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果链表中不包含任何元素，返回true，如果链表长度大于0，返回false</span></span><br><span class="line"><span class="keyword">this</span>.isEmpty = function () &#123;</span><br><span class="line">  <span class="keyword">return</span> length == <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回链表包含的元素个数，与数组的length属性类似</span></span><br><span class="line"><span class="keyword">this</span>.size = function () &#123;</span><br><span class="line">  <span class="keyword">return</span> length;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取链表头部元素</span></span><br><span class="line"><span class="keyword">this</span>.getHead = function () &#123;</span><br><span class="line">  <span class="keyword">return</span> head.element;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 由于链表使用了Node类，就需要重写继承自JavaScript对象默认的toString()方法，让其只输出元素的值</span></span><br><span class="line"><span class="keyword">this</span>.toString = function () &#123;</span><br><span class="line">  <span class="keyword">var</span> currentNode = head;</span><br><span class="line">  <span class="keyword">var</span> string = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (currentNode) &#123;</span><br><span class="line">    string += <span class="string">&#x27;,&#x27;</span> + currentNode.element;</span><br><span class="line">    currentNode = currentNode.next;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> string.slice(<span class="number">1</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">this</span>.print = function () &#123;</span><br><span class="line">  console.log(<span class="keyword">this</span>.toString());</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>创建单向链表实例进行测试：</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建单向链表实例</span></span><br><span class="line"><span class="keyword">var</span> singlyLinked = <span class="keyword">new</span> SinglyLinkedList();</span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(singlyLinked.removeAt(<span class="number">0</span>));              <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(singlyLinked.<span class="built_in">isEmpty</span>());              <span class="comment">// true</span></span><br><span class="line">singlyLinked.append(<span class="string">&#x27;Tom&#x27;</span>);             </span><br><span class="line">singlyLinked.append(<span class="string">&#x27;Peter&#x27;</span>);</span><br><span class="line">singlyLinked.append(<span class="string">&#x27;Paul&#x27;</span>);</span><br><span class="line">singlyLinked.print();                             <span class="comment">// &quot;Tom,Peter,Paul&quot;</span></span><br><span class="line">singlyLinked.<span class="built_in">insert</span>(<span class="number">0</span>, <span class="string">&#x27;Susan&#x27;</span>);        </span><br><span class="line">singlyLinked.print();                             <span class="comment">// &quot;Susan,Tom,Peter,Paul&quot;</span></span><br><span class="line">singlyLinked.<span class="built_in">insert</span>(<span class="number">1</span>, <span class="string">&#x27;Jack&#x27;</span>);         </span><br><span class="line">singlyLinked.print();                             <span class="comment">// &quot;Susan,Jack,Tom,Peter,Paul&quot;</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(singlyLinked.getHead());              <span class="comment">// &quot;Susan&quot;</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(singlyLinked.<span class="built_in">isEmpty</span>());              <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(singlyLinked.<span class="built_in">indexOf</span>(<span class="string">&#x27;Peter&#x27;</span>));       <span class="comment">// 3</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(singlyLinked.<span class="built_in">indexOf</span>(<span class="string">&#x27;Cris&#x27;</span>));        <span class="comment">// -1</span></span><br><span class="line">singlyLinked.remove(<span class="string">&#x27;Tom&#x27;</span>);             </span><br><span class="line">singlyLinked.removeAt(<span class="number">2</span>);               </span><br><span class="line">singlyLinked.print();                             <span class="comment">// &quot;Susan,Jack,Paul&quot;</span></span><br></pre></td></tr></table></figure><h3 id="2-2-双向链表"><a href="#2-2-双向链表" class="headerlink" title="2.2 双向链表"></a>2.2 双向链表</h3><p><strong>双向链表</strong>和普通链表的区别在于，在普通链表中，一个节点只有链向下一个节点的链接，而在双向链表中，链接是双向的：一个链向下一个元素，另一个链向前一个元素。</p><p>创建双向链表类：</p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建双向链表DoublyLinkedList类</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">DoublyLinkedList</span> <span class="params">()</span> &#123;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">Node</span> <span class="params">(element)</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.element = element;</span><br><span class="line">    <span class="keyword">this</span>.next = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">this</span>.prev = <span class="literal">null</span>;        <span class="comment">// 新增</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> length = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">var</span> head = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">var</span> tail = <span class="literal">null</span>;          <span class="comment">// 新增</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看到，双向链表在Node类里有prev属性（一个新指针），在DoublyLinkedList类里也有用来保存对列表最后一项的引用的tail属性。</p><p>双向链表提供了两种迭代列表的方法：从头到尾，或者从尾到头。我们可以访问一个特定节点的下一个或前一个元素。</p><p>在单向链表中，如果迭代链表时错过了要找的元素，就需要回到链表起点，重新开始迭代。在双向链表中，可以从任一节点，向前或向后迭代，这是双向链表的一个优点。</p><p>实现双向链表的辅助方法：</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 向链表尾部添加一个新的项</span></span><br><span class="line"><span class="keyword">this</span>.append = function (element) &#123;</span><br><span class="line">  <span class="keyword">var</span> node = new Node(element);</span><br><span class="line">  <span class="keyword">var</span> currentNode = tail;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 判断是否为空链表</span></span><br><span class="line">  <span class="keyword">if</span> (currentNode === <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="comment">// 空链表</span></span><br><span class="line">    head = node;</span><br><span class="line">    tail = node;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    currentNode.next = node;</span><br><span class="line">    node.prev = currentNode;</span><br><span class="line">    tail = node; </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  length++;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 向链表特定位置插入一个新的项</span></span><br><span class="line"><span class="keyword">this</span>.insert = function (position, element) &#123;</span><br><span class="line">  <span class="keyword">if</span> (position &lt; <span class="number">0</span> &amp;&amp; position &gt; length) &#123;</span><br><span class="line">    <span class="comment">// 越界</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> node = new Node(element);</span><br><span class="line">    <span class="keyword">var</span> index = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> currentNode = head;</span><br><span class="line">    <span class="keyword">var</span> previousNode;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (position === <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!head) &#123;</span><br><span class="line">        head = node;</span><br><span class="line">        tail = node;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        node.next = currentNode;</span><br><span class="line">        currentNode.prev = node;</span><br><span class="line">        head = node;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (position === length) &#123;</span><br><span class="line">      <span class="keyword">this</span>.append(element);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">while</span> (index &lt; position) &#123;</span><br><span class="line">        index++;</span><br><span class="line">        previousNode = currentNode;</span><br><span class="line">        currentNode = currentNode.next; </span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      previousNode.next = node;</span><br><span class="line">      node.next = currentNode;</span><br><span class="line"></span><br><span class="line">      node.prev = previousNode;</span><br><span class="line">      currentNode.prev = node;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    length++;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 从链表的特定位置移除一项</span></span><br><span class="line"><span class="keyword">this</span>.removeAt = function (position) &#123;</span><br><span class="line">  <span class="keyword">if</span> (position &lt; <span class="number">0</span> &amp;&amp; position &gt;= length || length === <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// 越界</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> currentNode = head;</span><br><span class="line">    <span class="keyword">var</span> index = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> previousNode;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (position === <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="comment">// 移除第一项</span></span><br><span class="line">      <span class="keyword">if</span> (length === <span class="number">1</span>) &#123;</span><br><span class="line">        head = <span class="literal">null</span>;</span><br><span class="line">        tail = <span class="literal">null</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        head = currentNode.next;</span><br><span class="line">        head.prev = <span class="literal">null</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (position === length - <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="comment">// 移除最后一项</span></span><br><span class="line">      <span class="keyword">if</span> (length === <span class="number">1</span>) &#123;</span><br><span class="line">        head = <span class="literal">null</span>;</span><br><span class="line">        tail = <span class="literal">null</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        currentNode = tail;</span><br><span class="line">        tail = currentNode.prev;</span><br><span class="line">        tail.next = <span class="literal">null</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">while</span> (index &lt; position) &#123;</span><br><span class="line">        index++;</span><br><span class="line">        previousNode = currentNode;</span><br><span class="line">        currentNode = currentNode.next;</span><br><span class="line">      &#125;</span><br><span class="line">      previousNode.next = currentNode.next;</span><br><span class="line">      previousNode = currentNode.next.prev;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    length--;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 从链表中移除指定项</span></span><br><span class="line"><span class="keyword">this</span>.remove = function (element) &#123;</span><br><span class="line">  <span class="keyword">var</span> index = <span class="keyword">this</span>.indexOf(element);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.removeAt(index);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回元素在链表的索引，如果链表中没有该元素则返回-1</span></span><br><span class="line"><span class="keyword">this</span>.indexOf = function (element) &#123;</span><br><span class="line">  <span class="keyword">var</span> currentNode = head;</span><br><span class="line">  <span class="keyword">var</span> index = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (currentNode) &#123;</span><br><span class="line">    <span class="keyword">if</span> (currentNode.element === element) &#123;</span><br><span class="line">      <span class="keyword">return</span> index;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    index++;</span><br><span class="line">    currentNode = currentNode.next;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果链表中不包含任何元素，返回true，如果链表长度大于0，返回false</span></span><br><span class="line"><span class="keyword">this</span>.isEmpty = function () &#123;</span><br><span class="line">  <span class="keyword">return</span> length == <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回链表包含的元素个数，与数组的length属性类似</span></span><br><span class="line"><span class="keyword">this</span>.size = function () &#123;</span><br><span class="line">  <span class="keyword">return</span> length;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取链表头部元素</span></span><br><span class="line"><span class="keyword">this</span>.getHead = function () &#123;</span><br><span class="line">  <span class="keyword">return</span> head.element;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 由于链表使用了Node类，就需要重写继承自JavaScript对象默认的toString()方法，让其只输出元素的值</span></span><br><span class="line"><span class="keyword">this</span>.toString = function () &#123;</span><br><span class="line">  <span class="keyword">var</span> currentNode = head;</span><br><span class="line">  <span class="keyword">var</span> string = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (currentNode) &#123;</span><br><span class="line"></span><br><span class="line">    string += <span class="string">&#x27;,&#x27;</span> + currentNode.element;</span><br><span class="line">    currentNode = currentNode.next;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> string.slice(<span class="number">1</span>);  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">this</span>.print = function () &#123;</span><br><span class="line">  console.log(<span class="keyword">this</span>.toString());</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>创建双向链表实例进行测试：</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建双向链表</span></span><br><span class="line"><span class="keyword">var</span> doublyLinked = <span class="keyword">new</span> DoublyLinkedList();</span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(doublyLinked.<span class="built_in">isEmpty</span>());              <span class="comment">// true</span></span><br><span class="line">doublyLinked.append(<span class="string">&#x27;Tom&#x27;</span>);             </span><br><span class="line">doublyLinked.append(<span class="string">&#x27;Peter&#x27;</span>);</span><br><span class="line">doublyLinked.append(<span class="string">&#x27;Paul&#x27;</span>);</span><br><span class="line">doublyLinked.print();                             <span class="comment">// &quot;Tom,Peter,Paul&quot;</span></span><br><span class="line">doublyLinked.<span class="built_in">insert</span>(<span class="number">0</span>, <span class="string">&#x27;Susan&#x27;</span>);        </span><br><span class="line">doublyLinked.print();                             <span class="comment">// &quot;Susan,Tom,Peter,Paul&quot;</span></span><br><span class="line">doublyLinked.<span class="built_in">insert</span>(<span class="number">1</span>, <span class="string">&#x27;Jack&#x27;</span>);         </span><br><span class="line">doublyLinked.print();                             <span class="comment">// &quot;Susan,Jack,Tom,Peter,Paul&quot;</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(doublyLinked.getHead());              <span class="comment">// &quot;Susan&quot;</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(doublyLinked.<span class="built_in">isEmpty</span>());              <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(doublyLinked.<span class="built_in">indexOf</span>(<span class="string">&#x27;Peter&#x27;</span>));       <span class="comment">// 3</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(doublyLinked.<span class="built_in">indexOf</span>(<span class="string">&#x27;Cris&#x27;</span>));        <span class="comment">// -1</span></span><br><span class="line">doublyLinked.remove(<span class="string">&#x27;Tom&#x27;</span>);             </span><br><span class="line">doublyLinked.removeAt(<span class="number">2</span>);               </span><br><span class="line">doublyLinked.print();                             <span class="comment">// &quot;Susan,Jack,Paul&quot;</span></span><br></pre></td></tr></table></figure><h3 id="2-3-循环链表"><a href="#2-3-循环链表" class="headerlink" title="2.3 循环链表"></a>2.3 循环链表</h3><p>循环链表可以像单向链表一样只有单向引用，也可以像双向链表一样有双向引用。循环链表和普通链表之间唯一的区别在于，最后一个元素指向下一个元素的指针（next）不是引用null，而是指向第一个元素（head）。这里就不进行代码实现了，大家可以结合上面的单向链表和双向链表自己实现一个循环链表。</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> ECMAScript基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 链表 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>重绘重排</title>
      <link href="/posts/d1f4e0a2/"/>
      <url>/posts/d1f4e0a2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="重排重会的概念"><a href="#重排重会的概念" class="headerlink" title="重排重会的概念"></a>重排重会的概念</h2><h3 id="1-重绘（repaint）"><a href="#1-重绘（repaint）" class="headerlink" title="1.重绘（repaint）"></a>1.重绘（repaint）</h3><p>在不改变文档布局的情况下，文档元素发生的例如背景颜色等外观改变的行为可称为重绘。根据 Opera 的说法，重绘的成本也很高，但在处理能力较高的现代设备中，可能感觉不明显。</p><h3 id="2-重排（reflow）"><a href="#2-重排（reflow）" class="headerlink" title="2.重排（reflow）"></a>2.重排（reflow）</h3><p>reflow 有人翻译为“回流”，也有人翻译为“重构”，也有人翻译为“重排”。我选择翻译为重排，取重新排版布局之意。</p><p>那么什么是重排呢？</p><p>developers.google 上这样解释：</p><blockquote><p>重排是在网络浏览器中执行的一个流程，用于重新计算文档中各元素的位置和几何形状，以便重新呈现该文档的部分内容或全部内容。</p></blockquote><p>我对重排的理解：</p><p>会改变文档布局，会引发元素的位置、尺寸发生改变的行为可称为重排。重排比起重绘，在视觉效果上会更明显，每当操作 DOM 树、更改影响布局的样式、更改元素的 className 属性或更改浏览器窗口大小时，都会发生重排现象。</p><p>重排在性能方面的消耗是巨大的，并且是导致 DOM 脚本缓慢的主要原因之一，这在处理能力较低的设备上更为明显。在很多情况下，它们相当于重新布局整个页面，因为元素的重排可能会导致它的祖先元素和子孙元素也发生相应的改变。</p><p>现代的电脑设备处理能力普遍较强，所以一些开发者或产品设计者，没有重视应当减少重排的发生，但在一些处理能力不足的特殊终端设备这很重要。</p><h2 id="什么时候会发生重排重绘"><a href="#什么时候会发生重排重绘" class="headerlink" title="什么时候会发生重排重绘"></a>什么时候会发生重排重绘</h2><p>会引发重排的情况：</p><ul><li>浏览器窗口大小的改变，调整窗口大小</li><li>删除可见的节点或增加节点</li><li>节点尺寸的改变，例如修改元素的width或height等</li><li>节点位置的改变，例如使用float或position的改变</li><li>节点文本内容的改变，例如不断输入内容。</li><li>激活 CSS 伪类，例如 :hover（在 IE 中激活兄弟的伪类）</li><li>给元素删除或添加样式表，例如给元素添加一个新的样式，或移除原来的样式。</li></ul><p>会引发重绘的情况：</p><p>例如元素的 color，background-color 等的改变。</p><blockquote><p>tips：据说重排必定会发生重绘，但重绘未必会发生重排。</p></blockquote><p>此外，个人认为重排重绘的边界并不是没有交集的。所以可能可以把重排重绘绑在一起，认为是一件事，不必仔细区分，而我们更应该付出注意力的是在程序设计时，尽可能降低重排重绘带来的消耗，减少不必要的重排重绘发生。</p><h2 id="学完之后"><a href="#学完之后" class="headerlink" title="学完之后"></a>学完之后</h2><p>了解了重排重会之后，知道重排重绘可能会产生较大的性能消耗，总结下应该注意的事情。</p><p><strong>面对重排重绘的注意事项</strong></p><ul><li>减少不必要的 DOM 深度，例如不必要的嵌套结构。在 DOM 树中的一个级别进行更改可能会致使该树的所有级别（上至根节点，下至所修改节点的子级）都随之变化。这会导致花费更多的时间来执行重排。</li><li>尽可能减少 CSS 规则的数量，并删除未使用到的 CSS 规则。一些默认就有的 CSS 规则，就不必写了，具有继承性的样式，也不必每级节点都写。calc() 之类的计算方法应该少用。</li><li>如果您想进行复杂的渲染更改（例如动画），请在流程外执行此操作。您可以使用 position-absolute 或 position-fixed 来实现此目的。</li><li>避免使用不必要且复杂的 CSS 选择器（尤其是后代选择器），因为此类选择器需要耗用更多的 CPU 处理能力来执行选择器匹配。总之不必要的深度，不管是 css 还是 dom 都不是好的选择，这对人和机器都是同样的道理，因为读和理解起来都同样的“费力”。</li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> 性能优化 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 重绘重排 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>预解析(提升)</title>
      <link href="/posts/a419e871/"/>
      <url>/posts/a419e871/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>JS解析器运行代码的过程分为两步：<strong>预解析 + 代码执行</strong></p><blockquote><p><strong>预解析</strong>：JS引擎会把JS里面所有的 var、function 提升到当前作用域的最前面<br><strong>代码执行</strong>：按照代码书写的顺序从上往下执行</p></blockquote><p>预解析分为：<strong>变量预解析（变量提升）</strong> 和 <strong>函数预解析（函数提升）</strong></p><h3 id="变量预解析（变量提升）"><a href="#变量预解析（变量提升）" class="headerlink" title="变量预解析（变量提升）"></a>变量预解析（变量提升）</h3><p>变量声明被提升，而变量赋值不会<br><strong>把所有的变量声明提升到当前作用域的最前面，不提升赋值操作</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(num); <span class="comment">// undefined</span></span><br><span class="line"><span class="keyword">var</span> num = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 相当于执行了以下代码：</span></span><br><span class="line"><span class="keyword">var</span> num;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(num); <span class="comment">//  undefined  声明了未赋值，则是undefined</span></span><br><span class="line">num = <span class="number">10</span>;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 函数表达式（匿名函数），var fun = funciton() &#123;&#125;， fun是变量名</span></span><br><span class="line"><span class="comment">// 函数表达式调用，必须写在函数表达式的下面才不会报错</span></span><br><span class="line"><span class="title function_">fun</span>(); <span class="comment">// 报错</span></span><br><span class="line"><span class="keyword">var</span> fun = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">22</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 相当于执行了以下代码：</span></span><br><span class="line"><span class="keyword">var</span> fun;</span><br><span class="line"><span class="title function_">fun</span>(); <span class="comment">// 报错  声明了一个fun的变量名，直接调用报错</span></span><br><span class="line">fun = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">22</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> fun = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">22</span>); </span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">fun</span>(); <span class="comment">// 函数表达式调用，必须写在函数表达式的下面才不会报错   正常输出：22</span></span><br></pre></td></tr></table></figure><h3 id="函数预解析（函数提升）"><a href="#函数预解析（函数提升）" class="headerlink" title="函数预解析（函数提升）"></a>函数预解析（函数提升）</h3><p><strong>把所有的函数声明提升到当前作用域的最前面，不调用函数</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">fu</span>();  <span class="comment">// 正常输出 11</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">11</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 相当于执行了以下代码： 先声明的函数，再调用</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">11</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">fu</span>();  <span class="comment">// 正常输出 11</span></span><br></pre></td></tr></table></figure><h3 id="函数优先级更高"><a href="#函数优先级更高" class="headerlink" title="函数优先级更高"></a>函数优先级更高</h3><p>函数声明和变量声明都会被提升。但是一个值得注意的细节是，<strong>函数声明会首先被提升，然后才是变量。</strong></p><p>考虑如下代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">foo</span>();      <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> foo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span> () &#123;</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>这里会输出 1 而不是 2 。这段代码其实等价于：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span> () &#123;</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">foo</span>();      <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line">foo = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><em><strong>var foo;</strong></em> 尽管出现在 function foo() {…} 声明之前，但是它是重复声明，所以会被编译器忽略，因为函数声明会被提升到变量声明之前。</p><p>注意，尽管重复的 var 声明会被忽略，但重复的函数声明却会覆盖前一个同名函数。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">foo</span>();      <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span> () &#123;</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> foo = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>);</span><br><span class="line">&#125;;  </span><br><span class="line"></span><br><span class="line"><span class="title function_">foo</span>();        <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span> () &#123;</span><br><span class="line">   cosole.<span class="title function_">log</span>(<span class="number">3</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个例子充分说明了在同一个作用域中进行重复定义是非常糟糕的，而且经常会导致各种奇怪的问题。上面那个例子，等价于：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span> () &#123;</span><br><span class="line">   cosole.<span class="title function_">log</span>(<span class="number">3</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">foo</span>();      <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line">foo = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>);</span><br><span class="line">&#125;;  </span><br><span class="line"></span><br><span class="line"><span class="title function_">foo</span>();        <span class="comment">// 2</span></span><br></pre></td></tr></table></figure><p>还有一些人会犯如下错误：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">foo</span>();      <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (a) &#123;</span><br><span class="line">   <span class="keyword">function</span> <span class="title function_">foo</span> () &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>);</span><br><span class="line">   &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">   <span class="keyword">function</span> <span class="title function_">foo</span> () &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>因为 if 并没有块作用域，所以这里的函数声明会提升到其作用域最前边，而后一个 function 声明会覆盖前一个，所以这里结果是 2 。这里代码等价如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span> () &#123;</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a;</span><br><span class="line"></span><br><span class="line"><span class="title function_">foo</span>();      <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line">a = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (a) &#123;&#125; </span><br><span class="line"><span class="keyword">else</span> &#123;&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 函数式编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 预解析（提升） </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>变量</title>
      <link href="/posts/13ffbe88/"/>
      <url>/posts/13ffbe88/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="var、let、const的区别"><a href="#var、let、const的区别" class="headerlink" title="var、let、const的区别"></a>var、let、const的区别</h3><p>var 声明的变量会挂载在window上，而let和const声明的变量不会：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">100</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a,<span class="variable language_">window</span>.<span class="property">a</span>);    <span class="comment">// 100 100</span></span><br><span class="line"><span class="keyword">let</span> b = <span class="number">10</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b,<span class="variable language_">window</span>.<span class="property">b</span>);    <span class="comment">// 10 undefined</span></span><br><span class="line"><span class="keyword">const</span> c = <span class="number">1</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(c,<span class="variable language_">window</span>.<span class="property">c</span>);    <span class="comment">// 1 undefined</span></span><br></pre></td></tr></table></figure><p><code>var</code>声明变量存在变量提升，<code>let</code>和 <code>const</code>不存在变量提升:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a); <span class="comment">// undefined  ===&gt;  a已声明还没赋值，默认得到undefined值</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">100</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b); <span class="comment">// 报错：b is not defined  ===&gt; 找不到b这个变量</span></span><br><span class="line"><span class="keyword">let</span> b = <span class="number">10</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(c); <span class="comment">// 报错：c is not defined  ===&gt; 找不到c这个变量</span></span><br><span class="line"><span class="keyword">const</span> c = <span class="number">10</span>;</span><br></pre></td></tr></table></figure><p>let和const声明形成块作用域</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="number">1</span>) &#123;</span><br><span class="line">   <span class="keyword">var</span> a = <span class="number">100</span>;</span><br><span class="line">   let b = <span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(a);  <span class="comment">// 100</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(b);  <span class="comment">// 报错：b is not defined  ===&gt; 找不到b这个变量-------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">1</span>) &#123;</span><br><span class="line">   <span class="keyword">var</span> a = <span class="number">100</span>;</span><br><span class="line">   const c = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(a);  <span class="comment">// 100</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(c);  <span class="comment">// 报错：c is not defined  ===&gt; 找不到c这个变量</span></span><br></pre></td></tr></table></figure><p>同一作用域下let和const不能声明同名变量，而var可以</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var a <span class="operator">=</span> <span class="number">100</span><span class="comment">;</span></span><br><span class="line">console.log(a)<span class="comment">; // 100</span></span><br><span class="line">var a <span class="operator">=</span> <span class="number">10</span><span class="comment">;</span></span><br><span class="line">console.log(a)<span class="comment">; // 10</span></span><br><span class="line">-------------------------------------</span><br><span class="line">let a <span class="operator">=</span> <span class="number">100</span><span class="comment">;</span></span><br><span class="line">let a <span class="operator">=</span> <span class="number">10</span><span class="comment">;  //  控制台报错：Identifier &#x27;a&#x27; has already been declared  ===&gt; 标识符a已经被声明了。</span></span><br></pre></td></tr></table></figure><p>暂存死区</p><figure class="highlight nim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="number">1</span>) &#123;</span><br><span class="line">   a = <span class="number">10</span>;  </span><br><span class="line">   //在当前块作用域中存在a使用<span class="keyword">let</span>/<span class="keyword">const</span>声明的情况下，给a赋值<span class="number">10</span>时，只会在当前作用域找变量a，  </span><br><span class="line">   // 而这时，还未到声明时候，所以控制台<span class="type">Error</span>:a <span class="keyword">is</span> <span class="keyword">not</span> defined</span><br><span class="line">   <span class="keyword">let</span> a = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>const</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">   1、一旦声明必须赋值,不能使用null占位。　</span></span><br><span class="line"><span class="comment">   2、声明后不能再修改　　</span></span><br><span class="line"><span class="comment">   3、如果声明的是复合类型数据，可以修改其属性</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">const</span> a = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> list = [];</span><br><span class="line">list[<span class="number">0</span>] = <span class="number">10</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(list);　　<span class="comment">// [10]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj = &#123;<span class="attr">a</span>:<span class="number">100</span>&#125;;</span><br><span class="line">obj.<span class="property">name</span> = <span class="string">&#x27;apple&#x27;</span>;</span><br><span class="line">obj.<span class="property">a</span> = <span class="number">10000</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj);　　<span class="comment">// &#123;a:10000,name:&#x27;apple&#x27;&#125;</span></span><br></pre></td></tr></table></figure><h3 id="问题：var-a-x3D-xxx，a内存中到底保存的是什么？"><a href="#问题：var-a-x3D-xxx，a内存中到底保存的是什么？" class="headerlink" title="问题：var a &#x3D; xxx，a内存中到底保存的是什么？"></a>问题：var a &#x3D; xxx，a内存中到底保存的是什么？</h3><p>xxx是基本数据，保存的就是这个数据<br>xxx是对象，保存的是对象的地址值<br>xxx是一个变量，保存的xxx的内存内容（可能是基本数据，也可能是地址值）</p><h3 id="关于引用变量赋值问题"><a href="#关于引用变量赋值问题" class="headerlink" title="关于引用变量赋值问题"></a>关于引用变量赋值问题</h3><p>2个引用变量指向同一个对象，通过一个变量修改对象内部数据，另一个变量看到的是修改之后的数据<br>2个引用变量指向同一个对象，让其中一个引用变量指向另一个对象，另一个对象依然指向前一个对象。</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> ECMAScript基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 变量 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>作用域</title>
      <link href="/posts/7a108a3c/"/>
      <url>/posts/7a108a3c/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>“作用域”是一套规则，用来管理引擎如何在当前作用域以及嵌套的子作用域中根据标识符名称进行变量查找。</p><p>作用域有两种主要工作模型：<strong>词法（静态）作用域</strong>和 <strong>动态作用域</strong> 。<br>静态作用域：如果函数中的变量，没有在该函数中定义，就去<strong>定义</strong>该函数的地方查找</p><p>静态作用域，也叫词法作用域，代码写完后，变量的作用域就已确定不变</p><p>动态作用域： 如果函数中的变量，没有在该函数中定义，就去<strong>调用</strong>该函数的地方查找</p><p>动态作用域，代码写完后，变量的作用域还无法确定，它和 调用它所在的函数有关</p><p>大多数语言采用的都是词法作用域，少数语言采用动态作用域（例如 Bash 脚本），这里我们主要讨论词法作用域。</p><h3 id="词法作用域"><a href="#词法作用域" class="headerlink" title="词法作用域"></a>词法作用域</h3><p>JS只有词法作用域，即在定义阶段而不是执行阶段确定作用域。例如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> value = <span class="number">1</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(value);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">function</span> <span class="title function_">bar</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> value = <span class="number">2</span>;</span><br><span class="line">    <span class="title function_">foo</span>();</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="title function_">bar</span>();<span class="comment">//1</span></span><br></pre></td></tr></table></figure><p>注意： with和eval可以修改词法作用域<br>动态修改作用域</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">eval</button></li><li class="tab"><button type="button" data-href="#super-2">with</button></li><li class="tab"><button type="button" data-href="#super-3">try...catch</button></li><li class="tab"><button type="button" data-href="#super-4">性能影响</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>eval(…) 函数</p><pre><code>接受一个字符串作为参数，并将其中的内容视为好像在书写时就存在于程序中这个位置的代码。</code></pre><p>在执行 eval(…) 之后的代码时，引擎并不知道或在意前面的代码是以动态形式插入进来并对词法作用域环境进行修改的，引擎只会像往常一样正常进行词法作用域的查找。</p><p>举个例子：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params">str</span>) &#123;</span><br><span class="line">   <span class="built_in">eval</span>(str);        <span class="comment">// &quot;欺骗&quot;词法</span></span><br><span class="line"></span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">foo</span>(<span class="string">&quot;var a = 10;&quot;</span>);</span><br></pre></td></tr></table></figure><p><strong>如大家所想，输出结果为 10。</strong><br>因为 eval(“var a &#x3D; 10;”) 在 foo 的作用域中新创建了一个同名变量 a，引擎在 foo 作用域中对 a 进行 RHS 查询，找到了新定义的 a，值为 10，所以不再向上查找全局作用域中的 a，所以导致输出结果为 10，这就是 eval(…) 的作用。</p><p>在<strong>严格模式</strong>下，eval(…) 在运行时有自己的词法作用域，意味着其中的声明无法修改所在的作用域。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;use strict;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span> (str) &#123;</span><br><span class="line">   <span class="built_in">eval</span>(str);        <span class="comment">// eval() 有自己的作用域，所以并不会修改 foo 的词法作用域</span></span><br><span class="line"></span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">foo</span>(<span class="string">&quot;var a = 10;&quot;</span>);</span><br></pre></td></tr></table></figure><p>这里输出结果为 2。</p><p>JavaScript 中还有一些功能和 eval(…) 类似的函数，例如 setTimeout(…) 和 setInterval(…) 的第一个参数可以是一个字符串，字符串的内容可以解释为一段动态生成的代码。这些功能已经过时并且不被提倡，最好不要使用它们。new Function(…) 函数的最后一个参数也可以接受代码字符串，并将其转化为动态生成的函数，也尽量避免使用。</p><p>在程序中动态生成代码的使用场景非常罕见，因为它所带来的好处无法抵消性能上的损失。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>with 通常被当做重复引用同一个对象中的多个属性的快捷方式，可以不需要重复引用对象本身。</p><p>举个例子：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">   <span class="attr">a</span>: <span class="number">2</span>,</span><br><span class="line">   <span class="attr">b</span>: <span class="number">3</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> (obj) &#123;</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(a);      <span class="comment">// 2</span></span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(b);      <span class="comment">// 3</span></span><br><span class="line">   c = <span class="number">4</span>;   </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(c);          <span class="comment">// 4, c 被泄露到全局作用域上</span></span><br></pre></td></tr></table></figure><p>如上所示，我们对 c 进行 LHS 查询，因为在 with 引入的新作用域中没有找到 c，所以向上一级作用域（这里是全局作用域）查找，也没有找到，在非严格模式下，在全局对象中新建了一个属性 c 并赋值为 4。</p><p>with 可以将一个没有或有多个属性的对象处理为一个完全隔离的词法作用域，因此这个对象的属性也会被处理为定义在这个作用域中的词法标识符。</p><p><strong>尽管 with 块可以将一个对象处理为词法作用域，但是这个块内部正常的 var 声明并不会限制在这个块作用域中，而是被添加到 with 所处的函数作用域中。</strong></p><p>严格模式下，with 被完全禁止使用。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">   <span class="attr">a</span>: <span class="number">2</span>,</span><br><span class="line">   <span class="attr">b</span>: <span class="number">3</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> (obj) &#123;</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(a);   </span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(b);  </span><br><span class="line">   c = <span class="number">4</span>;   </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(c);   </span><br></pre></td></tr></table></figure><p><img src="https://segmentfault.com/img/remote/1460000008412182" alt="严格模式下禁止使用with" title="严格模式下禁止使用with"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>try…catch 可以测试代码中的错误。try 部分包含需要运行的代码，而 catch 部分包含错误发生时运行的代码。</p><p>举个例子：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">   <span class="title function_">foo</span>();</span><br><span class="line">&#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(err);   </span><br><span class="line"></span><br><span class="line">   <span class="keyword">var</span> a = <span class="number">2</span>; </span><br><span class="line"><span class="comment">// 打印出 &quot;ReferenceError: foo is not defined at &lt;anonymous&gt;:2:4&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a);      <span class="comment">// 2</span></span><br></pre></td></tr></table></figure><p>当 try 中的代码出现错误时，就会进入 catch 块，此时会把异常对象添加到作用域链的最前端，类似于 with 一样，catch 中定义的局部变量也都会添加到包含 try…catch 的函数作用域（或全局作用域）中。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>JavaScript 引擎会在编译阶段进行数项性能优化。其中有些优化依赖于能够根据代码的词法进行静态分析，并预先确定所有变量和函数定义的位置，才能在执行过程中快速找到标识符。</p><p>但如果引擎在代码中发现了 eval(…)、with 和 try…catch ，它只能简单的假设关于标识符位置的判断都是无效的，因为无法在词法分析阶段明确知道 eval(…) 会接受到什么代码，这些代码会如何对作用域进行修改，也无法知道传递给 with 用来创建新词法作用域的对象的内容到底是什么。</p><p>最悲观的情况是如果出现了这些动态添加作用域的代码，所有的优化可能都是无意义的，因此最简单的做法就是完全不进行任何优化。</p><p>如果代码中大量使用 eval(…) 和 with，那么运行起来一定会变得非常缓慢。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="块级作用域"><a href="#块级作用域" class="headerlink" title="块级作用域"></a>块级作用域</h3><a href="/posts/de81bfb9/" title="ES6新特性">ES6新特性</a><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">全局作用域</button></li><li class="tab"><button type="button" data-href="#super-2">函数作用域</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><ul><li>直接编写在script标签中的JavaScript代码，都在全局作用域</li><li>全局作用域在<strong>页面打开</strong>时<strong>创建</strong>，在<strong>页面关闭</strong>时<strong>销毁</strong></li><li>在全局作用域中有一个全局对象window，它代表的是一个浏览器的窗口，它由浏览器创建，我们可以直接使用</li><li>在全局作用域中：<ul><li>创建的变量都会作为window对象的属性保存</li><li>创建的函数都会作为window对象的方法保存</li><li>全局作用域中的变量都是全局变量，在页面的任意的部分都可以访问的到</li></ul></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><ul><li><strong>调用函数</strong>时<strong>创建</strong>函数作用域，<strong>函数执行完毕</strong>以后，函数作用域<strong>销毁</strong></li><li>每调用一次函数就会创建一个新的函数作用域，它们之间是互相独立的</li><li>在函数作用域中可以访问到全局作用域的变量，在全局作用域中无法访问到函数作用域的变量</li><li>在函数中要访问全局变量可以使用window对象</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="作用域与执行上下文"><a href="#作用域与执行上下文" class="headerlink" title="作用域与执行上下文"></a>作用域与执行上下文</h3><p>（1）区别1<br>全局作用域之外，每个函数都会创建自己的作用域，作用域在函数定义时就已经确定了，而不是在函数调用时<br>全局执行上下文环境是在全局作用域确定之后，js代码马上执行之前创建<br>函数执行上下文环境是在调用函数时，函数体代码执行之前创建<br>（2）区别2<br>作用域是静态的，只要函数定义好了就一直存在，且不会在变化<br>上下文环境是动态的，调用函数时创建，函数调用结束时上下文环境就会被释放<br>（3）联系<br>执行上下文（对象）是从属于所在的作用域<br>全局上下文环境 &#x3D;&#x3D;&gt;全局作用域<br>函数上下文环境 &#x3D;&#x3D;&gt; 对应的函数使用域</p><h3 id="循环语句中的块级绑定"><a href="#循环语句中的块级绑定" class="headerlink" title="循环语句中的块级绑定"></a>循环语句中的块级绑定</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">   <span class="comment">// do something</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(i); <span class="comment">// 3</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">   <span class="comment">// do something</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ReferenceError: i is not defined</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(i); <span class="comment">// 3</span></span><br></pre></td></tr></table></figure><h3 id="全局块级绑定"><a href="#全局块级绑定" class="headerlink" title="全局块级绑定"></a>全局块级绑定</h3><p>使用var声明的变量会成为全局对象的属性，意味着可能会无意覆盖已存在的全局属性。<br>而用let和const声明的全局变量，不会添加到全局对象上。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">JSON</span> = <span class="string">&#x27;json&#x27;</span>;</span><br><span class="line"><span class="title function_">alert</span>(<span class="variable language_">window</span>.<span class="property">JSON</span>); <span class="comment">// &#x27;json&#x27; </span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="title class_">JSON</span> = <span class="string">&#x27;json&#x27;</span>;</span><br><span class="line"><span class="title function_">alert</span>(<span class="variable language_">window</span>.<span class="property">JSON</span>); <span class="comment">// &#x27;[object Object]&#x27;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 函数式编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 作用域 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>函数基础</title>
      <link href="/posts/1111c3f5/"/>
      <url>/posts/1111c3f5/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="函数创建"><a href="#函数创建" class="headerlink" title="函数创建"></a>函数创建</h2><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">使用 函数对象 创建（几乎不用）</button></li><li class="tab"><button type="button" data-href="#super-2">使用 函数声明 创建（比较常用）</button></li><li class="tab"><button type="button" data-href="#super-3">使用 函数表达式 创建（比较常用）</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>语法格式：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> 函数名 = <span class="keyword">new</span> <span class="title class_">Function</span>(<span class="string">&quot;执行语句&quot;</span>);</span><br></pre></td></tr></table></figure><p>示例代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fun = <span class="keyword">new</span> <span class="title class_">Function</span>(<span class="string">&quot;console.log(&#x27;这是我的第一个函数&#x27;);&quot;</span>);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>语法格式：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> 函数名 (参数<span class="number">1</span>, 参数<span class="number">2</span>, ...) &#123;</span><br><span class="line">    函数体</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>示例代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fun</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;这是我的第二个函数&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>语法格式：</p><p>函数表达式用一个变量来保存函数</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> add = <span class="keyword">function</span> (<span class="params">num1, num2</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> num1 + num2</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>示例代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fun  = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;这是我的第三个函数&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="函数参数"><a href="#函数参数" class="headerlink" title="函数参数"></a>函数参数</h2><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">默认参数</button></li><li class="tab"><button type="button" data-href="#super-2">剩余参数</button></li><li class="tab"><button type="button" data-href="#super-3">函数参数的传递方式</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>函数在没有得到入参时可以使用默认参数</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">fun</span> = (<span class="params">param = <span class="number">1</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(param)  <span class="comment">//1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">fun</span>()</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>如果函数的最后一个命名参数以 <code>...</code>为前缀，则它是包含剩余参数的数组。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">sum</span>(<span class="params">numA, ...nums</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(nums) &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt;nums.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        numA += nums[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> numA;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">sum</span>(<span class="number">1</span>));        <span class="comment">// 1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">sum</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>));   <span class="comment">// 6</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>按值传递VS按引用传递<br>按指传递：函数形参的值是调用函数所传入实参的副本；<br>按引用传递：函数形参的值是调用函数所传入实参的引用。</p><p>基本类型按值传递<br>对象类型？</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="函数属性"><a href="#函数属性" class="headerlink" title="函数属性"></a>函数属性</h2><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">函数内部属性</button></li><li class="tab"><button type="button" data-href="#super-2">length属性</button></li><li class="tab"><button type="button" data-href="#super-3">name属性</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>在函数内部，有两个特殊对象：<code>arguments</code>和 <code>this</code></p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">arguments对象</button></li><li class="tab"><button type="button" data-href="#super-2">this对象</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">super 1</button></li><li class="tab"><button type="button" data-href="#super-2">arguments的作用</button></li><li class="tab"><button type="button" data-href="#super-3">实参（arguments）与形参混用</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>位于函数内部，是一个类数组，存储着函数调用时的实参。</p><blockquote><p>因为有一个length属性，可以使用数组索引表示法arguments[1]来访问单个值<br>但是没有数组中的内置方法，如：forEach、reduce、filter、map。</p></blockquote><p>可以使用 <code>Array.prototype.slice</code>将 <code>arguments对象</code>转换成一个数组。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">one</span>(<span class="params"></span>) &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">slice</span>.<span class="title function_">call</span>(<span class="variable language_">arguments</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意：箭头函数中没有 <code>arguments对象</code>。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">one</span>(<span class="params"></span>) &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="variable language_">arguments</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> two = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="variable language_">arguments</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> three = <span class="keyword">function</span> <span class="title function_">three</span>(<span class="params"></span>) &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="variable language_">arguments</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">four</span> = (<span class="params"></span>) =&gt; <span class="variable language_">arguments</span>;</span><br><span class="line"><span class="title function_">four</span>(); <span class="comment">// Throws an error  - arguments is not defined</span></span><br></pre></td></tr></table></figure><p>当我们调用函数four时，它会抛出一个 <code>ReferenceError: arguments is not defined error</code>。使用rest语法，可以解决这个问题。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">four</span> = (<span class="params">...args</span>) =&gt; args;</span><br></pre></td></tr></table></figure><p>这会自动将所有参数值放入数组中。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>当需求改变：“<strong>无论传递多少参数过去，都得求出相加的和”</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params">a,b</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">add</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>)</span><br></pre></td></tr></table></figure><p>这时，<code>arguments</code>对象就派上用场了, 因为 <code>auguments</code>是个类数组，可以通过下标取值，我们遍历将所有实参相加，这样，无论传递多少参数，都可以实现求和。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params"></span>)&#123;</span><br><span class="line">   <span class="keyword">let</span> sum = <span class="number">0</span></span><br><span class="line">   <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">arguments</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">       sum = sum + <span class="variable language_">arguments</span>[i]</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> sum</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">add</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>)) <span class="comment">//&gt;&gt; 28</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">add</span>(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)) <span class="comment">//&gt;&gt; 3</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">add</span>()) <span class="comment">//&gt;&gt; 0</span></span><br></pre></td></tr></table></figure><blockquote><p>此外，arguments在实现<strong>call、bind、apply</strong>以及<strong>设计模式中</strong>还有着更加巧妙的作用，后面会单独讲解。</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><blockquote><p>参考JavaScript高级程序设计（第四版）第10章</p></blockquote><p>什么是与形参混用？看下面的代码</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params">num1, num2</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable language_">arguments</span>.<span class="property">length</span> === <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(num1 + <span class="number">10</span>)</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable language_">arguments</span>.<span class="property">length</span> === <span class="number">2</span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">arguments</span>[<span class="number">0</span>] + num2)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上面的函数中，使用了2个形参和 <code>arguments</code>对象。形参 <code>num1</code>保存着和 <code>arguments[0]</code>一样的值，因此使用谁都一样。同样 <code>arguments[1]</code>也保存着与 <code>num2</code>一样的值。</p><p>此外，arguments另一个有意思的地方是，它的值始终与对应的形参保持同步。看下面的例子：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params">num1, num2</span>) &#123;</span><br><span class="line">    <span class="variable language_">arguments</span>[<span class="number">1</span>] = <span class="number">10</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">arguments</span>[<span class="number">0</span>] + num2)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上面的函数，把第二个实参的值重写为10。因为 <code>arguments</code>对象的值会自动同步到对应的命名参数。所以修改 <code>arguments[1]</code>的值也会修改 <code>num2</code>的值，因此二者都是10。但要注意， <strong>这不意味着它们共享同一个栈内存地址，它们在内存中还是分开的，只不过会保持同步而已</strong> 。</p><p>另外切记： <strong>如果只传递了一个参数，然后把arguments[1]设置为某个值，那么这个值并不会反映到第二个形参上。这是因为，我们前面说过，arguments的值是函数调用时传递的实参个数确定的，而非定义时给出的形参个数确定的</strong> ,如下代码所示：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params">num1, num2</span>)&#123;</span><br><span class="line">    <span class="variable language_">arguments</span>[<span class="number">1</span>] = <span class="number">10</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">arguments</span>[<span class="number">0</span>] + num2) <span class="comment">//num2不会被设置为10，因为num2在下面调用时没有传递</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">add</span>(<span class="number">6</span>) <span class="comment">//&gt;&gt; NaN</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>在函数体内，<code>this</code>是指函数执行的环境对象(也叫 <code>context</code>)。一般来说，<code>this</code>指向调用函数的对象，如果没有，就是全局对象，在浏览器中就是 <code>window</code>对象。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> sum = <span class="keyword">function</span> (<span class="params"></span>) &#123; </span><br><span class="line">    <span class="comment">// 严格模式下是undefined </span></span><br><span class="line">    <span class="comment">// 非严格模式下是Window</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>); </span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">sum</span>();</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    <span class="attr">sum</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// this 为 obj 对象</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">obj.<span class="title function_">sum</span>();</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>函数的length属性是该函数期望参数的个数，不包括有默认值参数和剩余参数。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">sum</span> (numA, numB = <span class="number">1</span>, ...nums) &#123;&#125;</span><br><span class="line"><span class="title function_">alert</span>(sum.<span class="property">length</span>);  <span class="comment">// 1</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">sum</span> (numA, numB = <span class="number">1</span>, numC, ...nums) &#123;&#125;</span><br><span class="line"><span class="title function_">alert</span>(sum.<span class="property">length</span>);  <span class="comment">// 1</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="函数方法"><a href="#函数方法" class="headerlink" title="函数方法"></a>函数方法</h2><h3 id="call-apply-bind"><a href="#call-apply-bind" class="headerlink" title="call apply bind"></a>call apply bind</h3><h3 id="函数的双重职能（ES6中的函数）"><a href="#函数的双重职能（ES6中的函数）" class="headerlink" title="函数的双重职能（ES6中的函数）"></a>函数的双重职能（ES6中的函数）</h3><p>函数内部有两个不同的方法：[[Call]]和[[Constructor]]。<br>当使用<strong>普通方式</strong>调用函数时，[[Call]]会被执行。<br>当使用<strong>构造函数</strong>的形式调用函数时，[[Constructor]]会被执行。</p><p>new.target元属性<br>当以构造函数的形式调用函数时，new.target指向的是构造函数本身。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">new</span>.<span class="property">target</span> === <span class="title class_">Person</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;You must use new with Person&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> person = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&#x27;John&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> person2 = <span class="title class_">Person</span>(<span class="string">&#x27;John&#x27;</span>);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 函数式编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 函数 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数组</title>
      <link href="/posts/340249a9/"/>
      <url>/posts/340249a9/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="创建-x2F-访问-x2F-修改数组"><a href="#创建-x2F-访问-x2F-修改数组" class="headerlink" title="创建&#x2F;访问&#x2F;修改数组"></a>创建&#x2F;访问&#x2F;修改数组</h3><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">创建</button></li><li class="tab"><button type="button" data-href="#super-2">访问</button></li><li class="tab"><button type="button" data-href="#super-3">修改</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">Array构造函数</button></li><li class="tab"><button type="button" data-href="#super-2">数组字面量表示法</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr1 = <span class="keyword">new</span> <span class="title class_">Array</span>();     <span class="comment">// 创建一个空数组</span></span><br><span class="line"><span class="keyword">var</span> arr2 = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">10</span>);   <span class="comment">// 创建一个包含20项的数组</span></span><br><span class="line"><span class="keyword">var</span> arr3 = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="string">&#x27;liu&#x27;</span>, <span class="string">&#x27;wang&#x27;</span>, <span class="string">&#x27;li&#x27;</span>);  <span class="comment">// 创建一个包含3个字符串的数组</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr1 = [];      <span class="comment">// 创建一个空数组</span></span><br><span class="line"><span class="keyword">var</span> arr2 = [<span class="number">10</span>];    <span class="comment">// 创建一个包含1项的数组</span></span><br><span class="line"><span class="keyword">var</span> arr3 = [<span class="string">&#x27;liu&#x27;</span>, <span class="string">&#x27;wang&#x27;</span>, <span class="string">&#x27;li&#x27;</span>];   <span class="comment">// 创建一个包含3个字符串的数组</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> songs = [</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&#x27;My My My!&#x27;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&#x27;无问东西&#x27;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">name</span>: <span class="string">&#x27;枷锁&#x27;</span> &#125;</span><br><span class="line">];</span><br><span class="line">songs[<span class="number">0</span>];   <span class="comment">// &#123; id: 1, name: &#x27;My My My!&#x27; &#125;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> songs = [</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&#x27;My My My!&#x27;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&#x27;无问东西&#x27;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">name</span>: <span class="string">&#x27;枷锁&#x27;</span> &#125;</span><br><span class="line">];</span><br><span class="line">songs[<span class="number">0</span>] = &#123; <span class="attr">id</span>: <span class="number">4</span>, <span class="attr">name</span>: <span class="string">&#x27;There for you!&#x27;</span> &#125;;   </span><br><span class="line"><span class="comment">// &#123; id: 4, name: &#x27;There for you!&#x27; &#125;,</span></span><br><span class="line"><span class="comment">// &#123; id: 2, name: &#x27;无问东西&#x27; &#125;,</span></span><br><span class="line"><span class="comment">// &#123; id: 3, name: &#x27;枷锁&#x27; &#125;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="常用数组方法"><a href="#常用数组方法" class="headerlink" title="常用数组方法"></a>常用数组方法</h3><table><thead><tr><th>方法名</th><th>描述</th></tr></thead><tbody><tr><td>join</td><td>把数组的所有元素放入一个字符串，元素通过指定的分隔符进行分隔</td></tr><tr><td>push</td><td>向数组的末尾添加一个或更多元素，并返回新的长度</td></tr><tr><td>pop</td><td>删除并返回数组的最后一个元素</td></tr><tr><td>unshift</td><td>向数组的开头添加一个或更多元素，并返回新的长度</td></tr><tr><td>shift</td><td>删除并返回数组的第一个元素</td></tr><tr><td>slice</td><td>从某个已有的数组返回指定的元素</td></tr><tr><td>indexOf</td><td>返回第一个与给定参数相等的数组元素的索引，没有找到则返回-1</td></tr><tr><td>lastIndexOf</td><td>返回在数组中搜索到的与给定参数相等的元素的索引里的最大的值，没有找到则返回-1</td></tr><tr><td>valueOf</td><td>返回数组对象的原始值</td></tr><tr><td>sort</td><td>对数组的元素进行排序</td></tr><tr><td>reverse</td><td>颠倒数组中元素的顺序</td></tr><tr><td>concat</td><td>连接2个或更多数组，并返回结果</td></tr><tr><td>splice</td><td>删除元素，并向数组添加新元素</td></tr><tr><td>toString</td><td>把数组转换为字符串，并返回结果</td></tr><tr><td>toLocaleString</td><td>把数组转换为本地字符串，并返回结果</td></tr><tr><td>forEach</td><td>对数组中的每一项运行指定函数，这个方法没有返回值</td></tr><tr><td>every</td><td>对数组中的每一项运行指定函数，如果该函数对每一项都返回true，则返回true</td></tr><tr><td>some</td><td>对数组中的每一项运行指定函数，如果任一项返回true，则返回true</td></tr><tr><td>filter</td><td>对数组中的每一项运行指定函数，返回该函数会返回true的项组成的数组</td></tr><tr><td>map</td><td>对数组中的每一项运行指定函数，返回每次函数调用的结果组成的数组</td></tr><tr><td>reduce</td><td>接收一个函数作为累加器，数组中的每个值（从左到右）开始缩减，最终计算为一个值</td></tr><tr><td>reduceRight</td><td>接收一个函数作为累加器，数组中的每个值（从右到左）开始缩减，最终计算为一个值</td></tr></tbody></table><p><strong>PS：原始值是指固定而简单的值，存放在栈中的简单数据段，它们的值直接存储在变量访问的位置。</strong></p><h3 id="数组方法解析"><a href="#数组方法解析" class="headerlink" title="数组方法解析"></a>数组方法解析</h3><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">数组检测</button></li><li class="tab"><button type="button" data-href="#super-2">会更改原数组的方法</button></li><li class="tab"><button type="button" data-href="#super-3">不会更改原数组的方法</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">instanceof 运算符</button></li><li class="tab"><button type="button" data-href="#super-2">Array.isArray()</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><blockquote><p>可检测是否为数组，结果为布尔值（true&#x2F;false）</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [], obj = &#123;&#125;;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr <span class="keyword">instanceof</span> <span class="title class_">Array</span>); <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj <span class="keyword">instanceof</span> <span class="title class_">Array</span>); <span class="comment">// false</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><blockquote><p>如果对象是Array，则为true，否则为false</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [], obj = &#123;&#125;;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Array</span>.<span class="title function_">isArray</span>(arr)); <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Array</span>.<span class="title function_">isArray</span>(obj)); <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p>Array.isArray() 和 instanceof的区别：</p><blockquote><ul><li>当检测Array实例时，Array.isArray 优于 instanceof，因为Array.isArray 能检测 iframes</li><li>Array.isArray 是H5新增的方法，IE9以上版本支持</li></ul></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">排序</button></li><li class="tab"><button type="button" data-href="#super-2">添加/删除元素</button></li><li class="tab"><button type="button" data-href="#super-3">替换</button></li><li class="tab"><button type="button" data-href="#super-4">变形</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">sort()</button></li><li class="tab"><button type="button" data-href="#super-2">reverse()</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><strong>作用</strong></p><pre><code>对数组的元素进行排序（默认升序）。**语法**</code></pre><blockquote><p>arrayObject.sort(sortby)</p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>sortby</td><td>可选。规定排序顺序。必须是函数。</td></tr></tbody></table></blockquote><p><strong>返回值</strong></p><pre><code>对原数组的引用。请注意，数组在原数组上进行排序，不生成副本。**案例**</code></pre><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">5</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>];</span><br><span class="line">arr.<span class="title function_">sort</span>(<span class="keyword">function</span>(<span class="params">a, b</span>)&#123;</span><br><span class="line">    <span class="comment">// return a - b; // 升序排序</span></span><br><span class="line">    <span class="keyword">return</span> b - a; <span class="comment">// 降序排序</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr); <span class="comment">// [1, 2, 4, 5, 6]</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//升序</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">compare</span>(<span class="params">value1,value2</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(value1 &lt; value2) &#123;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;   <span class="comment">// 想要value1位于value2之前，则返回负数</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(value1 &gt; value2) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;    <span class="comment">// 想要value1位于value2之后，则返回正数</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> value = [<span class="number">0</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">15</span>]</span><br><span class="line">value.<span class="title function_">sort</span>(compare),</span><br><span class="line">values <span class="comment">// 0,1,5,10,15</span></span><br></pre></td></tr></table></figure><p>对于数值类型或者其valueOf()方法会返回数值类型的对象类型，可以使用更简单的比较函数：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//升序</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">compareNumbers</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> a - b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><strong>作用</strong></p><pre><code>reverse()方法用于颠倒数组中元素的顺序（默认降序）。会改变原数组。**语法**</code></pre><blockquote><p>arrayObject.reverse()<br><strong>返回值</strong></p></blockquote><p><strong>案例</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">arr.<span class="title function_">reverse</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr); <span class="comment">// [4,3,2,1]</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">push()</button></li><li class="tab"><button type="button" data-href="#super-2">unshift()</button></li><li class="tab"><button type="button" data-href="#super-3">pop()</button></li><li class="tab"><button type="button" data-href="#super-4">shift()</button></li><li class="tab"><button type="button" data-href="#super-5">.splice()</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><strong>作用</strong></p><pre><code>向数组末尾添加一个或多个元素**语法**</code></pre><blockquote><p>.push(..items)</p><ul><li>…items：被添加到<strong>数组末尾</strong>的元素<br><strong>返回值</strong></li></ul></blockquote><pre><code>* 添加元素后的新数组length值* 原数组已改变</code></pre><ul><li>在数组末尾添加一个或多个元素，并返回新的数组</li><li>push() 参数直接写数组元素即可</li><li>push 完毕之后，返回的结果是 新数组的长度</li><li>原来的数组会改变</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line"><span class="comment">// arr.push(4, &#x27;jay&#x27;); // 给数组增加元素</span></span><br><span class="line"><span class="comment">// console.log(arr); // [1,2,3,4,&#x27;jay&#x27;]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="title function_">push</span>(<span class="number">4</span>, <span class="string">&#x27;jay&#x27;</span>)) <span class="comment">// 5 返回新数组的长度</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><strong>作用</strong></p><pre><code>在数组开头添加一个或多个元素**语法**</code></pre><blockquote><p>unshift(…items)</p><ul><li>…items：被添加到<strong>数组开头</strong>的元素<br><strong>返回值</strong></li></ul></blockquote><ul><li>添加元素后的新数组length值</li><li>直接修改原数组</li><li>在数组开头，添加一个或多个数组元素</li><li>unshift() 参数直接写数组元素即可</li><li>unshift 完毕之后，返回的结果是 新数组的长度</li><li>原来数组会改变</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line">arr.<span class="title function_">unshift</span>(<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>); <span class="comment">// [&#x27;red&#x27;, &#x27;blue&#x27;, 1, 2, 3]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="title function_">unshift</span>(<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>)); <span class="comment">// 7 返回新数组的长度</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p><strong>作用</strong></p><pre><code>删除数组的最后一个元素**语法**</code></pre><blockquote><p>arrayObject.pop()<br><strong>返回值</strong></p></blockquote><ul><li>返回删除的元素值&#x2F;undefined</li><li>原数组已改变</li></ul><p>pop() 方法将删除 arrayObject 的最后一个元素，把数组长度减 1，并且返回它删除的元素的值。如果数组已经为空，则 pop() 不改变数组，并返回 undefined 值。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line">arr.<span class="title function_">pop</span>(); <span class="comment">// [1,2]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="title function_">pop</span>());<span class="comment">// 3 返回被删除的元素</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p><strong>作用</strong></p><pre><code>删除数组的第一个元素**语法**</code></pre><blockquote><p>shift()<br><strong>返回值</strong></p></blockquote><ul><li>返回删除的元素值&#x2F;undefined</li><li>原数组已改变</li></ul><p>如果数组是空的，那么 shift() 方法将不进行任何操作，返回 undefined 值。请注意，该方法不创建新数组，而是直接修改原有的 arrayObject。</p><ul><li>删除数组的第一个元素，一次只能删一个</li><li>shift() 没有参数</li><li>shift()完毕之后，返回的结果是 删除的那个元素</li><li>原数组会变化</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line">arr.<span class="title function_">shift</span>(); <span class="comment">// [2,3]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="title function_">shift</span>());</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p><strong>作用</strong></p><pre><code>在任意位置删除或添加元素，该方法会改变原始数组。</code></pre><p><strong>语法</strong></p><blockquote><p>.splice(index, deleteCount, …items)</p><ul><li>index：修改的起始位置</li><li>deleteCount：移除的数组元素个数（可选）</li><li>…items：添加进数组的元素（可选）<br><strong>返回值</strong></li></ul></blockquote><pre><code>被删除/添加元素组成的原数组**说明**<p>splice()方法可删除从index处开始的0个或多个元素，并且用参数列表中声明的一个或多个值来替换那些被删除的元素。如果从arrayObject中删除了元素，则返回的是含有被删除的元素的数组。<br></code></pre></p><p>splice()方法演示：该方法可以用于删除数组中的指定元素，该方法会影响到原数组，会将指定元素从原数组中删除，并将被删除的元素作为返回值返回</p><p>参数：</p><p>第一个参数：表示开始位置的索引<br>第二个参数：表示要删除的元素数量<br>第三个参数及以后参数：可以传递一些新的元素，这些元素将会自动插入到开始位置索引前边</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">&quot;孙悟空&quot;</span>, <span class="string">&quot;猪八戒&quot;</span>, <span class="string">&quot;沙和尚&quot;</span>, <span class="string">&quot;唐僧&quot;</span>, <span class="string">&quot;白骨精&quot;</span>];</span><br><span class="line"><span class="keyword">var</span> result = arr.<span class="title function_">splice</span>(<span class="number">3</span>, <span class="number">2</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line">result = arr.<span class="title function_">splice</span>(<span class="number">1</span>, <span class="number">0</span>, <span class="string">&quot;牛魔王&quot;</span>, <span class="string">&quot;铁扇公主&quot;</span>, <span class="string">&quot;红孩儿&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">fill()</button></li><li class="tab"><button type="button" data-href="#super-2">super 2</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>作用：<br>会将数组中索引的第一个到最后一个的每个位置全部填入一个静态的值。</p><p>语法：</p><blockquote><p>Array.prototype.fill(value[, start[, end]])<br>参数：</p></blockquote><ul><li>value：想要插入的值</li><li>start【可选】：起始的位置，默认为 0</li><li>end【可选】：结束的位置，默认为 数组长度<br>注意：不包括 end 的位置<br>返回值：</li><li>修改后的数组</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 沒有 start 和 end, 所以从 0 到数组的长度</span></span><br><span class="line"><span class="keyword">var</span> val = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(val.<span class="title function_">fill</span>(<span class="number">5</span>)) <span class="comment">// [5,5,5,5,5]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 只有 start 沒有 end,从 start 到数组结尾</span></span><br><span class="line"><span class="keyword">var</span> val2 = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(val2.<span class="title function_">fill</span>(<span class="number">5</span>,<span class="number">3</span>)) <span class="comment">// [1,2,3,5,5]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 有 start 也有 end, 从 star 到 end (不包括 end) 插入 5</span></span><br><span class="line"><span class="keyword">var</span> val3 = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(val3.<span class="title function_">fill</span>(<span class="number">5</span>,<span class="number">2</span>,<span class="number">3</span>)) <span class="comment">// [1,2,5,4,5]</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">copyWithin()</button></li><li class="tab"><button type="button" data-href="#super-2">super 2</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>作用：<br>对数组的一部分进行浅拷贝至同一数组的另一位置并回传此阵列，而不修改其大小。<br>返回被修改后的数组，原数组也会被修改。</p><p>语法：<br>Array.prototype.copyWithin(target, start, end)<br>参数</p><ul><li>target：要复制序列到这个位置的索引<br>如果是負數，target 從末尾開始算<br>如果 targrt 大於等於 arr.length, 則沒有項目被複製</li><li>start【可選】：開始複製的起始元素索引（起始為 0 ）</li><li>end【可選】：結束複製的元素索引，會從 start 複製到 end, 但是不包括 end 的值<br>如果省略 end，將會一路複製到數組末項<br>返回追：</li><li>修改后的数组</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> val = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(val.<span class="title function_">copyWithin</span>(<span class="number">3</span>)) <span class="comment">// [1,2,3,1,2,3]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> val2 = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(val2.<span class="title function_">copyWithin</span>(<span class="number">3</span>,<span class="number">2</span>)) <span class="comment">// [1,2,3,3,4,5]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> val3 = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(val3.<span class="title function_">copyWithin</span>(<span class="number">3</span>,<span class="number">2</span>,<span class="number">5</span>)) <span class="comment">// [1,2,3,3,4,5]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> val4 = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(val4.<span class="title function_">copyWithin</span>(<span class="number">8</span>,<span class="number">2</span>,<span class="number">5</span>)) <span class="comment">// [1,2,3,4,5,6]  // target 超過數組長度</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">操作</button></li><li class="tab"><button type="button" data-href="#super-2">转换成字符串</button></li><li class="tab"><button type="button" data-href="#super-3">转换成数组</button></li><li class="tab"><button type="button" data-href="#super-4">获取元素索引</button></li><li class="tab"><button type="button" data-href="#super-5">迭代方法</button></li><li class="tab"><button type="button" data-href="#super-6">归并方法</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">.concat()</button></li><li class="tab"><button type="button" data-href="#super-2">.slice()</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><strong>作用</strong></p><pre><code>concat()方法用于连接两个或多个数组。该方法不会改变现有的数组，而仅仅会返回被连接数组的一个副本。</code></pre><p><strong>语法</strong></p><blockquote><p>.concat(…arguments)</p><ul><li>…arguments：需要合并的值</li></ul></blockquote><p><strong>返回值</strong></p><pre><code>返回一个新的数组。该数组是通过把所有arrayX参数添加到arrayObject中生成的。如果要进行concat()操作的参数是数组，那么添加的是数组中的元素，而不是数组。</code></pre><p>concat()方法</p><blockquote><p>连接两个或多个数组，并将新的数组返回，不会改变原来的数组<br>演示</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">&quot;孙悟空&quot;</span>, <span class="string">&quot;猪八戒&quot;</span>, <span class="string">&quot;沙和尚&quot;</span>];</span><br><span class="line"><span class="keyword">var</span> arr2 = [<span class="string">&quot;白骨精&quot;</span>, <span class="string">&quot;玉兔精&quot;</span>, <span class="string">&quot;蜘蛛精&quot;</span>];</span><br><span class="line"><span class="keyword">var</span> arr3 = [<span class="string">&quot;二郎神&quot;</span>, <span class="string">&quot;太上老君&quot;</span>, <span class="string">&quot;玉皇大帝&quot;</span>];</span><br><span class="line"><span class="keyword">var</span> result = arr.<span class="title function_">concat</span>(arr2, arr3, <span class="string">&quot;牛魔王&quot;</span>, <span class="string">&quot;铁扇公主&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result);<span class="number">6</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><strong>作用</strong></p><pre><code>截取数组中开始位置到结束位置的元素（不包括结束位置），浅拷贝生成新数组，不会改变元素数组**语法**</code></pre><blockquote><p>.slice(start, end)</p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>start</td><td>必需。规定从何处开始选取。<code>如果是负数，那么它规定从数组尾部开始算起的位置。</code>也就是说，-1指最后一个元素，-2指倒数第二个元素，以此类推。</td></tr><tr><td>end</td><td>可选。规定从何处结束选取。<code>该参数是数组片断结束处的数组下标。</code>如果没有指定该参数，那么切分的数组包含从start到数组结束的所有元素。&#96;&#96;如果这个参数是负数，那么它规定的是从数组尾部开始算起的元素。</td></tr></tbody></table></blockquote><p><strong>返回值</strong></p><pre><code>返回一个新的数组，包含从 start 到 end （不包括该元素）的 arrayObject 中的元素。**说明**<p>请注意，该方法并不会修改数组，而是返回一个子数组。如果想删除数组中的一段元素，应该使用方法 Array.splice()。<br></code></pre></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">&quot;孙悟空&quot;</span>, <span class="string">&quot;猪八戒&quot;</span>, <span class="string">&quot;沙和尚&quot;</span>, <span class="string">&quot;唐僧&quot;</span>, <span class="string">&quot;白骨精&quot;</span>];</span><br><span class="line"><span class="keyword">var</span> result = arr.<span class="title function_">slice</span>(<span class="number">1</span>, <span class="number">4</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line">result = arr.<span class="title function_">slice</span>(<span class="number">3</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line">result = arr.<span class="title function_">slice</span>(<span class="number">1</span>, -<span class="number">2</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">toLocalString</button></li><li class="tab"><button type="button" data-href="#super-2">toString</button></li><li class="tab"><button type="button" data-href="#super-3">valueOf</button></li><li class="tab"><button type="button" data-href="#super-4">join</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><strong>作用</strong></p><pre><code>toLocaleString()方法可把数组转换为本地字符串，并返回结果。</code></pre><p><strong>语法</strong></p><blockquote><p>arrayObject.toLocaleString()</p></blockquote><p><strong>返回值</strong></p><pre><code>arrayObject的本地字符串表示。</code></pre><p><strong>说明</strong></p><pre><code>首先调用每个数组元素的 toLocaleString() 方法，然后使用地区特定的分隔符把生成的字符串连接起来，形成一个字符串。</code></pre><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">4</span>);</span><br><span class="line">arr[<span class="number">0</span>] = <span class="string">&quot;Geroge&quot;</span>;</span><br><span class="line">arr[<span class="number">1</span>] = <span class="string">&quot;John&quot;</span>;</span><br><span class="line">arr[<span class="number">2</span>] = <span class="string">&quot;Thomas&quot;</span>;</span><br><span class="line">arr[<span class="number">3</span>] = <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="title function_">toLocaleString</span>());    <span class="comment">// &quot;Geroge,John,Thomas,20&quot;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><strong>作用</strong></p><pre><code>toString()方法可把数组转换为字符串，并返回结果。</code></pre><p><strong>语法</strong></p><blockquote><p>.toString()</p></blockquote><p><strong>返回值</strong></p><pre><code>arrayObject的字符串表示。返回值与没有参数的join()方法返回的字符串相同。</code></pre><p><strong>说明</strong></p><pre><code>当数组用于字符串环境时，JavaScript会调用这一方法将数组自动转换成字符串。但是在某些情况下，需要显式地调用该方法。</code></pre><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">4</span>);</span><br><span class="line">arr[<span class="number">0</span>] = <span class="string">&quot;Geroge&quot;</span>;</span><br><span class="line">arr[<span class="number">1</span>] = <span class="string">&quot;John&quot;</span>;</span><br><span class="line">arr[<span class="number">2</span>] = <span class="string">&quot;Thomas&quot;</span>;</span><br><span class="line">arr[<span class="number">3</span>] = <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="title function_">toString</span>());    <span class="comment">// &quot;Geroge,John,Thomas,20&quot;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p><strong>作用</strong><br>valueOf()方法返回Array对象的原始值。该原始值由Array对象派生的所有对象继承。valueOf(）方法通常由JavaScript在后台自动调用，并不显式地出现在代码中。</p><p><strong>语法</strong></p><blockquote><p>arrayObject.valueOf()</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">4</span>);</span><br><span class="line">arr[<span class="number">0</span>] = <span class="string">&quot;Geroge&quot;</span>;</span><br><span class="line">arr[<span class="number">1</span>] = <span class="string">&quot;John&quot;</span>;</span><br><span class="line">arr[<span class="number">2</span>] = <span class="string">&quot;Thomas&quot;</span>;</span><br><span class="line">arr[<span class="number">3</span>] = <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="title function_">valueOf</span>());    <span class="comment">// [&quot;Geroge&quot;, &quot;John&quot;, &quot;Thomas&quot;, 20]</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p><strong>作用</strong></p><pre><code>把数组中的所有元素放入一个字符串。元素是通过指定的分隔符进行分隔的。将数组中的元素连接成一个字符串</code></pre><p><strong>语法</strong></p><blockquote><p>arrayObject.join(separator)<br>seperator：元素之间的分隔符（可选），如果省略该参数，则使用逗号作为分隔符</p></blockquote><p><strong>返回值</strong></p><pre><code>返回一个元素拼接的字符串</code></pre><p>返回一个字符串。该字符串是通过把 arrayObject 的每个元素转换为字符串，然后把这些字符串连接起来，在两个元素之间插入 separator 字符串而生成的。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">3</span>);</span><br><span class="line">arr[<span class="number">0</span>] = <span class="string">&quot;Geroge&quot;</span>;</span><br><span class="line">arr[<span class="number">1</span>] = <span class="string">&quot;John&quot;</span>;</span><br><span class="line">arr[<span class="number">2</span>] = <span class="string">&quot;Thomas&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> str1 = arr.<span class="title function_">join</span>();</span><br><span class="line"><span class="keyword">var</span> str2 = arr.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> str3 = arr.<span class="title function_">join</span>(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> str4 = arr.<span class="title function_">join</span>(<span class="string">&#x27;-&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str1);  <span class="comment">// &quot;Geroge,John,Thomas&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str2);  <span class="comment">// &quot;GerogeJohnThomas&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str3);  <span class="comment">// &quot;Geroge John Thomas&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str4);  <span class="comment">// &quot;Geroge-John-Thomas&quot;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">.from()</button></li><li class="tab"><button type="button" data-href="#super-2">.of()</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>作用：<br>从一个类似数组或可迭代对象中创建一个新的数组实例<br>语法：<br>Array.from(items[, mapFn[, thisArg]]);</p><ul><li>items：想要转换成数组的伪数组对象或可迭代对象</li><li>mapfn:回调函数，新数组的每个元素会执行，可选<ul><li>item：数组中正在处理的当前元素</li><li>index：正在处理的当前元素的索引</li></ul></li><li>thisArg：执行mapfn时的用于this的值，可选</li></ul><p>返回值</p><ul><li>新的数组实例</li></ul><p>实例：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Array</span>.<span class="title function_">from</span>(<span class="string">&#x27;163&#x27;</span>)</span><br><span class="line"><span class="comment">// [&#x27;1&#x27;,&#x27;6&#x27;,&#x27;3&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="number">0</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="number">1</span>: <span class="number">6</span>,</span><br><span class="line">  <span class="number">2</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="attr">length</span>: <span class="number">3</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> array = <span class="title class_">Array</span>.<span class="title function_">from</span>(obj);</span><br><span class="line"><span class="comment">// [1, 6, 3]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> parse2Int = <span class="keyword">function</span>(<span class="params">iitem, index</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">parseInt</span>(item)*<span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Array</span>.<span class="title function_">from</span>(<span class="string">&#x27;163&#x27;</span>, parse2Int);</span><br><span class="line"><span class="comment">// [2, 12, 6]</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>作用：根据输入参数生成新的数组<br>语法：<br>Array.of(…items)<br>参数：</p><ul><li>…items：任意个参数，按顺序成为新数组中的元素<br>返回值：<br>新的数组实例<br>实例：</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Array</span>.<span class="title function_">of</span>(<span class="number">1</span>)</span><br><span class="line"><span class="comment">// [1]</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Array</span>.<span class="title function_">of</span>(<span class="number">1</span>, <span class="number">6</span>, <span class="number">3</span>)</span><br><span class="line"><span class="comment">// [1, 6, 3]</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">indexOf()</button></li><li class="tab"><button type="button" data-href="#super-2">lastIndexOf()</button></li><li class="tab"><button type="button" data-href="#super-3">find()</button></li><li class="tab"><button type="button" data-href="#super-4">findIndex()</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><strong>作用</strong></p><pre><code>indexOf()方法可返回某个指定的值在数组中首次出现的位置。从左往右找，找不到返回-1。**语法**</code></pre><blockquote><p>indexOf(searchElement[0, fromIndex])<br>数组中查找给定元素的第一个索引<br>如果存在，返回索引号，如果不存在，则返回-1</p></blockquote><p>indexOf()：</p><ul><li>indexOf(数组元素) ：返回该数组元素的索引号</li><li>只返回一个满足条件的索引号</li><li>如果在该数组中找不到该数组元素，则返回-1</li><li>indexOf(数组元素，起始位置)：indexOf(‘春’,3) 表示从索引号为 3 的位置开始往后查找 春 字</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 示例  indexOf(数组元素)</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>, <span class="string">&#x27;pink&#x27;</span>];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="title function_">indexOf</span>(<span class="string">&#x27;blue&#x27;</span>)); <span class="comment">// 1</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><strong>作用</strong></p><pre><code>lastIndexOf()方法可返回某个指定的值在数组中首次出现的位置。从右往左找，找不到返回-1。</code></pre><p>在数组中的最后一个的索引</p><p><strong>语法</strong></p><blockquote><p>arrayObject.indexOf(searchValue, fromIndex)</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>作用：<br>返回第一个满足函数条件的元素值</p><p>语法：<br>arr.find(callback[, thisArg])</p><p>参数：<br>接受 2 个参数 callback 和 thisArg</p><ul><li>callback 函数<br>处理数组每一個元素的函数，接受三个参数<ul><li>currentEle：正被处理的函数</li><li>index【可选】：正被处理的函数索引</li><li>array【可选】：呼叫 find 方法的数组</li></ul></li><li>thisArg【可选】：执行 callback 函式时被当作 this 的物件</li></ul><p>返回值：</p><ul><li>找到的元素，或者undefined</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 返回符合 大於3 的第一個元素</span></span><br><span class="line"><span class="keyword">var</span> val = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line"><span class="keyword">var</span> <span class="title function_">fn</span> = i =&gt; i &gt; <span class="number">3</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(val.<span class="title function_">find</span>(fn)) <span class="comment">// 4</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>返回第一個滿足函數條件的元素值索引，否則返回 -1</p><p>其與 find()的區別在於，前者返回的元素值，後者返回的是元素值的索引值</p><p>arr.findIndex(callback[, thisArg])</p><p>接受 2 個參數 callback 和 thisArg</p><ul><li><p>callback 函數</p><p>會處理數組每一個元素的函數，它接受三個參數</p><ul><li><p>element</p><p>正被處理的函數</p></li><li><p>【可選】index</p><p>正被處理的函數索引</p></li><li><p>【可選】array</p><p>呼叫 find 方法的數組</p></li></ul></li><li><p>【可選】thisArg</p><p>執行 callback 函式時被當作 this 的物件</p></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 返回符合 大於3 的第一個元素索引</span></span><br><span class="line"><span class="keyword">var</span> val = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line"><span class="keyword">var</span> <span class="title function_">fn</span> = i =&gt; i &gt; <span class="number">3</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(val.<span class="title function_">findIndex</span>(fn)) <span class="comment">// 3</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p>对数组中的每一项运行给定函数，根据函数结果做出相应的操作。</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">.every()</button></li><li class="tab"><button type="button" data-href="#super-2">.filter()</button></li><li class="tab"><button type="button" data-href="#super-3">.forEach()</button></li><li class="tab"><button type="button" data-href="#super-4">.map()</button></li><li class="tab"><button type="button" data-href="#super-5">.some()</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><strong>作用</strong><br>every()方法用于检测数组所有元素是否都符合指定条件（通过函数提供）。<br>every()方法使用指定函数检测数组中的所有元素：</p><ul><li>如果数组中检测到有一个元素不满足，则整个表达式返回false，且剩余的元素不会再进行检测。</li><li>如果所有元素都满足条件，则返回true。</li></ul><p>注意：every()不会对空数组进行检测。<br>注意：every()不会改变原始数组。</p><p><strong>语法</strong></p><blockquote><p>Array.prototype.every(callbackFn[, thisArg])</p></blockquote><p>参数：</p><ul><li>callbackFn：函数（必需），数组中的每个元素都会执行这个函数。<ul><li>currentValue: 必需，数组中正在处理的当前元素。</li><li>index: 可选。数组中正在处理的当前元素的索引值。</li><li>array: 可选。正在操作的数组对象。</li></ul></li><li>thisValue：可选。对象作为该执行回调时使用，传递给函数。</li></ul><p>返回值：</p><ul><li>布尔值（true&#x2F;false）</li></ul><p><strong>说明</strong></p><p>有一个返回false，则整个every()返回值为false，并且不会执行后续其他项的回调函数。<br>空数组的every()直接返回true。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ages = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">24</span>, <span class="number">32</span>, <span class="number">40</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> result = ages.<span class="title function_">every</span>(<span class="keyword">function</span> (<span class="params">value, index, arr</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> value &gt; <span class="number">25</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result);    <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line">ages = [];</span><br><span class="line">result = ages.<span class="title function_">every</span>(<span class="keyword">function</span> (<span class="params">value, index, arr</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> value &gt; <span class="number">25</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result);    <span class="comment">// true</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><strong>作用</strong><br>创建一个新的数组，该数组包括通过callbackFn函数测试的原数组的所有元素</p><p>注意：filter()不会对空数组进行检测。<br>注意：filter()不会改变原始数组。</p><p><strong>语法</strong></p><blockquote><p>Array.prototype.filter(callbackFn[, thisArg])</p></blockquote><p>参数：</p><ul><li>callbackFn：函数（必需），数组中的每个元素都会执行这个函数。<ul><li>currentValue: 必需，数组中正在处理的当前元素。</li><li>index: 可选。数组中正在处理的当前元素的索引值。</li><li>array: 可选。正在操作的数组对象。</li></ul></li><li>thisValue：可选。对象作为该执行回调时使用，传递给函数。</li></ul><p>返回值：</p><ul><li>由通过测试的元素组成的新数组，或者[]</li></ul><p><strong>说明</strong></p><p>将所有返回true的数组项取出来组成一个新的数组。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ages = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">24</span>, <span class="number">32</span>, <span class="number">40</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> result = ages.<span class="title function_">filter</span>(<span class="keyword">function</span> (<span class="params">value, index, arr</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> value &gt; <span class="number">25</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result);    <span class="comment">// [32, 40]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ages);      <span class="comment">// [10, 20, 24, 32, 40]</span></span><br><span class="line"></span><br><span class="line">ages = [];</span><br><span class="line">result = ages.<span class="title function_">filter</span>(<span class="keyword">function</span> (<span class="params">value, index, arr</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> value &gt; <span class="number">25</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result);    <span class="comment">// []</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p><strong>作用</strong><br>遍历数组中的每个元素<br>对每个元素执行callbackFn函数<br><strong>语法</strong><br>.forEach(callbackFn[, thisArg])<br>callbackFn：数组中每个元素执行的函数<br>    - currentValue：数组中正在处理的当前元素<br>    - index：数组中正在处理的当前元素的索引<br>    - array：正在操作的数组<br>thisArg：callbackFn函数中的this指向（可选）<br>无返回值                                           |<br>forEach()方法演示：该方法可以用来遍历数组</p><p>forEach()方法需要一个函数作为参数，像这种函数，由我们创建但是不由我们调用的，我们称为回调函数。数组中有几个元素函数就会执行几次，每次执行时，浏览器会将遍历到的元素，以实参的形式传递进来，我们可以来定义形参，来读取这些内容，浏览器会在回调函数中传递三个参数：</p><p>第一个参数：就是当前正在遍历的元素<br>第二个参数：就是当前正在遍历的元素的索引<br>第三个参数：就是正在遍历的数组<br>注意：这个方法只支持IE8以上的浏览器，IE8及以下的浏览器均不支持该方法，所以如果需要兼容IE8，则不要使用forEach()，还是使用for循环来遍历数组。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">&quot;孙悟空&quot;</span>, <span class="string">&quot;猪八戒&quot;</span>, <span class="string">&quot;沙和尚&quot;</span>];</span><br><span class="line">arr.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">value, index, obj</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(value + <span class="string">&quot; #### &quot;</span> + index + <span class="string">&quot; #### &quot;</span> + obj);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p><strong>作用</strong><br>创建一个新数组<br>其中元素为执行callbackFn函数后返回的结果<br>map()方法返回一个新数组，数组中的元素为原始数组元素调用函数处理后的值。map()方法按照原始数组元素顺序依次处理元素。</p><p>注意：map()不会对空数组进行检测。<br>注意：map()不会改变原始数组。</p><p><strong>语法</strong><br>.map(callbackFn[, thisArg])<br>callbackFn：生成新数组元素的函数 <code>&lt;br /&gt;</code>    - currentValue：数组中正在处理的当前元素 <code>&lt;br /&gt;</code>    - index：数组中正在处理的当前元素的索引 <code>&lt;br /&gt;</code>    - array：正在操作的数组 <code>&lt;br /&gt;</code>thisArg：callbackFn函数中的this指向（可选）</p><blockquote><p>arrayObject.map(function (currentValue, index, arr) {}, thisValue)</p></blockquote><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>function (currentValue, index, arr)</td><td>必需。函数，数组中的每个元素都会执行这个函数。<code>currentValue: 必需。当前元素。</code>index: 可选。当前元素的索引值。&#96;&#96;arr: 可选。当前元素所属的数组对象。</td></tr><tr><td>thisValue</td><td>可选。对象作为该执行回调时使用，传递给函数。&#96;&#96;</td></tr></tbody></table><p><strong>返回值</strong><br>新数组 <code>&lt;br /&gt;</code>其中元素为执行callbackFn函数后的返回值</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> numbers = [<span class="number">65</span>, <span class="number">20</span>, <span class="number">11</span>, <span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> arr = numbers.<span class="title function_">map</span>(<span class="keyword">function</span> (<span class="params">value, index, arr</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> value * <span class="number">2</span>;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(numbers);   <span class="comment">// [65, 20, 11, 5]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr);       <span class="comment">// [130, 40, 22, 10]</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p><strong>作用</strong></p><p>some()方法用于检测数组所有元素是否满足指定条件（通过函数提供）。</p><ul><li>如果有一个元素满足条件，则表达式返回true，剩余的元素不会再执行检测。</li><li>如果没有满足条件的元素，则返回false。</li></ul><p>注意：some()不会对空数组进行检测。<br>注意：some()不会改变原始数组。</p><p><strong>语法</strong></p><blockquote><p>Array.prototype.some(callbackFn[, thisArg])</p></blockquote><p>参数：</p><ul><li>callbackFn：函数（必需），数组中的每个元素都会执行这个函数。<ul><li>currentValue: 必需，数组中正在处理的当前元素。</li><li>index: 可选。数组中正在处理的当前元素的索引值。</li><li>array: 可选。正在操作的数组对象。</li></ul></li><li>thisValue：可选。对象作为该执行回调时使用，传递给函数。</li></ul><p>返回值：</p><ul><li>布尔值（true&#x2F;false）</li></ul><p><strong>说明</strong></p><p>有一个返回true，则整个some()返回值为true，并且不会执行后续其他项的回调函数。<br>空数组的some()直接返回false。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ages = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">24</span>, <span class="number">32</span>, <span class="number">40</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> result = ages.<span class="title function_">some</span>(<span class="keyword">function</span> (<span class="params">value, index, arr</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> value &gt; <span class="number">25</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result);    <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">ages = [];</span><br><span class="line">result = ages.<span class="title function_">some</span>(<span class="keyword">function</span> (<span class="params">value, index, arr</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> value &gt; <span class="number">25</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result);    <span class="comment">// false</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-6"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">reduce</button></li><li class="tab"><button type="button" data-href="#super-2">reduceRight</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><strong>作用</strong><br>接收一个callbackFn函数作为累加器，数组中的每个值（从左到右）开始缩减，最终计算为一个值。</p><p>注意：reduce()对于空数组是不会执行回调函数的。</p><p><strong>语法</strong><br>Array.prototype.reduce(callbackFn[, initialValue])<br>参数：</p><ul><li>callbackFn：函数（必需），数组中的每个元素都会执行这个函数。<ul><li>accumulator：累加器累加回调的返回值</li><li>currentValue：数组中正在处理的当前元素</li><li>index：数组中正在处理的当前元素的索引</li><li>array：正在操作的数组<br>initialValue：可选。传递给函数的初始值。</li></ul></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> numbers = [<span class="number">15</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">7</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> total = numbers.<span class="title function_">reduce</span>(<span class="keyword">function</span> (<span class="params">total, currentValue</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(total);             <span class="comment">// 15 17 18 25</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(currentValue);      <span class="comment">// 2  1  7</span></span><br><span class="line">    <span class="keyword">return</span> total + currentValue;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(total);                 <span class="comment">// 25</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(numbers);               <span class="comment">// [15, 2, 1, 7]</span></span><br><span class="line"></span><br><span class="line">total = numbers.<span class="title function_">reduce</span>(<span class="keyword">function</span> (<span class="params">total, currentValue</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(total);             <span class="comment">// 20 35 37 38 45</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(currentValue);      <span class="comment">// 15 2  1  7</span></span><br><span class="line">    <span class="keyword">return</span> total + currentValue;</span><br><span class="line">&#125;, <span class="number">20</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(total);                 <span class="comment">// 45</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(numbers);               <span class="comment">// [15, 2, 1, 7]</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><strong>作用</strong><br>reduceRight()方法的功能和reduce()功能是一样的，不同的是reduceRight()从数组的末尾向前将数组中的数组项做累加。</p><p>注意：reduceRight()对于空数组是不会执行回调函数的。</p><p><strong>语法</strong></p><blockquote><p>arrayObject.reduceRight(function (total, currentValue, currentIndex, arr) {}, initialValue)</p></blockquote><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>function (total, currentValue, currentIndex, arr)</td><td>必需。函数，数组中的每个元素都会执行这个函数。<code>total: 必需。初始值，或者计算结束后的返回值。</code>currentValue: 必需。当前元素。<code>currentIndex: 可选。当前元素的索引。</code>arr: 可选。当前元素所属的数组对象。</td></tr><tr><td>initialValue</td><td>可选。传递给函数的初始值。&#96;&#96;</td></tr></tbody></table><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> numbers = [<span class="number">15</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">7</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> total = numbers.<span class="title function_">reduceRight</span>(<span class="keyword">function</span> (<span class="params">total, currentValue</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(total);             <span class="comment">// 7 8 10 25</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(currentValue);      <span class="comment">// 1 2 15</span></span><br><span class="line">    <span class="keyword">return</span> total + currentValue;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(total);                 <span class="comment">// 25</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(numbers);               <span class="comment">// [15, 2, 1, 7]</span></span><br><span class="line"></span><br><span class="line">total = numbers.<span class="title function_">reduceRight</span>(<span class="keyword">function</span> (<span class="params">total, currentValue</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(total);             <span class="comment">// 20 27 28 30 45</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(currentValue);      <span class="comment">// 7  1  2  15</span></span><br><span class="line">    <span class="keyword">return</span> total + currentValue;</span><br><span class="line">&#125;, <span class="number">20</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(total);                 <span class="comment">// 45</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(numbers);               <span class="comment">// [15, 2, 1, 7]</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="手动实现-Array-prototype-map-方法"><a href="#手动实现-Array-prototype-map-方法" class="headerlink" title="手动实现 Array.prototype.map 方法"></a>手动实现 Array.prototype.map 方法</h2><p>map() 方法创建一个新数组，其结果是该数组中的每个元素都调用一个提供的函数后返回的结果。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">map</span>(<span class="params">arr, mapCallback</span>) &#123;</span><br><span class="line">  <span class="comment">// 首先，检查传递的参数是否正确。</span></span><br><span class="line">  <span class="keyword">if</span> (!<span class="title class_">Array</span>.<span class="title function_">isArray</span>(arr) || !arr.<span class="property">length</span> || <span class="keyword">typeof</span> mapCallback !== <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> [];</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> result = [];</span><br><span class="line">    <span class="comment">// 每次调用此函数时，我们都会创建一个 result 数组</span></span><br><span class="line">    <span class="comment">// 因为我们不想改变原始数组。</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, len = arr.<span class="property">length</span>; i &lt; len; i++) &#123;</span><br><span class="line">      result.<span class="title function_">push</span>(<span class="title function_">mapCallback</span>(arr[i], i, arr));</span><br><span class="line">      <span class="comment">// 将 mapCallback 返回的结果 push 到 result 数组中</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="手动实现-Array-prototype-filter-方法"><a href="#手动实现-Array-prototype-filter-方法" class="headerlink" title="手动实现 Array.prototype.filter 方法"></a>手动实现 Array.prototype.filter 方法</h2><p>**filter()**方法创建一个新数组, 其包含通过所提供函数实现的测试的所有元素。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">filter</span>(<span class="params">arr, filterCallback</span>) &#123;</span><br><span class="line">  <span class="comment">// 首先，检查传递的参数是否正确。</span></span><br><span class="line">  <span class="keyword">if</span> (!<span class="title class_">Array</span>.<span class="title function_">isArray</span>(arr) || !arr.<span class="property">length</span> || <span class="keyword">typeof</span> filterCallback !== <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> [];</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> result = [];</span><br><span class="line">    <span class="comment">// 每次调用此函数时，我们都会创建一个 result 数组</span></span><br><span class="line">    <span class="comment">// 因为我们不想改变原始数组。</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, len = arr.<span class="property">length</span>; i &lt; len; i++) &#123;</span><br><span class="line">      <span class="comment">// 检查 filterCallback 的返回值是否是真值</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="title function_">filterCallback</span>(arr[i], i, arr)) &#123;</span><br><span class="line">        <span class="comment">// 如果条件为真，则将数组元素 push 到 result 中</span></span><br><span class="line">        result.<span class="title function_">push</span>(arr[i]);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result; <span class="comment">// return the result array</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="手动实现-Array-prototype-reduce-方法"><a href="#手动实现-Array-prototype-reduce-方法" class="headerlink" title="手动实现 Array.prototype.reduce 方法"></a>手动实现 Array.prototype.reduce 方法</h2><p><a href="https://link.juejin.cn/?target=">reduce()</a> 方法对数组中的每个元素执行一个由您提供的reducer函数(升序执行)，将其结果汇总为单个返回值。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">reduce</span>(<span class="params">arr, reduceCallback, initialValue</span>) &#123;</span><br><span class="line">  <span class="comment">// 首先，检查传递的参数是否正确。</span></span><br><span class="line">  <span class="keyword">if</span> (!<span class="title class_">Array</span>.<span class="title function_">isArray</span>(arr) || !arr.<span class="property">length</span> || <span class="keyword">typeof</span> reduceCallback !== <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> [];</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 如果没有将initialValue传递给该函数，我们将使用第一个数组项作为initialValue</span></span><br><span class="line">    <span class="keyword">let</span> hasInitialValue = initialValue !== <span class="literal">undefined</span>;</span><br><span class="line">    <span class="keyword">let</span> value = hasInitialValue ? initialValue : arr[<span class="number">0</span>];</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// 如果有传递 initialValue，则索引从 1 开始，否则从 0 开始</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = hasInitialValue ? <span class="number">1</span> : <span class="number">0</span>, len = arr.<span class="property">length</span>; i &lt; len; i++) &#123;</span><br><span class="line">      value = <span class="title function_">reduceCallback</span>(value, arr[i], i, arr);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> value;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> ECMAScript基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数组 </tag>
            
            <tag> Array </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据类型</title>
      <link href="/posts/ba595a63/"/>
      <url>/posts/ba595a63/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="数据类型介绍及数值的存储方式"><a href="#数据类型介绍及数值的存储方式" class="headerlink" title="数据类型介绍及数值的存储方式"></a>数据类型介绍及数值的存储方式</h3><p>JavaScript共有8种数据类型</p><ul><li>7种基本数据类型——Undefined、Null、Boolean、Number、String、Symbol（es6新增，表示独一无二的值）、BigInt（es10新增）<ul><li>直接存储在 <strong>栈</strong>（stack）中，占据空间小、大小固定，属于频繁被使用数据，所以放入栈中存储。</li></ul></li><li>1种引用（对象）数据类型——Object（本质上，由一组无序的名值对组成），其中包含 function、Array、Date等。<ul><li>同时存储在 <strong>栈</strong>（stack）和 <strong>堆</strong>（heap）中，占据空间大、大小不固定。</li><li>在 <strong>栈</strong> 中存储了指针，该指针指向 <strong>堆</strong> 中该实体的起始地址。当解释器寻找引用值时，会首先检索其在 <strong>栈</strong> 中的地址，取得地址后从 <strong>堆</strong> 中获得实体。</li></ul></li><li>JavaScript不支持创建自定义类型数据</li></ul><h3 id="undefined与undeclared的区别"><a href="#undefined与undeclared的区别" class="headerlink" title="undefined与undeclared的区别"></a>undefined与undeclared的区别</h3><p>undefined：已在作用域中声明但还没有赋值的变量。</p><p>undeclared：还没有在作用域中声明过的变量。</p><blockquote><p>对于undeclared变量的引用，浏览器会报引用错误。但是可以使用typeof的安全防范机制来避免报错，因为对于 undeclared（或者not defined）变量，typeof会返回”undefined”。</p></blockquote><h3 id="undefined和null的区别"><a href="#undefined和null的区别" class="headerlink" title="undefined和null的区别"></a>undefined和null的区别</h3><p>Undefined和Null都是基本数据类型.</p><blockquote><p>undefined代表定义未赋值</p><p>null代表空对象（不是真的对象）</p></blockquote><p>一般变量声明了但还没有定义的时候会返回undefined。</p><p>null主要用于</p><ul><li>初始赋值，赋值给一些可能会返回对象的变量</li><li>结束前，让此变量成为垃圾对象（被垃圾回收器回收）</li></ul><blockquote><p>其实 <strong>null</strong> 不是对象，虽然 <strong>typeof null</strong> 会输出object，但是这只是JS存在的一个悠久Bug。在JS的最初版本中使用的是32位系统，为了性能考虑使用低位存储变量的类型信息，000开头代表是对象，然而null表示为全零，所以将它错误的判断为object。虽然现在的内部类型判断代码已经改变了，但是对于这个Bug却是一直流传下来。</p></blockquote><h3 id="字符串转义字符"><a href="#字符串转义字符" class="headerlink" title="字符串转义字符"></a>字符串转义字符</h3><p>转义符皆以“\”开头的，常用转义如下：</p><table><thead><tr><th>转义符</th><th>说明</th></tr></thead><tbody><tr><td><code>\n</code></td><td>换行符</td></tr><tr><td><code>\</code></td><td>斜杠\</td></tr><tr><td><code>&#39;</code></td><td>‘’ 单引号</td></tr><tr><td><code>*</code></td><td>“” 双引号</td></tr><tr><td><code>\t</code></td><td>tab缩进</td></tr><tr><td><code>\b</code></td><td>空格，b是blank的意思</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> ECMAScript基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据类型 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>对象</title>
      <link href="/posts/9eb8af5a/"/>
      <url>/posts/9eb8af5a/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="基础创建方式"><a href="#基础创建方式" class="headerlink" title="基础创建方式"></a>基础创建方式</h3><ul><li><strong>字面量</strong> 创建对象</li><li><strong>new Object()</strong> 创建对象<div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">对象字面量——创建对象</button></li><li class="tab"><button type="button" data-href="#super-2">new Object()——创建对象</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><strong>花括号{}</strong> ：包含表达这个具体事物（对象）的<strong>属性和方法</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;王权&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">    <span class="attr">sayHi</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;999&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>对象：</p><ul><li>里面的属性或方法采取<strong>键值对</strong>的形式</li><li>多个属性或方法中间用逗号隔开</li><li>方法冒号后面跟的是一个<strong>匿名函数</strong></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// new Object 创建一个对象</span></span><br><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> <span class="title class_">Object</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加属性</span></span><br><span class="line">obj.<span class="property">name</span> = jay;</span><br><span class="line">obj.<span class="property">age</span> = <span class="number">18</span>;</span><br><span class="line">obj.<span class="property">sayHi</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">999</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意：</p><ul><li>利用 &#x3D; 等号赋值的方法，给对象添加属性和方法</li><li>每个属性和方法之间用分号结束</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div></li></ul><h2 id="进阶创建方式"><a href="#进阶创建方式" class="headerlink" title="进阶创建方式"></a>进阶创建方式</h2><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">工厂模式</button></li><li class="tab"><button type="button" data-href="#super-2">构造函数</button></li><li class="tab"><button type="button" data-href="#super-3">原型模式</button></li><li class="tab"><button type="button" data-href="#super-4">组合使用构造函数模式和原型模式</button></li><li class="tab"><button type="button" data-href="#super-5">动态原型模式</button></li><li class="tab"><button type="button" data-href="#super-6">寄生构造函数模式</button></li><li class="tab"><button type="button" data-href="#super-7">稳妥构造函数模式</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>工作原理：用函数来封装new Object()创建对象的细节。<br>优点：解决创建多个相似对象时的代码复用问题<br>缺点：无法解决对象识别的问题（就是怎样知道一个对象的类型是什么）</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">createPerson</span>(<span class="params">name, age, job</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> o = <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line">    o.<span class="property">name</span> = name;</span><br><span class="line">    o.<span class="property">age</span> = age;</span><br><span class="line">    o.<span class="property">job</span> = job;</span><br><span class="line">    o.<span class="property">sayName</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">name</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> o;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person1 = <span class="title function_">createPerson</span>(<span class="string">&quot;james&quot;</span>, <span class="number">9</span>, <span class="string">&quot;student&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> person2 = <span class="title function_">createPerson</span>(<span class="string">&quot;kobe&quot;</span>, <span class="number">9</span>, <span class="string">&quot;student&quot;</span>);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>工作原理：应用函数的方式，把对象里面一些相同的属性和方法抽象出来封装到函数里。<br>优点：解决工厂模式中对象类型无法识别的问题，并且创建自定义的构造函数意味着将来可以将它的实例标识为一种特定的类型。<br>缺点：每创建定义一个对象，就会创建一个实例，造成内存浪费。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 构造函数语法格式</span></span><br><span class="line"><span class="keyword">function</span> 构造函数名() &#123;</span><br><span class="line">    <span class="variable language_">this</span>.属性 = 值;</span><br><span class="line">    <span class="variable language_">this</span>.方法 = <span class="keyword">function</span>(<span class="params"></span>) &#123;&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 使用构造函数</span></span><br><span class="line"><span class="keyword">new</span> 构造函数名();</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 构造函数的示例</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Star</span>(<span class="params">name, age, sex</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">sex</span> = sex;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">sing</span> = <span class="keyword">function</span>(<span class="params">sang</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(sang);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> ldh =  <span class="keyword">new</span> <span class="title class_">Star</span>(<span class="string">&#x27;刘德华&#x27;</span>, <span class="number">18</span>, <span class="string">&#x27;男&#x27;</span>); <span class="comment">// 调用函数返回的是一个对象</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> ldh); <span class="comment">// Object</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ldh.<span class="property">name</span>); <span class="comment">// 刘德华</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ldh[<span class="string">&#x27;age&#x27;</span>]);<span class="comment">// 18</span></span><br><span class="line">ldh.<span class="title function_">sing</span>(<span class="string">&#x27;冰雨&#x27;</span>); <span class="comment">// 调用构造函数里面的方法，并传值</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果需要创建多个对象，只需要调用构造函数即可创建</span></span><br><span class="line"><span class="keyword">var</span> zxy = <span class="keyword">new</span> <span class="title class_">Star</span>(<span class="string">&#x27;张学友&#x27;</span>, <span class="number">18</span> , <span class="string">&#x27;男&#x27;</span>);</span><br></pre></td></tr></table></figure><p>注意：</p><ul><li>构造函数首字母要大写</li><li>构造函数不需要return，就可以返回结果</li><li>调用构造函数 ，必须使用new</li><li>构造函数里面的属性和方法必须添加this</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>每个函数都有一个 prototype（原型）属性，这个属性指向函数的原型对象，这个对象的用途是包含可以由特定类型的<strong>所有实例共享的属性和方法</strong>。<br>通过使用原型对象来添加公用属性和方法，从而实现代码的复用。</p><blockquote><p>换句话说：不必在构造函数中定义对象实例的信息，可以在函数外部将这些信息直接添加到原型对象中。<br>优点：解决了构造函数模式中多次创建相同函数对象的问题，所有的实例可以共享同一组属性和函数。<br>缺点：传址类型字段存在问题；</p></blockquote><ol><li>首先第一个问题是原型模式省略了构造函数模式传递初始化参数的过程，所有的实例在默认情况下都会取得默认的属性值，会在一定程度上造成不方便。</li><li>因为所有的实例都是共享一组属性，对于包含基本值的属性来说没有问题，但是对于包含引用类型的值来说（例如数组对象），所有的实例都是对同一个引用类型进行操作，那么属性的操作就不是独立的，最后导致读写的混乱。我们创建的实例一般都是要有属于自己的全部属性的，因此单独使用原型模式的情况是很少存在的。</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">name</span> = <span class="string">&quot;james&quot;</span>;</span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">age</span> = <span class="number">9</span>;</span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">job</span> = <span class="string">&quot;student&quot;</span>;</span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayName</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">name</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">person1.<span class="title function_">sayName</span>(); <span class="comment">// &quot;james&quot;</span></span><br><span class="line"><span class="keyword">var</span> person2 = <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">person2.<span class="title function_">sayName</span>(); <span class="comment">// &quot;james&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person1.<span class="property">sayName</span> === person2.<span class="property">sayName</span>) <span class="comment">// true</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>创建自定义类型的最常见方式。</p><blockquote><p>通过构造函数来初始化实例的属性<br>通过原型对象来定义方法和共享的属性</p></blockquote><p>优点：每个实例都会有自己的一份实例属性的副本，又同时共享着对象的引用，最大限度的节省了内存，还实现了向构造函数传递初始化参数。<br>缺点：由于使用了两种模式，因此对于代码的封装性来说不是很好。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name, age, job</span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">job</span> = job;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span> = &#123;</span><br><span class="line">    <span class="attr">constructor</span>: <span class="title class_">Person</span>,</span><br><span class="line">    <span class="attr">sayName</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">name</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> <span class="title function_">createPerson</span>(<span class="string">&quot;james&quot;</span>，<span class="number">9</span>，<span class="string">&quot;student&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person2 = <span class="keyword">new</span> <span class="title function_">createPerson</span>(<span class="string">&quot;kobe&quot;</span>，<span class="number">9</span>，<span class="string">&quot;student&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person1.<span class="property">name</span>); <span class="comment">// &quot;james&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person2.<span class="property">name</span>); <span class="comment">// &quot;kobe&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person1.<span class="property">sayName</span> === person2.<span class="property">sayName</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p>这一种模式将原型方法赋值的创建过程移动到了构造函数的内部，通过对属性是否存在的判断，可以实现仅在第一次调用函数时对原型对象赋值一次的效果。这一种方式很好地对上面的混合模式进行了封装。</p><p>优点：解决了混成模式中封装性的问题</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name, age, job</span>)&#123;</span><br><span class="line">    <span class="comment">// 属性</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">job</span> = job;</span><br><span class="line">    <span class="comment">// 方法</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="variable language_">this</span>.<span class="property">sayName</span> !== <span class="string">&quot;function&quot;</span> )&#123;</span><br><span class="line"></span><br><span class="line">        <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayName</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">name</span>);</span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> <span class="title function_">createPerson</span>(<span class="string">&quot;james&quot;</span>，<span class="number">9</span>，<span class="string">&quot;student&quot;</span>);</span><br><span class="line"></span><br><span class="line">person1.<span class="title function_">sayName</span>(); <span class="comment">// &quot;james&quot;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-6"><p>基本思想：创建一个函数，该函数的作用仅仅是封装创建对象的代码，然后返回新创建的对象。<br>优点：基于一个已有的类型，在实例化时对实例化的对象进行扩展。这样既不用修改原来的构造函数，也达到了扩展对象的目的。<br>缺点：和工厂模式一样的问题，不能依赖 instanceof 操作符来确定对象的类型。<br>如下面的例子所示：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name, age, job</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> o = <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line">    o.<span class="property">name</span> = name;</span><br><span class="line">    o.<span class="property">age</span> = age;</span><br><span class="line">    o.<span class="property">job</span> = job;</span><br><span class="line">    o.<span class="property">sayName</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">name</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> o;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;james&quot;</span>，<span class="number">9</span>，<span class="string">&quot;student&quot;</span>);</span><br></pre></td></tr></table></figure><p>通过上面的例子我们可以发现，其实这个模式和工厂模式基本上是一摸一样的，只不过我们是采用 new 操作符最后来创建对象。<br>注意在构造函数不返回值的情况下，默认会返回新创建的对象，而通过在构造函数的末尾添加一个 return 语句，可以重写调用构造函数时返回的值。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-7"><p>Douglas Crockford 发明了 JavaScript 中的稳妥对象这个概念。所谓稳妥对象，指的就是，没有公共属性，而且其方法也不使用 this 的对象。稳妥对象最适合在一些安全的环境中（这些环境中会禁止使用 this 和 new），或者在防止数据被其他应用程序改动时使用。</p><p>稳妥构造函数遵循与寄生构造函数类似的模式，但有两点不同：一是新创建的对象的实例方法不引用 this ；二是不使用 new 操作符调用构造函数。<br>优点：以上面为例，除了 sayName 方法外，没有别的方法可以访问数据成员，这就是稳妥构造函数提供的安全性。<br>缺点：和寄生构造函数一样，没有办法使用 instanceof 操作符来判断对象的类型<br>因此我们可以将前面的例子改写如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name, age, job</span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建要返回的对象</span></span><br><span class="line">    <span class="keyword">var</span> o = <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//可以在这里定义私有变量和函数</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//添加方法</span></span><br><span class="line">    o.<span class="property">sayName</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//返回对象</span></span><br><span class="line">    <span class="keyword">return</span> o;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person1 =  <span class="title class_">Person</span>(<span class="string">&quot;james&quot;</span>，<span class="number">9</span>，<span class="string">&quot;student&quot;</span>);</span><br><span class="line"></span><br><span class="line">person1.<span class="title function_">sayName</span>(); <span class="comment">// &quot;james&quot;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="对象的使用方式"><a href="#对象的使用方式" class="headerlink" title="对象的使用方式"></a>对象的使用方式</h2><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">创建对象</button></li><li class="tab"><button type="button" data-href="#super-2">属性定义</button></li><li class="tab"><button type="button" data-href="#super-3">访问属性/方法</button></li><li class="tab"><button type="button" data-href="#super-4">属性删除</button></li><li class="tab"><button type="button" data-href="#super-5">属性检测</button></li><li class="tab"><button type="button" data-href="#super-6">属性复制</button></li><li class="tab"><button type="button" data-href="#super-7">遍历对象</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><code>Object.create(新创建对象的原型对象, 添加到新创建对象的属性)</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>, &#123;</span><br><span class="line">    <span class="string">&#x27;glass&#x27;</span>: &#123;</span><br><span class="line">        <span class="attr">value</span>: <span class="string">&#x27;RayBan&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&#x27;clockIn&#x27;</span>: &#123;</span><br><span class="line">        <span class="attr">value</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;<span class="title function_">alert</span>(<span class="string">&#x27;at 9:30 am&#x27;</span>);&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="string">&#x27;clockOut&#x27;</span>: &#123;</span><br><span class="line">        <span class="attr">value</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;<span class="title function_">alert</span>(<span class="string">&#x27;at 9:30 pm&#x27;</span>);&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">Object.defineProperty(对象, 属性名, 属性描述符)</button></li><li class="tab"><button type="button" data-href="#super-2">Object.defineProperties(对象, 属性表述对象)</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(programmer, <span class="string">&#x27;shoes&#x27;</span>, &#123;</span><br><span class="line">    set.<span class="property">function</span> (value) &#123;</span><br><span class="line">        <span class="keyword">switch</span>() &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;nike&#x27;</span>: </span><br><span class="line">                <span class="title function_">alert</span>(<span class="string">&#x27;223&#x27;</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;vans&#x27;</span>:</span><br><span class="line">                <span class="title function_">alert</span>(<span class="string">&#x27;332&#x27;</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="attr">default</span>:</span><br><span class="line">                brea;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用方法</span></span><br><span class="line">programmer.<span class="property">shoes</span> = <span class="string">&#x27;nike&#x27;</span> <span class="comment">// &#x27;233&#x27;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">属性描述符</th><th align="center">数据描述符</th><th align="center">存取描述符</th><th>描述</th></tr></thead><tbody><tr><td align="center">configurable</td><td align="center">Yes</td><td align="center">Yes</td><td>当且仅当configurable为true 时，该属性才能够被改变，同时该属性也能从对应的对象上被删除，默认为 false。</td></tr><tr><td align="center">enumerable</td><td align="center">Yes</td><td align="center">Yes</td><td>当且仅当enumerable为true时，该属性才能够被枚举，默认为false。</td></tr><tr><td align="center">value</td><td align="center">Yes</td><td align="center">No</td><td>value 该属性对应的值，默认为undefined。</td></tr><tr><td align="center">writable</td><td align="center">Yes</td><td align="center">No</td><td>当且仅当writable为true时，value才能被赋值运算符改变，默认为false</td></tr><tr><td align="center">get</td><td align="center">No</td><td align="center">Yes</td><td>给属性提供getter的方法，如果没有getter则为undefined。该方法返回值被用作属性值，默认为undefined</td></tr><tr><td align="center">set</td><td align="center">No</td><td align="center">Yes</td><td>给属性提供setter的方法，如果没有setter则为undefined。该方法将接受唯一参数，并将该参数的新值分配给该属性，默认为undefined</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">使用 . 来访问</button></li><li class="tab"><button type="button" data-href="#super-2">使用 [] 来访问</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><ul><li>调用对象的方属性：<strong>对象.属性名</strong><blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 调用对象obj里面的name属性</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">name</span>)</span><br></pre></td></tr></table></figure></blockquote></li><li>调用对象的方法：<strong>对象名.方法名()</strong><blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">obj.<span class="title function_">seyHi</span>()</span><br></pre></td></tr></table></figure></blockquote></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><strong>对象名[‘属性名’]</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj[<span class="string">&#x27;name&#x27;</span>])</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>删除对象的属性可以使用delete关键字，格式如下：</p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> 对象.属性名</span><br></pre></td></tr></table></figure><p>案例演示：</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var person <span class="operator">=</span> new Object()<span class="comment">;</span></span><br><span class="line">person.name <span class="operator">=</span> <span class="string">&quot;孙悟空&quot;</span><span class="comment">;</span></span><br><span class="line">person.age <span class="operator">=</span> <span class="number">18</span><span class="comment">;</span></span><br><span class="line">console.log(person)<span class="comment">;</span></span><br><span class="line">delete person.name</span><br><span class="line">console.log(person)<span class="comment">;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">in运算符</button></li><li class="tab"><button type="button" data-href="#super-2">hasOwnProperty()</button></li><li class="tab"><button type="button" data-href="#super-3">propertyIsEnumberable</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>检测对象的自有或继承属性</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>检测对象的自有属性</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>检测自有且可枚举的属性</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-6"><p><code>Object.assign(目标对象, ...源对象)</code></p><ul><li>将所有可枚举属性的值从一个或多个源对象复制到目标对象，然后将返回目标对象</li><li>如果目标对象中的属性具有相同的键，则属性将被源中的属性覆盖。后来的源的属性将类似的覆盖早先的属性。</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-7"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">for-in语句</button></li><li class="tab"><button type="button" data-href="#super-2">Object.keys(obj)</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>枚举遍历对象中的属性，可以使用for … in语句循环，对象中有几个属性，循环体就会执行几次。</p><p>语法格式：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> 变量 <span class="keyword">in</span> 对象) &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>案例演示：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;zhangsan&quot;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">18</span></span><br><span class="line">&#125;<span class="keyword">for</span> (<span class="keyword">var</span> personKey <span class="keyword">in</span> person) &#123;</span><br><span class="line">    <span class="keyword">var</span> personVal = person[personKey];</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(personKey + <span class="string">&quot;:&quot;</span> + personVal);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 面对对象 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>执行上下文this指向</title>
      <link href="/posts/5d04ce7e/"/>
      <url>/posts/5d04ce7e/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>this——当函数被调用时，与函数上下文绑定，指向某个对象的引用。</p><h2 id="this指向"><a href="#this指向" class="headerlink" title="this指向"></a>this指向</h2><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">普通函数中的 this</button></li><li class="tab"><button type="button" data-href="#super-2">匿名函数中的 this</button></li><li class="tab"><button type="button" data-href="#super-3">箭头函数中的 this</button></li><li class="tab"><button type="button" data-href="#super-4">构造函数中的 this</button></li><li class="tab"><button type="button" data-href="#super-5">事件中的this</button></li><li class="tab"><button type="button" data-href="#super-6">作为对象时的 this</button></li><li class="tab"><button type="button" data-href="#super-7">call、apply、bind指定函数的this指向</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>默认绑定</p><ul><li>普通函数在非严格的全局环境下调用时，其中的 this 指向的是 window。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">f1</span> () &#123;</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">f1</span>() <span class="comment">// window</span></span><br></pre></td></tr></table></figure><ul><li>用了严格模式 “use strict”，严格模式下无法再意外创建全局变量，所以 this 不为 window 而为 undefined。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&quot;use strict&quot;</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">f1</span> () &#123;</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">f1</span>() <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure><blockquote><p>注意：babel 转成 ES6 的，babel 会自动给 js 文件上加上严格模式。</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><strong>匿名函数的 this 永远指向 window</strong> 。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Animal</span> = &#123;</span><br><span class="line">    <span class="attr">getName</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Animal</span>.<span class="title function_">getName</span>() <span class="comment">// window</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>在箭头函数中，this 的指向是由外层(函数或全局)作用域来决定的。</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">箭头函数中的 this</button></li><li class="tab"><button type="button" data-href="#super-2">箭头函数的 this 绑定无法修改</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>如果要让 this 指向 Animal 这个对象，则可以巧用箭头函数来解决。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Animal</span> = &#123;</span><br><span class="line">    <span class="attr">getName</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Animal</span>.<span class="title function_">getName</span>() <span class="comment">// &#123; getName: [Function: getName] &#125;</span></span><br></pre></td></tr></table></figure><p>严格模式对箭头函数没有效果。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">f1</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">f1</span>() <span class="comment">// window</span></span><br></pre></td></tr></table></figure><p>箭头函数体内的 this 对象  &#x3D;&#x3D;&gt;  定义时所在的对象，而不是使用时所在的对象。<br>普通函数使用了严格模式 this 会指向 undefined，但箭头函数依然指向了 window。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Fn</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">txt</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">txt</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj1 = &#123;</span><br><span class="line">    <span class="attr">txt</span>: <span class="string">&#x27;coboy&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> obj2 = &#123;</span><br><span class="line">    <span class="attr">txt</span>: <span class="string">&#x27;cobyte&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> f = <span class="title class_">Fn</span>.<span class="title function_">call</span>(obj1)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(f.<span class="title function_">call</span>(obj2)) <span class="comment">// &#x27;coboy&#x27;</span></span><br></pre></td></tr></table></figure><p>由于 Fn 中的 this 绑定到了 obj1 上，所以 f 中的 this 也会绑定到 obj1 上， 箭头函数的绑定无法被修改。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> txt = <span class="string">&#x27;意外不&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Fn</span> = (<span class="params"></span>) =&gt; <span class="function"><span class="params">txt</span> =&gt;</span> &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">txt</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj1 = &#123;</span><br><span class="line">    <span class="attr">txt</span>: <span class="string">&#x27;coboy&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> obj2 = &#123;</span><br><span class="line">    <span class="attr">txt</span>: <span class="string">&#x27;cobyte&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> f = <span class="title class_">Fn</span>.<span class="title function_">call</span>(obj1)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(f.<span class="title function_">call</span>(obj2)) <span class="comment">// &#x27;意外不&#x27;</span></span><br></pre></td></tr></table></figure><p>如果将 var 声明方式改成 const 或 let 则最后输出为 undefined，原因是使用 const 或 let 声明的变量不会挂载到 window 全局对象上。因此，this 指向 window 时，自然也找不到 txt 变量了。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">super 1</button></li><li class="tab"><button type="button" data-href="#super-2">super 2</button></li><li class="tab"><button type="button" data-href="#super-3">super 3</button></li><li class="tab"><button type="button" data-href="#super-4">super 4</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>通过 new 操作符来构建一个构造函数的实例对象，这个构造函数中的 this 就指向这个新的实例对象。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Animal</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>) <span class="comment">// Animal &#123;&#125;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> a1 = <span class="keyword">new</span> <span class="title class_">Animal</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a1) <span class="comment">// Animal &#123;&#125;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>同时构造函数 prototype 属性下面方法中的 this 也指向这个新的实例对象。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Animal</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">txt</span> = <span class="string">&#x27;coboy&#x27;</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">age</span> = <span class="number">100</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Animal</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getNum</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">txt</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> a1 = <span class="keyword">new</span> <span class="title class_">Animal</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a1.<span class="property">age</span>) <span class="comment">// 100</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a1.<span class="title function_">getNum</span>()) <span class="comment">// &#x27;coboy&#x27;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>在构造函数中出现显式 return 的情况。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Animal</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">txt</span> = <span class="string">&#x27;coboy&#x27;</span></span><br><span class="line">    <span class="keyword">const</span> obj = &#123;<span class="attr">txt</span>: <span class="string">&#x27;cobyte&#x27;</span>&#125;</span><br><span class="line">    <span class="keyword">return</span> obj</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> a1 = <span class="keyword">new</span> <span class="title class_">Animal</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a1.<span class="property">txt</span>) <span class="comment">// cobyte</span></span><br></pre></td></tr></table></figure><p>此时 a1 返回的是空对象 obj。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Animal</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">txt</span> = <span class="string">&#x27;coboy&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> a1 = <span class="keyword">new</span> <span class="title class_">Animal</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a1.<span class="property">txt</span>) <span class="comment">// &#x27;coboy&#x27;</span></span><br></pre></td></tr></table></figure><p>由此可以看出，如果构造函数中显式返回一个值，且返回的是一个对象，那么 this 就指向返回的对象，如果返回的不是一个对象，而是基本类型，那么 this 仍然指向实例。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p><code>addEventListener()</code>事件处理程序会在其所属元素的作用域内运行，但当用了箭头函数则会导致里面的this指向改变。因此不建议在创建事件的时候搭配箭头函数使用</p><p>还需注意：另一种添加事件的方法 <code>attachEvent</code>IE事件处理程序会在全局作用域中运行,因此this &#x3D; window。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">p2.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)     <span class="comment">//p2元素</span></span><br><span class="line">&#125;)</span><br><span class="line">p2.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="params">event</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)    <span class="comment">//window</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-6"><p>隐式绑定</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">super 1</button></li><li class="tab"><button type="button" data-href="#super-2">super 2</button></li><li class="tab"><button type="button" data-href="#super-3">super 3</button></li><li class="tab"><button type="button" data-href="#super-4">super 4</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;coboy&quot;</span>, </span><br><span class="line">    <span class="attr">age</span>: <span class="number">18</span>, </span><br><span class="line">    <span class="attr">add</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>, <span class="variable language_">this</span>.<span class="property">name</span>, <span class="variable language_">this</span>.<span class="property">age</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">obj.<span class="title function_">add</span>(); </span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">    &#123;name: &quot;coboy&quot;, age: 18, add: ƒ&#125; </span></span><br><span class="line"><span class="comment">    &quot;coboy&quot;</span></span><br><span class="line"><span class="comment">    18</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p>在对象方法中，作为对象的一个方法被调用时，this 指向调用它所在方法的对象。也就是开头我们所说的那句：“ <strong>谁调用了它，它就指向谁</strong> ”，在这里很明显是 obj 调用了它。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;coboy&quot;</span>, </span><br><span class="line">    <span class="attr">age</span>: <span class="number">18</span>, </span><br><span class="line">    <span class="attr">add</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>, <span class="variable language_">this</span>.<span class="property">name</span>, <span class="variable language_">this</span>.<span class="property">age</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> fn = obj.<span class="property">add</span></span><br><span class="line"><span class="title function_">fn</span>() <span class="comment">// window</span></span><br></pre></td></tr></table></figure><p>这个时候 this 则仍然指向 window。obj 对象方法 add 赋值给 fn 之后，fn 仍然在 window 的全局环境中执行，所以 this 仍然指向 window。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;coboy&quot;</span>, </span><br><span class="line">    <span class="attr">age</span>: <span class="number">18</span>, </span><br><span class="line">    <span class="attr">add</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">fn</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">obj.<span class="title function_">add</span>() <span class="comment">// window</span></span><br></pre></td></tr></table></figure><p>如果在对象方法内部声明一个函数，这个函数的 this 在对象方法执行的时候指向就不是这个对象了，而是指向 window 了。这里为什么会指向 window 呢？上述代码中声明了一个 fn 函数，接着又马上执行了它，其实可以看做是一个匿名的自执行函数，代码可以变成如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;coboy&quot;</span>, </span><br><span class="line">    <span class="attr">age</span>: <span class="number">18</span>, </span><br><span class="line">    <span class="attr">add</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        (<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)</span><br><span class="line">        &#125;)()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">obj.<span class="title function_">add</span>() <span class="comment">// window</span></span><br></pre></td></tr></table></figure><p>我们再回溯一下本文开头说到的那句经典的话：“ <strong>匿名函数的 this 永远指向 window</strong> ”，所以为什么指向 window，是不是很清楚了呢。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>obj2.getName() 如果要它输出‘coboy2’，如果不使用 bind、call、apply 方法该怎么做？</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj1 = &#123;</span><br><span class="line">    <span class="attr">txt</span>: <span class="string">&#x27;coboy1&#x27;</span>,</span><br><span class="line">    <span class="attr">getName</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">txt</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> obj2 = &#123;</span><br><span class="line">    <span class="attr">txt</span>: <span class="string">&#x27;coboy2&#x27;</span>,</span><br><span class="line">    <span class="attr">getName</span>: obj1.<span class="property">getName</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj1.<span class="title function_">getName</span>()) </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj2.<span class="title function_">getName</span>())</span><br></pre></td></tr></table></figure><p>上述方法同样说明了那个重要的结论：this 指向最后调用它的对象。</p><p>我们将函数 obj1 的 getName 函数挂载到了 obj2 的对象上，getName 最终作为 obj2 对象的方法被调用。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-7"><p>call、apply：改变this指向后，原函数会立即执行<br>   且只是临时改变this指向一次<br>bind：改变指向后，不会立即执行<br>  而是返回一个永久改变this指向的函数</p><p>显示绑定</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> user = &#123;  </span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Jack&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">btn.<span class="property">onclick</span> = (<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)   <span class="comment">// 指向user</span></span><br><span class="line">&#125;).<span class="title function_">call</span>(user)</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="call，apply，bind-修改-this-指向"><a href="#call，apply，bind-修改-this-指向" class="headerlink" title="call，apply，bind 修改 this 指向"></a>call，apply，bind 修改 this 指向</h2><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">call方法</button></li><li class="tab"><button type="button" data-href="#super-2">apply方法</button></li><li class="tab"><button type="button" data-href="#super-3">call 方法和 apply 方法的区别</button></li><li class="tab"><button type="button" data-href="#super-4">bind 方法</button></li><li class="tab"><button type="button" data-href="#super-5">call() 方法和 bind() 方法的区别</button></li><li class="tab"><button type="button" data-href="#super-6">apply、call、bind 的异同</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><code>call()</code> 方法调用一个函数, 其具有一个指定的 <code>this</code> 值和分别地提供的参数（参数的列表）。语法为：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fun.<span class="title function_">call</span>(thisArg, arg1, arg2, ...)</span><br></pre></td></tr></table></figure><p>注：</p><ul><li><code>thisArg</code> 指的是在 <code>fun</code> 函数中指定的 <code>this</code> 的值。如果指定了 null 或者 undefined 则内部 <code>this</code> 指向 window，同时值为原始值（数字，字符串，布尔值）的 <code>this</code> 会指向该原始值的自动包装对象。是一个可选项。</li><li>arg1, arg2, …指定的参数列表。也是可选项。</li><li>使用调用者提供的 <code>this</code> 值和参数调用该函数的返回值。若该方法没有返回值，则返回 undefined。</li><li><code>call()</code> 允许为不同的对象分配和调用属于一个对象的函数&#x2F;方法。</li><li><code>call()</code> 提供新的 <code>this</code> 值给当前调用的函数&#x2F;方法。你可以使用 <code>call()</code> 来实现继承：写一个方法，然后让另外一个新的对象来继承它（而不是在新对象中再写一次这个方法）。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">    <span class="attr">txt</span>: <span class="string">&quot;coboy&quot;</span>, </span><br><span class="line">    <span class="attr">age</span>: <span class="number">18</span>, </span><br><span class="line">    <span class="attr">getName</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>, <span class="variable language_">this</span>.<span class="property">txt</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> obj1 = &#123;</span><br><span class="line">    <span class="attr">txt</span>: <span class="string">&#x27;cobyte&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">obj.<span class="title function_">getName</span>();     <span class="comment">// this指向obj</span></span><br><span class="line">obj.<span class="property">getName</span>.<span class="title function_">call</span>(obj1); <span class="comment">// this指向obj1</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><code>apply()</code> 方法与 <code>call()</code> 方法类似，唯一的区别是 <code>call()</code> 方法接受的是参数，<code>apply()</code> 方法接受的是数组。语法为：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fun.<span class="title function_">apply</span>(thisArg, [argsArray]);</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">    <span class="attr">txt</span>: <span class="string">&quot;coboy&quot;</span>, </span><br><span class="line">    <span class="attr">age</span>: <span class="number">18</span>, </span><br><span class="line">    <span class="attr">getName</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>, <span class="variable language_">this</span>.<span class="property">txt</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> obj1 = &#123;</span><br><span class="line">    <span class="attr">txt</span>: <span class="string">&#x27;cobyte&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">obj.<span class="title function_">getName</span>();         <span class="comment">// this指向obj</span></span><br><span class="line">obj.<span class="property">getName</span>.<span class="title function_">apply</span>(obj1);    <span class="comment">// this指向obj1</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">    <span class="attr">txt</span>: <span class="string">&quot;coboy&quot;</span>, </span><br><span class="line">    <span class="attr">age</span>: <span class="number">18</span>, </span><br><span class="line">    <span class="attr">getName</span>: <span class="keyword">function</span>(<span class="params">name1, name2</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>, name1, name2)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> obj1 = &#123;</span><br><span class="line">    <span class="attr">txt</span>: <span class="string">&#x27;cobyte&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">obj.<span class="property">getName</span>.<span class="title function_">call</span>(obj1, <span class="string">&#x27;coboy1&#x27;</span>, <span class="string">&#x27;coboy2&#x27;</span>)</span><br><span class="line">obj.<span class="property">getName</span>.<span class="title function_">apply</span>(obj1, [<span class="string">&#x27;coboy1&#x27;</span>, <span class="string">&#x27;coboy2&#x27;</span>])</span><br></pre></td></tr></table></figure><p>call 方法与 apply 方法用法基本相同<br>不同点主要是：</p><ul><li>call() 方法的第二个参数和之后的参数可以是任意数据类型</li><li>apply 的第二个参数是数组类型或者 arguments 参数集合。</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p><code>bind()</code> 方法创建一个新的函数（称为绑定函数），在调用时设置 <code>this</code> 关键字为提供的值。并在调用新函数时，将给定参数列表作为原函数的参数序列的前若干项。语法为：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fun.<span class="title function_">bind</span>(thisArg[, arg1[, arg2[, ...]]])</span><br></pre></td></tr></table></figure><p>注：参数 thisArg：当绑定函数被调用时，该参数会作为原函数运行时的 <code>this</code> 指向。当使用 <code>new</code> 操作符调用绑定函数时，该参数无效。参数：arg1，arg2，…表示当目标函数被调用时，预先添加到绑定函数的参数列表中的参数。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">    <span class="attr">txt</span>: <span class="string">&quot;coboy&quot;</span>, </span><br><span class="line">    <span class="attr">age</span>: <span class="number">18</span>, </span><br><span class="line">    <span class="attr">getName</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">txt</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> obj2 = &#123;</span><br><span class="line">    <span class="attr">txt</span>: <span class="string">&quot;cobyte&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> newGetName = obj.<span class="property">getName</span>.<span class="title function_">bind</span>(obj2)</span><br><span class="line"><span class="title function_">newGetName</span>(); <span class="comment">// this指向obj2</span></span><br><span class="line">obj.<span class="title function_">getName</span>(); <span class="comment">// this仍然指向obj</span></span><br></pre></td></tr></table></figure><p>bind() 方法也能修改 this 指向，不过调用 bind() 方法不会执行 getName()函数，也不会改变 getName() 函数本身，只会返回一个已经修改了 this 指向的新函数，这个新函数可以赋值给一个变量，调用这个变量新函数才能执行 getName()。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><ol><li>bind 的返回值是函数，并且不会自动调用执行。</li><li>两者后面的参数的使用也不同。<blockquote><p>call 是把第二个及以后的参数作为原函数的实参传进去<br>bind 实参在其传入参数的基础上往后获取参数执行。</p></blockquote></li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params">a, b, c</span>)&#123; </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(a, b, c); </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> fn1 = fn.<span class="title function_">bind</span>(&#123;abc : <span class="number">123</span>&#125;, <span class="number">600</span>);</span><br><span class="line"><span class="title function_">fn</span>(<span class="number">100</span>,<span class="number">200</span>,<span class="number">300</span>) <span class="comment">// 100,200,300 </span></span><br><span class="line"><span class="title function_">fn1</span>(<span class="number">100</span>,<span class="number">200</span>,<span class="number">300</span>) <span class="comment">// 600,100,200 </span></span><br><span class="line"><span class="title function_">fn1</span>(<span class="number">200</span>,<span class="number">300</span>) <span class="comment">// 600,200,300 </span></span><br><span class="line">fn.<span class="title function_">call</span>(&#123;abc : <span class="number">123</span>&#125;,<span class="number">600</span>) <span class="comment">// 600,undefined,undefined</span></span><br><span class="line">fn.<span class="title function_">call</span>(&#123;abc : <span class="number">123</span>&#125;,<span class="number">600</span>,<span class="number">100</span>,<span class="number">200</span>) <span class="comment">// 600,100,200</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-6"><ol><li>三者都可以改变this的指向，第一个参数都是this，如果指向是null或者undefined则指向window</li><li>apply的参数是数组，call是列表，而bind可以多次传入</li><li>apply和call是改变this的指向之后直接运行函数，而bind则是返回绑定之后的函数</li></ol><p>三个函数的使用</p><blockquote><p>call()：参数一个一个传入，第一个实参是对象，实参传入个数可大于功能实现所需参数个数，返回函数运行结果。<br>apply()：参数为一个对象和一个数组，数组内的元素个数可大于功能实现所需参数个数，返回函数运行结果。<br>bind()：参数传入和call()一样，但bind()调用后会返回一个函数，需要一个新的变量来接收它返回的函数，再调用返回的新函数才能实现功能。用bind()进行显示绑定时，参数可以一次性传入，也可以分为两部分，第二部分传入返回的新函数。</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="从手写-new、call、apply、bind-中去理解-this"><a href="#从手写-new、call、apply、bind-中去理解-this" class="headerlink" title="从手写 new、call、apply、bind 中去理解 this"></a>从手写 new、call、apply、bind 中去理解 this</h2><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">手写 new 的实现</button></li><li class="tab"><button type="button" data-href="#super-2">手写 call 的实现</button></li><li class="tab"><button type="button" data-href="#super-3">手写 apply 的实现</button></li><li class="tab"><button type="button" data-href="#super-4">手写 bind 的实现(简单版)</button></li><li class="tab"><button type="button" data-href="#super-5">手写 bind 的实现(完整复杂版)</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><strong>new 操作符的实现过程</strong></p><ol><li>创建一个新的空对象</li><li>把这个新的空对象的隐式原型（<code>__proto__</code>）指向构造函数的原型对象（<code>prototype</code>）</li><li>把构造函数中的 <code>this</code>指向新创建的空对象并且执行构造函数，返回执行结果</li><li>判断返回的执行结果是否是引用类型，如果是引用类型则返回执行结果，<code>new</code>操作失败，否则返回创建的新对象</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  create函数要接受不定量的参数，第一个参数是构造函数（也就是new操作符的目标函数），其余参数被构造函数使用。</span></span><br><span class="line"><span class="comment">  new Create() 是一种js语法糖，可以用函数调用的方式模拟实现</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">create</span>(<span class="params">Fn, ...args</span>)&#123;</span><br><span class="line">    <span class="comment">// 1、创建一个空的对象</span></span><br><span class="line">    <span class="keyword">let</span> obj = &#123;&#125;; </span><br><span class="line">    <span class="comment">// 等价于 let obj = Object.create(&#123;&#125;);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2、将空对象的原型__proto__指向构造函数的原型prototype</span></span><br><span class="line">    obj.<span class="property">__proto__</span> = <span class="title class_">Fn</span>.<span class="property"><span class="keyword">prototype</span></span></span><br><span class="line">    <span class="comment">// 等价于 Object.setPrototypeOf(obj, Fn.prototype);</span></span><br><span class="line">  </span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * 以上 1、2步还可以通过以下两种方式实现</span></span><br><span class="line"><span class="comment">        * const obj = Object.create(Fn.prototype)</span></span><br><span class="line"><span class="comment">        * Object.setPrototypeOf(obj, Fn.prototype)</span></span><br><span class="line"><span class="comment">    */</span> </span><br><span class="line">  </span><br><span class="line">    <span class="comment">// 3、改变构造函数的上下文（this），并将参数传入</span></span><br><span class="line">    <span class="keyword">let</span> result = <span class="title class_">Fn</span>.<span class="title function_">apply</span>(obj, args);</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// 4、如果构造函数执行后，返回的结果是对象类型，则直接将该结果返回，否则返回 obj 对象</span></span><br><span class="line">    <span class="keyword">return</span> result <span class="keyword">instanceof</span> <span class="title class_">Object</span> ? result : obj;</span><br><span class="line">    <span class="comment">// return typeof result === &#x27;object&#x27; &amp;&amp; result != null ? result : obj</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在 new 的时候，会对构造函数的返回值做一些判断：</p><blockquote><p>如果返回值是基础数据类型，则忽略返回值<br>如果返回值是引用数据类型，则使用 return 的返回，也就是 new 操作符无效。</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><strong>call 函数的实现步骤</strong></p><ol><li>判断调用对象是否为函数，即使我们是定义在函数的原型上的，但是可能出现使用 call 等方式调用的情况。</li><li>判断传入上下文对象是否存在，如果不存在，则设置为 window。</li><li>处理传入的参数，截取第一个参数后的所有参数。</li><li>将函数作为上下文对象的一个属性。</li><li>使用上下文对象来调用这个方法，并保存返回结果。</li><li>删除刚才新增的属性。</li><li>返回结果。</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">myCall</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 判断调用对象</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable language_">this</span> !== <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;type error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取除对象以外的所有参数</span></span><br><span class="line">    <span class="keyword">const</span> args = [...<span class="variable language_">arguments</span>].<span class="title function_">slice</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1.取出作用域，如果不存在则设置为 window，避免报错</span></span><br><span class="line">    <span class="keyword">const</span> thisArg = args.<span class="title function_">shift</span>() || <span class="variable language_">window</span>;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// 2.添加 fn 属性（创建唯一的属性防止污染）</span></span><br><span class="line">    <span class="keyword">const</span> fn = <span class="title class_">Symbol</span>(<span class="string">&#x27;fn&#x27;</span>)</span><br><span class="line">    <span class="comment">// 将调用myCall的函数添加到对象thisArg中</span></span><br><span class="line">    thisArg[fn] = <span class="variable language_">this</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3.执行函数</span></span><br><span class="line">    <span class="keyword">const</span> result = thisArg[fn](...args) <span class="comment">// 隐式绑定，将参数一个一个按fn接收的类型传进调用fn，得到执行结果</span></span><br><span class="line">  </span><br><span class="line">    <span class="comment">// 4.删除新加的属性fn，将实参对象恢复原样</span></span><br><span class="line">    <span class="keyword">delete</span> thisArg[fn]</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 5.返回执行结果</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// func.mycall(obj, 参数2, 参数3, 参数4);</span></span><br></pre></td></tr></table></figure><ol><li>myCall 中的 this 指向谁？<br>myCall 已经设置在 Function 构造函数的原型对象（prototype）上了，所以每个函数都可以调用 myCall 方法，比如函数 Fn.myCall()，根据 this 的确定规律：“ <strong>谁调用它，this 就指向谁</strong> ”，所以myCall方法内的 this 就指向了调用的函数，也可以说是要绑定的那个函数。</li><li>Fn.myCall(obj) 本质就是把函数 Fn 赋值到 对象 obj 上，然后通过对象 obj.Fn() 来执行函数 Fn，那么最终又回到那个 this 的确定规律：“ <strong>谁调用它，this 就指向谁</strong> ”，因为对象 obj 调用了 Fn 所以 Fn 内部的 this 就指向了对象 obj。</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>apply 的实现跟 call 的实现基本是一样的，因为他们的使用方式也基本一样，只是传参的方式不一样。apply 的参数必须以数组的形式传参。</p><p><strong>apply 函数的实现步骤</strong></p><ol><li>判断调用对象是否为函数，即使我们是定义在函数的原型上的，但是可能出现使用 call 等方式调用的情况。</li><li>判断传入上下文对象是否存在，如果不存在，则设置为 window 。</li><li>将函数作为上下文对象的一个属性。</li><li>判断参数值是否传入</li><li>使用上下文对象来调用这个方法，并保存返回结果。</li><li>删除刚才新增的属性</li><li>返回结果</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">myApply</span> = <span class="keyword">function</span> (<span class="params">context, args</span>) &#123;</span><br><span class="line">    <span class="comment">// 判断调用对象是否为函数</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable language_">this</span> !== <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TypeError</span>(<span class="string">&quot;Error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!<span class="title class_">Array</span>.<span class="title function_">isArray</span>(args)) &#123;</span><br><span class="line">       <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;参数必须是数组&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> args = [...<span class="variable language_">arguments</span>].<span class="title function_">slice</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1.取出作用域，如果不存在则为 window</span></span><br><span class="line">    <span class="keyword">const</span> thisArg = args.<span class="title function_">shift</span>() || <span class="variable language_">window</span>;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// 2.添加 fn 属性（创建唯一的属性防止污染）</span></span><br><span class="line">    <span class="keyword">const</span> fn = <span class="title class_">Symbol</span>(<span class="string">&#x27;fn&#x27;</span>)</span><br><span class="line">    <span class="comment">// this 是函数的实例对象func</span></span><br><span class="line">    thisArg[fn] = <span class="variable language_">this</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3.执行函数</span></span><br><span class="line">    <span class="keyword">const</span> result = thisArg[fn](...args[<span class="number">0</span>])</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// 4.删除新加的属性</span></span><br><span class="line">    <span class="keyword">delete</span> thisArg[fn]</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 5.返回结果</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// func.apply(obj, [参数2, 参数3, 参数4])</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>bind 和 call、apply 方法的区别是它不会立即执行，它是返回一个改变了 this 指向的函数，在绑定的时候可以传参，之后执行的时候，还可以继续传参数数。<br>典型的闭包行为。<br><strong>bind 函数的实现步骤</strong></p><ol><li>判断调用对象是否为函数，即使我们是定义在函数的原型上的，但是可能出现使用 call 等方式调用的情况。</li><li>保存当前函数的引用，获取其余传入参数值。</li><li>创建一个函数返回</li><li>函数内部使用 apply 来绑定函数调用，需要判断函数作为构造函数的情况，这个时候需要传入当前函数的 this 给 apply 调用，其余情况都传入指定的上下文对象。</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">myBind</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 判断调用对象是否为函数</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable language_">this</span> !== <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TypeError</span>(<span class="string">&quot;Error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取参数</span></span><br><span class="line">    <span class="keyword">const</span> args = [...<span class="variable language_">arguments</span>].<span class="title function_">slice</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="comment">// 等价于</span></span><br><span class="line">    <span class="comment">// var bindArge = Array.prototype.slice.call(arguments, 1);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> thisArg = args.<span class="title function_">shift</span>() || <span class="variable language_">window</span></span><br><span class="line">    <span class="keyword">const</span> _self = <span class="variable language_">this</span></span><br><span class="line">  </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">Fn</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 根据调用方式，传入不同绑定值</span></span><br><span class="line">        <span class="keyword">return</span> fn.<span class="title function_">apply</span>(</span><br><span class="line">            <span class="variable language_">this</span> <span class="keyword">instanceof</span> <span class="title class_">Fn</span> ? <span class="variable language_">this</span> : context, args.<span class="title function_">concat</span>(...<span class="variable language_">arguments</span>)</span><br><span class="line">        );</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">myBind</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> thisArg = [...<span class="variable language_">arguments</span>].<span class="title function_">shift</span>()</span><br><span class="line">    <span class="keyword">const</span> args = <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">slice</span>.<span class="title function_">call</span>(<span class="variable language_">arguments</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">const</span> _self = <span class="variable language_">this</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(_self) === <span class="string">&#x27;[object Function]&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="title class_">TypeError</span>(<span class="string">&#x27;myBind must be called on a function&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 对 thisArg 进行深拷贝，防止 bind 执行后返回函数未执行期间，thisArg 被修改</span></span><br><span class="line">    thisArg = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(thisArg)) || <span class="variable language_">window</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * 构造函数生成对象实例</span></span><br><span class="line"><span class="comment">        * @returns &#123;Object|*&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">const</span> create = <span class="keyword">function</span> (<span class="params">conFn</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> obj = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 设置原型指向，确定继承关系 */</span></span><br><span class="line">        obj.<span class="property">__proto__</span> = conFn.<span class="property"><span class="keyword">prototype</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">            * 1、执行目标函数，绑定函数内部的属性</span></span><br><span class="line"><span class="comment">            * 2、如果目标函数有对象类型的返回值则取返回值，符合js new关键字的规范</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">const</span> res = conFn.<span class="title function_">apply</span>(obj, <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">slice</span>.<span class="title function_">call</span>(<span class="variable language_">arguments</span>,<span class="number">1</span>));</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">typeof</span> res === <span class="string">&#x27;object&#x27;</span> &amp;&amp; res != <span class="literal">null</span> ? res : obj;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> bound = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// new 操作符操作的时候</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span> <span class="keyword">instanceof</span> bound) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">create</span>(_self, args.<span class="title function_">concat</span>(<span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">slice</span>.<span class="title function_">call</span>(<span class="variable language_">arguments</span>)));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> self.<span class="title function_">apply</span>(thisArg, args.<span class="title function_">concat</span>(<span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">slice</span>.<span class="title function_">call</span>(<span class="variable language_">arguments</span>)));</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> bound;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="this-优先级"><a href="#this-优先级" class="headerlink" title="this 优先级"></a>this 优先级</h2><p>我们通常把通过 call、apply、bind、new 对 this 进行绑定的情况称为显式绑定，而把根据调用关系确定 this 指向的情况称为隐式绑定。那么显示绑定和隐式绑定谁的优先级更高呢？</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">super 1</button></li><li class="tab"><button type="button" data-href="#super-2">super 2</button></li><li class="tab"><button type="button" data-href="#super-3">super 3</button></li><li class="tab"><button type="button" data-href="#super-4">super 4</button></li><li class="tab"><button type="button" data-href="#super-5">显式绑定的 this 要比隐式绑定的 this 优先级要高</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getName</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">txt</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj1 = &#123;</span><br><span class="line">    <span class="attr">txt</span>: <span class="string">&#x27;coboy1&#x27;</span>,</span><br><span class="line">    <span class="attr">getName</span>: getName</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj2 = &#123;</span><br><span class="line">    <span class="attr">txt</span>: <span class="string">&#x27;coboy2&#x27;</span>,</span><br><span class="line">    <span class="attr">getName</span>: getName</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">obj1.<span class="property">getName</span>.<span class="title function_">call</span>(obj2) <span class="comment">// &#x27;coboy2&#x27;</span></span><br><span class="line">obj2.<span class="property">getName</span>.<span class="title function_">apply</span>(obj1) <span class="comment">// &#x27;coboy1&#x27;</span></span><br></pre></td></tr></table></figure><p>可以看出 call、apply 的显示绑定比隐式绑定优先级更高些。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getName</span>(<span class="params">name</span>) &#123;</span><br><span class="line">   <span class="variable language_">this</span>.<span class="property">txt</span> = name</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj1 = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> newGetName = getName.<span class="title function_">bind</span>(obj1)</span><br><span class="line"><span class="title function_">newGetName</span>(<span class="string">&#x27;coboy&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj1) <span class="comment">// &#123;txt: &quot;coboy&quot;&#125;</span></span><br></pre></td></tr></table></figure><p>当再使用 newGetName 作为构造函数时。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj2 = <span class="keyword">new</span> <span class="title function_">newGetName</span>(<span class="string">&#x27;cobyte&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj2.<span class="property">txt</span>) <span class="comment">// &#x27;cobyte&#x27;</span></span><br></pre></td></tr></table></figure><p>这个时候新对象中的 txt 属性值为 ‘cobyte’。<br>newGetName 函数本身是通过 bind 方法构造的函数，其内部已经将this绑定为 obj1,当它再次作为构造函数通过 new 被调用时，返回的实例就已经和 obj1 解绑了。也就是说，new 绑定修改了 bind 绑定中的 this 指向，所以 new 绑定的优先级比显式 bind 绑定的更高。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getName</span>(<span class="params"></span>) &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="function"><span class="params">name</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">txt</span></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj1 = &#123; <span class="attr">txt</span>: <span class="string">&#x27;coboy1&#x27;</span> &#125;</span><br><span class="line"><span class="keyword">const</span> obj2 = &#123; <span class="attr">txt</span>: <span class="string">&#x27;coboy2&#x27;</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> newGetName = getName.<span class="title function_">call</span>(obj1)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(newGetName.<span class="title function_">call</span>(obj2)) <span class="comment">// &#x27;coboy1&#x27;</span></span><br></pre></td></tr></table></figure><p>由于 getName 中的 this 绑定到了 obj1 上，所以 newGetName(引用箭头函数) 中的 this 也会绑到 obj1 上，箭头函数的绑定无法被修改。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> txt = <span class="string">&#x27;good boy&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getName</span> = (<span class="params"></span>) =&gt; <span class="function"><span class="params">name</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">txt</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj1 = &#123; <span class="attr">txt</span>: <span class="string">&#x27;coboy1&#x27;</span> &#125;</span><br><span class="line"><span class="keyword">const</span> obj2 = &#123; <span class="attr">txt</span>: <span class="string">&#x27;coboy2&#x27;</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> newGetName = getName.<span class="title function_">call</span>(obj1)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(newGetName.<span class="title function_">call</span>(obj2)) <span class="comment">// &#x27;good boy&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> txt = <span class="string">&#x27;good boy&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getName</span> = (<span class="params"></span>) =&gt; <span class="function"><span class="params">name</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">txt</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj1 = &#123; <span class="attr">txt</span>: <span class="string">&#x27;coboy1&#x27;</span> &#125;</span><br><span class="line"><span class="keyword">const</span> obj2 = &#123; <span class="attr">txt</span>: <span class="string">&#x27;coboy2&#x27;</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> newGetName = getName.<span class="title function_">call</span>(obj1)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(newGetName.<span class="title function_">call</span>(obj2)) <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure><p>const 声明的变量不会挂到 window 全局对象上，所以 this 指向 window 时，自然也找不到 txt 变量了。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p>通过上面的实现原理，我们就可以理解为什么上面的 this 优先级中通过 call、apply、bind 和 new 操作符的显式绑定的 this 要比隐式绑定的 this 优先级要高了。例如上面的 obj1.getName.call(obj2) 中的 getName 方法本来是通过 obj1 来调用的，但通过 call 方法之后，实际 getName 方法变成了 obj2.getName() 来执行了。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>通过本篇内容的学习，我们看到 this 的用法纷繁多样，确实不容易掌握。但总的来说可以总结为以下几条规则：</p><ul><li>在函数体中，非显式或隐式地简单调用函数时，在严格模式下，函数内的 this 会绑定到 undefined 上，在非严格模式下则会被绑定到全局对象 window&#x2F;global 上。</li><li>一般使用 new 方法调用构造函数时，构造函数内的 this 会被绑定到新创建的对象上，且优先级要比 bind 的高。</li><li>一般通过 call、apply、bind 方法显式调用函数时，函数体内的 this 会被绑定到指定参数的对象上，显式绑定的 this 要比隐式绑定的 this 优先级要高。</li><li>一般通过上下文对象调用函数时，函数体内的 this 会被绑定到该对象上。</li><li>在箭头函数中，this 的指向是由外层（函数或全局）作用域来决定的。</li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 函数式编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 执行上下文 </tag>
            
            <tag> this指向 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JS线程机制</title>
      <link href="/posts/7d1a3714/"/>
      <url>/posts/7d1a3714/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="进程与线程"><a href="#进程与线程" class="headerlink" title="进程与线程"></a>进程与线程</h3><h4 id="进程（process）"><a href="#进程（process）" class="headerlink" title="进程（process）"></a>进程（process）</h4><ul><li>程序的一次执行，它占有一片独有的内存空间</li><li>可以通过windows任务管理查看进程</li><li><strong>应用程序的执行程序</strong></li></ul><h4 id="线程（thread）"><a href="#线程（thread）" class="headerlink" title="线程（thread）"></a>线程（thread）</h4><ul><li>是进程内的一个独立执行单元</li><li>是程序执行的一个完整流程</li><li>是CPU的最小调度单元</li><li><strong>存在于进程内部，并执行其进程程序的部分功能。</strong></li></ul><p><a href="https://zh.wikipedia.org/wiki/%E4%BA%92%E6%96%A5%E9%94%81">&amp;#34;互斥锁&amp;#34;</a>（Mutual exclusion，缩写 Mutex）</p><blockquote><p>防止多个线程同时读写某一块内存区域。</p></blockquote><p><a href="https://en.wikipedia.org/wiki/Semaphore_(programming)">&amp;#34;信号量&amp;#34;</a>（Semaphore）</p><blockquote><p>用来保证多个线程不会互相冲突。</p></blockquote><p>mutex是semaphore的一种特殊情况（n&#x3D;1时）。也就是说，完全可以用后者替代前者。但是，因为mutex较为简单，且效率高，所以在必须保证资源独占的情况下，还是采用这种设计。</p><h4 id="图解"><a href="#图解" class="headerlink" title="图解"></a>图解</h4><p><img src="https://img-blog.csdnimg.cn/6a9a17c3b33842a49f15108d8356df4b.png" alt="在这里插入图片描述"></p><h4 id="JS是单线程还是多线程"><a href="#JS是单线程还是多线程" class="headerlink" title="JS是单线程还是多线程"></a>JS是单线程还是多线程</h4><ul><li>js是单线程运行的</li><li>但使用H5中的Web Workers可以多线程运行</li></ul><h4 id="操作系统的设计"><a href="#操作系统的设计" class="headerlink" title="操作系统的设计"></a>操作系统的设计</h4><p>因此可以归结为三点：</p><p>（1）以多进程形式，允许多个任务同时运行；</p><p>（2）以多线程形式，允许单个任务分成不同的部分运行；</p><p>（3）提供协调机制，一方面防止进程之间和线程之间产生冲突，另一方面允许进程之间和线程之间共享资源。</p><h2 id="chrome的浏览器架构"><a href="#chrome的浏览器架构" class="headerlink" title="chrome的浏览器架构"></a>chrome的浏览器架构</h2><p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/10/30/166c2e2c3bb30ecf~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp"></p><p>每个 Chrome 进程以及其控制的范围：</p><ul><li>浏览器（Browser）：控制 “Chrome” 应用程序，包括地址栏、书签、后退和前进按钮等。还需要处理 Web 浏览器的权限管理，例如网络请求和文件访问。</li><li>渲染器（Renderer）：控制选项卡内，网站里显示的所有内容。</li><li>插件（Plugin）：控制网站使用的插件，例如：Flash。</li><li>GPU：独立于其他进程，专用于处理 GPU 任务，它被分成不同的进程，因为 GPU 会处理来自多个进程的请求，并将它们绘制在相同的 Surface 中。</li></ul><p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/10/30/166c2e2c3e092660~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp"></p><h2 id="JS线程组成"><a href="#JS线程组成" class="headerlink" title="JS线程组成"></a>JS线程组成</h2><p>虽然游览器是单线程执行JavaScript代码的，但是游览器有多个线程协助操作来实现单线程异步模型。</p><ol><li>GUI渲染线程</li><li>JavaScript引擎线程</li><li>事件触发线程</li><li>定时器触发线程</li><li>http请求线程</li><li>其他线程</li></ol><p>在JavaScript代码运行的过程中实际执行程序时同时只存在一个活动线程，实现同步异步就是靠多线程切换的形式来实现。</p><p>上面的细分线程可以归纳为两条线程：</p><ol><li>【主线程】：执行页面的渲染，js代码的运行，事件的触发等</li><li>【工作线程】：在幕后工作，用来处理异步任务的执行来实现非阻塞的运行模式</li></ol>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 异步编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 线程机制 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript执行过程</title>
      <link href="/posts/bc5f0cb1/"/>
      <url>/posts/bc5f0cb1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="浏览器的工作原理"><a href="#浏览器的工作原理" class="headerlink" title="浏览器的工作原理"></a>浏览器的工作原理</h1><p>比如： 浏览器中输入 <a href="https://link.juejin.cn/?target=http://www.baidu.com" title="http://www.baidu.com">www.baidu.com</a>，其中做了什么？</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6f277237eeac482384d90619373e5586~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="05_02.png"></p><p>步骤解析：</p><ol><li>输入<a href="http://www.baidu.com/">www.baidu.com</a>, 被 <strong>浏览器内核</strong> 解析成ip地址（假设: 111.222.333.444）,根据ip地址，找到一台服务器，服务器就会返回一个 <code>index.html</code> 文件，用来解析（注意: 这里并不是把所有的静态资源到返回了，在框架时代，就应该是所谓的<strong>分包</strong>操作吧。打包成多个 chunk.js, 用到时再加载）。</li><li>在解析 index.html 过程中，<ol><li>如果遇到 link 标签，就会去服务器中下载对应的 css 文件；</li><li>如果遇到了 script 标签，就回去服务器中下载对应的 js 文件。</li></ol></li></ol><h1 id="浏览器渲染过程"><a href="#浏览器渲染过程" class="headerlink" title="浏览器渲染过程"></a>浏览器渲染过程</h1><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b01811e4f0fe4197b503668a7088cd00~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="05_03.png"></p><p>根据上面的图解，可以得出以下信息：</p><ul><li>HTML 经过 HTML Parser 生成解析 DOMTree，Style 经过 CSS Parser解析生成 StyleRules。</li><li>DOMTree 和 StyleRules 结合，生成渲染树（RenderTree）</li><li>执行 layout 过程，确定每个节点在屏幕上的确切坐标。</li><li>渲染树 绘制（Painting），然后展示在屏幕上。</li></ul><blockquote><p><strong>注意</strong> ：上面的步骤并不是严格顺序执行的。浏览器引擎会以最快的速度展示内容。简单的来说，就是一边解析HTML一边构建渲染树，构建一部分，就会把以后的元素渲染出来。如果样式没有加载出来，就会以浏览器默认的样式展示。</p><p><code>正是由于浏览器引擎的尽快展示内容，就会造成样式还没加载就展示的问题。这就是经常发生的FOCU（flash of unstyled content）或则 白屏问题。</code></p></blockquote><h2 id="CSS加载不会阻塞DOM树的解析"><a href="#CSS加载不会阻塞DOM树的解析" class="headerlink" title="CSS加载不会阻塞DOM树的解析"></a>CSS加载不会阻塞DOM树的解析</h2><p>通过上面的图解可以看出，HTML解析和CSS解析，是并行的。所以CSS加载不会阻塞DOM树的解析</p><h2 id="CSS加载会阻塞DOM树的渲染"><a href="#CSS加载会阻塞DOM树的渲染" class="headerlink" title="CSS加载会阻塞DOM树的渲染"></a>CSS加载会阻塞DOM树的渲染</h2><p>渲染树（RenderTree）是 DOMTree 和 StyleRules 的结合。所以，就算DOMTree加载完成，也要等到CSS加载完成并解析完成，才能生成渲染树。</p><h2 id="JS执行会阻塞DOM树的解析"><a href="#JS执行会阻塞DOM树的解析" class="headerlink" title="JS执行会阻塞DOM树的解析"></a>JS执行会阻塞DOM树的解析</h2><p>从渲染图可以知道 HTML 解析成 DOMTree， 如果遇到 JavaScript 代码， 就会停止解析HTML，就会把控制权交给  <strong>JS引擎</strong> ， 去执行 JavaScript 代码。当 JavaScript 执行完成后，浏览器再从中断的地方继续解析生成DOM。</p><blockquote><p>这也是建议将 script 标签放在 body 标签底部的原因。</p></blockquote><p><strong>特殊情况：</strong></p><p>在上面也说过了，CSS加载不会阻塞DOM树的解析。但是呢？如果在解析DOM的时候，里面加入script标签，引入了JavaScript代码（js是万能的，也可以修改DOM，也可以修改样式）。如果JavaScript代码，需要修改样式，那么就需要等待CSS加载完毕，才能操作CSS。所以在这种特殊的情况下， <strong>css加载也是会阻塞DOM的解析</strong> 。</p><h2 id="优化渲染过程"><a href="#优化渲染过程" class="headerlink" title="优化渲染过程"></a>优化渲染过程</h2><ul><li>使用内联的JS、CSS，减少JS、CSS文件的下载。</li><li>webpack等工具对JS、CSS文件压缩，减少文件的大小。</li><li>使用 async 或者 defer。</li><li>使用CDN。</li></ul><h1 id="JavaScript在浏览器中的执行过程"><a href="#JavaScript在浏览器中的执行过程" class="headerlink" title="JavaScript在浏览器中的执行过程"></a>JavaScript在浏览器中的执行过程</h1><p><a href="https://juejin.cn/post/7097961831670480910">参考</a></p><p>JavaScript是一门高级语言，需要转化成机器指令，才能在电脑的CPU中运行。使JavaScript代码转换成机器指令，是通过JavaScript引擎来完成的。</p><p>JavaScript引擎在把JavaScript代码转换成机器指令过程中，先对JavaScript代码进行解析（词法分析，语法分析），生成AST树，然后在通过一些列操作转换成机器指令，从而在CPU中运行。</p><p>运行过程：</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/28348dbdbbe842ab9ed0bdd6672cee4f~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="05_04.png"></p><p>从上面图中，就可以看出，JavaScript代码一定需要经过解析，才能运行（后面会体现出来）。</p><h2 id="执行上下文栈"><a href="#执行上下文栈" class="headerlink" title="执行上下文栈"></a>执行上下文栈</h2><p>执行上下文栈（Execution Context Stack，简写ECS），也被称为 <strong>函数调用栈</strong> 。</p><p>JavaScript引擎内部实现了一个执行上文栈，目的就是为了执行代码。只要有代码执行，一定是在执行上下文栈中执行的。</p><p>从名字可以看出，这是一个 <strong>栈结构</strong> ，意味着可以进行<strong>入栈</strong>和<strong>出栈</strong>操作，也有着<strong>栈底</strong>和<strong>栈顶</strong>的概念。</p><h2 id="全局执行上下文"><a href="#全局执行上下文" class="headerlink" title="全局执行上下文"></a>全局执行上下文</h2><p>全局执行上下文（Global Execution Context，简写GEC）。</p><p>只要代码想要执行，一定经过执行上下文栈，而执行上下文栈也被称为函数调用栈，也就意味着代码是以函数的形式被调用。但是全局代码（比如定义变量，定义函数等）并不是函数的形式，我们并不能主动调用代码，而被动的需要浏览器去调用代码。起到该作用的就是 <strong>全局执行上下文</strong> ，先解析全局代码然后执行。</p><p><code>全局执行上下文放在函数调用栈的栈底</code>。</p><h2 id="函数执行上下文"><a href="#函数执行上下文" class="headerlink" title="函数执行上下文"></a>函数执行上下文</h2><p>函数执行上下文（Function Execution Context，简写FEC）。</p><p>在执行代码的过程中，如果遇到函数的主动调用，就会生成一个函数执行上下文，<strong>入栈</strong>到函数调用栈中；当函数调动完成之后，就会执行出栈操作。</p><p>三者大致的关系如下：</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2ccba36353634269b357c4eae0d3e164~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="06_2.png"></p><h2 id="理解执行上下文"><a href="#理解执行上下文" class="headerlink" title="理解执行上下文"></a>理解执行上下文</h2><p>全局执行上下文和函数执行上下文，大致也分为两个阶段：<strong>编译阶段</strong>和 <strong>执行阶段</strong> 。</p><ul><li><p>编译阶段：其实就是解析代码的过程。（难点也是重点）</p><blockquote><p>解析过程中，保存了三个重要的信息：</p><ol><li><code>VO</code>(Variable Object)对象：该对象保存了当前执行上下文中的变量和函数地址（也就是当前作用域）。</li><li><code>作用域链</code>：VO(当前作用域) + ParentScope(父级作用域)</li><li><code>this的指向</code>： 视情况而定。</li></ol></blockquote></li><li><p>执行阶段：依次执行代码，给变量赋值等等一些操作。</p></li></ul><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d5487b7d351b4692a4137bb8513b5591~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="06_3.png"></p><p>我的简单理解就是：<code>编译创建信息，执行使用信息</code>。</p><h2 id="JavaScript的执行过程分析"><a href="#JavaScript的执行过程分析" class="headerlink" title="JavaScript的执行过程分析"></a>JavaScript的执行过程分析</h2><p>上面说到了太多的概念，可能会云里雾里的。那么直接看一段代码的执行过程，可以加深对上面的概念认识和理解。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">var</span> name = <span class="string">&#x27;copyer&#x27;</span></span><br><span class="line"> <span class="keyword">var</span> age = <span class="number">18</span></span><br><span class="line"> <span class="title function_">foo</span>()</span><br><span class="line"> <span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">     <span class="keyword">var</span> city = <span class="string">&#x27;cq&#x27;</span></span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(city)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="variable language_">console</span>.<span class="title function_">log</span>(message)</span><br><span class="line"> <span class="variable language_">console</span>.<span class="title function_">log</span>(age)</span><br></pre></td></tr></table></figure><p><strong>分析代码：</strong></p><h3 id="第一步：初始化全局对象"><a href="#第一步：初始化全局对象" class="headerlink" title="第一步：初始化全局对象"></a>第一步：初始化全局对象</h3><p>变量定义（name、age），函数定义（foo）,都是需要全局执行上下文来进行处理的。</p><p>全局执行上下文的两个阶段：</p><ul><li>编译阶段：在解析的过程中，会在堆内存中开辟一个地址（0x100），来保存一个GO对象; GO对象里面记录着JavaScript全局提供的一些属性和方法，和自己写的全局变量（还没有赋值）和全局函数。确定了三个信息：<ul><li>VO：指向GO的地址</li><li>Scope Chain: VO（因为全局就是最顶层的作用域，就没有父级作用域）</li><li>this: window</li></ul></li><li>执行阶段：依次执行代码，对GO对象，进行变量初始化，以及对函数的调用。</li></ul><blockquote><p><strong>认识GO对象</strong> ：</p><p>GO：Global Object，即全局对象，在全局执行上下文的编译阶段生成。</p><p>GO里面保存了JavaScript内部提供的一些全局的函数和属性（setTimeout,window,Math等等）。</p><p>在编译阶段，也会把自己写的全局变量添加进去（name，age）；解析是函数的话，也会在堆内存中开辟一个新的地址（0x200）来保存函数信息。在GO对象中，就会以key-value的形式保存（key:函数名，value:内存地址）</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">var</span> <span class="title class_">GlobalObject</span> = &#123;</span><br><span class="line">     <span class="comment">//自带的</span></span><br><span class="line">     <span class="title class_">Math</span>: xxx,</span><br><span class="line">     <span class="attr">setTimeout</span>: xxx，</span><br><span class="line">     <span class="variable language_">window</span>：<span class="title class_">GlobalObject</span>，</span><br><span class="line">     ...</span><br><span class="line">     <span class="comment">// 新增的</span></span><br><span class="line">     name：<span class="literal">undefined</span>，</span><br><span class="line">     <span class="attr">age</span>: <span class="literal">undefined</span>,</span><br><span class="line">     <span class="attr">foo</span>: <span class="number">0x200</span></span><br><span class="line"> &#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure></blockquote><blockquote><p><strong>函数内存空间</strong> ：</p><p>在解析过程中，如果遇到函数，就会在堆内存中开辟一个新的空间，来保存函数的一些信息。那么保存的有哪些内容呢？</p><ol><li>父级作用域（<code>parentScope</code>）: 函数的父级作用域在定义的时候就已经确定了。</li><li>函数执行体</li></ol></blockquote><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b1273ec0ba66482ab5df32abacd24dc2~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="06_6.png"></p><h3 id="第二步：执行全局代码过程中，遇到函数调用"><a href="#第二步：执行全局代码过程中，遇到函数调用" class="headerlink" title="第二步：执行全局代码过程中，遇到函数调用"></a>第二步：执行全局代码过程中，遇到函数调用</h3><p>如果在执行的过程中，遇到的函数调用，就会产生一个函数执行上下文添加到函数调用栈中（ <strong>入栈</strong> ）；函数调用完成之后，就会弹出函数调用栈（ <strong>出栈</strong> ）。</p><p>函数执行上下文的两个阶段：</p><ul><li>编译阶段：在解析的函数过程中，会在堆内存中开辟一个地址（0x300），来保存一个AO对象; AO对象里面记录着函数形参（arguments）和定义的变量（包括内部函数定义）。确定了三个信息：<ul><li>VO：指向AO的地址</li><li>Scope Chain: AO + parentScope（函数定义的时候，parentScope就已经确认了）</li><li>this: window（一般根据调用的情况而定，这里是window调用的）</li></ul></li><li>执行阶段：依次执行函数体中的代码，对AO对象，进行变量初始化，以及对函数的调用。执行完毕之后，就弹出函数调用栈，也会自动清空堆内存中的AO对象。</li></ul><blockquote><p><strong>认识AO对象</strong> ：</p><p>AO：Activation Object，即活跃对象（当前函数处于激活的状态），在函数执行上下文的编译阶段生成。</p><p>里面保存了函数形参（arguments）和函数内部的变量</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">var</span> <span class="title class_">ActivationObject</span> = &#123;</span><br><span class="line">     <span class="attr">arguments</span>: <span class="regexp">/是一个数组，这里保存的也是地址/</span></span><br><span class="line">     <span class="attr">city</span>: <span class="literal">undefined</span>,</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></blockquote><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7f7af37701f94e8696c64d7a8662adb5~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="06_7.png"></p><h2 id="JavaScript的作用域链"><a href="#JavaScript的作用域链" class="headerlink" title="JavaScript的作用域链"></a>JavaScript的作用域链</h2><p>在（全局，函数）执行上下文的<strong>编译阶段</strong>保存了三个信息，其中两个就是关于作用域的：</p><ul><li>VO：指向一个对象（AO，GO），也可以简单的理解为 <code>当前作用域</code></li><li>Scope Chain: <code>作用域链</code></li></ul><p>看下面的一段代码</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">var</span> message = <span class="string">&#x27;copyer&#x27;</span></span><br><span class="line"> <span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">     <span class="keyword">var</span> age = <span class="number">18</span></span><br><span class="line">     <span class="keyword">function</span> <span class="title function_">bar</span>(<span class="params"></span>) &#123;</span><br><span class="line">         <span class="variable language_">console</span>.<span class="title function_">log</span>(message)</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="title function_">bar</span>()</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="title function_">foo</span>()</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p> <strong>代码分析</strong> ：</p><p>全局执行上下文：编译阶段生成GO对象(0x100)</p><ul><li>VO：0x100（GO）</li><li>scope chain：GO</li></ul><p>函数执行上下文（foo）：编译阶段生成AO对象（0x200）</p><ul><li>VO: 0x200（AO对象，foo）</li><li>scope chain：VO（0x200） + GO（0x100, parentScope）</li></ul><p>函数执行上下文（bar）：编译阶段生成AO对象（0x300）</p><ul><li>VO: 0x300 （AO, bar）</li><li>scope chain: VO（0x300） + AO（0x200, parentScope）</li></ul><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b317b30d46c84b5bac9bb2a75d415b35~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="06_8.png"></p><p>在执行 bar 函数体的时候，发现message 在当前VO（0x300）中没有，就会沿着scope chain继续寻找。</p><ul><li>在 VO（0x300）中没有message，就会去parentScope（0x200）中去寻找。</li><li>在 VO（0x200）中也没有message，就会继续去parentScope（0x100）中去寻找。</li><li>在 VO（0x100）中发现message，也就是GO，所以打印 message 为 copyer</li></ul><p>这就是所谓的作用域链。</p><p> <strong>记住两句话</strong> ：</p><ol><li>父级作用域在编译阶段就已经确定了。</li><li>查找变量就是按照作用域链查找（找到近停止）。</li></ol><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ol><li>理解执行上下文栈（函数调用栈）： 所有代码执行的地方。</li><li>理解全局执行上下文： 针对全局代码。</li><li>理解函数执行上下文： 针对函数。</li><li>执行上下文的两个阶段： 编译阶段和执行阶段。</li><li>理解VO，GO，AO。</li></ol>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> ECMAScript基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JS执行过程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Promise分析</title>
      <link href="/posts/9fa4412f/"/>
      <url>/posts/9fa4412f/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="异步方案对比（Promise和回调函数）"><a href="#异步方案对比（Promise和回调函数）" class="headerlink" title="异步方案对比（Promise和回调函数）"></a>异步方案对比（Promise和回调函数）</h2><ul><li><p>侵入性</p></li><li><p>扁平化（链式调用）</p></li><li><p>状态固化，即事件发生后无法监听到</p><p>Promise对象进入完成状态时，状态会固化。因此Promise对象完成前后可以获得一样的执行结果</p></li></ul><h2 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h2><p>Promise(承诺)，给予调用者一个承诺，过一会返回数据，就可以创建一个promise对象<br>当new一个promise，此时需要传递一个回调函数，这个函数需要立即执行，称之为executor<br>这个回调函数，还需要传入两个参数——回调函数——<code>reslove()</code>、<code>reject()</code></p><ul><li>当执行了reslove函数，会回调promise对象的.then函数</li><li>当执行了reject函数，会回调promise对象的.catche函数</li></ul><h2 id="解决问题"><a href="#解决问题" class="headerlink" title="解决问题"></a>解决问题</h2><blockquote><p>Callback 由于异步操作会造成回调地狱，还会造成难以测试的问题。</p></blockquote><p>因此，出现 &#x3D;&#x3D;&gt; <strong>ES6 中的 Promise （基于<a href="https://promisesaplus.com/"> Promise A +</a> 规范的异步编程解决方案）</strong></p><blockquote><p>基于<a href="http://www.ruanyifeng.com/blog/2013/09/finite-state_machine_for_javascript.html">有限状态机</a>的原理</p></blockquote><p>主要解决如下问题：</p><ol><li>统一编码规范。只要开发者使用promise，就会给他一个承诺，成功的时候调用then方法，失败的时候调用catch方法等等一些列规范。</li><li>promise的链式调用解决了回调地狱的问题，提升了代码的可读性和可维护性。</li><li>支持多并发请求，获取并发请求中的数据</li></ol><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">同步</button></li><li class="tab"><button type="button" data-href="#super-2">异步</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>管理 <strong>同步操作</strong> 结果状态和数据的容器对象结构<br><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a3638fa2c1c947e0b835805130395516~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="img"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>支持管理 <strong>异步操作</strong> 所产生的结果状态和数据<br><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5a64376b3f814adbae1ba2a738302631~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="img"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="Promise-对象的异步操作有三种状态"><a href="#Promise-对象的异步操作有三种状态" class="headerlink" title="Promise 对象的异步操作有三种状态"></a>Promise 对象的异步操作有三种状态</h2><blockquote><p><code>pending</code>（进行中）<br><code>fulfilled</code>（已成功）<br><code>rejected</code>（已失败）</p></blockquote><h2 id="Promise-A-规范"><a href="#Promise-A-规范" class="headerlink" title="Promise A+规范"></a>Promise A+规范</h2><p>Promise&#x2F;A+的规范比较长，总结两条核心规则：</p><ol><li>Promise本质是一个状态机，且状态只能为以下三种：<blockquote><ul><li>Pending（等待态）</li><li>Fulfilled（执行态）</li><li>Rejected（拒绝态）</li></ul></blockquote></li></ol><blockquote><p>能改变状态机状态的只有resolve按钮和reject按钮。<br>状态的变更是单向的：</p></blockquote><ul><li>从 <code>pending</code>（进行中）变为 <code>fulfilled</code>（已成功）</li><li>从 <code>pending</code>（进行中）变为 <code>rejected</code>（已失败）<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">resolve</span>() <span class="comment">// 状态：pending -&gt; fulfilled</span></span><br><span class="line">    <span class="title function_">reject</span>()  <span class="comment">// 这里的状态就无法改动了（反过来也是一样）</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li></ul><ol start="2"><li>then方法接收两个可选参数，分别对应状态改变时触发的回调。<br>then方法返回一个promise。<br>then 方法可以被同一个 promise 调用多次。<br><img src="/image/Promise%E5%88%86%E6%9E%90/1665061301763.png" alt="1665061301763"><blockquote><p>温馨提示：<br>有限状态机提供了一种优雅的解决方式，异步的处理本身可以通过异步状态的变化来触发相应的操作，这会比回调函数在逻辑上的处理更加合理，也可以降低代码的复杂度。</p></blockquote></li></ol><h2 id="Promise的流程图"><a href="#Promise的流程图" class="headerlink" title="Promise的流程图"></a>Promise的流程图</h2><p>从上面的 promise的使用 和 promise的三种状态，可以总结出以下的流程过程：<br><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9dfbc2602ecf413ea38c4b4786f288d3~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="10_02.png"></p><h2 id="Promise的缺点"><a href="#Promise的缺点" class="headerlink" title="Promise的缺点"></a>Promise的缺点</h2><ul><li>无法取消 <code>Promise</code>，一旦新建它就会立即执行，无法中途取消。</li><li>无法在 <code>Promise </code> 外部通过 <code>try...catch...</code> 的形式进行错误捕获（<code>Promise</code> 内部捕获了错误）</li><li>当处于pending（等待）状态时，无法得知目前进展到哪个阶段（刚开始&#x2F;即将完成）</li></ul><h2 id="Promise的传参"><a href="#Promise的传参" class="headerlink" title="Promise的传参"></a>Promise的传参</h2><p>ES6 中提供了一个构造函数 <code>Promise</code>, 也可以被称为一个类，需要通过 <code>new</code> 的方式来进行调用，生成一个实例对象。</p><ol><li>构造函数 <code>Promise</code> 接受一个回调函数作为参数，被称为 <code>executor</code>。该回调函数(executor) 会立即被执行，<strong>同步</strong>的表现方式。</li></ol><p>  const executor &#x3D; function() {<br>      console.log(‘executor函数会被立即执行’)<br>  }<br>  const promise &#x3D; new Promise(executor) &#x2F;&#x2F; 接受一个回调函数，立即执行，同步表现形式</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="number">2.</span> `<span class="language-javascript">executor</span>` 函数也接受两个回调函数作为参数，分别取名是：`<span class="language-javascript">resolve</span>` 和 `<span class="language-javascript">reject</span>`。这两个回调函数是内部实现的，对于**开发者**而言只需要调用即可。</span><br><span class="line">  &gt; * resolve将<span class="built_in">Promise</span>对象变为fulfilled状态</span><br><span class="line">  &gt; * reject将<span class="built_in">Promise</span>对象变为rejected状态</span><br><span class="line">  &gt; ```<span class="language-javascript"><span class="title class_">JavaScript</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> executor = <span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;executor函数会被立即执行&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 成功了调用resolve</span></span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">resolve</span>()</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 失败了调用reject</span></span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">reject</span>()</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(executor)</span></span><br></pre></td></tr></table></figure><p>  一般简写为：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promsie = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;executor函数会被立即执行&#x27;</span>)</span><br><span class="line">    <span class="comment">// 成功了调用resolve</span></span><br><span class="line">    <span class="title function_">resolve</span>()</span><br><span class="line">    <span class="comment">// 失败了调用reject</span></span><br><span class="line">    <span class="title function_">reject</span>()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="模拟promise源码的实现"><a href="#模拟promise源码的实现" class="headerlink" title="模拟promise源码的实现"></a>模拟promise源码的实现</h2><p>上面使用大量的回调函数作为参数，可能会看晕，那么使用 <code>class</code>来模拟 <code>promise</code>的源码，加深一下印象。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Promise</span> &#123;</span><br><span class="line">   <span class="title function_">constructor</span>(<span class="params">executor</span>) &#123;</span><br><span class="line">     <span class="keyword">const</span> resolve = <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;;</span><br><span class="line">     <span class="keyword">const</span> reject = <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;;</span><br><span class="line">     <span class="keyword">try</span> &#123;</span><br><span class="line">       <span class="title function_">executor</span>(resolve, reject); <span class="comment">// 调用executor函数，传递两个内部函数作为参数</span></span><br><span class="line">     &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">       <span class="comment">// 如果 executor 不是回调函数，报错</span></span><br><span class="line">       <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">`Promise resolver #&lt;<span class="subst">$&#123;<span class="keyword">typeof</span> executor&#125;</span>&gt; is not a function`</span>)</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="重要法则"><a href="#重要法则" class="headerlink" title="重要法则"></a>重要法则</h2><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">resolve——executor函数接受的第一个参数</button></li><li class="tab"><button type="button" data-href="#super-2">reject——executor函数的第二个参数</button></li><li class="tab"><button type="button" data-href="#super-3">实例方法——then方法</button></li><li class="tab"><button type="button" data-href="#super-4">catch</button></li><li class="tab"><button type="button" data-href="#super-5">finally</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>作用：将 <code>Promise</code>对象的状态从 <code>等待(pending) </code>变为 <code>成功(fulfilled)</code>。</p><p><code>resolve</code>接受一个参数，供调用then方法的时候使用。</p><p>参数分为三种：</p><ol><li>参数是<strong>一个普通的值或对象</strong></li><li>参数是<strong>promise</strong></li><li>参数是<strong>thenable对象</strong></li></ol><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">1. 普通值</button></li><li class="tab"><button type="button" data-href="#super-2">2. promise</button></li><li class="tab"><button type="button" data-href="#super-3">3. thenable方法</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>传入的普通值或对象作为then回调的参数。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// 1、数字</span></span><br><span class="line"> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="title function_">resolve</span>(<span class="number">231</span>)</span><br><span class="line"> &#125;).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(res) <span class="comment">// 231</span></span><br><span class="line"> &#125;)</span><br><span class="line"> </span><br><span class="line"> <span class="comment">// 2、字符串</span></span><br><span class="line"> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="title function_">resolve</span>(<span class="string">&#x27;copyer&#x27;</span>)</span><br><span class="line"> &#125;).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(res) <span class="comment">// copyer</span></span><br><span class="line"> &#125;)</span><br><span class="line"> </span><br><span class="line"> <span class="comment">// 3、对象（thenable对象除外）</span></span><br><span class="line"> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="title function_">resolve</span>(&#123; <span class="attr">name</span>: <span class="string">&quot;copyer&quot;</span> &#125;);</span><br><span class="line"> &#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(res); <span class="comment">// &#123;name: &#x27;copyer&#x27;&#125;</span></span><br><span class="line"> &#125;);</span><br><span class="line"> </span><br><span class="line"> <span class="comment">// 4、boolean</span></span><br><span class="line"> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="title function_">resolve</span>(<span class="literal">false</span>);</span><br><span class="line"> &#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(res); <span class="comment">// false</span></span><br><span class="line"> &#125;);</span><br><span class="line"> </span><br><span class="line"> <span class="comment">// 5、undefined</span></span><br><span class="line"> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="title function_">resolve</span>(<span class="literal">undefined</span>);</span><br><span class="line"> &#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(res); <span class="comment">// undefined</span></span><br><span class="line"> &#125;);</span><br><span class="line"> </span><br><span class="line"> <span class="comment">// 6、null</span></span><br><span class="line"> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="title function_">resolve</span>(<span class="literal">null</span>);</span><br><span class="line"> &#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(res); <span class="comment">// null</span></span><br><span class="line"> &#125;);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>当 <code>外promise</code>的 <code>resolve</code>的参数为 <code>promise</code>对象(<code>内promise</code>) 的时候，那么 <code>外promise </code>的状态是由 <code>内promise</code>所决定的。</p><ul><li>当 <code>内promise</code> 调用了<strong>resolve</strong>方法，<code>外promise</code>的状态变为 <strong>fulfilled</strong> ，成功回调。</li><li>当 <code>内promise</code> 调用了<strong>reject</strong>方法，<code>外promise</code>的状态变为 <strong>rejected</strong> , 失败回调。</li></ul><p>这里可以先使用 <code>then</code>方法来操作下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// 外promise</span></span><br><span class="line"> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="title function_">resolve</span>(p);</span><br><span class="line"> &#125;).<span class="title function_">then</span>(</span><br><span class="line">   <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;成功回调:&quot;</span>, res); </span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;失败回调:&quot;</span>, err);</span><br><span class="line">   &#125;</span><br><span class="line"> );</span><br><span class="line"> </span><br><span class="line"> <span class="comment">// 内promise</span></span><br><span class="line"> <span class="keyword">const</span> p = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="title function_">resolve</span>(<span class="string">&quot;success&quot;</span>);  <span class="comment">// 成功回调: success</span></span><br><span class="line"> &#125;);</span><br><span class="line"> <span class="keyword">const</span> p = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="title function_">reject</span>(<span class="string">&quot;failure&quot;</span>);  <span class="comment">// 失败回调: failure</span></span><br><span class="line"> &#125;);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>如果resolve中传入的是一个对象，并且这个对象有实现then方法，那么会执行该then方法，then方法会传入resolve、reject函数。此时的promise状态取决于调用了resolve还是reject函数。这种模式称之为thenable。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> thenable = &#123;</span><br><span class="line">  <span class="attr">then</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;thenable的方法会被执行&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">resolve</span>(thenable); <span class="comment">// 会执行对象中的then方法</span></span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;成功回调&quot;</span>, res);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>作用：将 <code>Promise</code>对象的状态从 <code>等待(pending)</code>变为 <code>成功(rejected)</code>。</p><p><code>reject</code>是一个表示失败的回调函数，接受<strong>一个任意类型</strong>的参数，在<strong>then的第二个回调函数</strong>中或则<strong>catch的回调函数</strong>中，拿到失败的结果。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方式一： catch的回调函数</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">reject</span>(<span class="string">&quot;reject不合格的原因&quot;</span>);  <span class="comment">// 1、传递一个不合格的原因</span></span><br><span class="line">&#125;).<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;   </span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(err); <span class="comment">// reject 不合格的原因</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方式二： then的第二个回调函数</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">reject</span>(<span class="string">&quot;reject不合格的原因&quot;</span>);  <span class="comment">// 1、传递一个不合格的原因</span></span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;&#125;, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(err) <span class="comment">// reject不合格原因</span></span><br><span class="line">&#125;) </span><br></pre></td></tr></table></figure><p>相对于 <code>resolve</code>接受的不同类型的参数，表现出不同的形式; <code>reject</code>就相当的简单一点，<code>reject</code>传递过去什么，接受到的值就是什么。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p><code>then</code>是 <code>promise</code>对象上的一个方法（准确的来说，是在 <code>promise </code>的原型 <code>Promise.prototype.then</code> ），供实例调用的。</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">接受两个参数</button></li><li class="tab"><button type="button" data-href="#super-2">then的多次调用</button></li><li class="tab"><button type="button" data-href="#super-3">then的返回值</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>在上面的 <code>resolve</code>，<code>reject</code>方法中，也提及到了 <code>then</code> 的大致使用，接受两个参数：</p><ul><li>参数一：回调函数，接受resolve的成功回调传递的值</li><li>参数二：回调函数，接受reject的失败回调传递的值</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">resolve</span>(<span class="string">&quot;成功的值&quot;</span>); <span class="comment">// 情况一</span></span><br><span class="line">  <span class="title function_">reject</span>(<span class="string">&quot;失败的值&quot;</span>);  <span class="comment">// 情况二</span></span><br><span class="line">&#125;).<span class="title function_">then</span>(</span><br><span class="line">  <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(res); <span class="comment">// 情况一： 成功的值</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(err); <span class="comment">// 情况二： 失败的值</span></span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>聊完了then的参数，接下来就来聊一聊then的其他特殊情况吧。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>这里的多次调用，并不是指的是链式调用（<strong>不同promise</strong>的实例），而是针对<strong>同一promise</strong>实例的then方法多次调用。</p><p>当执行resolve方法时，状态变为了 <strong>fulfilled</strong> ，then方法中的回调函数都会执行。（内部实现，就是then中的回调函数，存放在数组中，当状态变为fulfilled时，遍历数组，依次执行函数。）</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> p = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">resolve</span>(<span class="string">&quot;copyer&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">p.<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res);  <span class="comment">// copyer</span></span><br><span class="line">&#125;);</span><br><span class="line">p.<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res); <span class="comment">// copyer</span></span><br><span class="line">&#125;);</span><br><span class="line">p.<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res); <span class="comment">// copyer</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>示例：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> p = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">resolve</span>(<span class="string">&quot;copyer&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">p.<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res) <span class="comment">// copyer</span></span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res) <span class="comment">// undefined</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>在链式调用的时候，第二个then的 <code>res</code>为什么是 <code>undefined</code>?</p><p>先搞清楚一件事：</p><blockquote><p>为什么可以链式调用？<br><code>then</code>是promise原型上的方法，promise的实例可以调用。<br>当第二次继续调用then方法的时候，说明也是调用的promise的then方法，那就说明了两种情况：</p><ol><li>then的回调函数中返回了 <code>this</code>，promise的实例对象，可以调用then方法</li><li>then的回调函数返回了一个新的Promise实例，也是可以调用then方法的</li></ol><p>promise内部采用的是： <strong>第二种</strong> 。因为第一种是没有意义的，针对同一个promise，后面拿取的结果跟第一次拿取的结果是一样的。<br><strong>结论一：then方法的回调函数，返回一个promise</strong><br><strong>结论二：then方法的链式调用，是针对不同的promise（即每次都是一个新的promise）</strong></p></blockquote><p>知道了promise的链式调用的原理之后，就来看看返回值的类型吧。</p><p>then的返回值也是三种情况（跟 resolve 的三种情况是一样的）：</p><ul><li>普通的值</li><li>promise</li><li>thenable</li></ul><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">1. 普通的值</button></li><li class="tab"><button type="button" data-href="#super-2">2. promise</button></li><li class="tab"><button type="button" data-href="#super-3">3. thenable对象</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><ul><li>返回一个普通值，则相当于主动调用Promise.resolve。并且把返回值作为实参传递到then方法。</li><li>如果没有返回值，则相当于返回undefined。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 普通的值</span></span><br><span class="line"><span class="keyword">const</span> p = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">resolve</span>(<span class="string">&quot;copyer&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">p.<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res) <span class="comment">// copyer</span></span><br><span class="line">  <span class="comment">// 函数的默认返回值： undefined ====&gt; 被内部转化为 Promise.resolve(undefined)</span></span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res) <span class="comment">// undefined</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> p = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">resolve</span>(<span class="string">&quot;copyer&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">p.<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res) <span class="comment">// copyer</span></span><br><span class="line">  <span class="keyword">return</span> &#123;<span class="attr">name</span>: <span class="string">&#x27;james&#x27;</span>&#125; <span class="comment">// 被内部转化为 Promise.resolve(&#123;name: &#x27;james&#x27;&#125;)</span></span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res) <span class="comment">// &#123;name: &#x27;james&#x27;&#125;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>如果返回值，本身就是promise，直接根据返回的promise状态执行对应的成功回调resolve()还是失败回调reject()。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 成功回调</span></span><br><span class="line"><span class="keyword">const</span> p = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">resolve</span>(<span class="string">&quot;copyer&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">p.<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res) <span class="comment">// copyer</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="string">&#x27;返回值的new_promise_success&#x27;</span>)</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res) <span class="comment">// 返回值的new_promise_success</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 失败回调</span></span><br><span class="line"><span class="keyword">const</span> p = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">resolve</span>(<span class="string">&quot;copyer&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">p.<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res) <span class="comment">// copyer</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="string">&#x27;返回值的new_promise_failure&#x27;</span>)</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res) <span class="comment">// 这里不会执行，因为返回的promise状态为rejected</span></span><br><span class="line">&#125;, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(err) <span class="comment">// 返回值的new_promise_failure</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>返回一个thenable对象，其状态取决于你是调用了resolve还是reject。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> thenable = &#123;</span><br><span class="line">  <span class="attr">then</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;执行thenable对象中的then方法&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">resolve</span>(<span class="string">&#x27;copyer&#x27;</span>)</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res); <span class="comment">// copyer</span></span><br><span class="line">  <span class="keyword">return</span> thenable;</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res); <span class="comment">// 这里不会执行，会执行thenable对象的then方法</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p><code>catch</code>是 <code>promise</code>对象上的一个方法（准确的来说，是在 <code>promise</code>的原型 <strong>Promise.prototype.catch</strong> ），供实例调用的。用于拿取<strong>失败</strong>的信息。</p><p>简单使用：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">reject</span>(<span class="string">&quot;32132&quot;</span>);</span><br><span class="line">&#125;).<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(err); <span class="comment">// 32132</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>一般情况下，reject传递什么，catch就接受什么；但是如果reject的参数是一个promise的话，就影响catch的捕获异常。</p><h5 id="catch的捕获时机"><a href="#catch的捕获时机" class="headerlink" title="catch的捕获时机"></a>catch的捕获时机</h5><p>两个promise片段：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// params_promise</span></span><br><span class="line"><span class="keyword">const</span> p = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">resolve</span>(<span class="string">&#x27;2321&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// main_promise</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">reject</span>(p);</span><br><span class="line">&#125;).<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(err); <span class="comment">// 视情况而定</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ul><li>如果 <code>main_promise</code> 是 rejected 状态, <code>params_promise</code>是 fulfilled 状态，那么 catch 捕获的是 <code>main_promsie</code>的异常信息。</li><li>如果 <code>main_promise</code> 是 fulfilled 状态, <code>params_promise</code>是 rejected 状态，那么 catch 捕获的是 <code>params_promsie</code>的异常信息。</li><li>如果 <code>main_promise</code> 是 rejected 状态, <code>params_promise</code>是 rejected 状态，那么 catch 捕获的是 <code>main_promsie</code>的异常信息。</li></ul><p>从而可以知道： <strong>catch的捕获规则是是 <code>由外向内</code>的（<code>就远原则</code>），在依次执行代码的时候，如果遇到异常，就直捕获停止，不会向下再去捕获。</strong></p><p>catch的返回值还是一个promise，又开启一个新的流程了。</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">catch的多次调用</button></li><li class="tab"><button type="button" data-href="#super-2">super 2</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">const promise = <span class="keyword">new</span> Promise(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  reject(<span class="string">&#x27;ice error&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">promise.catch(<span class="function"><span class="params">err</span> =&gt;</span> <span class="built_in">console</span>.<span class="built_in">log</span>(err))</span><br><span class="line">promise.catch(<span class="function"><span class="params">err</span> =&gt;</span> <span class="built_in">console</span>.<span class="built_in">log</span>(err))</span><br><span class="line">promise.catch(<span class="function"><span class="params">err</span> =&gt;</span> <span class="built_in">console</span>.<span class="built_in">log</span>(err))</span><br><span class="line"></span><br><span class="line"><span class="comment">//ice error</span></span><br><span class="line"><span class="comment">//ice error</span></span><br><span class="line"><span class="comment">//ice error</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">返回一个普通对象</button></li><li class="tab"><button type="button" data-href="#super-2">明确返回一个promise</button></li><li class="tab"><button type="button" data-href="#super-3">返回thenble对象</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">reject</span>(<span class="string">&#x27;ice error&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">promise.<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> (&#123;<span class="attr">name</span>:<span class="string">&#x27;ice&#x27;</span>, <span class="attr">age</span>: <span class="number">22</span>&#125;)).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(res))</span><br><span class="line"></span><br><span class="line"><span class="comment">//&#123;name:&#x27;ice&#x27;, age: 22&#125;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">reject</span>(<span class="string">&#x27;ice error&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">promise.<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">reject</span>(<span class="string">&#x27;ice error promise&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">res</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(res))</span><br><span class="line"></span><br><span class="line"><span class="comment">//ice error promise</span></span><br><span class="line"></span><br><span class="line">此时<span class="keyword">new</span> <span class="title class_">Promise</span>() 调用了reject函数，则会被<span class="keyword">catch</span>捕获到</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">reject</span>(<span class="string">&#x27;ice error&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">promise.<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="title function_">then</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">      <span class="title function_">reject</span>(<span class="string">&#x27;ice error then&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">res</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(res))</span><br><span class="line"></span><br><span class="line"><span class="comment">//ice error then</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p><code>finally</code>是 <code>promise</code>对象上的一个方法（准确的来说，是在 <code>promise</code>的原型 <strong>Promise.prototype.finally</strong> ），供实例调用的。</p><p>finally 是ES9（ES2018）新增的一个特性。</p><p>finally 方法是不接收参数的。</p><p> <strong>无论promise的状态是fulfilled还是rejected，都会执行该方法</strong> 。返回值也是一个promise，可以链式调用。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">resolve</span>(p);</span><br><span class="line">&#125;).<span class="title function_">finally</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 执行</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">21321</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="string">&#x27;123&#x27;</span>)</span><br><span class="line">&#125;).<span class="title function_">finally</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 执行</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">231321321321</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ul><li><code>Promise.all</code>：适合多个异步任务并发执行但不允许其中任何一个任务失败</li><li><code>Promise.race</code> ：适合多个异步任务抢占式执行</li><li><code>Promise.allSettled</code> ：适合多个异步任务并发执行但允许某些任务失败</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="理解-Promise-的类方法-x2F-静态方法"><a href="#理解-Promise-的类方法-x2F-静态方法" class="headerlink" title="理解 Promise 的类方法&#x2F;静态方法"></a>理解 Promise 的类方法&#x2F;静态方法</h2><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">resolve</button></li><li class="tab"><button type="button" data-href="#super-2">reject</button></li><li class="tab"><button type="button" data-href="#super-3">all</button></li><li class="tab"><button type="button" data-href="#super-4">allSettled</button></li><li class="tab"><button type="button" data-href="#super-5">race</button></li><li class="tab"><button type="button" data-href="#super-6">any</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>类方法resolve方法其实跟executor方法中的resolve方法是一致的，并且情况都是等价的</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="string">&#x27;copyer&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 等价于</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">resolve</span>(<span class="string">&#x27;copyer&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>参数也分为三种情况：</p><ol><li>普通的值</li><li>promise</li><li>thenable对象</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>reject方法，会将Promise对象的状态设置为rejected状态。</p><p>Promise.reject的用法相当于 new Promise，然后调用reject</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="string">&#x27;copyer&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 等价于</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">reject</span>(<span class="string">&#x27;copyer&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>Promise.reject传入的参数无论时候什么类型，都会直接作为reject的参数传递到catch方法中。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>将多个Promise包裹成一个新的Promise，新的Promise的状态由包裹的Promise的状态共同决定。</p><ul><li>当所有的Promise的状态变为fulfilled时，新的Promise的状态为fulfilled，并且会将所有Promise的返回值组成一个数组。</li><li>当有一个Promise的状态为reject时，新的Promise的状态为reject，并且会将第一个reject的返回值作为参数。</li></ul><p> <strong>参数接受一个数组</strong> 。</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">正常情况</button></li><li class="tab"><button type="button" data-href="#super-2">少数情况一</button></li><li class="tab"><button type="button" data-href="#super-3">少数情况二</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>promise组成一个数组</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">resolve</span>(<span class="number">10</span>);</span><br><span class="line">  &#125;, <span class="number">10</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> p2 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">resolve</span>(<span class="number">20</span>);</span><br><span class="line">  &#125;, <span class="number">20</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> p3 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">resolve</span>(<span class="number">30</span>);</span><br><span class="line">  &#125;, <span class="number">30</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// p1、p2、p3组成一个数组</span></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">all</span>([p1, p2, p3]).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res); <span class="comment">// [10,20,30]</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>数组中包含数字，字符串等等其他类型</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Promise</span>.<span class="title function_">all</span>([<span class="number">1</span>, <span class="string">&quot;copyer&quot;</span>, p1]).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(res); <span class="comment">// [1, &#x27;copyer&#x27;, 10]</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>当all方法执行是，会遍历里面的数组，检查里面的item是不是promise对象，如果不是，就会转化成promise，比如</p><ul><li><code>1</code> 会被转化成 <code>Promise.resolve(1)</code></li><li><code>copyer</code> 会被转化成 <code>Promise.resolve(&#39;copyer&#39;)</code></li></ul><p>当每项都成为 promise对象之后，再来确定新的 promise 的状态。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>传递了一个thenable对象</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> thenable = &#123;</span><br><span class="line">  <span class="attr">then</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">321</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">all</span>([<span class="number">1</span>, thenable, p1]).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>会直接执行 thenable 对象中的then方法，不会执行promise中的then方法。</p><blockquote><p>解释说明：正常情况是在开发中常见的，少数情况是在开发中基本上不可见的</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>all方法有一个缺陷：当其中的一个Promise变成reject状态时，新Promise的状态也就变成了reject状态。</p><ul><li>对于一些已经resolved的结果，也是拿不到的。</li></ul><p>在ES11（ES2020）中，添加了一个新的API来解决此类问题，用法跟all基本上是一样的。</p><ul><li>该方法会在所有的Promise都有结果（settled），无论是fulfilled，还是reject时，才会有最终的状态，返回一个新的Promise。</li><li>并且这个Promise的结果一定是fulfilled的。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">resolve</span>(<span class="number">10</span>);</span><br><span class="line">  &#125;, <span class="number">10</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> p2 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">resolve</span>(<span class="number">20</span>);</span><br><span class="line">  &#125;, <span class="number">20</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> p3 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">reject</span>(<span class="number">30</span>);</span><br><span class="line">  &#125;, <span class="number">30</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">allSettled</span>([p1, p2, p3]).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res); </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>返回的格式：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123; <span class="attr">status</span>: <span class="string">&#x27;fulfilled&#x27;</span>, <span class="attr">value</span>: <span class="number">10</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">status</span>: <span class="string">&#x27;fulfilled&#x27;</span>, <span class="attr">value</span>: <span class="number">20</span> &#125;, <span class="comment">// 成功时value</span></span><br><span class="line">  &#123; <span class="attr">status</span>: <span class="string">&#x27;rejected&#x27;</span>, <span class="attr">reason</span>: <span class="number">30</span> &#125;  <span class="comment">// 失败是reason</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure><p><code>status</code>: 表示其中Promise的状态<br><code>value</code>: 成功的返回值<br><code>reason</code>: 失败的返回值</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p>如果有一个Promise有了结果，我们就希望决定最终新Promise的状态，那么可以使用race方法：</p><ul><li>race是竞技、竞赛的意思，表示多个Promise相互竞争，谁先有结果，那么就使用谁的结果</li><li>当数组中有一个对象resolve时，新对象状态变为fulfilled</li><li>当数组中有一个对象reject时，新对象状态变为rejected</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">resolve</span>(<span class="number">10</span>);</span><br><span class="line">  &#125;, <span class="number">10</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> p2 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">resolve</span>(<span class="number">20</span>);</span><br><span class="line">  &#125;, <span class="number">20</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> p3 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">resolve</span>(<span class="number">30</span>);</span><br><span class="line">  &#125;, <span class="number">30</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">race</span>([p1, p2, p3]).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res);  <span class="comment">// 10</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-6"><p>any方法是ES12中新增的方法，和all方法基本上相反。(还是实验性的语法，暂时没有被所有浏览器支持)。</p><p><code>MDN</code>对Promise.any的解释：</p><p><code>Promise.any()</code> 接收一个 <code>Promise</code>可迭代对象，只要其中的一个 <code>promise</code> 成功，就返回那个已经成功的 <code>promise</code> 。如果可迭代对象中没有一个 <code>promise</code> 成功（即所有的 <code>promises</code> 都失败&#x2F;拒绝），就返回一个失败的 <code>promise </code>和 <code>AggregateError</code>类型的实例。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promise1 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">reject</span>(<span class="string">&#x27;hi error&#x27;</span>)</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> promise2 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">resolve</span>(<span class="string">&#x27;hi panda&#x27;</span>)</span><br><span class="line">  &#125;, <span class="number">2000</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">any</span>([promise1, promise2])</span><br><span class="line">       .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(res))</span><br><span class="line">       .<span class="title function_">catch</span>(<span class="function"><span class="params">e</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(e))</span><br><span class="line">       </span><br><span class="line"><span class="comment">//hi panda</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="Promise实践方案"><a href="#Promise实践方案" class="headerlink" title="Promise实践方案"></a>Promise实践方案</h2><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">使用catch代替reject handler</button></li><li class="tab"><button type="button" data-href="#super-2">同步代码Promise化</button></li><li class="tab"><button type="button" data-href="#super-3">避免嵌套的Promise</button></li><li class="tab"><button type="button" data-href="#super-4">避免断链</button></li><li class="tab"><button type="button" data-href="#super-5">正确处理异步集合</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">fetch</span>(url).<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;error&#x27;</span>)</span><br><span class="line">&#125;，err =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(err)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>替换为</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">fetch</span>(url).<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;error&#x27;</span>)</span><br><span class="line">&#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(err)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>通过Promise.reslve()将同步代码Promise化</p><ul><li>更好的捕获错误</li><li>保证各种情况下处理方式一致</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getData</span> ()&#123;</span><br><span class="line">  <span class="keyword">const</span> data = <span class="variable constant_">CACHE</span>[<span class="string">&#x27;foo&#x27;</span>]</span><br><span class="line">  <span class="keyword">if</span> (data) &#123;</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/api/foo&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>替换为</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getData</span> () &#123;</span><br><span class="line">  <span class="keyword">const</span> data = <span class="variable constant_">CACHE</span>[<span class="string">&#x27;foo&#x27;</span>]</span><br><span class="line">  <span class="keyword">if</span> (data)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(data)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/api/foo&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">getData</span>().<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line"><span class="comment">// 处理结果</span></span><br><span class="line">&#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line"><span class="comment">// 处理异常</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>以链式回调的方式避免回调地狱问题</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">fetch</span>(url1).<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">fetch</span>(url2).<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 处理结果</span></span><br><span class="line">  &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 异常处理</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 异常处理</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>替换为</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">fetch</span>(url1).<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">fetch</span>(url2)</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 处理结果</span></span><br><span class="line">&#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 异常处理</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>保证链式调用，返回thenn方法返回的promise对象</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p>借助Promise.all()&#x2F;Promise.race()处理异步集合<br><code>const promiseArr=[Promise.resolve(1),Promise.resolve(2)]</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">promiseArr.<span class="title function_">forEach</span>(<span class="function"><span class="params">p</span>=&gt;</span></span><br><span class="line">  <span class="title function_">p</span>().<span class="title function_">then</span>(<span class="function"><span class="params">value</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 结果处理</span></span><br><span class="line">  &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 异常处理</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>替换为</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Promise</span>.<span class="title function_">all</span>(promiseArr).<span class="title function_">then</span>(<span class="function"><span class="params">resultArr</span> =&gt;</span></span><br><span class="line">  <span class="comment">// 结果处理</span></span><br><span class="line">&#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 异常处理</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="Promise的回调地狱-进阶"><a href="#Promise的回调地狱-进阶" class="headerlink" title="Promise的回调地狱 (进阶)"></a>Promise的回调地狱 (进阶)</h2><p>需求：</p><blockquote><p>当我发送网络请求的时候，需要拿到这次网络请求的数据，再发送网络请求，就这样重复三次，才能拿到我最终的结果。</p></blockquote><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">卧龙解法</button></li><li class="tab"><button type="button" data-href="#super-2">凤雏解法</button></li><li class="tab"><button type="button" data-href="#super-3">生成器+Promise解法</button></li><li class="tab"><button type="button" data-href="#super-4">自动化执行函数封装</button></li><li class="tab"><button type="button" data-href="#super-5">最终解决回调地狱的办法</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">requestData</span>(<span class="params">url</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (url.<span class="title function_">includes</span>(<span class="string">&#x27;iceweb&#x27;</span>)) &#123;</span><br><span class="line">        <span class="title function_">resolve</span>(url)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">reject</span>(<span class="string">&#x27;请求错误&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">requestData</span>(<span class="string">&#x27;iceweb.io&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">requestData</span>(<span class="string">`iceweb.org <span class="subst">$&#123;res&#125;</span>`</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">requestData</span>(<span class="string">`iceweb.com <span class="subst">$&#123;res&#125;</span>`</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//iceweb.com iceweb.org iceweb.io</span></span><br></pre></td></tr></table></figure><p>虽然能够实现，但是多层代码的嵌套，可读性非常差，我们把这种多层次代码嵌套称之为回调地狱</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">requestData</span>(<span class="params">url</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (url.<span class="title function_">includes</span>(<span class="string">&#x27;iceweb&#x27;</span>)) &#123;</span><br><span class="line">        <span class="title function_">resolve</span>(url)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">reject</span>(<span class="string">&#x27;请求错误&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">requestData</span>(<span class="string">&#x27;iceweb.io&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">requestData</span>(<span class="string">`iceweb.org <span class="subst">$&#123;res&#125;</span>`</span>)</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">requestData</span>(<span class="string">`iceweb.com <span class="subst">$&#123;res&#125;</span>`</span>)</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//iceweb.com iceweb.org iceweb.io</span></span><br></pre></td></tr></table></figure><p>利用了then链式调用这一特性，返回了一个新的promise，但是不够优雅，思考一下能不能写成同步的方式呢？</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">requestData</span>(<span class="params">url</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (url.<span class="title function_">includes</span>(<span class="string">&#x27;iceweb&#x27;</span>)) &#123;</span><br><span class="line">        <span class="title function_">resolve</span>(url)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">reject</span>(<span class="string">&#x27;请求错误&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span>* <span class="title function_">getData</span>(<span class="params">url</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> res1 = <span class="keyword">yield</span> <span class="title function_">requestData</span>(url)</span><br><span class="line">  <span class="keyword">const</span> res2 = <span class="keyword">yield</span> <span class="title function_">requestData</span>(res1)</span><br><span class="line">  <span class="keyword">const</span> res3 = <span class="keyword">yield</span> <span class="title function_">requestData</span>(res2)</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res3)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> generator = <span class="title function_">getData</span>(<span class="string">&#x27;iceweb.io&#x27;</span>)</span><br><span class="line"></span><br><span class="line">generator.<span class="title function_">next</span>().<span class="property">value</span>.<span class="title function_">then</span>(<span class="function"><span class="params">res1</span> =&gt;</span> &#123;</span><br><span class="line">  generator.<span class="title function_">next</span>(<span class="string">`iceweb.org <span class="subst">$&#123;res1&#125;</span>`</span>).<span class="property">value</span>.<span class="title function_">then</span>(<span class="function"><span class="params">res2</span> =&gt;</span> &#123;</span><br><span class="line">    generator.<span class="title function_">next</span>(<span class="string">`iceweb.com <span class="subst">$&#123;res2&#125;</span>`</span>).<span class="property">value</span>.<span class="title function_">then</span>(<span class="function"><span class="params">res3</span> =&gt;</span> &#123;</span><br><span class="line">      generator.<span class="title function_">next</span>(res3)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//iceweb.com iceweb.org iceweb.io</span></span><br></pre></td></tr></table></figure><p>大家可以发现我们的getData已经变为同步的形式，可以拿到我最终的结果了。那么很多同学会问，generator一直调用.next不是也产生了回调地狱吗？<br>其实不用关心这个，我们可以发现它这个是有规律的，我们可以封装成一个自动化执行的函数，我们就不用关心内部是如何调用的了。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">requestData</span>(<span class="params">url</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (url.<span class="title function_">includes</span>(<span class="string">&#x27;iceweb&#x27;</span>)) &#123;</span><br><span class="line">        <span class="title function_">resolve</span>(url)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">reject</span>(<span class="string">&#x27;请求错误&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span>* <span class="title function_">getData</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> res1 = <span class="keyword">yield</span> <span class="title function_">requestData</span>(<span class="string">&#x27;iceweb.io&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> res2 = <span class="keyword">yield</span> <span class="title function_">requestData</span>(<span class="string">`iceweb.org <span class="subst">$&#123;res1&#125;</span>`</span>)</span><br><span class="line">  <span class="keyword">const</span> res3 = <span class="keyword">yield</span> <span class="title function_">requestData</span>(<span class="string">`iceweb.com <span class="subst">$&#123;res2&#125;</span>`</span>)</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res3)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//自动化执行 async await相当于自动帮我们执行.next</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">asyncAutomation</span>(<span class="params">genFn</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> generator = <span class="title function_">genFn</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">_automation</span> = (<span class="params">result</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> nextData = generator.<span class="title function_">next</span>(result)</span><br><span class="line">    <span class="keyword">if</span>(nextData.<span class="property">done</span>) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    nextData.<span class="property">value</span>.<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">_automation</span>(res)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">_automation</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">asyncAutomation</span>(getData)</span><br><span class="line"></span><br><span class="line"><span class="comment">//iceweb.com iceweb.org iceweb.io</span></span><br></pre></td></tr></table></figure><p>利用promise+生成器的方式变相实现解决回调地狱问题，其实就是async await的一个变种而已<br>最早为TJ实现，前端大神人物<br>async await核心代码就类似这些，内部主动帮我们调用.next方法</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">requestData</span>(<span class="params">url</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (url.<span class="title function_">includes</span>(<span class="string">&#x27;iceweb&#x27;</span>)) &#123;</span><br><span class="line">        <span class="title function_">resolve</span>(url)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">reject</span>(<span class="string">&#x27;请求错误&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getData</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> res1 = <span class="keyword">await</span> <span class="title function_">requestData</span>(<span class="string">&#x27;iceweb.io&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> res2 = <span class="keyword">await</span> <span class="title function_">requestData</span>(<span class="string">`iceweb.org <span class="subst">$&#123;res1&#125;</span>`</span>)</span><br><span class="line">  <span class="keyword">const</span> res3 = <span class="keyword">await</span> <span class="title function_">requestData</span>(<span class="string">`iceweb.com <span class="subst">$&#123;res2&#125;</span>`</span>)</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res3)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">getData</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">//iceweb.com iceweb.org iceweb.io</span></span><br></pre></td></tr></table></figure><p>你会惊奇的发现，只要把getData生成器函数函数，改为async函数，yeild的关键字替换为await就可以实现异步代码同步写法了。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 异步编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ES6 </tag>
            
            <tag> Promise </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>深浅拷贝</title>
      <link href="/posts/e98504f5/"/>
      <url>/posts/e98504f5/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>参考文章：<br><a href="https://mp.weixin.qq.com/s/vXbFsG59L1Ba0DMcZeU2Bg">如何写出一个惊艳面试官的深拷贝</a><br><a href="https://segmentfault.com/a/1190000016672263">深拷贝的终极探索（99%的人都不知道）</a></p><h2 id="js的深浅拷贝"><a href="#js的深浅拷贝" class="headerlink" title="js的深浅拷贝"></a>js的深浅拷贝</h2><p>深拷贝：指针赋值，并且内容拷贝<br>浅拷贝：只是简单的指针赋值</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">浅拷贝</button></li><li class="tab"><button type="button" data-href="#super-2">深拷贝</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>创建一个新对象，这个对象有着原始对象属性值的一份精确拷贝。</p><blockquote><p>如果属性是基本类型，拷贝的就是基本类型的值<br>如果属性是引用类型，拷贝的就是内存地址<br>所以如果其中一个对象改变了这个地址，就会影响到另一个对象。</p></blockquote><ul><li><img src="https://mmbiz.qpic.cn/mmbiz_jpg/aDoYvepE5x0ocaqyO4ciaNVlImEC8SJEzfKK7pic7GXDhM7libYVqQna44ibBXE6Un7rbFV0UZuMIDm7eTRzjWgLHA/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>将一个对象从内存中完整的拷贝一份出来，从堆内存中开辟一个新的区域存放新对象，且修改新对象不会影响原对象。</p><ul><li><img src="https://mmbiz.qpic.cn/mmbiz_jpg/aDoYvepE5x0ocaqyO4ciaNVlImEC8SJEz6V6PGFiaNpSdicevict90bS8BdpGOmyicAIxLuaEGDuCxZiaRLQT8l7vTog/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">循环 + 递归</button></li><li class="tab"><button type="button" data-href="#super-2">jQuery.extend()</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">浅拷贝的实现方式</button></li><li class="tab"><button type="button" data-href="#super-2">深拷贝的实现方式</button></li><li class="tab"><button type="button" data-href="#super-3">终极版</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">简单版</button></li><li class="tab"><button type="button" data-href="#super-2">Object.assign()方法</button></li><li class="tab"><button type="button" data-href="#super-3">Array.prototype.slice()</button></li><li class="tab"><button type="button" data-href="#super-4">拓展运算符...</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>创建一个新的对象，遍历需要克隆的对象，将需要克隆对象的属性依次添加到新对象上，返回。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">shallowClone</span>(<span class="params">source</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> target = &#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i <span class="keyword">in</span> source) &#123;</span><br><span class="line">        <span class="keyword">if</span> (source.<span class="title function_">hasOwnProperty</span>(i)) &#123;</span><br><span class="line">            target[i] = source[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> target;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>用于将所有可枚举属性的值从一个或多个源对象复制到目标对象，返回目标对象。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>slice() 方法返回一个新的数组对象，这一对象是一个由 begin和end（不包括end）决定的原数组的浅拷贝。</p><blockquote><p>原始数组不会被改变。</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;Jake&quot;</span>,</span><br><span class="line">  <span class="attr">flag</span>: &#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="string">&quot;better day by day&quot;</span>,</span><br><span class="line">    <span class="attr">time</span>: <span class="string">&quot;2020-05-31&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> b = &#123;...a&#125;;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">乞丐版</button></li><li class="tab"><button type="button" data-href="#super-2">简单版</button></li><li class="tab"><button type="button" data-href="#super-3">兼容数组</button></li><li class="tab"><button type="button" data-href="#super-4">*解决循环引用问题*</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><code>JSON.parse(JSON.stringify());</code></p><blockquote><p>可以应对大部分的应用场景，<br>缺陷的：不适合拷贝其他引用类型、拷贝函数、循环引用等情况。</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>简单版深拷贝 &#x3D; 简单版浅拷贝 + 递归</p><blockquote><p>如果是原始类型，无需继续拷贝，直接返回<br>如果是引用类型，创建一个新的对象，遍历需要克隆的对象，将需要克隆对象的属性执行深拷贝后依次添加到新对象上。<br>只考虑了普通的 object</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">clone</span>(<span class="params">target</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> target === <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> cloneTarget = &#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> target) &#123;</span><br><span class="line">      cloneTarget[key] = <span class="title function_">clone</span>(target[key]);</span><br><span class="line">    &#125;   </span><br><span class="line">    <span class="keyword">return</span> cloneTarget;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;   </span><br><span class="line">    <span class="keyword">return</span> target;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">clone</span>(<span class="params">target</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (typeOf target === <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> cloneTarget = <span class="title class_">Array</span>.<span class="title function_">isArray</span>(target)?[]:&#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> target) &#123;</span><br><span class="line">      cloneTarget[key] = <span class="title function_">clone</span>(target[key]);l</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cloneTarget;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> target;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>额外开辟一个存储空间，来存储当前对象和拷贝对象的对应关系</p><blockquote><p>当需要拷贝当前对象时，先去存储空间中找，有没有拷贝过这个对象<br>如果有的话直接返回，如果没有的话继续拷贝，这样就巧妙化解的循环引用的问题。<br>这个存储空间，需要可以存储 key-value形式的数据，且 key 可以是一个引用类型</p></blockquote><ul><li>检查map中有无克隆过的对象</li><li>有 - 直接返回</li><li>没有 - 将当前对象作为key，克隆对象作为value进行存储</li><li>继续克隆</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">cloneDeep</span>(<span class="params">target, map = <span class="keyword">new</span> <span class="built_in">WeakMap</span>()</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span>(typeOf target === <span class="string">&#x27;object&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> cloneTarget = <span class="title class_">Array</span>.<span class="title function_">isArray</span>(target) ? [] : &#123;&#125;;</span><br><span class="line">    <span class="keyword">if</span>(map.<span class="title function_">get</span>(target)) &#123;</span><br><span class="line">      <span class="keyword">return</span> target;</span><br><span class="line">    &#125;</span><br><span class="line">    map.<span class="title function_">set</span>(target, cloneTarget);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">const</span> key <span class="keyword">in</span> target)&#123;</span><br><span class="line">      cloneTarget[key] = <span class="title function_">cloneDeep</span>(target[key], map);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cloneTarget;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> target;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  可继续遍历的数据类型</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">const</span> mapTag = <span class="string">&#x27;[object Map]&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> setTag = <span class="string">&#x27;[object Set]&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> arrayTag = <span class="string">&#x27;[object Array]&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> objectTag = <span class="string">&#x27;[object Object]&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> argsTag = <span class="string">&#x27;[object Arguments]&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  不可继续遍历的数据类型</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">const</span> boolTag = <span class="string">&#x27;[object Boolean]&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> dateTag = <span class="string">&#x27;[object Date]&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> numberTag = <span class="string">&#x27;[object Number]&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> stringTag = <span class="string">&#x27;[object String]&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> symbolTag = <span class="string">&#x27;[object Symbol]&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> errorTag = <span class="string">&#x27;[object Error]&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> regexpTag = <span class="string">&#x27;[object RegExp]&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> funcTag = <span class="string">&#x27;[object Function]&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> deepTag = [mapTag, setTag, arrayTag, objectTag, argsTag];</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  工具函数-通用while循环</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">forEach</span>(<span class="params">array, iteratee</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> index = -<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">const</span> length = array.<span class="property">length</span>;</span><br><span class="line">  <span class="keyword">while</span> (++index &lt; length) &#123;</span><br><span class="line">    <span class="title function_">iteratee</span>(array[index], index);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> array;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  工具函数-判断是否为引用类型</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isObject</span>(<span class="params">target</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> type = <span class="keyword">typeof</span> target;</span><br><span class="line">  <span class="keyword">return</span> target !== <span class="literal">null</span> &amp;&amp; (type === <span class="string">&#x27;object&#x27;</span> || type === <span class="string">&#x27;function&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  工具函数-获取实际类型</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getType</span>(<span class="params">target</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(target);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  工具函数-初始化被克隆的对象</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getInit</span>(<span class="params">target</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="title class_">Ctor</span> = target.<span class="property">constructor</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Ctor</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  工具函数-克隆Symbol</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">cloneSymbol</span>(<span class="params">target</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Object</span>(<span class="title class_">Symbol</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">valueOf</span>.<span class="title function_">call</span>(target));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  工具函数-克隆正则表达式</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">cloneReg</span>(<span class="params">target</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> reFlags = <span class="regexp">/\w$/</span>;</span><br><span class="line">  <span class="keyword">const</span> result = <span class="keyword">new</span> target.<span class="title function_">constructor</span>(<span class="params">target.source, reFlags.exec(target)</span>);</span><br><span class="line">  result.<span class="property">lastIndex</span> = target.<span class="property">lastIndex</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  工具函数-克隆函数</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">cloneFunction</span>(<span class="params">func</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> bodyReg = <span class="regexp">/(?&lt;=&#123;)(.|\n)+(?=&#125;)/m</span>;</span><br><span class="line">  <span class="keyword">const</span> paramReg = <span class="regexp">/(?&lt;=\().+(?=\)\s+&#123;)/</span>;</span><br><span class="line">  <span class="keyword">const</span> funcString = func.<span class="title function_">toString</span>();</span><br><span class="line">  <span class="keyword">if</span> (func.<span class="property"><span class="keyword">prototype</span></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> param = paramReg.<span class="title function_">exec</span>(funcString);</span><br><span class="line">    <span class="keyword">const</span> body = bodyReg.<span class="title function_">exec</span>(funcString);</span><br><span class="line">    <span class="keyword">if</span> (body) &#123;</span><br><span class="line">      <span class="keyword">if</span> (param) &#123;</span><br><span class="line">        <span class="keyword">const</span> paramArr = param[<span class="number">0</span>].<span class="title function_">split</span>(<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Function</span>(...paramArr, body[<span class="number">0</span>]);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Function</span>(body[<span class="number">0</span>]);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">eval</span>(funcString);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  工具函数-克隆其余不可遍历的普通数据类型</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">cloneOtherType</span>(<span class="params">target, type</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="title class_">Ctor</span> = target.<span class="property">constructor</span>;</span><br><span class="line">  <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="attr">boolTag</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="attr">numberTag</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="attr">stringTag</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="attr">errorTag</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="attr">dateTag</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Ctor</span>(target);</span><br><span class="line">    <span class="keyword">case</span> <span class="attr">regexpTag</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">cloneReg</span>(target);</span><br><span class="line">    <span class="keyword">case</span> <span class="attr">symbolTag</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">cloneSymbol</span>(target);</span><br><span class="line">    <span class="keyword">case</span> <span class="attr">funcTag</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">cloneFunction</span>(target);</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">clone</span>(<span class="params">target, map = <span class="keyword">new</span> <span class="built_in">WeakMap</span>()</span>) &#123;</span><br><span class="line">  <span class="comment">// 克隆原始类型</span></span><br><span class="line">  <span class="keyword">if</span> (!<span class="title function_">isObject</span>(target)) &#123;</span><br><span class="line">    <span class="keyword">return</span> target;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 初始化</span></span><br><span class="line">  <span class="keyword">const</span> type = <span class="title function_">getType</span>(target);</span><br><span class="line">  <span class="keyword">let</span> cloneTarget;</span><br><span class="line">  <span class="keyword">if</span> (deepTag.<span class="title function_">includes</span>(type)) &#123;</span><br><span class="line">    cloneTarget = <span class="title function_">getInit</span>(target, type);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">cloneOtherType</span>(target, type);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 防止循环引用</span></span><br><span class="line">  <span class="keyword">if</span> (map.<span class="title function_">get</span>(target)) &#123;</span><br><span class="line">    <span class="keyword">return</span> map.<span class="title function_">get</span>(target);</span><br><span class="line">  &#125;</span><br><span class="line">  map.<span class="title function_">set</span>(target, cloneTarget);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 克隆set</span></span><br><span class="line">  <span class="keyword">if</span> (type === setTag) &#123;</span><br><span class="line">    target.<span class="title function_">forEach</span>(<span class="function"><span class="params">value</span> =&gt;</span> &#123;</span><br><span class="line">      cloneTarget.<span class="title function_">add</span>(<span class="title function_">clone</span>(value, map));</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> cloneTarget;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 克隆map</span></span><br><span class="line">  <span class="keyword">if</span> (type === mapTag) &#123;</span><br><span class="line">    target.<span class="title function_">forEach</span>(<span class="function">(<span class="params">value, key</span>) =&gt;</span> &#123;</span><br><span class="line">      cloneTarget.<span class="title function_">set</span>(key, <span class="title function_">clone</span>(value, map));</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> cloneTarget;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 克隆对象和数组</span></span><br><span class="line">  <span class="keyword">const</span> keys = type === arrayTag ? <span class="literal">undefined</span> : <span class="title class_">Object</span>.<span class="title function_">keys</span>(target);</span><br><span class="line">  <span class="title function_">forEach</span>(keys || target, <span class="function">(<span class="params">value, key</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (keys) &#123;</span><br><span class="line">      key = value;</span><br><span class="line">    &#125;</span><br><span class="line">    cloneTarget[key] = <span class="title function_">clone</span>(target[key], map);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> cloneTarget;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  clone</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><h2 id="深浅拷贝"><a href="#深浅拷贝" class="headerlink" title="深浅拷贝"></a>深浅拷贝</h2><p>jQuery.extend() 函数用于将一个或多个对象的内容合并到目标对象。<br>语法：jQuery.extend( [deep], target, object1 [, objectN] )</p><ul><li>[deep]：可选（true或false），对应深浅拷贝；<blockquote><p>默认情况是false（浅拷贝），并且false是不能够显示的写出来的。如果想写，只能写true（深拷贝）</p></blockquote></li><li>target：目标对象（Object类型），其他对象的成员属性将被附加到该对象上。</li><li>object1：可选（Object类型），第一个被合并的对象。</li><li>objectN：可选（Object类型），第N个被合并的对象。</li></ul><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">浅拷贝</button></li><li class="tab"><button type="button" data-href="#super-2">深拷贝</button></li><li class="tab"><button type="button" data-href="#super-3">jQuery源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 浅拷贝</span></span><br><span class="line"><span class="keyword">var</span> defaults = &#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&quot;张三&quot;</span>,</span><br><span class="line">    <span class="attr">age</span>:<span class="number">18</span>,</span><br><span class="line">    <span class="attr">sex</span>:<span class="string">&quot;true&quot;</span>,</span><br><span class="line">    <span class="attr">scores</span>:&#123;</span><br><span class="line">        <span class="title class_">Chinese</span>:<span class="number">70</span>,</span><br><span class="line">        <span class="title class_">Science</span>:<span class="number">100</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> options = &#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&quot;李四&quot;</span>,</span><br><span class="line">    <span class="attr">age</span>:<span class="number">20</span>,</span><br><span class="line">    <span class="attr">scores</span>:&#123;</span><br><span class="line">        <span class="title class_">Chinese</span>:<span class="number">98</span>,</span><br><span class="line">        <span class="title class_">Math</span>:<span class="number">99</span>,</span><br><span class="line">        <span class="title class_">English</span>:<span class="number">100</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> settings = jQuery.<span class="title function_">extend</span>(defaults, options);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(defaults);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(options);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(settings);</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdn.net/20180816112106619?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2JzZnpfMjAxOA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="结果为："><br>可以发现原对象发生改变<br>规则：a对象和b对象相同的部分，b覆盖a，不同的部分，a保留，b追加到a中</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 深拷贝</span></span><br><span class="line"><span class="keyword">var</span> settings = $.extend(<span class="literal">true</span>,defaults,options);</span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(defaults);</span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(options);</span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(settings);</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdn.net/20180816111910420?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2JzZnpfMjAxOA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="结果为："><br>结果可以发现b不是像浅拷贝一样属性中的对象分数完全被覆盖，而是分数对象中的属性b覆盖a中相同的，b不同的追加，a中的保留<br>规则：保存到新对象，不改变a对象的值</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> settings = $.<span class="title function_">extend</span>(<span class="literal">true</span>,&#123;&#125;,defaults,options);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(defaults);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(options);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(settings);</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdn.net/20180816112419888?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2JzZnpfMjAxOA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br>可以看出a对象没有发生改变，不同于上面第二个例子，即单纯的深度拷贝。这个例子的结果即是新对象{}被填充数据的结果</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">jQuery.<span class="property">extend</span> = jQuery.<span class="property">fn</span>.<span class="property">extend</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">var</span> options, name, src, copy, copyIsArray, clone,</span><br><span class="line">        target = <span class="variable language_">arguments</span>[<span class="number">0</span>] || &#123;&#125;,</span><br><span class="line">        i = <span class="number">1</span>,</span><br><span class="line">        length = <span class="variable language_">arguments</span>.<span class="property">length</span>,</span><br><span class="line">        deep = <span class="literal">false</span>;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    变量 options      指向某个源对象。</span></span><br><span class="line"><span class="comment">    变量 name         表示某个源对象的某个属性名。</span></span><br><span class="line"><span class="comment">    变量 src          表示目标对象的某个属性的原始值。</span></span><br><span class="line"><span class="comment">    变量 copy         表示某个源对象的某个属性的值。</span></span><br><span class="line"><span class="comment">    变量 copyIsArray  指示变量 copy 是否是数组。</span></span><br><span class="line"><span class="comment">    变量 clone        表示深度复制时原始值的修正值。</span></span><br><span class="line"><span class="comment">    变量 target       指向目标对象,申明时先临时用第一个参数值。</span></span><br><span class="line"><span class="comment">    变量 i            表示源对象的起始下标，申明时先临时用第二个参数值。</span></span><br><span class="line"><span class="comment">    变量 length       表示参数的个数，用于修正变量 target。</span></span><br><span class="line"><span class="comment">    变量 deep         指示是否执行深度复制，默认为 false，即浅拷贝。</span></span><br><span class="line"><span class="comment">    ps：</span></span><br><span class="line"><span class="comment">    源对象指的是把自己的值付给别人的对象；</span></span><br><span class="line"><span class="comment">    目标对象指的是被源对象赋值的对象。</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">// 如果第一个参数传入的是布尔值</span></span><br><span class="line">    <span class="comment">// 用于判断是 深拷贝 还是 浅拷贝 </span></span><br><span class="line">    <span class="keyword">if</span> ( <span class="keyword">typeof</span> target === <span class="string">&quot;boolean&quot;</span> ) &#123;</span><br><span class="line">        <span class="comment">// 设置deep变量，确定是深拷贝还是浅拷贝</span></span><br><span class="line">        deep = target;</span><br><span class="line">        <span class="comment">// 将目标对象设为第二个参数值。</span></span><br><span class="line">        target = <span class="variable language_">arguments</span>[<span class="number">1</span>] || &#123;&#125;;</span><br><span class="line">        <span class="comment">// 源对象的起始下标设为2（即从第三个参数开始处理源对象）</span></span><br><span class="line">        i = <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// Handle case when target is a string or something (possible in deep copy)</span></span><br><span class="line">    <span class="keyword">if</span> ( <span class="keyword">typeof</span> target !== <span class="string">&quot;object&quot;</span> &amp;&amp; !jQuery.<span class="title function_">isFunction</span>(target) ) &#123;</span><br><span class="line">        target = &#123;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// 如果没有目标对象，那么目标对象就是jQuery对象</span></span><br><span class="line">    <span class="keyword">if</span> ( length === i ) &#123;</span><br><span class="line">        target = <span class="variable language_">this</span>;</span><br><span class="line">        --i;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// 拷贝的核心部分代码</span></span><br><span class="line">    <span class="comment">// 遍历源对象</span></span><br><span class="line">    <span class="keyword">for</span> ( ; i &lt; length; i++ ) &#123;</span><br><span class="line">        <span class="comment">// Only deal with non-null/undefined values</span></span><br><span class="line">        <span class="keyword">if</span> ( (options = <span class="variable language_">arguments</span>[ i ]) != <span class="literal">null</span> ) &#123;<span class="comment">//options就是源对象</span></span><br><span class="line">            <span class="comment">// Extend the base object</span></span><br><span class="line">            <span class="comment">// 遍历源对象的属性名</span></span><br><span class="line">            <span class="keyword">for</span> ( name <span class="keyword">in</span> options ) &#123;</span><br><span class="line">                <span class="comment">// 获取目标对象上，属性名对应的属性</span></span><br><span class="line">                src = target[ name ];</span><br><span class="line">                <span class="comment">// 获取源对象上，属性名对应的属性</span></span><br><span class="line">                copy = options[ name ];</span><br><span class="line"> </span><br><span class="line">                <span class="comment">// 如果复制值copy 与目标对象target相等，</span></span><br><span class="line">                <span class="comment">// 为了避免深度遍历时陷入死循环，因此不会覆盖目标对象的同名属性。</span></span><br><span class="line">                <span class="keyword">if</span> ( target === copy ) &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line"> </span><br><span class="line">                <span class="comment">// 递归地将源对象上的属性值合并到目标对象上</span></span><br><span class="line">                <span class="comment">/*</span></span><br><span class="line"><span class="comment">                    如果是深拷贝，且待拷贝的对象存在，且是普通对象或是数组</span></span><br><span class="line"><span class="comment">                    这一个判断条件非常关键，这正是之前疑问的症结</span></span><br><span class="line"><span class="comment">                    1、普通对象的定义是：通过 &quot;&#123;&#125;&quot; 或者 &quot;new Object&quot; 创建</span></span><br><span class="line"><span class="comment">                    2、目标对象tobeCloned的属性o对象的obj不是普通对象，也不是数组，所以程序不会走到下面的分支</span></span><br><span class="line"><span class="comment">                */</span></span><br><span class="line">                <span class="keyword">if</span> ( deep &amp;&amp; copy &amp;&amp; ( jQuery.<span class="title function_">isPlainObject</span>(copy) || (copyIsArray = jQuery.<span class="title function_">isArray</span>(copy)) ) ) &#123;</span><br><span class="line">                    <span class="keyword">if</span> ( copyIsArray ) &#123;</span><br><span class="line">                        <span class="comment">// 如果是数组</span></span><br><span class="line">                        copyIsArray = <span class="literal">false</span>;</span><br><span class="line">                        clone = src &amp;&amp; jQuery.<span class="title function_">isArray</span>(src) ? src : [];</span><br><span class="line"> </span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        clone = src &amp;&amp; jQuery.<span class="title function_">isPlainObject</span>(src) ? src : &#123;&#125;;</span><br><span class="line">                    &#125;</span><br><span class="line"> </span><br><span class="line">                    <span class="comment">// 递归地拷贝</span></span><br><span class="line">                    target[ name ] = jQuery.<span class="title function_">extend</span>( deep, clone, copy );</span><br><span class="line"> </span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> ( copy !== <span class="literal">undefined</span> ) &#123;</span><br><span class="line">                <span class="comment">// 这个分支的处理很暴力：把源对象的属性，直接赋给源对象。</span></span><br><span class="line">                <span class="comment">// 对于上文中tobeCloned对象的属性o，没有进一步递归地拷贝，而是直接把引用赋给源对象</span></span><br><span class="line">                <span class="comment">// 所以改变tobeCloned的o属性时，目标对象的o属性也被改变了。</span></span><br><span class="line">                    target[ name ] = copy;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// Return the modified object</span></span><br><span class="line">    <span class="keyword">return</span> target;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>总结：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> q = jQuery.<span class="title function_">extend</span>(<span class="literal">true</span>,&#123;&#125;,m,n);     <span class="comment">// 深拷贝 新建一个Object。</span></span><br><span class="line"><span class="keyword">var</span> q = jQuery.<span class="title function_">extend</span>(<span class="literal">false</span>,&#123;&#125;,m,n);    <span class="comment">// 浅拷贝 新建一个Object。</span></span><br><span class="line"><span class="keyword">var</span> q = jQuery.<span class="title function_">extend</span>(<span class="literal">true</span>,m,n)         <span class="comment">// 合并到m中并赋给q，m改变，q改变；n改变，q不变  </span></span><br><span class="line"><span class="keyword">var</span> q = jQuery.<span class="title function_">extend</span>(<span class="literal">false</span>,m,n)        <span class="comment">// q只与n完全一致，n改变，q改变   </span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ES6 </tag>
            
            <tag> 深/浅拷贝 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JS异步编程</title>
      <link href="/posts/a91625c/"/>
      <url>/posts/a91625c/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>异步API</p><h2 id="简单对比Callback、Promise、Generator、Async几个异步API的优劣"><a href="#简单对比Callback、Promise、Generator、Async几个异步API的优劣" class="headerlink" title="简单对比Callback、Promise、Generator、Async几个异步API的优劣"></a>简单对比Callback、Promise、Generator、Async几个异步API的优劣</h2><p>在 JavaScript 中利用<a href="https://juejin.cn/post/6844903843197616136#heading-3" title="https://juejin.cn/post/6844903843197616136#heading-3">事件循环机制</a>（Event Loop）可以在单线程中实现非阻塞式、异步的操作。例如</p><ul><li>Node.js 中的 Callback、<a href="https://link.juejin.cn/?target=http://nodejs.cn/api/events.html%23events_class_eventemitter" title="http://nodejs.cn/api/events.html#events_class_eventemitter">EventEmitter</a>、<a href="https://link.juejin.cn/?target=http://nodejs.cn/api/stream.html" title="http://nodejs.cn/api/stream.html">Stream</a></li><li>ES6 中的 <a href="https://link.juejin.cn/?target=https://es6.ruanyifeng.com/%23docs/promise" title="https://es6.ruanyifeng.com/#docs/promise">Promise</a>、<a href="https://link.juejin.cn/?target=https://es6.ruanyifeng.com/%23docs/generator-async" title="https://es6.ruanyifeng.com/#docs/generator-async">Generator</a></li><li>ES2017 中的 <a href="https://link.juejin.cn/?target=https://es6.ruanyifeng.com/%23docs/async" title="https://es6.ruanyifeng.com/#docs/async">Async</a></li><li>三方库 RxJS、<a href="https://link.juejin.cn/?target=https://github.com/kriskowal/q" title="https://github.com/kriskowal/q">Q</a> 、<a href="https://link.juejin.cn/?target=https://github.com/tj/co" title="https://github.com/tj/co">Co、</a><a href="https://link.juejin.cn/?target=https://github.com/petkaantonov/bluebird" title="https://github.com/petkaantonov/bluebird">Bluebird</a></li></ul><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">Callback(回调)函数</button></li><li class="tab"><button type="button" data-href="#super-2">Promise及手写实现方式</button></li><li class="tab"><button type="button" data-href="#super-3">Generator函数及其作用</button></li><li class="tab"><button type="button" data-href="#super-4">Async/await及其工作方式</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>Callback（回调函数）是在 Web 前端开发中经常会使用的编程方式。它作为一个参数传递给其他的代码，其作用是在需要的时候方便调用这段（回调函数）代码。<br><strong>案例如下：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> interface <span class="title class_">IObj</span> &#123;</span><br><span class="line">  <span class="attr">value</span>: string;</span><br><span class="line">  <span class="title function_">deferExec</span>(): <span class="keyword">void</span>;</span><br><span class="line">  <span class="title function_">deferExecAnonymous</span>(): <span class="keyword">void</span>;</span><br><span class="line">  <span class="title function_">console</span>(): <span class="keyword">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">obj</span>: <span class="title class_">IObj</span> = &#123;</span><br><span class="line">  <span class="attr">value</span>: <span class="string">&#x27;hello&#x27;</span>,</span><br><span class="line"></span><br><span class="line">  <span class="title function_">deferExecBind</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 使用箭头函数可达到一样的效果</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="variable language_">this</span>.<span class="property">console</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>), <span class="number">1000</span>);</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="title function_">deferExec</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="variable language_">this</span>.<span class="property">console</span>, <span class="number">1000</span>);</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="title function_">console</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">value</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">obj.<span class="title function_">deferExecBind</span>(); <span class="comment">// hello</span></span><br><span class="line">obj.<span class="title function_">deferExec</span>(); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure><p>回调函数经常会因为调用环境的变化而导致 <code>this</code> 的指向性变化。除此之外，使用回调函数来处理多个继发的异步任务时容易导致回调地狱（Callback Hell）:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">fs.<span class="title function_">readFile</span>(fileA, <span class="string">&#x27;utf-8&#x27;</span>, <span class="keyword">function</span> (<span class="params">err, data</span>) &#123;</span><br><span class="line">  fs.<span class="title function_">readFile</span>(fileB, <span class="string">&#x27;utf-8&#x27;</span>, <span class="keyword">function</span> (<span class="params">err, data</span>) &#123;</span><br><span class="line">    fs.<span class="title function_">readFile</span>(fileC, <span class="string">&#x27;utf-8&#x27;</span>, <span class="keyword">function</span> (<span class="params">err, data</span>) &#123;</span><br><span class="line">      fs.<span class="title function_">readFile</span>(fileD, <span class="string">&#x27;utf-8&#x27;</span>, <span class="keyword">function</span> (<span class="params">err, data</span>) &#123;</span><br><span class="line">        <span class="comment">// 假设在业务中 fileD 的读写依次依赖 fileA、fileB 和 fileC</span></span><br><span class="line">        <span class="comment">// 或者经常也可以在业务中看到多个 HTTP 请求的操作有前后依赖（继发 HTTP 请求）</span></span><br><span class="line">        <span class="comment">// 这些异步任务之间纵向嵌套强耦合，无法进行横向复用</span></span><br><span class="line">        <span class="comment">// 如果某个异步发生变化，那它的所有上层或下层回调可能都需要跟着变化（比如 fileA 和 fileB 的依赖关系倒置）</span></span><br><span class="line">        <span class="comment">// 因此称这种现象为 回调地狱</span></span><br><span class="line">        <span class="comment">// ....</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>回调函数不能通过 <code>return</code> 返回数据，比如我们希望调用带有回调参数的函数并返回异步执行的结果时，只能通过再次回调的方式进行参数传递：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 希望延迟 3s 后执行并拿到结果</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getAsyncResult</span>(<span class="params">result: number</span>) &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> result * <span class="number">3</span>;</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 尽管这是常规的编程思维方式</span></span><br><span class="line"><span class="keyword">const</span> result = <span class="title function_">getAsyncResult</span>(<span class="number">3000</span>);</span><br><span class="line"><span class="comment">// 但是打印 undefined</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;result: &#x27;</span>, result);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getAsyncResultWithCb</span>(<span class="params">result: number, cb: (result: number) =&gt; <span class="keyword">void</span></span>) &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">cb</span>(result * <span class="number">3</span>);</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过回调的形式获取结果</span></span><br><span class="line"><span class="title function_">getAsyncResultWithCb</span>(<span class="number">3000</span>, <span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;result: &#x27;</span>, result); <span class="comment">// 9000</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>对于 JavaScript 中标准的异步 API 可能无法通过在外部进行 <code>try...catch...</code> 的方式进行错误捕获：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 下述是异常代码</span></span><br><span class="line">    <span class="comment">// 你可以在回调函数的内部进行 try...catch...</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(a.<span class="property">b</span>.<span class="property">c</span>)</span><br><span class="line">  &#125;, <span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">  <span class="comment">// 这里不会执行</span></span><br><span class="line">  <span class="comment">// 进程会被终止</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">error</span>(err)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上述示例讲述的都是 JavaScript 中标准的异步 API ，如果使用一些三方的异步 API 并且提供了回调能力时，这些 API 可能是非受信的，在真正使用的时候会因为 <strong>执行反转</strong> （回调函数的执行权在三方库中）导致以下一些问题：</p><ul><li>使用者的回调函数设计没有进行错误捕获，而恰恰三方库进行了错误捕获却没有抛出错误处理信息，此时使用者很难感知到自己设计的回调函数是否有错误</li><li>使用者难以感知到三方库的回调时机和回调次数，这个回调函数执行的权利控制在三方库手中</li><li>使用者无法更改三方库提供的回调参数，回调参数可能无法满足使用者的诉求</li></ul><p>举个简单的例子：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">interface <span class="title class_">ILib</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="attr">params</span>: T;</span><br><span class="line">  <span class="title function_">emit</span>(<span class="attr">params</span>: T): <span class="keyword">void</span>;</span><br><span class="line">  <span class="title function_">on</span>(<span class="attr">callback</span>: <span class="function">(<span class="params">params: T</span>) =&gt;</span> <span class="keyword">void</span>): <span class="keyword">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 假设以下是一个三方库，并发布成了npm 包</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">lib</span>: <span class="title class_">ILib</span>&lt;string&gt; = &#123;</span><br><span class="line">  <span class="attr">params</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line"></span><br><span class="line">  <span class="title function_">emit</span>(<span class="params">params</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">params</span> = params;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="title function_">on</span>(<span class="params">callback</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// callback 回调执行权在 lib 上</span></span><br><span class="line">      <span class="comment">// lib 库可以决定回调执行多次</span></span><br><span class="line">      <span class="title function_">callback</span>(<span class="variable language_">this</span>.<span class="property">params</span>);</span><br><span class="line">      <span class="title function_">callback</span>(<span class="variable language_">this</span>.<span class="property">params</span>);</span><br><span class="line">      <span class="title function_">callback</span>(<span class="variable language_">this</span>.<span class="property">params</span>);</span><br><span class="line">      <span class="comment">// lib 库甚至可以决定回调延迟执行</span></span><br><span class="line">      <span class="comment">// 异步执行回调函数</span></span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">callback</span>(<span class="variable language_">this</span>.<span class="property">params</span>);</span><br><span class="line">      &#125;, <span class="number">3000</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">      <span class="comment">// 假设 lib 库的捕获没有抛出任何异常信息</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 开发者引入 lib 库开始使用</span></span><br><span class="line">lib.<span class="title function_">emit</span>(<span class="string">&#x27;hello&#x27;</span>);</span><br><span class="line"></span><br><span class="line">lib.<span class="title function_">on</span>(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 使用者希望 on 里的回调只执行一次</span></span><br><span class="line"><span class="comment">// 这里的回调函数的执行时机是由三方库 lib 决定</span></span><br><span class="line">  <span class="comment">// 实际上打印四次，并且其中一次是异步执行</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(value);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">lib.<span class="title function_">on</span>(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 下述是异常代码</span></span><br><span class="line">  <span class="comment">// 但是执行下述代码不会抛出任何异常信息</span></span><br><span class="line">  <span class="comment">// 开发者无法感知自己的代码设计错误</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(value.<span class="property">a</span>.<span class="property">b</span>.<span class="property">c</span>)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>Promise提供了一种链式书写回调函数的异步流程控制方式，从而避免层层嵌套。</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">将异步文件读取封装为Promise的形式</button></li><li class="tab"><button type="button" data-href="#super-2">链式调用</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> readFile = <span class="keyword">function</span> (<span class="params">filePath</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>)&#123;</span><br><span class="line">    fs.<span class="title function_">readFile</span>(filePath, <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span>(err)&#123;</span><br><span class="line">        <span class="title function_">reject</span>(err)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">resolve</span>(data)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">readFile</span>(<span class="string">&#x27;/fileA&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">readfile</span>(<span class="string">&#x27;/fileB&#x27;</span>)</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">readfile</span>(<span class="string">&#x27;/fileC&#x27;</span>)</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// …</span></span><br><span class="line">&#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// …</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>相关资料：</p><blockquote><p><a href="#heading-69" title="https://juejin.cn/post/6844904064614924302#heading-69">「硬核JS」深入了解异步解决方案</a><br><a href="https://link.juejin.cn/?target=https://www.ituring.com.cn/article/66566%23" title="https://www.ituring.com.cn/article/66566#">「翻译」Promises&#x2F;A+规范</a></p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>Promise 解决了 Callback 的回调地狱问题，但也造成了代码冗余，如果一些异步任务不支持 Promise 语法，就需要进行一层 Promise 封装。Generator 将 JavaScript 的异步编程带入了一个全新的阶段，它使得异步代码的设计和执行看起来和同步代码一致。Generator 使用的简单示例如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> firstPromise = (<span class="attr">result</span>: number): <span class="title class_">Promise</span>&lt;number&gt; =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(result * <span class="number">2</span>), <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> nextPromise = (<span class="attr">result</span>: number): <span class="title class_">Promise</span>&lt;number&gt; =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(result * <span class="number">3</span>), <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在 Generator 函数里执行的异步代码看起来和同步代码一致</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">gen</span>(<span class="params">result: number</span>): <span class="title class_">Generator</span>&lt;<span class="title class_">Promise</span>&lt;number&gt;, <span class="title class_">Promise</span>&lt;number&gt;, number&gt; &#123;</span><br><span class="line">  <span class="comment">// 异步代码</span></span><br><span class="line">  <span class="keyword">const</span> firstResult = <span class="keyword">yield</span> <span class="title function_">firstPromise</span>(result)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;firstResult: &#x27;</span>, firstResult) <span class="comment">// 2</span></span><br><span class="line"><span class="comment">// 异步代码</span></span><br><span class="line">  <span class="keyword">const</span> nextResult = <span class="keyword">yield</span> <span class="title function_">nextPromise</span>(firstResult)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;nextResult: &#x27;</span>, nextResult) <span class="comment">// 6</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">nextPromise</span>(firstResult)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> g = <span class="title function_">gen</span>(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 手动执行 Generator 函数</span></span><br><span class="line">g.<span class="title function_">next</span>().<span class="property">value</span>.<span class="title function_">then</span>(<span class="function">(<span class="params">res: number</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 将 firstPromise 的返回值传递给第一个 yield 表单式对应的 firstResult</span></span><br><span class="line">  <span class="keyword">return</span> g.<span class="title function_">next</span>(res).<span class="property">value</span></span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">res: number</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 将 nextPromise 的返回值传递给第二个 yield 表单式对应的 nextResult</span></span><br><span class="line">  <span class="keyword">return</span> g.<span class="title function_">next</span>(res).<span class="property">value</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>通过上述代码，可以看出 Generator 相对于 Promise 具有以下优势：</p><ul><li>丰富了状态类型，Generator 通过 <code>next</code> 可以产生不同的状态信息，也可以通过 <code>return</code> 结束函数的执行状态，相对于 Promise 的 <code>resolve</code> 不可变状态更加丰富</li><li>Generator 函数内部的异步代码执行看起来和同步代码执行一致，非常利于代码的维护</li><li>Generator 函数内部的执行逻辑和相应的状态变化逻辑解耦，降低了代码的复杂度</li></ul><p><code>next</code> 可以不停的改变状态使得 <code>yield</code> 得以继续执行的代码可以变得非常有规律，例如从上述的<strong>手动执行 Generator 函数</strong>可以看出，完全可以将其封装成一个自动执行的执行器，具体如下所示：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> firstPromise = (<span class="attr">result</span>: number): <span class="title class_">Promise</span>&lt;number&gt; =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(result * <span class="number">2</span>), <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> nextPromise = (<span class="attr">result</span>: number): <span class="title class_">Promise</span>&lt;number&gt; =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(result * <span class="number">3</span>), <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">type <span class="title class_">Gen</span> =  <span class="title class_">Generator</span>&lt;<span class="title class_">Promise</span>&lt;number&gt;, <span class="title class_">Promise</span>&lt;number&gt;, number&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span>* <span class="title function_">gen</span>(): <span class="title class_">Gen</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> firstResult = <span class="keyword">yield</span> <span class="title function_">firstPromise</span>(<span class="number">1</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;firstResult: &#x27;</span>, firstResult) <span class="comment">// 2</span></span><br><span class="line">  <span class="keyword">const</span> nextResult = <span class="keyword">yield</span> <span class="title function_">nextPromise</span>(firstResult)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;nextResult: &#x27;</span>, nextResult) <span class="comment">// 6</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">nextPromise</span>(firstResult)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Generator 自动执行器</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">co</span>(<span class="params">gen: () =&gt; Gen</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> g = <span class="title function_">gen</span>()</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">next</span>(<span class="params">data: number</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> result = g.<span class="title function_">next</span>(data)</span><br><span class="line">    <span class="keyword">if</span>(result.<span class="property">done</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> result.<span class="property">value</span></span><br><span class="line">    &#125;</span><br><span class="line">    result.<span class="property">value</span>.<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 通过递归的方式处理相同的逻辑</span></span><br><span class="line">      <span class="title function_">next</span>(data)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 第一次调用 next 主要用于启动 Generator 函数</span></span><br><span class="line">  <span class="comment">// 内部指针会从函数头部开始执行，直到遇到第一个 yield 表达式</span></span><br><span class="line">  <span class="comment">// 因此第一次 next 传递的参数没有任何含义（这里传递只是为了防止 TS 报错）</span></span><br><span class="line">  <span class="title function_">next</span>(<span class="number">0</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">co</span>(gen)</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>温馨提示：<a href="https://link.juejin.cn/?target=https://github.com/tj" title="https://github.com/tj">TJ Holowaychuk </a>设计了一个 Generator 自动执行器 <a href="https://link.juejin.cn/?target=https://github.com/tj/co" title="https://github.com/tj/co">Co</a>，使用 Co 的前提是 <code>yield</code>  命令后必须是 Promise 对象或者 Thunk 函数。Co 还可以支持并发的异步处理，具体可查看官方的<a href="https://link.juejin.cn/?target=https://github.com/tj/co%23arrays" title="https://github.com/tj/co#arrays"> API 文档</a>。</p></blockquote><p>需要注意的是 Generator 函数的返回值是一个 Iterator 遍历器对象，具体如下所示：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> firstPromise = (<span class="attr">result</span>: number): <span class="title class_">Promise</span>&lt;number&gt; =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(result * <span class="number">2</span>), <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> nextPromise = (<span class="attr">result</span>: number): <span class="title class_">Promise</span>&lt;number&gt; =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(result * <span class="number">3</span>), <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">type <span class="title class_">Gen</span> = <span class="title class_">Generator</span>&lt;<span class="title class_">Promise</span>&lt;number&gt;&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span>* <span class="title function_">gen</span>(): <span class="title class_">Gen</span> &#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="title function_">firstPromise</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">yield</span> <span class="title function_">nextPromise</span>(<span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注意使用 next 是继发执行，而这里是并发执行</span></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">all</span>([...<span class="title function_">gen</span>()]).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;res: &#x27;</span>, res);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> promise <span class="keyword">of</span> <span class="title function_">gen</span>()) &#123;</span><br><span class="line">  promise.<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;res: &#x27;</span>, res);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Generator 函数的错误处理相对复杂一些，极端情况下需要对执行和 Generator 函数进行双重错误捕获，具体如下所示：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> firstPromise = (<span class="attr">result</span>: number): <span class="title class_">Promise</span>&lt;number&gt; =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 需要注意这里的reject 没有被捕获</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">reject</span>(result * <span class="number">2</span>), <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> nextPromise = (<span class="attr">result</span>: number): <span class="title class_">Promise</span>&lt;number&gt; =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(result * <span class="number">3</span>), <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">type <span class="title class_">Gen</span> = <span class="title class_">Generator</span>&lt;<span class="title class_">Promise</span>&lt;number&gt;&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span>* <span class="title function_">gen</span>(): <span class="title class_">Gen</span> &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="title function_">firstPromise</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">yield</span> <span class="title function_">nextPromise</span>(<span class="number">2</span>);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Generator 函数错误捕获: &#x27;</span>, err);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> g = <span class="title function_">gen</span>();</span><br><span class="line">  g.<span class="title function_">next</span>();</span><br><span class="line">  <span class="comment">// 返回 Promise 后还需要通过 Promise.prototype.catch 进行错误捕获</span></span><br><span class="line">  g.<span class="title function_">next</span>();</span><br><span class="line">  <span class="comment">// Generator 函数错误捕获</span></span><br><span class="line">  g.<span class="keyword">throw</span>(<span class="string">&#x27;err&#x27;</span>);</span><br><span class="line">  <span class="comment">// 执行器错误捕获</span></span><br><span class="line">  g.<span class="keyword">throw</span>(<span class="string">&#x27;err&#x27;</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;执行错误捕获: &#x27;</span>, err);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在使用 <code>g.throw</code> 的时候还需要注意以下一些事项：</p><ul><li>如果 Generator 函数本身没有捕获错误，那么 Generator 函数内部抛出的错误可以在执行处进行错误捕获</li><li>如果 Generator 函数内部和执行处都没有进行错误捕获，则终止进程并抛出错误信息</li><li>如果没有执行过 <code>g.next</code>，则 <code>g.throw</code> 不会在 Gererator 函数中被捕获（因为执行指针没有启动 Generator 函数的执行），此时可以在执行处进行执行错误捕获</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p><strong>async</strong>是异步的意思，而<strong>await</strong>是<strong>async wait</strong>的简写，即异步等待。</p><p>Async是Generator函数的语法糖，Async的特性如下：</p><ul><li>内置执行器：Generator函数需要设计手动执行器或者通用执行器（例如Co执行器）进行执行，Async语法则内置了自动执行器，设计代码时无须关心执行步骤</li><li><code>yield</code> 命令无约束：在 Generator 中使用 Co 执行器时 <code>yield</code> 后必须是 Promise 对象或者 Thunk 函数，而 Async 语法中的 <code>await</code> 后可以是 Promise 对象或者原始数据类型对象、数字、字符串、布尔值等（此时会对其进行 <code>Promise.resolve()</code> 包装处理）</li><li>返回 Promise： <code>async</code> 函数的返回值是 Promise 对象（返回原始数据类型会被 Promise 进行封装）， 因此还可以作为 <code>await</code>  的命令参数，相对于 Generator 返回 Iterator 遍历器更加简洁实用</li><li>async&#x2F;await有一个限制就是 <strong>必须在函数中使用</strong> ，因此我们将代码包进一个函数，并 <strong>在函数前加上async，这样我们便可以在函数中使用await关键字</strong> 。</li></ul><p>举个简单的示例：</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> firstPromise = (<span class="attr">result</span>: <span class="built_in">number</span>): <span class="title class_">Promise</span>&lt;<span class="built_in">number</span>&gt; =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(result * <span class="number">2</span>), <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> nextPromise = (<span class="attr">result</span>: <span class="built_in">number</span>): <span class="title class_">Promise</span>&lt;<span class="built_in">number</span>&gt; =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(result * <span class="number">3</span>), <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">co</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> firstResult = <span class="keyword">await</span> <span class="title function_">firstPromise</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="comment">// 1s 后打印 2</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;firstResult: &#x27;</span>, firstResult); </span><br><span class="line">  <span class="comment">// 等待 firstPromise 的状态发生变化后执行</span></span><br><span class="line">  <span class="keyword">const</span> nextResult = <span class="keyword">await</span> <span class="title function_">nextPromise</span>(firstResult);</span><br><span class="line">  <span class="comment">// 2s 后打印 6</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;nextResult: &#x27;</span>, nextResult); </span><br><span class="line">  <span class="keyword">return</span> nextResult;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">co</span>();</span><br><span class="line"></span><br><span class="line"><span class="title function_">co</span>().<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;res: &#x27;</span>, res); <span class="comment">// 6</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>通过上述示例可以看出，<code>async</code> 函数的特性如下：</p><ul><li>调用 <code>async</code> 函数后返回的是一个 Promise 对象，通过 <code>then</code> 回调可以拿到 async 函数内部 <code>return</code> 语句的返回值</li><li>调用 <code>async</code> 函数后返回的 Promise 对象必须等待内部所有 <code>await</code> 对应的 Promise 执行完（这使得 <code>async</code> 函数可能是阻塞式执行）后才会发生状态变化，除非中途遇到了 <code>return</code> 语句</li><li><code>await</code> 命令后如果是 Promise 对象，则返回 Promise 对象处理后的结果，如果是原始数据类型，则直接返回原始数据类型</li></ul><p>上述代码是阻塞式执行，<code>nextPromise</code> 需要等待 <code>firstPromise</code> 执行完成后才能继续执行，如果希望两者能够并发执行，则可以进行下述设计：</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> firstPromise = (<span class="attr">result</span>: <span class="built_in">number</span>): <span class="title class_">Promise</span>&lt;<span class="built_in">number</span>&gt; =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(result * <span class="number">2</span>), <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> nextPromise = (<span class="attr">result</span>: <span class="built_in">number</span>): <span class="title class_">Promise</span>&lt;<span class="built_in">number</span>&gt; =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(result * <span class="number">3</span>), <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">co</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>([<span class="title function_">firstPromise</span>(<span class="number">1</span>), <span class="title function_">nextPromise</span>(<span class="number">1</span>)]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">co</span>().<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;res: &#x27;</span>, res); <span class="comment">// [2,3]</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>除了使用 Promise 自带的并发执行 API，也可以通过让所有的 Promise 提前并发执行来处理：</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> firstPromise = (<span class="attr">result</span>: <span class="built_in">number</span>): <span class="title class_">Promise</span>&lt;<span class="built_in">number</span>&gt; =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;firstPromise&#x27;</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(result * <span class="number">2</span>), <span class="number">10000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> nextPromise = (<span class="attr">result</span>: <span class="built_in">number</span>): <span class="title class_">Promise</span>&lt;<span class="built_in">number</span>&gt; =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;nextPromise&#x27;</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(result * <span class="number">3</span>), <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">co</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 执行 firstPromise</span></span><br><span class="line">  <span class="keyword">const</span> first = <span class="title function_">firstPromise</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="comment">// 和 firstPromise 同时执行 nextPromise</span></span><br><span class="line">  <span class="keyword">const</span> next = <span class="title function_">nextPromise</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="comment">// 等待 firstPromise 结果回来</span></span><br><span class="line">  <span class="keyword">const</span> firstResult = <span class="keyword">await</span> first;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;firstResult: &#x27;</span>, firstResult);</span><br><span class="line">  <span class="comment">// 等待 nextPromise 结果回来</span></span><br><span class="line">  <span class="keyword">const</span> nextResult = <span class="keyword">await</span> next;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;nextResult: &#x27;</span>, nextResult);</span><br><span class="line">  <span class="keyword">return</span> nextResult;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">co</span>().<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;res: &#x27;</span>, res); <span class="comment">// 3</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>Async 的错误处理相对于 Generator 会更加简单，具体示例如下所示：</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> firstPromise = (<span class="attr">result</span>: <span class="built_in">number</span>): <span class="title class_">Promise</span>&lt;<span class="built_in">number</span>&gt; =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// Promise 决断错误</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">reject</span>(result * <span class="number">2</span>), <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> nextPromise = (<span class="attr">result</span>: <span class="built_in">number</span>): <span class="title class_">Promise</span>&lt;<span class="built_in">number</span>&gt; =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(result * <span class="number">3</span>), <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">co</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> firstResult = <span class="keyword">await</span> <span class="title function_">firstPromise</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;firstResult: &#x27;</span>, firstResult);</span><br><span class="line">  <span class="keyword">const</span> nextResult = <span class="keyword">await</span> <span class="title function_">nextPromise</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;nextResult: &#x27;</span>, nextResult);</span><br><span class="line">  <span class="keyword">return</span> nextResult;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">co</span>()</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;res: &#x27;</span>, res);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;err: &#x27;</span>, err); <span class="comment">// err: 2</span></span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p><code>async</code> 函数内部抛出的错误，会导致函数返回的 Promise 对象变为 <code>rejected</code> 状态，从而可以通过 <code>catch</code> 捕获， 上述代码只是一个粗粒度的容错处理，如果希望 <code>firstPromise</code> 错误后可以继续执行 <code>nextPromise</code>，则可以通过 <code>try...catch...</code> 在 <code>async</code> 函数里进行局部错误捕获：</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> firstPromise = (<span class="attr">result</span>: <span class="built_in">number</span>): <span class="title class_">Promise</span>&lt;<span class="built_in">number</span>&gt; =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// Promise 决断错误</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">reject</span>(result * <span class="number">2</span>), <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> nextPromise = (<span class="attr">result</span>: <span class="built_in">number</span>): <span class="title class_">Promise</span>&lt;<span class="built_in">number</span>&gt; =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(result * <span class="number">3</span>), <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">co</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">firstPromise</span>(<span class="number">1</span>);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;err: &#x27;</span>, err); <span class="comment">// err: 2</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// nextPromise 继续执行</span></span><br><span class="line">  <span class="keyword">const</span> nextResult = <span class="keyword">await</span> <span class="title function_">nextPromise</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">return</span> nextResult;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">co</span>()</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;res: &#x27;</span>, res); <span class="comment">// res: 3</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;err: &#x27;</span>, err);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><blockquote><p>温馨提示：Callback 是 Node.js 中经常使用的编程方式，Node.js 中很多原生的 API 都是采用 Callback 的形式进行异步设计，早期的 Node.js 经常会有 Callback 和 Promise 混用的情况，并且在很长一段时间里都没有很好的支持 Async 语法。如果你对 Node.js 和它的替代品 Deno 感兴趣，可以观看 Ryan Dahl 在 TS Conf 2019 中的经典演讲 <a href="https://link.juejin.cn/?target=https://www.youtube.com/watch?v=1gIiZfSbEAE" title="https://www.youtube.com/watch?v=1gIiZfSbEAE">Deno is a New Way to JavaScript</a>。</p></blockquote><p>相比于<strong>Promise</strong>，<strong>async&#x2F;await</strong>能更好地处理 then 链</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">takeLongTime</span>(<span class="params">n</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> Promise(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> resolve(n + <span class="number">200</span>), n);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">step1</span>(<span class="params">n</span>) &#123;</span><br><span class="line">  <span class="built_in">console</span>.<span class="built_in">log</span>(step1 with $&#123;n&#125;);</span><br><span class="line">  <span class="keyword">return</span> takeLongTime(n);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">step2</span>(<span class="params">n</span>) &#123;</span><br><span class="line">  <span class="built_in">console</span>.<span class="built_in">log</span>(step2 with $&#123;n&#125;);</span><br><span class="line">  <span class="keyword">return</span> takeLongTime(n);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">step3</span>(<span class="params">n</span>) &#123;</span><br><span class="line">  <span class="built_in">console</span>.<span class="built_in">log</span>(step3 with $&#123;n&#125;);</span><br><span class="line">  <span class="keyword">return</span> takeLongTime(n);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>现在分别用<strong>Promise</strong> 和<strong>async&#x2F;await</strong>来实现这三个步骤的处理。</p><p><strong>使用Promise</strong></p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">doIt</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="built_in">console</span>.time(<span class="string">&quot;doIt&quot;</span>);</span><br><span class="line">  const time1 = <span class="number">300</span>;</span><br><span class="line">  step1(time1)</span><br><span class="line">    .then(<span class="function"><span class="params">time2</span> =&gt;</span> step2(time2))</span><br><span class="line">    .then(<span class="function"><span class="params">time3</span> =&gt;</span> step3(time3))</span><br><span class="line">    .then(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.<span class="built_in">log</span>(result is $&#123;result&#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line">doIt();<span class="comment">// step1 with 300// step2 with 500// step3 with 700// result is 900</span></span><br></pre></td></tr></table></figure><p><strong>使用</strong>async&#x2F;await</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">doIt</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">time</span>(<span class="string">&quot;doIt&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> time1 = <span class="number">300</span>;</span><br><span class="line">  <span class="keyword">const</span> time2 = <span class="keyword">await</span> <span class="title function_">step1</span>(time1);</span><br><span class="line">  <span class="keyword">const</span> time3 = <span class="keyword">await</span> <span class="title function_">step2</span>(time2);</span><br><span class="line">  <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="title function_">step3</span>(time3);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(result is $&#123;result&#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">doIt</span>();</span><br></pre></td></tr></table></figure><p>结果和之前的 Promise 实现是一样的，但是这个代码看起来是不是清晰得多，优雅整洁，几乎跟同步代码一样。</p><p><strong>await</strong>关键字只能在async function中使用。在任何非async function的函数中使用await关键字都会抛出错误。await关键字在执行下一行代码之前等待右侧表达式(可能是一个Promise)返回。</p><p><strong>优缺点：</strong><br><strong>async&#x2F;await</strong>的优势在于处理 then 的调用链，能够更清晰准确的写出代码，并且也能优雅地解决回调地狱问题。当然也存在一些缺点，因为 await 将异步代码改造成了同步代码，如果多个异步代码没有依赖性却使用了 await 会导致性能上的降低。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 异步编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JS异步 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ES6新特性</title>
      <link href="/posts/de81bfb9/"/>
      <url>/posts/de81bfb9/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="严格模式"><a href="#严格模式" class="headerlink" title="严格模式"></a>严格模式</h2><p>ES6的模块自动采用严格模式（相当于在模块头部加上”use strict”;）。<br>严格模式主要有以下限制。</p><ul><li>变量必须声明后才能使用</li><li>函数的参数不能有同名属性（会报错）</li><li>不能使用with语句</li><li>不能对只读属性赋值（会报错）</li><li>不能使用前缀 0 表示八进制数（会报错）</li><li>不能删除不可删除的属性（会报错）</li><li>不能删除变量delete prop（会报错），只能删除属性delete global[prop]</li><li>eval不会在它的外层作用域引入变量</li><li>eval和arguments不能被重新赋值</li><li>arguments不会自动反映函数参数的变化</li><li>不能使用arguments.callee</li><li>不能使用arguments.caller</li><li>禁止this指向全局对象</li><li>不能使用fn.caller和fn.arguments获取函数调用的堆栈</li><li>增加了保留字（比如protected、static和interface）</li></ul><h2 id="Symbol"><a href="#Symbol" class="headerlink" title="Symbol"></a>Symbol</h2><p>ES6新增数据类型 <code>Symbol</code>。</p><blockquote><p>表示一个独一无二的值</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> test = <span class="title class_">Symbol</span>(<span class="string">&#x27;one&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> test2 = <span class="title class_">Symbol</span>(<span class="string">&#x27;one&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(test, test2)      <span class="comment">//Symbol(one) Symbol(one)</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(test === test2)   <span class="comment">//false</span></span><br></pre></td></tr></table></figure><p>一般用于防止对象属性重复，全局下即便不知道是什么属性，只要是Symbol类型就不会重复</p><blockquote><p>即使对象键值相同，实际却不相同</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> test = <span class="title class_">Symbol</span>(<span class="string">&#x27;one&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> test2 = <span class="title class_">Symbol</span>(<span class="string">&#x27;one&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">   [test]: <span class="number">1</span>,</span><br><span class="line">   [test2]: <span class="number">1</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj)<span class="comment">//&#123;Symbol(one): 1, Symbol(one): 1&#125;</span></span><br></pre></td></tr></table></figure><h2 id="块级作用域"><a href="#块级作用域" class="headerlink" title="块级作用域"></a>块级作用域</h2><p>es6多出两个块级作用域：<code>const</code>与 <code>let</code>。</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">const</button></li><li class="tab"><button type="button" data-href="#super-2">let</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><code>const</code>定义常量，常量不可重新赋值，一般只用于读取不作修改变量时使用：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> a = <span class="number">1</span>;</span><br><span class="line">a = <span class="number">2</span>;      <span class="comment">//错误，不可重新赋值</span></span><br></pre></td></tr></table></figure><p>由于栈内存不可变，堆内存可以进行修改。</p><blockquote><p>因此，<code>const</code>声明的数组和对象仍然可以添加或删除内容。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [];</span><br><span class="line">arr = [<span class="number">1</span>];      <span class="comment">//错误，不可重复赋值</span></span><br><span class="line">arr.<span class="title function_">push</span>(<span class="number">1</span>);   <span class="comment">//正确</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123;&#125;;</span><br><span class="line">obj = &#123; <span class="attr">name</span>: <span class="string">&#x27;name&#x27;</span> &#125;;<span class="comment">//错误，不可重复赋值</span></span><br><span class="line">obj.<span class="property">name</span> = <span class="string">&#x27;name&#x27;</span>;<span class="comment">//正确</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><code>let</code>声明可变变量</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="number">1</span>;</span><br><span class="line">a = <span class="number">2</span></span><br></pre></td></tr></table></figure><p>只在块级中有作用：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="keyword">let</span> a = <span class="number">1</span></span><br><span class="line">   <span class="keyword">const</span> b = <span class="number">2</span></span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(a, b)    <span class="comment">//1 2</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a)          <span class="comment">//错误，提示你没有声明</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b)          <span class="comment">//错误，提示你没有声明</span></span><br></pre></td></tr></table></figure><p><strong>声明变量时优先使用常量const，其余非常量都使用let</strong>。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="对象解构赋值"><a href="#对象解构赋值" class="headerlink" title="对象解构赋值"></a>对象解构赋值</h2><p>对象解构：从数组或者对象中将<strong>栈内存</strong>取出进行使用。<br>一般都是只进行使用不进行修改，所以解构一般都用<strong>const</strong>声明。</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">super 1</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="基础解构"><a href="#基础解构" class="headerlink" title="基础解构"></a>基础解构</h3><p>在对象中解构时声明的名称与key一一对应：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">   <span class="attr">name</span>: <span class="string">&#x27;John&#x27;</span>,</span><br><span class="line">   <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> &#123; name, age &#125; = obj<span class="comment">// 解构语法</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(name)<span class="comment">// John</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(age)<span class="comment">// 18</span></span><br></pre></td></tr></table></figure><p>在数组中按照位置对应，声明名称可以随意：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="string">&#x27;name&#x27;</span>, <span class="number">18</span>]</span><br><span class="line"><span class="keyword">const</span> &#123; a, b &#125; = arr</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a, b)<span class="comment">//name 18</span></span><br></pre></td></tr></table></figure><h3 id="别名解构"><a href="#别名解构" class="headerlink" title="别名解构"></a>别名解构</h3><p>把对象属性赋值给属性名不一致的变量名</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">   <span class="attr">name</span>: <span class="string">&#x27;name&#x27;</span>,</span><br><span class="line">   <span class="attr">age</span>: <span class="number">18</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="attr">name</span>: newName, age &#125; = obj</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(newName, age)<span class="comment">//name 18</span></span><br></pre></td></tr></table></figure><h3 id="默认值解构"><a href="#默认值解构" class="headerlink" title="默认值解构"></a>默认值解构</h3><p>当对象中不存在特定属性的解构，会赋值为 <code>undefined</code> ，如果不希望是 <code>undefined</code> ，可以为其设置一个默认值</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fullName = &#123;</span><br><span class="line">    <span class="attr">firstName</span>: <span class="string">&quot;Quintion&quot;</span>,</span><br><span class="line">    <span class="attr">lastName</span>: <span class="string">&quot;Tang&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="attr">firstName</span>: trueName, lastName, age = <span class="number">18</span> &#125; = fullName; <span class="comment">// 解构语法</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(trueName); <span class="comment">// Quintion</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(lastName); <span class="comment">// Tang</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(age); <span class="comment">// 18</span></span><br></pre></td></tr></table></figure><p>下面来看下存在 <code>age</code> 属性下的结果：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fullName = &#123;</span><br><span class="line">    <span class="attr">firstName</span>: <span class="string">&quot;Quintion&quot;</span>,</span><br><span class="line">    <span class="attr">lastName</span>: <span class="string">&quot;Tang&quot;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">30</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="attr">firstName</span>: trueName, lastName, age = <span class="number">18</span> &#125; = fullName; <span class="comment">// 解构语法</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(trueName); <span class="comment">// Quintion</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(lastName); <span class="comment">// Tang</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(age); <span class="comment">// 30</span></span><br></pre></td></tr></table></figure><h3 id="REST解构"><a href="#REST解构" class="headerlink" title="REST解构"></a>REST解构</h3><p>如果想从一个对象中解构一个属性，剩下的属性结构为另一个变量，如下：</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> fullName = &#123;</span><br><span class="line">    firstName: <span class="string">&quot;Quintion&quot;</span>,</span><br><span class="line">    lastName: <span class="string">&quot;Tang&quot;</span>,</span><br><span class="line">    age: <span class="number">30</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">const</span> &#123; age, ...username &#125; = fullName; <span class="comment">// 解构语法</span></span><br><span class="line">console.<span class="built_in">log</span>(username); <span class="comment">// &#123; firstName: &#x27;Quintion&#x27;, lastName: &#x27;Tang&#x27; &#125;</span></span><br><span class="line">console.<span class="built_in">log</span>(age); <span class="comment">// 30</span></span><br></pre></td></tr></table></figure><h3 id="嵌套解构"><a href="#嵌套解构" class="headerlink" title="嵌套解构"></a>嵌套解构</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">   <span class="attr">name</span>: <span class="string">&#x27;name&#x27;</span>,</span><br><span class="line">   <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">   <span class="attr">info</span>: &#123;</span><br><span class="line">   <span class="attr">address</span>: <span class="string">&#x27;北京&#x27;</span></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> &#123; name, age, <span class="attr">info</span>: &#123; address &#125; &#125; = obj</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(name, age, address)<span class="comment">//name 18 北京</span></span><br></pre></td></tr></table></figure><h2 id="模板字符串"><a href="#模板字符串" class="headerlink" title="模板字符串"></a>模板字符串</h2><p>字符串中需要添加变量时用于代替+号连接的方案。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> id = <span class="number">123</span></span><br><span class="line"><span class="keyword">const</span> mes = <span class="string">&#x27;id是&#x27;</span> + id    <span class="comment">//旧方案</span></span><br><span class="line"><span class="keyword">const</span> mes2 = <span class="string">`id是<span class="subst">$&#123;id&#125;</span>`</span>   <span class="comment">//模板字符串</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(mes, mes2)     <span class="comment">//id是123 id是123</span></span><br></pre></td></tr></table></figure><h2 id="箭头函数"><a href="#箭头函数" class="headerlink" title="箭头函数"></a>箭头函数</h2><p>适用于需要匿名函数的地方。</p><p><strong>任何可以使用函数表达式的地方，都可以使用箭头函数</strong> 。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 函数表达式</span></span><br><span class="line"><span class="keyword">let</span> add = <span class="keyword">function</span> (<span class="params">a, b</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 箭头函数</span></span><br><span class="line"><span class="keyword">let</span> <span class="title function_">arrowAdd</span> = (<span class="params">a, b</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">add</span>(<span class="number">1</span>, <span class="number">2</span>)) <span class="comment">// &gt;&gt; 3</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">arrowAdd</span>(<span class="number">1</span>, <span class="number">2</span>)) <span class="comment">// &gt;&gt; 3</span></span><br></pre></td></tr></table></figure><blockquote><p>注：不能用作构造函数。</p></blockquote><p>一个普通的箭头函数，参数是state，返回值是res：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ES5 Version</span></span><br><span class="line"><span class="keyword">function</span>(<span class="params">state</span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ES6 Version</span></span><br><span class="line">(state) =&gt; &#123; <span class="keyword">return</span> res &#125;</span><br></pre></td></tr></table></figure><p>如果后面的内容<strong>直接返回</strong>，可以去掉{}，或者使用()：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ES5 Version</span></span><br><span class="line"><span class="keyword">var</span> getCurrentDate = <span class="keyword">function</span> (<span class="params">state</span>) &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ES6 Version</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getCurrentDate</span> = (<span class="params">state</span>) =&gt; <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br></pre></td></tr></table></figure><p>单一入参的话，前面的括号()也可省略，多参数必须保留：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ES5 Version</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">greet</span>(<span class="params">name</span>) &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="string">&#x27;Hello &#x27;</span> + name + <span class="string">&#x27;!&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ES6 Version</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">greet</span> = (<span class="params">name</span>) =&gt; <span class="title class_">Hello</span> $&#123;name&#125;;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">greet2</span> = name =&gt; <span class="title class_">Hello</span> $&#123;name&#125;;</span><br></pre></td></tr></table></figure><h3 id="箭头函数和普通函数的重要区别"><a href="#箭头函数和普通函数的重要区别" class="headerlink" title="箭头函数和普通函数的重要区别"></a>箭头函数和普通函数的重要区别</h3><blockquote><p>箭头函数没有this、arguments、super、new.target，它们是离该箭头函数最近的非箭头函数的绑定。【词法作用域】<br>不能用作构造函数<br>没有prototype属性<br>不能使用new来调用<br>内部的this无法改变<br>形参名称不能重复</p></blockquote><blockquote><p>但可以使用rest参数来获得在箭头函数中传递的所有参数。</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">getArgs</span> = (<span class="params"></span>) =&gt; <span class="variable language_">arguments</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getArgs2</span> = (<span class="params">...rest</span>) =&gt; rest</span><br></pre></td></tr></table></figure><p>箭头函数没有自己的this值。它捕获词法作用域函数的this值，在此示例中，addAll函数将复制computeResult方法中的this值，如果我们在全局作用域声明箭头函数，则this值为 window 对象。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> data = &#123;</span><br><span class="line">   <span class="attr">result</span>: <span class="number">0</span>,</span><br><span class="line">   <span class="attr">nums</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>],</span><br><span class="line">   <span class="title function_">computeResult</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="comment">// 这里的“this”指的是“data”对象</span></span><br><span class="line">      <span class="keyword">const</span> <span class="title function_">addAll</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">         <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">nums</span>.<span class="title function_">reduce</span>(<span class="function">(<span class="params">total, cur</span>) =&gt;</span> total + cur, <span class="number">0</span>)</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">result</span> = <span class="title function_">addAll</span>();</span><br><span class="line">   &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="对象展开运算符"><a href="#对象展开运算符" class="headerlink" title="对象展开运算符"></a>对象展开运算符</h2><p>类似函数剩余参数：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">   <span class="attr">name</span>: <span class="string">&#x27;name&#x27;</span>,</span><br><span class="line">   <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">   <span class="attr">address</span>: <span class="string">&#x27;北京&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> &#123; ...all &#125; = obj</span><br><span class="line"><span class="keyword">const</span> &#123; name, ...other &#125; = obj</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(all, other)<span class="comment">//&#123;name: &#x27;name&#x27;, age: 18, address: &#x27;北京&#x27;&#125; &#123;age: 18, address: &#x27;北京&#x27;&#125;</span></span><br></pre></td></tr></table></figure><p>在react组件传值时可以使用到，比如需要把一整个对象的属性都传入：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">   <span class="attr">name</span>: <span class="string">&#x27;name&#x27;</span>,</span><br><span class="line">   <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">   <span class="attr">address</span>: <span class="string">&#x27;北京&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> &#123; ...all &#125; = obj</span><br><span class="line"></span><br><span class="line">&lt;<span class="title class_">Component</span> ...all&gt;&lt;<span class="title class_">Component</span>&gt;</span><br></pre></td></tr></table></figure><h2 id="set"><a href="#set" class="headerlink" title="set"></a>set</h2><p>ES6 提供了新的数据结构 Set（集合）。它类似于数组，但成员的值都是唯一的，集合实现了 iterator 接口，所以可以使用『扩展运算符』和『for…of…』进行遍历，集合的属性和方法：</p><p>size：返回集合的元素个数<br>add()：增加一个新元素，返回当前集合<br>delete()：删除元素，返回 boolean 值<br>has()：检测集合中是否包含某个元素，返回 boolean 值<br>clear()：清空集合，返回 undefined</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建一个空集合</span></span><br><span class="line">let s = <span class="keyword">new</span> Set();</span><br><span class="line"><span class="comment">//创建一个非空集合</span></span><br><span class="line">let s1 = <span class="keyword">new</span> Set([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</span><br><span class="line"><span class="comment">//集合属性与方法</span></span><br><span class="line"><span class="comment">//返回集合的元素个数</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(s1.size);</span><br><span class="line"><span class="comment">//添加新元素</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(s1.add(<span class="number">4</span>));</span><br><span class="line"><span class="comment">//删除元素</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(s1.delete(<span class="number">1</span>));</span><br><span class="line"><span class="comment">//检测是否存在某个值</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(s1.has(<span class="number">2</span>));</span><br><span class="line"><span class="comment">//清空集合</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(s1.clear());</span><br></pre></td></tr></table></figure><h2 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h2><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">ES6 提供了 <span class="built_in">Map</span> 数据结构。它类似于对象，也是键值对的集合。但是“键” 的范围不限于字符串，各种类型的值（包括对象）都可以当作键。<span class="built_in">Map</span> 也实现了 iterator 接口，所以可以使用『扩展运算符』和『<span class="keyword">for</span>…of…』进行遍历。<span class="built_in">Map</span> 的属性和方法：size：返回 <span class="built_in">Map</span> 的元素个数</span><br><span class="line">set()：增加一个新元素，返回当前 <span class="built_in">Map</span></span><br><span class="line">get()：返回键名对象的键值</span><br><span class="line">has()：检测 <span class="built_in">Map</span> 中是否包含某个元素，返回 <span class="built_in">boolean</span> 值</span><br><span class="line">clear()：清空集合，返回 <span class="literal">undefined</span></span><br><span class="line"><span class="comment">//创建一个空 map</span></span><br><span class="line">let m = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line"><span class="comment">//创建一个非空 map</span></span><br><span class="line">let m2 = <span class="keyword">new</span> <span class="built_in">Map</span>([</span><br><span class="line">    [<span class="string">&quot;name&quot;</span>, <span class="string">&quot;张三&quot;</span>],</span><br><span class="line">    [<span class="string">&quot;gender&quot;</span>, <span class="string">&quot;女&quot;</span>]</span><br><span class="line">]);</span><br><span class="line"><span class="comment">//属性和方法</span></span><br><span class="line"><span class="comment">//获取映射元素的个数</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(m2.size);</span><br><span class="line"><span class="comment">//添加映射值</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(m2.set(<span class="string">&quot;age&quot;</span>, <span class="number">6</span>));</span><br><span class="line"><span class="comment">//获取映射值</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(m2.get(<span class="string">&quot;age&quot;</span>));</span><br><span class="line"><span class="comment">//检测是否有该映射</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(m2.has(<span class="string">&quot;age&quot;</span>));</span><br><span class="line"><span class="comment">//清除</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(m2.clear());</span><br></pre></td></tr></table></figure><h2 id="class类"><a href="#class类" class="headerlink" title="class类"></a>class类</h2><p>类(class)是在JS中编写构造函数的新方法。<br>它是使用构造函数的语法糖，在底层中使用仍然是原型和基于原型的继承。</p><ul><li>class：声明类</li><li>constructor：定义构造函数初始化</li><li>extends：继承父类</li><li>super：调用父级构造方法</li><li>static：定义静态方法和属性</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ES5 Version</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">firstName, lastName, age, address</span>)&#123;</span><br><span class="line">   <span class="variable language_">this</span>.<span class="property">firstName</span> = firstName;</span><br><span class="line">   <span class="variable language_">this</span>.<span class="property">lastName</span> = lastName;</span><br><span class="line">   <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">   <span class="variable language_">this</span>.<span class="property">address</span> = address;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Person</span>.<span class="property">self</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="string">&quot;[object Person]&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getFullName</span> = <span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">firstName</span> + <span class="string">&quot; &quot;</span> + <span class="variable language_">this</span>.<span class="property">lastName</span>;</span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="comment">//ES6 Version</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">   <span class="title function_">constructor</span>(<span class="params">firstName, lastName, age, address</span>)&#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">lastName</span> = lastName;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">firstName</span> = firstName;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">address</span> = address;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">static</span> <span class="title function_">self</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="title function_">toString</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;[object Person]&quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="title function_">getFullName</span>(<span class="params"></span>)&#123;</span><br><span class="line">      <span class="keyword">return</span> $&#123;<span class="variable language_">this</span>.<span class="property">firstName</span>&#125; $&#123;<span class="variable language_">this</span>.<span class="property">lastName</span>&#125;;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>重写方法并从另一个类继承。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ES5 Version</span></span><br><span class="line"><span class="title class_">Employee</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>);</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Employee</span>(<span class="params">firstName, lastName, age, address, jobTitle, yearStarted</span>) &#123;</span><br><span class="line">   <span class="title class_">Person</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>, firstName, lastName, age, address);</span><br><span class="line">   <span class="variable language_">this</span>.<span class="property">jobTitle</span> = jobTitle;</span><br><span class="line">   <span class="variable language_">this</span>.<span class="property">yearStarted</span> = yearStarted;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Employee</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">describe</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">   <span class="keyword">return</span> I am $&#123;<span class="variable language_">this</span>.<span class="title function_">getFullName</span>()&#125; and I have a position <span class="keyword">of</span> $&#123;<span class="variable language_">this</span>.<span class="property">jobTitle</span>&#125; and I started at $&#123;<span class="variable language_">this</span>.<span class="property">yearStarted</span>&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Employee</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="string">&quot;[object Employee]&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ES6 Version</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Employee</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Person</span>  &#123;</span><br><span class="line">   <span class="comment">//Inherits from &quot;Person&quot; </span></span><br><span class="line">   <span class="keyword">class</span>  <span class="title class_">constructor</span>(firstName, lastName, age, address, jobTitle, yearStarted) &#123;</span><br><span class="line">      <span class="variable language_">super</span>(firstName, lastName, age, address);</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">jobTitle</span> = jobTitle;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">yearStarted</span> = yearStarted;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="title function_">describe</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> I am $&#123;<span class="variable language_">this</span>.<span class="title function_">getFullName</span>()&#125; and I have a position <span class="keyword">of</span> $&#123;<span class="variable language_">this</span>.<span class="property">jobTitle</span>&#125; and I started at $&#123;<span class="variable language_">this</span>.<span class="property">yearStarted</span>&#125;;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="title function_">toString</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="comment">// Overriding the &quot;toString&quot; method of &quot;Person&quot;</span></span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;[object Employee]&quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>所以我们要怎么知道它在内部使用原型？</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Something</span> &#123;&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">AnotherSomething</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">as</span> = <span class="keyword">new</span> <span class="title class_">AnotherSomething</span>();</span><br><span class="line"><span class="keyword">const</span> s = <span class="keyword">new</span> <span class="title class_">Something</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="title class_">Something</span>);         <span class="comment">// &quot;function&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="title class_">AnotherSomething</span>);  <span class="comment">// &quot;function&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">as</span>.<span class="title function_">toString</span>());            <span class="comment">// &quot;[object Object]&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">as</span>.<span class="title function_">toString</span>());            <span class="comment">// &quot;[object Object]&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">as</span>.<span class="property">toString</span> === <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>);  <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(s.<span class="property">toString</span> === <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>);   <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>相关资料：<br><a href="https://link.juejin.cn/?target=https://www.zhihu.com/question/29789315" title="https://www.zhihu.com/question/29789315">《ECMAScript 6实现了 class，对 JavaScript 前端开发有什么意义？》</a></p><p><a href="https://link.juejin.cn/?target=http://es6.ruanyifeng.com/%23docs/class" title="http://es6.ruanyifeng.com/#docs/class">《Class的基本语法》</a></p><h2 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h2><h2 id="ES6-模块与-CommonJS-模块的差异"><a href="#ES6-模块与-CommonJS-模块的差异" class="headerlink" title="ES6 模块与 CommonJS 模块的差异"></a>ES6 模块与 CommonJS 模块的差异</h2><ol><li>CommonJS输出的是值的拷贝，ES6模块输出的是值的引用。<blockquote><p>CommonJS一旦输出一个值，模块内部的变化就影响不到这个值。<br>ES6模块的运行机制与CommonJavaScript不一样。JavaScript 引擎对脚本静态分析的时候，遇到模块加载命令import,就会生成一个只读引用。等到脚本真正执行时，再根据这个只读引用，到被加载的那个模块里面去取值。</p></blockquote></li><li>CommonJS是运行时加载，ES6模块是编译时输出接口。<blockquote><p>CommonJavaScript 模块就是对象，即在输入时是先加载整个模块，生成一个对象，然后再从这个对象上面读取方法，这种加载称为“运行时加载”。<br>而ES6模块不是对象，它的对外接口只是一-种静态定义，在代码静态解析阶段就会生成。</p></blockquote></li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">module:</span> &#123;</span><br><span class="line">    <span class="attr">rules:</span> [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test:</span> <span class="string">/\.js$/</span>,</span><br><span class="line">        <span class="attr">exclude:</span> <span class="string">/(node_modules|bower_components)/</span>,</span><br><span class="line">        <span class="attr">use:</span> &#123;</span><br><span class="line">          <span class="attr">loader:</span> <span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">          <span class="attr">options:</span> &#123;</span><br><span class="line">            <span class="attr">presets:</span> [[<span class="string">&#x27;babel-preset-es2015&#x27;</span>, &#123;<span class="attr">modules:</span> <span class="literal">false</span>&#125;]],</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="async函数实现原理"><a href="#async函数实现原理" class="headerlink" title="async函数实现原理"></a>async函数实现原理</h2><p>async函数是基于generator实现，所以涉及到generator相关知识。在没有async函数之前，通常使用co库来执行generator，所以通过co我们也能模拟async的实现。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Asyncfn</span>(<span class="params"></span>) &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="title function_">co</span>(<span class="keyword">function</span>*() &#123;</span><br><span class="line">      <span class="comment">//.....</span></span><br><span class="line">   &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">co</span>(<span class="params">gen</span>) &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> fn = <span class="title function_">gen</span>();</span><br><span class="line">      <span class="keyword">function</span> <span class="title function_">next</span>(<span class="params">data</span>) &#123;</span><br><span class="line">         <span class="keyword">let</span> &#123; value, done &#125; = fn.<span class="title function_">next</span>(data);</span><br><span class="line">         <span class="keyword">if</span> (done) <span class="keyword">return</span> <span class="title function_">resolve</span>(value);</span><br><span class="line">         <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(value).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">next</span>(res);</span><br><span class="line">         &#125;, reject);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="title function_">next</span>();</span><br><span class="line">   &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="模块化开发"><a href="#模块化开发" class="headerlink" title="模块化开发"></a>模块化开发</h2><a href="/posts/b96efc28/" title="模块化开发">模块化开发</a><h2 id="深拷贝与浅拷贝"><a href="#深拷贝与浅拷贝" class="headerlink" title="深拷贝与浅拷贝"></a>深拷贝与浅拷贝</h2><a href="/posts/e98504f5/" title="深浅拷贝">深浅拷贝</a>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> ES新特性 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ES新特性 </tag>
            
            <tag> ES6 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>模块化开发</title>
      <link href="/posts/b96efc28/"/>
      <url>/posts/b96efc28/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="谈谈你对模块化开发的理解？"><a href="#谈谈你对模块化开发的理解？" class="headerlink" title="谈谈你对模块化开发的理解？"></a>谈谈你对模块化开发的理解？</h2><p>我对模块的理解是，一个模块是实现一个特定功能的一组方法。在最开始的时候，js只实现一些简单的功能，所以并没有模块的概念，但随着程序越来越复杂，代码的模块化开发变得越来越重要。</p><p>由于函数具有独立作用域的特点，最原始的写法是使用函数来作为模块，几个函数作为一个模块，但是这种方式容易造成全局变量的污染，并且模块间没有联系。</p><p>后面提出了对象写法，通过将函数作为一个对象的方法来实现，这样解决了直接使用函数作为模块的一些缺点，但是这种办法会暴露所有的所有的模块成员，外部代码可以修改内部属性的值。</p><p>现在最常用的是立即执行函数的写法，通过利用闭包来实现模块私有作用域的建立，同时不会对全局作用域造成污染。</p><p>相关资料：</p><p><a href="https://juejin.cn/post/6844903581661790216" title="https://juejin.cn/post/6844903581661790216">-《浅谈模块化开发》</a></p><p><a href="https://link.juejin.cn/?target=http://www.ruanyifeng.com/blog/2012/10/javascript_module.html" title="http://www.ruanyifeng.com/blog/2012/10/javascript_module.html">《**Javascript **模块化编程（一）：模块的写法》</a></p><p><a href="https://juejin.cn/post/6844903576309858318" title="https://juejin.cn/post/6844903576309858318">《前端模块化：<strong>CommonJS</strong>，AMD，CMD，ES6》</a></p><p><a href="https://link.juejin.cn/?target=http://es6.ruanyifeng.com/%23docs/module" title="http://es6.ruanyifeng.com/#docs/module">《**Module **的语法》</a></p><h2 id="js的模块规范"><a href="#js的模块规范" class="headerlink" title="js的模块规范"></a>js的模块规范</h2><p>js中现在比较成熟的有四种模块加载方案：</p><ol><li>CommonJS方案，它通过require来引入模块，通过module.exports定义模块的输出接口。这种模块加载方案是服务器端的解决方案，它是以同步的方式来引入模块的，因为在服务端文件都存储在本地磁盘，所以读取非常快，所以以同步的方式加载没有问题。但如果是在浏览器端，由于模块的加载是使用网络请求，因此使用异步加载的方式更加合适。<ul><li>值引用</li><li>可动态加载</li><li>可被缓存</li><li>默认严格模式</li></ul></li><li>AMD方案，这种方案采用异步加载的方式来加载模块，模块的加载不影响后面语句的执行，所有依赖这个模块的语句都定义在一个回调函数里，等到加载完成后再执行回调函数。require.js实现了AMD规范。</li><li>CMD方案，这种方案和AMD方案都是为了解决异步模块加载的问题，sea.js实现了CMD规范。它和require.js的区别在于模块定义时对依赖的处理不同和对依赖模块的执行时机的处理不同。</li><li>ES6提出的方案，使用import和export的形式来导入导出模块。</li></ol><h2 id="AMD和CMD规范的区别？"><a href="#AMD和CMD规范的区别？" class="headerlink" title="AMD和CMD规范的区别？"></a>AMD和CMD规范的区别？</h2><p>它们之间的主要区别有两个方面。</p><ol><li>第一个方面是在模块定义时对依赖的处理不同。AMD推崇依赖前置，在定义模块的时候就要声明其依赖的模块。而CMD推崇就近依赖，只有在用到某个模块的时候再去 require。</li><li>第二个方面是对依赖模块的执行时机处理不同。首先AMD和CMD对于模块的加载方式都是异步加载，不过它们的区别在于模块的执行时机，AMD 在依赖模块加载完成后就直接执行依赖模块，依赖模块的执行顺序和我们书写的顺序不一定一致。而 CMD 在依赖模块加载完成后并不执行，只是下载而已，等到所有的依赖模块都加载好后，进入回调函数逻辑，遇到require语句的时候才执行对应的模块，这样模块的执行顺序就和我们书写的顺序保持一致了。</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// CMD</span></span><br><span class="line"><span class="title function_">define</span>(</span><br><span class="line">   <span class="keyword">function</span>(<span class="params"><span class="built_in">require</span>, <span class="built_in">exports</span>, <span class="variable language_">module</span></span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> a = <span class="built_in">require</span>(<span class="string">&quot;./a&quot;</span>);</span><br><span class="line">      a.<span class="title function_">doSomething</span>();</span><br><span class="line">      <span class="comment">// 此处略去 100 行</span></span><br><span class="line">      <span class="keyword">var</span> b = <span class="built_in">require</span>(<span class="string">&quot;./b&quot;</span>);</span><br><span class="line">      <span class="comment">// 依赖可以就近书写</span></span><br><span class="line">      b.<span class="title function_">doSomething</span>();*</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">   &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">//</span> AMD 默认推荐</span><br><span class="line">define([<span class="string">&quot;./a&quot;</span>, <span class="string">&quot;./b&quot;</span>], <span class="keyword">function</span>(a, b) &#123;</span><br><span class="line">   <span class="regexp">//</span> 依赖必须一开始就写好</span><br><span class="line">   a.doSomething();</span><br><span class="line">   <span class="regexp">//</span> 此处略去 <span class="number">100</span> 行</span><br><span class="line">   b.doSomething();</span><br><span class="line">   <span class="regexp">//</span> ...</span><br><span class="line">   &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>相关资料：<br><a href="https://juejin.cn/post/6844903541853650951" title="https://juejin.cn/post/6844903541853650951">《前端模块化，AMD 与 CMD 的区别》</a></p><h2 id="ES6模块与CommonJS模块的差异"><a href="#ES6模块与CommonJS模块的差异" class="headerlink" title="ES6模块与CommonJS模块的差异"></a>ES6模块与CommonJS模块的差异</h2><p>l <strong>CommonJS</strong>模块输出的是一个值的拷贝，ES6模块输出的是值的引用。<strong>CommonJS</strong>模块输出的是值的，也就是说，一旦输出一个值，模块内部的变化就影响不到这个值。ES6模块的运行机制与CommonJS不一样。JS引擎对脚本静态分析的时候，遇到模块加载命令import，就会生成一个只读引用。等到脚本真正执行时，再根据这个只读引用，到被加载的那个模块里面去取值。</p><p>l <strong>CommonJS</strong>模块是运行时加载，ES6模块是编译时输出接口。<strong>CommonJS</strong>模块就是对象，即在输入时是先加载整个模块，生成一个对象，然后再从这个对象上面读取方法，这种加载称为“运行时加载”。而ES6模块不是对象，它的对外接口只是一种静态定义，在代码静态解析阶段就会生成。</p><h3 id="requireJS的核心原理"><a href="#requireJS的核心原理" class="headerlink" title="requireJS的核心原理"></a>requireJS的核心原理</h3><p>require.js的核心原理是通过动态创建script脚本来异步引入模块，然后对每个脚本的load事件进行监听，如果每个脚本都加载完成了，再调用回调函数。</p><p>详细资料可以参考：</p><p><a href="https://link.juejin.cn/?target=https://github.com/HRFE/blog/issues/10" title="https://github.com/HRFE/blog/issues/10">《requireJS 的用法和原理分析》</a></p><p><a href="https://link.juejin.cn/?target=https://zhuanlan.zhihu.com/p/55039478" title="https://zhuanlan.zhihu.com/p/55039478">《requireJS 的核心原理是什么？》</a></p><p><a href="https://link.juejin.cn/?target=https://www.jianshu.com/p/5a39535909e4" title="https://www.jianshu.com/p/5a39535909e4">《requireJS 原理分析》</a></p><h1 id="模块的概念"><a href="#模块的概念" class="headerlink" title="模块的概念"></a>模块的概念</h1><blockquote><p>（Modular design）　所谓的 <strong>模块化设计</strong> ，简单地说就是将产品的某些要素组合在一起，构成一个具有特定功能的子系统，将这个子系统作为通用性的模块与其他产品要素进行多种组合，构成新的系统，产生多种不同功能或相同功能、不同性能的系列产品。</p></blockquote><p>这是在整个设计行业对模块化的定义。对于编程语言中的模块化设计，其基本思路就是将有相同功能的部分代码封装在一起，形成一个通用的，可复用的 <strong>模块</strong> ，使之在其它系统中可以重复利用，并不会对模块内部产生影响。所以设计模式中模块化设计的三大特征也要遵循：</p><ol><li>相对独立性</li><li>互换性</li><li>通用性</li></ol><p>换做在编程语言中，相对独立性即要使私有成员无法被外部访问并暴露给外部指定的方法。通用性在程序设计中多被称为 <strong>可复用性</strong> ，而模块设计的原则和目的也是可复用性。模块可以减少我们对重复代码的编写，提高开发的效率。</p><h2 id="JavaScript对模块的需求"><a href="#JavaScript对模块的需求" class="headerlink" title="JavaScript对模块的需求"></a>JavaScript对模块的需求</h2><p>最初JavaScript是作为网页开发的脚本而开发，Brendan Eich 可能也不会想到当初十几天开发出的一个脚本语言如今会焕发如此的生命力，也正是因为开发周期如此之短，使之缺点在当今工程化的JavaScript中被极大的放大。其中一个就是模块的概念，JavaScript原生并没有模块的概念，就如同没有原生的类一样（尽管ES6推出了所谓的类）。为此，开发者想出了很多方法从语言层面来模拟模块化。</p><h1 id="初期的模块化"><a href="#初期的模块化" class="headerlink" title="初期的模块化"></a>初期的模块化</h1><p>在各类框架，插件没有流行，JavaScript仅作为一门脚本语言的时候，开发人员想出了一些方法来对项目中一些方法集合进行封装，形成类似于模块的模式。</p><h2 id="原生写法"><a href="#原生写法" class="headerlink" title="原生写法"></a>原生写法</h2><h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>模块就是实现特定功能的一组方法。</p><p>只要把不同的函数（以及记录状态的变量）简单地放在一起，就算是一个模块。</p><h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">m1</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">m2</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h3 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h3><ol><li>“污染”了全局变量，无法保证不与其他模块发生变量名冲突</li><li>模块成员之间看不出直接关系。</li></ol><h2 id="对象写法"><a href="#对象写法" class="headerlink" title="对象写法"></a>对象写法</h2><h3 id="描述-1"><a href="#描述-1" class="headerlink" title="描述"></a>描述</h3><p>为了解决上面的“全局变量污染的问题”，又利用了对象这一数据类型，使一个模块成为一个对象，模块的成员作为对象的成员变量。</p><h3 id="例子-1"><a href="#例子-1" class="headerlink" title="例子"></a>例子</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> module1 = <span class="keyword">new</span> <span class="title class_">Object</span>(&#123;</span><br><span class="line"></span><br><span class="line">    _count : <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line">    m1 : <span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    m2 : <span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h3 id="缺点-1"><a href="#缺点-1" class="headerlink" title="缺点"></a>缺点</h3><ol><li>私有变量被直接暴露给外部，如上面的 <code>_count</code>应该是一个保留的私有变量，但是在外部我们也是可以访问到的。</li></ol><h2 id="立即执行函数（IIFE）写法"><a href="#立即执行函数（IIFE）写法" class="headerlink" title="立即执行函数（IIFE）写法"></a>立即执行函数（IIFE）写法</h2><h3 id="描述-2"><a href="#描述-2" class="headerlink" title="描述"></a>描述</h3><p>又为了解决无法保有私有成员的问题（其本质是JavaScript没有局部作用域的问题，具体看<a href="https://link.juejin.cn/?target=https://michaelwang.top/2021/01/31/%25E5%2585%25A8%25E9%259D%25A2%25E7%2590%2586%25E8%25A7%25A3JavaScript%25E4%25BD%259C%25E7%2594%25A8%25E5%259F%259F%25E4%25B8%258E%25E9%2597%25AD%25E5%258C%2585/" title="https://michaelwang.top/2021/01/31/%E5%85%A8%E9%9D%A2%E7%90%86%E8%A7%A3JavaScript%E4%BD%9C%E7%94%A8%E5%9F%9F%E4%B8%8E%E9%97%AD%E5%8C%85/">这里</a>），这里利用了立即执行函数形成一个闭包的同时也形成了一个局部作用域，这个作用域内的变量在外部是无法访问到的。这样就解决了上面的私有便变量的问题。</p><h3 id="例子-2"><a href="#例子-2" class="headerlink" title="例子"></a>例子</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> module1 = (<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> _count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> m1 = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> m2 = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        m1 : m1,</span><br><span class="line">        m2 : m2</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">&#125;)();</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p>这里 <code>module1</code>形成了一个闭包，返回一个对象，我们只能访问到对象暴露的 <code>m1</code>和 <code>m2</code>方法，内部的 <code>_count</code>是无法被访问到了。</p><h3 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h3><ol><li>提高性能：通过 IIFE 的参数传递常用全局对象 window、document，在作用域内引用这些全局对象。JavaScript 解释器首先在作用域内查找属性，然后一直沿着链向上查找，直到全局范围，因此将全局对象放在 IIFE 作用域内可以提升js解释器的查找速度和性能；</li><li>压缩空间：通过参数传递全局对象，压缩时可以将这些全局对象匿名为一个更加精简的变量名；</li></ol><h3 id="缺点-2"><a href="#缺点-2" class="headerlink" title="缺点"></a>缺点</h3><ol><li>不能很好的管理依赖，缺少一个依赖管理者。比如依赖的调用顺序，在没有管理者时，我们必须自己确定调用顺序，比如：<br>我们要调用 <code>module1</code>的 <code>mock</code>方法，<br>而 <code>module1</code>又依赖 <code>module2</code><br><code>module2</code>又依赖 <code>module3</code><br><code>module4</code>又依赖 <code>module3</code><br>我们则必须按这个顺序加载脚本文件<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&#x27;./module4&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&#x27;./module3&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&#x27;./module2&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&#x27;./module1&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">module1.mock()</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure></li></ol><h3 id="立即执行函数（IIFE）的衍生写法"><a href="#立即执行函数（IIFE）的衍生写法" class="headerlink" title="立即执行函数（IIFE）的衍生写法"></a>立即执行函数（IIFE）的衍生写法</h3><h4 id="放大模式"><a href="#放大模式" class="headerlink" title="放大模式"></a>放大模式</h4><h5 id="描述-3"><a href="#描述-3" class="headerlink" title="描述"></a>描述</h5><p>如果一个模块很大，必须分成几个部分，或者一个模块需要继承另一个模块，这时就有必要采用”放大模式”（augmentation）。</p><h5 id="例子-3"><a href="#例子-3" class="headerlink" title="例子"></a>例子</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> module1 = (<span class="keyword">function</span> (<span class="params">mod</span>)&#123;</span><br><span class="line"></span><br><span class="line">    mod.<span class="property">m3</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> mod;</span><br><span class="line"></span><br><span class="line">&#125;)(module1);</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p>上面的代码为 <code>module</code>添加了一个 <code>m3</code>属性。并将新的模块实体返回。</p><h4 id="宽放大模式"><a href="#宽放大模式" class="headerlink" title="宽放大模式"></a>宽放大模式</h4><h5 id="描述-4"><a href="#描述-4" class="headerlink" title="描述"></a>描述</h5><p>对于上面的放大模式，存在一定的问题。由于在浏览器中，所有的资源都是异步加载的，所以上面的参数可能不存在，所以我们必须要考虑这种情况，增强代码的健壮性。</p><h5 id="例子-4"><a href="#例子-4" class="headerlink" title="例子"></a>例子</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> module1 = ( <span class="keyword">function</span> (<span class="params">mod</span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> mod;</span><br><span class="line"></span><br><span class="line">&#125;)(<span class="variable language_">window</span>.<span class="property">module1</span> || &#123;&#125;);</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p>上面的代码相当于是给函数参数设置了一个默认参数为 <code>&#123;&#125;</code>，当 <code>window.module1</code>不存在的时候，在对 <code>&#123;&#125;</code>空对象进行操作。</p><h1 id="现代模块设计"><a href="#现代模块设计" class="headerlink" title="现代模块设计"></a>现代模块设计</h1><p>恩格斯说：“社会一旦有技术上的需要，则这种需要会比十所大学更能把科学院推向前进。”随着进入大前端时代，网站的规模越来越大，逻辑层面越来越复杂。模块化的管理成为必然，很多模块管理框架应运而生。具有代表性的有：</p><ul><li>Node.js中CommonJS</li><li>基于 AMD 的 RequireJS</li><li>基于 CMD 的 SeaJS</li><li>ECMAScript规定的ES Module</li></ul><h2 id="CommonJS"><a href="#CommonJS" class="headerlink" title="CommonJS"></a>CommonJS</h2><h3 id="描述-5"><a href="#描述-5" class="headerlink" title="描述"></a>描述</h3><p>CommonJS 是Node.js中采用的一种规范，其基本原则有：</p><ol><li><strong>由于 <code>Node</code>是在服务端运行，所以 <code>CommonJS</code>的模块加载是同步进行的，所以其在浏览器中并不适用，因为浏览器中的文件都是通过网络加载的，并不适合同步加载。</strong></li><li>每个文件就是一个模块，有自己的作用域。在一个文件里面定义的变量、函数、类，都是私有的，对其他文件不可见。</li><li>每个模块内部有一个全局变量 <code>module</code>，这个变量是一个对象，它的 <code>exports</code>属性（即 <code>module.export</code>）用于导出模块。</li><li>每个模块内部有一个全局变量 <code>require</code>，其是一个函数，用于导入模块，参数即模块的地址。</li><li>模块可以多次加载，但是只会在第一次加载时运行一次，然后运行结果就被缓存了，以后再加载，就直接读取缓存结果。要想让模块再次运行，必须清除缓存。</li><li>模块加载的顺序，按照其在代码中出现的顺序。</li></ol><h3 id="例子-5"><a href="#例子-5" class="headerlink" title="例子"></a>例子</h3><h5 id="导出"><a href="#导出" class="headerlink" title="导出"></a>导出</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//module1.js</span></span><br><span class="line"><span class="keyword">let</span> _temp = -<span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> pi = <span class="number">3.1415926</span></span><br><span class="line"><span class="keyword">let</span> exchange = <span class="keyword">function</span>(<span class="params">a, b</span>)&#123;</span><br><span class="line">    _temp = a</span><br><span class="line">    a = b</span><br><span class="line">    b = _temp</span><br><span class="line">    <span class="keyword">return</span> [a,b]</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">export</span>.<span class="property">pi</span> = pi</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">export</span>.<span class="property">exchange</span> = exchange</span><br><span class="line"></span><br><span class="line"><span class="comment">//或者这么写</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">export</span>.<span class="property">sum</span> = <span class="keyword">function</span>(<span class="params">a, b</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line">&#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h5 id="导入"><a href="#导入" class="headerlink" title="导入"></a>导入</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> module1 = <span class="built_in">require</span>(<span class="string">&#x27;./module1.js&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(module1.<span class="title function_">exchange</span>(<span class="number">1</span>, <span class="number">2</span>))<span class="comment">//[2, 1]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(module1.<span class="property">pi</span>)<span class="comment">//3.1415926</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h3 id="详细介绍"><a href="#详细介绍" class="headerlink" title="详细介绍"></a>详细介绍</h3><h4 id="module对象"><a href="#module对象" class="headerlink" title="module对象"></a>module对象</h4><p><code>Node</code>内部提供一个 <code>Module</code>构建函数。所有的模块都是 <code>Module</code>的实例。</p><p>查看 <code>Node</code>源码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Module</span>(<span class="params">id, parent</span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">id</span> = id;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">exports</span> = &#123;&#125;;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">parent</span> = parent;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p>可以发现其是一个构造器函数，其中设置了以下属性：</p><ul><li><code>module.id</code>：模块的识别符，通常是带有绝对路径的模块文件名。</li><li><code>module.filename</code> 模块的文件名，带有绝对路径。</li><li><code>module.loaded</code> 返回一个布尔值，表示模块是否已经完成加载。</li><li><code>module.parent</code> 返回一个对象，表示调用该模块的父级块。</li><li><code>module.children</code> 返回一个数组，表示该模块要用到的其他子级模块。</li><li><code>module.exports</code> 表示模块对外输出的值。</li></ul><p>实际上我们模块导入的过程就是为对应模块的 <code>module.exports</code>对象增加成员的过程。</p><h4 id="目录加载规则"><a href="#目录加载规则" class="headerlink" title="目录加载规则"></a>目录加载规则</h4><p>通常一个项目都有一个入口文件（或函数），比如C语言，Java中的 <code>main</code>函数。在 <code>Node</code>项目中，一般也会指定一个入口文件，让 <code>require</code>方法可以通过这个入口文件，加载整个项目。</p><p>一般这个入口放在 <code>packge.json</code>文件，并将入口文件写入 <code>main</code>字段。如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//packge.json</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;new_project&quot;</span>,</span><br><span class="line">    <span class="string">&quot;main&quot;</span>: <span class="string">&quot;./main/index.js&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p><code>require</code>发现参数字符串指向一个目录以后，会自动查看该目录的 <code>packge.json</code>文件，然后加载 <code>main</code>字段指定的入口文件。如果 <code>packge.json</code>文件没有 <code>main</code>字段，或者没有 <code>packge.json</code>文件，则会加载该目录下的 <code>index.js</code>文件或者 <code>index.node</code>文件。</p><h4 id="模块缓存"><a href="#模块缓存" class="headerlink" title="模块缓存"></a>模块缓存</h4><p>Node会在第一次加载模块后，缓冲该模块（实际上是缓存该模块的 <code>module.exports</code>属性）。如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;./moudle1.js&#x27;</span>)</span><br><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;./moudle1.js&#x27;</span>).<span class="property">num</span> = <span class="number">1</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;./moudle1.js&#x27;</span>).<span class="property">num</span><span class="comment">//1</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p>上面三次导入一个模块，但是我们添加的成员变量在第三次缓冲时仍然可以访问到，证明其是被缓冲在内存中的。</p><p>我们可以通过删除 <code>require.cache</code>的对应属性来删除模块缓冲。</p><h5 id="删除模块缓冲"><a href="#删除模块缓冲" class="headerlink" title="删除模块缓冲"></a>删除模块缓冲</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//删除指定模块</span></span><br><span class="line"><span class="keyword">delete</span> <span class="built_in">require</span>.<span class="property">cache</span>[moduleName]</span><br><span class="line"><span class="title class_">Reflect</span>.<span class="title function_">deleteProperty</span>(<span class="built_in">require</span>.<span class="property">cache</span>, moduleName)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除所有模块的缓存</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">keys</span>(<span class="built_in">require</span>.<span class="property">cache</span>).<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">key</span>) &#123;</span><br><span class="line">  <span class="keyword">delete</span> <span class="built_in">require</span>.<span class="property">cache</span>[key];</span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h4 id="模块的加载机制"><a href="#模块的加载机制" class="headerlink" title="模块的加载机制"></a>模块的加载机制</h4><p><code>CommonJS</code> 模块的加载机制是，输入的是被输出的值的拷贝。也就是说，一旦输出一个值，模块内部的变化就影响不到这个值。请看下面这个例子。</p><p>下面是一个模块文件 <code>lib.js</code>。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// lib.js</span></span><br><span class="line"><span class="keyword">var</span> counter = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">incCounter</span>(<span class="params"></span>) &#123;</span><br><span class="line">  counter++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">counter</span>: counter,</span><br><span class="line">  <span class="attr">incCounter</span>: incCounter,</span><br><span class="line">&#125;;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p>上面代码输出内部变量 <code>counter</code> 和改写这个变量的内部方法 <code>incCounter</code>。</p><p>然后，加载上面的模块。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">var</span> counter = <span class="built_in">require</span>(<span class="string">&#x27;./lib&#x27;</span>).<span class="property">counter</span>;</span><br><span class="line"><span class="keyword">var</span> incCounter = <span class="built_in">require</span>(<span class="string">&#x27;./lib&#x27;</span>).<span class="property">incCounter</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(counter);  <span class="comment">// 3</span></span><br><span class="line"><span class="title function_">incCounter</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(counter); <span class="comment">// 3</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p>上面代码说明，<code>counter</code> 输出以后，<code>lib.js</code> 模块内部的变化就影响不到 <code>counter</code> 了。</p><h2 id="AMD"><a href="#AMD" class="headerlink" title="AMD"></a>AMD</h2><h3 id="描述-6"><a href="#描述-6" class="headerlink" title="描述"></a>描述</h3><p>AMD 全称为  <strong>Asynchromous Module Definition（异步模块定义）</strong> 。 AMD 是 RequireJS 在推广过程中对模块定义的规范化产出，它是一个在浏览器端模块化开发的规范。 AMD 模式可以用于浏览器环境并且允许<strong>异步</strong>加载模块，同时又能保证正确的顺序，也可以按需动态加载模块。</p><h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h3><ul><li><code>AMD</code>是依赖前置，即提前声明需要的依赖。</li><li>对依赖的加载是提前进行的，在运行前就加载所有的依赖。</li></ul><h3 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h3><p>模块通过 <code>define</code> 函数定义在闭包中，格式如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">define</span>(id?: <span class="title class_">String</span>, dependencies?: <span class="title class_">String</span>[], <span class="attr">factory</span>: <span class="title class_">Function</span>|<span class="title class_">Object</span>);</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p><code>id</code> 是模块的名字，它是可选的参数。</p><p><code>dependencies</code> 指定了所要依赖的模块列表，它是一个数组，也是可选的参数，每个依赖的模块的输出将作为参数一次传入 <code>factory</code> 中。如果没有指定 <code>dependencies</code>，那么它的默认值是 <code>[&quot;require&quot;, &quot;exports&quot;, &quot;module&quot;]</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">define</span>(<span class="keyword">function</span>(<span class="params"><span class="built_in">require</span>, <span class="built_in">exports</span>, <span class="variable language_">module</span></span>) &#123;&#125;）</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p><code>factory</code> 是最后一个参数，它包裹了模块的具体实现，它是一个函数或者对象。如果是函数，那么它的返回值就是模块的输出接口或值。</p><h3 id="例子-require-js"><a href="#例子-require-js" class="headerlink" title="例子(require.js)"></a>例子(<code>require.js</code>)</h3><h4 id="定义模块"><a href="#定义模块" class="headerlink" title="定义模块"></a>定义模块</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">define</span>([<span class="string">&#x27;jquery&#x27;</span>], <span class="keyword">function</span>(<span class="params">$</span>)P&#123;</span><br><span class="line"> <span class="keyword">var</span> num = <span class="number">555</span></span><br><span class="line">     <span class="keyword">var</span> _version = <span class="number">0.01</span></span><br><span class="line">   </span><br><span class="line">     <span class="keyword">var</span> showMessage = <span class="keyword">function</span>(<span class="params">message</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(!message)&#123;</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                $(<span class="string">&#x27;#messageBox&#x27;</span>).<span class="title function_">html</span>(<span class="string">&#x27;欢迎访问&#x27;</span> + name)</span><br><span class="line">            &#125;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">return</span>&#123;</span><br><span class="line">         <span class="string">&#x27;num&#x27;</span>:num,</span><br><span class="line">         <span class="string">&#x27;showMessage&#x27;</span>: showMessage</span><br><span class="line">     &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//_version为内部维护变量，无法被外部访问到</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h4 id="引入模块"><a href="#引入模块" class="headerlink" title="引入模块"></a>引入模块</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 配置文件</span></span><br><span class="line"><span class="built_in">require</span>.<span class="title function_">config</span>(&#123;</span><br><span class="line">    <span class="attr">baseUrl</span>: <span class="string">&#x27;js&#x27;</span>,</span><br><span class="line">    <span class="attr">paths</span>: &#123;</span><br><span class="line">        <span class="attr">jquery</span>: <span class="string">&#x27;lib/jquery-1.11.1&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 加载模块</span></span><br><span class="line"><span class="built_in">require</span>([<span class="string">&#x27;jquery&#x27;</span>, <span class="string">&#x27;script/hello&#x27;</span>],<span class="keyword">function</span> (<span class="params">$, hello</span>) &#123;</span><br><span class="line">    $(<span class="string">&quot;#btn&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">      hello.<span class="title function_">showMessage</span>(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h2 id="CMD"><a href="#CMD" class="headerlink" title="CMD"></a>CMD</h2><h3 id="描述-7"><a href="#描述-7" class="headerlink" title="描述"></a>描述</h3><p>CMD（Common Module Definition） 是 SeaJS 在推广过程中对模块定义的规范化产出。CMD 规范的前身是 Modules&#x2F;Wrappings 规范。</p><h3 id="特点-1"><a href="#特点-1" class="headerlink" title="特点"></a>特点</h3><ul><li>CMD推崇依赖就近，即在依赖使用时才引入。</li><li>CMD是延迟执行的，即使用的时候才延迟执行的。</li></ul><h3 id="用法（SeaJS）"><a href="#用法（SeaJS）" class="headerlink" title="用法（SeaJS）"></a>用法（SeaJS）</h3><p>1、 <strong><code>seajs.config</code></strong> ({…});  &#x2F;&#x2F;用来对 Sea.js 进行配置。<br>2、 <strong><code>seajs.use</code></strong> ([‘a’,’b’],function(a,b){…});  &#x2F;&#x2F;用来在页面中加载一个或多个模块。<br>3、 <strong><code>define</code></strong> (function(require, exports, module){…});  &#x2F;&#x2F;用来定义模块。Sea.js 推崇一个模块一个文件，遵循统一的写法：<br>4、 <strong><code>require</code></strong> (function(require){var a &#x3D; require(“xModule”); … });  &#x2F;&#x2F;require 用来获取指定模块的接口。<br>5、 <strong><code>require.async</code></strong> ,  &#x2F;&#x2F;用来在模块内部异步加载一个或多个模块。 例如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">define</span>(<span class="keyword">function</span>(<span class="params"><span class="built_in">require</span></span>)&#123;</span><br><span class="line">    <span class="built_in">require</span>.<span class="title function_">async</span>([<span class="string">&#x27;aModule&#x27;</span>,<span class="string">&#x27;bModule&#x27;</span>],<span class="keyword">function</span>(<span class="params">a,b</span>)&#123;  <span class="comment">// 异步加载多个模块，在加载完成时，执行回调</span></span><br><span class="line">    a.<span class="title function_">func</span>();</span><br><span class="line">    b.<span class="title function_">func</span>();</span><br><span class="line">    &#125;)  </span><br><span class="line">&#125;);</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p>6、 <strong><code>exports</code></strong> , &#x2F;&#x2F;用来在模块内部对外提供接口。 例如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">define</span>(<span class="keyword">function</span>(<span class="params"><span class="built_in">require</span>, <span class="built_in">exports</span></span>)&#123;</span><br><span class="line">    <span class="built_in">exports</span>.<span class="property">varName01</span> = <span class="string">&#x27;varValue&#x27;</span>;  <span class="comment">// 对外提供 varName01 属性  </span></span><br><span class="line">    <span class="built_in">exports</span>.<span class="property">funName01</span> = <span class="keyword">function</span>(<span class="params">p1,p2</span>)&#123;  <span class="comment">// 对外提供 funName01 方法</span></span><br><span class="line">    ....</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;);</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p>7、 <strong><code>module.exports</code></strong> , 与 exports 类似，用来在模块内部对外提供接口。例如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">define</span>(<span class="keyword">function</span>(<span class="params"><span class="built_in">require</span>, <span class="built_in">exports</span>, <span class="variable language_">module</span></span>) &#123;  </span><br><span class="line">  <span class="variable language_">module</span>.<span class="property">exports</span> = &#123;  <span class="comment">// 对外提供接口</span></span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;a&#x27;</span>,</span><br><span class="line">    <span class="attr">doSomething</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;...&#125;;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h3 id="例子-6"><a href="#例子-6" class="headerlink" title="例子"></a>例子</h3><h4 id="定义模块-1"><a href="#定义模块-1" class="headerlink" title="定义模块"></a>定义模块</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// seajs 的简单配置</span></span><br><span class="line">seajs.<span class="title function_">config</span>(&#123;</span><br><span class="line">  <span class="attr">base</span>: <span class="string">&quot;../sea-modules/&quot;</span>,</span><br><span class="line">  <span class="attr">alias</span>: &#123;</span><br><span class="line">    <span class="string">&quot;jquery&quot;</span>: <span class="string">&quot;jquery/jquery/1.10.1/jquery.js&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 所有模块都通过 define 来定义</span></span><br><span class="line"><span class="title function_">define</span>(<span class="keyword">function</span>(<span class="params"><span class="built_in">require</span>, <span class="built_in">exports</span>, <span class="variable language_">module</span></span>) &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 通过 require 引入依赖</span></span><br><span class="line">  <span class="keyword">var</span> $ = <span class="built_in">require</span>(<span class="string">&#x27;jquery&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> <span class="title class_">Spinning</span> = <span class="built_in">require</span>(<span class="string">&#x27;./spinning&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 通过 exports 对外提供接口</span></span><br><span class="line">  <span class="built_in">exports</span>.<span class="property">doSomething</span> = ...</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 或者通过 module.exports 提供整个接口</span></span><br><span class="line">  <span class="variable language_">module</span>.<span class="property">exports</span> = ...</span><br><span class="line"></span><br><span class="line">  <span class="comment">//或者使用return向外提供接口</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">someVal</span>: someVal,</span><br><span class="line">      <span class="attr">doSomething</span>: doSomething</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p>如果 <code>retunr</code>语句是模块的唯一代码，还可以简化为：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">define</span>(&#123;</span><br><span class="line">  <span class="attr">someVal</span>: someVal,</span><br><span class="line">  <span class="attr">doSomething</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">&#125;);</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h4 id="引入模块-1"><a href="#引入模块-1" class="headerlink" title="引入模块"></a>引入模块</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//单一模式</span></span><br><span class="line">seajs.<span class="title function_">use</span>(<span class="string">&#x27;./a&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment">//回调模式</span></span><br><span class="line">seajs.<span class="title function_">use</span>(<span class="string">&#x27;./a&#x27;</span>, <span class="keyword">function</span>(<span class="params">a</span>) &#123;</span><br><span class="line">  a.<span class="title function_">run</span>()</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line"><span class="comment">//多模块模式</span></span><br><span class="line">seajs.<span class="title function_">use</span>([<span class="string">&#x27;./a&#x27;</span>, <span class="string">&#x27;./b&#x27;</span>], <span class="keyword">function</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">  a.<span class="title function_">run</span>()</span><br><span class="line">  b.<span class="title function_">run</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//在一个模块中引入其他模块</span></span><br><span class="line"><span class="title function_">define</span>(<span class="keyword">function</span>(<span class="params"><span class="built_in">require</span>, <span class="built_in">exports</span>, <span class="variable language_">module</span></span>) &#123;</span><br><span class="line">    <span class="comment">//同步引入其他模块</span></span><br><span class="line">    <span class="keyword">var</span> module1 = <span class="built_in">require</span>(<span class="string">&#x27;./module1&#x27;</span>)</span><br><span class="line">  </span><br><span class="line">    <span class="comment">//异步引入其他模块</span></span><br><span class="line">    <span class="keyword">var</span> module2 = <span class="built_in">require</span>.<span class="title function_">async</span>(<span class="string">&#x27;./module2&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p> <strong>注意</strong> ：</p><ul><li>对 <code>module.exports</code> 的赋值需要同步执行，不能放在回调函数里。</li><li>在 <code>html</code>中 ，为 <code>script</code>标签添加 <code>data-main = true</code>确定其为主入口。data-main通常用在只有一个入口的情况，use可以用在多个入口的情况</li></ul><h2 id="UMD"><a href="#UMD" class="headerlink" title="UMD"></a>UMD</h2><h3 id="描述-8"><a href="#描述-8" class="headerlink" title="描述"></a>描述</h3><p>UMD（Universal Module Definition），AMD模块以浏览器第一的原则发展，异步加载模块。CommonJS模块以服务器第一原则发展，选择同步加载，它的模块无需包装(unwrapped modules)。这迫使人们又想出另一个更通用的模式UMD （Universal Module Definition）。希望解决跨平台的解决方案。</p><h3 id="特点-2"><a href="#特点-2" class="headerlink" title="特点"></a>特点</h3><ul><li>兼容 AMD 和 CommonJS 规范的同时，还兼容全局引用的方式</li></ul><h3 id="例子-7"><a href="#例子-7" class="headerlink" title="例子"></a>例子</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span> (<span class="params">root, factory</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> define === <span class="string">&#x27;function&#x27;</span> &amp;&amp; define.<span class="property">amd</span>) &#123;</span><br><span class="line">        <span class="comment">//AMD</span></span><br><span class="line">        <span class="title function_">define</span>([<span class="string">&#x27;jquery&#x27;</span>], factory);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">exports</span> === <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">        <span class="comment">//Node, CommonJS之类的</span></span><br><span class="line">        <span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title function_">factory</span>(<span class="built_in">require</span>(<span class="string">&#x27;jquery&#x27;</span>));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//浏览器全局变量(root 即 window)</span></span><br><span class="line">        root.<span class="property">returnExports</span> = <span class="title function_">factory</span>(root.<span class="property">jQuery</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;(<span class="variable language_">this</span>, <span class="keyword">function</span> (<span class="params">$</span>) &#123;</span><br><span class="line">    <span class="comment">//方法</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">myFunc</span>(<span class="params"></span>)&#123;&#125;;</span><br><span class="line">    <span class="comment">//暴露公共方法</span></span><br><span class="line">    <span class="keyword">return</span> myFunc;</span><br><span class="line">&#125;));</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h2 id="ES-Module"><a href="#ES-Module" class="headerlink" title="ES Module"></a>ES Module</h2><h3 id="描述-9"><a href="#描述-9" class="headerlink" title="描述"></a>描述</h3><p>在 ES Module 之前，社区制定了一些模块加载方案，最主要的有 CommonJS 和 AMD 两种。前者用于服务器，后者用于浏览器。ES Module 在语言标准的层面上，实现了模块功能，而且实现得相当简单，完全可以取代 CommonJS 和 AMD 规范，成为浏览器和服务器通用的模块解决方案。</p><p>ES Module 的设计思想是尽量的静态化，使得编译时就能确定模块的依赖关系，以及输入和输出的变量。CommonJS 和 AMD 模块，都只能在运行时确定这些东西。</p><p>CommonJS 和 AMD 模块，其本质是在运行时生成一个<strong>对象</strong>进行导出，称为“运行时加载”，没法进行“编译优化”，而 ES Module 不是对象，而是通过 <code>export</code> 命令显式指定输出的代码，再通过 <code>import</code> 命令输入。这称为“编译时加载”或者静态加载，即 ES Module 可以在编译时就完成模块加载，效率要比 CommonJS 模块的加载方式高。当然，这也导致了没法引用 ES Module 模块本身，因为它不是对象。</p><p>由于 ES Module 是编译时加载，使得静态分析成为可能。有了它，就能进一步拓宽 JavaScript 的语法，比如引入宏（macro）和类型检验（type system）这些只能靠静态分析实现的功能。</p><p>除了静态加载带来的各种好处，ESz  Module 还有以下好处：</p><ul><li>不再需要 UMD 模块格式了，将来服务器和浏览器都会支持 ES Module 格式。目前，通过各种工具库，其实已经做到了这一点。</li><li>将来浏览器的新 API 就能用模块格式提供，不再必须做成全局变量或者 navigator 对象的属性。</li><li>不再需要对象作为命名空间（比如 Math 对象），未来这些功能可以通过模块提供。</li></ul><h3 id="特点-3"><a href="#特点-3" class="headerlink" title="特点"></a>特点</h3><ul><li>静态编译</li><li>输出的值引用，而非值拷贝</li><li><code>import</code> 只能写在顶层，因为是静态语法</li><li>ES6 的模块自动采用严格模式，不管你有没有在模块头部加上 <code>&quot;use strict&quot;;</code>。（具体严格模式内容不再赘述）</li></ul><h3 id="例子-8"><a href="#例子-8" class="headerlink" title="例子"></a>例子</h3><h4 id="导出模块"><a href="#导出模块" class="headerlink" title="导出模块"></a>导出模块</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//module1.js</span></span><br><span class="line"><span class="keyword">let</span> pi = <span class="number">3.1415926</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> d = <span class="string">&#x27;default&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> sum = <span class="keyword">function</span>(<span class="params">a, b</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> bactch1 = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> bactch2 = <span class="number">2</span></span><br><span class="line"><span class="keyword">let</span> bactch3 = <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//导出已定义的变量</span></span><br><span class="line"><span class="keyword">export</span> pi</span><br><span class="line"><span class="keyword">export</span> sum</span><br><span class="line"></span><br><span class="line"><span class="comment">//直接导出声明的变量</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> e = <span class="number">2.718281828459</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">multiply</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> x * y;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//批量导出</span></span><br><span class="line"><span class="keyword">export</span> &#123;bactch1, bactch2, bactch3&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//导出默认</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> d</span><br><span class="line"><span class="comment">//对导出变量重命名,并且重命名为default，与上面的说法一致</span></span><br><span class="line"><span class="keyword">export</span> &#123;d <span class="keyword">as</span> <span class="keyword">default</span>&#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p>注意：</p><ul><li><p><code>export default</code> 命令用于指定模块的默认输出。<code>export default</code> 就是输出一个叫做 <code>default</code> 的变量或方法，然后系统允许你为它取任意名字</p></li><li><p><code>export default</code>只能导出变量，不能在后面声明变量。如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//错误</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">const</span> pi = <span class="number">3.1415926</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure></li><li><p><code>export</code>语句输出的接口，与其对应的值是动态绑定关系，即通过该接口，可以取到模块内部实时的值。<br>如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">var</span> foo = <span class="string">&#x27;bar&#x27;</span>;</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> foo = <span class="string">&#x27;baz&#x27;</span>, <span class="number">500</span>);</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p>面代码输出变量 <code>foo</code>，值为 <code>bar</code>，500 毫秒之后变成 <code>baz</code>。</p></li></ul><h4 id="导入模块"><a href="#导入模块" class="headerlink" title="导入模块"></a>导入模块</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//直接导入模块所有成员</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">from</span> <span class="string">&#x27;module1&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//批量导入模块</span></span><br><span class="line"><span class="keyword">import</span> &#123;pi, e, sum&#125; <span class="keyword">from</span> <span class="string">&#x27;module1&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//直接执行所加载的模块</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;lodash&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//在一条import语句中，同时输入默认方法和其他接口</span></span><br><span class="line"><span class="keyword">import</span> _, &#123; each, forEach &#125; <span class="keyword">from</span> <span class="string">&#x27;lodash&#x27;</span>;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h4 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h4><ol><li><code>export</code>后无法直接接变量内容。如：<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//错误</span></span><br><span class="line"><span class="keyword">export</span> <span class="number">3</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure></li></ol><h4 id="import"><a href="#import" class="headerlink" title="import()"></a>import()</h4><p><code>import</code>命令会被 JavaScript 引擎静态分析，先于模块内的其他语句执行（<code>import</code>命令叫做“连接” binding 其实更合适）。所以 <code>import</code>和 <code>export</code>命令只能在模块的顶层，不能在代码块之中。如，下面的代码会报错</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 报错</span></span><br><span class="line"><span class="keyword">if</span> (x === <span class="number">2</span>) &#123;</span><br><span class="line">  <span class="keyword">import</span> <span class="title class_">MyModual</span> <span class="keyword">from</span> <span class="string">&#x27;./myModual&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p>但是有时候我们需要按需引入又该怎么办，<a href="https://link.juejin.cn/?target=https://github.com/tc39/proposal-dynamic-import" title="https://github.com/tc39/proposal-dynamic-import">ES2020提案</a> 引入 <code>import()</code>函数，支持动态加载模块。</p><p><code>import(specifier)</code></p><h5 id="特点-4"><a href="#特点-4" class="headerlink" title="特点"></a>特点</h5><ol><li><code>import</code>函数的参数 <code>specifier</code>，指定所要加载的模块的位置。</li><li><code>import</code>命令能够接受什么参数，<code>import()</code>函数就能接受什么参数，两者区别主要是后者为动态加载。</li><li><code>import()</code>返回一个 Promise 对象。模块作为 <code>Promise</code>的参数返回下面是一个例子。</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> main = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;main&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">import</span>(<span class="string">`./section-modules/<span class="subst">$&#123;someVariable&#125;</span>.js`</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">module</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">module</span>.<span class="title function_">loadPageInto</span>(main);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    main.<span class="property">textContent</span> = err.<span class="property">message</span>;</span><br><span class="line">  &#125;);</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p><code>import()</code>函数可以用在任何地方，不仅仅是模块，非模块的脚本也可以使用。它是运行时执行，也就是说，什么时候运行到这一句，就会加载指定的模块。另外，<code>import()</code>函数与所加载的模块没有静态连接关系，这点也是与 <code>import</code>语句不相同。<code>import()</code>类似于 Node 的 <code>require</code>方法，区别主要是前者是异步加载，后者是同步加载。</p><h2 id="兼容性"><a href="#兼容性" class="headerlink" title="兼容性"></a>兼容性</h2><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a0047ec8a0384bc9853163c873d28cea~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="ESModule兼容性.png"></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>目前JavaScript的模块规范就是上面谈到的四种，CommonJS、AMD、CMD、ES Module。 CommonJS 用在服务器端，AMD 和CMD 用在浏览器环境，ES Module 是作为终极通用解决方案，时下热议的<a href="https://link.juejin.cn/?target=https://github.com/vitejs/vite" title="https://github.com/vitejs/vite">vite</a>即利用了ES Module。</p><h2 id="比较"><a href="#比较" class="headerlink" title="比较"></a>比较</h2><h3 id="AMD-和-CMD-的区别"><a href="#AMD-和-CMD-的区别" class="headerlink" title="AMD 和 CMD 的区别"></a>AMD 和 CMD 的区别</h3><ul><li>执行时机： AMD 是提前执行，CMD 是延迟执行。</li><li>对依赖的处理：AMD 推崇依赖前置，CMD 推崇依赖就近。</li><li>API 设计理念：AMD 的 API 默认是一个当多个用，非常灵活，CMD 的 API 严格区分，推崇职责单一。</li><li>遵循的规范：RequireJS 遵循的是 Modules&#x2F;AMD 规范，SeaJS 遵循的是 Mdoules&#x2F;Wrappings 规范的 define 形式。</li><li>设计理念：SeaJS 设计理念是 focus on web, 努力成为浏览器端的模块加载器，RequireJS 想成为浏览器端的模块加载器，同时也想成为 Rhino &#x2F; Node 等环境的模块加载器。</li></ul><h3 id="CommonJS-和-ES-Module-的区别"><a href="#CommonJS-和-ES-Module-的区别" class="headerlink" title="CommonJS 和 ES Module 的区别"></a>CommonJS 和 ES Module 的区别</h3><ul><li>加载时机：CommonJS 是运行时加载（动态加载），ES Module 是编译时加载（静态加载）</li><li>加载模块：CommonJS 模块就是对象，加载的是该对象，ES Module 模块不是对象，加载的不是对象，是接口</li><li>加载结果：CommonJS 加载的是整个模块，即将所有的接口全部加载进来，ES Module 可以单独加载其中的某个接口（方法）</li><li>输出：CommonJS 输出值的拷贝，ES Module 输出值的引用</li><li>this: CommonJS 指向当前模块，ES Module 指向 undefined</li></ul><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ul><li><a href="https://juejin.cn/post/6844903826600755214" title="https://juejin.cn/post/6844903826600755214">JavaScript 模块化总结</a></li><li><a href="https://link.juejin.cn/?target=https://es6.ruanyifeng.com/?search=import&x=0&y=0%23docs/module" title="https://es6.ruanyifeng.com/?search=import&amp;x=0&amp;y=0#docs/module">Module 的语法-阮一峰</a></li><li><a href="https://link.juejin.cn/?target=https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/import" title="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/import">import-MDN</a></li><li><a href="https://link.juejin.cn/?target=http://www.ruanyifeng.com/blog/2012/10/javascript_module.html" title="http://www.ruanyifeng.com/blog/2012/10/javascript_module.html">Javascript模块化编程（一）：模块的写法-阮一峰</a></li></ul><p>作者：MW530<br>链接：<a href="https://juejin.cn/post/7116775733887762445">https://juejin.cn/post/7116775733887762445</a><br>来源：稀土掘金<br>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> ES新特性 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ES6 </tag>
            
            <tag> 模块化开发 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>防抖与节流</title>
      <link href="/posts/100fa4c9/"/>
      <url>/posts/100fa4c9/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">函数防抖</button></li><li class="tab"><button type="button" data-href="#super-2">函数节流</button></li><li class="tab"><button type="button" data-href="#super-3">总结异同点</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><strong>定义</strong>：在事件被触发 n 秒后再执行回调，如果在这 n 秒内事件又被触发，则重新计时。<br><strong>应用场景</strong>：在一些点击请求的事件上，避免因为用户的多次点击向后端发送多次请求。<br><strong>实现方法</strong>：<br>    事件触发<br>&#x3D;&#x3D;&gt; 开启一个定时器<br>&#x3D;&#x3D;&gt; 如果再次触发，则清除上一个事件触发，重写一个定时器<br>&#x3D;&#x3D;&gt; 定时时间到，触发事件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 函数防抖的实现</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">debounce</span>(<span class="params">fn, wait</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> timer = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> context = <span class="variable language_">this</span>,</span><br><span class="line">        args = <span class="variable language_">arguments</span>;</span><br><span class="line">    <span class="comment">// 如果此时存在定时器的话，则取消之前的定时器，重新记时</span></span><br><span class="line">    <span class="keyword">if</span> (timer) &#123;</span><br><span class="line">      <span class="built_in">clearTimeout</span>(timer);</span><br><span class="line">      timer = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// 设置定时器，使事件间隔指定事件后执行</span></span><br><span class="line">    timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      fn.<span class="title function_">apply</span>(context, args);</span><br><span class="line">    &#125;, wait);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><strong>定义</strong>：规定一个单位时间，在这个单位时间内，只能有一次触发事件的回调函数执行，如果在同一个单位时间内某事件被触发多次，只有一次能生效。<br><strong>应用场景</strong>：节流可以使用在 scroll 函数的事件监听上，通过事件节流来降低事件调用的频率。<br><strong>实现方法</strong>：<br>    事件触发<br>&#x3D;&#x3D;&gt; 操作执行<br>&#x3D;&#x3D;&gt; 关闭阀门<br>&#x3D;&#x3D;&gt; 阀门关闭，后续触发无效<br>&#x3D;&#x3D;&gt; 一段时间过后，阀门打开<br>&#x3D;&#x3D;&gt; 操作可再次触发</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 函数节流的实现</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">throttle</span>(<span class="params">fn, delay</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> valid = <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> context = <span class="variable language_">this</span>,</span><br><span class="line">        args = <span class="variable language_">arguments</span>;</span><br><span class="line">    <span class="comment">// 如果两次时间间隔超过了指定时间，则执行函数</span></span><br><span class="line">    <span class="keyword">if</span> (valid) &#123;</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        fn.<span class="title function_">apply</span>(context, args);</span><br><span class="line">        valid = <span class="literal">true</span>;</span><br><span class="line">      &#125;, delay);</span><br><span class="line">      valid = <span class="literal">false</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>相同点：<br>为了阻止操作高频触发，浪费性能<br>区别：<br>防抖：让你多次触发，只失效最后一次。适用于只需要一次触发生效的场景<br>节流：让你的操作，每隔一段时间才能触发。适用于多次触发需要多次生效的场景。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>详细资料可以参考：<br><a href="https://juejin.cn/post/6844903535125987335">《轻松理解 JS 函数节流和函数防抖》</a><br><a href="https://juejin.cn/post/6844903575663935496">《JavaScript 事件节流和事件防抖》</a><br><a href="https://juejin.cn/post/6844903618827517965">《JS 的防抖与节流》</a></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 函数式编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 防抖/节流 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>设计模式</title>
      <link href="/posts/364ea8cc/"/>
      <url>/posts/364ea8cc/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="设计模式"><a href="#设计模式" class="headerlink" title="设计模式"></a>设计模式</h2><h3 id="1-概念"><a href="#1-概念" class="headerlink" title="1. 概念"></a>1. 概念</h3><p>设计模式是一套被反复使用的、多数人知晓的、经过分类编目的、代码设计经验的总结。使用设计模式是为了重用代码、让代码更容易被他人理解、保证代码可靠性。毫无疑问，设计模式于己于他人于系统都是多赢的，设计模式使代码编制真正工程化，设计模式是软件工程的基石，如同大厦的一块块砖石一样。</p><h3 id="2-设计原则"><a href="#2-设计原则" class="headerlink" title="2. 设计原则"></a>2. 设计原则</h3><p><strong>S – Single Responsibility Principle 单一职责原则</strong><br>    o 一个程序只做好一件事<br>    o 如果功能过于复杂就拆分开，每个部分保持独立</p><p><strong>O – OpenClosed Principle 开放&#x2F;封闭原则</strong><br>    o 对扩展开放，对修改封闭<br>    o 增加需求时，扩展新代码，而非修改已有代码</p><p><strong>L – Liskov Substitution Principle 里氏替换原则</strong><br>    o 子类能覆盖父类<br>    o 父类能出现的地方子类就能出现</p><p><strong>I – Interface Segregation Principle 接口隔离原则</strong><br>    o 保持接口的单一独立<br>    o 类似单一职责原则，这里更关注接口</p><p><strong>D – Dependency Inversion Principle 依赖倒转原则</strong><br>    o 面向接口编程，依赖于抽象而不依赖于具<br>    o 使用方只关注接口而不关注具体类的实现</p><h3 id="3-设计模式的类型"><a href="#3-设计模式的类型" class="headerlink" title="3. 设计模式的类型"></a>3. 设计模式的类型</h3><ol><li><strong>创建型模式（Creational Patterns）</strong><blockquote><p>处理对象的创建，根据实际情况使用合适的方式创建对象。常规的对象创建方式可能会导致设计上的问题，或增加设计的复杂度。创建型模式通过以某种方式控制对象的创建来解决问题。</p></blockquote></li><li><strong>结构型模式（structural Patterns）</strong><blockquote><p>通过识别系统中组件间的简单关系来简化系统的设计。</p></blockquote></li><li><strong>行为型模式（Behavioral Patterns）</strong><blockquote><p>用于识别对象之间常见的交互模式并加以实现，如此，增加了这些交互的灵活性。</p></blockquote></li></ol><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">创建型模式</button></li><li class="tab"><button type="button" data-href="#super-2">结构型模式</button></li><li class="tab"><button type="button" data-href="#super-3">行为型模式</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>单例模式：某个类只能有一个实例，提供一个全局的访问点。<br>简单工厂：一个工厂类根据传入的参量决定创建出那一种产品类的实例。<br>工厂方法：定义一个创建对象的接口，让子类决定实例化那个类。<br>抽象工厂：创建相关或依赖对象的家族，而无需明确指定具体类。<br>建造者模式：封装一个复杂对象的构建过程，并可以按步骤构造。<br>原型模式：通过复制现有的实例来创建新的实例。</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">单例模式</button></li><li class="tab"><button type="button" data-href="#super-2">工厂模式</button></li><li class="tab"><button type="button" data-href="#super-3">抽象工厂模式</button></li><li class="tab"><button type="button" data-href="#super-4">建造者模式</button></li><li class="tab"><button type="button" data-href="#super-5">原型模式</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>单例模式（Singleton Pattern）是 Java 中最简单的设计模式之一。这种类型的设计模式属于创建型模式，它提供了一种创建对象的最佳方式。</p><p>这种模式涉及到一个单一的类，该类负责创建自己的对象，同时确保只有单个对象被创建。这个类提供了一种访问其唯一的对象的方式，可以直接访问，不需要实例化该类的对象。</p><p>注意：<br>1、单例类只能有一个实例；<br>2、单例类必须自己创建自己的唯一实例；<br>3、单例类必须给所有其他对象提供这一实例。</p><p>介  绍：<br>意图：保证一个类仅有一个实例，并提供一个访问它的全局访问点。<br>主要解决：一个全局使用的类频繁地创建与销毁。<br>何时使用：当您想控制实例数目，节省系统资源的时候。<br>如何解决：判断系统是否已经有这个单例，如果有则返回，如果没有则创建。<br>关键代码：构造函数是私有的。</p><p>应用实例： 1、一个党只能有一个主席。 2、Windows 是多进程多线程的，在操作一个文件的时候，就不可避免地出现多个进程或线程同时操作一个文件的现象，所以所有文件的处理必须通过唯一的实例来进行。 3、一些设备管理器常常设计为单例模式，比如一个电脑有两台打印机，在输出的时候就要处理不能两台打印机打印同一个文件。</p><p>优点：<br>1、在内存里只有一个实例，减少了内存的开销，尤其是频繁的创建和销毁实例（比如管理学院首页页面缓存）。<br>2、避免对资源的多重占用（比如写文件操作）。</p><p>缺点：没有接口，不能继承，与单一职责原则冲突，一个类应该只关心内部逻辑，而不关心外面怎么样来实例化。</p><p>使用场景：<br>1、要求生产唯一序列号。<br>2、WEB 中的计数器，不用每次刷新都在数据库里加一次，用单例先缓存起来。<br>3、创建的一个对象需要消耗的资源过多，比如 I&#x2F;O 与数据库的连接等。</p><p>注意事项：getInstance() 方法中需要使用同步锁 synchronized (Singleton.class) 防止多线程同时进入造成 instance 被多次实例化。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>工厂模式（Factory Pattern）是 Java 中最常用的设计模式之一。这种类型的设计模式属于创建型模式，它提供了一种创建对象的最佳方式。</p><p>在工厂模式中，我们在创建对象时不会对客户端暴露创建逻辑，并且是通过使用一个共同的接口来指向新创建的对象。</p><p>介 绍：<br>意图：定义一个创建对象的接口，让其子类自己决定实例化哪一个工厂类，工厂模式使其创建过程延迟到子类进行。</p><p>主要解决：主要解决接口选择的问题。</p><p>何时使用：我们明确地计划不同条件下创建不同实例时。</p><p>如何解决：让其子类实现工厂接口，返回的也是一个抽象的产品。</p><p>关键代码：创建过程在其子类执行。</p><p>应用实例： 1、您需要一辆汽车，可以直接从工厂里面提货，而不用去管这辆汽车是怎么做出来的，以及这个汽车里面的具体实现。 2、Hibernate 换数据库只需换方言和驱动就可以。</p><p>优点： 1、一个调用者想创建一个对象，只要知道其名称就可以了。 2、扩展性高，如果想增加一个产品，只要扩展一个工厂类就可以。 3、屏蔽产品的具体实现，调用者只关心产品的接口。</p><p>缺点：每次增加一个产品时，都需要增加一个具体类和对象实现工厂，使得系统中类的个数成倍增加，在一定程度上增加了系统的复杂度，同时也增加了系统具体类的依赖。这并不是什么好事。</p><p>使用场景：<br>1、日志记录器：记录可能记录到本地硬盘、系统事件、远程服务器等，用户可以选择记录日志到什么地方。<br>2、数据库访问，当用户不知道最后系统采用哪一类数据库，以及数据库可能有变化时。<br>3、设计一个连接服务器的框架，需要三个协议，”POP3”、”IMAP”、”HTTP”，可以把这三个作为产品类，共同实现一个接口。</p><p>注意事项：作为一种创建类模式，在任何需要生成复杂对象的地方，都可以使用工厂方法模式。有一点需要注意的地方就是复杂对象适合使用工厂模式，而简单对象，特别是只需要通过 new 就可以完成创建的对象，无需使用工厂模式。如果使用工厂模式，就需要引入一个工厂类，会增加系统的复杂度。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>抽象工厂模式：围绕一个超级工厂创建其他工厂。</p><p>这种类型的设计模式属于创建型模式，它提供了一种创建对象的最佳方式。</p><p>在抽象工厂模式中，接口是负责创建一个相关对象的工厂，不需要显式指定它们的类。每个生成的工厂都能按照工厂模式提供对象。</p><p>意图：提供一个创建一系列相关或相互依赖对象的接口，而无需指定它们具体的类。</p><p>主要解决：主要解决接口选择的问题。</p><p>何时使用：系统的产品有多于一个的产品族，而系统只消费其中某一族的产品。</p><p>如何解决：在一个产品族里面，定义多个产品。</p><p>关键代码：在一个工厂里聚合多个同类产品。</p><p>应用实例：工作了，为了参加一些聚会，肯定有两套或多套衣服吧，比如说有商务装（成套，一系列具体产品）、时尚装（成套，一系列具体产品），甚至对于一个家庭来说，可能有商务女装、商务男装、时尚女装、时尚男装，这些也都是成套的，即一系列具体产品。假设一种情况（现实中是不存在的，要不然，没法进入共产主义了，但有利于说明抽象工厂模式），在您的家中，某一个衣柜（具体工厂）只能存放某一种这样的衣服（成套，一系列具体产品），每次拿这种成套的衣服时也自然要从这个衣柜中取出了。用 OO 的思想去理解，所有的衣柜（具体工厂）都是衣柜类的（抽象工厂）某一个，而每一件成套的衣服又包括具体的上衣（某一具体产品），裤子（某一具体产品），这些具体的上衣其实也都是上衣（抽象产品），具体的裤子也都是裤子（另一个抽象产品）。</p><p>优点：当一个产品族中的多个对象被设计成一起工作时，它能保证客户端始终只使用同一个产品族中的对象。</p><p>缺点：产品族扩展非常困难，要增加一个系列的某一产品，既要在抽象的 Creator 里加代码，又要在具体的里面加代码。</p><p>使用场景：<br>1、QQ 换皮肤，一整套一起换。<br>2、生成不同操作系统的程序。</p><p>注意事项：产品族难扩展，产品等级易扩展。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>建造者模式（Builder Pattern）使用多个简单的对象一步一步构建成一个复杂的对象。这种类型的设计模式属于创建型模式，它提供了一种创建对象的最佳方式。</p><p>一个 Builder 类会一步一步构造最终的对象。该 Builder 类是独立于其他对象的。</p><p>介  绍：<br>意图：将一个复杂的构建与其表示相分离，使得同样的构建过程可以创建不同的表示。</p><p>主要解决：主要解决在软件系统中，有时候面临着”一个复杂对象”的创建工作，其通常由各个部分的子对象用一定的算法构成；由于需求的变化，这个复杂对象的各个部分经常面临着剧烈的变化，但是将它们组合在一起的算法却相对稳定。</p><p>何时使用：一些基本部件不会变，而其组合经常变化的时候。</p><p>如何解决：将变与不变分离开。</p><p>关键代码：建造者：创建和提供实例，导演：管理建造出来的实例的依赖关系。</p><p>应用实例： 1、去肯德基，汉堡、可乐、薯条、炸鸡翅等是不变的，而其组合是经常变化的，生成出所谓的”套餐”。 2、JAVA 中的 StringBuilder。</p><p>优点： 1、建造者独立，易扩展。 2、便于控制细节风险。</p><p>缺点： 1、产品必须有共同点，范围有限制。 2、如内部变化复杂，会有很多的建造类。</p><p>使用场景： 1、需要生成的对象具有复杂的内部结构。 2、需要生成的对象内部属性本身相互依赖。</p><p>注意事项：与工厂模式的区别是：建造者模式更加关注与零件装配的顺序。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p>原型模式（Prototype Pattern）是用于创建重复的对象，同时又能保证性能。这种类型的设计模式属于创建型模式，它提供了一种创建对象的最佳方式。</p><p>这种模式是实现了一个原型接口，该接口用于创建当前对象的克隆。当直接创建对象的代价比较大时，则采用这种模式。例如，一个对象需要在一个高代价的数据库操作之后被创建。我们可以缓存该对象，在下一个请求时返回它的克隆，在需要的时候更新数据库，以此来减少数据库调用。</p><p>介  绍：<br>意图：用原型实例指定创建对象的种类，并且通过拷贝这些原型创建新的对象。</p><p>主要解决：在运行期建立和删除原型。</p><p>何时使用： 1、当一个系统应该独立于它的产品创建，构成和表示时。 2、当要实例化的类是在运行时刻指定时，例如，通过动态装载。 3、为了避免创建一个与产品类层次平行的工厂类层次时。 4、当一个类的实例只能有几个不同状态组合中的一种时。建立相应数目的原型并克隆它们可能比每次用合适的状态手工实例化该类更方便一些。</p><p>如何解决：利用已有的一个原型对象，快速地生成和原型对象一样的实例。</p><p>关键代码： 1、实现克隆操作，在 JAVA 继承 Cloneable，重写 clone()，在 .NET 中可以使用 Object 类的 MemberwiseClone() 方法来实现对象的浅拷贝或通过序列化的方式来实现深拷贝。 2、原型模式同样用于隔离类对象的使用者和具体类型（易变类）之间的耦合关系，它同样要求这些”易变类”拥有稳定的接口。</p><p>应用实例： 1、细胞分裂。 2、JAVA 中的 Object clone() 方法。</p><p>优点：<br>1、性能提高。<br>2、逃避构造函数的约束。</p><p>缺点：<br>1、配备克隆方法需要对类的功能进行通盘考虑，这对于全新的类不是很难，但对于已有的类不一定很容易，特别当一个类引用不支持串行化的间接对象，或者引用含有循环结构的时候。<br>2、必须实现 Cloneable 接口。</p><p>使用场景：<br>1、资源优化场景。<br>2、类初始化需要消化非常多的资源，这个资源包括数据、硬件资源等。<br>3、性能和安全要求的场景。<br>4、通过 new 产生一个对象需要非常繁琐的数据准备或访问权限，则可以使用原型模式。<br>5、一个对象多个修改者的场景。<br>6、一个对象需要提供给其他对象访问，而且各个调用者可能都需要修改其值时，可以考虑使用原型模式拷贝多个对象供调用者使用。<br>7、在实际项目中，原型模式很少单独出现，一般是和工厂方法模式一起出现，通过 clone 的方法创建一个对象，然后由工厂方法提供给调用者。原型模式已经与 Java 融为浑然一体，大家可以随手拿来使用。</p><p>注意事项：与通过对一个类进行实例化来构造新对象不同的是，原型模式是通过拷贝一个现有对象生成新对象的。浅拷贝实现 Cloneable，重写，深拷贝是通过实现 Serializable 读取二进制流。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>适配器模式：将一个类的方法接口转换成客户希望的另外一个接口。<br>组合模式：将对象组合成树形结构以表示“”部分-整体“”的层次结构。<br>装饰模式：动态的给对象添加新的功能。<br>代理模式：为其他对象提供一个代理以便控制这个对象的访问。<br>亨元模式：通过共享技术来有效的支持大量细粒度的对象。<br>外观模式：对外提供一个统一的方法，来访问子系统中的一群接口。<br>桥接模式：将抽象部分和它的实现部分分离，使它们都可以独立的变化。</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">适配器模式</button></li><li class="tab"><button type="button" data-href="#super-2">组合模式</button></li><li class="tab"><button type="button" data-href="#super-3">装饰器模式</button></li><li class="tab"><button type="button" data-href="#super-4">代理模式</button></li><li class="tab"><button type="button" data-href="#super-5">享元模式</button></li><li class="tab"><button type="button" data-href="#super-6">外观模式</button></li><li class="tab"><button type="button" data-href="#super-7">桥接模式</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>适配器模式（Adapter Pattern）是作为两个不兼容的接口之间的桥梁。这种类型的设计模式属于结构型模式，它结合了两个独立接口的功能。</p><p>这种模式涉及到一个单一的类，该类负责加入独立的或不兼容的接口功能。举个真实的例子，读卡器是作为内存卡和笔记本之间的适配器。您将内存卡插入读卡器，再将读卡器插入笔记本，这样就可以通过笔记本来读取内存卡。</p><p>我们通过下面的实例来演示适配器模式的使用。其中，音频播放器设备只能播放 mp3 文件，通过使用一个更高级的音频播放器来播放 vlc 和 mp4 文件。</p><p>介  绍：<br>意图：将一个类的接口转换成客户希望的另外一个接口。适配器模式使得原本由于接口不兼容而不能一起工作的那些类可以一起工作。</p><p>主要解决：主要解决在软件系统中，常常要将一些”现存的对象”放到新的环境中，而新环境要求的接口是现对象不能满足的。</p><p>何时使用： 1、系统需要使用现有的类，而此类的接口不符合系统的需要。 2、想要建立一个可以重复使用的类，用于与一些彼此之间没有太大关联的一些类，包括一些可能在将来引进的类一起工作，这些源类不一定有一致的接口。 3、通过接口转换，将一个类插入另一个类系中。（比如老虎和飞禽，现在多了一个飞虎，在不增加实体的需求下，增加一个适配器，在里面包容一个虎对象，实现飞的接口。）</p><p>如何解决：继承或依赖（推荐）。</p><p>关键代码：适配器继承或依赖已有的对象，实现想要的目标接口。</p><p>应用实例： 1、美国电器 110V，中国 220V，就要有一个适配器将 110V 转化为 220V。 2、JAVA JDK 1.1 提供了 Enumeration 接口，而在 1.2 中提供了 Iterator 接口，想要使用 1.2 的 JDK，则要将以前系统的 Enumeration 接口转化为 Iterator 接口，这时就需要适配器模式。 3、在 LINUX 上运行 WINDOWS 程序。 4、JAVA 中的 jdbc。</p><p>优点： 1、可以让任何两个没有关联的类一起运行。 2、提高了类的复用。 3、增加了类的透明度。 4、灵活性好。</p><p>缺点： 1、过多地使用适配器，会让系统非常零乱，不易整体进行把握。比如，明明看到调用的是 A 接口，其实内部被适配成了 B 接口的实现，一个系统如果太多出现这种情况，无异于一场灾难。因此如果不是很有必要，可以不使用适配器，而是直接对系统进行重构。 2.由于 JAVA 至多继承一个类，所以至多只能适配一个适配者类，而且目标类必须是抽象类。</p><p>使用场景：有动机地修改一个正常运行的系统的接口，这时应该考虑使用适配器模式。</p><p>注意事项：适配器不是在详细设计时添加的，而是解决正在服役的项目的问题。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>组合模式（Composite Pattern），又叫部分整体模式，是用于把一组相似的对象当作一个单一的对象。组合模式依据树形结构来组合对象，用来表示部分以及整体层次。这种类型的设计模式属于结构型模式，它创建了对象组的树形结构。</p><p>这种模式创建了一个包含自己对象组的类。该类提供了修改相同对象组的方式。</p><p>我们通过下面的实例来演示组合模式的用法。实例演示了一个组织中员工的层次结构。</p><p>介  绍：<br>意图：将对象组合成树形结构以表示”部分-整体”的层次结构。组合模式使得用户对单个对象和组合对象的使用具有一致性。</p><p>主要解决：它在我们树型结构的问题中，模糊了简单元素和复杂元素的概念，客户程序可以向处理简单元素一样来处理复杂元素，从而使得客户程序与复杂元素的内部结构解耦。</p><p>何时使用： 1、您想表示对象的部分-整体层次结构（树形结构）。 2、您希望用户忽略组合对象与单个对象的不同，用户将统一地使用组合结构中的所有对象。</p><p>如何解决：树枝和叶子实现统一接口，树枝内部组合该接口。</p><p>关键代码：树枝内部组合该接口，并且含有内部属性 List，里面放 Component。</p><p>应用实例： 1、算术表达式包括操作数、操作符和另一个操作数，其中，另一个操作符也可以是操作数、操作符和另一个操作数。 2、在 JAVA AWT 和 SWING 中，对于 Button 和 Checkbox 是树叶，Container 是树枝。</p><p>优点： 1、高层模块调用简单。 2、节点自由增加。</p><p>缺点：在使用组合模式时，其叶子和树枝的声明都是实现类，而不是接口，违反了依赖倒置原则。</p><p>使用场景：部分、整体场景，如树形菜单，文件、文件夹的管理。</p><p>注意事项：定义时为具体类。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>装饰器模式（Decorator Pattern）允许向一个现有的对象添加新的功能，同时又不改变其结构。这种类型的设计模式属于结构型模式，它是作为现有的类的一个包装。</p><p>这种模式创建了一个装饰类，用来包装原有的类，并在保持类方法签名完整性的前提下，提供了额外的功能。</p><p>我们通过下面的实例来演示装饰器模式的用法。其中，我们将把一个形状装饰上不同的颜色，同时又不改变形状类。</p><p>介  绍：<br>意图：动态地给一个对象添加一些额外的职责。就增加功能来说，装饰器模式相比生成子类更为灵活。</p><p>主要解决：一般的，我们为了扩展一个类经常使用继承方式实现，由于继承为类引入静态特征，并且随着扩展功能的增多，子类会很膨胀。</p><p>何时使用：在不想增加很多子类的情况下扩展类。</p><p>如何解决：将具体功能职责划分，同时继承装饰者模式。</p><p>关键代码： 1、Component 类充当抽象角色，不应该具体实现。 2、修饰类引用和继承 Component 类，具体扩展类重写父类方法。</p><p>应用实例： 1、孙悟空有 72 变，当他变成”庙宇”后，他的根本还是一只猴子，但是他又有了庙宇的功能。 2、不论一幅画有没有画框都可以挂在墙上，但是通常都是有画框的，并且实际上是画框被挂在墙上。在挂在墙上之前，画可以被蒙上玻璃，装到框子里；这时画、玻璃和画框形成了一个物体。</p><p>优点：装饰类和被装饰类可以独立发展，不会相互耦合，装饰模式是继承的一个替代模式，装饰模式可以动态扩展一个实现类的功能。</p><p>缺点：多层装饰比较复杂。</p><p>使用场景： 1、扩展一个类的功能。 2、动态增加功能，动态撤销。</p><p>注意事项：可代替继承。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>代理模式（Proxy Pattern）中，一个类代表另一个类的功能。这种类型的设计模式属于结构型模式。</p><p>在代理模式中，我们创建具有现有对象的对象，以便向外界提供功能接口。</p><p>介  绍：<br>意图：为其他对象提供一种代理以控制对这个对象的访问。</p><p>主要解决：在直接访问对象时带来的问题，比如说：要访问的对象在远程的机器上。在面向对象系统中，有些对象由于某些原因（比如对象创建开销很大，或者某些操作需要安全控制，或者需要进程外的访问），直接访问会给使用者或者系统结构带来很多麻烦，我们可以在访问此对象时加上一个对此对象的访问层。</p><p>何时使用：想在访问一个类时做一些控制。</p><p>如何解决：增加中间层。</p><p>关键代码：实现与被代理类组合。</p><p>应用实例： 1、Windows 里面的快捷方式。 2、猪八戒去找高翠兰结果是孙悟空变的，可以这样理解：把高翠兰的外貌抽象出来，高翠兰本人和孙悟空都实现了这个接口，猪八戒访问高翠兰的时候看不出来这个是孙悟空，所以说孙悟空是高翠兰代理类。 3、买火车票不一定在火车站买，也可以去代售点。 4、一张支票或银行存单是账户中资金的代理。支票在市场交易中用来代替现金，并提供对签发人账号上资金的控制。 5、spring aop。</p><p>优点： 1、职责清晰。 2、高扩展性。 3、智能化。</p><p>缺点： 1、由于在客户端和真实主题之间增加了代理对象，因此有些类型的代理模式可能会造成请求的处理速度变慢。 2、实现代理模式需要额外的工作，有些代理模式的实现非常复杂。</p><p>使用场景：按职责来划分，通常有以下使用场景： 1、远程代理。 2、虚拟代理。 3、Copy-on-Write 代理。 4、保护（Protect or Access）代理。 5、Cache代理。 6、防火墙（Firewall）代理。 7、同步化（Synchronization）代理。 8、智能引用（Smart Reference）代理。</p><p>注意事项： 1、和适配器模式的区别：适配器模式主要改变所考虑对象的接口，而代理模式不能改变所代理类的接口。 2、和装饰器模式的区别：装饰器模式为了增强功能，而代理模式是为了加以控制。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p>享元模式（Flyweight Pattern）主要用于减少创建对象的数量，以减少内存占用和提高性能。这种类型的设计模式属于结构型模式，它提供了减少对象数量从而改善应用所需的对象结构的方式。</p><p>享元模式尝试重用现有的同类对象，如果未找到匹配的对象，则创建新对象。我们将通过创建 5 个对象来画出 20 个分布于不同位置的圆来演示这种模式。由于只有 5 种可用的颜色，所以 color 属性被用来检查现有的 Circle 对象。</p><p>介  绍：<br>意图：运用共享技术有效地支持大量细粒度的对象。</p><p>主要解决：在有大量对象时，有可能会造成内存溢出，我们把其中共同的部分抽象出来，如果有相同的业务请求，直接返回在内存中已有的对象，避免重新创建。</p><p>何时使用： 1、系统中有大量对象。 2、这些对象消耗大量内存。 3、这些对象的状态大部分可以外部化。 4、这些对象可以按照内蕴状态分为很多组，当把外蕴对象从对象中剔除出来时，每一组对象都可以用一个对象来代替。 5、系统不依赖于这些对象身份，这些对象是不可分辨的。</p><p>如何解决：用唯一标识码判断，如果在内存中有，则返回这个唯一标识码所标识的对象。</p><p>关键代码：用 HashMap 存储这些对象。</p><p>应用实例： 1、JAVA 中的 String，如果有则返回，如果没有则创建一个字符串保存在字符串缓存池里面。 2、数据库的数据池。</p><p>优点：大大减少对象的创建，降低系统的内存，使效率提高。</p><p>缺点：提高了系统的复杂度，需要分离出外部状态和内部状态，而且外部状态具有固有化的性质，不应该随着内部状态的变化而变化，否则会造成系统的混乱。</p><p>使用场景： 1、系统有大量相似对象。 2、需要缓冲池的场景。</p><p>注意事项： 1、注意划分外部状态和内部状态，否则可能会引起线程安全问题。 2、这些类必须有一个工厂对象加以控制。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-6"><p>外观模式（Facade Pattern）隐藏系统的复杂性，并向客户端提供了一个客户端可以访问系统的接口。这种类型的设计模式属于结构型模式，它向现有的系统添加一个接口，来隐藏系统的复杂性。</p><p>这种模式涉及到一个单一的类，该类提供了客户端请求的简化方法和对现有系统类方法的委托调用。</p><p>介  绍：<br>意图：为子系统中的一组接口提供一个一致的界面，外观模式定义了一个高层接口，这个接口使得这一子系统更加容易使用。</p><p>主要解决：降低访问复杂系统的内部子系统时的复杂度，简化客户端与之的接口。</p><p>何时使用： 1、客户端不需要知道系统内部的复杂联系，整个系统只需提供一个”接待员”即可。 2、定义系统的入口。</p><p>如何解决：客户端不与系统耦合，外观类与系统耦合。</p><p>关键代码：在客户端和复杂系统之间再加一层，这一层将调用顺序、依赖关系等处理好。</p><p>应用实例： 1、去医院看病，可能要去挂号、门诊、划价、取药，让患者或患者家属觉得很复杂，如果有提供接待人员，只让接待人员来处理，就很方便。 2、JAVA 的三层开发模式。</p><p>优点： 1、减少系统相互依赖。 2、提高灵活性。 3、提高了安全性。</p><p>缺点：不符合开闭原则，如果要改东西很麻烦，继承重写都不合适。</p><p>使用场景： 1、为复杂的模块或子系统提供外界访问的模块。 2、子系统相对独立。 3、预防低水平人员带来的风险。</p><p>注意事项：在层次化结构中，可以使用外观模式定义系统中每一层的入口。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-7"><p>桥接模式（Bridge  Pattern）是用于把抽象化与实现化解耦，使得二者可以独立变化。这种类型的设计模式属于结构型模式，它通过提供抽象化和实现化之间的桥接结构，来实现二者的解耦。</p><p>这种模式涉及到一个作为桥接的接口，使得实体类的功能独立于接口实现类。这两种类型的类可被结构化改变而互不影响。</p><p>介  绍：<br>意图：将抽象部分与实现部分分离，使它们都可以独立的变化。</p><p>主要解决：在有多种可能会变化的情况下，用继承会造成类爆炸问题，扩展起来不灵活。</p><p>何时使用：实现系统可能有多个角度分类，每一种角度都可能变化。</p><p>如何解决：把这种多角度分类分离出来，让它们独立变化，减少它们之间耦合。</p><p>关键代码：抽象类依赖实现类。</p><p>应用实例： 1、猪八戒从天蓬元帅转世投胎到猪，转世投胎的机制将尘世划分为两个等级，即：灵魂和肉体，前者相当于抽象化，后者相当于实现化。生灵通过功能的委派，调用肉体对象的功能，使得生灵可以动态地选择。 2、墙上的开关，可以看到的开关是抽象的，不用管里面具体怎么实现的。</p><p>优点： 1、抽象和实现的分离。 2、优秀的扩展能力。 3、实现细节对客户透明。</p><p>缺点：桥接模式的引入会增加系统的理解与设计难度，由于聚合关联关系建立在抽象层，要求开发者针对抽象进行设计与编程。</p><p>使用场景： 1、如果一个系统需要在构件的抽象化角色和具体化角色之间增加更多的灵活性，避免在两个层次之间建立静态的继承联系，通过桥接模式可以使它们在抽象层建立一个关联关系。 2、对于那些不希望使用继承或因为多层次继承导致系统类的个数急剧增加的系统，桥接模式尤为适用。 3、一个类存在两个独立变化的维度，且这两个维度都需要进行扩展。</p><p>注意事项：对于两个独立变化的维度，使用桥接模式再适合不过了。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>模板模式：定义一个算法结构，而将一些步骤延迟到子类实现。<br>解释器模式：给定一个语言，定义它的文法的一种表示，并定义一个解释器。<br>策略模式：定义一系列算法，把他们封装起来，并且使它们可以相互替换。<br>状态模式：允许一个对象在其对象内部状态改变时改变它的行为。<br>观察者模式：对象间的一对多的依赖关系。<br>备忘录模式：在不破坏封装的前提下，保持对象的内部状态。<br>中介者模式：用一个中介对象来封装一系列的对象交互。<br>命令模式：将命令请求封装为一个对象，使得可以用不同的请求来进行参数化。<br>访问者模式：在不改变数据结构的前提下，增加作用于一组对象元素的新功能。<br>责任链模式：将请求的发送者和接收者解耦，使的多个对象都有处理这个请求的机会。<br>迭代器模式：一种遍历访问聚合对象中各个元素的方法，不暴露该对象的内部结构。</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">模板模式</button></li><li class="tab"><button type="button" data-href="#super-2">解释器模式</button></li><li class="tab"><button type="button" data-href="#super-3">策略模式</button></li><li class="tab"><button type="button" data-href="#super-4">状态模式</button></li><li class="tab"><button type="button" data-href="#super-5">观察者模式</button></li><li class="tab"><button type="button" data-href="#super-6">备忘录模式</button></li><li class="tab"><button type="button" data-href="#super-7">中介者模式</button></li><li class="tab"><button type="button" data-href="#super-8">命令模式</button></li><li class="tab"><button type="button" data-href="#super-9">访问者模式</button></li><li class="tab"><button type="button" data-href="#super-10">责任链模式</button></li><li class="tab"><button type="button" data-href="#super-11">迭代器模式</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>模板模式（Template Pattern）中，一个抽象类公开定义了执行它的方法的方式&#x2F;模板。它的子类可以按需要重写方法实现，但调用将以抽象类中定义的方式进行。这种类型的设计模式属于行为型模式。</p><p>介  绍：<br>意图：定义一个操作中的算法的骨架，而将一些步骤延迟到子类中。模板方法使得子类可以不改变一个算法的结构即可重定义该算法的某些特定步骤。</p><p>主要解决：一些方法通用，却在每一个子类都重新写了这一方法。</p><p>何时使用：有一些通用的方法。</p><p>如何解决：将这些通用算法抽象出来。</p><p>关键代码：在抽象类实现，其他步骤在子类实现。</p><p>应用实例： 1、在造房子的时候，地基、走线、水管都一样，只有在建筑的后期才有加壁橱加栅栏等差异。 2、西游记里面菩萨定好的 81 难，这就是一个顶层的逻辑骨架。 3、spring 中对 Hibernate 的支持，将一些已经定好的方法封装起来，比如开启事务、获取 Session、关闭 Session 等，程序员不重复写那些已经规范好的代码，直接丢一个实体就可以保存。</p><p>优点： 1、封装不变部分，扩展可变部分。 2、提取公共代码，便于维护。 3、行为由父类控制，子类实现。</p><p>缺点：每一个不同的实现都需要一个子类来实现，导致类的个数增加，使得系统更加庞大。</p><p>使用场景： 1、有多个子类共有的方法，且逻辑相同。 2、重要的、复杂的方法，可以考虑作为模板方法。</p><p>注意事项：为防止恶意操作，一般模板方法都加上 final 关键词。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>解释器模式（Interpreter Pattern）提供了评估语言的语法或表达式的方式，它属于行为型模式。这种模式实现了一个表达式接口，该接口解释一个特定的上下文。这种模式被用在 SQL 解析、符号处理引擎等。</p><p>介  绍：<br>意图：给定一个语言，定义它的文法表示，并定义一个解释器，这个解释器使用该标识来解释语言中的句子。</p><p>主要解决：对于一些固定文法构建一个解释句子的解释器。</p><p>何时使用：如果一种特定类型的问题发生的频率足够高，那么可能就值得将该问题的各个实例表述为一个简单语言中的句子。这样就可以构建一个解释器，该解释器通过解释这些句子来解决该问题。</p><p>如何解决：构件语法树，定义终结符与非终结符。</p><p>关键代码：构件环境类，包含解释器之外的一些全局信息，一般是 HashMap。</p><p>应用实例：编译器、运算表达式计算。</p><p>优点： 1、可扩展性比较好，灵活。 2、增加了新的解释表达式的方式。 3、易于实现简单文法。</p><p>缺点： 1、可利用场景比较少。 2、对于复杂的文法比较难维护。 3、解释器模式会引起类膨胀。 4、解释器模式采用递归调用方法。</p><p>使用场景： 1、可以将一个需要解释执行的语言中的句子表示为一个抽象语法树。 2、一些重复出现的问题可以用一种简单的语言来进行表达。 3、一个简单语法需要解释的场景。</p><p>注意事项：可利用场景比较少，JAVA 中如果碰到可以用 expression4J 代替。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>策略模式（Strategy Pattern）中，一个类的行为或其算法可以在运行时更改。这种类型的设计模式属于行为型模式。</p><p>在策略模式中，我们创建表示各种策略的对象和一个行为随着策略对象改变而改变的 context 对象。策略对象改变 context 对象的执行算法。</p><p>介  绍：<br>意图：定义一系列的算法,把它们一个个封装起来, 并且使它们可相互替换。</p><p>主要解决：在有多种算法相似的情况下，使用 if…else 所带来的复杂和难以维护。</p><p>何时使用：一个系统有许多许多类，而区分它们的只是他们直接的行为。</p><p>如何解决：将这些算法封装成一个一个的类，任意地替换。</p><p>关键代码：实现同一个接口。</p><p>应用实例： 1、诸葛亮的锦囊妙计，每一个锦囊就是一个策略。 2、旅行的出游方式，选择骑自行车、坐汽车，每一种旅行方式都是一个策略。 3、JAVA AWT 中的 LayoutManager。</p><p>优点： 1、算法可以自由切换。 2、避免使用多重条件判断。 3、扩展性良好。</p><p>缺点： 1、策略类会增多。 2、所有策略类都需要对外暴露。</p><p>使用场景： 1、如果在一个系统里面有许多类，它们之间的区别仅在于它们的行为，那么使用策略模式可以动态地让一个对象在许多行为中选择一种行为。 2、一个系统需要动态地在几种算法中选择一种。 3、如果一个对象有很多的行为，如果不用恰当的模式，这些行为就只好使用多重的条件选择语句来实现。</p><p>注意事项：如果一个系统的策略多于四个，就需要考虑使用混合模式，解决策略类膨胀的问题。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>状态模式（State Pattern）中，类的行为是基于它的状态改变的。这种类型的设计模式属于行为型模式。</p><p>在状态模式中，我们创建表示各种状态的对象和一个行为随着状态对象改变而改变的 context 对象。</p><p>介  绍：<br>意图：允许对象在内部状态发生改变时改变它的行为，对象看起来好像修改了它的类。</p><p>主要解决：对象的行为依赖于它的状态（属性），并且可以根据它的状态改变而改变它的相关行为。</p><p>何时使用：代码中包含大量与对象状态有关的条件语句。</p><p>如何解决：将各种具体的状态类抽象出来。</p><p>关键代码：通常命令模式的接口中只有一个方法。而状态模式的接口中有一个或者多个方法。而且，状态模式的实现类的方法，一般返回值，或者是改变实例变量的值。也就是说，状态模式一般和对象的状态有关。实现类的方法有不同的功能，覆盖接口中的方法。状态模式和命令模式一样，也可以用于消除 if…else 等条件选择语句。</p><p>应用实例： 1、打篮球的时候运动员可以有正常状态、不正常状态和超常状态。 2、曾侯乙编钟中，’钟是抽象接口’,’钟A’等是具体状态，’曾侯乙编钟’是具体环境（Context）。</p><p>优点： 1、封装了转换规则。 2、枚举可能的状态，在枚举状态之前需要确定状态种类。 3、将所有与某个状态有关的行为放到一个类中，并且可以方便地增加新的状态，只需要改变对象状态即可改变对象的行为。 4、允许状态转换逻辑与状态对象合成一体，而不是某一个巨大的条件语句块。 5、可以让多个环境对象共享一个状态对象，从而减少系统中对象的个数。</p><p>缺点： 1、状态模式的使用必然会增加系统类和对象的个数。 2、状态模式的结构与实现都较为复杂，如果使用不当将导致程序结构和代码的混乱。 3、状态模式对”开闭原则”的支持并不太好，对于可以切换状态的状态模式，增加新的状态类需要修改那些负责状态转换的源代码，否则无法切换到新增状态，而且修改某个状态类的行为也需修改对应类的源代码。</p><p>使用场景： 1、行为随状态改变而改变的场景。 2、条件、分支语句的代替者。</p><p>注意事项：在行为受状态约束的时候使用状态模式，而且状态不超过 5 个。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p>观察者模式（Observer Pattern）：当对象间存在一对多关系时，则使用观察者模式。比如，当一个对象被修改时，则会自动通知它的依赖对象。观察者模式属于行为型模式。</p><p>介  绍：<br>意图：定义对象间的一种一对多的依赖关系，当一个对象的状态发生改变时，所有依赖于它的对象都得到通知并被自动更新。</p><p>主要解决：一个对象状态改变给其他对象通知的问题，而且要考虑到易用和低耦合，保证高度的协作。</p><p>何时使用：一个对象（目标对象）的状态发生改变，所有的依赖对象（观察者对象）都将得到通知，进行广播通知。</p><p>如何解决：使用面向对象技术，可以将这种依赖关系弱化。</p><p>关键代码：在抽象类里有一个 ArrayList 存放观察者们。</p><p>应用实例： 1、拍卖的时候，拍卖师观察最高标价，然后通知给其他竞价者竞价。 2、西游记里面悟空请求菩萨降服红孩儿，菩萨洒了一地水招来一个老乌龟，这个乌龟就是观察者，他观察菩萨洒水这个动作。</p><p>优点： 1、观察者和被观察者是抽象耦合的。 2、建立一套触发机制。</p><p>缺点： 1、如果一个被观察者对象有很多的直接和间接的观察者的话，将所有的观察者都通知到会花费很多时间。 2、如果在观察者和观察目标之间有循环依赖的话，观察目标会触发它们之间进行循环调用，可能导致系统崩溃。 3、观察者模式没有相应的机制让观察者知道所观察的目标对象是怎么发生变化的，而仅仅只是知道观察目标发生了变化。</p><p>使用场景：</p><p>一个抽象模型有两个方面，其中一个方面依赖于另一个方面。将这些方面封装在独立的对象中使它们可以各自独立地改变和复用。<br>一个对象的改变将导致其他一个或多个对象也发生改变，而不知道具体有多少对象将发生改变，可以降低对象之间的耦合度。<br>一个对象必须通知其他对象，而并不知道这些对象是谁。<br>需要在系统中创建一个触发链，A对象的行为将影响B对象，B对象的行为将影响C对象……，可以使用观察者模式创建一种链式触发机制。</p><p>注意事项： 1、JAVA 中已经有了对观察者模式的支持类。 2、避免循环引用。 3、如果顺序执行，某一观察者错误会导致系统卡壳，一般采用异步方式。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-6"><p>备忘录模式（Memento Pattern）保存一个对象的某个状态，以便在适当的时候恢复对象。备忘录模式属于行为型模式。</p><p>介  绍：<br>意图：在不破坏封装性的前提下，捕获一个对象的内部状态，并在该对象之外保存这个状态。</p><p>主要解决：所谓备忘录模式就是在不破坏封装的前提下，捕获一个对象的内部状态，并在该对象之外保存这个状态，这样可以在以后将对象恢复到原先保存的状态。</p><p>何时使用：很多时候我们总是需要记录一个对象的内部状态，这样做的目的就是为了允许用户取消不确定或者错误的操作，能够恢复到他原先的状态，使得他有”后悔药”可吃。</p><p>如何解决：通过一个备忘录类专门存储对象状态。</p><p>关键代码：客户不与备忘录类耦合，与备忘录管理类耦合。</p><p>应用实例： 1、后悔药。 2、打游戏时的存档。 3、Windows 里的 ctri + z。 4、IE 中的后退。 4、数据库的事务管理。</p><p>优点： 1、给用户提供了一种可以恢复状态的机制，可以使用户能够比较方便地回到某个历史的状态。 2、实现了信息的封装，使得用户不需要关心状态的保存细节。</p><p>缺点：消耗资源。如果类的成员变量过多，势必会占用比较大的资源，而且每一次保存都会消耗一定的内存。</p><p>使用场景： 1、需要保存&#x2F;恢复数据的相关状态场景。 2、提供一个可回滚的操作。</p><p>注意事项： 1、为了符合迪米特原则，还要增加一个管理备忘录的类。 2、为了节约内存，可使用原型模式+备忘录模式。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-7"><p>中介者模式（Mediator Pattern）是用来降低多个对象和类之间的通信复杂性。这种模式提供了一个中介类，该类通常处理不同类之间的通信，并支持松耦合，使代码易于维护。中介者模式属于行为型模式。</p><p>介  绍：<br>意图：用一个中介对象来封装一系列的对象交互，中介者使各对象不需要显式地相互引用，从而使其耦合松散，而且可以独立地改变它们之间的交互。</p><p>主要解决：对象与对象之间存在大量的关联关系，这样势必会导致系统的结构变得很复杂，同时若一个对象发生改变，我们也需要跟踪与之相关联的对象，同时做出相应的处理。</p><p>何时使用：多个类相互耦合，形成了网状结构。</p><p>如何解决：将上述网状结构分离为星型结构。</p><p>关键代码：对象 Colleague 之间的通信封装到一个类中单独处理。</p><p>应用实例： 1、中国加入 WTO 之前是各个国家相互贸易，结构复杂，现在是各个国家通过 WTO 来互相贸易。 2、机场调度系统。 3、MVC 框架，其中C（控制器）就是 M（模型）和 V（视图）的中介者。</p><p>优点： 1、降低了类的复杂度，将一对多转化成了一对一。 2、各个类之间的解耦。 3、符合迪米特原则。</p><p>缺点：中介者会庞大，变得复杂难以维护。</p><p>使用场景： 1、系统中对象之间存在比较复杂的引用关系，导致它们之间的依赖关系结构混乱而且难以复用该对象。 2、想通过一个中间类来封装多个类中的行为，而又不想生成太多的子类。</p><p>注意事项：不应当在职责混乱的时候使用。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-8"><p>命令模式（Command Pattern）是一种数据驱动的设计模式，它属于行为型模式。请求以命令的形式包裹在对象中，并传给调用对象。调用对象寻找可以处理该命令的合适的对象，并把该命令传给相应的对象，该对象执行命令。</p><p>介  绍：<br>意图：将一个请求封装成一个对象，从而使您可以用不同的请求对客户进行参数化。</p><p>主要解决：在软件系统中，行为请求者与行为实现者通常是一种紧耦合的关系，但某些场合，比如需要对行为进行记录、撤销或重做、事务等处理时，这种无法抵御变化的紧耦合的设计就不太合适。</p><p>何时使用：在某些场合，比如要对行为进行”记录、撤销&#x2F;重做、事务”等处理，这种无法抵御变化的紧耦合是不合适的。在这种情况下，如何将”行为请求者”与”行为实现者”解耦？将一组行为抽象为对象，可以实现二者之间的松耦合。</p><p>如何解决：通过调用者调用接受者执行命令，顺序：调用者→接受者→命令。</p><p>关键代码：定义三个角色：1、received 真正的命令执行对象 2、Command 3、invoker 使用命令对象的入口</p><p>应用实例：struts 1 中的 action 核心控制器 ActionServlet 只有一个，相当于 Invoker，而模型层的类会随着不同的应用有不同的模型类，相当于具体的 Command。</p><p>优点： 1、降低了系统耦合度。 2、新的命令可以很容易添加到系统中去。</p><p>缺点：使用命令模式可能会导致某些系统有过多的具体命令类。</p><p>使用场景：认为是命令的地方都可以使用命令模式，比如： 1、GUI 中每一个按钮都是一条命令。 2、模拟 CMD。</p><p>注意事项：系统需要支持命令的撤销(Undo)操作和恢复(Redo)操作，也可以考虑使用命令模式，见命令模式的扩展。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-9"><p>访问者模式（Visitor Pattern）中，我们使用了一个访问者类，它改变了元素类的执行算法。通过这种方式，元素的执行算法可以随着访问者改变而改变。这种类型的设计模式属于行为型模式。根据模式，元素对象已接受访问者对象，这样访问者对象就可以处理元素对象上的操作。</p><p>介  绍：<br>意图：主要将数据结构与数据操作分离。</p><p>主要解决：稳定的数据结构和易变的操作耦合问题。</p><p>何时使用：需要对一个对象结构中的对象进行很多不同的并且不相关的操作，而需要避免让这些操作”污染”这些对象的类，使用访问者模式将这些封装到类中。</p><p>如何解决：在被访问的类里面加一个对外提供接待访问者的接口。</p><p>关键代码：在数据基础类里面有一个方法接受访问者，将自身引用传入访问者。</p><p>应用实例：您在朋友家做客，您是访问者，朋友接受您的访问，您通过朋友的描述，然后对朋友的描述做出一个判断，这就是访问者模式。</p><p>优点： 1、符合单一职责原则。 2、优秀的扩展性。 3、灵活性。</p><p>缺点： 1、具体元素对访问者公布细节，违反了迪米特原则。 2、具体元素变更比较困难。 3、违反了依赖倒置原则，依赖了具体类，没有依赖抽象。</p><p>使用场景： 1、对象结构中对象对应的类很少改变，但经常需要在此对象结构上定义新的操作。 2、需要对一个对象结构中的对象进行很多不同的并且不相关的操作，而需要避免让这些操作”污染”这些对象的类，也不希望在增加新操作时修改这些类。</p><p>注意事项：访问者可以对功能进行统一，可以做报表、UI、拦截器与过滤器。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-10"><p>责任链模式（Chain of Responsibility Pattern）为请求创建了一个接收者对象的链。这种模式给予请求的类型，对请求的发送者和接收者进行解耦。这种类型的设计模式属于行为型模式。</p><p>在这种模式中，通常每个接收者都包含对另一个接收者的引用。如果一个对象不能处理该请求，那么它会把相同的请求传给下一个接收者，依此类推。</p><p>介  绍：<br>意图：避免请求发送者与接收者耦合在一起，让多个对象都有可能接收请求，将这些对象连接成一条链，并且沿着这条链传递请求，直到有对象处理它为止。</p><p>主要解决：职责链上的处理者负责处理请求，客户只需要将请求发送到职责链上即可，无须关心请求的处理细节和请求的传递，所以职责链将请求的发送者和请求的处理者解耦了。</p><p>何时使用：在处理消息的时候以过滤很多道。</p><p>如何解决：拦截的类都实现统一接口。</p><p>关键代码：Handler 里面聚合它自己，在 HanleRequest 里判断是否合适，如果没达到条件则向下传递，向谁传递之前 set 进去。</p><p>应用实例： 1、红楼梦中的”击鼓传花”。 2、JS 中的事件冒泡。 3、JAVA WEB 中 Apache Tomcat 对 Encoding 的处理，Struts2 的拦截器，jsp servlet 的 Filter。</p><p>优点： 1、降低耦合度。它将请求的发送者和接收者解耦。 2、简化了对象。使得对象不需要知道链的结构。 3、增强给对象指派职责的灵活性。通过改变链内的成员或者调动它们的次序，允许动态地新增或者删除责任。 4、增加新的请求处理类很方便。</p><p>缺点： 1、不能保证请求一定被接收。 2、系统性能将受到一定影响，而且在进行代码调试时不太方便，可能会造成循环调用。 3、可能不容易观察运行时的特征，有碍于除错。</p><p>使用场景： 1、有多个对象可以处理同一个请求，具体哪个对象处理该请求由运行时刻自动确定。 2、在不明确指定接收者的情况下，向多个对象中的一个提交一个请求。 3、可动态指定一组对象处理请求。</p><p>注意事项：在 JAVA WEB 中遇到很多应用。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-11"><p>迭代器模式（Iterator Pattern）是 Java 和 .Net 编程环境中非常常用的设计模式。这种模式用于顺序访问集合对象的元素，不需要知道集合对象的底层表示。</p><p>迭代器模式属于行为型模式。</p><p>介  绍：<br>意图：提供一种方法顺序访问一个聚合对象中各个元素, 而又无须暴露该对象的内部表示。</p><p>主要解决：不同的方式来遍历整个整合对象。</p><p>何时使用：遍历一个聚合对象。</p><p>如何解决：把在元素之间游走的责任交给迭代器，而不是聚合对象。</p><p>关键代码：定义接口：hasNext, next。</p><p>应用实例：JAVA 中的 iterator。</p><p>优点： 1、它支持以不同的方式遍历一个聚合对象。 2、迭代器简化了聚合类。 3、在同一个聚合上可以有多个遍历。 4、在迭代器模式中，增加新的聚合类和迭代器类都很方便，无须修改原有代码。</p><p>缺点：由于迭代器模式将存储数据和遍历数据的职责分离，增加新的聚合类需要对应增加新的迭代器类，类的个数成对增加，这在一定程度上增加了系统的复杂性。</p><p>使用场景： 1、访问一个聚合对象的内容而无须暴露它的内部表示。 2、需要为聚合对象提供多种遍历方式。 3、为遍历不同的聚合结构提供一个统一的接口。</p><p>注意事项：迭代器模式就是分离了集合对象的遍历行为，抽象出一个迭代器类来负责，这样既可以做到不暴露集合的内部结构，又可让外部代码透明地访问集合内部的数据。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="9种前端常见的设计模式"><a href="#9种前端常见的设计模式" class="headerlink" title="9种前端常见的设计模式"></a>9种前端常见的设计模式</h2><h3 id="1-外观模式（Facade-Pattern）"><a href="#1-外观模式（Facade-Pattern）" class="headerlink" title="1. 外观模式（Facade Pattern）"></a>1. 外观模式（Facade Pattern）</h3><p>外观模式是最常见的设计模式之一，它为子系统中的一组接口提供一个统一的高层接口，使子系统更容易使用。简而言之外观设计模式就是把多个子系统中复杂逻辑进行抽象，从而提供一个更统一、更简洁、更易用的API。很多我们常用的框架和库基本都遵循了外观设计模式，比如JQuery就把复杂的原生DOM操作进行了抽象和封装，并消除了浏览器之间的兼容问题，从而提供了一个更高级更易用的版本。其实在平时工作中我们也会经常用到外观模式进行开发，只是我们不自知而已。</p><ol><li>兼容浏览器事件绑定</li></ol><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> addMyEvent = <span class="keyword">function</span> (el, ev, fn) &#123;  </span><br><span class="line">  <span class="keyword">if</span> (el.addEventListener) &#123;</span><br><span class="line">    el.add<span class="constructor">EventListener(<span class="params">ev</span>, <span class="params">fn</span>, <span class="params">false</span>)</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (el.attachEvent) &#123;</span><br><span class="line">    el.attach<span class="constructor">Event(&#x27;<span class="params">on</span>&#x27; + <span class="params">ev</span>, <span class="params">fn</span>)</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    el<span class="literal">[&#x27;<span class="identifier">on</span>&#x27; + <span class="identifier">ev</span>]</span> = fn</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ol start="2"><li>封装接口</li></ol><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> myEvent = &#123;</span><br><span class="line">  <span class="comment">// ...   </span></span><br><span class="line">  stop:<span class="function"> <span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">    e.stop<span class="constructor">Propagation()</span>;</span><br><span class="line">    e.prevent<span class="constructor">Default()</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><strong>场景</strong><br>· 设计初期，应该要有意识地将不同的两个层分离，比如经典的三层结构，在数据访问层和业务逻辑层、业务逻辑层和表示层之间建立外观Facade<br>· 在开发阶段，子系统往往因为不断的重构演化而变得越来越复杂，增加外观Facade可以提供一个简单的接口，减少他们之间的依赖。<br>· 在维护一个遗留的大型系统时，可能这个系统已经很难维护了，这时候使用外观Facade也是非常合适的，为系系统开发一个外观Facade类，为设计粗糙和高度复杂的遗留代码提供比较清晰的接口，让新系统和Facade对象交互，Facade与遗留代码交互所有的复杂工作。</p><p><strong>优点</strong><br>· 减少系统相互依赖。<br>· 提高灵活性。<br>· 提高了安全性</p><p><strong>缺点</strong><br>· 不符合开闭原则，如果要改东西很麻烦，继承重写都不合适。</p><h3 id="2-代理模式（Proxy-Pattern）"><a href="#2-代理模式（Proxy-Pattern）" class="headerlink" title="2. 代理模式（Proxy Pattern）"></a>2. 代理模式（Proxy Pattern）</h3><p>是为一个对象提供一个代用品或占位符，以便控制对它的访问</p><blockquote><p>假设当A 在心情好的时候收到花，小明表白成功的几率有60%，而当A 在心情差的时候收到花，小明表白的成功率无限趋近于0。 小明跟A 刚刚认识两天，还无法辨别A 什么时候心情好。如果不合时宜地把花送给A，花 被直接扔掉的可能性很大，这束花可是小明吃了7 天泡面换来的。 但是A 的朋友B 却很了解A，所以小明只管把花交给B，B 会监听A 的心情变化，然后选 择A 心情好的时候把花转交给A，代码如下：</p></blockquote><figure class="highlight zephir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Flower = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"><span class="keyword">let</span> xiaoming = &#123;</span><br><span class="line">  sendFlower: <span class="function"><span class="keyword">function</span><span class="params">(target)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> flower = <span class="keyword">new</span> Flower()</span><br><span class="line">    target.receiveFlower(flower)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> B = &#123;</span><br><span class="line">  receiveFlower: <span class="function"><span class="keyword">function</span><span class="params">(flower)</span> </span>&#123;</span><br><span class="line">    A.listenGoodMood(**<span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      A.receiveFlower(flower)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> A = &#123;</span><br><span class="line">  receiveFlower: <span class="function"><span class="keyword">function</span><span class="params">(flower)</span> </span>&#123;</span><br><span class="line">    console.log(<span class="string">&#x27;收到花&#x27;</span>+ flower)</span><br><span class="line">  &#125;,</span><br><span class="line">  listenGoodMood: <span class="function"><span class="keyword">function</span><span class="params">(fn)</span> </span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="function"><span class="keyword">fn</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    &#125;, 1000)</span></span><br><span class="line"><span class="function">  &#125;</span></span><br><span class="line"><span class="function">&#125;</span></span><br><span class="line"><span class="function"><span class="title">xiaoming</span>.<span class="title">sendFlower</span><span class="params">(B)</span></span></span><br></pre></td></tr></table></figure><p><strong>场景</strong></p><ul><li>HTML元 素事件代理</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;ul&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> ul = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#ul&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  ul.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="params">event</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(event.<span class="property">target</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>ES6 的 proxy <a href="https://link.juejin.cn/?target=https://es6.ruanyifeng.com/%23docs/proxy" title="https://es6.ruanyifeng.com/#docs/proxy">阮一峰<strong>Proxy</strong></a></li><li>jQuery.proxy()方法</li></ul><p><strong>优点</strong></p><ul><li>代理模式能将代理对象与被调用对象分离，降低了系统的耦合度。代理模式在客户端和目标对象之间起到一个中介作用，这样可以起到保护目标对象的作用</li><li>代理对象可以扩展目标对象的功能；通过修改代理对象就可以了，符合开闭原则；<br><strong>缺点</strong></li><li>处理请求速度可能有差别，非直接访问存在开销</li></ul><h3 id="3-工厂模式（Factory-Pattern）"><a href="#3-工厂模式（Factory-Pattern）" class="headerlink" title="3. 工厂模式（Factory Pattern）"></a>3. 工厂模式（Factory Pattern）</h3><p><a href="https://segmentfault.com/a/1190000021247238">JavaScript设计模式第2篇：工厂模式 - SegmentFault 思否</a></p><p>工厂模式定义一个用于创建对象的接口，这个接口由子类决定实例化哪一个类。该模式使一个类的实例化延迟到了子类。而子类可以重写接口方法以便创建的时候指定自己的对象类型。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Product</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">init</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;init&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">fun</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;fun&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Factory</span> &#123;</span><br><span class="line">  <span class="title function_">create</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Product</span>(name)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// use</span></span><br><span class="line"><span class="keyword">let</span> factory = <span class="keyword">new</span> <span class="title class_">Factory</span>()</span><br><span class="line"><span class="keyword">let</span> p = factory.<span class="title function_">create</span>(<span class="string">&#x27;p1&#x27;</span>)</span><br><span class="line">p.<span class="title function_">init</span>()</span><br><span class="line">p.<span class="title function_">fun</span>()</span><br></pre></td></tr></table></figure><p><strong>场景</strong><br>· 如果你不想让某个子系统与较大的那个对象之间形成强耦合，而是想运行时从许多子系统中进行挑选的话，那么工厂模式是一个理想的选择<br>· 将new操作简单封装，遇到new的时候就应该考虑是否用工厂模式；<br>· 需要依赖具体环境创建不同实例，这些实例都有相同的行为,这时候我们可以使用工厂模式，简化实现的过程，同时也可以减少每种对象所需的代码量，有利于消除对象间的耦合，提供更大的灵活性</p><p><strong>优点</strong><br>· 创建对象的过程可能很复杂，但我们只需要关心创建结果。<br>· 构造函数和创建者分离, 符合“开闭原则”<br>· 一个调用者想创建一个对象，只要知道其名称就可以了。<br>· 扩展性高，如果想增加一个产品，只要扩展一个工厂类就可以。</p><p><strong>缺点</strong><br>· 添加新产品时，需要编写新的具体产品类,一定程度上增加了系统的复杂度<br>· 考虑到系统的可扩展性，需要引入抽象层，在客户端代码中均使用抽象层进行定义，增加了系统的抽象性和理解难度</p><p><strong>什么时候不用</strong><br>· 当被应用到错误的问题类型上时,这一模式会给应用程序引入大量不必要的复杂性.除非为创建对象提供一个接口是我们编写的库或者框架的一个设计上目标,否则我会建议使用明确的构造器,以避免不必要的开销。<br>· 由于对象的创建过程被高效的抽象在一个接口后面的事实,这也会给依赖于这个过程可能会有多复杂的单元测试带来问题。</p><h3 id="4-单例模式（Singleton-Pattern）"><a href="#4-单例模式（Singleton-Pattern）" class="headerlink" title="4. 单例模式（Singleton Pattern）"></a>4. 单例模式（Singleton Pattern）</h3><p><a href="https://segmentfault.com/a/1190000021101281">JavaScript设计模式第1篇：单例模式 - SegmentFault 思否</a></p><blockquote><p>单个Class中最多只有一个实例，并提供一个访问它的全局访问点。</p><p>当需要一个对象去贯穿整个系统执行某些任务时，单例模式就派上了用场。</p><p>而除此之外的场景尽量避免单例模式的使用，因为单例模式会引入全局状态，而一个健康的系统应该避免引入过多的全局状态。</p></blockquote><p>实现方式：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 单例构造器</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">FooServiceSingleton</span> = (<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 隐藏的Class的构造函数</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">FooService</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">  <span class="comment">// 未初始化的单例对象</span></span><br><span class="line">  <span class="keyword">let</span> fooService;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="comment">// 创建/获取单例对象的函数</span></span><br><span class="line">    <span class="attr">getInstance</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!fooService) &#123;</span><br><span class="line">        fooService = <span class="keyword">new</span> <span class="title class_">FooService</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> fooService;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><p>实现的关键点有：</p><ol><li>使用 IIFE创建局部作用域并即时执行；</li><li>**getInstance() **为一个闭包，使用闭包保存局部作用域中的单例对象并返回。</li></ol><p>我们可以验证下单例对象是否创建成功：</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">const fooService1 <span class="operator">=</span> FooServiceSingleton.getInstance()<span class="comment">;</span></span><br><span class="line">const fooService2 <span class="operator">=</span> FooServiceSingleton.getInstance()<span class="comment">;</span></span><br><span class="line">console.log(fooService1 <span class="operator">=</span><span class="operator">=</span><span class="operator">=</span> fooService2)<span class="comment">; // true</span></span><br></pre></td></tr></table></figure><p><strong>场景例子</strong><br>· 定义命名空间和实现分支型方法<br>· 登录框<br>· vuex 和 redux中的store</p><p><strong>优点</strong><br>· 划分命名空间，减少全局变量<br>· 增强模块性，把自己的代码组织在一个全局变量名下，放在单一位置，便于维护<br>· 只会实例化一次。简化了代码的调试和维护</p><p><strong>缺点</strong><br>· 由于单例模式提供的是一种单点访问，所以它有可能导致模块间的强耦合<br>· 从而不利于单元测试。无法单独测试一个调用了来自单例的方法的类，而只能把它与那个单例作为一<br>· 个单元一起测试。</p><h3 id="5-策略模式（Strategy-Pattern）"><a href="#5-策略模式（Strategy-Pattern）" class="headerlink" title="5. 策略模式（Strategy Pattern）"></a>5. 策略模式（Strategy Pattern）</h3><p>简单描述：对象有某个行为，但是在不同的场景中，该行为有不同的实现算法。把它们一个个封装起来，并且使它们可以互相替换</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>策略模式-校验表单<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">content</span>=<span class="string">&quot;text/html&quot;</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span> = <span class="string">&quot;registerForm&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">action</span>=<span class="string">&quot;http://xxxx.com/api/register&quot;</span>&gt;</span></span><br><span class="line">    用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;userName&quot;</span>&gt;</span></span><br><span class="line">    密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span></span><br><span class="line">    手机号码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;phoneNumber&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 策略对象</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> strategies = &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">isNoEmpty</span>: <span class="keyword">function</span> (<span class="params">value, errorMsg</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (value === <span class="string">&#x27;&#x27;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">return</span> errorMsg;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">isNoSpace</span>: <span class="keyword">function</span> (<span class="params">value, errorMsg</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (value.<span class="title function_">trim</span>() === <span class="string">&#x27;&#x27;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">return</span> errorMsg;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">minLength</span>: <span class="keyword">function</span> (<span class="params">value, errorMsg, lens</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (value.<span class="title function_">trim</span>().<span class="property">length</span> &lt; lens) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">return</span> errorMsg;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">maxLength</span>: <span class="keyword">function</span> (<span class="params">value, errorMsg, lens</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (value.<span class="property">length</span> &gt; lens) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">return</span> errorMsg;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">isMobile</span>: <span class="keyword">function</span> (<span class="params">value, errorMsg</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (!<span class="regexp">/^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|17[7]|18[0|1|2|3|5|6|7|8|9])\d&#123;8&#125;$/</span>.<span class="title function_">test</span>(value)) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">return</span> errorMsg;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 验证类</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">class</span> <span class="title class_">Validator</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">cache</span> = [];</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">add</span>(<span class="params">dom, rules</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>, rule; rule = rules[i++];) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">let</span> strategyAry = rule.<span class="property">strategy</span>.<span class="title function_">split</span>(<span class="string">&#x27;:&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">let</span> errorMsg = rule.<span class="property">errorMsg</span>;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">cache</span>.<span class="title function_">push</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">let</span> strategy = strategyAry.<span class="title function_">shift</span>();</span></span><br><span class="line"><span class="language-javascript">            strategyAry.<span class="title function_">unshift</span>(dom.<span class="property">value</span>);</span></span><br><span class="line"><span class="language-javascript">            strategyAry.<span class="title function_">push</span>(errorMsg);</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> strategies[strategy].<span class="title function_">apply</span>(dom, strategyAry);</span></span><br><span class="line"><span class="language-javascript">          &#125;)</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">start</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>, validatorFunc; validatorFunc = <span class="variable language_">this</span>.<span class="property">cache</span>[i++];) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">let</span> errorMsg = <span class="title function_">validatorFunc</span>();</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (errorMsg) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> errorMsg;</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 调用代码(尝试使用)</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> registerForm = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;registerForm&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> validataFunc = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> validator = <span class="keyword">new</span> <span class="title class_">Validator</span>();</span></span><br><span class="line"><span class="language-javascript">      validator.<span class="title function_">add</span>(registerForm.<span class="property">userName</span>, [&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">strategy</span>: <span class="string">&#x27;isNoEmpty&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">errorMsg</span>: <span class="string">&#x27;用户名不能为空&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      &#125;, &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">strategy</span>: <span class="string">&#x27;isNoSpace&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">errorMsg</span>: <span class="string">&#x27;密码不能为空&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      &#125;, &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">strategy</span>: <span class="string">&#x27;minLength:2&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">errorMsg</span>: <span class="string">&#x27;用户名长度不能小于2位&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      &#125;]);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      validator.<span class="title function_">add</span>(registerForm.<span class="property">password</span>, [ &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">strategy</span>: <span class="string">&#x27;minLength:6&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">errorMsg</span>: <span class="string">&#x27;密码长度不能小于6位&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      &#125;]);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      validator.<span class="title function_">add</span>(registerForm.<span class="property">phoneNumber</span>, [&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">strategy</span>: <span class="string">&#x27;isMobile&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">errorMsg</span>: <span class="string">&#x27;请输入正确的手机号码格式&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      &#125;]);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> validator.<span class="title function_">start</span>();</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    registerForm.<span class="property">onsubmit</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> errorMsg = <span class="title function_">validataFunc</span>();</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (errorMsg) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">alert</span>(errorMsg);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>场景例子</strong><br>· 如果在一个系统里面有许多类，它们之间的区别仅在于它们的’行为’，那么使用策略模式可以动态地让一个对象在许多行为中选择一种行为。<br>· 一个系统需要动态地在几种算法中选择一种。<br>· 表单验证</p><p><strong>优点</strong><br>· 利用组合、委托、多态等技术和思想，可以有效的避免多重条件选择语句<br>· 提供了对开放-封闭原则的完美支持，将算法封装在独立的strategy中，使得它们易于切换，理解，易于扩展<br>· 利用组合和委托来让Context拥有执行算法的能力，这也是继承的一种更轻便的代替方案</p><p><strong>缺点</strong><br>· 会在程序中增加许多策略类或者策略对象<br>· 要使用策略模式，必须了解所有的strategy，必须了解各个strategy之间的不同点，这样才能选择一个合适的strategy</p><h3 id="6-迭代器模式（Iterator-Pattern）"><a href="#6-迭代器模式（Iterator-Pattern）" class="headerlink" title="6. 迭代器模式（Iterator Pattern）"></a>6. 迭代器模式（Iterator Pattern）</h3><p>如果你看到这，ES6中的迭代器 Iterator 相信你还是有点印象的，上面第60条已经做过简单的介绍。迭代器模式简单的说就是提供一种方法顺序一个聚合对象中各个元素，而又不暴露该对象的内部表示。</p><p>迭代器模式解决了以下问题：<br>· 提供一致的遍历各种数据结构的方式，而不用了解数据的内部结构<br>· 提供遍历容器（集合）的能力而无需改变容器的接口</p><p>一个迭代器通常需要实现以下接口：<br>· hasNext()：判断迭代是否结束，返回Boolean<br>· next()：查找并返回下一个元素</p><p>为Javascript的数组实现一个迭代器可以这么写：</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> item = [<span class="number">1</span>, <span class="string">&#x27;red&#x27;</span>, <span class="literal">false</span>, <span class="number">3.14</span>];</span><br><span class="line"></span><br><span class="line">function Iterator(items) &#123;</span><br><span class="line">  <span class="keyword">this</span>.items = items;</span><br><span class="line">  <span class="keyword">this</span>.index = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Iterator.prototype = &#123;</span><br><span class="line">  hasNext: function () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.index &lt; <span class="keyword">this</span>.items.length;</span><br><span class="line">  &#125;,</span><br><span class="line">  next: function () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.items[<span class="keyword">this</span>.index++];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>验证一下迭代器是否工作：</p><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">iterator</span> = <span class="keyword">new</span> <span class="keyword">Iterator</span>(item)<span class="punctuation">;</span></span><br><span class="line"><span class="keyword">while</span>(<span class="keyword">iterator</span>.hasNext())<span class="comment">&#123;</span></span><br><span class="line"><span class="comment">  console.log(iterator.next());</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">//输出：1, red, false, 3.14</span></span><br></pre></td></tr></table></figure><p>ES6提供了更简单的迭代循环语法 for…of，使用该语法的前提是操作对象需要实现 可迭代协议（The iterable protocol），简单说就是该对象有个Key为 Symbol.iterator 的方法，该方法返回一个iterator对象。</p><p>比如我们实现一个 Range 类用于在某个数字区间进行迭代：</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title">Range</span>(start, end) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="type">&#123;</span></span><br><span class="line">    [Symbol.iterator]: <span class="keyword">function</span> <span class="title"></span>() &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="type">&#123;</span></span><br><span class="line">        next() &#123;</span><br><span class="line">          <span class="keyword">if</span> (start &lt; <span class="keyword">end</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> &#123; value: start++, done: <span class="literal">false</span> &#125;;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">return</span> &#123; done: <span class="literal">true</span>, value: <span class="keyword">end</span> &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>验证一下：</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (num of Range(<span class="number">1</span>, <span class="number">5</span>)) &#123;</span><br><span class="line">  <span class="built_in">console</span>.<span class="built_in">log</span>(num);</span><br><span class="line">&#125;<span class="comment">// 输出：1, 2, 3, 4</span></span><br></pre></td></tr></table></figure><h3 id="7-观察者模式（Observer-Pattern）即发布-x2F-订阅模式"><a href="#7-观察者模式（Observer-Pattern）即发布-x2F-订阅模式" class="headerlink" title="7. 观察者模式（Observer Pattern）即发布&#x2F;订阅模式"></a>7. 观察者模式（Observer Pattern）即发布&#x2F;订阅模式</h3><p>日常生活中的应用也比比皆是，比如：订阅某个博主的频道，当有内容更新时会收到推送；又比如JavaScript中的事件订阅响应机制。</p><p>观察者模式的思想用一句话描述就是： <strong>被观察对象（</strong>subject<strong>）维护一组观察者（observer），当被观察对象状态改变时，通过调用观察者的某个方法将这些变化通知到观察者</strong> 。</p><p>观察者模式中Subject对象一般需要实现以下API：</p><ul><li>subscribe()：接收一个观察者observer对象，使其订阅自己</li><li>unsubscribe()：接收一个观察者observer对象，使其取消订阅自己</li><li>ire()：触发事件，通知到所有观察者</li></ul><p>用JavaScript手动实现观察者模式：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 被观察者</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Subject</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">observers</span> = [];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Subject</span>.<span class="property"><span class="keyword">prototype</span></span> = &#123;</span><br><span class="line">  <span class="comment">// 订阅</span></span><br><span class="line">  <span class="attr">subscribe</span>: <span class="keyword">function</span> (<span class="params">observer</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">observers</span>.<span class="title function_">push</span>(observer);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 取消订阅</span></span><br><span class="line">  <span class="attr">unsubscribe</span>: <span class="keyword">function</span> (<span class="params">observerToRemove</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">observers</span> = <span class="variable language_">this</span>.<span class="property">observers</span>.<span class="title function_">filter</span>(<span class="function"><span class="params">observer</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> observer !== observerToRemove;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 事件触发</span></span><br><span class="line">  <span class="attr">fire</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">observers</span>.<span class="title function_">forEach</span>(<span class="function"><span class="params">observer</span> =&gt;</span> &#123;</span><br><span class="line">      observer.<span class="title function_">call</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>验证一下订阅是否成功：</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">const subject = <span class="keyword">new</span> Subject();</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">observer1</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">&#x27;Observer 1 Firing!&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">observer2</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">&#x27;Observer 2 Firing!&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">subject.subscribe(observer1);</span><br><span class="line">subject.subscribe(observer2);</span><br><span class="line">subject.fire();</span><br><span class="line"></span><br><span class="line"><span class="comment">//输出：</span></span><br><span class="line">Observer <span class="number">1</span> Firing! </span><br><span class="line">Observer <span class="number">2</span> Firing!</span><br></pre></td></tr></table></figure><p>验证一下取消订阅是否成功：</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">subject<span class="selector-class">.unsubscribe</span>(observer2);</span><br><span class="line">subject<span class="selector-class">.fire</span>();</span><br><span class="line"><span class="comment">//输出：</span></span><br><span class="line">Observer <span class="number">1</span> Firing!</span><br></pre></td></tr></table></figure><p><strong>场景</strong><br>· DOM事件</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;hello world!&#x27;</span>);</span><br><span class="line">&#125;);<span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">click</span>()</span><br></pre></td></tr></table></figure><p>· vue 响应式<br><strong>优点</strong></p><ul><li>支持简单的广播通信，自动通知所有已经订阅过的对象</li><li>目标对象与观察者之间的抽象耦合关系能单独扩展以及重用</li><li>增加了灵活性</li><li>观察者模式所做的工作就是在解耦，让耦合的双方都依赖于抽象，而不是依赖于具体。从而使得各自的变化都不会影响到另一边的变化。</li></ul><p><strong>缺点</strong></p><blockquote><p>过度使用会导致对象与对象之间的联系弱化，会导致程序难以跟踪维护和理解</p></blockquote><h3 id="8-中介者模式（Mediator-Pattern）"><a href="#8-中介者模式（Mediator-Pattern）" class="headerlink" title="8. 中介者模式（Mediator Pattern）"></a>8. 中介者模式（Mediator Pattern）</h3><p>在中介者模式中，中介者（Mediator）包装了一系列对象相互作用的方式，使得这些对象不必直接相互作用，而是由中介者协调它们之间的交互，从而使它们可以松散偶合。当某些对象之间的作用发生改变时，不会立即影响其他的一些对象之间的作用，保证这些作用可以彼此独立的变化。</p><p>中介者模式和观察者模式有一定的相似性，都是一对多的关系，也都是集中式通信，不同的是中介者模式是处理同级对象之间的交互，而观察者模式是处理Observer和Subject之间的交互。中介者模式有些像婚恋中介，相亲对象刚开始并不能直接交流，而是要通过中介去筛选匹配再决定谁和谁见面。</p><p><strong>场景</strong></p><blockquote><p>例如购物车需求，存在商品选择表单、颜色选择表单、购买数量表单等等，都会触发change事件，那么可以通过中介者来转发处理这些事件，实现各个事件间的解耦，仅仅维护中介者对象即可。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> goods = &#123;   </span><br><span class="line">    <span class="comment">//手机库存</span></span><br><span class="line">    <span class="string">&#x27;red|32G&#x27;</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="string">&#x27;red|64G&#x27;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">&#x27;blue|32G&#x27;</span>: <span class="number">7</span>,</span><br><span class="line">    <span class="string">&#x27;blue|32G&#x27;</span>: <span class="number">6</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//中介者</span></span><br><span class="line"><span class="keyword">var</span> mediator = (<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> colorSelect = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;colorSelect&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> memorySelect = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;memorySelect&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> numSelect = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;numSelect&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">changed</span>: <span class="keyword">function</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">            <span class="keyword">switch</span>(obj)&#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="attr">colorSelect</span>:</span><br><span class="line">                    <span class="comment">//TODO</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="attr">memorySelect</span>:</span><br><span class="line">                    <span class="comment">//TODO</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="attr">numSelect</span>:</span><br><span class="line">                    <span class="comment">//TODO</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line">colorSelect.<span class="property">onchange</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    mediator.<span class="title function_">changed</span>(<span class="variable language_">this</span>);</span><br><span class="line">&#125;;</span><br><span class="line">memorySelect.<span class="property">onchange</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    mediator.<span class="title function_">changed</span>(<span class="variable language_">this</span>);</span><br><span class="line">&#125;;</span><br><span class="line">numSelect.<span class="property">onchange</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    mediator.<span class="title function_">changed</span>(<span class="variable language_">this</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>· 聊天室里</p><p>聊天室成员类：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Member</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">chatroom</span> = <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Member</span>.<span class="property"><span class="keyword">prototype</span></span> = &#123;</span><br><span class="line">  <span class="comment">// 发送消息</span></span><br><span class="line">  <span class="attr">send</span>: <span class="keyword">function</span> (<span class="params">message, toMember</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">chatroom</span>.<span class="title function_">send</span>(message, <span class="variable language_">this</span>, toMember);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 接收消息</span></span><br><span class="line">  <span class="attr">receive</span>: <span class="keyword">function</span> (<span class="params">message, fromMember</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;fromMember.name&#125;</span> to <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>: <span class="subst">$&#123;message&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>聊天室类：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Chatroom</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">members</span> = &#123;&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Chatroom</span>.<span class="property"><span class="keyword">prototype</span></span> = &#123;</span><br><span class="line">  <span class="comment">// 增加成员</span></span><br><span class="line"> <span class="attr">addMember</span>: <span class="keyword">function</span> (<span class="params">member</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">members</span>[member.<span class="property">name</span>] = member;</span><br><span class="line">    member.<span class="property">chatroom</span> = <span class="variable language_">this</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 发送消息</span></span><br><span class="line">  <span class="attr">send</span>: <span class="keyword">function</span> (<span class="params">message, fromMember, toMember</span>) &#123;</span><br><span class="line">    toMember.<span class="title function_">receive</span>(message, fromMember);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>测试一下：</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">const chatroom = <span class="keyword">new</span> <span class="constructor">Chatroom()</span>;const bruce = <span class="keyword">new</span> <span class="constructor">Member(&#x27;<span class="params">bruce</span>&#x27;)</span>;const frank = <span class="keyword">new</span> <span class="constructor">Member(&#x27;<span class="params">frank</span>&#x27;)</span>;</span><br><span class="line">chatroom.add<span class="constructor">Member(<span class="params">bruce</span>)</span>;</span><br><span class="line">chatroom.add<span class="constructor">Member(<span class="params">frank</span>)</span>;</span><br><span class="line">bruce.send(&#x27;Hey frank&#x27;, frank);</span><br><span class="line"><span class="comment">//输出：bruce to frank: hello frank</span></span><br></pre></td></tr></table></figure><p><strong>优点</strong></p><ul><li>使各对象之间耦合松散，而且可以独立地改变它们之间的交互</li><li>中介者和对象一对多的关系取代了对象之间的网状多对多的关系</li><li>如果对象之间的复杂耦合度导致维护很困难，而且耦合度随项目变化增速很快，就需要中介者重构代码</li></ul><p><strong>缺点</strong></p><blockquote><p>系统中会新增一个中介者对象，因为对象之间交互的复杂性，转移成了中介者对象的复杂性，使得中介者对象经常是巨大的。中介者对象自身往往就是一个难以维护的对象。</p></blockquote><h3 id="9-访问者模式（Visitor-Pattern）"><a href="#9-访问者模式（Visitor-Pattern）" class="headerlink" title="9. 访问者模式（Visitor Pattern）"></a>9. 访问者模式（Visitor Pattern）</h3><p><strong>访问者模式</strong> 是一种将算法与对象结构分离的设计模式，通俗点讲就是：访问者模式让我们能够在不改变一个对象结构的前提下能够给该对象增加新的逻辑，新增的逻辑保存在一个独立的访问者对象中。访问者模式常用于拓展一些第三方的库和工具。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 访问者  </span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Visitor</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">  <span class="title function_">visitConcreteElement</span>(<span class="params">ConcreteElement</span>) &#123;</span><br><span class="line">    <span class="title class_">ConcreteElement</span>.<span class="title function_">operation</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 元素类  </span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ConcreteElement</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">  <span class="title function_">operation</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ConcreteElement.operation invoked&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">accept</span>(<span class="params">visitor</span>) &#123;</span><br><span class="line">    visitor.<span class="title function_">visitConcreteElement</span>(<span class="variable language_">this</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// client</span></span><br><span class="line"><span class="keyword">let</span> visitor = <span class="keyword">new</span> <span class="title class_">Visitor</span>()</span><br><span class="line"><span class="keyword">let</span> element = <span class="keyword">new</span> <span class="title class_">ConcreteElement</span>()</span><br><span class="line">elementA.<span class="title function_">accept</span>(visitor)</span><br></pre></td></tr></table></figure><p>访问者模式的实现有以下几个要素：<br>· Visitor Object：访问者对象，拥有一个<strong>visit()<strong>方法<br>· Receiving Object：接收对象，拥有一个</strong> accept()</strong> 方法<br>· visit(receivingObj)：用于Visitor接收一个<strong>Receiving Object</strong><br>· accept(visitor)：用于<strong>Receving Object</strong>接收一个Visitor，并通过调用<strong>Visitor</strong>的<strong>visit()</strong> 为其提供获取<strong>Receiving Object</strong>数据的能力</p><p>简单的代码实现如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Receiving</span> <span class="title class_">Object</span>:</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Employee</span>(<span class="params">name, salary</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">salary</span> = salary;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Employee</span>.<span class="property"><span class="keyword">prototype</span></span> = &#123;</span><br><span class="line">  <span class="attr">getSalary</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">salary</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">setSalary</span>: <span class="keyword">function</span> (<span class="params">salary</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">salary</span> = salary;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">accept</span>: <span class="keyword">function</span> (<span class="params">visitor</span>) &#123;</span><br><span class="line">    visitor.<span class="title function_">visit</span>(<span class="variable language_">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Visitor</span> <span class="title class_">Object</span>：</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Visitor</span>(<span class="params"></span>) &#123; &#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Visitor</span>.<span class="property"><span class="keyword">prototype</span></span> = &#123;</span><br><span class="line">  <span class="attr">visit</span>: <span class="keyword">function</span> (<span class="params">employee</span>) &#123;</span><br><span class="line">    employee.<span class="title function_">setSalary</span>(employee.<span class="title function_">getSalary</span>() * <span class="number">2</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>验证一下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> employee = <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&#x27;bruce&#x27;</span>, <span class="number">1000</span>);</span><br><span class="line"><span class="keyword">const</span> visitor = <span class="keyword">new</span> <span class="title class_">Visitor</span>();</span><br><span class="line">employee.<span class="title function_">accept</span>(visitor);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(employee.<span class="title function_">getSalary</span>());<span class="comment">//输出：2000</span></span><br></pre></td></tr></table></figure><p><strong>场景</strong><br>· 对象结构中对象对应的类很少改变，但经常需要在此对象结构上定义新的操作<br>· 需要对一个对象结构中的对象进行很多不同的并且不相关的操作，而需要避免让这些操作”污染”这些对象的类，也不希望在增加新操作时修改这些类。<br><strong>优点</strong><br>· 符合单一职责原则<br>· 优秀的扩展性<br>· 灵活性</p><p><strong>缺点</strong><br>· 具体元素对访问者公布细节，违反了迪米特原则<br>· 违反了依赖倒置原则，依赖了具体类，没有依赖抽象。<br>· 具体元素变更比较困难</p><p>相关参考资料：<br><a href="https://juejin.cn/post/6844904032826294286" title="https://juejin.cn/post/6844904032826294286">JavaScript设计模式es6（23种)</a><br><a href="https://juejin.cn/book/6844733763675488269/section/6844733763792928776" title="https://juejin.cn/book/6844733763675488269/section/6844733763792928776">《前端面试之道》</a><br><a href="#heading-3" title="https://juejin.cn/post/6844903503266054157#heading-3">《**JavaScript **设计模式》</a><br><a href="https://juejin.cn/post/6844903607452581896" title="https://juejin.cn/post/6844903607452581896">《**JavaScript **中常见设计模式整理》</a></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 设计模式 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 设计模式 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Web APIs</title>
      <link href="/posts/c0110283/"/>
      <url>/posts/c0110283/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>以下内容参考：<a href="https://juejin.cn/post/7118259341060210701#heading-90">JavaScript学习笔记</a></p><p>Web APIs</p><p>JavaScript基础和Web APIs两个阶段的关联性：JS基础学习ECMAScript基础语法为后面做铺垫，Web APIs是JS的应用，大量使用JS基础语法做交互效果</p><p>API 和Web API：</p><p>API （应用程序编程接口），是一些预先定义的函数，目的是提供应用程序与开发人员基于某种软件或硬件得以访问一组例程的能力，而又无需访问源码，或理解内部工作机制的细节（API是给程序员提供的一种工具，以便能更轻松的实现想要完成的功能）</p><p>Web API是<strong>浏览器</strong>提供的一套操作<strong>浏览器功能</strong>和<strong>页面元素</strong>的 <strong>API</strong> （BOM和DOM）</p><p>BOM：浏览器对象模型</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c68bdc64d183490db6f74d4fb85b2cf7~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="图片.png"></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>JS内置对象</title>
      <link href="/posts/9271cfed/"/>
      <url>/posts/9271cfed/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a href="https://juejin.cn/post/7118259341060210701#heading-90">JavaScript学习笔记</a></p><p>JavaScript内置对象</p><p>内置对象就是js语言自带的一些对象，这些对象供开发者使用，并提供了一些常用的或是最基本而必要的功能（属性和方法）</p><p>内置对象最大的优点是帮助程序员快速开发</p><p>JavaScript提供的内置对象：Number、Math、Date、Array、String、RegExp、Global、Error</p><h2 id="标准内置对象的分类"><a href="#标准内置对象的分类" class="headerlink" title="标准内置对象的分类"></a>标准内置对象的分类</h2><p>详细资料可以参考：<br><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects">《标准内置对象的分类》</a></p><p><a href="https://segmentfault.com/a/1190000011467723#articleHeader24">《JS 所有内置对象属性和方法汇总》</a></p><h2 id="Number-数值对象"><a href="#Number-数值对象" class="headerlink" title="Number 数值对象"></a>Number 数值对象</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Number">Number - JavaScript | MDN (mozilla.org)</a></p><p>JavaScript 的 <strong><code>Number</code></strong> 对象是经过封装的能让你处理数字值的对象。<code>Number</code> 对象由 <code>Number()</code> 构造器创建。</p><p>JavaScript 的 <code>Number</code>类型为<a href="https://en.wikipedia.org/wiki/Floating-point_arithmetic">双精度 IEEE 754 64 位浮点</a>类型。</p><table><thead><tr><th>col1</th><th>col2</th></tr></thead><tbody><tr><td><code>var num = new Number(10);</code><br /><code>typeof num</code></td><td>“Object”</td></tr><tr><td>Number(“1.1”)</td><td>1.1</td></tr><tr><td>Number(0xA)</td><td>10</td></tr><tr><td>Number(true)</td><td>1</td></tr><tr><td>Number(“12.a”)</td><td>NaN</td></tr></tbody></table><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">属性</button></li><li class="tab"><button type="button" data-href="#super-2">方法</button></li><li class="tab"><button type="button" data-href="#super-3">实例方法</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">Number.EPSILON</button></li><li class="tab"><button type="button" data-href="#super-2">Number.MAX_SAFE_INTEGER</button></li><li class="tab"><button type="button" data-href="#super-3">Number.MAX_VALUE</button></li><li class="tab"><button type="button" data-href="#super-4">Number.MIN_SAFE_INTEGER</button></li><li class="tab"><button type="button" data-href="#super-5">Number.MIN_VALUE</button></li><li class="tab"><button type="button" data-href="#super-6">Number.NaN</button></li><li class="tab"><button type="button" data-href="#super-7">Number.NEGATIVE_INFINITY</button></li><li class="tab"><button type="button" data-href="#super-8">Number.POSITIVE_INFINITY</button></li><li class="tab"><button type="button" data-href="#super-9">Number.prototype(en-US)</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><code>epsilon</code><br>两个可表示 (representable) 数之间的最小间隔。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><code>max_safe_integer</code><br>JavaScript 中最大的安全整数 (<code>2^53 - 1</code>)。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p><code>max_value</code><br>能表示的最大正数。最小的负数是 <code>-MAX_VALUE</code>。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p><code>min_safe_integer</code><br>JavaScript 中最小的安全整数 (<code>-(2^53 - 1)</code>).</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p><code>min_value</code><br>能表示的最小正数即最接近 0 的正数 (实际上不会变成 0)。最大的负数是 <code>-MIN_VALUE</code>。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-6"><p>特殊的“非数字”值。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-7"><p><code>negative_infinity</code><br>特殊的负无穷大值，在溢出时返回该值。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-8"><p><code>positive_infinity</code><br>特殊的正无穷大值，在溢出时返回该值。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-9"><p>Number 对象上允许的额外属性。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">Number.isNaN()</button></li><li class="tab"><button type="button" data-href="#super-2">Number.isFinite()</button></li><li class="tab"><button type="button" data-href="#super-3">Number.isInteger()</button></li><li class="tab"><button type="button" data-href="#super-4">Number.isSafeInteger()</button></li><li class="tab"><button type="button" data-href="#super-5">Number.parseFloat()</button></li><li class="tab"><button type="button" data-href="#super-6">Number.parseInt()</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>作用：确定传递的值是否是 NaN。<br><code>Number.isNaN(value)</code><br>参数：<br>    - value：要检测是否为 NaN 的值。<br>返回值：<br>    * 布尔值，表示给定的值是否是 NaN。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>作用：确定传递的值类型及本身是否是有限数。<br><code>Number.isFinite(value)</code><br>参数：<br>    - value：要被检测有穷性的值。<br>返回值<br>    * 布尔值 表示给定的值是否是一个有穷数。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>作用：确定传递的值类型是“number”，且是整数。<br><code>Number.isInteger(Number)</code><br>参数：<br>    - number：检测的值<br>返回值：<br>    * 布尔值（true&#x2F;false）</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>作用：确定传递的值是否为安全整数 ( -(2^53 - 1) 至 2^53 - 1) 之间。<br><code>Number.isSafeInteger(testValue)</code><br>参数：<br>    - testValue：需要检测的参数。<br>返回值：<br>    * 布尔值 表示给定的值是否是一个安全整数（safe integer）。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p>作用：和全局对象 parseFloat() 一样。<br><code>Number.parseFloat(string)</code><br>参数：<br>    - string：被解析的字符串。<br>返回值<br>    * 给定值被解析成浮点数，如果无法被解析成浮点数，则返回NaN</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-6"><p>作用：和全局对象 parseInt() 一样。<br><code>Number.parseInt(string[, radix])</code><br>参数：<br>    - string：要解析的值。 如果此参数不是字符串，则使用 ToString 抽象操作将其转换为字符串。忽略此参数中的前导空格。<br>    - radix：一个介于 2 到 36 之间的整数，代表字符串的基数 (数学数字系统中的基)。<br>返回值<br>    * 转换后的整型数</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">Number.prototype.toExponential(fractionDigits)</button></li><li class="tab"><button type="button" data-href="#super-2">Number.prototype.toFixed(digits)</button></li><li class="tab"><button type="button" data-href="#super-3">Number.prototype.toLocaleString([locales [, options]])</button></li><li class="tab"><button type="button" data-href="#super-4">Number.prototype.toPrecision(precision)</button></li><li class="tab"><button type="button" data-href="#super-5">Number.prototype.toString([radix])</button></li><li class="tab"><button type="button" data-href="#super-6">Number.prototype.valueOf()</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>作用：将数值转换成指数形式，返回字符串。<br><code>numObj.toExponential(fractionDigits)</code><br>参数<br>    - fractionDigits（可选）：整数，用来指定小数点后有几位数字。默认情况下用尽可能多的位数来显示数字。<br>返回值<br>    * 使用指数形式表示的字符串<br>异常<br>    * RangeError<br>        如果 fractionDigits 太小或太大将会抛出该错误。介于 0 和 20（包括 20）之间的值不会引起 RangeError 。 执行环境也可以支持更大或更小范围。<br>    * TypeError<br>        如果该方法在一个非数值类型对象上调用。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>作用：将数值保留指定位数的小数位。<br><code>numObj.toFixed(digits)</code><br>参数<br>    - digits：小数点后数字的个数；介于 0 到 20（包括）之间。如果忽略该参数，则默认为 0。<br>返回值<br>    * 定点表示法格式化后的字符串。</p><p>抛出异常<br>    * RangeError<br>        如果 digits 参数太小或太大。0 到 20（包括）之间的值不会引起 RangeError。实现环境（implementations）也可以支持更大或更小的值。<br>    * TypeError<br>        如果该方法在一个非Number类型的对象上调用。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>作用：返回数字在特定语言环境下表示的字符串。覆盖 Object.prototype.toLocaleString() 方法。<br><code>numObj.toLocaleString([locales [, options]])</code><br>参数：<br>返回值<br>    * 返回一个语言环境下的表示字符串。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>作用：以指定精度返回该数值的字符串表示形式。<br><code>numObj.toPrecision(precision)</code><br>参数<br>    - precision（可选）：一个用来指定有效数个数的整数。<br>返回值<br>    * 指定位数表示的字符串。<br>异常<br>    * RangeError<br>        如果 precison 参数不在 1 和 100（包括）之间，将会抛出一个 RangeError 。执行环境也可以支持更大或更小的范围。ECMA-262 只需要最多 21 位显示数字。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p>作用：返回一个代表给定对象的字符串，基于指定的基数。<br><code>numObj.toString([radix])</code><br>参数：<br>    - radix：指定要用于数字到字符串的转换的基数 (从 2 到 36)。如果未指定 radix 参数，则默认值为 10。<br>返回值：<br>    * 字符串<br>异常信息<br>    * RangeError<br>        如果 toString() 的 radix 参数不在 2 到 36 之间，将会抛出一个 RangeError。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-6"><p>作用：返回指定对象的原始值。覆盖 Object.prototype.valueOf() 方法。<br><code>numObj.valueOf()</code><br>返回值<br>    * 表示指定 Number 对象的原始值的数字</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>转换函数比较</p><table><thead><tr><th align="center">字符串</th><th align="center"><code>parseInt(string)</code></th><th align="center"><code>parseFloat(string)</code></th><th align="center"><code>Number(value)</code></th></tr></thead><tbody><tr><td align="center">“1.1”</td><td align="center">1</td><td align="center">1.1</td><td align="center">1.1</td></tr><tr><td align="center">“12.3a4”</td><td align="center">12</td><td align="center">12.3</td><td align="center">NaN</td></tr><tr><td align="center">“www”</td><td align="center">NaN</td><td align="center">NaN</td><td align="center">NaN</td></tr></tbody></table><h2 id="Math-数学对象"><a href="#Math-数学对象" class="headerlink" title="Math 数学对象"></a>Math 数学对象</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Math">Math - JavaScript | MDN (mozilla.org)</a></p><p>Math数学对象，不是一个构造函数，不需要new来调用，可直接使用里面的属性和方法</p><table><thead><tr><th align="center">方法名</th><th>说明</th><th>返回值</th></tr></thead><tbody><tr><td align="center">Math.abs(x)</td><td>返回数的绝对值</td><td></td></tr><tr><td align="center">Math.ceil(x)</td><td>对数值进行向上舍入</td><td>Math.ceil(1.1)); &#x2F;&#x2F; 2<br />Math.ceil(1.9)); &#x2F;&#x2F; 2</td></tr><tr><td align="center">Math.floor(x)</td><td>对数值进行向下舍入</td><td>Math.floor(1.1)); &#x2F;&#x2F; 1<br />Math.floor(1.9)); &#x2F;&#x2F; 1</td></tr><tr><td align="center">Math.max(x,y)</td><td>返回x和y中的较大值</td><td></td></tr><tr><td align="center">Math.min(x,y)</td><td>返回x和y中的较小值</td><td></td></tr><tr><td align="center">Math.pow(x,y)</td><td>返回x的y次幂</td><td></td></tr><tr><td align="center">Math.random()</td><td>返回0~1之间的随机数</td><td></td></tr><tr><td align="center">Math.round(x)</td><td>把数值四舍五入为最接近的整数</td><td>Math.round(1.9));   &#x2F;&#x2F; 2<br />Math.round(-1.5)); &#x2F;&#x2F; -1</td></tr><tr><td align="center">Math.sqrt(x)</td><td>返回数的平方根</td><td></td></tr></tbody></table><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 示例</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Math</span>.<span class="property">PI</span>); <span class="comment">// PI 一个属性  圆周率</span></span><br></pre></td></tr></table></figure><p><strong>得到两个数之间的随机数，并且包含这两个数：</strong></p><p>公式：<code>Math.floor(Math.random() * (max - min + 1)) + min</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 得到两个数之间的随机数，并且包含这两个数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getRandom</span>(<span class="params">min, max</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * (max - min + <span class="number">1</span>)) + min;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">getRandom</span>(<span class="number">1</span>, <span class="number">100</span>))</span><br></pre></td></tr></table></figure><p><strong>Math对象的属性</strong></p><table><thead><tr><th>属性</th><th>意义</th></tr></thead><tbody><tr><td>Math.E</td><td>常数e的值</td></tr><tr><td>Math.PI</td><td>pai的值</td></tr><tr><td>Math.LN2</td><td>2的自然对数</td></tr><tr><td>Math.LN10</td><td>10的自然对数</td></tr><tr><td>Math.LOG2E</td><td>以2为底的e的对数</td></tr><tr><td>Math.SQRT1-2</td><td>0.5的平方根</td></tr><tr><td>Math.SQRT2</td><td>2的平方根</td></tr></tbody></table><p>舍入方法比较</p><table><thead><tr><th align="center">数值</th><th align="center">Math.round(x)</th><th align="center">Math.ceil(x)</th><th align="center">Math.floor(x)</th></tr></thead><tbody><tr><td align="center">1.1</td><td align="center">1</td><td align="center">2</td><td align="center">1</td></tr><tr><td align="center">1.9</td><td align="center">2</td><td align="center">2</td><td align="center">1</td></tr><tr><td align="center"></td><td align="center">四舍五入</td><td align="center">向上取整</td><td align="center">向下取整</td></tr></tbody></table><h2 id="Date-日期对象"><a href="#Date-日期对象" class="headerlink" title="Date 日期对象"></a>Date 日期对象</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Date">Date - JavaScript | MDN (mozilla.org)</a></p><p>Date() 日期对象是一个 <strong>构造函数</strong>，必须使用<strong>new</strong>来调用创建日期对象</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(date);</span><br><span class="line"><span class="comment">// 默认输出：Sun Dec 17 2017 13:55:10 GMT+0800(CST)</span></span><br></pre></td></tr></table></figure><ul><li>如果没有参数，则返回当前系统的当前时间</li></ul><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">获取年/月/日/星期/时/分/秒</button></li><li class="tab"><button type="button" data-href="#super-2">设置年/月/日/时/分/秒</button></li><li class="tab"><button type="button" data-href="#super-3">年/月/日/时/分/秒格式化</button></li><li class="tab"><button type="button" data-href="#super-4">总毫秒数（时间戳）</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><table><thead><tr><th align="center">方法</th><th>说明</th><th align="center">代码</th></tr></thead><tbody><tr><td align="center">getFullYear()</td><td>获取当前年</td><td align="center">dObj.getFullYear()</td></tr><tr><td align="center">getMonth()</td><td>获取当前月份（0~11）</td><td align="center">dObj.getMonth()</td></tr><tr><td align="center">getDate()</td><td>获取当天日期（1~31）</td><td align="center">dObj.getDate()</td></tr><tr><td align="center">getDay()</td><td>获取星期几（周日0~周六6）</td><td align="center">dObj.getDay()</td></tr><tr><td align="center">getHours()</td><td>获取当前小时（0~23）</td><td align="center">dObj.getHours()</td></tr><tr><td align="center">getMinutes()</td><td>获取当前分钟（0~59）</td><td align="center">dObj.getMinutes()</td></tr><tr><td align="center">getSeconds()</td><td>获取当前秒钟（0~59）</td><td align="center">dObj.getSeconds()</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><table><thead><tr><th align="center">方法</th><th>说明</th><th align="center">代码</th></tr></thead><tbody><tr><td align="center">setFullYear()</td><td>设置Date对象中的年份（四位数）</td><td align="center">dObj.setFullYear()</td></tr><tr><td align="center">setMonth()</td><td>设置Date对象中的月份（0~11）</td><td align="center">dObj.setMonth()</td></tr><tr><td align="center">setDate()</td><td>设置Date对象中月的某一天（1~31）</td><td align="center">dObj.setDate()</td></tr><tr><td align="center">setHours()</td><td>设置Date对象中的小时（0~23）</td><td align="center">dObj.setHours()</td></tr><tr><td align="center">setMinutes()</td><td>设置Date对象中的分钟（0~59）</td><td align="center">dObj.setMinutes()</td></tr><tr><td align="center">setSeconds()</td><td>设置Date对象中的秒钟（0~59）</td><td align="center">dObj.setSeconds()</td></tr><tr><td align="center">setMilliseconds()</td><td>设置Date对象中的毫秒数（0~999）</td><td align="center">dObj.setMilliseconds()</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><table><thead><tr><th align="center">方法</th><th>说明</th><th align="center">代码</th></tr></thead><tbody><tr><td align="center">toDateString()</td><td>以特定于实现的格式显示星期几、月、日和年；</td><td align="center"></td></tr><tr><td align="center">toTimeString()</td><td>以特定于实现的格式显示时、分、秒和时区</td><td align="center"></td></tr><tr><td align="center">toLocalDateString()</td><td>以特定于地区的格式显示星期几、月、日和年</td><td align="center"></td></tr><tr><td align="center">toLocalTimeString()</td><td>以特定于实现的格式显示时、分、秒</td><td align="center"></td></tr><tr><td align="center">toUTCString()</td><td>以特定于实现的格式完整的UTC日期</td><td align="center"></td></tr><tr><td align="center">自定义</td><td></td><td align="center"></td></tr></tbody></table><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">format</span>(<span class="params">date</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> date.<span class="title function_">getFullYear</span>() + <span class="string">&#x27;-&#x27;</span> + </span><br><span class="line">        (date.<span class="title function_">getMonth</span>() + <span class="number">1</span>) + <span class="string">&#x27;-&#x27;</span> +</span><br><span class="line">        date.<span class="title function_">getDate</span>() + <span class="string">&#x27;-&#x27;</span> + </span><br><span class="line">        date.<span class="title function_">getHours</span>() + <span class="string">&#x27;-&#x27;</span> + </span><br><span class="line">        date.<span class="title function_">getMinutes</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>Date对象是基于1970年1月1日（世界标准时间）起的毫秒数</p><p>获得Date总的毫秒数，不是当前时间的毫秒数，而是距离1970年1月1日过了多少毫秒数</p><p>获取总毫秒数的方式如下：</p><ul><li>valueOf() 、getTime()：</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通过valueOf() getTime()查看</span></span><br><span class="line"><span class="keyword">var</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(date.<span class="title function_">valueOf</span>()); <span class="comment">// 距离1970年1月1日的总毫秒数</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(date.<span class="title function_">getTime</span>());<span class="comment">// 距离1970年1月1日的总毫秒数</span></span><br></pre></td></tr></table></figure><ul><li>简单的写法（最常用的写法）：</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> date = +<span class="keyword">new</span> <span class="title class_">Date</span>(); <span class="comment">// +new Date() 括号内为空，则返回的就是总的毫秒数</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(date)</span><br></pre></td></tr></table></figure><ul><li>H5 新增的 获取总的毫秒数</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Date</span>.<span class="title function_">now</span>())</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="Array-数组对象"><a href="#Array-数组对象" class="headerlink" title="Array 数组对象"></a>Array 数组对象</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array">Array - JavaScript | MDN (mozilla.org)</a></p><a href="/posts/340249a9/" title="数组">数组</a><h2 id="String-字符串对象"><a href="#String-字符串对象" class="headerlink" title="String 字符串对象"></a>String 字符串对象</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String">String - JavaScript | MDN (mozilla.org)</a></p><table><thead><tr><th align="center">方法</th><th>作用</th><th>示例</th><th>返回值</th></tr></thead><tbody><tr><td align="center">string.prototype.charAt(index)</td><td>返回字符串中特定索引处的字符</td><td>str.charAt(0)</td><td>指定位置的字符&#x2F;空字符</td></tr><tr><td align="center">charCodeAt()</td><td>返回字符串中特定索引处的字符的ASCll码</td><td>str.charCodeAt(0)</td><td></td></tr><tr><td align="center">toUpperCase()</td><td>将字符串的所有字符转换成大写字母</td><td>str.toUpperCase()</td><td></td></tr><tr><td align="center">toLowerCase()</td><td>将字符串的所有字符转换成小写字母</td><td>str.toLowerCase()</td><td></td></tr><tr><td align="center">indexOf</td><td>返回字符串中特定字符串第一次出现的位置</td><td>str.indexOf(‘Q’, [起始位置])<br />起始位置不写，默认从第一个字符开始查找</td><td></td></tr><tr><td align="center">lastIndexOf</td><td>返回字符串中特定字符串最后一次出现的位置</td><td></td><td></td></tr><tr><td align="center">substr()</td><td>从起始索引提取字符串中指定数目的字符</td><td></td><td></td></tr><tr><td align="center">substring()</td><td>提取字符串中两个指定的索引值之间的字符</td><td></td><td></td></tr><tr><td align="center">slice()</td><td>返回字符串的某个子串，支持负数参数，功能更强大</td><td></td><td></td></tr><tr><td align="center">concat()</td><td>用于将多个字符串拼加成一个字符串</td><td></td><td></td></tr><tr><td align="center">string.prototype.replace()</td><td>将字符串中的某个子串以特定的字符串替换</td><td>replace(‘被替换的字符’, ‘替换的字符’)<br />只会替换第一个字符</td><td></td></tr><tr><td align="center">split()</td><td>将某个字符串分割成多个字符串，可以指定分隔符</td><td>str.split(‘,’)</td><td></td></tr><tr><td align="center">string.prototype.match(regexp)</td><td>使用正则表达式搜索目标子字符串</td><td></td><td>返回匹配结果的数组</td></tr><tr><td align="center">string.prototype.search(regexp)</td><td>执行正则表达式和string之间的搜索匹配</td><td></td><td>第一个匹配的的子串的起始位置或-1</td></tr><tr><td align="center">trim()</td><td>移除字符串首尾空白</td><td></td><td></td></tr></tbody></table><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">求字符出现的位置及次数（案例）</button></li><li class="tab"><button type="button" data-href="#super-2">统计出现次数最多的字符（案例）</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>示例：查找字母 o ，”haeobcosndosoaoaoaoaxovfodo”</p><p>核心算法：</p><p>1、先查找第一个o出现的位置</p><p>2、indexOf()返回的结果不是-1，就继续往后查找</p><p>3、因为indexOf()只能查找到第一个就停止，所以后面的查找，需要用第二个参数的索引加1，以此类推，直到indexOf() &#x3D;&#x3D;-1结束</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">&#x27;haeobcosndosoaoaoaoaxovfodo&#x27;</span></span><br><span class="line"><span class="keyword">var</span> index = str.<span class="title function_">indexOf</span>(<span class="string">&#x27;o&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> num = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> (index !== -<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(index);</span><br><span class="line">    num++;</span><br><span class="line">    index = str.<span class="title function_">indexOf</span>(<span class="string">&#x27;o&#x27;</span>, index + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;o出现的次数：&#x27;</span>, num);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>步骤：</p><p>1、核心算法：利用chartAt()遍历这个字符串</p><p>2、把每个字符都存储给对象，如果对象没有该属性，就为1，如果存在了就+1</p><p>3、遍历对象，得到最大值和该字符</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">&#x27;dnkfjejowdsmfjowhndfbjwhwomc&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 把每个字符存入对象，</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; str.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">var</span> chars = str.<span class="title function_">charAt</span>(i); <span class="comment">// 得到每一个字符</span></span><br><span class="line">    <span class="comment">// obj[chars] 得到的是属性值，判断它是否存在，存在则里面的次数+1</span></span><br><span class="line">     obj[chars] ? obj[chars]++ : obj[chars] = <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 遍历对象</span></span><br><span class="line"><span class="keyword">var</span> max = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> maxChar = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">for</span> (k <span class="keyword">in</span> obj) &#123;</span><br><span class="line">    <span class="comment">// k 是属性名</span></span><br><span class="line">    <span class="comment">// obj[k] 是属性值</span></span><br><span class="line">    <span class="keyword">if</span> (obj[k] &gt; max) &#123;</span><br><span class="line">        max = obj[k];</span><br><span class="line">        maxChar = k</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;出现次数最多的是：&#x27;</span> + maxChar + <span class="string">&#x27; 次数：&#x27;</span> + max); </span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="RegExp-正则对象"><a href="#RegExp-正则对象" class="headerlink" title="RegExp 正则对象"></a>RegExp 正则对象</h2><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>正则表达式用于定义一些字符串的规则，计算机可以根据正则表达式，来检查一个字符串是否符合规则，获取将字符串中符合规则的内容提取出来。</p><p>使用typeof检查正则对象，会返回object。</p><p>目的</p><ul><li>给定的字符串是否符合正则表达式的过滤逻辑(称作”匹配”)</li><li>可以通过正则表达式，从字符串中获取想要的特定部分</li></ul><p>正则表达式的特点</p><ul><li>灵活性、逻辑性和功能性非常的强</li><li>可以迅速地用极简单的方式达到字符串的复杂控制</li></ul><h3 id="创建正则对象"><a href="#创建正则对象" class="headerlink" title="创建正则对象"></a>创建正则对象</h3><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">使用对象创建</button></li><li class="tab"><button type="button" data-href="#super-2">使用字面量创建</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>语法格式：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> 变量名 = <span class="keyword">new</span> <span class="title class_">RegExp</span>(<span class="string">&quot;正则表达式&quot;</span>,<span class="string">&quot;匹配模式&quot;</span>);</span><br></pre></td></tr></table></figure><p>匹配模式：</p><p>i：忽略大小写<br>g：全局匹配模式<br>ig：忽略大小写且全局匹配模式<br>案例演示：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这个正则表达式可以来检查一个字符串中是否含有a</span></span><br><span class="line"><span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="title class_">RegExp</span>(<span class="string">&quot;ab&quot;</span>, <span class="string">&quot;i&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;Abc&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> result = reg.<span class="title function_">test</span>(str);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>语法格式：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> 变量名 = <span class="regexp">/正则表达式/</span>匹配模式;</span><br></pre></td></tr></table></figure><p>匹配模式：</p><p>i：忽略大小写<br>g：全局匹配模式<br>m：执行多行匹配<br>注意：可以为一个正则表达式设置多个匹配模式，且顺序无所谓</p><p>案例演示：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这个正则表达式可以来检查一个字符串中是否含有a</span></span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/a/i</span>;</span><br><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;Abc&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> result = reg.<span class="title function_">test</span>(str);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h3><p>RegExp.prototype.test(str)<br>作用：</p><ul><li>判定正则表达式与指定的字符串是否匹配<br>参数：</li></ul><ul><li>str：用来匹配的字符串<br>返回值：</li><li>true&#x2F;false</li></ul><p>RegExp.prototype.exec(str)<br>作用：</p><ul><li>在指定字符串中执行搜索匹配，得到结果数组<br>参数：</li></ul><ul><li>str:要匹配的字符串<br>返回值：</li><li>完整的匹配数组，第一个元素是匹配的字符串，余下的元素是<br>分组的子表达式匹配的子串<br>说明：</li></ul><ul><li>此方法执行完会更新正则表达式对象中的属性lastlndex</li></ul><h3 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h3><p>RegExp.lastIndex<br>作用：</p><ul><li>指定下一次匹配的起始索引</li><li>使用全局检索时才生效</li></ul><h3 id="案例分析"><a href="#案例分析" class="headerlink" title="案例分析"></a>案例分析</h3><p>案例分析-邮箱<br><code>edu163@163.com</code><br>( [\w_.-+] )+    必须有@字符 。<br>@                  前缀字符前至少有一个字符，允许的字符有字母、数字、.、_和-<br>( [\w-]+. )+      提供商必须包含至少一个字符，允许的字符有字母、数字、-和.<br>( [\w]{2,10} )+     最后以2-10个字母或数字结尾</p><p><code>/^( [ \w_\.\-\+] )+\@( [\w\-]+\. )+( [\w]&#123;2,10&#125; )+$/</code><br>、网易NETEASE Web前端微专业</p><p>案例分析-url<br><img src="/image/JS%E5%86%85%E7%BD%AE%E5%AF%B9%E8%B1%A1/1663149397281.png" alt="1663149397281"></p><h2 id="Global-全局对象"><a href="#Global-全局对象" class="headerlink" title="Global 全局对象"></a>Global 全局对象</h2><h2 id="Error-错误对象"><a href="#Error-错误对象" class="headerlink" title="Error 错误对象"></a>Error 错误对象</h2><ol><li>创建Error<br>new Error(message);</li></ol><ul><li>创建一个Error对象，运行时抛出</li><li>参数：</li><li>message：错误信息</li><li>返回值：Error实例</li></ul><ol start="2"><li>抛出&#x2F;捕获Error</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"> 语句</span><br><span class="line">&#125; <span class="keyword">catch</span> (exception) &#123;</span><br><span class="line">  语句</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">  语句</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>Error属性<br>Error.prototype.name</li></ol><ul><li>Error的名称</li><li>默认值：Error<br>Error.prototype.message</li><li>错误信息</li><li>默认值：empty</li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 高阶对象 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JS内置对象 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JS-自学之路</title>
      <link href="/posts/fef2da2b/"/>
      <url>/posts/fef2da2b/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ECMAScript基础"><a href="#ECMAScript基础" class="headerlink" title="ECMAScript基础"></a>ECMAScript基础</h1><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">初始化JavaScript</button></li><li class="tab"><button type="button" data-href="#super-2">数据类型</button></li><li class="tab"><button type="button" data-href="#super-3">数据结构</button></li><li class="tab"><button type="button" data-href="#super-4">字面量和变量</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">浏览器执行JS过程</button></li><li class="tab"><button type="button" data-href="#super-2">JS的组成</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><a href="/posts/bc5f0cb1/" title="JavaScript执行过程">JavaScript执行过程</a></p><p>浏览器分成两部分：渲染引擎、JS引擎</p><ul><li><strong>渲染引擎</strong> ：用来解析HTML和CSS，俗称内核。比如，chrome浏览器的blink，老版本的webkit</li><li><strong>JS引擎</strong> ：亦称为JS解析器。用来读取网页中的JavaScript代码，对其处理后运行。比如，chrome的V8 浏览器本身并不会执行JS代码，而是通过内置JavaScript引擎（解释器）来执行JS代码。JS引擎执行代码时，逐行解释每一句源码（转换为机器语言），然后由计算机去执行。所以，JavaScript语言归为脚本语言，会逐行进行解释执行。</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>js由三部分内容组成：</p><blockquote><p>ECMAScript：JavaScript基础语法<br><a href="/posts/f75e92e9/" title="DOM">DOM</a>：页面文档对象模型（操作页面结构——网页内容、结构、样式）<br><a href="/posts/f3d3ee5b/" title="BOM">BOM</a>：浏览器对象模型（操作浏览器）<br>DOM API + BOM API &#x3D; web API</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">基础</button></li><li class="tab"><button type="button" data-href="#super-2">数据类型转换</button></li><li class="tab"><button type="button" data-href="#super-3">数据类型判断</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><a href="/posts/ba595a63/" title="数据类型">数据类型</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><ul><li>转换为String类型</li><li>转换为Number类型</li><li>转换为Boolean类型<br><a href="/posts/7af85a27/" title="数据类型转换方式">数据类型转换方式</a></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p><a href="/posts/198fa1b/" title="数据类型判断方法">数据类型判断方法</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">栈</button></li><li class="tab"><button type="button" data-href="#super-2">队列</button></li><li class="tab"><button type="button" data-href="#super-3">数组</button></li><li class="tab"><button type="button" data-href="#super-4">链表</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><a href="/posts/1f4ac2fb/" title="栈">栈</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><a href="/posts/b6c47025/" title="队列">队列</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p><a href="/posts/340249a9/" title="数组">数组</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p><a href="/posts/2362a8ea/" title="链表">链表</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">字面量</button></li><li class="tab"><button type="button" data-href="#super-2">变量</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>字面量实际上就是一些固定的值，比如：1、2 、3、true、false、null、NaN、“hello”，字面量都是不可以改变的，由于字面量不是很方便使用，所以在JavaScript中很少直接使用字面量，使用的而是变量。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><a href="/posts/13ffbe88/" title="变量">变量</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h1 id="控制流程"><a href="#控制流程" class="headerlink" title="控制流程"></a>控制流程</h1><a href="/posts/fc724bce/" title="控制流程">控制流程</a><h1 id="机制原理"><a href="#机制原理" class="headerlink" title="机制原理"></a>机制原理</h1><h1 id="函数式编程"><a href="#函数式编程" class="headerlink" title="函数式编程"></a>函数式编程</h1><h2 id="函数初阶"><a href="#函数初阶" class="headerlink" title="函数初阶"></a>函数初阶</h2><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">基础</button></li><li class="tab"><button type="button" data-href="#super-2">函数基础</button></li><li class="tab"><button type="button" data-href="#super-3">匿名函数</button></li><li class="tab"><button type="button" data-href="#super-4">立即执行函数</button></li><li class="tab"><button type="button" data-href="#super-5">对象中的函数</button></li><li class="tab"><button type="button" data-href="#super-6">箭头函数——ES6</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><a href="/posts/20dbfd00/" title="基础">基础</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><a href="/posts/1111c3f5/" title="函数基础">函数基础</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>匿名函数：没有名字的函数就是匿名函数，它可以让一个变量来接收，也就是用 “函数表达式” 方式创建和接收。</p><p>案例演示：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fun = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&quot;我是一个匿名函数&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">fun</span>();</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>立即执行函数——immediately Invoked Function Expression（IIFE）</p><blockquote><p>函数定义完，立即被调用，这种函数叫做立即执行函数，立即执行函数往往只会执行一次。<br>案例演示：</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&quot;我是一个匿名函数&quot;</span>);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><blockquote><p>ES6不需要IIFE</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p>对象的属性值可以是任何的数据类型，也可以是个函数。</p><p>如果一个函数作为一个对象的属性保存，那么我们称这个函数是这个对象的方法，调用这个函数就说调用对象的方法（method）。</p><p>注意：方法和函数只是名称上的区别，没有其它别的区别</p><p>案例演示：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;zhangsan&quot;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">    <span class="attr">sayHello</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(name + <span class="string">&quot; hello&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;person.<span class="title function_">sayHello</span>();</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-6"><p><a href="/posts/de81bfb9/" title="ES6新特性">ES6新特性</a></p><p><a href="/posts/de81bfb9/##%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0">hexo 安装</a></p><p><a href="/posts/de81bfb9/##箭头函数">hexo 安装</a><br><a href="##%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B">跳转</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="函数式编程-1"><a href="#函数式编程-1" class="headerlink" title="函数式编程"></a>函数式编程</h2><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">函数式编程</button></li><li class="tab"><button type="button" data-href="#super-2">函数柯里化（curry）</button></li><li class="tab"><button type="button" data-href="#super-3">Compose和Pipe函数</button></li><li class="tab"><button type="button" data-href="#super-4">高阶函数</button></li><li class="tab"><button type="button" data-href="#super-5">防抖和节流</button></li><li class="tab"><button type="button" data-href="#super-6">underscorejs</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><a href="/posts/1690d21b/" title="函数式编程">函数式编程</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>柯里化的意思是将一个多元函数，转换成一个依次调用的单元函数。</p><blockquote><p><code>f(a,b,c) → f(a)(b)(c)</code></p></blockquote><p><a href="/posts/d56cb4fa/" title="函数柯里化（curry）">函数柯里化（curry）</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>函数组合概念<br>函数组合的目的是将多个函数组合成一个函数。下面来看一个简化版的实现：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">compose</span> = (<span class="params">f, g</span>) =&gt; <span class="function"><span class="params">x</span> =&gt;</span> <span class="title function_">f</span>(<span class="title function_">g</span>(x))</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">f</span> = x =&gt; x + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">g</span> = x =&gt; x * <span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> fg = <span class="title function_">compose</span>(f, g);</span><br><span class="line"><span class="title function_">fg</span>(<span class="number">1</span>) <span class="comment">//3</span></span><br></pre></td></tr></table></figure><blockquote><p>可以看到 compose 就实现了一个简单的功能：形成了一个全新的函数，而这个函数就是一条从 g -&gt; f 的流水线。</p></blockquote><p>curry函数和compose函数的关系</p><blockquote><p>柯里化其实就是流水线上的加工站，函数组合就是我们的流水线，它由多个加工站组成。</p></blockquote><p><a href="/posts/82dafe4d/" title="compose和pipe函数">compose和pipe函数</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p><a href="/posts/100fa4c9/" title="防抖与节流">防抖与节流</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-6"><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="函数进阶"><a href="#函数进阶" class="headerlink" title="函数进阶"></a>函数进阶</h2><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">原型与原型链</button></li><li class="tab"><button type="button" data-href="#super-2">执行上下文this指向</button></li><li class="tab"><button type="button" data-href="#super-3">作用域与作用域链</button></li><li class="tab"><button type="button" data-href="#super-4">闭包</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">原型</button></li><li class="tab"><button type="button" data-href="#super-2">原型链</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><a href="/posts/263f3be4/" title="原型">原型</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><a href="/posts/bf8cf30/" title="原型链">原型链</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">执行上下文</button></li><li class="tab"><button type="button" data-href="#super-2">执行上下文栈</button></li><li class="tab"><button type="button" data-href="#super-3">执行上下文this指向</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><a href="/posts/18bcf77b/" title="执行上下文">执行上下文</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><a href="/posts/dec4cd8f/" title="执行上下文栈">执行上下文栈</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p><a href="/posts/5d04ce7e/" title="执行上下文this指向">执行上下文this指向</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">预解析（提升）</button></li><li class="tab"><button type="button" data-href="#super-2">作用域</button></li><li class="tab"><button type="button" data-href="#super-3">作用域链</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><a href="/posts/a419e871/" title="预解析(提升)">预解析(提升)</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><a href="/posts/7a108a3c/" title="作用域">作用域</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p><a href="/posts/de6d0944/" title="作用域链">作用域链</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p><a href="/posts/f9636392/" title="闭包">闭包</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h1 id="面向对象"><a href="#面向对象" class="headerlink" title="面向对象"></a>面向对象</h1><p>面向对象：Object-oriented programming（OOP）</p><p>具有对象概念的程序编程典范，同时也是一种程序开发的抽象方针。它可能包含数据、属性、代码与方法。<strong>对象则指的是类的实例</strong>。它将对象作为程序的基本单元，<strong>将程序和数据封装其中，以提高软件的重用性、灵活性和扩展性</strong>，对象里的程序可以访问及经常修改对象相关连的数据。在面向对象程序编程里，计算机程序会被设计成彼此相关的对象。</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">对象</button></li><li class="tab"><button type="button" data-href="#super-2">对象进阶</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">基础</button></li><li class="tab"><button type="button" data-href="#super-2">对象解构赋值——ES6</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><a href="/posts/9eb8af5a/" title="对象">对象</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><a href="/posts/de81bfb9/" title="ES6新特性">ES6新特性</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">对象继承</button></li><li class="tab"><button type="button" data-href="#super-2">深浅拷贝——ES6</button></li><li class="tab"><button type="button" data-href="#super-3">垃圾回收</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><a href="/posts/388b3727/" title="JavaScript - 继承">JavaScript - 继承</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><a href="/posts/e98504f5/" title="深浅拷贝">深浅拷贝</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p><a href="/posts/72f47432/" title="垃圾回收">垃圾回收</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h1 id="JS异步编程"><a href="#JS异步编程" class="headerlink" title="JS异步编程"></a>JS异步编程</h1><p>异步</p><h2 id="浏览器的事件循环（轮询）-EventLoop-模型"><a href="#浏览器的事件循环（轮询）-EventLoop-模型" class="headerlink" title="浏览器的事件循环（轮询）(EventLoop)模型"></a>浏览器的事件循环（轮询）(EventLoop)模型</h2><a href="/posts/4e43da1/" title="事件循环（EventLoop）">事件循环（EventLoop）</a><p>发布&#x2F;订阅模式<br>深入理解Promise<br>Generator<br>CO模块<br>Async和Await<br>手写Promise<br>webworker多线程机制<br>Rxjs</p><h1 id="设计模式"><a href="#设计模式" class="headerlink" title="设计模式"></a>设计模式</h1><a href="/posts/364ea8cc/" title="设计模式">设计模式</a><h1 id="JS中高阶对象"><a href="#JS中高阶对象" class="headerlink" title="JS中高阶对象"></a>JS中高阶对象</h1><p>分为三种</p><ul><li>自定义对象</li><li>内置对象</li><li>浏览器对象（BOM）</li></ul><p>自定义对象和内置对象属于ECMAScript，浏览器对象属于js独有的（js API）</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">自定义对象</button></li><li class="tab"><button type="button" data-href="#super-2">内置对象</button></li><li class="tab"><button type="button" data-href="#super-3">浏览器对象（BOM）</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><a href="/posts/72f2429a/" title="JS自定义对象">JS自定义对象</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><a href="/posts/9271cfed/" title="JS内置对象">JS内置对象</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p><a href="/posts/3a160893/" title="JS浏览器对象">JS浏览器对象</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h1 id="ES特性"><a href="#ES特性" class="headerlink" title="ES特性"></a>ES特性</h1><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">ES6新特性</button></li><li class="tab"><button type="button" data-href="#super-2">ES7新特性</button></li><li class="tab"><button type="button" data-href="#super-3">ES8新特性</button></li><li class="tab"><button type="button" data-href="#super-4">ES9新特性</button></li><li class="tab"><button type="button" data-href="#super-5">ES10新特性</button></li><li class="tab"><button type="button" data-href="#super-6">ES11新特性</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><a href="/posts/de81bfb9/" title="ES6新特性">ES6新特性</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><a href="/posts/3143d487/" title="ES7新特性">ES7新特性</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p><a href="/posts/c0488f0a/" title="ES8新特性">ES8新特性</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p><a href="/posts/2f8ae434/" title="ES9新特性">ES9新特性</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p><a href="/posts/ec010a4e/" title="ES10新特性">ES10新特性</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-6"><p><a href="/posts/3c36170/" title="ES11新特性">ES11新特性</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 自学之路 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git-使用方法总览</title>
      <link href="/posts/ca2adad3/"/>
      <url>/posts/ca2adad3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a href="https://www.liaoxuefeng.com/wiki/896043488029600">查看全部内容</a></p><h1 id="Git使用方法总览"><a href="#Git使用方法总览" class="headerlink" title="Git使用方法总览"></a>Git使用方法总览</h1><ul><li><a href="/posts/b364958a/" title="Git-安装教程">Git-安装教程</a></li><li><a href="/posts/84e344b9/" title="Git-使用教程">Git-使用教程</a></li><li><a href="/posts/90f6c624/" title="Git-创建与合并分支">Git-创建与合并分支</a></li><li><a href="/posts/a71bafb4/" title="Git-bug分支">Git-bug分支</a></li><li><a href="/posts/9983a820/" title="Git-常用指令">Git-常用指令</a></li><li><a href="/posts/131126ae/" title="Git-使用时可能遇到的问题">Git-使用时可能遇到的问题</a></li><li><a href="/posts/801c406d/" title="Github制作个人网站">Github制作个人网站</a></li></ul><h4 id="1-初始化"><a href="#1-初始化" class="headerlink" title="1. 初始化"></a>1. 初始化</h4><h5 id="用户"><a href="#用户" class="headerlink" title="用户"></a>用户</h5><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="keyword">config</span> --<span class="keyword">global</span> user<span class="variable">.email</span> <span class="string">&quot;your email&quot;</span></span><br><span class="line">$ git <span class="keyword">config</span> –-<span class="keyword">global</span> user<span class="variable">.name</span> <span class="string">&quot;your name&quot;</span></span><br></pre></td></tr></table></figure><h4 id="2-秘钥"><a href="#2-秘钥" class="headerlink" title="2. 秘钥"></a>2. 秘钥</h4><h5 id="查看是否存在秘钥"><a href="#查看是否存在秘钥" class="headerlink" title="查看是否存在秘钥"></a>查看是否存在秘钥</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> -al ~/.ssh</span></span><br></pre></td></tr></table></figure><p>id_rsa 是私钥，id_rsa.pub 是公钥</p><p>id_rsa.pub 是你需要上传到 github 的 SSH KEY</p><h5 id="生成秘钥"><a href="#生成秘钥" class="headerlink" title="生成秘钥"></a>生成秘钥</h5><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -t rsa -<span class="keyword">b</span> <span class="number">4096</span> -C <span class="string">&quot;your_email@example.com&quot;</span></span><br></pre></td></tr></table></figure><h4 id="3-本地库和远程库"><a href="#3-本地库和远程库" class="headerlink" title="3. 本地库和远程库"></a>3. 本地库和远程库</h4><h5 id="已创建有远程库，未创建本地库"><a href="#已创建有远程库，未创建本地库" class="headerlink" title="已创建有远程库，未创建本地库"></a>已创建有远程库，未创建本地库</h5><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="keyword">clone</span> <span class="title">&quot;your</span> repo<span class="string">&quot;</span></span><br></pre></td></tr></table></figure><h5 id="已创建本地库，未创建远程库"><a href="#已创建本地库，未创建远程库" class="headerlink" title="已创建本地库，未创建远程库"></a>已创建本地库，未创建远程库</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">1. 新建文件夹</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">mkdir</span> <span class="built_in">test</span></span> </span><br><span class="line">            </span><br><span class="line">2. 初始化 git </span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git init</span> </span><br><span class="line">  </span><br><span class="line">3. 移除原有的 origin                </span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git remote <span class="built_in">rm</span> origin</span></span><br><span class="line">  </span><br><span class="line">4. 添加你的远程库(SSH地址)</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git remote add origin <span class="string">&quot;your remote repo&quot;</span></span></span><br><span class="line">  </span><br><span class="line">5. 更新本地库</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git pull</span></span><br><span class="line"> </span><br><span class="line">6. 首次推送与远程库建立关联，以后直接 git push 就可以</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git push --set-upstream origin master</span> </span><br></pre></td></tr></table></figure><h4 id="4-分支操作"><a href="#4-分支操作" class="headerlink" title="4. 分支操作"></a>4. 分支操作</h4><h5 id="查看、新建、切换、删除分支"><a href="#查看、新建、切换、删除分支" class="headerlink" title="查看、新建、切换、删除分支"></a>查看、新建、切换、删除分支</h5><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">查看当前所在分支</span><br><span class="line"><span class="variable">$ </span>git branch</span><br><span class="line">  </span><br><span class="line">查看所有分支</span><br><span class="line"><span class="variable">$ </span>git branch -a</span><br><span class="line"></span><br><span class="line">查看远程库信息</span><br><span class="line"><span class="variable">$ </span>git remote -v</span><br><span class="line">  </span><br><span class="line">新建分支</span><br><span class="line"><span class="variable">$ </span>git branch <span class="string">&quot;new branch&quot;</span></span><br><span class="line"></span><br><span class="line">切换分支</span><br><span class="line"><span class="variable">$ </span>git checkout <span class="string">&quot;target branch&quot;</span></span><br><span class="line">  </span><br><span class="line">新建并切换到新分支</span><br><span class="line"><span class="variable">$ </span>git checkout -b <span class="string">&quot;new branch&quot;</span></span><br><span class="line"></span><br><span class="line">新建分支并和远程分支进行关联</span><br><span class="line"><span class="variable">$ </span>git checkout -b <span class="string">&quot;new branch&quot;</span> origin/<span class="string">&quot;new branch&quot;</span></span><br><span class="line"></span><br><span class="line">合并分支到当前所处分支上</span><br><span class="line"><span class="variable">$ </span>git merge <span class="string">&quot;your branch&quot;</span></span><br><span class="line">  </span><br><span class="line">删除分支</span><br><span class="line"><span class="variable">$ </span>git branch -d <span class="string">&quot;your branch&quot;</span></span><br><span class="line">  </span><br><span class="line">强制删除未 commit 的分支</span><br><span class="line"><span class="variable">$ </span>git branch -D <span class="string">&quot;your branch&quot;</span></span><br></pre></td></tr></table></figure><h4 id="5-正常流程"><a href="#5-正常流程" class="headerlink" title="5. 正常流程"></a>5. 正常流程</h4><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">查看当前工作区状态</span><br><span class="line"><span class="symbol">$</span> git status</span><br><span class="line">  </span><br><span class="line">添加单个文件到暂存区</span><br><span class="line"><span class="symbol">$</span> git add xxx.txt</span><br><span class="line">  </span><br><span class="line">一次性添加所有改动文件</span><br><span class="line"><span class="symbol">$</span> git add .</span><br><span class="line">  </span><br><span class="line">提交文件到本地版本库</span><br><span class="line"><span class="symbol">$</span> git commit -m <span class="string">&quot;I add a file.&quot;</span></span><br><span class="line">  </span><br><span class="line">推送本地更新到远程版本库</span><br><span class="line"><span class="symbol">$</span> git push</span><br><span class="line">  </span><br><span class="line">本地库关联远程库</span><br><span class="line"><span class="symbol">$</span> git push --<span class="keyword">set</span>-upstream <span class="comment">origin master</span></span><br></pre></td></tr></table></figure><h4 id="6-对比文件"><a href="#6-对比文件" class="headerlink" title="6. 对比文件"></a>6. 对比文件</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">工作区和暂存区之间差异对比</span><br><span class="line"><span class="variable">$</span> git <span class="built_in">diff</span> <span class="string">&quot;xxx.txt&quot;</span></span><br><span class="line"></span><br><span class="line">暂存区和版本库之间差异对比</span><br><span class="line"><span class="variable">$</span> git <span class="built_in">diff</span> <span class="literal">--cached</span>(<span class="literal">--staged</span>) <span class="string">&quot;xxx.txt&quot;</span></span><br><span class="line"></span><br><span class="line">工作区和版本库之间差异对比</span><br><span class="line"><span class="variable">$</span> git <span class="built_in">diff</span> master</span><br></pre></td></tr></table></figure><h4 id="7-查看历史提交记录"><a href="#7-查看历史提交记录" class="headerlink" title="7. 查看历史提交记录"></a>7. 查看历史提交记录</h4><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">$</span> git <span class="built_in">log</span></span><br></pre></td></tr></table></figure><h4 id="8-版本回退"><a href="#8-版本回退" class="headerlink" title="8. 版本回退"></a>8. 版本回退</h4><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">HEAD 是最新版本，HEAD^ 是上一个版本</span><br><span class="line">$ git reset <span class="comment">--hard HEAD^ </span></span><br><span class="line"></span><br><span class="line">回退到指定<span class="built_in">id</span>，git <span class="built_in">log</span> 查看版本<span class="built_in">id</span>，版本<span class="built_in">id</span>不用全部输入，取头几位就可以</span><br><span class="line">$ git reset –hard cb926e7e</span><br></pre></td></tr></table></figure><h4 id="9-撤销工作区修改"><a href="#9-撤销工作区修改" class="headerlink" title="9. 撤销工作区修改"></a>9. 撤销工作区修改</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">使用版本库中的文件或者暂存区中的文件替换工作区的文件</span><br><span class="line">让文件回到最近一次 git <span class="keyword">commit</span> 或 git <span class="keyword">add</span> 时的状态</span><br><span class="line">$ git checkout <span class="comment">-- &quot;xxx.txt&quot;</span></span><br></pre></td></tr></table></figure><h4 id="10-删除文件"><a href="#10-删除文件" class="headerlink" title="10. 删除文件"></a>10. 删除文件</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">删除工作区中的文件</span><br><span class="line"><span class="variable">$</span> <span class="built_in">rm</span> <span class="string">&quot;xxx.txt&quot;</span></span><br><span class="line"></span><br><span class="line">提交删除操作到暂存区</span><br><span class="line"><span class="variable">$</span> git <span class="built_in">rm</span> <span class="string">&quot;xxx.txt&quot;</span></span><br><span class="line"></span><br><span class="line">提交删除到版本库，在版本库中彻底删除文件</span><br><span class="line"><span class="variable">$</span> git commit <span class="literal">-m</span> <span class="string">&quot;remove file&quot;</span></span><br></pre></td></tr></table></figure><h4 id="11-分支管理策略"><a href="#11-分支管理策略" class="headerlink" title="11. 分支管理策略"></a>11. 分支管理策略</h4><p>在实际开发中，我们应该按照几个基本原则进行分支管理：</p><ul><li>master分支应该是非常稳定的，也就是仅用来发布新版本，平时不能在上面干活</li><li>developer分支用来干活，也就是说，developer分支是不稳定的，到某个时候，比如1.0版本发布时，再把developer分支合并到master上，在master分支发布1.0版本</li><li>你和你的小伙伴们每个人都在developer分支上干活，每个人都有自己的分支，时不时地往developer分支上合并就可以了</li></ul><p><strong>所以，团队合作的分支看起来就像这样：</strong></p><p><img src="https://segmentfault.com/img/remote/1460000015097690"></p><h4 id="12-储藏工作现场"><a href="#12-储藏工作现场" class="headerlink" title="12. 储藏工作现场"></a>12. 储藏工作现场</h4><p>修复bug时，我们会通过创建新的bug分支进行修复，然后合并，最后删除；<br>当手头工作没有完成时，先把工作现场git stash一下，然后去修复bug，修复后，再git stash pop，回到工作现场</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">储存工作现场</span><br><span class="line"><span class="variable">$ </span>git stash</span><br><span class="line"></span><br><span class="line">工作现场列表</span><br><span class="line"><span class="variable">$ </span>git stash list</span><br><span class="line"></span><br><span class="line">恢复但不删除储藏栈的工作现场</span><br><span class="line"><span class="variable">$ </span>git stash apply</span><br><span class="line"></span><br><span class="line">恢复并删除储藏栈中的工作现场</span><br><span class="line"><span class="variable">$ </span>git stash pop</span><br></pre></td></tr></table></figure><h4 id="13-多人协作工作模式"><a href="#13-多人协作工作模式" class="headerlink" title="13. 多人协作工作模式"></a>13. 多人协作工作模式</h4><ul><li>试图用git push origin branch-name推送自己的修改</li><li>如果推送失败，则因为远程分支比你的本地更新，需要先用git pull试图合并</li><li>如果合并有冲突，则解决冲突，并在本地提交</li><li>没有冲突或者解决掉冲突后，再用git push origin branch-name推送就能成功</li></ul><h4 id="14-创建-gitignore"><a href="#14-创建-gitignore" class="headerlink" title="14. 创建 .gitignore"></a>14. 创建 .gitignore</h4><p>在 git 工作区根目录下创建 .gitignore 文件，把要忽略的文件名写进去，git 就会自动忽略这些文件</p><h4 id="15-创建别名"><a href="#15-创建别名" class="headerlink" title="15. 创建别名"></a>15. 创建别名</h4><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">给 <span class="built_in">status</span> 创建别名 st </span><br><span class="line">$ git <span class="built_in">config</span> <span class="comment">--global alias.st status</span></span><br></pre></td></tr></table></figure><h4 id="16-git-配置文件"><a href="#16-git-配置文件" class="headerlink" title="16. git 配置文件"></a>16. git 配置文件</h4><p>配置文件放在 ~&#x2F;.gitconfig</p><h4 id="17-git-fetch-和-git-pul-区别"><a href="#17-git-fetch-和-git-pul-区别" class="headerlink" title="17. git fetch 和 git pul 区别"></a>17. git fetch 和 git pul 区别</h4><p>要讲清楚这两个命令的区别，就需要从git clone开始讲起</p><p>假设你在github上有一个远程仓库地址是xxx，然后你从远程仓库clone到本地仓库</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="keyword">clone</span> <span class="title">xxx</span></span><br></pre></td></tr></table></figure><p>执行完此命令后，Git会自动为你将远程仓库命名为origin，并下载其中所有的数据到本地，在本地建立所有远程存在的分支，并且命名为origin&#x2F;xxx，例如远程分支有master、developer，那么本地就会建立origin&#x2F;master分支、origin&#x2F;developer分支，并且它们都是处于remotes目录下，是隐藏的。使用命令git branch -a就可以看到隐藏目录remotes，结果显示为remotes&#x2F;origin&#x2F;master以及remotes&#x2F;origin&#x2F;developer。接着，Git会继续建立一个属于你的本地master和developer分支，位置和远程origin&#x2F;master、origin&#x2F;developer分支处于相同的位置，你就可以开始工作了。<br>这样，我们在本地仓库的本地分支和远程分支就都有了，并且始于同一位置。</p><p><img src="https://segmentfault.com/img/remote/1460000015097691"></p><p>如果其他人向github上xxx推送了他们的更新，那么服务器上的相应分支就会向前推进。如果在本地的相应分支进行了commit提交到本地代码库，那么本地的master或者developer分支也会向前推进，不过只要你不和服务器通信数据，那么本地的remotes&#x2F;origin&#x2F;master（developer）指针仍然会在原地不动。</p><p><img src="https://segmentfault.com/img/remote/1460000015097692"></p><p>注意这里的本地分支master已经前移，服务器上的master分支也已经前移，所以可以说本地的remotes&#x2F;origin&#x2F;master是过时的。</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>git fetch origin</span><br></pre></td></tr></table></figure><p>运行git fetch origin命令后，会同步远程服务器上的数据到本地，该命令首先找到origin是哪个服务器，从上面获取你未曾拥有的数据，更新到你的本地remotes&#x2F;origin&#x2F;master（developer），然后把remotes&#x2F;origin&#x2F;master(developer)的指针移动到最新的位置上：</p><p><img src="https://segmentfault.com/img/remote/1460000015097693"></p><p>这就是git fetch origin的作用</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">比较本地 <span class="keyword">master</span> <span class="title">分支和 origin</span>/<span class="keyword">master</span> <span class="title">分支有什么区别</span></span><br><span class="line"><span class="title">$</span> git log <span class="literal">master</span>..origin/<span class="keyword">master</span> </span><br><span class="line"></span><br><span class="line"><span class="title">切换到本地 master</span> 分支下</span><br><span class="line">$ git checkout <span class="keyword">master</span> </span><br><span class="line"></span><br><span class="line"><span class="title">合并 origin</span>/<span class="keyword">master</span> <span class="title">分支到本地 master</span> 分支</span><br><span class="line">$ git merge origin <span class="literal">master</span></span><br></pre></td></tr></table></figure><ul><li>git pull 相当于 git fetch origin 和 git merge</li><li>git fetch 相当于先将服务器上的 origin 分支更新到本地 remotes&#x2F;origin 分支上，然后手动去 merge 合并 origin 分支到本地分支上</li></ul><p><strong>这就是 git pull 和 git fetch 的区别</strong></p><h4 id="18-git-删除未跟踪文件"><a href="#18-git-删除未跟踪文件" class="headerlink" title="18. git 删除未跟踪文件"></a>18. git 删除未跟踪文件</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">删除未跟踪文件</span><br><span class="line"><span class="variable">$</span> git clean <span class="operator">-f</span></span><br><span class="line"></span><br><span class="line">删除未跟踪文件目录</span><br><span class="line"><span class="variable">$</span> git clean <span class="literal">-fd</span></span><br><span class="line"></span><br><span class="line">正式删除文件以前先查看哪些会被删除</span><br><span class="line"><span class="variable">$</span> git clean <span class="literal">-nf</span></span><br><span class="line"><span class="variable">$</span> git clean <span class="literal">-nfd</span></span><br></pre></td></tr></table></figure><h4 id="19-在本地删除远程已经没有的分支"><a href="#19-在本地删除远程已经没有的分支" class="headerlink" title="19. 在本地删除远程已经没有的分支"></a>19. 在本地删除远程已经没有的分支</h4><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>git fetch -p origin</span><br></pre></td></tr></table></figure><h4 id="20-重命名本地分支"><a href="#20-重命名本地分支" class="headerlink" title="20. 重命名本地分支"></a>20. 重命名本地分支</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git branch -m <span class="built_in">old</span>-<span class="keyword">local</span>-branch-<span class="type">name</span> <span class="built_in">new</span>-<span class="keyword">local</span>-branch-<span class="type">name</span></span><br></pre></td></tr></table></figure><h4 id="21-删除远程分支"><a href="#21-删除远程分支" class="headerlink" title="21. 删除远程分支"></a>21. 删除远程分支</h4><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>git push origin <span class="symbol">:old-remote-branch-name</span></span><br></pre></td></tr></table></figure><h4 id="22-本地分支与远程分支建立关联（远程分支不存在也可以）"><a href="#22-本地分支与远程分支建立关联（远程分支不存在也可以）" class="headerlink" title="22. 本地分支与远程分支建立关联（远程分支不存在也可以）"></a>22. 本地分支与远程分支建立关联（远程分支不存在也可以）</h4><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">切换到本地分支</span><br><span class="line">$ git checkout <span class="built_in">local</span>-branch</span><br><span class="line"></span><br><span class="line"><span class="built_in">push</span> 到想要建立关联的远程分支</span><br><span class="line">$ git <span class="built_in">push</span> -u <span class="built_in">origin</span>/remote-branch</span><br></pre></td></tr></table></figure><h4 id="23-重新跟踪远程文件"><a href="#23-重新跟踪远程文件" class="headerlink" title="23. 重新跟踪远程文件"></a>23. 重新跟踪远程文件</h4><figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">先删除远程文件</span><br><span class="line">$ <span class="string">git</span> <span class="string">remote</span> <span class="string">rm</span> <span class="string">origin</span></span><br><span class="line"></span><br><span class="line">跟踪新远程文件</span><br><span class="line">$ <span class="string">git</span> <span class="string">remote</span> <span class="string">add</span> <span class="string">origin</span> <span class="string">https</span>://<span class="string">xxx</span>.<span class="string">git</span></span><br><span class="line"></span><br><span class="line">或者合并成一条命令</span><br><span class="line">$ <span class="string">git</span> <span class="string">remote</span> <span class="string">origin</span> <span class="built_in">set-url</span> <span class="string">https</span>://<span class="string">xxx</span>.<span class="string">git</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="ie=edge"><title>Markmap</title><style>* {  margin: 0;  padding: 0;}#mindmap {  display: block;  width: 100vw;  height: 100vh;}</style><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.13.5/dist/style.css"></head><body><svg id="mindmap"></svg><script src="https://cdn.jsdelivr.net/npm/d3@6.7.0"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.13.5"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.13.5/dist/index.umd.min.js"></script><script>(r => {                setTimeout(r);              })(() => {  const {    markmap,    mm  } = window;  const toolbar = new markmap.Toolbar();  toolbar.attach(mm);  const el = toolbar.render();  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');  document.body.append(el);})</script><script>((getMarkmap, getOptions, root, jsonOptions) => {        const markmap = getMarkmap();        window.mm = markmap.Markmap.create('svg#mindmap', (getOptions || markmap.deriveOptions)(jsonOptions), root);      })(() => window.markmap,null,{"type":"heading","depth":0,"payload":{"lines":[0,1]},"content":"前端学习路线","children":[{"type":"heading","depth":1,"payload":{"lines":[1,2]},"content":"通用基础","children":[{"type":"heading","depth":2,"payload":{"lines":[2,3]},"content":"编译原理"},{"type":"heading","depth":2,"payload":{"lines":[3,4]},"content":"计算机网络"},{"type":"heading","depth":2,"payload":{"lines":[4,5]},"content":"操作系统"},{"type":"heading","depth":2,"payload":{"lines":[5,6]},"content":"数据结构"},{"type":"heading","depth":2,"payload":{"lines":[6,7]},"content":"算法"},{"type":"heading","depth":2,"payload":{"lines":[7,8]},"content":"设计模式"}]},{"type":"heading","depth":1,"payload":{"lines":[9,10]},"content":"前端基础","children":[{"type":"heading","depth":2,"payload":{"lines":[10,11]},"content":"HTML","children":[{"type":"heading","depth":3,"payload":{"lines":[11,12]},"content":"元素"},{"type":"heading","depth":3,"payload":{"lines":[12,13]},"content":"DOM"},{"type":"heading","depth":3,"payload":{"lines":[13,14]},"content":"语义化"},{"type":"heading","depth":3,"payload":{"lines":[14,15]},"content":"html5标签"},{"type":"heading","depth":3,"payload":{"lines":[15,16]},"content":"SEO搜索优化"}]},{"type":"heading","depth":2,"payload":{"lines":[16,17]},"content":"CSS","children":[{"type":"heading","depth":3,"payload":{"lines":[17,18]},"content":"选择器"},{"type":"heading","depth":3,"payload":{"lines":[18,19]},"content":"布局","children":[{"type":"heading","depth":4,"payload":{"lines":[19,20]},"content":"经典布局（盒模型）"},{"type":"heading","depth":4,"payload":{"lines":[20,21]},"content":"flex"},{"type":"heading","depth":4,"payload":{"lines":[21,22]},"content":"grid"},{"type":"heading","depth":4,"payload":{"lines":[22,23]},"content":"table"}]},{"type":"heading","depth":3,"payload":{"lines":[23,24]},"content":"交互","children":[{"type":"heading","depth":4,"payload":{"lines":[24,25]},"content":"动画"}]},{"type":"heading","depth":3,"payload":{"lines":[25,26]},"content":"响应式设计"},{"type":"heading","depth":3,"payload":{"lines":[26,27]},"content":"CSS3特性"},{"type":"heading","depth":3,"payload":{"lines":[27,28]},"content":"CSS框架"}]},{"type":"heading","depth":2,"payload":{"lines":[28,29]},"content":"JavaScript","children":[{"type":"heading","depth":3,"payload":{"lines":[29,30]},"content":"数据类型"},{"type":"heading","depth":3,"payload":{"lines":[30,31]},"content":"原型及原型链"},{"type":"heading","depth":3,"payload":{"lines":[31,32]},"content":"作用域"},{"type":"heading","depth":3,"payload":{"lines":[32,33]},"content":"闭包"},{"type":"heading","depth":3,"payload":{"lines":[33,34]},"content":"异步"},{"type":"heading","depth":3,"payload":{"lines":[34,35]},"content":"事件","children":[{"type":"heading","depth":4,"payload":{"lines":[35,36]},"content":"事件循环"},{"type":"heading","depth":4,"payload":{"lines":[36,37]},"content":"事件队列"},{"type":"heading","depth":4,"payload":{"lines":[37,38]},"content":"事件代理/委托"}]},{"type":"heading","depth":3,"payload":{"lines":[38,39]},"content":"正则表达式"}]}]},{"type":"heading","depth":1,"payload":{"lines":[40,41]},"content":"开发软件补充","children":[{"type":"heading","depth":2,"payload":{"lines":[41,42]},"content":"编辑器和IDE","children":[{"type":"heading","depth":3,"payload":{"lines":[42,43]},"content":"Sublime Text3"},{"type":"heading","depth":3,"payload":{"lines":[43,44]},"content":"Visual Studio Code"},{"type":"heading","depth":3,"payload":{"lines":[44,45]},"content":"WebStorm"}]},{"type":"heading","depth":2,"payload":{"lines":[45,46]},"content":"测试工具","children":[{"type":"heading","depth":3,"payload":{"lines":[46,47]},"content":"Chrome Dev Tools"},{"type":"heading","depth":3,"payload":{"lines":[47,48]},"content":"PostMan"},{"type":"heading","depth":3,"payload":{"lines":[48,49]},"content":"Firebug"}]},{"type":"heading","depth":2,"payload":{"lines":[49,50]},"content":"切图","children":[{"type":"heading","depth":3,"payload":{"lines":[50,51]},"content":"Sketch"},{"type":"heading","depth":3,"payload":{"lines":[51,52]},"content":"PhotoShop"},{"type":"heading","depth":3,"payload":{"lines":[52,53]},"content":"PxCook"}]},{"type":"heading","depth":2,"payload":{"lines":[53,54]},"content":"交互","children":[{"type":"heading","depth":3,"payload":{"lines":[54,55]},"content":"Axure"}]}]},{"type":"heading","depth":1,"payload":{"lines":[56,57]},"content":"类库框架","children":[{"type":"heading","depth":2,"payload":{"lines":[57,58]},"content":"工具类","children":[{"type":"heading","depth":3,"payload":{"lines":[58,59]},"content":"jQuery"},{"type":"heading","depth":3,"payload":{"lines":[59,60]},"content":"Bootstrap"},{"type":"heading","depth":3,"payload":{"lines":[60,61]},"content":"Zepto"},{"type":"heading","depth":3,"payload":{"lines":[61,62]},"content":"lodash"}]},{"type":"heading","depth":2,"payload":{"lines":[62,63]},"content":"开发库/框架","children":[{"type":"heading","depth":3,"payload":{"lines":[63,64]},"content":"vue","children":[{"type":"heading","depth":4,"payload":{"lines":[64,65]},"content":"Vuex*"},{"type":"heading","depth":4,"payload":{"lines":[65,66]},"content":"Vue-router*"},{"type":"heading","depth":4,"payload":{"lines":[66,67]},"content":"Vue-cli*"},{"type":"heading","depth":4,"payload":{"lines":[67,68]},"content":"Element Ui"},{"type":"heading","depth":4,"payload":{"lines":[68,69]},"content":"Nuxt"},{"type":"heading","depth":4,"payload":{"lines":[69,70]},"content":"Vue3*","children":[{"type":"heading","depth":5,"payload":{"lines":[70,71]},"content":"原理"},{"type":"heading","depth":5,"payload":{"lines":[71,72]},"content":"vue-components-api"}]}]},{"type":"heading","depth":3,"payload":{"lines":[72,73]},"content":"React","children":[{"type":"heading","depth":4,"payload":{"lines":[73,74]},"content":"Redux*"},{"type":"heading","depth":4,"payload":{"lines":[74,75]},"content":"React-router*"},{"type":"heading","depth":4,"payload":{"lines":[75,76]},"content":"creat-react-app*"},{"type":"heading","depth":4,"payload":{"lines":[76,77]},"content":"Ant Design"},{"type":"heading","depth":4,"payload":{"lines":[77,78]},"content":"Next"}]},{"type":"heading","depth":3,"payload":{"lines":[78,79]},"content":"Anguler"},{"type":"heading","depth":3,"payload":{"lines":[79,80]},"content":"Backbone"},{"type":"heading","depth":3,"payload":{"lines":[80,81]},"content":"Knockout"}]}]},{"type":"heading","depth":1,"payload":{"lines":[82,83]},"content":"工程开发","children":[{"type":"heading","depth":2,"payload":{"lines":[83,84]},"content":"模块化","children":[{"type":"heading","depth":3,"payload":{"lines":[84,85]},"content":"ES6 Module"},{"type":"heading","depth":3,"payload":{"lines":[85,86]},"content":"Common JS"},{"type":"heading","depth":3,"payload":{"lines":[86,87]},"content":"SeaJs/CMD"},{"type":"heading","depth":3,"payload":{"lines":[87,88]},"content":"RequireJS/AMD"}]},{"type":"heading","depth":2,"payload":{"lines":[88,89]},"content":"版本管理","children":[{"type":"heading","depth":3,"payload":{"lines":[89,90]},"content":"Git","children":[{"type":"heading","depth":4,"payload":{"lines":[90,91]},"content":"GitLab"},{"type":"heading","depth":4,"payload":{"lines":[91,92]},"content":"Github"}]},{"type":"heading","depth":3,"payload":{"lines":[92,93]},"content":"Svn"}]},{"type":"heading","depth":2,"payload":{"lines":[93,94]},"content":"依赖管理","children":[{"type":"heading","depth":3,"payload":{"lines":[94,95]},"content":"Npm"},{"type":"heading","depth":3,"payload":{"lines":[95,96]},"content":"Cnpm"},{"type":"heading","depth":3,"payload":{"lines":[96,97]},"content":"Yarn"}]},{"type":"heading","depth":2,"payload":{"lines":[97,98]},"content":"Node","children":[{"type":"heading","depth":3,"payload":{"lines":[98,99]},"content":"Express"},{"type":"heading","depth":3,"payload":{"lines":[99,100]},"content":"Koa/Koa2"},{"type":"heading","depth":3,"payload":{"lines":[100,101]},"content":"Egg"}]},{"type":"heading","depth":2,"payload":{"lines":[101,102]},"content":"语言增强","children":[{"type":"heading","depth":3,"payload":{"lines":[102,103]},"content":"css增强器","children":[{"type":"heading","depth":4,"payload":{"lines":[103,104]},"content":"less"},{"type":"heading","depth":4,"payload":{"lines":[104,105]},"content":"postcss"},{"type":"heading","depth":4,"payload":{"lines":[105,106]},"content":"sass"},{"type":"heading","depth":4,"payload":{"lines":[106,107]},"content":"stylus"}]},{"type":"heading","depth":3,"payload":{"lines":[107,108]},"content":"JavaScript增强器","children":[{"type":"heading","depth":4,"payload":{"lines":[108,109]},"content":"TypeScript"},{"type":"heading","depth":4,"payload":{"lines":[109,110]},"content":"CoffeeScript"},{"type":"heading","depth":4,"payload":{"lines":[110,111]},"content":"Flow"}]}]},{"type":"heading","depth":2,"payload":{"lines":[111,112]},"content":"构建/打包工具","children":[{"type":"heading","depth":3,"payload":{"lines":[112,113]},"content":"WebPack"},{"type":"heading","depth":3,"payload":{"lines":[113,114]},"content":"Gulp"},{"type":"heading","depth":3,"payload":{"lines":[114,115]},"content":"Grunt"},{"type":"heading","depth":3,"payload":{"lines":[115,116]},"content":"Rollup"}]},{"type":"heading","depth":2,"payload":{"lines":[116,117]},"content":"转换器","children":[{"type":"heading","depth":3,"payload":{"lines":[117,118]},"content":"Bable"}]},{"type":"heading","depth":2,"payload":{"lines":[118,119]},"content":"CI/CD","children":[{"type":"heading","depth":3,"payload":{"lines":[119,120]},"content":"Git Web hook"},{"type":"heading","depth":3,"payload":{"lines":[120,121]},"content":"Jenkins"}]},{"type":"heading","depth":2,"payload":{"lines":[121,122]},"content":"代码质量","children":[{"type":"heading","depth":3,"payload":{"lines":[122,123]},"content":"质量检测","children":[{"type":"heading","depth":4,"payload":{"lines":[123,124]},"content":"StyleLint"},{"type":"heading","depth":4,"payload":{"lines":[124,125]},"content":"JSLint/TSLint/ESLint"}]},{"type":"heading","depth":3,"payload":{"lines":[125,126]},"content":"单元测试","children":[{"type":"heading","depth":4,"payload":{"lines":[126,127]},"content":"Expect"},{"type":"heading","depth":4,"payload":{"lines":[127,128]},"content":"Jest"}]},{"type":"heading","depth":3,"payload":{"lines":[128,129]},"content":"E2E测试","children":[{"type":"heading","depth":4,"payload":{"lines":[129,130]},"content":"NightWatch"}]}]}]},{"type":"heading","depth":1,"payload":{"lines":[131,132]},"content":"知识进阶","children":[{"type":"heading","depth":2,"payload":{"lines":[132,133]},"content":"网络通信","children":[{"type":"heading","depth":3,"payload":{"lines":[133,134]},"content":"通讯协议","children":[{"type":"heading","depth":4,"payload":{"lines":[134,135]},"content":"HTTP和HTTPS"},{"type":"heading","depth":4,"payload":{"lines":[135,136]},"content":"UDP"},{"type":"heading","depth":4,"payload":{"lines":[136,137]},"content":"WebSocket"}]}]},{"type":"heading","depth":2,"payload":{"lines":[137,138]},"content":"性能","children":[{"type":"heading","depth":3,"payload":{"lines":[138,139]},"content":"性能优化","children":[{"type":"heading","depth":4,"payload":{"lines":[139,140]},"content":"首次绘制（FP）"},{"type":"heading","depth":4,"payload":{"lines":[140,141]},"content":"首次内容绘制（FCP）"},{"type":"heading","depth":4,"payload":{"lines":[141,142]},"content":"首次有效绘制（FMP）"},{"type":"heading","depth":4,"payload":{"lines":[142,143]},"content":"每秒传输帧数（FPS）"},{"type":"heading","depth":4,"payload":{"lines":[143,144]},"content":"用户可交互时间"},{"type":"heading","depth":4,"payload":{"lines":[144,145]},"content":"DNS解析时间"},{"type":"heading","depth":4,"payload":{"lines":[145,146]},"content":"TCP连接时间"},{"type":"heading","depth":4,"payload":{"lines":[146,147]},"content":"HTTP请求响应时间"}]},{"type":"heading","depth":3,"payload":{"lines":[147,148]},"content":"评估工具","children":[{"type":"heading","depth":4,"payload":{"lines":[148,149]},"content":"Page Speed"},{"type":"heading","depth":4,"payload":{"lines":[149,150]},"content":"Chrome dev tools"}]}]},{"type":"heading","depth":2,"payload":{"lines":[150,151]},"content":"安全","children":[{"type":"heading","depth":3,"payload":{"lines":[151,152]},"content":"XSS"},{"type":"heading","depth":3,"payload":{"lines":[152,153]},"content":"CSP"},{"type":"heading","depth":3,"payload":{"lines":[153,154]},"content":"CSRF"}]},{"type":"heading","depth":2,"payload":{"lines":[154,155]},"content":"浏览器","children":[{"type":"heading","depth":3,"payload":{"lines":[155,156]},"content":"IE0/11/Edge"},{"type":"heading","depth":3,"payload":{"lines":[156,157]},"content":"FireFox"},{"type":"heading","depth":3,"payload":{"lines":[157,158]},"content":"Chrome"},{"type":"heading","depth":3,"payload":{"lines":[158,159]},"content":"Safari"},{"type":"heading","depth":3,"payload":{"lines":[159,160]},"content":"Opera"}]},{"type":"heading","depth":2,"payload":{"lines":[160,161]},"content":"编程思维","children":[{"type":"heading","depth":3,"payload":{"lines":[161,162]},"content":"Script"},{"type":"heading","depth":3,"payload":{"lines":[162,163]},"content":"Code Blocks"},{"type":"heading","depth":3,"payload":{"lines":[163,164]},"content":"Code Behind"},{"type":"heading","depth":3,"payload":{"lines":[164,165]},"content":"MVC"},{"type":"heading","depth":3,"payload":{"lines":[165,166]},"content":"MVP"},{"type":"heading","depth":3,"payload":{"lines":[166,167]},"content":"MVVM"},{"type":"heading","depth":3,"payload":{"lines":[167,168]},"content":"Flux"}]}]},{"type":"heading","depth":1,"payload":{"lines":[168,169]},"content":"领域分支","children":[{"type":"heading","depth":2,"payload":{"lines":[169,170]},"content":"可视化","children":[{"type":"heading","depth":3,"payload":{"lines":[170,171]},"content":"SVG"},{"type":"heading","depth":3,"payload":{"lines":[171,172]},"content":"Canvas 2D"},{"type":"heading","depth":3,"payload":{"lines":[172,173]},"content":"WebGL"}]},{"type":"heading","depth":2,"payload":{"lines":[173,174]},"content":"移动web","children":[{"type":"heading","depth":3,"payload":{"lines":[174,175]},"content":"WebView"},{"type":"heading","depth":3,"payload":{"lines":[175,176]},"content":"Web to Native"},{"type":"heading","depth":3,"payload":{"lines":[176,177]},"content":"小程序"},{"type":"heading","depth":3,"payload":{"lines":[177,178]},"content":"响应式网页设计"}]},{"type":"heading","depth":2,"payload":{"lines":[178,179]},"content":"游戏开发","children":[{"type":"heading","depth":3,"payload":{"lines":[179,180]},"content":"Cocos 2d"},{"type":"heading","depth":3,"payload":{"lines":[180,181]},"content":"Egret Engine"}]}]},{"type":"heading","depth":1,"payload":{"lines":[182,183]},"content":"数据管理","children":[{"type":"heading","depth":2,"payload":{"lines":[183,184]},"content":"web服务器","children":[{"type":"heading","depth":3,"payload":{"lines":[184,185]},"content":"Nginx"},{"type":"heading","depth":3,"payload":{"lines":[185,186]},"content":"Apache"},{"type":"heading","depth":3,"payload":{"lines":[186,187]},"content":"Tomact"}]},{"type":"heading","depth":2,"payload":{"lines":[187,188]},"content":"数据库","children":[{"type":"heading","depth":3,"payload":{"lines":[188,189]},"content":"SQL"},{"type":"heading","depth":3,"payload":{"lines":[189,190]},"content":"NoSQL","children":[{"type":"heading","depth":4,"payload":{"lines":[190,191]},"content":"CouchDB"},{"type":"heading","depth":4,"payload":{"lines":[191,192]},"content":"Hbase"}]}]},{"type":"heading","depth":2,"payload":{"lines":[192,193]},"content":"数据缓存","children":[{"type":"heading","depth":3,"payload":{"lines":[193,194]},"content":"Redis"},{"type":"heading","depth":3,"payload":{"lines":[194,195]},"content":"Memcached"}]}]}]},{})</script></body></html>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="前端学习路线"><a href="#前端学习路线" class="headerlink" title="前端学习路线"></a>前端学习路线</h1><h2 id="通用基础"><a href="#通用基础" class="headerlink" title="通用基础"></a>通用基础</h2><h3 id="编译原理"><a href="#编译原理" class="headerlink" title="编译原理"></a>编译原理</h3><h3 id="计算机网络"><a href="#计算机网络" class="headerlink" title="计算机网络"></a>计算机网络</h3><h3 id="操作系统"><a href="#操作系统" class="headerlink" title="操作系统"></a>操作系统</h3><h3 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h3><h3 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h3><h3 id="设计模式"><a href="#设计模式" class="headerlink" title="设计模式"></a>设计模式</h3><h2 id="前端基础"><a href="#前端基础" class="headerlink" title="前端基础"></a>前端基础</h2><h3 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h3><h4 id="元素"><a href="#元素" class="headerlink" title="元素"></a>元素</h4><h4 id="DOM"><a href="#DOM" class="headerlink" title="DOM"></a>DOM</h4><h4 id="语义化"><a href="#语义化" class="headerlink" title="语义化"></a>语义化</h4><h4 id="html5标签"><a href="#html5标签" class="headerlink" title="html5标签"></a>html5标签</h4><h4 id="SEO搜索优化"><a href="#SEO搜索优化" class="headerlink" title="SEO搜索优化"></a>SEO搜索优化</h4><h3 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h3><h4 id="选择器"><a href="#选择器" class="headerlink" title="选择器"></a>选择器</h4><h4 id="布局"><a href="#布局" class="headerlink" title="布局"></a>布局</h4><h5 id="经典布局（盒模型）"><a href="#经典布局（盒模型）" class="headerlink" title="经典布局（盒模型）"></a>经典布局（盒模型）</h5><h5 id="flex"><a href="#flex" class="headerlink" title="flex"></a>flex</h5><h5 id="grid"><a href="#grid" class="headerlink" title="grid"></a>grid</h5><h5 id="table"><a href="#table" class="headerlink" title="table"></a>table</h5><h4 id="交互"><a href="#交互" class="headerlink" title="交互"></a>交互</h4><h5 id="动画"><a href="#动画" class="headerlink" title="动画"></a>动画</h5><h4 id="响应式设计"><a href="#响应式设计" class="headerlink" title="响应式设计"></a>响应式设计</h4><h4 id="CSS3特性"><a href="#CSS3特性" class="headerlink" title="CSS3特性"></a>CSS3特性</h4><h4 id="CSS框架"><a href="#CSS框架" class="headerlink" title="CSS框架"></a>CSS框架</h4><h3 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h3><h4 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h4><h4 id="原型及原型链"><a href="#原型及原型链" class="headerlink" title="原型及原型链"></a>原型及原型链</h4><h4 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h4><h4 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h4><h4 id="异步"><a href="#异步" class="headerlink" title="异步"></a>异步</h4><h4 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h4><h5 id="事件循环"><a href="#事件循环" class="headerlink" title="事件循环"></a>事件循环</h5><h5 id="事件队列"><a href="#事件队列" class="headerlink" title="事件队列"></a>事件队列</h5><h5 id="事件代理-x2F-委托"><a href="#事件代理-x2F-委托" class="headerlink" title="事件代理&#x2F;委托"></a>事件代理&#x2F;委托</h5><h4 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h4><h2 id="开发软件补充"><a href="#开发软件补充" class="headerlink" title="开发软件补充"></a>开发软件补充</h2><h3 id="编辑器和IDE"><a href="#编辑器和IDE" class="headerlink" title="编辑器和IDE"></a>编辑器和IDE</h3><h4 id="Sublime-Text3"><a href="#Sublime-Text3" class="headerlink" title="Sublime Text3"></a>Sublime Text3</h4><h4 id="Visual-Studio-Code"><a href="#Visual-Studio-Code" class="headerlink" title="Visual Studio Code"></a>Visual Studio Code</h4><h4 id="WebStorm"><a href="#WebStorm" class="headerlink" title="WebStorm"></a>WebStorm</h4><h3 id="测试工具"><a href="#测试工具" class="headerlink" title="测试工具"></a>测试工具</h3><h4 id="Chrome-Dev-Tools"><a href="#Chrome-Dev-Tools" class="headerlink" title="Chrome Dev Tools"></a>Chrome Dev Tools</h4><h4 id="PostMan"><a href="#PostMan" class="headerlink" title="PostMan"></a>PostMan</h4><h4 id="Firebug"><a href="#Firebug" class="headerlink" title="Firebug"></a>Firebug</h4><h3 id="切图"><a href="#切图" class="headerlink" title="切图"></a>切图</h3><h4 id="Sketch"><a href="#Sketch" class="headerlink" title="Sketch"></a>Sketch</h4><h4 id="PhotoShop"><a href="#PhotoShop" class="headerlink" title="PhotoShop"></a>PhotoShop</h4><h4 id="PxCook"><a href="#PxCook" class="headerlink" title="PxCook"></a>PxCook</h4><h3 id="交互-1"><a href="#交互-1" class="headerlink" title="交互"></a>交互</h3><h4 id="Axure"><a href="#Axure" class="headerlink" title="Axure"></a>Axure</h4><h2 id="类库框架"><a href="#类库框架" class="headerlink" title="类库框架"></a>类库框架</h2><h3 id="工具类"><a href="#工具类" class="headerlink" title="工具类"></a>工具类</h3><h4 id="jQuery"><a href="#jQuery" class="headerlink" title="jQuery"></a>jQuery</h4><h4 id="Bootstrap"><a href="#Bootstrap" class="headerlink" title="Bootstrap"></a>Bootstrap</h4><h4 id="Zepto"><a href="#Zepto" class="headerlink" title="Zepto"></a>Zepto</h4><h4 id="lodash"><a href="#lodash" class="headerlink" title="lodash"></a>lodash</h4><h3 id="开发库-x2F-框架"><a href="#开发库-x2F-框架" class="headerlink" title="开发库&#x2F;框架"></a>开发库&#x2F;框架</h3><h4 id="vue"><a href="#vue" class="headerlink" title="vue"></a>vue</h4><h5 id="Vuex"><a href="#Vuex" class="headerlink" title="Vuex*"></a>Vuex*</h5><h5 id="Vue-router"><a href="#Vue-router" class="headerlink" title="Vue-router*"></a>Vue-router*</h5><h5 id="Vue-cli"><a href="#Vue-cli" class="headerlink" title="Vue-cli*"></a>Vue-cli*</h5><h5 id="Element-Ui"><a href="#Element-Ui" class="headerlink" title="Element Ui"></a>Element Ui</h5><h5 id="Nuxt"><a href="#Nuxt" class="headerlink" title="Nuxt"></a>Nuxt</h5><h5 id="Vue3"><a href="#Vue3" class="headerlink" title="Vue3*"></a>Vue3*</h5><h6 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h6><h6 id="vue-components-api"><a href="#vue-components-api" class="headerlink" title="vue-components-api"></a>vue-components-api</h6><h4 id="React"><a href="#React" class="headerlink" title="React"></a>React</h4><h5 id="Redux"><a href="#Redux" class="headerlink" title="Redux*"></a>Redux*</h5><h5 id="React-router"><a href="#React-router" class="headerlink" title="React-router*"></a>React-router*</h5><h5 id="creat-react-app"><a href="#creat-react-app" class="headerlink" title="creat-react-app*"></a>creat-react-app*</h5><h5 id="Ant-Design"><a href="#Ant-Design" class="headerlink" title="Ant Design"></a>Ant Design</h5><h5 id="Next"><a href="#Next" class="headerlink" title="Next"></a>Next</h5><h4 id="Anguler"><a href="#Anguler" class="headerlink" title="Anguler"></a>Anguler</h4><h4 id="Backbone"><a href="#Backbone" class="headerlink" title="Backbone"></a>Backbone</h4><h4 id="Knockout"><a href="#Knockout" class="headerlink" title="Knockout"></a>Knockout</h4><h2 id="工程开发"><a href="#工程开发" class="headerlink" title="工程开发"></a>工程开发</h2><h3 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h3><h4 id="ES6-Module"><a href="#ES6-Module" class="headerlink" title="ES6 Module"></a>ES6 Module</h4><h4 id="Common-JS"><a href="#Common-JS" class="headerlink" title="Common JS"></a>Common JS</h4><h4 id="SeaJs-x2F-CMD"><a href="#SeaJs-x2F-CMD" class="headerlink" title="SeaJs&#x2F;CMD"></a>SeaJs&#x2F;CMD</h4><h4 id="RequireJS-x2F-AMD"><a href="#RequireJS-x2F-AMD" class="headerlink" title="RequireJS&#x2F;AMD"></a>RequireJS&#x2F;AMD</h4><h3 id="版本管理"><a href="#版本管理" class="headerlink" title="版本管理"></a>版本管理</h3><h4 id="Git"><a href="#Git" class="headerlink" title="Git"></a>Git</h4><h5 id="GitLab"><a href="#GitLab" class="headerlink" title="GitLab"></a>GitLab</h5><h5 id="Github"><a href="#Github" class="headerlink" title="Github"></a>Github</h5><h4 id="Svn"><a href="#Svn" class="headerlink" title="Svn"></a>Svn</h4><h3 id="依赖管理"><a href="#依赖管理" class="headerlink" title="依赖管理"></a>依赖管理</h3><h4 id="Npm"><a href="#Npm" class="headerlink" title="Npm"></a>Npm</h4><h4 id="Cnpm"><a href="#Cnpm" class="headerlink" title="Cnpm"></a>Cnpm</h4><h4 id="Yarn"><a href="#Yarn" class="headerlink" title="Yarn"></a>Yarn</h4><h3 id="Node"><a href="#Node" class="headerlink" title="Node"></a>Node</h3><h4 id="Express"><a href="#Express" class="headerlink" title="Express"></a>Express</h4><h4 id="Koa-x2F-Koa2"><a href="#Koa-x2F-Koa2" class="headerlink" title="Koa&#x2F;Koa2"></a>Koa&#x2F;Koa2</h4><h4 id="Egg"><a href="#Egg" class="headerlink" title="Egg"></a>Egg</h4><h3 id="语言增强"><a href="#语言增强" class="headerlink" title="语言增强"></a>语言增强</h3><h4 id="css增强器"><a href="#css增强器" class="headerlink" title="css增强器"></a>css增强器</h4><h5 id="less"><a href="#less" class="headerlink" title="less"></a>less</h5><h5 id="postcss"><a href="#postcss" class="headerlink" title="postcss"></a>postcss</h5><h5 id="sass"><a href="#sass" class="headerlink" title="sass"></a>sass</h5><h5 id="stylus"><a href="#stylus" class="headerlink" title="stylus"></a>stylus</h5><h4 id="JavaScript增强器"><a href="#JavaScript增强器" class="headerlink" title="JavaScript增强器"></a>JavaScript增强器</h4><h5 id="TypeScript"><a href="#TypeScript" class="headerlink" title="TypeScript"></a>TypeScript</h5><h5 id="CoffeeScript"><a href="#CoffeeScript" class="headerlink" title="CoffeeScript"></a>CoffeeScript</h5><h5 id="Flow"><a href="#Flow" class="headerlink" title="Flow"></a>Flow</h5><h3 id="构建-x2F-打包工具"><a href="#构建-x2F-打包工具" class="headerlink" title="构建&#x2F;打包工具"></a>构建&#x2F;打包工具</h3><h4 id="WebPack"><a href="#WebPack" class="headerlink" title="WebPack"></a>WebPack</h4><h4 id="Gulp"><a href="#Gulp" class="headerlink" title="Gulp"></a>Gulp</h4><h4 id="Grunt"><a href="#Grunt" class="headerlink" title="Grunt"></a>Grunt</h4><h4 id="Rollup"><a href="#Rollup" class="headerlink" title="Rollup"></a>Rollup</h4><h3 id="转换器"><a href="#转换器" class="headerlink" title="转换器"></a>转换器</h3><h4 id="Bable"><a href="#Bable" class="headerlink" title="Bable"></a>Bable</h4><h3 id="CI-x2F-CD"><a href="#CI-x2F-CD" class="headerlink" title="CI&#x2F;CD"></a>CI&#x2F;CD</h3><h4 id="Git-Web-hook"><a href="#Git-Web-hook" class="headerlink" title="Git Web hook"></a>Git Web hook</h4><h4 id="Jenkins"><a href="#Jenkins" class="headerlink" title="Jenkins"></a>Jenkins</h4><h3 id="代码质量"><a href="#代码质量" class="headerlink" title="代码质量"></a>代码质量</h3><h4 id="质量检测"><a href="#质量检测" class="headerlink" title="质量检测"></a>质量检测</h4><h5 id="StyleLint"><a href="#StyleLint" class="headerlink" title="StyleLint"></a>StyleLint</h5><h5 id="JSLint-x2F-TSLint-x2F-ESLint"><a href="#JSLint-x2F-TSLint-x2F-ESLint" class="headerlink" title="JSLint&#x2F;TSLint&#x2F;ESLint"></a>JSLint&#x2F;TSLint&#x2F;ESLint</h5><h4 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h4><h5 id="Expect"><a href="#Expect" class="headerlink" title="Expect"></a>Expect</h5><h5 id="Jest"><a href="#Jest" class="headerlink" title="Jest"></a>Jest</h5><h4 id="E2E测试"><a href="#E2E测试" class="headerlink" title="E2E测试"></a>E2E测试</h4><h5 id="NightWatch"><a href="#NightWatch" class="headerlink" title="NightWatch"></a>NightWatch</h5><h2 id="知识进阶"><a href="#知识进阶" class="headerlink" title="知识进阶"></a>知识进阶</h2><h3 id="网络通信"><a href="#网络通信" class="headerlink" title="网络通信"></a>网络通信</h3><h4 id="通讯协议"><a href="#通讯协议" class="headerlink" title="通讯协议"></a>通讯协议</h4><h5 id="HTTP和HTTPS"><a href="#HTTP和HTTPS" class="headerlink" title="HTTP和HTTPS"></a>HTTP和HTTPS</h5><h5 id="UDP"><a href="#UDP" class="headerlink" title="UDP"></a>UDP</h5><h5 id="WebSocket"><a href="#WebSocket" class="headerlink" title="WebSocket"></a>WebSocket</h5><h3 id="性能"><a href="#性能" class="headerlink" title="性能"></a>性能</h3><h4 id="性能优化"><a href="#性能优化" class="headerlink" title="性能优化"></a>性能优化</h4><h5 id="首次绘制（FP）"><a href="#首次绘制（FP）" class="headerlink" title="首次绘制（FP）"></a>首次绘制（FP）</h5><h5 id="首次内容绘制（FCP）"><a href="#首次内容绘制（FCP）" class="headerlink" title="首次内容绘制（FCP）"></a>首次内容绘制（FCP）</h5><h5 id="首次有效绘制（FMP）"><a href="#首次有效绘制（FMP）" class="headerlink" title="首次有效绘制（FMP）"></a>首次有效绘制（FMP）</h5><h5 id="每秒传输帧数（FPS）"><a href="#每秒传输帧数（FPS）" class="headerlink" title="每秒传输帧数（FPS）"></a>每秒传输帧数（FPS）</h5><h5 id="用户可交互时间"><a href="#用户可交互时间" class="headerlink" title="用户可交互时间"></a>用户可交互时间</h5><h5 id="DNS解析时间"><a href="#DNS解析时间" class="headerlink" title="DNS解析时间"></a>DNS解析时间</h5><h5 id="TCP连接时间"><a href="#TCP连接时间" class="headerlink" title="TCP连接时间"></a>TCP连接时间</h5><h5 id="HTTP请求响应时间"><a href="#HTTP请求响应时间" class="headerlink" title="HTTP请求响应时间"></a>HTTP请求响应时间</h5><h4 id="评估工具"><a href="#评估工具" class="headerlink" title="评估工具"></a>评估工具</h4><h5 id="Page-Speed"><a href="#Page-Speed" class="headerlink" title="Page Speed"></a>Page Speed</h5><h5 id="Chrome-dev-tools"><a href="#Chrome-dev-tools" class="headerlink" title="Chrome dev tools"></a>Chrome dev tools</h5><h3 id="安全"><a href="#安全" class="headerlink" title="安全"></a>安全</h3><h4 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h4><h4 id="CSP"><a href="#CSP" class="headerlink" title="CSP"></a>CSP</h4><h4 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h4><h3 id="浏览器"><a href="#浏览器" class="headerlink" title="浏览器"></a>浏览器</h3><h4 id="IE0-x2F-11-x2F-Edge"><a href="#IE0-x2F-11-x2F-Edge" class="headerlink" title="IE0&#x2F;11&#x2F;Edge"></a>IE0&#x2F;11&#x2F;Edge</h4><h4 id="FireFox"><a href="#FireFox" class="headerlink" title="FireFox"></a>FireFox</h4><h4 id="Chrome"><a href="#Chrome" class="headerlink" title="Chrome"></a>Chrome</h4><h4 id="Safari"><a href="#Safari" class="headerlink" title="Safari"></a>Safari</h4><h4 id="Opera"><a href="#Opera" class="headerlink" title="Opera"></a>Opera</h4><h3 id="编程思维"><a href="#编程思维" class="headerlink" title="编程思维"></a>编程思维</h3><h4 id="Script"><a href="#Script" class="headerlink" title="Script"></a>Script</h4><h4 id="Code-Blocks"><a href="#Code-Blocks" class="headerlink" title="Code Blocks"></a>Code Blocks</h4><h4 id="Code-Behind"><a href="#Code-Behind" class="headerlink" title="Code Behind"></a>Code Behind</h4><h4 id="MVC"><a href="#MVC" class="headerlink" title="MVC"></a>MVC</h4><h4 id="MVP"><a href="#MVP" class="headerlink" title="MVP"></a>MVP</h4><h4 id="MVVM"><a href="#MVVM" class="headerlink" title="MVVM"></a>MVVM</h4><h4 id="Flux"><a href="#Flux" class="headerlink" title="Flux"></a>Flux</h4><h2 id="领域分支"><a href="#领域分支" class="headerlink" title="领域分支"></a>领域分支</h2><h3 id="可视化"><a href="#可视化" class="headerlink" title="可视化"></a>可视化</h3><h4 id="SVG"><a href="#SVG" class="headerlink" title="SVG"></a>SVG</h4><h4 id="Canvas-2D"><a href="#Canvas-2D" class="headerlink" title="Canvas 2D"></a>Canvas 2D</h4><h4 id="WebGL"><a href="#WebGL" class="headerlink" title="WebGL"></a>WebGL</h4><h3 id="移动web"><a href="#移动web" class="headerlink" title="移动web"></a>移动web</h3><h4 id="WebView"><a href="#WebView" class="headerlink" title="WebView"></a>WebView</h4><h4 id="Web-to-Native"><a href="#Web-to-Native" class="headerlink" title="Web to Native"></a>Web to Native</h4><h4 id="小程序"><a href="#小程序" class="headerlink" title="小程序"></a>小程序</h4><h4 id="响应式网页设计"><a href="#响应式网页设计" class="headerlink" title="响应式网页设计"></a>响应式网页设计</h4><h3 id="游戏开发"><a href="#游戏开发" class="headerlink" title="游戏开发"></a>游戏开发</h3><h4 id="Cocos-2d"><a href="#Cocos-2d" class="headerlink" title="Cocos 2d"></a>Cocos 2d</h4><h4 id="Egret-Engine"><a href="#Egret-Engine" class="headerlink" title="Egret Engine"></a>Egret Engine</h4><h2 id="数据管理"><a href="#数据管理" class="headerlink" title="数据管理"></a>数据管理</h2><h3 id="web服务器"><a href="#web服务器" class="headerlink" title="web服务器"></a>web服务器</h3><h4 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h4><h4 id="Apache"><a href="#Apache" class="headerlink" title="Apache"></a>Apache</h4><h4 id="Tomact"><a href="#Tomact" class="headerlink" title="Tomact"></a>Tomact</h4><h3 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h3><h4 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h4><h4 id="NoSQL"><a href="#NoSQL" class="headerlink" title="NoSQL"></a>NoSQL</h4><h5 id="CouchDB"><a href="#CouchDB" class="headerlink" title="CouchDB"></a>CouchDB</h5><h5 id="Hbase"><a href="#Hbase" class="headerlink" title="Hbase"></a>Hbase</h5><h3 id="数据缓存"><a href="#数据缓存" class="headerlink" title="数据缓存"></a>数据缓存</h3><h4 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h4><h4 id="Memcached"><a href="#Memcached" class="headerlink" title="Memcached"></a>Memcached</h4>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>前端常用免费API接口</title>
      <link href="/posts/fb598a01/"/>
      <url>/posts/fb598a01/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="平台"><a href="#平台" class="headerlink" title="平台"></a>平台</h2><ol><li>阿里云市场：<a href="https://link.juejin.cn/?target=https://market.aliyun.com/data" title="https://market.aliyun.com/data">market.aliyun.com&#x2F;data</a></li><li>聚合数据：<a href="https://link.juejin.cn/?target=https://www.juhe.cn/docs" title="https://www.juhe.cn/docs">www.juhe.cn/docs</a></li><li>阿凡达数据：<a href="https://link.juejin.cn/?target=https://www.avatardata.cn/" title="https://www.avatardata.cn/">www.avatardata.cn/</a></li><li>进制数据：<a href="https://link.juejin.cn/?target=https://www.binstd.com/" title="https://www.binstd.com/">www.binstd.com/</a></li><li>小白开放平台：<a href="https://link.juejin.cn/?target=http://www.yesapi.cn/" title="http://www.yesapi.cn/">www.yesapi.cn/</a></li><li>京东万象：<a href="https://link.juejin.cn/?target=https://wx.jdcloud.com/api" title="https://wx.jdcloud.com/api">wx.jdcloud.com&#x2F;api</a></li><li>神箭手：<a href="https://link.juejin.cn/?target=https://www.shenjianshou.cn" title="https://www.shenjianshou.cn">www.shenjianshou.cn</a></li><li>apishop：<a href="https://link.juejin.cn/?target=https://www.apishop.net" title="https://www.apishop.net">www.apishop.net</a></li><li>iDataAPI：<a href="https://link.juejin.cn/?target=http://www.idataapi.cn" title="http://www.idataapi.cn">www.idataapi.cn</a></li><li>HaoService：<a href="https://link.juejin.cn/?target=http://www.haoservice.com" title="http://www.haoservice.com">www.haoservice.com</a></li></ol><h2 id="天气查询接口"><a href="#天气查询接口" class="headerlink" title="天气查询接口"></a>天气查询接口</h2><ol><li>免费天气api接口：<a href="https://link.juejin.cn/?target=https://www.kancloud.cn/ccjin/yingq/603579" title="https://www.kancloud.cn/ccjin/yingq/603579">www.kancloud.cn/ccjin/yingq…</a></li></ol><h2 id="快递查询接口"><a href="#快递查询接口" class="headerlink" title="快递查询接口"></a>快递查询接口</h2><ol><li>快递100：<a href="https://link.juejin.cn/?target=https://www.kuaidi100.com/openapi/applyapi.shtml" title="https://www.kuaidi100.com/openapi/applyapi.shtml">www.kuaidi100.com/openapi/app…</a></li><li>快递鸟：<a href="https://link.juejin.cn/?target=http://www.kdniao.com/api-all?renqun_youhua=288645" title="http://www.kdniao.com/api-all?renqun_youhua=288645">www.kdniao.com/api-all?ren…</a></li></ol><h2 id="地图接口"><a href="#地图接口" class="headerlink" title="地图接口"></a>地图接口</h2><ol><li>高德地图 <a href="https://link.juejin.cn/?target=https://lbs.amap.com" title="https://lbs.amap.com">lbs.amap.com</a></li><li>百度地图 <a href="https://link.juejin.cn/?target=http://lbsyun.baidu.com" title="http://lbsyun.baidu.com">lbsyun.baidu.com</a></li><li>腾讯地图 <a href="https://link.juejin.cn/?target=https://lbs.qq.com" title="https://lbs.qq.com">lbs.qq.com</a></li><li>搜狗地图 <a href="https://link.juejin.cn/?target=http://map.sogou.com/api" title="http://map.sogou.com/api">map.sogou.com&#x2F;api</a></li></ol><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><ol><li>JSON API免费接口  <a href="https://link.juejin.cn/?target=http://www.bejson.com/knownjson/webInterface/" title="http://www.bejson.com/knownjson/webInterface/">www.bejson.com/knownjson/w…</a></li><li>免费开放接口（美图获取等）  <a href="https://link.juejin.cn/?target=https://www.jianshu.com/p/e6f072839282" title="https://www.jianshu.com/p/e6f072839282">www.jianshu.com/p/e6f072839…</a></li><li>免费API接口汇总（不定时更新）：  <a href="https://link.juejin.cn/?target=https://segmentfault.com/a/1190000017047048" title="https://segmentfault.com/a/1190000017047048">segmentfault.com&#x2F;a&#x2F;119000001…</a></li><li>免费第三方API平台整合  <a href="https://link.juejin.cn/?target=https://www.cnblogs.com/liuying1995/p/6723185.html" title="https://www.cnblogs.com/liuying1995/p/6723185.html">www.cnblogs.com/liuying1995…</a></li><li>分享一些开放的免费的API接口  <a href="https://link.juejin.cn/?target=https://blog.csdn.net/huxinrun/article/details/84788763" title="https://blog.csdn.net/huxinrun/article/details/84788763">blog.csdn.net&#x2F;huxinrun&#x2F;ar…</a></li><li>各大平台的免费api接口  <a href="https://link.juejin.cn/?target=https://blog.csdn.net/qq_36570464/article/details/82561056" title="https://blog.csdn.net/qq_36570464/article/details/82561056">blog.csdn.net&#x2F;qq_36570464…</a></li><li>收集的免费API接口  <a href="https://link.juejin.cn/?target=https://www.cnblogs.com/chen0307/p/9634848.html" title="https://www.cnblogs.com/chen0307/p/9634848.html">www.cnblogs.com/chen0307/p/…</a></li><li>免费实用的 API 接口  <a href="https://link.juejin.cn/?target=https://www.jianshu.com/p/12c2fb8cab66" title="https://www.jianshu.com/p/12c2fb8cab66">www.jianshu.com/p/12c2fb8ca…</a></li><li>以前整理的网络上免费API接口  <a href="https://link.juejin.cn/?target=https://www.cnblogs.com/annie00/p/5852873.html" title="https://www.cnblogs.com/annie00/p/5852873.html">www.cnblogs.com/annie00/p/5…</a></li><li>免费开放API接口  <a href="https://link.juejin.cn/?target=https://blog.csdn.net/weixin_42330073/article/details/86541973" title="https://blog.csdn.net/weixin_42330073/article/details/86541973">blog.csdn.net&#x2F;weixin_4233…</a></li><li>整理搜集免费的API接口网址  <a href="https://link.juejin.cn/?target=https://blog.csdn.net/lhjuejiang/article/details/80684366" title="https://blog.csdn.net/lhjuejiang/article/details/80684366">blog.csdn.net&#x2F;lhjuejiang&#x2F;…</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 高阶对象 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> API </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript - 继承</title>
      <link href="/posts/388b3727/"/>
      <url>/posts/388b3727/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>详细内容可参考：<a href="https://link.juejin.cn/?target=http://cavszhouyou.top/JavaScript%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E4%B9%8B%E7%BB%A7%E6%89%BF.html" title="http://cavszhouyou.top/JavaScript%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E4%B9%8B%E7%BB%A7%E6%89%BF.html">《JavaScript 深入理解之继承》</a></p><h2 id="this、call、apply、bind"><a href="#this、call、apply、bind" class="headerlink" title="this、call、apply、bind"></a>this、call、apply、bind</h2><p>详情可看：<a href="https://juejin.cn/post/6844904009308831751" title="https://juejin.cn/post/6844904009308831751">「前端料包」一文彻底搞懂JavaScript中的this、call、apply和bind</a></p><ol><li>在浏览器里，在全局范围内this指向window对象</li><li>在函数中，this永远指向最后调用他的那个对象</li><li>构造函数中，this指向new出来的那个新的对象</li><li>call、apply、bind中的this被强绑定在指定的那个对象上</li><li>箭头函数中this比较特殊，箭头函数this为父作用域的this，不是调用时的this。要知道前四种方式，都是调用时确定，也就是动态的，而箭头函数的this指向是静态的，声明的时候就确定了下来</li><li>apply、call、bind都是js给函数内置的一些API，调用他们可以为函数指定this的执行，同时也可以传参</li></ol><h2 id="手写call、apply及bind函数"><a href="#手写call、apply及bind函数" class="headerlink" title="手写call、apply及bind函数"></a>手写call、apply及bind函数</h2><a href="/posts/5d04ce7e/" title="执行上下文this指向">执行上下文this指向</a><h2 id="JavaScript原型及原型链"><a href="#JavaScript原型及原型链" class="headerlink" title="JavaScript原型及原型链"></a>JavaScript原型及原型链</h2><p>重温一下构造函数、原型和实例的关系：</p><p>每个构造函数都有一个原型对象，原型有一个属性指回构造函数，而实例有一个内部指针指向原型。<br>如下图：<br><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/324d603fd6ea4bfdb53c26ef6780ca43~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="原型.png"></p><ul><li>Person 就是一个构造函数</li><li>Person Prototype 就是原型对象</li><li>person1, person2就是两个实例</li></ul><p>如果原型是另一个类型的实例呢？那就意味着这个原型本身有一个内部指针指向另一个原型，相应地另一个原型也有一个指针指向另一个构造函数。这样就在实例和原型之间构造了一条原型链。这就是原型链的基本构想。</p><p>在js中我们是使用构造函数来新建一个对象的，每一个构造函数的内部都有一个prototype属性值，这个属性值是一个对象，这个对象包含了可以由该构造函数的所有实例共享的属性和方法。<br>当我们使用构造函数新建一个对象后，在这个对象的内部将包含一个指针proto，这个指针指向构造函数的prototype属性对应的值，在ES5中这个指针被称为对象的原型。一般来说我们是不应该能够获取到这个值的，但是现在浏览器中都实现了proto属性来让我们访问这个属性，但是我们最好不要使用这个属性，因为它不是规范中规定的。ES5中新增了一个Object.getPrototypeOf()方法，我们可以通过这个方法来获取对象的原型。</p><p>当我们访问一个对象的属性时，如果这个对象内部不存在这个属性，那么它就会去它的原型对象里找这个属性，这个原型对象又会有自己的原型，于是就这样一直找下去，也就是原型链的概念。原型链的尽头一般来说都是Object.prototype所以这就是我们新建的对象为什么能够使用toString()等方法的原因。</p><p>原型链:每个对象有一个 <code>__proto__</code>属性，表示自己的原型，每个对象的原型 都指向 该对象的原型对象 prototype，而每个对象的 <code>__proto__.constructor</code> 都指向该对象构造函数的实例，当我们查找的时候，会先沿着自身的属性去查找，找不到去原型上去查找，如果依然没有，则前往该对象上的原型对象进行查找，最终返回结果，如果没有，则返回 null</p><p>特点：<br>JavaScript 对象是通过引用来传递的，我们创建的每个新对象实体中并没有一份属于自己的原型副本。当我们修改原型时，与 之相关的对象也会继承这一改变。</p><p>参考文章：<a href="http://cavszhouyou.top/JavaScript%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E4%B9%8B%E5%8E%9F%E5%9E%8B%E4%B8%8E%E5%8E%9F%E5%9E%8B%E9%93%BE.html">《JavaScript 深入理解之原型与原型链》</a></p><h2 id="js获取原型的方法"><a href="#js获取原型的方法" class="headerlink" title="js获取原型的方法"></a>js获取原型的方法</h2><ol><li><strong>proto</strong></li><li><strong>constructor.prototype</strong></li><li><strong>Object.getPrototypeOf(p)</strong></li></ol><h2 id="七种继承方式"><a href="#七种继承方式" class="headerlink" title="七种继承方式"></a>七种继承方式</h2><h3 id="一、ES6继承"><a href="#一、ES6继承" class="headerlink" title="一、ES6继承"></a>一、ES6继承</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Parent</span> &#123;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Son</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Parent</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span> () &#123;</span><br><span class="line">        <span class="variable language_">super</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="二、原型链继承"><a href="#二、原型链继承" class="headerlink" title="二、原型链继承"></a>二、原型链继承</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">SuperType</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">property</span> = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">SuperType</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getSuperTypeValue</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">property</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">SubType</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">subProperty</span> = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 继承 SuperType</span></span><br><span class="line"><span class="title class_">SubType</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="keyword">new</span> <span class="title class_">SuperType</span>();</span><br><span class="line">  </span><br><span class="line"><span class="title class_">SubType</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getSubValue</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">subProperty</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> instance = <span class="keyword">new</span> <span class="title class_">SubType</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(instance. getSuperTypeValue); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p><strong>缺点</strong></p><ul><li>多个继承的时候，不能对父类进行修改，否则多个子类会共享一个父类实例（因为所有子类的 <code>prototype</code> 都指向的是父类的实例）</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">SuperType</span>(<span class="params"></span>)&#123; </span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">colors</span> = [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;blue&quot;</span>, <span class="string">&quot;green&quot;</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">SubType</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">SubType</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="keyword">new</span> <span class="title class_">SuperType</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> instance1 = <span class="keyword">new</span> <span class="title class_">SubType</span>()</span><br><span class="line">instance1.<span class="property">colors</span>.<span class="title function_">push</span>(<span class="string">&quot;black&quot;</span>)</span><br><span class="line"><span class="title function_">alert</span>(instance1.<span class="property">colors</span>); <span class="comment">//&quot;red, blue, green, black&quot; </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> instance2 = <span class="keyword">new</span> <span class="title class_">SubType</span>(); </span><br><span class="line"><span class="title function_">alert</span>(instance2.<span class="property">colors</span>); <span class="comment">//&quot;red, blue, green, black&quot;</span></span><br></pre></td></tr></table></figure><ul><li>在创建子类型的时候不能向超类型传递参数</li></ul><h3 id="三、借用构造函数继承-经典继承方式"><a href="#三、借用构造函数继承-经典继承方式" class="headerlink" title="三、借用构造函数继承(经典继承方式)"></a>三、借用构造函数继承(经典继承方式)</h3><p>基本思路：在子类构造函数的内部调用父类的构造函数，使用apply() 和 call() 方法以新创建的对象为上下文执行构造函数。</p><p>优点：可以在子类构造函数中向父类构造函数传参</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 借用构造函数继承</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">SuperType</span> () &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">colors</span> = [<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>, <span class="string">&#x27;green&#x27;</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">SubType</span> () &#123;</span><br><span class="line">  <span class="comment">// 通过 call 来继承 SuperType 并传参</span></span><br><span class="line">  <span class="title class_">SuperType</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>);</span><br><span class="line">  <span class="comment">// 添加实例属性</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> instance1 = <span class="keyword">new</span> <span class="title class_">SubType</span>();</span><br><span class="line"><span class="keyword">const</span> instance2 = <span class="keyword">new</span> <span class="title class_">SubType</span>();</span><br><span class="line">instance1.<span class="property">colors</span>.<span class="title function_">push</span>(<span class="string">&#x27;black&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(instance1.<span class="property">colors</span>) <span class="comment">// [&#x27;red&#x27;, &#x27;blue&#x27;, &#x27;green&#x27;, &#x27;black&#x27;]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(instance2.<span class="property">colors</span>) <span class="comment">// [&#x27;red&#x27;, &#x27;blue&#x27;, &#x27;green&#x27;]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>缺点</p><ul><li>子类只能拿到父类自身的属性和方法，无法拿到原型的方法</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">SuperType</span> (name) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">colors</span> = [<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>, <span class="string">&#x27;green&#x27;</span>]</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">run</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;run&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">SuperType</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">test</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;test&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">SubType</span> () &#123;</span><br><span class="line">  <span class="comment">// 通过 call 来继承</span></span><br><span class="line">  <span class="title class_">SuperType</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>, <span class="string">&#x27;test&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> instance1 = <span class="keyword">new</span> <span class="title class_">SubType</span>()</span><br><span class="line"><span class="keyword">const</span> instance2 = <span class="keyword">new</span> <span class="title class_">SubType</span>()</span><br><span class="line">instance1.<span class="property">colors</span>.<span class="title function_">push</span>(<span class="string">&#x27;black&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(instance1.<span class="property">colors</span>, instance1)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(instance2.<span class="property">colors</span>, instance2)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(instance1.<span class="title function_">test</span>()) <span class="comment">// test is not a function</span></span><br></pre></td></tr></table></figure><h3 id="四、组合继承-伪经典继承"><a href="#四、组合继承-伪经典继承" class="headerlink" title="四、组合继承(伪经典继承)"></a>四、组合继承(伪经典继承)</h3><p>基本思路：使用原型链继承原型上的属性和方法；借用构造函数继承实例上的属性。<br>这样，就在原型上实现了原型属性和方法的复用，也能保证每个实例都拥有自己的属性。</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 组合继承</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">SuperType</span> (name) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">colors</span> = [<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>, <span class="string">&#x27;green&#x27;</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">SuperType</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayName</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">SubType</span> (name, age) &#123;</span><br><span class="line">  <span class="comment">// 通过 call 来继承实例属性</span></span><br><span class="line">  <span class="title class_">SuperType</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>, name)</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">继承原型方法</span><br><span class="line"><span class="title class_">SubType</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="keyword">new</span> <span class="title class_">SuperType</span>(); </span><br><span class="line"><span class="title class_">SubType</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> = <span class="title class_">SubType</span>;</span><br><span class="line"><span class="title class_">SubType</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayAge</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">age</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> instance1 = <span class="keyword">new</span> <span class="title class_">SubType</span>(<span class="string">&#x27;father&#x27;</span>, <span class="number">40</span>)</span><br><span class="line">instance1.<span class="property">colors</span>.<span class="title function_">push</span>(<span class="string">&#x27;black&#x27;</span>)</span><br><span class="line">instance1.<span class="title function_">sayName</span>()   <span class="comment">// father</span></span><br><span class="line">instance1.<span class="title function_">sayAge</span>()    <span class="comment">// 40</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> instance2 = <span class="keyword">new</span> <span class="title class_">SubType</span>(<span class="string">&#x27;son&#x27;</span>, <span class="number">27</span>)</span><br><span class="line">instance2.<span class="title function_">sayName</span>()   <span class="comment">// son</span></span><br><span class="line">instance1.<span class="title function_">sayAge</span>()    <span class="comment">// 27</span></span><br></pre></td></tr></table></figure><p>缺点</p><ul><li>由于调用2次父类构造函数，一次是在创建子类型的时候，另一次是在子类构造函数内部，子类会包含父类的全部实例属性，但不得不在调用子类从而重写这些属性</li><li>造成子类型的原型中多了很多不必要的属性</li></ul><h3 id="五、原型式继承"><a href="#五、原型式继承" class="headerlink" title="五、原型式继承"></a>五、原型式继承</h3><p>基本思路：基于已有的对象来创建新的对象<br>实现方式：</p><ul><li>在 <code>object</code> 函数内部，通过创建一个临时的实例，并返回，从而实现继承；</li><li>也可以通过 <code>Object.create()</code> 代替 <code>object</code>函数<ul><li>此方法接收两个参数：<ul><li>作为新对象原型的对象</li><li>给新对象定义额外属性的对象（第二个可选）</li></ul></li></ul></li></ul><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 原型式继承</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">object</span> (obj) &#123;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">F</span> () &#123;&#125;</span><br><span class="line">  F.<span class="property"><span class="keyword">prototype</span></span> = obj</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title function_">F</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> person = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;Nicholas&#x27;</span>,</span><br><span class="line">  <span class="attr">friends</span>: [<span class="string">&#x27;Shelby&#x27;</span>, <span class="string">&#x27;Court&#x27;</span>, <span class="string">&#x27;Van&#x27;</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> anotherPerson = <span class="built_in">object</span>.<span class="title function_">create</span>(person);</span><br><span class="line">anotherPerson.<span class="property">name</span> = <span class="string">&#x27;Greg&#x27;</span></span><br><span class="line">anotherPerson.<span class="property">friends</span>.<span class="title function_">push</span>(<span class="string">&#x27;Rob&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(anotherPerson);           <span class="comment">// &#123; name: &#x27;Greg&#x27; &#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(anotherPerson.<span class="property">friends</span>);   <span class="comment">// [&#x27;Shelby&#x27;, &#x27;Court&#x27;, &#x27;Van&#x27;,&#x27;Rob&#x27;]</span></span><br></pre></td></tr></table></figure><p>缺点</p><ul><li>原型链继承多个实例的引用类型属性指向相同，存在篡改的可能。</li><li>无法传递参数</li></ul><h3 id="六、寄生式继承"><a href="#六、寄生式继承" class="headerlink" title="六、寄生式继承"></a>六、寄生式继承</h3><p>通过创建一个仅用封装继承过程的函数，通过传入一个对象，然后复制一个对象的副本，然后对象进行扩展，最后返回这个对象。</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">createAnother</span> (original) &#123;</span><br><span class="line">    <span class="comment">// 通过调用函数创建一个对象</span></span><br><span class="line">    <span class="keyword">const</span> clone = <span class="title class_">Object</span>.<span class="title function_">create</span>(original);</span><br><span class="line">    <span class="comment">// 添加属性</span></span><br><span class="line">    clone.<span class="property">sayHi</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;hi&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 返回对象</span></span><br><span class="line">    <span class="keyword">return</span> clone;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> person = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;test&#x27;</span>,</span><br><span class="line">    <span class="attr">friends</span>: [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> anotherPerson = <span class="title function_">createAnother</span>(person)</span><br><span class="line">anotherPerson.<span class="title function_">sayHi</span>() <span class="comment">// hi</span></span><br></pre></td></tr></table></figure><p>优点</p><ul><li>如果这个对象不是自定义类型时，就是一个简单对象实现了继承</li></ul><p>缺点</p><ul><li>通过寄生式继承来为对象添加函数，会由于不能做到函数复用，从而降低效率</li></ul><h3 id="七、寄生式组合继承"><a href="#七、寄生式组合继承" class="headerlink" title="七、寄生式组合继承"></a>七、寄生式组合继承</h3><p>寄生组合式继承是通过借用构造函数来继承属性，通过原型链的混合形式来继承方法</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">SuperType</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">SuperType</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayName</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;My name is &quot;</span> + <span class="variable language_">this</span>.<span class="property">name</span> + <span class="string">&quot;.&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">SubType</span>(<span class="params">name, grade</span>) &#123;</span><br><span class="line">  <span class="title class_">SuperType</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>, name);<span class="comment">// 第二次调用 SuperType()</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 第一次调用 SuperType()</span></span><br><span class="line"><span class="title class_">SubType</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="title class_">SuperType</span>.<span class="property"><span class="keyword">prototype</span></span>);</span><br><span class="line"><span class="title class_">SubType</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> = <span class="title class_">SubType</span>;</span><br><span class="line"><span class="title class_">SubType</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayAge</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;My age is &quot;</span> + <span class="variable language_">this</span>.<span class="property">age</span> + <span class="string">&quot;.&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> instance1 = <span class="keyword">new</span> <span class="title class_">SubType</span>(<span class="string">&#x27;zxc&#x27;</span>, <span class="number">12</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(instance1);</span><br></pre></td></tr></table></figure><p>缺点</p><ul><li>使用超类型的实例做为子类型的原型，导致添加了不必要的原型属性。</li></ul><p>在上面的代码执行后， SubType.prototype上会有两个属性： name  和 colors 。它们都是 SuperType 的实例属性，但现在成为了 SubType 的原型属性。在调用 SubType构造函数时，也会调用SuperType 构造函数，这一次会在新对象上创建实例属性 name 和 colors 。这两个实例属性会遮蔽原型上同名的属性。</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/efca6f7d5e8c49729f6efd1b3ae32b9e~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="image.png"></p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bdf5f83e4bec48e99a3d9e8dfe635f44~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="image.png"></p><p>如图所示，有两组 name 和 colors 属性：一组在实例上，另一组在 SubType 的原型上。这是<br>调用两次 SuperType 构造函数的结果,好在有办法解决这个问题。</p><p>寄生式组合继承通过盗用构造函数继承属性，但使用混合式原型链继承方法。基本思路是 <strong>不通过调<br>用父类构造函数给子类原型赋值，而是取得父类原型的一个副本。说到底就是使用寄生式继承来继承父<br>类原型，然后将返回的新对象赋值给子类原型</strong> 。寄生式组合继承的基本模式如下所示：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function inheritPrototype(subType, superType) &#123;</span><br><span class="line">    let <span class="attr">prototype</span> = object(superType.prototype)<span class="comment">; // 创建对象</span></span><br><span class="line">    <span class="attr">prototype.constructor</span> = subType<span class="comment">; // 增强对象</span></span><br><span class="line">    <span class="attr">subType.prototype</span> = prototype<span class="comment">; // 赋值对象</span></span><br><span class="line">&#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p>这个 inheritPrototype() 函数实现了寄生式组合继承的核心逻辑。这个函数接收两个参数：子<br>类构造函数和父类构造函数。在这个函数内部，第一步是创建父类原型的一个副本。然后，给返回的<br>prototype 对象设置 constructor 属性，解决由于重写原型导致默认 constructor 丢失的问题。最<br>后将新创建的对象赋值给子类型的原型。如下例所示，调用 inheritPrototype() 就可以实现前面例<br>子中的子类型原型赋值：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">SuperType</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">colors</span> = [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;blue&quot;</span>, <span class="string">&quot;green&quot;</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">SuperType</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayName</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">SubType</span>(<span class="params">name, age</span>) &#123;</span><br><span class="line">    <span class="title class_">SuperType</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>, name)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">inheritPrototype</span>(<span class="title class_">SubType</span>, <span class="title class_">SuperType</span>);</span><br><span class="line"><span class="title class_">SubType</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayAge</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">age</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p>这里只调用了一次 SuperType 构造函数，避免了 SubType.prototype 上不必要也用不到的属性，<br>因此可以说这个例子的效率更高。而且，原型链仍然保持不变，因此 instanceof 操作符和<br>isPrototypeOf() 方法正常有效。<strong>寄生式组合继承</strong>可以算是引用类型继承的最佳模式。</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 面对对象 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 继承 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>垃圾回收</title>
      <link href="/posts/72f47432/"/>
      <url>/posts/72f47432/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="垃圾回收存在的意义"><a href="#垃圾回收存在的意义" class="headerlink" title="垃圾回收存在的意义"></a>垃圾回收存在的意义</h2><p>在 <code>C</code>语言和 <code>C++</code>语言中，如果想要开辟一块堆内存，需要先计算需要内存的大小，然后通过<strong>malloc</strong>函数去手动分配，在用完之后，还要用<strong>free</strong>函数去清理释放，否则这块内存就会被永久占用，造成<strong>内存泄露</strong>。</p><p>但是在写 <code>JavaScript</code>的时候，却没有这个过程，V8引擎会根据用户当前定义对象的大小去自动申请分配内存。</p><blockquote><p>虽然不需要再去手动管理内存，但仍然需要进行<strong>垃圾回收</strong>，避免出现<strong>内存泄露</strong>。</p></blockquote><h2 id="世代假说"><a href="#世代假说" class="headerlink" title="世代假说"></a>世代假说</h2><p>第一：大部分对象在内存中存在的时间很短，简单来说，就是很多对象一经分配内存，很快就变得不可访问；<br>第二：不死的对象，会活得更久。</p><h2 id="工作流程"><a href="#工作流程" class="headerlink" title="工作流程"></a>工作流程</h2><ol><li>标记空间中活动对象和非活动对象。<ol><li>所谓活动对象就是还在使用的对象</li><li>非活动对象就是可以进行垃圾回收的对象。</li></ol></li><li>回收非活动对象所占据的内存。<blockquote><p>在所有的标记完成之后，统一清理内存中所有被标记为可回收的对象。</p></blockquote></li><li>内存整理。<blockquote><p>一般来说，频繁回收对象后，内存中就会存在大量不连续空间，我们把这些不连续的内存空间称为内存碎片。<br>当内存中出现了大量的内存碎片之后，如果需要分配较大连续内存的时候，就有可能出现内存不足的情况。<br>整理这些内存碎片，但这步其实是可选的，因为有的垃圾回收器不会产生内存碎片</p></blockquote></li></ol><h2 id="垃圾回收策略"><a href="#垃圾回收策略" class="headerlink" title="垃圾回收策略"></a>垃圾回收策略</h2><ul><li><a href="https://www.jianshu.com/p/b8ed21e8a4fb">《深入理解 V8 的垃圾回收原理》</a></li><li><a href="https://zhuanlan.zhihu.com/p/23992332">《JavaScript 中的垃圾回收》</a></li></ul><p><img src="/image/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/1656849559793.png" alt="1656849559793"><br>v8的垃圾回收策略主要基于分代式垃圾回收机制，这个机制又基于世代假说，这个假说有两个特点：</p><blockquote><p>一、新生的对象存活时间较短，容易早死</p><p>二、不死的对象存活时间较长，会活得更久</p></blockquote><p>基于这个假说，v8引擎将内存分为了新生代和老生代。</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">新生代（副垃圾回收器）</button></li><li class="tab"><button type="button" data-href="#super-2">晋升</button></li><li class="tab"><button type="button" data-href="#super-3">老生代（主垃圾回收器）</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>作用：</p><blockquote><p>保存生存周期较短的对象</p></blockquote><p>特点：</p><blockquote><p>牺牲空间换时间，适合新生代，因为它的对象生存周期较短。</p></blockquote><p>缺点</p><blockquote><p>由于采用 Scavenge 算法，所以执行垃圾清理的时候，都需要把对象区域复制到空闲区域，每次都需要一定时间，所以一般新生区的空间会比较小</p></blockquote><p>分配方式</p><p>新生代存的都是生存周期短的对象，分配内存也很容易，只保存一个指向内存空间的指针，根据分配对象的大小递增指针就可以了，当存储空间快要满时，就进行一次垃圾回收。</p><p>实现方式</p><p>采用 <code>Scavenge</code>垃圾回收算法——只复制存活对象</p><blockquote><ol><li>把<strong>新生代内存空间</strong>对半划分为两个区域，一半是工作区域 <code>from</code>，一半是闲置区域 <code>to</code></li><li>新生代垃圾回收器会将<strong>from区域</strong>内的对象复制到<strong>to区域</strong>中</li><li>同时，将<strong>存活对象</strong>有序地排列起来，在复制过程中完成<strong>内存整理</strong>操作，因此<strong>to区域</strong>就没有内存碎片。</li><li>完成复制后，<strong>from区域</strong>与<strong>to区域</strong>进行<strong>交换</strong>，使得存活对象始终处于工作区域from中，另一块闲置区域始终保持空闲状态</li></ol></blockquote><p>这样就完成了垃圾对象的回收操作，同时这种角色翻转的操作还能让新生代中的这两块区域无限重复使用下去。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>当一个对象经过多次复制仍然存活时，它就会被认为是生命周期较长的对象。这种较长生命周期的对象随后会被移动到老生代中，采用新的算法进行管理。</p><p> <strong>对象从新生代移动到老生代的过程叫作晋升</strong> 。</p><p>对象晋升的条件主要有两个：</p><ol><li>对象从From空间复制到To空间时，会检查它的内存地址来判断这个对象是否经历过一次Scavenge回收。如果经历过，会将该对象从From空间移动到老生代空间中，如果没有，则复制到To空间。</li></ol><blockquote><p><strong>总结来说</strong>：<br>如果一个对象是<strong>第二次经历</strong>从From空间复制到To空间，那么这个对象会被移动到老生代中。</p></blockquote><ol start="2"><li>当要从From空间复制一个对象到To空间时，如果<strong>To空间</strong>已经使用了**超过25%**，则这个对象直接晋升到老生代中。</li></ol><blockquote><p><strong>设置25%这个阈值的原因</strong>：<br>当这次Scavenge回收完成后，这个To空间会变为From空间，接下来的内存分配将在这个空间中进行。如果占比过高，会影响后续的内存分配。</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>作用：</p><blockquote><p>保存生存周期较长的对象</p></blockquote><p>特点</p><blockquote><ol><li>占用空间大</li><li>存活时间长</li></ol></blockquote><p>解决问题</p><p>在老生代中，存活对象占较大比重，如果继续采用Scavenge算法进行管理，就会存在两个问题：</p><ol><li>由于存活对象较多，复制存活对象的效率会很低。</li><li>采用Scavenge算法会浪费一半内存，由于老生代所占堆内存远大于新生代，所以浪费会很严重。</li></ol><p>所以，V8在老生代中主要采用了<strong>Mark-Sweep</strong>和<strong>Mark-Compact</strong>相结合的方式进行垃圾回收。</p><p>实现方式</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">Mark-Sweep</button></li><li class="tab"><button type="button" data-href="#super-2">Mark-Compact</button></li><li class="tab"><button type="button" data-href="#super-3">两者结合</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>Mark-Sweep是标记清除的意思，它分为标记和清除两个阶段。</p><ol><li>在<strong>标记阶段</strong>，遍历堆内存中的所有对象，并标记<strong>存活对象</strong></li><li>在<strong>清除阶段</strong>，只清除<strong>未标记对象</strong>。</li></ol><p>也就是说，Scavenge只复制活着的对象，而Mark-Sweep只清除死了的对象。</p><blockquote><p>活对象在新生代中只占较少部分，死对象在老生代中只占较少部分.<br>这就是两种回收方式都能高效处理的原因。</p></blockquote><p>通过流程图来看一下：</p><p> <strong>step1</strong> . 老生代中有对象A、B、C、D、E、F</p><p><img src="https://segmentfault.com/img/bVbwnVL?w=800&h=262" alt="clipboard.png" title="clipboard.png"></p><p> <strong>step2</strong> . GC进入标记阶段，将A、C、E标记为存活对象</p><p><img src="https://segmentfault.com/img/bVbwnVN?w=801&h=302" alt="clipboard.png" title="clipboard.png"></p><p> <strong>step3</strong> . GC进入清除阶段，回收掉死亡的B、D、F对象所占用的内存空间</p><p><img src="https://segmentfault.com/img/bVbwnVT?w=801&h=272" alt="clipboard.png" title="clipboard.png"></p><p>可以看到，Mark-Sweep最大的问题就是</p><blockquote><p>在进行一次清除回收以后，内存空间会出现不连续的状态。<br>这种内存碎片会对后续的内存分配造成问题。<br>比如，如果出现需要分配一个大内存的情况，由于剩余的碎片空间不足以完成此次分配，就会提前触发垃圾回收，而这次回收是不必要的。</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>为了解决Mark-Sweep的内存碎片问题，Mark-Compact就出现了。</p><p> <strong>Mark-Compact</strong>是标记整理的意思，由Mark-Sweep演变而来。</p><blockquote><p>Mark-Compact在标记完存活对象以后，会将活着的对象向内存空间的一端移动，移动完成后，直接清理掉边界外的所有内存。</p></blockquote><p> 如下图所示：<br> <strong>step1</strong> . 老生代中有对象A、B、C、D、E、F（和Mark—Sweep一样）</p><p><img src="https://segmentfault.com/img/bVbwnVV?w=801&h=262" alt="clipboard.png" title="clipboard.png"></p><p> <strong>step2</strong> . GC进入标记阶段，将A、C、E标记为存活对象（和Mark—Sweep一样）</p><p><img src="https://segmentfault.com/img/bVbwnVN?w=801&h=302" alt="clipboard.png" title="clipboard.png"></p><p> <strong>step3</strong> . GC进入整理阶段，将所有存活对象向内存空间的一侧移动，灰色部分为移动后空出来的空间</p><p><img src="https://segmentfault.com/img/bVbwnV1?w=850&h=298" alt="clipboard.png" title="clipboard.png"></p><p> <strong>step4</strong> . GC进入清除阶段，将边界另一侧的内存一次性全部回收</p><p><img src="https://segmentfault.com/img/bVbwnV6?w=840&h=306" alt="clipboard.png" title="clipboard.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>在V8的回收策略中，Mark-Sweep和Mark-Conpact两者是结合使用的。</p><p>由于Mark-Conpact需要移动对象，所以它的执行速度不可能很快，在取舍上，V8主要使用Mark-Sweep，在空间不足以对从新生代中晋升过来的对象进行分配时，才使用Mark-Compact。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="全停顿"><a href="#全停顿" class="headerlink" title="全停顿"></a>全停顿</h2><p>为了避免出现Javascript应用逻辑与垃圾回收时看到的情况不一致，每次执行垃圾回收时，都会暂停js的脚本执行，等垃圾回收完毕，再恢复执行，这种被称作全停顿(stop-the-world)。</p><p>新生代中，由于空间较小，且对象存活较少，所以影响不大，老生代的话，会容易出现卡顿。</p><p>为了降低老生代的垃圾回收而造成的卡顿，V8 将标记过程分为一个个的子标记过程，同时让垃圾回收标记和 JavaScript 应用逻辑交替进行，直到标记阶段完成，我们把这个算法称为增量标记（Incremental Marking）算法。</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 面对对象 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 垃圾回收 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>事件循环（EventLoop）</title>
      <link href="/posts/4e43da1/"/>
      <url>/posts/4e43da1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>更多详情见<a href="https://nodejs.org/zh-cn/docs/guides/event-loop-timers-and-nexttick/">Node.js 事件循环，定时器和process.nextTick()</a></p><h2 id="三种事件模型"><a href="#三种事件模型" class="headerlink" title="三种事件模型"></a>三种事件模型</h2><p><strong>事件</strong>是用户操作网页时发生的交互动作或者网页本身的一些操作，现代浏览器一共有三种事件模型。</p><ol><li><strong>DOM0级模型：</strong> 这种模型不会传播，所以没有事件流的概念，但是现在有的浏览器支持以冒泡的方式实现，它可以在网页中直接定义监听函数，也可以通过js属性来指定监听函数。这种方式是所有浏览器都兼容的。</li><li><strong>IE事件模型：</strong> 在该事件模型中，一次事件共有两个过程，事件处理阶段，和事件冒泡阶段。事件处理阶段会首先执行目标元素绑定的监听事件。然后是事件冒泡阶段，冒泡指的是事件从目标元素冒泡到document，依次检查经过的节点是否绑定了事件监听函数，如果有则执行。这种模型通过attachEvent 来添加监听函数，可以添加多个监听函数，会按顺序依次执行。</li><li><strong>DOM2级事件模型：</strong> 在该事件模型中，一次事件共有三个过程，第一个过程是事件捕获阶段。捕获指的是事件从document一直向下传播到目标元素，依次检查经过的节点是否绑定了事件监听函数，如果有则执行。后面两个阶段和IE事件模型的两个阶段相同。这种事件模型，事件绑定的函数是addEventListener，其中第三个参数可以指定事件是否在捕获阶段执行。</li></ol><h2 id="事件委托"><a href="#事件委托" class="headerlink" title="事件委托"></a>事件委托</h2><p><strong>事件委托</strong> 本质上是利用了浏览器事件冒泡的机制。因为事件在冒泡过程中会上传到父节点，并且父节点可以通过事件对象获取到目标节点，因此可以把子节点的监听函数定义在父节点上，由父节点的监听函数统一处理多个子元素的事件，这种方式称为事件代理。</p><p>使用事件代理我们可以不必要为每一个子元素都绑定一个监听事件，这样减少了内存上的消耗。并且使用事件代理我们还可以实现事件的动态绑定，比如说新增了一个子节点，我们并不需要单独地为它添加一个监听事件，它所发生的事件会交给父元素中的监听函数来处理。</p><p>相关资料：<a href="https://link.juejin.cn/?target=https://zhuanlan.zhihu.com/p/26536815" title="https://zhuanlan.zhihu.com/p/26536815">《JavaScript 事件委托详解》</a></p><h2 id="事件传播"><a href="#事件传播" class="headerlink" title="事件传播"></a>事件传播</h2><p>当<strong>事件</strong>发生DOM元素上时，该事件并不完全发生在那个元素上。</p><p>事件传播有三个阶段：</p><ol><li>捕获阶段–事件从window开始，然后向下到每个元素，直到到达目标元素事件或event.target。</li><li>目标阶段–事件已达到目标元素。</li><li>冒泡阶段–事件从目标元素冒泡，然后上升到每个元素，直到到达window。</li></ol><h2 id="事件捕获"><a href="#事件捕获" class="headerlink" title="事件捕获"></a>事件捕获</h2><p>当事件发生在DOM元素上时，该事件并不完全发生在那个元素上。在捕获阶段，事件从window开始，一直到触发事件的元素。</p><p>Window -&gt; document -html -&gt; body -&gt; 目标元素</p><p>假设有如下的HTML结构：</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;div <span class="keyword">class</span>=&quot;<span class="symbol">grandparent</span>&quot;&gt;</span><br><span class="line">   &lt;<span class="symbol">div</span> <span class="symbol">class</span>=&quot;<span class="symbol">parent</span>&quot;&gt;</span><br><span class="line">      &lt;<span class="symbol">div</span> <span class="symbol">class</span>=&quot;<span class="symbol">child</span>&quot;&gt;<span class="symbol">1</span> &lt;/<span class="symbol">div</span>&gt;</span><br><span class="line">   &lt;/<span class="symbol">div</span>&gt;</span><br><span class="line">&lt;/<span class="symbol">div</span>&gt;</span><br></pre></td></tr></table></figure><p>对应的JS代码:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">addEvent</span>(<span class="params">el, event, callback, isCapture = <span class="literal">false</span></span>) &#123;</span><br><span class="line">   <span class="keyword">if</span> (!el || !event || !callback || <span class="keyword">typeof</span> callback !== <span class="string">&#x27;function&#x27;</span>) <span class="keyword">return</span>;</span><br><span class="line">   <span class="keyword">if</span> (<span class="keyword">typeof</span> el === <span class="string">&#x27;string&#x27;</span>) &#123;</span><br><span class="line">      el = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(el);</span><br><span class="line">   &#125;;</span><br><span class="line">   el.<span class="title function_">addEventListener</span>(event, callback, isCapture);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">addEvent</span>(<span class="variable language_">document</span>, <span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">   <span class="keyword">const</span> child = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.child&#x27;</span>);</span><br><span class="line">   <span class="keyword">const</span> parent = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.parent&#x27;</span>);</span><br><span class="line">   <span class="keyword">const</span> grandparent = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.grandparent&#x27;</span>);</span><br><span class="line">   <span class="title function_">addEvent</span>(child, <span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;child&#x27;</span>);</span><br><span class="line">   &#125;);</span><br><span class="line">   <span class="title function_">addEvent</span>(parent, <span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;parent&#x27;</span>);</span><br><span class="line">   &#125;);</span><br><span class="line">   <span class="title function_">addEvent</span>(grandparent, <span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;grandparent&#x27;</span>);</span><br><span class="line">   &#125;);</span><br><span class="line">   <span class="title function_">addEvent</span>(<span class="variable language_">document</span>, <span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;document&#x27;</span>);</span><br><span class="line">   &#125;);</span><br><span class="line">   <span class="title function_">addEvent</span>(<span class="string">&#x27;html&#x27;</span>, <span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">   &#125;)</span><br><span class="line">   <span class="title function_">addEvent</span>(<span class="variable language_">window</span>, <span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;window&#x27;</span>);</span><br><span class="line">   &#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><strong>addEventListene</strong>r方法具有第三个可选参数<strong>useCapture</strong>，其默认值为<strong>false</strong>，事件将在冒泡阶段中发生，如果为true，则事件将在捕获阶段中发生。如果单击<strong>child</strong>元素，它将分别在控制台上打印<strong>window</strong>，<strong>document</strong>，<strong>html</strong>，<strong>grandparent</strong>和<strong>parent</strong>，这就是 <strong>事件捕获</strong> 。</p><h2 id="事件冒泡"><a href="#事件冒泡" class="headerlink" title="事件冒泡"></a>事件冒泡</h2><p>事件冒泡刚好与事件捕获相反，当前元素** <strong>-&gt;</strong> <strong>body -&gt; html</strong> <strong>-&gt;</strong> <strong>document -&gt;</strong> **window。当事件发生在DOM元素上时，该事件并不完全发生在那个元素上。在冒泡阶段，事件冒泡，或者事件发生在它的父代，祖父母，祖父母的父代，直到到达window为止。</p><p>假设有如下的HTML结构：</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;div <span class="keyword">class</span>=&quot;<span class="symbol">grandparent</span>&quot;&gt;</span><br><span class="line">  `&lt;<span class="symbol">div</span> <span class="symbol">class</span>=&quot;<span class="symbol">parent</span>&quot;&gt;</span><br><span class="line">      &lt;<span class="symbol">div</span> <span class="symbol">class</span>=&quot;<span class="symbol">child</span>&quot;&gt;<span class="symbol">1</span> &lt;/<span class="symbol">div</span>&gt;</span><br><span class="line">   &lt;/<span class="symbol">div</span>&gt;</span><br><span class="line">&lt;/<span class="symbol">div</span>&gt;</span><br></pre></td></tr></table></figure><p>对应的JS代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">addEvent</span>(<span class="params">el, event, callback, isCapture = <span class="literal">false</span></span>) &#123;</span><br><span class="line">   <span class="keyword">if</span> (!el || !event || !callback || <span class="keyword">typeof</span> callback !== <span class="string">&#x27;function&#x27;</span>) </span><br><span class="line">   <span class="keyword">return</span>;</span><br><span class="line">   <span class="keyword">if</span> (<span class="keyword">typeof</span> el === <span class="string">&#x27;string&#x27;</span>) &#123;</span><br><span class="line">      el = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(el);</span><br><span class="line">   &#125;;</span><br><span class="line">   el.<span class="title function_">addEventListener</span>(event, callback, isCapture);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">addEvent</span>(<span class="variable language_">document</span>, <span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">   <span class="keyword">const</span> child = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.child&#x27;</span>);</span><br><span class="line">   <span class="keyword">const</span> parent = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.parent&#x27;</span>);</span><br><span class="line">   <span class="keyword">const</span> grandparent = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.grandparent&#x27;</span>);</span><br><span class="line">   <span class="title function_">addEvent</span>(child, <span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;child&#x27;</span>);</span><br><span class="line">   &#125;);</span><br><span class="line">   <span class="title function_">addEvent</span>(parent, <span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;parent&#x27;</span>);</span><br><span class="line">   &#125;);</span><br><span class="line">   <span class="title function_">addEvent</span>(grandparent, <span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;grandparent&#x27;</span>);</span><br><span class="line">   &#125;);</span><br><span class="line">   <span class="title function_">addEvent</span>(<span class="variable language_">document</span>, <span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;document&#x27;</span>);</span><br><span class="line">   &#125;);</span><br><span class="line">   <span class="title function_">addEvent</span>(<span class="string">&#x27;html&#x27;</span>, <span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">   &#125;)</span><br><span class="line">   <span class="title function_">addEvent</span>(<span class="variable language_">window</span>, <span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;window&#x27;</span>);</span><br><span class="line">   &#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><strong>addEventListener</strong>方法具有第三个可选参数<strong>useCapture</strong>，其默认值为<strong>false</strong>，事件将在冒泡阶段中发生，如果为true，则事件将在捕获阶段中发生。如果单击<strong>child</strong>元素，它将分别在控制台上打印<strong>child</strong>，<strong>parent</strong>，<strong>grandparent</strong>，<strong>html</strong>，<strong>document</strong>和<strong>window</strong>，这就是 <strong>事件冒泡</strong> 。</p><h2 id="谈谈JS的运行机制"><a href="#谈谈JS的运行机制" class="headerlink" title="谈谈JS的运行机制"></a>谈谈JS的运行机制</h2><h3 id="js单线程"><a href="#js单线程" class="headerlink" title="js单线程"></a>js单线程</h3><p>JavaScript语言的一大特点就是单线程，即同一时间只能做一件事情。</p><p>JavaScript的单线程，与它的用途有关。作为浏览器脚本语言，JavaScript的主要用途是与用户互动，以及操作DOM。这决定了它只能是单线程，否则会带来很复杂的同步问题。比如，假定JavaScript同时有两个线程，一个线程在某个DOM节点上添加内容，另一个线程删除了这个节点，这时浏览器应该以哪个线程为准？</p><p>为了避免复杂性，从一诞生，JavaScript就是单线程，这已经成了这门语言的核心特征，将来也不会改变。</p><h3 id="js事件循环"><a href="#js事件循环" class="headerlink" title="js事件循环"></a>js事件循环</h3><p>js代码执行过程中会有很多任务，这些任务总的分成两类：</p><p>l 同步任务</p><p>l 异步任务</p><p>当我们打开网站时，网页的渲染过程就是一大堆同步任务，比如页面骨架和页面元素的渲染。而像加载图片音乐之类占用资源大耗时久的任务，就是异步任务。，我们用导图来说明：<img src="file:///C:\Users\ADMINI~1\AppData\Local\Temp\ksohtml17948\wps6.jpg">我解释一下这张图：</p><p>l 同步和异步任务分别进入不同的执行”场所”，同步的进入主线程，异步的进入<strong>Event Table</strong>并注册函数。</p><p>l 当指定的事情完成时，<strong>Event Table</strong>会将这个函数移入<strong>Event Queue</strong>。</p><p>l 主线程内的任务执行完毕为空，会去<strong>Event Queue</strong>读取对应的函数，进入主线程执行。</p><p>l 上述过程会不断重复，也就是常说的<strong>Event Loop</strong>(事件循环)。</p><p>那主线程执行栈何时为空呢？js引擎存在<strong>monitoring process</strong>进程，会持续不断的检查主线程执行栈是否为空，一旦为空，就会去<strong>Event Queue</strong>那里检查是否有等待被调用的函数。</p><p>以上就是js运行的整体流程</p><p>需要注意的是除了同步任务和异步任务，任务还可以更加细分为macrotask(宏任务)和microtask(微任务)，js引擎会优先执行微任务</p><p>微任务包括了 <strong>promise</strong> 的回调、node 中的 process.nextTick 、对 Dom 变化监听的 MutationObserver。</p><p>宏任务包括了<strong>script</strong>脚本的执行、setTimeout ，setInterval ，setImmediate 一类的定时事件，还有如 I&#x2F;O 操作、UI 渲染等。</p><p>面试中该如何回答呢？下面是我个人推荐的回答：</p><ol><li>首先js 是单线程运行的，在代码执行的时候，通过将不同函数的执行上下文压入执行栈中来保证代码的有序执行。</li><li>在执行同步代码的时候，如果遇到了异步事件，js 引擎并不会一直等待其返回结果，而是会将这个事件挂起，继续执行执行栈中的其他任务</li><li>当同步事件执行完毕后，再将异步事件对应的回调加入到与当前执行栈中不同的另一个任务队列中等待执行。</li><li>任务队列可以分为宏任务对列和微任务对列，当当前执行栈中的事件执行完毕后，js 引擎首先会判断微任务对列中是否有任务可以执行，如果有就将微任务队首的事件压入栈中执行。</li><li>当微任务对列中的任务都执行完成后再去判断宏任务对列中的任务。</li></ol><p>最后可以用下面一道题检测一下收获：</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">setTimeout(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">   <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="number">1</span>)</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">new</span> Promise(<span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">   <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="number">2</span>);</span><br><span class="line">   resolve()</span><br><span class="line">&#125;).then(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">   <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="number">3</span>)</span><br><span class="line">&#125;);</span><br><span class="line">process.nextTick(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">   <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="number">4</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(<span class="number">5</span>)</span><br></pre></td></tr></table></figure><p>第一轮：主线程开始执行，遇到setTimeout，将setTimeout的回调函数丢到宏任务队列中，在往下执行new Promise立即执行，输出2，then的回调函数丢到微任务队列中，再继续执行，遇到process.nextTick，同样将回调函数扔到为任务队列，再继续执行，输出5，当所有同步任务执行完成后看有没有可以执行的微任务，发现有then函数和nextTick两个微任务，先执行哪个呢？process.nextTick指定的异步任务总是发生在所有异步任务之前，因此先执行process.nextTick输出4然后执行then函数输出3，第一轮执行结束。 第二轮：从宏任务队列开始，发现setTimeout回调，输出1执行完毕，因此结果是25431</p><p>相关资料：<br><a href="https://juejin.cn/post/6844903606466904078" title="https://juejin.cn/post/6844903606466904078">《浏览器事件循环机制（event loop）》</a></p><p><a href="https://link.juejin.cn/?target=https://zhuanlan.zhihu.com/p/33058983" title="https://zhuanlan.zhihu.com/p/33058983">《详解 JavaScript 中的 Event Loop（事件循环）机制》</a></p><p><a href="https://link.juejin.cn/?target=http://www.ruanyifeng.com/blog/2013/10/event_loop.html" title="http://www.ruanyifeng.com/blog/2013/10/event_loop.html">《 Event Loop》</a></p><p><a href="https://juejin.cn/post/6844903512845860872" title="https://juejin.cn/post/6844903512845860872">《这一次，彻底弄懂 JavaScript 执行机制》</a></p><p>那主线程执行栈何时为空呢？js引擎存在<strong>monitoring process</strong>进程，会持续不断的检查主线程执行栈是否为空，一旦为空，就会去<strong>Event Queue</strong>那里检查是否有等待被调用的函数。</p><p>以上就是js运行的整体流程</p><p>需要注意的是除了同步任务和异步任务，任务还可以更加细分为macrotask(宏任务)和microtask(微任务)，js引擎会优先执行微任务</p><p>微任务包括了** promise **的回调、node 中的 process.nextTick 、对 Dom 变化监听的 MutationObserver。</p><p>宏任务包括了** script **脚本的执行、setTimeout ，setInterval ，setImmediate 一类的定时事件，还有如 I&#x2F;O 操作、UI 渲染等。</p><p>面试中该如何回答呢？下面是我个人推荐的回答：</p><ol><li>首先js 是单线程运行的，在代码执行的时候，通过将不同函数的执行上下文压入执行栈中来保证代码的有序执行。</li><li>在执行同步代码的时候，如果遇到了异步事件，js 引擎并不会一直等待其返回结果，而是会将这个事件挂起，继续执行执行栈中的其他任务</li><li>当同步事件执行完毕后，再将异步事件对应的回调加入到与当前执行栈中不同的另一个任务队列中等待执行。</li><li>任务队列可以分为宏任务对列和微任务对列，当当前执行栈中的事件执行完毕后，js 引擎首先会判断微任务对列中是否有任务可以执行，如果有就将微任务队首的事件压入栈中执行。</li><li>当微任务对列中的任务都执行完成后再去判断宏任务对列中的任务。</li></ol><p>最后可以用下面一道题检测一下收获：</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">setTimeout(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">   <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="number">1</span>)</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">new</span> Promise(<span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">   <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="number">2</span>);</span><br><span class="line">   resolve()</span><br><span class="line">&#125;).then(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">   <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="number">3</span>)</span><br><span class="line">&#125;);</span><br><span class="line">process.nextTick(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">   <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="number">4</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(<span class="number">5</span>)</span><br></pre></td></tr></table></figure><p>第一轮：主线程开始执行，遇到setTimeout，将setTimeout的回调函数丢到宏任务队列中，在往下执行new Promise立即执行，输出2，then的回调函数丢到微任务队列中，再继续执行，遇到process.nextTick，同样将回调函数扔到为任务队列，再继续执行，输出5，当所有同步任务执行完成后看有没有可以执行的微任务，发现有then函数和nextTick两个微任务，先执行哪个呢？process.nextTick指定的异步任务总是发生在所有异步任务之前，因此先执行process.nextTick输出4然后执行then函数输出3，第一轮执行结束。 第二轮：从宏任务队列开始，发现setTimeout回调，输出1执行完毕，因此结果是2543</p><p>相关资料：<br><a href="https://juejin.cn/post/6844903606466904078">《浏览器事件循环机制（event loop）》</a></p><p><a href="https://zhuanlan.zhihu.com/p/33058983">《详解 JavaScript 中的 Event Loop（事件循环）机制》</a></p><p><a href="http://www.ruanyifeng.com/blog/2013/10/event_loop.html">《 Event Loop》</a></p><p><a href="https://juejin.cn/post/6844903512845860872">《这一次，彻底弄懂 JavaScript 执行机制》</a></p><h1 id="浏览器中的事件循环"><a href="#浏览器中的事件循环" class="headerlink" title="浏览器中的事件循环"></a>浏览器中的事件循环</h1><h2 id="事件循环概念"><a href="#事件循环概念" class="headerlink" title="事件循环概念"></a>事件循环概念</h2><p><code>JavaScript</code> 代码的执行过程中，除了依靠函数调用栈来搞定函数的执行顺序外，还依靠任务队列(<code>task queue</code>)来搞定另外一些代码的执行。整个执行过程，称之为事件循环。</p><p>一个线程中，事件循环是唯一的，但是任务队列可以拥有多个。</p><p>任务队列又分为 <code>macro-task</code>（宏任务）与 <code>micro-task</code>（微任务）。</p><h3 id="宏任务-macro-task"><a href="#宏任务-macro-task" class="headerlink" title="宏任务(macro-task)"></a>宏任务(macro-task)</h3><p>置于同一个宏任务队列中</p><ul><li>script(整体代码)</li><li>setTimeout</li><li>setInterval</li><li>requestAnimationFrame(浏览器独有)</li><li>I&#x2F;O</li><li>UI render(浏览器独有)</li></ul><h3 id="微任务-micro-task"><a href="#微任务-micro-task" class="headerlink" title="微任务(micro-task)"></a>微任务(micro-task)</h3><p>置于同一个微任务队列中</p><ul><li>Promise</li><li>Async&#x2F;Await(实际就是promise)</li><li>Mutation Observer(html5新特性)</li></ul><h2 id="执行流程"><a href="#执行流程" class="headerlink" title="执行流程"></a>执行流程</h2><ol><li>执行全局Script同步代码（既含同步语句，也含异步语句）</li><li>全局Script代码执行完毕后，调用栈Stack会清空；</li><li>从<strong>微任务队列</strong>中取出位于队首的回调任务，放入调用栈Stack中执行，执行完后<strong>微任务队列</strong>长度-1；</li><li>重复步骤三，直到把<strong>微任务队列</strong>中的所有任务都执行完毕。<blockquote><p>注意，如果在执行<strong>微任务</strong>的过程中，又产生了<strong>微任务</strong>，那么会加入到队列的末尾，也会在这个周期被调用执行；</p></blockquote></li><li><strong>微任务队列</strong>中的所有任务都执行完毕，此时<strong>微任务队列</strong>为空队列，调用栈Stack也为空；</li><li>从<strong>宏任务队列</strong>中取出位于队首的回调任务，放入调用栈Stack中执行；</li><li>执行完毕后，调用栈Stack为空；</li><li>重复步骤3~7；</li><li>……</li></ol><p>例子如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">async1</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">async2</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;async1 end&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">async2</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;async2 end&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">async1</span>()</span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;setTimeout&#x27;</span>)</span><br><span class="line">&#125;, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Promise&#x27;</span>)</span><br><span class="line">    <span class="title function_">resolve</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">.<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;promise1&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">.<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;promise2&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>输出答案为：<br><code>async2 end =&gt; Promise =&gt; promise1 =&gt; promise2 =&gt; async1 end =&gt; setTimeout</code></p><h2 id="注意async-x2F-await前后执行顺序"><a href="#注意async-x2F-await前后执行顺序" class="headerlink" title="注意async&#x2F;await前后执行顺序"></a>注意async&#x2F;await前后执行顺序</h2><p><code>async</code> 会隐式返回 <code>Promise</code> 作为结果的函数，那么可以简单理解为，<code>await</code> 后面的函数执行完毕时，<code>await</code> 会产生一个微任务(Promise.then是微任务)。<br>但是我们要注意这个微任务产生的时机，它是执行完 <code>await</code> 之后，直接跳出 <code>async</code> 函数，执行其他代码(此处就是协程的运作，A暂停执行，控制权交给B)。<br>其他代码执行完毕后，再回到 <code>async</code> 函数去执行剩下的代码，然后把 <code>await</code> 后面的代码注册到微任务队列当中。我们来看个例子：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;script start&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">async1</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">async2</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;async1 end&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">async2</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;async2 end&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">async1</span>()</span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;setTimeout&#x27;</span>)</span><br><span class="line">&#125;, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Promise&#x27;</span>)</span><br><span class="line">    <span class="title function_">resolve</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">.<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;promise1&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">.<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;promise2&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;script end&#x27;</span>)</span><br></pre></td></tr></table></figure><p>答案输出为：<br><code>script start =&gt; async2 end =&gt; Promise =&gt; script end =&gt; promise1 =&gt; promise2 =&gt; async1 end =&gt; setTimeout</code></p><p>分析这段代码：</p><ul><li><p>执行代码，输出 <code>script start</code>。</p></li><li><p>执行 <code>async1()</code>，会调用 <code>async2()，然后输出 </code>async2 end <code>，此时将会保留async1函数的上下文，然后跳出 </code>async1&#96; 函数。</p></li><li><p>遇到setTimeout，产生一个宏任务</p></li><li><p>执行 <code>Promise</code>，输出 <code>Promise</code>。遇到 <code>then</code>，产生第一个微任务</p></li><li><p>继续执行代码，输出 <code>script end</code></p></li><li><p>代码逻辑执行完毕(当前宏任务执行完毕)，开始执行当前宏任务产生的微任务队列，输出 <code>promise1</code>，该微任务遇到 <code>then</code>，产生一个新的微任务</p></li><li><p>执行产生的微任务，输出 <code>promise2</code>，当前微任务队列执行完毕。执行权回到 <code>async1</code></p></li><li><p>执行 <code>await</code>，实际上会产生一个 <code>promise</code> 返回，即</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> promise_ = <span class="keyword">new</span> <span class="title class_">Promise</span>((resolve,reject)&#123;</span><br><span class="line">    <span class="title function_">resolve</span>(<span class="literal">undefined</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>执行完成，执行await后面的语句，输出 <code>async1 end</code></p></li><li><p>最后，执行下一个宏任务，即执行 <code>setTimeout</code>，输出 <code>setTimeout</code></p></li></ul><h2 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h2><p>新版的 <code>chrome</code> 浏览器优化后，<code>await</code> 变快<br>答案输出改为:<br><code>script start =&gt; async2 end =&gt; Promise =&gt; script end =&gt; async1 end =&gt; promise1 =&gt; promise2 =&gt; setTimeout</code></p><p>可以分2种情况来理解：</p><ol><li>如果 <code>await</code> 后面直接跟着一个变量，比如：await 1；</li></ol><blockquote><p>这种情况的话相当于直接把 <code>await</code> 后面的代码注册为一个微任务，可以简单理解为 <code>promise.then</code>(await下面的代码)。然后跳出 <code>async1</code> 函数，执行其他代码，当遇到 <code>promise</code> 函数的时候，会注册 <code>promise.then()</code> 函数到微任务队列，注意此时微任务队列里面已经存在await后面的微任务。所以这种情况会先执行 <code>await</code> 后面的代码（async1 end），再执行 <code>async1</code> 函数后面注册的微任务代码(promise1,promise2)。</p></blockquote><ol start="2"><li><p>如果await后面跟的是一个异步函数的调用，代码如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;script start&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">async1</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">async2</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;async1 end&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">async2</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;async2 end&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>().<span class="title function_">then</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;async2 end1&#x27;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">async1</span>()</span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;setTimeout&#x27;</span>)</span><br><span class="line">&#125;, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Promise&#x27;</span>)</span><br><span class="line">    <span class="title function_">resolve</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">.<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;promise1&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">.<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;promise2&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;script end&#x27;</span>)</span><br></pre></td></tr></table></figure><p>答案输出为：<br><code>script start =&gt; async2 end =&gt; Promise =&gt; script end =&gt; async2 end1 =&gt; promise1 =&gt; promise2 =&gt; async1 end =&gt; setTimeout</code></p><p>此时执行完awit并不先把await后面的代码注册到微任务队列中去，而是执行完await之后，直接跳出async1函数，执行其他代码。然后遇到promise的时候，把promise.then注册为微任务。其他代码执行完毕后，需要回到async1函数去执行剩下的代码，然后把await后面的代码注册到微任务队列当中，注意此时微任务队列中是有之前注册的微任务的。所以这种情况会先执行async1函数之外的微任务(promise1,promise2)，然后才执行async1内注册的微任务(async1 end).<br>可以理解为，这种情况下，await 后面的代码会在本轮循环的最后被执行.</p></li></ol><p>浏览器中有事件循环，node 中也有，事件循环是 node 处理非阻塞 I&#x2F;O 操作的机制，node中事件循环的实现是依靠的libuv引擎。由于 node 11 之后，事件循环的一些原理发生了变化，这里就以新的标准去讲，最后再列上变化点让大家了解前因后果。</p><h1 id="Node中的事件循环"><a href="#Node中的事件循环" class="headerlink" title="Node中的事件循环"></a>Node中的事件循环</h1><h2 id="事件循环概念-1"><a href="#事件循环概念-1" class="headerlink" title="事件循环概念"></a>事件循环概念</h2><p>事件循环： Node.js 处理非阻塞 I&#x2F;O 操作的机制。</p><h3 id="宏任务-macro-task-1"><a href="#宏任务-macro-task-1" class="headerlink" title="宏任务(macro-task)"></a>宏任务(macro-task)</h3><p>置于相对应的宏任务队列中</p><ul><li>setTimeout</li><li>setInterval</li><li>setImmediate(Node独有)</li><li>script（整体代码)</li><li>I&#x2F;O 操作</li></ul><h3 id="微任务-micro-task-1"><a href="#微任务-micro-task-1" class="headerlink" title="微任务(micro-task)"></a>微任务(micro-task)</h3><p>置于相对应的微任务队列中</p><ul><li>process.nextTick(与普通微任务有区别，在微任务队列执行之前执行)</li><li>new Promise().then(回调)</li></ul><h2 id="事件循环机制解析"><a href="#事件循环机制解析" class="headerlink" title="事件循环机制解析"></a>事件循环机制解析</h2><p>当 Node.js 启动后，会初始化事件循环，处理已提供的输入脚本（或丢入 <a href="https://nodejs.org/api/repl.html#repl_repl">REPL</a>），它可能会调用一些异步的 API、调度定时器，或调用 <code>process.nextTick()</code>，然后开始处理事件循环。</p><p>下面的图表展示了事件循环操作顺序的简化概览。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">   ┌───────────────────────────┐</span><br><span class="line">┌─<span class="operator">&gt;</span>│           timers          │</span><br><span class="line">│  └─────────────┬─────────────┘</span><br><span class="line">│  ┌─────────────┴─────────────┐</span><br><span class="line">│  │     pending callbacks     │</span><br><span class="line">│  └─────────────┬─────────────┘</span><br><span class="line">│  ┌─────────────┴─────────────┐</span><br><span class="line">│  │       idle, <span class="keyword">prepare</span>       │</span><br><span class="line">│  └─────────────┬─────────────┘      ┌───────────────┐</span><br><span class="line">│  ┌─────────────┴─────────────┐      │   incoming:   │</span><br><span class="line">│  │           poll            │<span class="operator">&lt;</span>─────┤  connections, │</span><br><span class="line">│  └─────────────┬─────────────┘      │   data, etc.  │</span><br><span class="line">│  ┌─────────────┴─────────────┐      └───────────────┘</span><br><span class="line">│  │           <span class="keyword">check</span>           │</span><br><span class="line">│  └─────────────┬─────────────┘</span><br><span class="line">│  ┌─────────────┴─────────────┐</span><br><span class="line">└──┤      <span class="keyword">close</span> callbacks      │</span><br><span class="line">   └───────────────────────────┘</span><br></pre></td></tr></table></figure><h2 id="阶段概述"><a href="#阶段概述" class="headerlink" title="阶段概述"></a>阶段概述</h2><ul><li><strong>timers（定时器阶段）</strong>：执行timer的回调，即 <code>setTimeout()</code> 、 <code>setInterval()</code> 的回调函数。</li><li><strong>pending callbacks（待定回调阶段）</strong>：执行延迟到下一个循环迭代的 I&#x2F;O 回调，即上一轮循环中未被执行的一些I&#x2F;O回调。</li><li><strong>idle, prepare（闲置阶段）</strong>：仅系统内部使用。</li><li><strong>poll（轮询阶段）</strong>：检索新的 I&#x2F;O 事件；执行与 I&#x2F;O 相关的回调（几乎所有情况下，除了关闭的回调函数，那些由计时器和 <code>setImmediate()</code> 调度的之外），其余情况 node 将在适当的时候在此阻塞。</li><li><strong>check（检测阶段）</strong>：<code>setImmediate()</code> 回调函数在这里执行。</li><li><strong>close callbacks（关闭事件的回调函数）</strong>：一些关闭的回调函数，如：<code>socket.on(&#39;close&#39;,...)</code>。</li></ul><p>在每次运行的事件循环之间，Node.js 检查它是否在等待任何异步 I&#x2F;O 或计时器，如果没有的话，则完全关闭。</p><h2 id="三大重点阶段"><a href="#三大重点阶段" class="headerlink" title="三大重点阶段"></a>三大重点阶段</h2><p>日常开发中的绝大部分异步任务都是在 poll、check、timers 这3个阶段处理的,所以我们来重点看看。</p><h3 id="timers（定时器）"><a href="#timers（定时器）" class="headerlink" title="timers（定时器）"></a>timers（定时器）</h3><p>timers 阶段会执行 setTimeout 和 setInterval 回调，并且是由 poll 阶段控制的。 同样，在 Node 中定时器指定的时间也不是准确时间，只能是尽快执行。</p><h3 id="poll（轮询阶段）"><a href="#poll（轮询阶段）" class="headerlink" title="poll（轮询阶段）"></a>poll（轮询阶段）</h3><p>轮询阶段 是一个至关重要的阶段，poll 阶段的执行逻辑流程图如下：<br><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/3/2/1709951e65ffe00e~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp" alt="GitHub"></p><p><strong>轮询</strong> 阶段有两个重要的功能：</p><ol><li>计算应该阻塞和轮询 I&#x2F;O 的时间。</li><li>然后，处理 <strong>轮询</strong> 队列里的事件。</li></ol><p>如果当前已经存在定时器，而且有定时器到时间了，拿出来执行，eventLoop 将回到 timers 阶段。</p><p>当事件循环进入<strong>轮询</strong>阶段且没有被调度的定时器时, 会去看回调函数队列，将发生以下两种情况：</p><ul><li>如果 poll 队列不为空，事件循环将会遍历访问回调队列并同步执行，直到队列为空或者达到系统限制</li><li>如果 poll 队列为空时，会有两件事发生<ul><li>如果有脚本被 <code>setImmediate</code> 调度（回调需要执行），则事件循环将结束 <code>poll</code> 阶段并进入到 <code>check</code> 阶段来执行那些被调度的脚本；</li><li>如果有脚本未被 <code>setImmediate</code> 调度（无需执行回调），则事件循环将会等待回调被添加到队列中并立即执行回调，<blockquote><p>这里同样会有个超时时间设置防止一直等待下去，一段时间后自动进入 <code>check</code> 阶段。</p></blockquote></li></ul></li></ul><p>一旦 <strong>轮询</strong> 队列为空，事件循环将检查 _已达到时间阈值的计时器_。如果一个或多个计时器已准备就绪，则事件循环将绕回计时器阶段以执行这些计时器的回调。</p><h3 id="check（检查阶段）"><a href="#check（检查阶段）" class="headerlink" title="check（检查阶段）"></a>check（检查阶段）</h3><p>check 阶段。这是一个比较简单的阶段，直接执行 setImmdiate 的回调。<br>此阶段允许人员在轮询阶段完成后立即执行回调。如果轮询阶段变为空闲状态，并且脚本使用 <code>setImmediate()</code> 后被排列在队列中，则事件循环可能继续到 <strong>检查</strong> 阶段而不是等待。</p><h2 id="执行流程-1"><a href="#执行流程-1" class="headerlink" title="执行流程"></a>执行流程</h2><ol><li>执行全局Script的同步代码</li><li>执行microtask微任务，先执行所有Next Tick Queue中的所有任务，再执行Other Microtask Queue中的所有任务</li><li>开始执行macrotask宏任务，共6个阶段，从第1个阶段开始执行相应每一个阶段macrotask中的所有任务，注意，这里是所有每个阶段宏任务队列的所有任务，在浏览器的Event Loop中是只取宏队列的第一个任务出来执行，每一个阶段的macrotask任务执行完毕后，开始执行微任务，也就是步骤2</li><li>Timers Queue -&gt; 步骤2 -&gt; I&#x2F;O Queue -&gt; 步骤2 -&gt; Check Queue -&gt; 步骤2 -&gt; Close Callback Queue -&gt; 步骤2 -&gt; Timers Queue ……</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;start&#x27;</span>);</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;          <span class="comment">// callback1</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">111</span>);</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;        <span class="comment">// callback2</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>);</span><br><span class="line">  &#125;, <span class="number">0</span>);</span><br><span class="line">  <span class="title function_">setImmediate</span>(<span class="function">() =&gt;</span> &#123;      <span class="comment">// callback3</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  process.<span class="title function_">nextTick</span>(<span class="function">() =&gt;</span> &#123;  <span class="comment">// callback4</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">4</span>);  </span><br><span class="line">  &#125;)</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(<span class="function">() =&gt;</span> &#123;        <span class="comment">// callback5</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">5</span>);</span><br><span class="line">  process.<span class="title function_">nextTick</span>(<span class="function">() =&gt;</span> &#123;  <span class="comment">// callback6</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">6</span>);  </span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;          <span class="comment">// callback7   </span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">7</span>);</span><br><span class="line">  process.<span class="title function_">nextTick</span>(<span class="function">() =&gt;</span> &#123;  <span class="comment">// callback8</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">8</span>);  </span><br><span class="line">  &#125;)</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">process.<span class="title function_">nextTick</span>(<span class="function">() =&gt;</span> &#123;    <span class="comment">// callback9</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">9</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;end&#x27;</span>);</span><br></pre></td></tr></table></figure><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 正确答案</span></span><br><span class="line">start -&gt; end -&gt; <span class="number">9</span> -&gt; <span class="number">1</span> -&gt; <span class="number">7</span> -&gt; <span class="number">4</span> -&gt; <span class="number">8</span> -&gt; <span class="number">5</span> -&gt; <span class="number">3</span> -&gt; <span class="number">6</span> -&gt; <span class="number">2</span></span><br></pre></td></tr></table></figure><h2 id="新版本"><a href="#新版本" class="headerlink" title="新版本"></a>新版本</h2><p>Node 在新版本中，也是每个 Macrotask 执行完后，就去执行 Microtask 了，和浏览器的模型一致。</p><p><img src="https://segmentfault.com/img/remote/1460000022213423" alt="node队列" title="node队列"></p><h1 id="setImmediate-对比-setTimeout"><a href="#setImmediate-对比-setTimeout" class="headerlink" title="setImmediate() 对比 setTimeout()"></a>setImmediate() 对比 setTimeout()</h1><p><code>setImmediate()</code> 和 <code>setTimeout()</code> 相类似，但是基于被调用的时机，存在不同表现。</p><ul><li><code>setImmediate()</code> ————在当前 <strong>轮询</strong> 阶段完成后，就执行脚本。</li><li><code>setTimeout()</code> ————在 <strong>定时器阶段</strong> 执行，在最小阈值时间（ms单位）过后执行脚本。</li></ul><p>执行计时器的顺序将根据调用它们的上下文而异。如果二者都从主模块内调用，则计时器将受进程性能的约束（这可能会受到计算机上其他正在运行应用程序的影响）。</p><p>例如，如果运行以下不在 I&#x2F;O 周期（即主模块）内的脚本，则执行两个计时器的顺序是非确定性的，因为它受进程性能的约束：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// timeout_vs_immediate.js</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;timeout&#x27;</span>);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;immediate&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ node timeout_vs_immediate.js</span><br><span class="line"><span class="built_in">timeout</span></span><br><span class="line">immediate</span><br><span class="line"></span><br><span class="line">$ node timeout_vs_immediate.js</span><br><span class="line">immediate</span><br><span class="line"><span class="built_in">timeout</span></span><br></pre></td></tr></table></figure><p>但是，如果你把这两个函数放入一个 I&#x2F;O 循环内调用，setImmediate 总是被优先调用：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// timeout_vs_immediate.js</span></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line">fs.<span class="title function_">readFile</span>(__filename, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;timeout&#x27;</span>);</span><br><span class="line">  &#125;, <span class="number">0</span>);</span><br><span class="line">  <span class="title function_">setImmediate</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;immediate&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ node timeout_vs_immediate.js</span><br><span class="line">immediate</span><br><span class="line"><span class="built_in">timeout</span></span><br><span class="line"></span><br><span class="line">$ node timeout_vs_immediate.js</span><br><span class="line">immediate</span><br><span class="line"><span class="built_in">timeout</span></span><br></pre></td></tr></table></figure><p>使用 <code>setImmediate()</code> 相对于 <code>setTimeout()</code> 的主要优势是，如果 <code>setImmediate()</code>是在 I&#x2F;O 周期内被调度的，那它将会在其中任何的定时器之前执行，跟这里存在多少个定时器无关</p><h1 id="process-nextTick-对比-setImmediate"><a href="#process-nextTick-对比-setImmediate" class="headerlink" title="process.nextTick() 对比 setImmediate()"></a>process.nextTick() 对比 setImmediate()</h1><ul><li>setImmediate(fn)的回调任务会插入到宏队列Check Queue中</li><li>process.nextTick(fn)的回调任务会插入到微队列Next Tick Queue中</li><li>process.nextTick(fn)调用深度有限制，上限是1000，而setImmedaite则没有</li></ul><h1 id="process-nextTick"><a href="#process-nextTick" class="headerlink" title="process.nextTick()"></a>process.nextTick()</h1><p><code>process.nextTick()</code> 是独立于eventLoop的任务队列，是异步 API 的一部分。</p><p>在事件循环的当前操作完成后，检查并处理 <code>nextTickQueue</code>（不管事件循环的当前阶段如何），如果里面有任务，会让这部分任务优先于微任务执行。</p><p>以下为例：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;timeout1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="title class_">Promise</span>.<span class="title function_">resolve</span>().<span class="title function_">then</span>(<span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;promise resolve&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    process.<span class="title function_">nextTick</span>(<span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;next tick1&#x27;</span>))</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;timeout2&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    process.<span class="title function_">nextTick</span>(<span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;next tick2&#x27;</span>))</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(<span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;timeout3&#x27;</span>));</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(<span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;timeout4&#x27;</span>));</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li><p>在 node11 之前，因为每一个 eventLoop 阶段完成后会去检查 nextTick 队列，如果里面有任务，会让这部分任务优先于微任务执行，因此上述代码是先进入 check 阶段，执行所有 setImmediate，完成之后执行 nextTick 队列，最后执行微任务队列</p><blockquote><p>因此输出：<code>timeout1 =&gt; timeout2 =&gt; timeout3 =&gt; timeout4 =&gt; next tick1 =&gt; next tick2 =&gt; promise resolve</code></p></blockquote></li><li><p>在 node11 之后，process.nextTick 是微任务的一种，因此上述代码是先进入 check 阶段，执行一个 setImmediate 宏任务，然后执行其微任务队列，再执行下一个宏任务及其微任务</p><blockquote><p>因此输出为：<code>timeout1 =&gt; next tick1 =&gt; promise resolve =&gt; timeout2 =&gt; next tick2 =&gt; timeout3 =&gt; timeout4</code></p></blockquote></li></ul><p>任何时候在给定的阶段中调用 <code>process.nextTick()</code>，则所有传递到 <code>process.nextTick()</code> 的回调需要先进行解析，然后继续事件循环。这可能会造成一些糟糕的情况，因为 <strong>它允许您通过递归 <code>process.nextTick()</code>调用来“饿死”I&#x2F;O</strong> ，阻止事件循环到达 <strong>轮询</strong> 阶段。</p><h1 id="node-js-和-浏览器中-eventLoop的主要区别"><a href="#node-js-和-浏览器中-eventLoop的主要区别" class="headerlink" title="node.js 和 浏览器中 eventLoop的主要区别"></a>node.js 和 浏览器中 eventLoop的主要区别</h1><p>最主要的区别在于：</p><ul><li>浏览器中的微任务是在每个相应的宏任务中执行的</li><li>node.js中的微任务是在不同阶段之间执行的</li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 异步编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 事件循环 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>package.json配置</title>
      <link href="/posts/96457dc7/"/>
      <url>/posts/96457dc7/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>每个前端项目，都有 package.json 文件，它是项目的配置文件。</p><p>常见的配置：配置项目启动、打包命令，声明依赖包等。</p><p>package.json 文件是一个 JSON 对象，该对象的每一个成员就是当前项目的一项设置。</p><p>搭建新项目时，脚手架会初始化一个 package.json 配置文件，位于项目的根目录中。当使用 <a href="https://so.csdn.net/so/search?q=react&spm=1001.2101.3001.7020">react</a> 脚手架（create-react-app）初始化一个项目时，其 package.json 文件内容如下：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;my-app&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.1.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;private&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;@testing-library/jest-dom&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^5.14.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;@testing-library/react&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^11.2.7&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;@testing-library/user-event&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^12.8.3&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;react&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^17.0.2&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;react-dom&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^17.0.2&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;react-scripts&quot;</span><span class="punctuation">:</span> <span class="string">&quot;4.0.3&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;web-vitals&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^1.1.2&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react-scripts start&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react-scripts build&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react-scripts test&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;eject&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react-scripts eject&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;eslintConfig&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;extends&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;react-app&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;react-app/jest&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;browserslist&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;production&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;&gt;0.2%&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;not dead&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;not op_mini all&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;development&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;last 1 chrome version&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;last 1 firefox version&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;last 1 safari version&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>克隆新项目到本地时，需要执行 npm install（yarn install）命令来安装项目所需的依赖文件。当执行该命令时，就会根据 package.json 文件中的配置信息来自动下载所需的模块，也就是配置项目所需的运行和开发环境。</p><p>package.json 常见配置项如下：</p><p><img src="https://img-blog.csdnimg.cn/img_convert/19a71ff8afdc6a29570e40717dd58440.png" alt="图片"></p><h2 id="必须属性"><a href="#必须属性" class="headerlink" title="必须属性"></a>必须属性</h2><p>最重要的两个字段：name 和 version。</p><p>如果没有，无法正常执行 npm install 命令。</p><p>npm 规定 package.json 文件是由名称（name）和版本号（version）作为唯一标识符。</p><h3 id="name"><a href="#name" class="headerlink" title="name"></a>name</h3><p>name ：项目的名称，是一个字符串。</p><p>命名时，需要注意：</p><ul><li>长度 ≤ 214 个字符</li><li>不能以 “.” 和“_”开头，不能包含大写字母（因为软件包在 npm 上发布时，会基于属性name获得自身URL，所以不能包含非 URL 安全字符）</li><li>尽可能的简短、语义化（因为名称作为参数被传入 require(“”)，用来导入模块）</li><li>名称不能重复（可以使用 npm view 命令查询项目名是否重复，如果不重复就会提示 404）</li></ul><p><img src="https://img-blog.csdnimg.cn/img_convert/d5fb62ca8756ea97f3fa477ca5b785bd.png" alt="图片"></p><p>如果 npm 包上有对应的包，则会显示包的详细信息：</p><p><img src="https://img-blog.csdnimg.cn/img_convert/0f0becac1c1a3fb4b72800d5060e244e.png" alt="图片"></p><p>实际上，开发的项目并不会发布在 npm 上，所以这个名称是否标准可能就不是那么重要，它不会影响项目的正常运行。如果需要发布在 npm 上，name 字段一定要符合要求。</p><h3 id="version"><a href="#version" class="headerlink" title="version"></a>version</h3><p>version ：项目的版本号，是一个字符串。</p><p>每次项目改动后，即将发布前，都要同步更改项目的版本号。</p><p>版本号的使用规范如下：</p><ul><li>版本号的命名遵循语义化版本 2.0.0 规范，格式为： <strong>「主版本号. 次版本号. 修订号」</strong> ，<ul><li>修改主版本号：做了大的功能性的改动</li><li>修改次版本号：新增了新功能</li><li>修改修订号：修复了一些 bug</li></ul></li><li>先行版本：先行版本通过会加在版本号的后面，通过 “-” 号连接以点分隔的标识符和版本编译信息：内部版本（alpha）、公测版本（beta）、候选版本（rc，即 release candiate）。</li></ul><p>可以通过以下命令来查看 npm 包的版本信息，以 react 为例：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 查看最新版本</span></span><br><span class="line">npm view react version</span><br><span class="line"><span class="comment">// 查看所有版本</span></span><br><span class="line">npm view react versions</span><br></pre></td></tr></table></figure><p>当执行第二条命令时，结果如下：</p><p><img src="https://img-blog.csdnimg.cn/img_convert/4809ab4a095e23371666ca6bed9c308c.png" alt="图片"></p><h2 id="描述信息"><a href="#描述信息" class="headerlink" title="描述信息"></a>描述信息</h2><p>有五个配置字段：描述和项目包相关的信息。</p><h3 id="description"><a href="#description" class="headerlink" title="description"></a>description</h3><p>description：描述项目包，是一个字符串。</p><p>可以让其他开发者在 npm 的搜索中发现我们的项目包。</p><h3 id="keywords"><a href="#keywords" class="headerlink" title="keywords"></a>keywords</h3><p>keywords ：一个字符串数组，表示这个项目包的关键词。</p><p>和 description 一样，用来增加项目包的曝光率。</p><p>下面以 eslint 包为例：</p><p><img src="https://img-blog.csdnimg.cn/img_convert/5d642935e8fdd8f86734123554dcd194.png" alt="图片"></p><h3 id="author"><a href="#author" class="headerlink" title="author"></a>author</h3><p>author：该项目包的作者。有两种形式。</p><p>一种是字符串格式：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;author&quot;</span>: <span class="string">&quot;CUGGZ &lt;xxxxx@xx.com&gt; (https://juejin.cn/user/3544481220801815)&quot;</span></span><br></pre></td></tr></table></figure><p>另一种是对象形式：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;author&quot;</span>: &#123;</span><br><span class="line">  <span class="string">&quot;name&quot;</span> : <span class="string">&quot;CUGGZ&quot;</span>,</span><br><span class="line">  <span class="string">&quot;email&quot;</span> : <span class="string">&quot;xxxxx@xx.com&quot;</span>,</span><br><span class="line">  <span class="string">&quot;url&quot;</span> : <span class="string">&quot;https://juejin.cn/user/3544481220801815&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="contributors"><a href="#contributors" class="headerlink" title="contributors"></a>contributors</h3><p>contributors ：该项目包的贡献者，是一个数组。</p><p>包含所有的贡献者，它同样有两种写法：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;contributors&quot;</span>: [</span><br><span class="line">  <span class="string">&quot;CUGGZ0 &lt;xxxxx@xx.com&gt; (https://juejin.cn/user/3544481220801815)&quot;</span>,</span><br><span class="line">  <span class="string">&quot;CUGGZ1 &lt;xxxxx@xx.com&gt; (https://juejin.cn/user/3544481220801815)&quot;</span></span><br><span class="line"> ]</span><br></pre></td></tr></table></figure><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;contributors&quot;</span>: [</span><br><span class="line">  &#123;</span><br><span class="line">   <span class="string">&quot;name&quot;</span> : <span class="string">&quot;CUGGZ0&quot;</span>,</span><br><span class="line">   <span class="string">&quot;email&quot;</span> : <span class="string">&quot;xxxxx@xx.com&quot;</span>,</span><br><span class="line">   <span class="string">&quot;url&quot;</span> : <span class="string">&quot;https://juejin.cn/user/3544481220801815&quot;</span></span><br><span class="line"> &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">   <span class="string">&quot;name&quot;</span> : <span class="string">&quot;CUGGZ1&quot;</span>,</span><br><span class="line">   <span class="string">&quot;email&quot;</span> : <span class="string">&quot;xxxxx@xx.com&quot;</span>,</span><br><span class="line">   <span class="string">&quot;url&quot;</span> : <span class="string">&quot;https://juejin.cn/user/3544481220801815&quot;</span></span><br><span class="line"> &#125;</span><br><span class="line"> ]</span><br></pre></td></tr></table></figure><h3 id="homepage"><a href="#homepage" class="headerlink" title="homepage"></a>homepage</h3><p>homepage：项目的主页地址，是一个字符串。</p><h3 id="repository"><a href="#repository" class="headerlink" title="repository"></a>repository</h3><p>repository：代码的存放仓库地址，通常有两种书写形式。</p><p>第一种，字符串形式：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;repository&quot;</span>: <span class="string">&quot;https://github.com/facebook/react.git&quot;</span></span><br></pre></td></tr></table></figure><p>第二种，对象形式，显式设置版本控制系统：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;repository&quot;</span>: &#123;</span><br><span class="line">  <span class="string">&quot;type&quot;</span>: <span class="string">&quot;git&quot;</span>,</span><br><span class="line">  <span class="string">&quot;url&quot;</span>: <span class="string">&quot;https://github.com/facebook/react.git&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="bugs"><a href="#bugs" class="headerlink" title="bugs"></a>bugs</h3><p>bugs：项目提交问题的地址，是一个对象。</p><p>可以添加一个提交问题的地址和反馈的邮箱：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;bugs&quot;</span>: &#123; </span><br><span class="line">  <span class="string">&quot;url&quot;</span> : <span class="string">&quot;https://github.com/facebook/react/issues&quot;</span>,</span><br><span class="line">  <span class="string">&quot;email&quot;</span> : <span class="string">&quot;xxxxx@xx.com&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最常见的 bugs 就是 Github 中的 issues 页面，如上就是 react 的 issues 页面地址。</p><h2 id="依赖配置"><a href="#依赖配置" class="headerlink" title="依赖配置"></a>依赖配置</h2><p>项目会依赖一个或者多个外部的依赖包。</p><p>根据依赖包的不同用途，可以将他们配置在下面的五个属性下：dependencies、devDependencies、peerDependencies、bundledDependencies、optionalDependencies 。</p><h3 id="dependencies"><a href="#dependencies" class="headerlink" title="dependencies"></a>dependencies</h3><p>dependencies：声明项目生产环境中必须的依赖包。</p><p>当使用 npm 或 yarn 安装 npm 包时，该 npm 包会被自动插入到此配置项中：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install <span class="tag">&lt;<span class="name">PACKAGENAME</span>&gt;</span></span><br><span class="line">yarn add <span class="tag">&lt;<span class="name">PACKAGENAME</span>&gt;</span></span><br></pre></td></tr></table></figure><p>当在安装依赖时使用 –save 参数，也会将新安装的 npm 包写入 dependencies 属性。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save <span class="tag">&lt;<span class="name">PACKAGENAME</span>&gt;</span></span><br></pre></td></tr></table></figure><p>该字段的值是一个对象，该对象的各个成员，分别由模块名和对应的版本要求组成，表示依赖的模块及其版本范围。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;dependencies&quot;</span>: &#123;</span><br><span class="line">   <span class="string">&quot;react&quot;</span>: <span class="string">&quot;^17.0.2&quot;</span>,</span><br><span class="line">   <span class="string">&quot;react-dom&quot;</span>: <span class="string">&quot;^17.0.2&quot;</span>,</span><br><span class="line">   <span class="string">&quot;react-scripts&quot;</span>: <span class="string">&quot;4.0.3&quot;</span>,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>这里每一项配置都是一个键值对（key-value）， key 表示模块名称，value 表示模块的版本号。版本号遵循 <strong>「主版本号. 次版本号. 修订号」</strong> 的格式规定：</p><ul><li><strong>「固定版本」</strong> 上面的 react-scripts 的版本 4.0.3 就是固定版本，安装时只安装这个指定的版本；</li><li><strong>「波浪号」</strong> 比如~ 4.0.3，表示安装 4.0.x 的最新版本（不低于 4.0.3），也就是说安装时不会改变主版本号和次版本号；</li><li><strong>「插入号」</strong> 比如上面 react 的版本 ^17.0.2，表示安装 17.x.x 的最新版本（不低于 17.0.2），也就是说安装时不会改变主版本号。如果主版本号为 0，那么插入号和波浪号的行为是一致的；</li><li>latest：安装最新的版本。</li></ul><p>需要注意，不要把测试或者过渡性的依赖放在 dependencies，避免生产环境出现意外的问题。</p><h3 id="devDependencies"><a href="#devDependencies" class="headerlink" title="devDependencies"></a>devDependencies</h3><p>devDependencies：声明开发阶段需要的依赖包，如 Webpack、Eslint、Babel 等，用于辅助开发。</p><p>由于只需安装在开发设备上，无需在生产环境中运行代码。</p><p>因此打包上线时不需要这些包，所以可以把这些依赖添加到 devDependencies 中，这些依赖依然会在本地指定 npm install 时被安装和管理，但是不会被安装到生产环境中。</p><p>当使用 npm 或 yarn 安装软件包时，指定以下参数后，新安装的 npm 包会被自动插入到此列表中：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install <span class="comment">--save-dev &lt;PACKAGENAME&gt;</span></span><br><span class="line">yarn <span class="keyword">add</span> <span class="comment">--dev &lt;PACKAGENAME&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;devDependencies&quot;</span>: &#123;</span><br><span class="line">  <span class="string">&quot;autoprefixer&quot;</span>: <span class="string">&quot;^7.1.2&quot;</span>,</span><br><span class="line">  <span class="string">&quot;babel-core&quot;</span>: <span class="string">&quot;^6.22.1&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="peerDependencies"><a href="#peerDependencies" class="headerlink" title="peerDependencies"></a>peerDependencies</h3><p>有些情况下，项目和所依赖的模块，都会同时依赖另一个模块，但是所依赖的版本不一样。比如，我们的项目依赖 A 模块和 B 模块的 1.0 版，而 A 模块本身又依赖 B 模块的 2.0 版。大多数情况下，这不是问题，B 模块的两个版本可以并存，同时运行。但是，有一种情况，会出现问题，就是这种依赖关系将暴露给用户。</p><p>最典型的场景就是插件，比如 A 模块是 B 模块的插件。用户安装的 B 模块是 1.0 版本，但是 A 插件只能和 2.0 版本的 B 模块一起使用。这时，用户要是将 1.0 版本的 B 的实例传给 A，就会出现问题。因此，需要一种机制，在模板安装的时候提醒用户，如果 A 和 B 一起安装，那么 B 必须是 2.0 模块。</p><p>peerDependencies：供插件指定其所需要的主工具版本。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;name&quot;</span>: <span class="string">&quot;chai-as-promised&quot;</span>,</span><br><span class="line"><span class="string">&quot;peerDependencies&quot;</span>: &#123;</span><br><span class="line">   <span class="string">&quot;chai&quot;</span>: <span class="string">&quot;1.x&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上面代码指定在安装 chai-as-promised 模块时，主程序 chai 必须一起安装，而且 chai 的版本必须是 1.x。如果项目指定的依赖是 chai 的 2.0 版本，就会报错。</p><p>需要注意，从 npm 3.0 版开始，peerDependencies 不再会默认安装了。</p><h3 id="optionalDependencies"><a href="#optionalDependencies" class="headerlink" title="optionalDependencies"></a>optionalDependencies</h3><p>如果需要在找不到包或者安装包失败时，npm 仍然能够继续运行，则可以将该包放在 optionalDependencies 对象中，optionalDependencies 对象中的包会覆盖 dependencies 中同名的包，所以只需在一个地方进行设置即可。</p><p>需要注意，由于 optionalDependencies 中的依赖可能并未安装成功，所以一定要做异常处理，否则当获取这个依赖时，如果获取不到就会报错。</p><h3 id="bundledDependencies"><a href="#bundledDependencies" class="headerlink" title="bundledDependencies"></a>bundledDependencies</h3><p>上面的几个依赖相关的配置项都是一个对象，而 bundledDependencies 配置项是一个数组，数组里可以指定一些模块，这些模块将在这个包发布时被一起打包。</p><p>需要注意，这个字段数组中的值必须是在 dependencies, devDependencies 两个里面声明过的包才行。</p><h3 id="engines"><a href="#engines" class="headerlink" title="engines"></a>engines</h3><p>当我们维护一些旧项目时，可能对 npm 包的版本或者 Node 版本有特殊要求，如果不满足条件就可能无法将项目跑起来。为了让项目开箱即用，可以在 engines 字段中说明具体的版本号：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;engines&quot;</span>: &#123;</span><br><span class="line"> <span class="string">&quot;node&quot;</span>: <span class="string">&quot;&gt;=8.10.3 &lt;12.13.0&quot;</span>,</span><br><span class="line">  <span class="string">&quot;npm&quot;</span>: <span class="string">&quot;&gt;=6.9.0&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>需要注意，engines 只是起一个说明的作用，即使用户安装的版本不符合要求，也不影响依赖包的安装。</p><h2 id="脚本配置"><a href="#脚本配置" class="headerlink" title="脚本配置"></a>脚本配置</h2><h3 id="scripts"><a href="#scripts" class="headerlink" title="scripts"></a>scripts</h3><p>scripts 是 package.json 中内置的脚本入口，是 key-value 键值对配置，key 为可运行的命令，可以通过 npm run 来执行命令。除了运行基本的 scripts 命令，还可以结合 pre 和 post 完成前置和后续操作。先来看一组 scripts：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line"> <span class="string">&quot;dev&quot;</span>: <span class="string">&quot;node index.js&quot;</span>,</span><br><span class="line">  <span class="string">&quot;predev&quot;</span>: <span class="string">&quot;node beforeIndex.js&quot;</span>,</span><br><span class="line">  <span class="string">&quot;postdev&quot;</span>: <span class="string">&quot;node afterIndex.js&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这三个 js 文件中都有一句 console：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;scripts: index.js&quot;</span>)</span><br><span class="line"><span class="comment">// beforeIndex.js</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;scripts: before index.js&quot;</span>)</span><br><span class="line"><span class="comment">// afterIndex.js</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;scripts: after index.js&quot;</span>)</span><br></pre></td></tr></table></figure><p>当我们执行 npm run dev 命令时，输出结果如下：</p><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">scripts:</span> before index.js</span><br><span class="line"><span class="symbol">scripts:</span> index.js</span><br><span class="line"><span class="symbol">scripts:</span> after index.js</span><br></pre></td></tr></table></figure><p>可以看到，三个命令都执行了，执行顺序是 predev→dev→postdev。如果 scripts 命令存在一定的先后关系，则可以使用这三个配置项，分别配置执行命令。</p><p>通过配置 scripts 属性，可以定义一些常见的操作命令：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">  <span class="string">&quot;dev&quot;</span>: <span class="string">&quot;webpack-dev-server --inline --progress --config build/webpack.dev.conf.js&quot;</span>,</span><br><span class="line">  <span class="string">&quot;start&quot;</span>: <span class="string">&quot;npm run dev&quot;</span>,</span><br><span class="line">  <span class="string">&quot;unit&quot;</span>: <span class="string">&quot;jest --config test/unit/jest.conf.js --coverage&quot;</span>,</span><br><span class="line">  <span class="string">&quot;test&quot;</span>: <span class="string">&quot;npm run unit&quot;</span>,</span><br><span class="line">  <span class="string">&quot;lint&quot;</span>: <span class="string">&quot;eslint --ext .js,.vue src test/unit&quot;</span>,</span><br><span class="line">  <span class="string">&quot;build&quot;</span>: <span class="string">&quot;node build/build.js&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这些脚本是命令行应用程序。可以通过调用 npm run XXX 或 yarn XXX 来运行它们，其中 XXX 是命令的名称。例如：npm run dev。我们可以为命令使用任何的名称，脚本也可以是任何操作。</p><p>使用好该字段可以大大的提升开发效率。</p><h3 id="config"><a href="#config" class="headerlink" title="config"></a>config</h3><p>config 字段用来配置 scripts 运行时的配置参数，如下所示：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;config&quot;</span>: &#123;</span><br><span class="line"> <span class="string">&quot;port&quot;</span>: <span class="number">3000</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果运行 npm run start，则 port 字段会映射到 <code>npm_package_config_port</code>环境变量中：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(process.<span class="property">env</span>.<span class="property">npm_package_config_port</span>) <span class="comment">// 3000</span></span><br></pre></td></tr></table></figure><p>用户可以通过 <code>npm config set foo:port 3001</code> 命令来重写 port 的值。</p><h2 id="文件-amp-目录"><a href="#文件-amp-目录" class="headerlink" title="文件 &amp; 目录"></a>文件 &amp; 目录</h2><p>与文件、目录相关的属性。</p><h3 id="main"><a href="#main" class="headerlink" title="main"></a>main</h3><p>main：指定加载的入口文件，在 browser 和 Node 环境中都可以使用。</p><p>如果将项目发布为 npm 包，那么当使用 require 导入 npm 包时，返回的就是 main 字段所列出的文件的 module.exports 属性。</p><p>如果不指定该字段，默认是项目根目录下的 index.js。如果没找到，就会报错。</p><p>该字段的值是一个字符串：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;main&quot;</span>: <span class="string">&quot;./src/index.js&quot;</span>,</span><br></pre></td></tr></table></figure><h3 id="browser"><a href="#browser" class="headerlink" title="browser"></a>browser</h3><p>browser：定义 npm 包在 browser 环境下的入口文件。</p><p>如果 npm 包只在 web 端使用，并且严禁在 server 端使用，使用 browser 来定义入口文件。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;browser&quot;</span>: <span class="string">&quot;./src/index.js&quot;</span> </span><br></pre></td></tr></table></figure><h3 id="module"><a href="#module" class="headerlink" title="module"></a>module</h3><p>module：定义 npm 包的 ESM 规范的入口文件，browser 环境和 node 环境均可使用。</p><p>如果 npm 包导出的是 ESM 规范的包，使用 module 来定义入口文件。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;module&quot;</span>: <span class="string">&quot;./src/index.mjs&quot;</span>,</span><br></pre></td></tr></table></figure><p>需要注意，.js 文件是使用 commonJS 规范的语法 (require(‘xxx’))，.mjs 是用 ESM 规范的语法 (import ‘xxx’)。</p><p>上面三个的入口入口文件相关的配置是有差别的，特别是在不同的使用场景下。</p><p>在 Web 环境中，如果使用 loader 加载 ESM（ES module），那么这三个配置的加载顺序是 browser→module→main，如果使用 require 加载 CommonJS 模块，则加载的顺序为 main→module→browser。</p><p>Webpack 在进行项目构建时，有一个 target 选项，默认为 Web，即构建 Web 应用。</p><p>如果需要编译一些同构项目，如 node 项目，则只需将 webpack.config.js 的 target 选项设置为 node 进行构建即可。</p><p>如果在 Node 环境中加载 CommonJS 模块，或者 ESM，则只有 main 字段有效。</p><h3 id="bin"><a href="#bin" class="headerlink" title="bin"></a>bin</h3><p>bin：指定各个内部命令对应的可执行文件的位置：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;bin&quot;</span>: &#123;</span><br><span class="line">  <span class="string">&quot;someTool&quot;</span>: <span class="string">&quot;./bin/someTool.js&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里，someTool 命令对应的可执行文件为 bin 目录下的 someTool.js，someTool.js 会建立符号链接 node_modules&#x2F;.bin&#x2F;someTool。由于 node_modules&#x2F;.bin &#x2F; 目录会在运行时加入系统的 PATH 变量，因此在运行 npm 时，就可以不带路径，直接通过命令来调用这些脚本。因此，下面的写法可以简写：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">scripts: &#123;  </span><br><span class="line">  start: <span class="string">&#x27;./node_modules/bin/someTool.js build&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 简写</span><br><span class="line">scripts: &#123;  </span><br><span class="line">  start: <span class="string">&#x27;someTool build&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>所有 node_modules&#x2F;.bin &#x2F; 目录下的命令，都可以用 npm run [命令] 的格式运行。</p><p>上面的配置在 package.json 包中提供了一个映射到本地文件名的 bin 字段，之后 npm 包将链接这个文件到 prefix&#x2F;fix 里面，以便全局引入。或者链接到本地的 node_modules&#x2F;.bin &#x2F; 文件中，以便在本项目中使用。</p><h3 id="files"><a href="#files" class="headerlink" title="files"></a>files</h3><p>files 配置是一个数组，用来描述当把 npm 包作为依赖包安装时需要说明的文件列表。当 npm 包发布时，files 指定的文件会被推送到 npm 服务器中，如果指定的是文件夹，那么该文件夹下面所有的文件都会被提交。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;files&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;LICENSE&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Readme.md&quot;</span>,</span><br><span class="line">    <span class="string">&quot;index.js&quot;</span>,</span><br><span class="line">    <span class="string">&quot;lib/&quot;</span></span><br><span class="line"> ]</span><br></pre></td></tr></table></figure><p>如果有不想提交的文件，可以在项目根目录中新建一个. npmignore 文件，并在其中说明不需要提交的文件，防止垃圾文件推送到 npm 上。这个文件的形式和. gitignore 类似。写在这个文件中的文件即便被写在 files 属性里也会被排除在外。比如可以在该文件中这样写：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">node_modules</span><br><span class="line">.vscode</span><br><span class="line"></span><br><span class="line">build</span><br><span class="line"></span><br><span class="line">.DS_Store</span><br></pre></td></tr></table></figure><h3 id="man"><a href="#man" class="headerlink" title="man"></a>man</h3><p>man 命令是 Linux 中的帮助指令，通过该指令可以查看 Linux 中的指令帮助、配置文件帮助和编程帮助等信息。如果 node.js 模块是一个全局的命令行工具，在 package.json 通过 man 属性可以指定 man 命令查找的文档地址：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;man&quot;</span>: [</span><br><span class="line"> <span class="string">&quot;./man/npm-access.1&quot;</span>,</span><br><span class="line"> <span class="string">&quot;./man/npm-audit.1&quot;</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>man 字段可以指定一个或多个文件, 当执行 man {包名} 时, 会展现给用户文档内容。</p><p>需要注意：</p><ul><li>man 文件必须以数字结尾，如果经过压缩，还可以使用. gz 后缀。这个数字表示文件安装到哪个 man 节中；</li><li>如果 man 文件名称不是以模块名称开头的，安装的时候会加上模块名称前缀。</li></ul><p>对于上面的配置，可以使用以下命令来执行查看文档：</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">man <span class="built_in">npm</span>-access</span><br><span class="line">man <span class="built_in">npm</span>-audit</span><br></pre></td></tr></table></figure><h3 id="directories"><a href="#directories" class="headerlink" title="directories"></a>directories</h3><p>directories 字段用来规范项目的目录。node.js 模块是基于 CommonJS 模块化规范实现的，需要严格遵循 CommonJS 规范。模块目录下除了必须包含包项目描述文件 package.json 以外，还需要包含以下目录：</p><ul><li>bin ：存放可执行二进制文件的目录</li><li>lib ：存放 js 代码的目录</li><li>doc ：存放文档的目录</li><li>test ：存放单元测试用例代码的目录</li><li>…</li></ul><p>在实际的项目目录中，我们可能没有按照这个规范进行命名，那么就可以在 directories 字段指定每个目录对应的文件路径：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;directories&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;bin&quot;</span>: <span class="string">&quot;./bin&quot;</span>,</span><br><span class="line">    <span class="string">&quot;lib&quot;</span>: <span class="string">&quot;./lib&quot;</span>,</span><br><span class="line">    <span class="string">&quot;doc&quot;</span>: <span class="string">&quot;./doc&quot;</span>,</span><br><span class="line">    <span class="string">&quot;test&quot;</span> <span class="string">&quot;./test&quot;</span>,</span><br><span class="line">    <span class="string">&quot;man&quot;</span>: <span class="string">&quot;./man&quot;</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>这个属性实际上没有什么实际的作用，当然不排除未来会有什么比较有意义的用处。</p><h2 id="发布配置"><a href="#发布配置" class="headerlink" title="发布配置"></a>发布配置</h2><p>下面来看看和 npm 项目包发布相关的配置。</p><h3 id="private"><a href="#private" class="headerlink" title="private"></a>private</h3><p>private 字段可以防止我们意外地将私有库发布到 npm 服务器。只需要将该字段设置为 true：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;private&quot;</span>: <span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="preferGlobal"><a href="#preferGlobal" class="headerlink" title="preferGlobal"></a>preferGlobal</h3><p>preferGlobal 字段表示当用户不把该模块安装为全局模块时，如果设置为 true 就会显示警告。它并不会真正的防止用户进行局部的安装，只是对用户进行提示，防止产生误解：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;preferGlobal&quot;</span>: <span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="publishConfig"><a href="#publishConfig" class="headerlink" title="publishConfig"></a>publishConfig</h3><p>publishConfig 配置会在模块发布时生效，用于设置发布时一些配置项的集合。如果不想模块被默认标记为最新，或者不想发布到公共仓库，可以在这里配置 tag 或仓库地址。更详细的配置可以参考 npm-config[1]。</p><p>通常情况下，publishConfig 会配合 private 来使用，如果只想让模块发布到特定 npm 仓库，就可以这样来配置：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;private&quot;</span>: <span class="literal">true</span>,</span><br><span class="line"><span class="string">&quot;publishConfig&quot;</span>: &#123;</span><br><span class="line">  <span class="string">&quot;tag&quot;</span>: <span class="string">&quot;1.1.0&quot;</span>,</span><br><span class="line">  <span class="string">&quot;registry&quot;</span>: <span class="string">&quot;https://registry.npmjs.org/&quot;</span>,</span><br><span class="line">  <span class="string">&quot;access&quot;</span>: <span class="string">&quot;public&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-os"><a href="#4-os" class="headerlink" title="4. os"></a>4. os</h3><p>os 字段可以让我们设置该 npm 包可以在什么操作系统使用，不能再什么操作系统使用。如果我们希望开发的 npm 包只运行在 linux，为了避免出现不必要的异常，建议使用 Windows 系统的用户不要安装它，这时就可以使用 os 配置：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;os&quot;</span> [<span class="string">&quot;linux&quot;</span>]   <span class="comment">// 适用的操作系统</span></span><br><span class="line"><span class="string">&quot;os&quot;</span> [<span class="string">&quot;!win32&quot;</span>]  <span class="comment">// 禁用的操作系统</span></span><br></pre></td></tr></table></figure><h3 id="cpu"><a href="#cpu" class="headerlink" title="cpu"></a>cpu</h3><p>该配置和 OS 配置类似，用 CPU 可以更准确的限制用户的安装环境：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;cpu&quot;</span> [<span class="string">&quot;x64&quot;</span>, <span class="string">&quot;AMD64&quot;</span>]   <span class="comment">// 适用的cpu</span></span><br><span class="line"><span class="string">&quot;cpu&quot;</span> [<span class="string">&quot;!arm&quot;</span>, <span class="string">&quot;!mips&quot;</span>]  <span class="comment">// 禁用的cpu</span></span><br></pre></td></tr></table></figure><p>可以看到，黑名单和白名单的区别就是，黑名单在前面加了一个 “!”。</p><h3 id="license"><a href="#license" class="headerlink" title="license"></a>license</h3><p>license 字段用于指定软件的开源协议，开源协议表述了其他人获得代码后拥有的权利，可以对代码进行何种操作，何种操作又是被禁止的。常见的协议如下：</p><ul><li>MIT ：只要用户在项目副本中包含了版权声明和许可声明，他们就可以拿你的代码做任何想做的事情，你也无需承担任何责任。</li><li>Apache ：类似于 MIT ，同时还包含了贡献者向用户提供专利授权相关的条款。</li><li>GPL ：修改项目代码的用户再次分发源码或二进制代码时，必须公布他的相关修改。</li></ul><p>可以这样来声明该字段：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;license&quot;</span>: <span class="string">&quot;MIT&quot;</span></span><br></pre></td></tr></table></figure><h2 id="第三方配置"><a href="#第三方配置" class="headerlink" title="第三方配置"></a>第三方配置</h2><p>package.json 文件还可以承载命令特有的配置，例如 Babel、ESLint 等。它们每个都有特有的属性，例如 eslintConfig、babel 等。它们是命令特有的，可以在相应的命令 &#x2F; 项目文档中找到如何使用它们。下面来看几个常用的第三方配置项。</p><h3 id="typings"><a href="#typings" class="headerlink" title="typings"></a>typings</h3><p>typings 字段用来指定 TypeScript 的入口文件：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;typings&quot;</span>: <span class="string">&quot;types/index.d.ts&quot;</span>,</span><br></pre></td></tr></table></figure><p>该字段的作用和 main 配置相同。</p><h3 id="eslintConfig"><a href="#eslintConfig" class="headerlink" title="eslintConfig"></a>eslintConfig</h3><p>eslint 的配置可以写在单独的配置文件. eslintrc.json 中，也可以写在 package.json 文件的 eslintConfig 配置项中。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;eslintConfig&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;root&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;env&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;node&quot;</span>: <span class="literal">true</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="string">&quot;extends&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;plugin:vue/essential&quot;</span>,</span><br><span class="line">        <span class="string">&quot;eslint:recommended&quot;</span></span><br><span class="line">      ],</span><br><span class="line">      <span class="string">&quot;rules&quot;</span>: &#123;&#125;,</span><br><span class="line">      <span class="string">&quot;parserOptions&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;parser&quot;</span>: <span class="string">&quot;babel-eslint&quot;</span></span><br><span class="line">     &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="babel"><a href="#babel" class="headerlink" title="babel"></a>babel</h3><p>babel 用来指定 Babel 的编译配置，代码如下：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;babel&quot;</span>: &#123;</span><br><span class="line"> <span class="string">&quot;presets&quot;</span>: [<span class="string">&quot;@babel/preset-env&quot;</span>],</span><br><span class="line"> <span class="string">&quot;plugins&quot;</span>: [...]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="unpkg"><a href="#unpkg" class="headerlink" title="unpkg"></a>unpkg</h3><p>使用该字段可以让 npm 上所有的文件都开启 cdn 服务，该 CND 服务由 unpkg 提供：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;unpkg&quot;</span>: <span class="string">&quot;dist/vue.js&quot;</span></span><br></pre></td></tr></table></figure><h3 id="lint-staged"><a href="#lint-staged" class="headerlink" title="lint-staged"></a>lint-staged</h3><p>lint-staged 是一个在 Git 暂存文件上运行 linters 的工具，配置后每次修改一个文件即可给所有文件执行一次 lint 检查，通常配合 gitHooks 一起使用。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;lint-staged&quot;</span>: &#123;</span><br><span class="line"> <span class="string">&quot;*.js&quot;</span>: [</span><br><span class="line">   <span class="string">&quot;eslint --fix&quot;</span>,</span><br><span class="line">    <span class="string">&quot;git add&quot;</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用 lint-staged 时，每次提交代码只会检查当前改动的文件。</p><h3 id="gitHooks"><a href="#gitHooks" class="headerlink" title="gitHooks"></a>gitHooks</h3><p>gitHooks 用来定义一个钩子，在提交（commit）之前执行 ESlint 检查。在执行 lint 命令后，会自动修复暂存区的文件。修复之后的文件并不会存储在暂存区，所以需要用 git add 命令将修复后的文件重新加入暂存区。在执行 pre-commit 命令之后，如果没有错误，就会执行 git commit 命令：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;gitHooks&quot;</span>: &#123;</span><br><span class="line"> <span class="string">&quot;pre-commit&quot;</span>: <span class="string">&quot;lint-staged&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里就是配合上面的 lint-staged 来进行代码的检查操作。</p><h3 id="browserslist"><a href="#browserslist" class="headerlink" title="browserslist"></a>browserslist</h3><p>browserslist 字段用来告知支持哪些浏览器及版本。Babel、Autoprefixer 和其他工具会用到它，以将所需的 polyfill 和 fallback 添加到目标浏览器。比如最上面的例子中的该字段值：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;browserslist&quot;</span>: &#123;</span><br><span class="line">  <span class="string">&quot;production&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;&gt;0.2%&quot;,</span></span><br><span class="line"><span class="string">    &quot;</span><span class="keyword">not</span> dead<span class="string">&quot;,</span></span><br><span class="line"><span class="string">    &quot;</span><span class="keyword">not</span> op_mini all<span class="string">&quot;</span></span><br><span class="line"><span class="string">  ],</span></span><br><span class="line"><span class="string">  &quot;</span>development<span class="string">&quot;: [</span></span><br><span class="line"><span class="string">    &quot;</span><span class="keyword">last</span> <span class="number">1</span> chrome version<span class="string">&quot;,</span></span><br><span class="line"><span class="string">    &quot;</span><span class="keyword">last</span> <span class="number">1</span> firefox version<span class="string">&quot;,</span></span><br><span class="line"><span class="string">    &quot;</span><span class="keyword">last</span> <span class="number">1</span> safari version<span class="string">&quot;</span></span><br><span class="line"><span class="string">  ]</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure><p>这里指定了一个对象，里面定义了生产环境和开发环境的浏览器要求。上面的 development 就是指定开发环境中支持最后一个版本的 chrome、Firefox、safari 浏览器。这个属性是不同的前端工具之间共用目标浏览器和 node 版本的配置工具，被很多前端工具使用，比如 Babel、Autoprefixer 等。</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> 配置文件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> packageJS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue个人学习之路</title>
      <link href="/posts/8769c46b/"/>
      <url>/posts/8769c46b/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>将 Vue.js 添加到项目中主要有四种方式：</p><ol><li>在页面上以 <a href="https://v3.cn.vuejs.org/guide/installation.html#cdn">CDN 包</a>的形式导入。</li><li>下载 JavaScript 文件并<a href="https://v3.cn.vuejs.org/guide/installation.html#%E4%B8%8B%E8%BD%BD%E5%B9%B6%E8%87%AA%E6%89%98%E7%AE%A1">自行托管</a>。</li><li>使用 <a href="https://v3.cn.vuejs.org/guide/installation.html#npm">npm</a> 安装它。</li><li>使用官方的 <a href="https://v3.cn.vuejs.org/guide/installation.html#%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7-cli">CLI</a> 来构建一个项目，它为现代前端工作流程提供了功能齐备的构建设置 (例如，热重载、保存时的提示等等)。</li></ol><p>在使用 Vue 时，推荐在浏览器上安装 <a href="https://github.com/vuejs/vue-devtools#vue-devtools">Vue Devtools</a>，允许在一个更友好的界面中审查和调试 Vue 应用。</p><h2 id="npm"><a href="#npm" class="headerlink" title="npm"></a>npm</h2><p>在用 Vue 构建大型应用时推荐使用 npm 安装。npm 能很好地和诸如 <a href="https://webpack.js.org/">webpack</a> 或 <a href="https://rollupjs.org/">Rollup</a> 模块打包器配合使用。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 最新稳定版</span></span><br><span class="line">$ npm install vue@next</span><br></pre></td></tr></table></figure><p>Vue 还提供了编写<a href="https://v3.cn.vuejs.org/guide/single-file-component.html">单文件组件</a>的配套工具。如果你想使用单文件组件，那么你还需要安装 <code>@vue/compiler-sfc</code>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -D @vue/compiler-sfc</span><br></pre></td></tr></table></figure><h2 id="命令行工具-CLI"><a href="#命令行工具-CLI" class="headerlink" title="命令行工具 (CLI)"></a>命令行工具 (CLI)</h2><p>Vue 提供<a href="https://cli.vuejs.org/zh/">CLI</a>，为单页面应用 (SPA) 快速搭建脚手架。它为现代前端工作流提供了功能齐备的构建设置。</p><p>运行所需时间短，带有热重载、保存时 lint 校验。</p><p>详情查阅 <a href="https://cli.vuejs.org/zh/">Vue CLI 的文档</a>。</p><blockquote><p>TIP</p><p>CLI 工具假定用户对 Node.js 和相关构建工具有一定程度的了解。如果你是新手，我们强烈建议先在不用构建工具的情况下通读<a href="https://v3.cn.vuejs.org/guide/introduction.html">指南</a>，在熟悉 Vue 本身之后再使用 CLI。</p></blockquote><p>对于 Vue 3，你应该使用 <code>npm</code> 上可用的 Vue CLI v4.5 作为 <code>@vue/cli</code>。要升级，你应该需要全局重新安装最新版本的 <code>@vue/cli</code>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yarn global add @vue/cli</span><br><span class="line"><span class="comment"># 或</span></span><br><span class="line">npm install -g @vue/cli</span><br></pre></td></tr></table></figure><p>然后在 Vue 项目中运行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vue upgrade --next</span><br></pre></td></tr></table></figure><h2 id="Vite"><a href="#Vite" class="headerlink" title="Vite"></a>Vite</h2><p><a href="https://cn.vitejs.dev/">Vite</a> 是一个 web 开发构建工具，由于其原生 ES 模块导入方式，可以实现闪电般的冷服务器启动。</p><p>通过在终端中运行以下命令，可以使用 Vite 快速构建 Vue 项目。</p><p>使用 npm：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># npm 6.x</span></span><br><span class="line">$ npm init vite@latest &lt;project-name&gt; --template vue</span><br><span class="line"></span><br><span class="line"><span class="comment"># npm 7+，需要加上额外的双短横线</span></span><br><span class="line">$ npm init vite@latest &lt;project-name&gt; -- --template vue</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cd</span> &lt;project-name&gt;</span><br><span class="line">$ npm install</span><br><span class="line">$ npm run dev</span><br></pre></td></tr></table></figure><p>或者 yarn：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ yarn create vite &lt;project-name&gt; --template vue</span><br><span class="line">$ <span class="built_in">cd</span> &lt;project-name&gt;</span><br><span class="line">$ yarn</span><br><span class="line">$ yarn dev</span><br></pre></td></tr></table></figure><p>或者 pnpm:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ pnpm create vite &lt;project-name&gt; -- --template vue</span><br><span class="line">$ <span class="built_in">cd</span> &lt;project-name&gt;</span><br><span class="line">$ pnpm install</span><br><span class="line">$ pnpm dev</span><br></pre></td></tr></table></figure><h2 id="对不同构建版本的解释"><a href="#对不同构建版本的解释" class="headerlink" title="对不同构建版本的解释"></a>对不同构建版本的解释</h2><p>在 <a href="https://cdn.jsdelivr.net/npm/vue@3.0.2/dist/">npm 包的 dist&#x2F; 目录</a>你将会找到很多不同的 Vue.js 构建版本。下面是一个概述，根据不同的使用情况，应该使用哪个 <code>dist</code> 文件：</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue3中文文档</title>
      <link href="/posts/54132e49/"/>
      <url>/posts/54132e49/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h2><ol><li><a href="/posts/20c039b5/" title="Vue简介">Vue简介</a></li><li></li><li><a href="/posts/dd9187b4/" title="Vue快速开始">Vue快速开始</a></li></ol><h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h2><ol><li>创建Vue应用</li><li>模板语法</li><li>响应式基础</li><li>计算属性</li><li>类与样式绑定</li><li>条件渲染</li><li>列表渲染</li><li>事件处理</li><li>表单输入绑定</li><li>生命周期钩子</li><li>侦听器</li><li>模板ref</li><li>组件基础</li></ol><h2 id="深入组件"><a href="#深入组件" class="headerlink" title="深入组件"></a>深入组件</h2><ol><li>组件注册</li><li>Props</li><li>组件事件</li><li>透传attribute</li><li>插槽</li><li>依赖注入</li><li>异步组件</li></ol><h2 id="可重用性"><a href="#可重用性" class="headerlink" title="可重用性"></a>可重用性</h2><ol><li>可组合函数</li><li>自定义指令</li><li>插件</li></ol><h2 id="内置组件"><a href="#内置组件" class="headerlink" title="内置组件"></a>内置组件</h2><ol><li>Transition</li><li>TransitionGroup</li><li>KeepAlive</li><li>Teleport</li><li>Suspense</li></ol><h2 id="升级规模"><a href="#升级规模" class="headerlink" title="升级规模"></a>升级规模</h2><ol><li>单文件组件</li><li>工具链</li><li>路由</li><li>状态管理</li><li>测试</li><li>服务端渲染(SSR)</li></ol><h2 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h2><ol><li>生产环境部署</li><li>性能</li><li>无障碍访问</li><li>安全</li></ol><h2 id="与TS"><a href="#与TS" class="headerlink" title="与TS"></a>与TS</h2><ol><li>搭配TypeScript 使用 Vue</li><li>TypeScript 与组合式 API</li><li>TypeScript 与选项式 API</li></ol><h2 id="进阶"><a href="#进阶" class="headerlink" title="进阶"></a>进阶</h2><ol><li>多种方式使用Vue</li><li>组合式API FAQ</li><li>深入响应式系统</li><li>渲染机制</li><li>渲染函数&amp; JSX</li></ol>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d11a905a44ce4472971eb60059925bbc~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="9.5渲染函数 &amp; JSX.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/438d00c6d3704be09dccc28e7659336a~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="9.4渲染机制.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ee7f26b79e594314b0ed7dae6ec99120~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="9.3深入响应式系统.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/26500ad14a9b40468abd6248f0e19ca5~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="9.2组合式 API FAQ.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f8fd87c89b194002917d3168ccfc2450~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="9.1多种方式使用 Vue.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/96eee769dd5f479c9b999560cf90ec1d~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="8.3TypeScript 与选项式 API.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fe3f507807a641708d139148424da0d8~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="8.2TypeScript 与组合式 API.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e9c80b2390154e69bd2eebf47941fd1b~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="8.1搭配 TypeScript 使用 Vue.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fd66c99a76304ec29f032553413e9d9a~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="7.4安全.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9531e87f22004c19b0aa12f0d64436d7~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="7.3无障碍访问.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/232fcbe7d45b4930b6f42625e83e3650~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="7.2性能.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e6667affa8c74eaebecf9c1a30d6a0b3~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="7.1生产环境部署.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/31d41f0649534d7688ba5c5b1f4ef22d~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="6.6服务端渲染 (SSR).png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a3b9daf80f134560a8e746fa9bddb2cf~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="6.5测试.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/086c50b3380d4c85abe2f2e3ccf48fe8~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="6.4状态管理.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0bec5741659e433ca695047629773092~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="6.3路由.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/067b1857dd5742dda8e92e345fdab17c~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="6.2工具链.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bba871a4b16142b3937d7086841bdea5~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="6.1单文件组件.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d4db4b74bb5040859cb108eec340ac90~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="5.5Suspense.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2a38ad082cd9403cb9d56469db3033d9~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="5.4Teleport·传送门.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/781a77a78ed84adc8d1af7db675970c9~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="5.3KeepAlive.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/46e203bd6cfb4d18b6de640e7b9b1745~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="5.2TransitionGroup·过渡组.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/50acf192292f48ebbccfbc71f1314f89~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="5.1Transition·过渡.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/420274900423488683c4bc7cab9d7f51~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="4.3插件.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/eda3751a9fcb48ef8cbf06f7b175ef53~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="4.2自定义指令.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/92d9c987fdff4577ac50d8fc09df5b72~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="4.1可组合函数.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c64a9837f07848aaa2e244914f713563~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="3.7异步组件.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f88cd79997604105bb8edcbc3d094cc0~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="3.6依赖注入.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bc59c0360e89499b8fb32d64618f22d3~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="3.5插槽.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b23a7ecfd1d044f3a7c86d55723a2a90~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="3.4透传 attribute.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/078a5fc679ef459898055a0e3a99119a~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="3.3组件事件.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/91d7ee6b017649f580eb5ee0cedf0fbc~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="3.2Props.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dc704843e57b46e484943ea266ca4d69~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="3.1组件注册.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e7c7b000970d4b31badd6536a3f594e5~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="2.13组件基础.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3d79dff8b6cc44d492dc8a99d6843b1c~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="2.12模板 ref.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cb7d2d11916c43749364e04264e6c9b8~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="2.11侦听器.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bc17a34fcc9f479895ef593fd2ef4f00~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="2.10生命周期钩子.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8205c61dc80e490b80f8861ff4d3ca6c~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="2.9表单输入绑定.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/deb0102443ab40e9ad4de9786f0f1308~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="2.8事件处理.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ea77c91b482d40da8f1ff13a3a192d04~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="2.7列表渲染.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6fff91c14e9e4c2e842b3e6098206ca5~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="2.6条件渲染.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1b8c90ff4b1a487c8f1ea56096f832ed~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="2.5类与样式绑定.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e8acf74314d14580964f6a10689b03c4~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="2.4计算属性.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/38b481a4e39f4344a3014b511423e4d0~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="2.3响应式基础.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0eb2cfb6eab14381b975fbdd0f994423~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="2.2模板语法.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/165d1b6f30f346d79f9c8f57fcb6db3b~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="2.1创建 Vue 应用.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Vue快速开始</title>
      <link href="/posts/dd9187b4/"/>
      <url>/posts/dd9187b4/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/38ed042f7ec94fc6a22d1c8da152b035~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="1.2快速开始.png"></p>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue简介</title>
      <link href="/posts/20c039b5/"/>
      <url>/posts/20c039b5/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/55770bbc83b54d4a81a14a5be715794f~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="1.1简介.png"></p>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>创建并初始化Vue实例</title>
      <link href="/posts/35b9d843/"/>
      <url>/posts/35b9d843/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue3.0开发高质量音乐Web app</title>
      <link href="/posts/38edd151/"/>
      <url>/posts/38edd151/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="课程简介"><a href="#课程简介" class="headerlink" title="课程简介"></a>课程简介</h2><ul><li>课程实用指南</li><li>课前必读（源码获取方式）</li></ul><h2 id="项目初始化和推荐页面开发"><a href="#项目初始化和推荐页面开发" class="headerlink" title="项目初始化和推荐页面开发"></a>项目初始化和推荐页面开发</h2><p>本章从项目的初始化开始，介绍了项目是如何初始化的，然后带你编写页面的基础骨架，初始化基础路由。随后教你如何注册后端接口路由来获取数据，带你开发轮播图组件、基础滚动组件以及自定义指令v-loading。</p><ol><li>使用脚手架工具创建项目</li><li>脚手架生成代码介绍</li><li>项目基础代码编写</li><li>Tab组件实现</li><li>获取轮播图接口数据</li><li>轮播图组件的开发</li><li>轮播图组件的使用</li><li>歌单列表实现&amp;滚动组件的封装</li><li>图片懒加载的实现</li><li>v-loading自定义指令的开发</li><li>v-loading自定义指令的优化</li></ol><h2 id="歌手页面开发"><a href="#歌手页面开发" class="headerlink" title="歌手页面开发"></a>歌手页面开发</h2><p>本章会带你开发歌手页面，从获取歌手列表数据开始，编写IndexList索引列表组件，并实现列表固定标题和列表快速导航入口的功能。</p><ol><li>歌手列表数据获取</li><li>IndexList组件基础滚动功能实现</li><li>歌手列表固定标题实现</li><li>歌手列表快速导航入口实现</li></ol><h2 id="歌手详情页开发"><a href="#歌手详情页开发" class="headerlink" title="歌手详情页开发"></a>歌手详情页开发</h2><p>本章会带你开发歌手详情页面，从获取歌曲列表数据和歌曲url开始，编写MusicList组件展示歌手详情，并且实现滚动交互、路由过渡动画效果。带你初次体验Vuex的应用，设计Vuex的数据。</p><ol><li>歌手详情页歌曲列表数据获取</li><li>歌手详情页批量获取歌曲url</li><li>歌手详情页MusicList组件基础代码编写</li><li>歌手详情页MusicList组件功能交互优化</li><li>歌手详情页支持详情页刷新</li><li>歌手详情页路由过渡效果实现</li><li>歌手详情页边界情况处理</li><li>歌手详情页歌曲列表点击以及vuex的应用</li><li>歌手详情页歌曲列表实现随机播放</li></ol><h2 id="播放器内核组件开发"><a href="#播放器内核组件开发" class="headerlink" title="播放器内核组件开发"></a>播放器内核组件开发</h2><p>本章会带你开发最核心的播放器组件，包括播放器的基础样式和歌曲播放功能开发、前进后退、暂停、播放模式切换等逻辑开发、歌曲收藏功能开发。然后带你开发进度组件、歌词相关逻辑、cd唱片旋转逻辑、手指交互逻辑。接着带你开发mini播放器、圆形进度条组件，实现全屏切换过渡效果、左右滑动切换歌曲等功能。</p><ol><li>播放器基础样式及歌曲播放功能开发</li><li>播放器播放按钮的暂停与播放逻辑开发</li><li>播放器歌曲前进与后退逻辑开发</li><li>播放器DOM异常错误处理</li><li>播放器歌曲播放模式相关逻辑开发</li><li>播放器歌曲收藏功能相关逻辑开发</li><li>播放器进度条相关逻辑开发</li><li>播放器cd唱片旋转相关逻辑开发</li><li>播放器歌词相关逻辑开发</li><li>播放器中间视图层手指交互相关逻辑开发</li><li>播放器mini播放器开发</li><li>播放器全屏切换过渡效果实现</li><li>播放器播放列表组件实现</li><li>播放器滚动列表高度自适应</li><li>播放器高阶Scroll组件的实现</li></ol><h2 id="歌单详情页与排行榜页面开发"><a href="#歌单详情页与排行榜页面开发" class="headerlink" title="歌单详情页与排行榜页面开发"></a>歌单详情页与排行榜页面开发</h2><p>本章会带你开发歌单详情页和排行榜页面，教你如何在相似功能中实现组件的复用和进一步的抽象。</p><ol><li>歌单详情页开发</li><li>排行榜页面开发</li><li>排行榜详情页开发</li></ol><h2 id="搜索页面开发"><a href="#搜索页面开发" class="headerlink" title="搜索页面开发"></a>搜索页面开发</h2><p>本章会带你开发搜索页面，包括搜索框组件的开发、热门搜索模块的开发、Suggest组件开发、搜素历史功能的开发，让你学会移动端常见的上拉加载的交互实现，以及更多的交互细节和边界情况的处理。</p><ol><li>搜索页面搜索框开发</li><li>搜索页面热门搜索开发</li><li>搜索页面Suggest组件开发</li><li>搜索页面搜索历史功能开发</li></ol><h2 id="添加歌曲与用户中心页面开发"><a href="#添加歌曲与用户中心页面开发" class="headerlink" title="添加歌曲与用户中心页面开发"></a>添加歌曲与用户中心页面开发</h2><p>本章会带你开发添加歌曲到列表功能以及用户中心页面功能，进一步完善页面的功能，至此，音乐播放器全部功能开发完毕。</p><ol><li>添加歌曲到列表功能开发</li><li>用户中心页面开发</li></ol><h2 id="性能优化与项目部署"><a href="#性能优化与项目部署" class="headerlink" title="性能优化与项目部署"></a>性能优化与项目部署</h2><p>本章会带你对项目做性能分析，并做一定的性能优化，包括Keep-alive组件的应用和路由组件的异步加载。</p><ol><li>keep-alive组件应用</li><li>路由组件异步加载</li><li>项目部署</li></ol>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue核心技术（Vue+Vue-Router+Vuex+SSR）</title>
      <link href="/posts/5324204b/"/>
      <url>/posts/5324204b/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>课程介绍</strong><br>课程介绍，介绍课程的章节安排和学习本门课程的一些注意点。</p><ul><li>Webpack4升级注意</li><li>项目运行报错最新问题总结</li><li>补充Webpack4.29升级</li><li>补充vue-loader15.6.2.升级</li></ul><h5 id="Vue-Webpack的前端工程工作流搭建"><a href="#Vue-Webpack的前端工程工作流搭建" class="headerlink" title="Vue+Webpack的前端工程工作流搭建"></a><strong>Vue+Webpack的前端工程工作流搭建</strong></h5><p>详细讲解webpack的配置以及vue-loader，css-module等较为高级的内容如何进行配置。</p><ul><li>项目目录升级-一个正式项目的目录结构</li><li>vue-loader配置</li><li>css module配置</li><li>安装使用eslint和editorconfig以及precommit</li><li>Webpack4升级</li></ul><h5 id="Vue核心知识"><a href="#Vue核心知识" class="headerlink" title="Vue核心知识"></a><strong>Vue核心知识</strong></h5><p>从Vue的实例、生命周期、原生指令、数据绑定、特殊API和组件开发等角度详细分析Vue的方方面面。并且深入讲解Vue的组件开发，包括一些高级属性slot、自定义双向绑定、render function等。</p><ul><li>一点小准备-单独讲解vue核心内容的配置</li><li>Vue实例</li><li>Vue的生命周期方法</li><li>Vue的数据绑定</li><li>computed和watch使用场景和方法</li><li>Vue的原生指令</li><li>Vue的组件之组件的定义</li><li>Vue的组件之组件的继承.mp</li><li>Vue的组件之自定义双向绑定</li><li>Vue的组件之高级属性</li><li>Vue的组件之render function</li></ul><h5 id="Vue-Router和Vuex"><a href="#Vue-Router和Vuex" class="headerlink" title="Vue-Router和Vuex"></a><strong>Vue-Router和Vuex</strong></h5><p>首先把Vue-Router和Vuex集成到项目开发当中。然后分别讲解Vue-Router和Vuex的详细使用方法和API，包括Router的配置，导航守卫，Vuex的配置，分模块等。并实现了Vuex Store的热更替功能。</p><ul><li>Vue-router之集成</li><li>Vue-router之配置</li><li>Vue-router之路由参数传递</li><li>Vue-router之导航守卫</li><li>Vuex之集成</li><li>Vuex之state和getters</li><li>Vuex之mutation和action</li><li>Vuex之模块</li><li>Vuex之其他一些API和配置</li></ul><h5 id="服务器渲染"><a href="#服务器渲染" class="headerlink" title="服务器渲染"></a><strong>服务器渲染</strong></h5><p>在项目当中加入Node Server，同时集成服务端渲染。解决服务端渲染需要考虑的基础问题，包括开发时如何跟webpack-dev-server配合，title信息的处理，正式环境的服务端渲染使用等。</p><ul><li>开发时服务端渲染的配置和原理</li><li>使用koa实现node server</li><li>服务端渲染的entry配置</li><li>开发时服务端渲染静态资源路径处理</li><li>使用vue-meta处理元信息</li><li>生产环境服务端渲染</li></ul><h5 id="高级组件开发"><a href="#高级组件开发" class="headerlink" title="高级组件开发"></a><strong>高级组件开发</strong></h5><p>通过两个高级组件：Notification和Tabs，讲解一些只有在高级组件开发当中才会用到的开发技巧。比如通过extend继承组件，通过一个js方法调用组件的显示，以及嵌套组件父组件显示子组件中的内容等。</p><ul><li>notification之基本组件实现</li><li>notification之通过方法调用</li><li>notification之优化</li><li>tabs组件之基本组件实现</li><li>tabs组件之选中状态和切换</li><li>tabs组件之在父组件中渲染子组件的slot</li></ul><h5 id="项目开发"><a href="#项目开发" class="headerlink" title="项目开发"></a><strong>项目开发</strong></h5><p>首先开发服务端的API接口，然后进行前后端的接口联调，登录页面的实现，以及最后调整服务端渲染的代码，让服务端渲染的时候用到的数据可以在客户端重用。</p><ul><li>服务端api请求基础实现</li><li>数据API实现</li><li>后端登录接口实现以及session的使用.mp4</li><li>登录页面实现</li><li>联调第一个API</li><li>请求错误处理和登录接口联调</li><li>所有接口进行联调</li><li>在数据请求的时候使用全局loading</li><li>在服务端渲染时获取数据</li><li>前后端数据复用以及服务端用户认证</li><li>服务端渲染进行redirect操作</li><li>createRenderer的方式进行服务端渲染</li><li>正式环境打包以及异步模块打包优化</li></ul><h5 id="部署和总结"><a href="#部署和总结" class="headerlink" title="部署和总结"></a><strong>部署和总结</strong></h5><p>通过PM在服务器上部署项目应用，并自动化把静态资源部署到七牛CDN上面。同时使用nginx配置让应用可以通过域名访问。最后总结课程内容。</p><ul><li>pm2使用以及服务器端部署</li><li>静态资源上传cdn</li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="项目准备工作"><a href="#项目准备工作" class="headerlink" title="项目准备工作"></a>项目准备工作</h2><p>包括项目需求分析、Vue-cli 3.0 脚手架介绍、cube-ui 介绍、目录模块分析、api 接口 mock 等。</p><ul><li><strong>Vue-cli 3.0 介绍</strong></li><li><strong>目录介绍 &amp; cube-ui 安装</strong></li><li><strong>api 接口 mock</strong></li></ul><h2 id="头部组件开发"><a href="#头部组件开发" class="headerlink" title="头部组件开发"></a>头部组件开发</h2><p>包括 Header组件编写，axios 封装和数据交互、star 组件抽象封装和 HeaderDetail 组件的编写和交互。</p><ul><li><strong>目录结构 &amp; header 组件</strong></li><li><strong>axios 封装 &amp; 数据获取</strong></li><li><strong>header-detail &amp; star 组件</strong></li><li><strong>header-detail 交互</strong></li></ul><h2 id="Tab-组件开发"><a href="#Tab-组件开发" class="headerlink" title="Tab 组件开发"></a>Tab 组件开发</h2><p>包括 Tab 组件的基础实现、上下联动实现、组件更高维度的抽象和封装。</p><ul><li><strong>tab 组件基础实现</strong></li><li><strong>tab 组件上下联动</strong></li><li><strong>tab 组件抽象和封装</strong></li></ul><h2 id="商品页面开发"><a href="#商品页面开发" class="headerlink" title="商品页面开发"></a>商品页面开发</h2><p>包括 ScrollNav 组件的应用、ShopCart 组件的开发、CartControl 组件开发、小球飞入动画实现、侧边栏内容定制化、购物车列表组件实现和完善、sticky 组件实现、弹层类组件优化。</p><ul><li><strong>scroll-nav 组件应用</strong></li><li><strong>shop-cart 组件</strong></li><li><strong>cart-control 组件</strong></li><li><strong>小球飞入动画实现</strong></li><li><strong>侧边栏内容定制化</strong></li><li><strong>购物车列表组件</strong></li><li><strong>购物车 sticky 组件</strong></li><li><strong>购物车列表功能完善</strong></li><li><strong>弹层类组件优化</strong></li></ul><h2 id="商品详情页开发"><a href="#商品详情页开发" class="headerlink" title="商品详情页开发"></a>商品详情页开发</h2><p>包括详情页骨架开发、详情页购物能力开发、详情页评价列表开发、评价选择组件开发。</p><ul><li><strong>商品详情页-骨架开发</strong></li><li><strong>商品详情页-购物开发</strong></li><li><strong>商品详情页-评价列表开发</strong></li><li><strong>商品详情页-评价选择组件开发</strong></li></ul><h2 id="评价和商家页面开发"><a href="#评价和商家页面开发" class="headerlink" title="评价和商家页面开发"></a>评价和商家页面开发</h2><p>包括评价页面骨架开发、评价选择组件 Mixin 抽取、商家页面静态页面开发、商家页面本地缓存封装和实现。</p><ul><li><strong>评价页面骨架开发和数据获取</strong></li><li><strong>评价页面评价选择组件 mixin 抽取</strong></li><li><strong>商家页面静态页面开发</strong></li><li><strong>商家页面本地缓存封装实现</strong></li></ul><h2 id="create-api-原理分析"><a href="#create-api-原理分析" class="headerlink" title="create-api 原理分析"></a>create-api 原理分析</h2><p>包括create-api 原理介绍和源码分析。</p><ul><li><strong>create-api 原理介绍</strong></li><li><strong>create-api 源码分析</strong></li></ul><h2 id="打包构建和项目部署"><a href="#打包构建和项目部署" class="headerlink" title="打包构建和项目部署"></a>打包构建和项目部署</h2><p>包括打包构建和性能优化、搭建小型 node 服务代理接口、部署到云服务器和 nginx 多项目部署方案。</p><ul><li><strong>打包构建&amp;性能优化</strong></li><li><strong>搭建小型 node 服务代理接口</strong></li><li><strong>部署到云服务器</strong></li><li><strong>nginx 配置多项目部署方案</strong></li></ul><h2 id="Vuejs介绍"><a href="#Vuejs介绍" class="headerlink" title="Vuejs介绍"></a>Vuejs介绍</h2><p>从前端开发趋势分析开始，引入 MVVM 开发框架和 Vue.js，接着对比流行框架Angular 和 React，最后详细介绍 Vue.js 的核心思想-数据驱动和组件化。</p><ul><li><strong>Vuejs介绍-近年来前端开发趋势</strong></li><li><strong>Vuejs介绍-MVVM框架</strong></li><li><strong>Vuejs介绍-什么是Vuejs及Vuejs生态</strong></li><li><strong>Vuejs介绍-对比Angular、React</strong></li><li><strong>Vuejs介绍-Vuejs核心思想</strong></li></ul><h2 id="Vue-cli-开启-Vuejs-项目"><a href="#Vue-cli-开启-Vuejs-项目" class="headerlink" title="Vue-cli 开启 Vuejs 项目"></a>Vue-cli 开启 Vuejs 项目</h2><p>介绍 Vue 项目的脚手架，如何安装，对脚手架生成的目录文件做介绍，介绍 Vue 组件的编写方法，最后运行 demo 项目并介绍 webpack 构建脚本来说明 demo 的运行原理。</p><ul><li><strong>Vue-cli介绍</strong></li><li><strong>Vue-cli安装</strong></li><li><strong>项目运行</strong></li><li><strong>项目文件介绍</strong></li><li><strong>webpack打包</strong></li></ul><h2 id="项目实战-准备工作"><a href="#项目实战-准备工作" class="headerlink" title="项目实战-准备工作"></a>项目实战-准备工作</h2><p>分析外卖 APP 商家页面的需求，准备图片资源，利用 icon-moon 把 svg 制作成图标字体，对代码的目录结构设计，最后 mock 测试数据。</p><ul><li><strong>需求分析</strong></li><li><strong>项目资源准备</strong></li><li><strong>图标字体制作</strong></li><li><strong>项目目录设计</strong></li><li><strong>mock数据（模拟后台数据）</strong></li></ul><h2 id="项目实战-页面骨架开发"><a href="#项目实战-页面骨架开发" class="headerlink" title="项目实战-页面骨架开发"></a>项目实战-页面骨架开发</h2><p>设计页面的骨架，拆分组件，商品、评论和商家详情页利用 Vue-router 做切换，最后还介绍了 flex 弹性布局以及移动端 1 像素 border 实现的小技巧。</p><ul><li><strong>组件拆分</strong></li><li><strong>Vue-router</strong></li><li><strong>1像素border实现</strong></li></ul><h2 id="项目实战-header组件开发"><a href="#项目实战-header组件开发" class="headerlink" title="项目实战-header组件开发"></a>项目实战-header组件开发</h2><p>编写 header 头部组件，应用 Vue-resource 从服务端读取数据，介绍如何在 Vue.js 中使用过渡动画，如何编写 css sticky footer 布局，如何从需求中抽象出 star 星星组件。</p><ul><li><strong>Vue-resource应用</strong></li><li><strong>外部组件</strong></li><li><strong>详情弹层页 - 实现弹出层</strong></li><li><strong>详情弹层页 - CSS Sticky footer</strong></li><li><strong>详情弹层页 - star组件抽象</strong></li><li><strong>详情弹层页 - star组件使用</strong></li><li><strong>详情弹层页 - 小标题自适应经典flex布局实现</strong></li><li><strong>详情弹层页 - header剩余组件实现</strong></li></ul><h2 id="项目实战-goods-商品列表页开发"><a href="#项目实战-goods-商品列表页开发" class="headerlink" title="项目实战-goods 商品列表页开发"></a>项目实战-goods 商品列表页开发</h2><p>  编写 goods 商品组件，包括它的子组件 shopcart 购物车。介绍了如何在 Vue.js 应用第三方 JS 插件 better-scroll实现列表滚动，并配合 Vue.js 的计算属性来实现左右列表的联动。应用了自定义 Vue.js 过渡动画实现了购物车的飞入动画效果，介绍了在 Vue.js中父子组件如何通讯。…</p><ul><li><strong>布局编写</strong></li><li><strong>左侧menu布局</strong></li><li><strong>右侧食品列表布局</strong></li><li><strong>better-scroll运用</strong></li><li><strong>shopcart购物车组件</strong></li><li><strong>cartcontrol组件</strong></li><li><strong>购物车小球动画实现</strong></li><li><strong>购物车详情页实现</strong></li></ul><h2 id="项目实战-food-商品详情页实现"><a href="#项目实战-food-商品详情页实现" class="headerlink" title="项目实战-food 商品详情页实现"></a>项目实战-food 商品详情页实现</h2><p>编写 food 商品详情页组件，介绍了图片占位的技巧，并从需求中抽象出的 split 分隔组件和 ratingselect 评论组件，实现自定义过滤器 datefilter。</p><ul><li>*<strong>商品详情页实现</strong></li><li><strong>split组件实现</strong></li><li><strong>ratingselect组件</strong></li><li><strong>评价列表</strong></li></ul><h2 id="项目实战-ratings评价列表页实现"><a href="#项目实战-ratings评价列表页实现" class="headerlink" title="项目实战-ratings评价列表页实现"></a>项目实战-ratings评价列表页实现</h2><p>  编写 ratings 评价列表页，感受在 Vue.js 中复用组件的好处，实现快速开发。</p><ul><li><strong>ratings组件开发-overview开发</strong></li><li><strong>ratings组件开发-评价列表</strong></li></ul><h2 id="项目实战-seller-商家详情页实现"><a href="#项目实战-seller-商家详情页实现" class="headerlink" title="项目实战-seller 商家详情页实现"></a>项目实战-seller 商家详情页实现</h2><p>编写 seller 商家详情页，实现一套通用移动端数据存取方案，以及对项目做一些体验上的优化。</p><ul><li><strong>seller组件开发-overview开发</strong></li><li><strong>seller组件开发-公告与活动开发</strong></li><li><strong>seller组件开发-BScroll应用</strong></li><li><strong>seller组件开发-商家实景图</strong></li><li><strong>seller组件开发-商家信息</strong></li><li><strong>seller组件开发-收藏商家</strong></li><li><strong>seller组件开发-收藏商家</strong></li><li><strong>seller组件开发-体验优化</strong></li></ul><h2 id="项目实战-项目编译打包"><a href="#项目实战-项目编译打包" class="headerlink" title="项目实战-项目编译打包"></a>项目实战-项目编译打包</h2><p>上线前的最后一步，编译打包Vue.js 项目。介绍了 webpack 编译时的配置，如何利用node.js 开启一个server本地调试。</p><ul><li><strong>webpack配置介绍</strong></li><li><strong>nodejs调试</strong></li></ul><h2 id="项目从-vue-js1-0-向-2-0-升级"><a href="#项目从-vue-js1-0-向-2-0-升级" class="headerlink" title="项目从 vue.js1.0 向 2.0 升级"></a>项目从 vue.js1.0 向 2.0 升级</h2><p>本章节把项目从1.0向2.0升级向大家做了简要的介绍。</p><ul><li><strong>1.0升级2.0 配置文件修改</strong></li><li><strong>1.0升级2.0 源码修改</strong></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Vue总览</title>
      <link href="/posts/c423f156/"/>
      <url>/posts/c423f156/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="Vue3-中文版翻译"><a href="#Vue3-中文版翻译" class="headerlink" title="Vue3 中文版翻译"></a><a href="https://staging-cn.vuejs.org/">Vue3 中文版翻译</a></h2><h2 id="Vue基础语法"><a href="#Vue基础语法" class="headerlink" title="Vue基础语法"></a>Vue基础语法</h2><h3 id="创建第一个Vue实例"><a href="#创建第一个Vue实例" class="headerlink" title="创建第一个Vue实例"></a>创建第一个Vue实例</h3><h3 id="挂载点，模版与实例"><a href="#挂载点，模版与实例" class="headerlink" title="挂载点，模版与实例"></a>挂载点，模版与实例</h3><h3 id="Vue实例中的数据-事件和方法"><a href="#Vue实例中的数据-事件和方法" class="headerlink" title="Vue实例中的数据,事件和方法"></a>Vue实例中的数据,事件和方法</h3><h3 id="Vue中的属性绑定和双向数据绑定"><a href="#Vue中的属性绑定和双向数据绑定" class="headerlink" title="Vue中的属性绑定和双向数据绑定"></a>Vue中的属性绑定和双向数据绑定</h3><h3 id="Vue中的计算属性和侦听器"><a href="#Vue中的计算属性和侦听器" class="headerlink" title="Vue中的计算属性和侦听器"></a>Vue中的计算属性和侦听器</h3><h3 id="v-if-v-show与v-for指令"><a href="#v-if-v-show与v-for指令" class="headerlink" title="v-if, v-show与v-for指令"></a>v-if, v-show与v-for指令</h3><h2 id="Vue中的组件"><a href="#Vue中的组件" class="headerlink" title="Vue中的组件"></a>Vue中的组件</h2><h3 id="todolist功能开发"><a href="#todolist功能开发" class="headerlink" title="todolist功能开发"></a>todolist功能开发</h3><h3 id="todolist组件拆分"><a href="#todolist组件拆分" class="headerlink" title="todolist组件拆分"></a>todolist组件拆分</h3><h3 id="组件与实例的关系"><a href="#组件与实例的关系" class="headerlink" title="组件与实例的关系"></a>组件与实例的关系</h3><h3 id="实现todolist的删除功能"><a href="#实现todolist的删除功能" class="headerlink" title="实现todolist的删除功能"></a>实现todolist的删除功能</h3><h2 id="Vue-cli的使用"><a href="#Vue-cli的使用" class="headerlink" title="Vue-cli的使用"></a>Vue-cli的使用</h2><h3 id="vue-cli的简介与使用"><a href="#vue-cli的简介与使用" class="headerlink" title="vue-cli的简介与使用"></a>vue-cli的简介与使用</h3><h3 id="使用vue-cli开发TodoList"><a href="#使用vue-cli开发TodoList" class="headerlink" title="使用vue-cli开发TodoList"></a>使用vue-cli开发TodoList</h3><h3 id="全局样式与局部样式"><a href="#全局样式与局部样式" class="headerlink" title="全局样式与局部样式"></a>全局样式与局部样式</h3>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Butterfly主题-美化</title>
      <link href="/posts/d84a9e61/"/>
      <url>/posts/d84a9e61/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="美化-x2F-特效"><a href="#美化-x2F-特效" class="headerlink" title="美化 &#x2F; 特效"></a>美化 &#x2F; 特效</h2><h3 id="自定义主题色"><a href="#自定义主题色" class="headerlink" title="自定义主题色"></a>自定义主题色</h3><p>配置 <code>butterfly.yml</code> ，比如：</p><blockquote><p>颜色值必须被双引号包裹，就像”#000”而不是”#000”。否则将会在构建的时候报错！</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 主题色</span></span><br><span class="line"><span class="attr">theme_color:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">main:</span> <span class="string">&quot;#F44E5A&quot;</span> <span class="comment"># 粉红色</span></span><br><span class="line">  <span class="attr">paginator:</span> <span class="string">&quot;#F44E5A&quot;</span> <span class="comment"># 分页器</span></span><br><span class="line">  <span class="attr">button_hover:</span> <span class="string">&quot;#FF7242&quot;</span> <span class="comment"># 按钮悬停</span></span><br><span class="line">  <span class="attr">text_selection:</span> <span class="string">&quot;#F44E5A&quot;</span> <span class="comment"># 文本选择</span></span><br><span class="line">  <span class="attr">link_color:</span> <span class="string">&quot;#99a9bf&quot;</span></span><br><span class="line">  <span class="attr">meta_color:</span> <span class="string">&quot;#858585&quot;</span></span><br><span class="line">  <span class="attr">hr_color:</span> <span class="string">&quot;#A4D8FA&quot;</span></span><br><span class="line">  <span class="attr">code_foreground:</span> <span class="string">&quot;#F47466&quot;</span> <span class="comment"># 代码前景</span></span><br><span class="line">  <span class="attr">code_background:</span> <span class="string">&quot;rgba(27, 31, 35, .05)&quot;</span> <span class="comment"># 代码背景</span></span><br><span class="line">  <span class="attr">toc_color:</span> <span class="string">&quot;#F44E5A&quot;</span> <span class="comment"># TOC目录颜色</span></span><br><span class="line">  <span class="attr">blockquote_padding_color:</span> <span class="string">&quot;#F44E5A&quot;</span> <span class="comment"># 块引用填充颜色</span></span><br><span class="line">  <span class="attr">blockquote_background_color:</span> <span class="string">&quot;#F44E5A&quot;</span> <span class="comment"># 块引用背景颜色</span></span><br></pre></td></tr></table></figure><h3 id="网站背景"><a href="#网站背景" class="headerlink" title="网站背景"></a>网站背景</h3><p>默认显示白色，可设置图片或者顔色<br>配置 <code>butterfly.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># background</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 图片路径引用说明</span></span><br><span class="line"><span class="string">网络资源路径：url(http://xxxxxx.com/xxx.jpg)</span></span><br><span class="line"><span class="attr">background:</span> <span class="string">url(https://i.loli.net/2019/09/09/5oDRkWVKctx2b6A.png)</span></span><br><span class="line"></span><br><span class="line"><span class="string">相对路径引用：如果网站根目录不是/，则使用本地图片需要填充加上根目录信息，例如网站是</span> <span class="string">https://yoursite.com/blog,引用一张img/xx.png图片，则设置background为</span> <span class="string">`url(/blog/img/xx.png)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 背景颜色设定</span></span><br><span class="line"><span class="attr">background:</span> <span class="string">&#x27;#49B202&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="footer背景"><a href="#footer背景" class="headerlink" title="footer背景"></a>footer背景</h3><p><code>footer</code> 的背景会与 <code>top_img</code> 的一致，当设置 <code>false</code> 时，将与主题色一致。<br>配置 <code>butterfly.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 留空/false:显示默认的颜色、img显示链接、true：与top_img一致</span></span><br><span class="line"><span class="attr">footer_bg:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># img链接</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 颜色值设定</span></span><br><span class="line"><span class="string">顔色(</span></span><br><span class="line"><span class="string">HEX值</span> <span class="bullet">-</span> <span class="comment">#0000FF</span></span><br><span class="line"><span class="string">RGB值</span> <span class="bullet">-</span> <span class="string">rgb(0,0,255)</span></span><br><span class="line"><span class="string">顔色单词</span> <span class="bullet">-</span> <span class="string">orange</span></span><br><span class="line"><span class="string">渐变色</span> <span class="bullet">-</span> <span class="string">linear-gradient(</span> <span class="string">135deg,</span> <span class="comment">#E2B0FF 10%, #9F44D3 100%)</span></span><br><span class="line"><span class="string">）</span></span><br></pre></td></tr></table></figure><h3 id="键盘打字效果"><a href="#键盘打字效果" class="headerlink" title="键盘打字效果"></a>键盘打字效果</h3><p>配置 <code>butterfly.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 打字效果</span></span><br><span class="line"><span class="comment"># https://github.com/disjukr/activate-power-mode </span></span><br><span class="line"><span class="attr">activate_power_mode:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">colorful:</span> <span class="literal">true</span> <span class="comment"># 冒光特效</span></span><br><span class="line">  <span class="attr">shake:</span> <span class="literal">false</span><span class="comment"># 抖动特效</span></span><br><span class="line">  <span class="attr">mobile:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><h3 id="页面背景特效"><a href="#页面背景特效" class="headerlink" title="页面背景特效"></a>页面背景特效</h3><blockquote><p>静态彩带</p></blockquote><p>在 <code>\source\_data</code>中 <code>butterfly.yml</code>修改：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># canvas_ribbon (靜止彩帶背景)</span></span><br><span class="line"><span class="comment"># See: https://github.com/hustcc/ribbon.jscanvas_ribbon:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">size:</span> <span class="number">150</span></span><br><span class="line">  <span class="attr">alpha:</span> <span class="number">0.6</span></span><br><span class="line">  <span class="attr">zIndex:</span> <span class="number">-1</span></span><br><span class="line">  <span class="attr">click_to_change:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">click_to_change:</span> <span class="literal">false</span>  <span class="comment">#设置是否每次点击都更换綵带</span></span><br><span class="line">  <span class="attr">mobile:</span> <span class="literal">false</span> <span class="comment"># false 手机端不显示 true 手机端显示</span></span><br></pre></td></tr></table></figure><p><code>点击</code>页面，<code>彩带</code>会进行 <code>变化</code>。</p><p><img src="https://pic-bed-1305292171.file.myqcloud.com/wv-blog/_post/hexo-noteimage-20220123104521812.png"></p><blockquote><p>动态彩带</p></blockquote><p>在 <code>\source\_data</code>中 <code>butterfly.yml</code>修改：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Fluttering Ribbon (動態彩帶)</span></span><br><span class="line"><span class="attr">canvas_fluttering_ribbon:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">mobile:</span> <span class="literal">false</span> <span class="comment"># false 手机端不显示 true 手机端显示</span></span><br></pre></td></tr></table></figure><p>这个彩带可以 <code>动态变换</code>。</p><blockquote><p>canvas_nest</p></blockquote><p>在 <code>\source\_data</code>中 <code>butterfly.yml</code>修改：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># canvas_nest</span></span><br><span class="line"><span class="comment"># https://github.com/hustcc/canvas-nest.jscanvas_nest:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">&#x27;0,0,255&#x27;</span> <span class="comment">#线条颜色, default: &#x27;0,0,0&#x27;;</span></span><br><span class="line">  <span class="attr">opacity:</span> <span class="number">0.7</span> <span class="comment"># 线条的不透明度 (0~1), default: 0.5.</span></span><br><span class="line">  <span class="attr">zIndex:</span> <span class="number">-1</span> <span class="comment"># z-index property of the background, default: -1.</span></span><br><span class="line">  <span class="attr">count:</span> <span class="number">99</span> <span class="comment"># 线条数量, default: 99.</span></span><br><span class="line">  <span class="attr">mobile:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><p>这个可以鼠标 <code>自动吸附</code>。</p><h3 id="鼠标点击效果"><a href="#鼠标点击效果" class="headerlink" title="鼠标点击效果"></a>鼠标点击效果</h3><p>配置 <code>butterfly.yml</code> 文件</p><ol><li>烟花</li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">fireworks:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">zIndex:</span> <span class="number">9999</span> <span class="comment"># -1 or 9999</span></span><br><span class="line">  <span class="attr">mobile:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><ol start="2"><li>爱心</li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">click_heart:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">mobile:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><ol start="3"><li>文字</li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">ClickShowText:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">text:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">富强</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">民主</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">文明</span></span><br><span class="line">  <span class="attr">fontSize:</span> <span class="string">15px</span></span><br><span class="line">  <span class="attr">random:</span> <span class="literal">false</span> <span class="comment"># 文字随机显示</span></span><br><span class="line">  <span class="attr">mobile:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><h3 id="文章页美化"><a href="#文章页美化" class="headerlink" title="文章页美化"></a>文章页美化</h3><p>调整 <code>ol</code> 、<code>ul</code> 、<code>h1-h5</code> 的样式（对应列表、标题的样式）<br>配置 <code>butterfly.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">post_beautify:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">title-prefix-icon:</span> <span class="string">&#x27;\f0c1&#x27;</span></span><br><span class="line">  <span class="attr">title-prefix-icon-color:</span> <span class="string">&#x27;#F47466&#x27;</span></span><br></pre></td></tr></table></figure><p><code>title-prefix-icon</code> 填写的是 <code>fontawesome</code> 的 <code>icon</code> 的 <code>Unicode</code> 数</p><h3 id="自定义字体"><a href="#自定义字体" class="headerlink" title="自定义字体"></a>自定义字体</h3><p>可自行设置字体的 <code>font-family</code></p><h4 id="全局字体"><a href="#全局字体" class="headerlink" title="全局字体"></a>全局字体</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># <span class="title class_">Global</span> font settings</span><br><span class="line"># <span class="title class_">Don</span><span class="string">&#x27;t modify the following settings unless you know how they work (非必要不要修改)</span></span><br><span class="line"><span class="string">font:</span></span><br><span class="line"><span class="string">  global-font-size: 16px</span></span><br><span class="line"><span class="string">  code-font-size:</span></span><br><span class="line"><span class="string">  font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, Lato, Roboto, &quot;PingFang SC&quot;, &quot;Microsoft JhengHei&quot;, &quot;Microsoft YaHei&quot;, sans-serif</span></span><br><span class="line"><span class="string">  code-font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft JhengHei&quot;, &quot;Microsoft YaHei&quot;, sans-serif</span></span><br></pre></td></tr></table></figure><h4 id="Blog标题字体"><a href="#Blog标题字体" class="headerlink" title="Blog标题字体"></a>Blog标题字体</h4><pre><code>如果不需要配置则留空即可</code></pre><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># <span class="title class_">Font</span> settings <span class="keyword">for</span> the site title and site subtitle</span><br><span class="line"># 左上角网站名字 主页居中网站名字</span><br><span class="line"><span class="attr">blog_title_font</span>:</span><br><span class="line">  <span class="attr">font_link</span>: <span class="attr">https</span>:<span class="comment">//fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap</span></span><br><span class="line">  font-<span class="attr">family</span>: <span class="title class_">Titillium</span> <span class="title class_">Web</span>, <span class="string">&#x27;PingFang SC&#x27;</span>, <span class="string">&#x27;Hiragino Sans GB</span></span><br></pre></td></tr></table></figure><h3 id="网站副标题样式"><a href="#网站副标题样式" class="headerlink" title="网站副标题样式"></a>网站副标题样式</h3><p>可设置主页中显示的网站副标题或者喜欢的座右铭。</p><h4 id="副标题设置"><a href="#副标题设置" class="headerlink" title="副标题设置"></a>副标题设置</h4><p>配置 <code>butterfly.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 主页subtitle</span></span><br><span class="line"><span class="comment"># 打字效果</span></span><br><span class="line"><span class="attr">subtitle:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># Typewriter Effect (打字效果)</span></span><br><span class="line">  <span class="attr">effect:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># loop (循环打字)</span></span><br><span class="line">  <span class="attr">loop:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># source调用第三方服务</span></span><br><span class="line">  <span class="comment"># source: false 关闭调用</span></span><br><span class="line">  <span class="comment"># source: 1  调用金山词霸的每日一句（简体）</span></span><br><span class="line">  <span class="comment"># source: 2  调用一言网的一句话（简体） #https://hitokoto.cn/</span></span><br><span class="line">  <span class="comment"># source: 3  调用一句网（简体） http://yijuzhan.com/</span></span><br><span class="line">  <span class="comment"># source: 4  调用今日诗词（简体） https://www.jinrishici.com/</span></span><br><span class="line">  <span class="comment"># subtitle 会先显示 source , 再显示 sub 的内容</span></span><br><span class="line">  <span class="attr">source:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># (如果有英文逗号&#x27; , &#x27;，请使用转义字符 ,)</span></span><br><span class="line">  <span class="attr">sub:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">今日事,今日毕</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">Never</span> <span class="string">put</span> <span class="string">off</span> <span class="string">till</span> <span class="string">tomorrow</span> <span class="string">what</span> <span class="string">you</span> <span class="string">can</span> <span class="string">do</span> <span class="string">today</span></span><br></pre></td></tr></table></figure><h4 id="副标题字体大小颜色"><a href="#副标题字体大小颜色" class="headerlink" title="副标题字体大小颜色"></a>副标题字体大小颜色</h4><p>在 <code>\themes\butterfly\source\css\_layout</code>中的 <code>head.styl</code>:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#site-subtitle</span></span><br><span class="line">    <span class="attr">color:</span> <span class="string">var(--white)</span>   <span class="string">此处修改为白色</span></span><br><span class="line">    <span class="attr">font-size:</span> <span class="number">1.</span><span class="string">05em</span>     <span class="string">字体大小</span>  </span><br><span class="line"></span><br><span class="line">    <span class="string">+minWidth768()</span></span><br><span class="line">      <span class="attr">font-size:</span> <span class="number">1.</span><span class="string">40em</span>   <span class="string">字体大小</span></span><br></pre></td></tr></table></figure><h3 id="主页文章-cover-位置"><a href="#主页文章-cover-位置" class="headerlink" title="主页文章 cover 位置"></a>主页文章 cover 位置</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 主页文章COVER显示位置</span></span><br><span class="line"><span class="comment"># 三个值可配置 left , right , both</span></span><br><span class="line"><span class="comment"># left(全部图片显示在左边)，right(全部图片显示在右边)，both(左右左右顺序显示)</span></span><br><span class="line"><span class="attr">index_post_cover:</span> <span class="string">left</span></span><br></pre></td></tr></table></figure><p>主页 <code>top_img</code>显示大小，默认的显示为全屏。<code>site-info</code>的区域会居中显示</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 主页设置</span></span><br><span class="line"><span class="comment"># 默认top_img全屏，site_info在中间</span></span><br><span class="line"><span class="comment"># 使用默认, 都无需填写（建议默认）</span></span><br><span class="line"><span class="attr">index_top_img_height:</span> <span class="comment">#主页top_img高度 例如 300px/300em/300rem  不能使用百分比</span></span><br></pre></td></tr></table></figure><blockquote><p>注意：<code>index_top_img_height</code> 的值不能使用百分比。<br>2个都不填的话，会使用默认值</p></blockquote><h3 id="字数统计"><a href="#字数统计" class="headerlink" title="字数统计"></a>字数统计</h3><p>要为 <code>Butterfly</code> 配上字数统计特性，你需要如下几个步骤:</p><ol><li>打开 <code>hexo</code> 工作目录</li><li><code>npm install hexo-wordcount --save</code> or <code>yarn add hexo-wordcount</code></li><li>配置 <code>butterfly.yml</code> :</li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">wordcount:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">post_wordcount:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">min2read:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_wordcount:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="添加文章书写样式"><a href="#添加文章书写样式" class="headerlink" title="添加文章书写样式"></a>添加文章书写样式</h3><h4 id="文字增加背景色块"><a href="#文字增加背景色块" class="headerlink" title="文字增加背景色块"></a>文字增加背景色块</h4><p>如：<br>站点配置文件<br>主题配置文件<br>站点配置文件<br>主题配置文件<br>打开 <code>themes/next/source/css/_custom</code> 下的 <code>custom.styl</code> 文件,添加属性样式</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">// 颜色块-黄</span><br><span class="line"><span class="selector-tag">span</span><span class="selector-id">#inline-yellow</span> &#123;</span><br><span class="line"><span class="attribute">display</span>:inline;</span><br><span class="line"><span class="attribute">padding</span>:.<span class="number">2em</span> .<span class="number">6em</span> .<span class="number">3em</span>;</span><br><span class="line"><span class="attribute">font-size</span>:<span class="number">80%</span>;</span><br><span class="line"><span class="attribute">font-weight</span>:bold;</span><br><span class="line"><span class="attribute">line-height</span>:<span class="number">1</span>;</span><br><span class="line"><span class="attribute">color</span>:<span class="number">#fff</span>;</span><br><span class="line"><span class="attribute">text-align</span>:center;</span><br><span class="line"><span class="attribute">white-space</span>:nowrap;</span><br><span class="line"><span class="attribute">vertical-align</span>:baseline;</span><br><span class="line"><span class="attribute">border-radius</span>:<span class="number">0</span>;</span><br><span class="line"><span class="attribute">background-color</span>: <span class="number">#f0ad4e</span>;</span><br><span class="line">&#125;</span><br><span class="line">// 颜色块-绿</span><br><span class="line"><span class="selector-tag">span</span><span class="selector-id">#inline-green</span> &#123;</span><br><span class="line"><span class="attribute">display</span>:inline;</span><br><span class="line"><span class="attribute">padding</span>:.<span class="number">2em</span> .<span class="number">6em</span> .<span class="number">3em</span>;</span><br><span class="line"><span class="attribute">font-size</span>:<span class="number">80%</span>;</span><br><span class="line"><span class="attribute">font-weight</span>:bold;</span><br><span class="line"><span class="attribute">line-height</span>:<span class="number">1</span>;</span><br><span class="line"><span class="attribute">color</span>:<span class="number">#fff</span>;</span><br><span class="line"><span class="attribute">text-align</span>:center;</span><br><span class="line"><span class="attribute">white-space</span>:nowrap;</span><br><span class="line"><span class="attribute">vertical-align</span>:baseline;</span><br><span class="line"><span class="attribute">border-radius</span>:<span class="number">0</span>;</span><br><span class="line"><span class="attribute">background-color</span>: <span class="number">#5cb85c</span>;</span><br><span class="line">&#125;</span><br><span class="line">// 颜色块-蓝</span><br><span class="line"><span class="selector-tag">span</span><span class="selector-id">#inline-blue</span> &#123;</span><br><span class="line"><span class="attribute">display</span>:inline;</span><br><span class="line"><span class="attribute">padding</span>:.<span class="number">2em</span> .<span class="number">6em</span> .<span class="number">3em</span>;</span><br><span class="line"><span class="attribute">font-size</span>:<span class="number">80%</span>;</span><br><span class="line"><span class="attribute">font-weight</span>:bold;</span><br><span class="line"><span class="attribute">line-height</span>:<span class="number">1</span>;</span><br><span class="line"><span class="attribute">color</span>:<span class="number">#fff</span>;</span><br><span class="line"><span class="attribute">text-align</span>:center;</span><br><span class="line"><span class="attribute">white-space</span>:nowrap;</span><br><span class="line"><span class="attribute">vertical-align</span>:baseline;</span><br><span class="line"><span class="attribute">border-radius</span>:<span class="number">0</span>;</span><br><span class="line"><span class="attribute">background-color</span>: <span class="number">#2780e3</span>;</span><br><span class="line">&#125;</span><br><span class="line">// 颜色块-紫</span><br><span class="line"><span class="selector-tag">span</span><span class="selector-id">#inline-purple</span> &#123;</span><br><span class="line"><span class="attribute">display</span>:inline;</span><br><span class="line"><span class="attribute">padding</span>:.<span class="number">2em</span> .<span class="number">6em</span> .<span class="number">3em</span>;</span><br><span class="line"><span class="attribute">font-size</span>:<span class="number">80%</span>;</span><br><span class="line"><span class="attribute">font-weight</span>:bold;</span><br><span class="line"><span class="attribute">line-height</span>:<span class="number">1</span>;</span><br><span class="line"><span class="attribute">color</span>:<span class="number">#fff</span>;</span><br><span class="line"><span class="attribute">text-align</span>:center;</span><br><span class="line"><span class="attribute">white-space</span>:nowrap;</span><br><span class="line"><span class="attribute">vertical-align</span>:baseline;</span><br><span class="line"><span class="attribute">border-radius</span>:<span class="number">0</span>;</span><br><span class="line"><span class="attribute">background-color</span>: <span class="number">#9954bb</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在你需要编辑的文章地方。放置如下代码:<br><code>&lt;span id=&quot;inline-blue&quot;&gt; 站点配置文件 &lt;/span&gt;</code><br><code>&lt;span id=&quot;inline-purple&quot;&gt; 主题配置文件 &lt;/span&gt;</code><br><code>&lt;span id=&quot;inline-yellow&quot;&gt; 站点配置文件 &lt;/span&gt;</code><br><code>&lt;span id=&quot;inline-green&quot;&gt; 主题配置文件 &lt;/span&gt;</code></p><h4 id="下载按钮样式"><a href="#下载按钮样式" class="headerlink" title="下载按钮样式"></a>下载按钮样式</h4><p>如：<br><a href="https://www.iots.vip/"> Download Now</a><br>打开 <code>themes/next/source/css/_custom</code> 下的 <code>custom.styl</code> 文件,添加属性样式</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">a</span><span class="selector-id">#download</span> &#123;</span><br><span class="line"><span class="attribute">display</span>: inline-block;</span><br><span class="line"><span class="attribute">padding</span>: <span class="number">0</span> <span class="number">10px</span>;</span><br><span class="line"><span class="attribute">color</span>: <span class="number">#000</span>;</span><br><span class="line"><span class="attribute">background</span>: transparent;</span><br><span class="line"><span class="attribute">border</span>: <span class="number">2px</span> solid <span class="number">#000</span>;</span><br><span class="line"><span class="attribute">border-radius</span>: <span class="number">2px</span>;</span><br><span class="line"><span class="attribute">transition</span>: all .<span class="number">5s</span> ease;</span><br><span class="line"><span class="attribute">font-weight</span>: bold;</span><br><span class="line">&amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line"><span class="attribute">background</span>: <span class="number">#000</span>;</span><br><span class="line"><span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在你需要编辑的文章地方。放置如下代码<br><code>&lt;a id=&quot;download&quot; href=&quot;https://www.iots.vip&quot; target=&quot;_blank&quot;&gt;&lt;i class=&quot;fa fa-download&quot;&gt;&lt;/i&gt;&lt;span&gt; Download Now &lt;/span&gt; &lt;/a&gt;</code></p>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
          <category> Butterfly </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Butterfly主题-优化</title>
      <link href="/posts/516cb7ec/"/>
      <url>/posts/516cb7ec/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="Butterfly主题文件优化"><a href="#Butterfly主题文件优化" class="headerlink" title="Butterfly主题文件优化"></a>Butterfly主题文件优化</h2><h3 id="添加自定义404页面"><a href="#添加自定义404页面" class="headerlink" title="添加自定义404页面"></a>添加自定义404页面</h3><p>1.找到自己心仪的404页面，这个网站很多很多呦。</p><p><strong><a href="https://404.life/">https://404.life/</a></strong></p><p>2.在 <code>\source</code>中创建一个 <code>404文件夹</code>和一个 <code>404.html</code></p><p>3.修改 <code>404.html</code>内容</p><p> <code>红线</code>的地方，可以自行选择是否修改</p><p> <code>红框</code>的地方，必须修改 (可以按照图片中修改)</p><p>4.设置404跳过渲染，在主目录 <code>_config.yml</code>中：</p><figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">skip_render</span><span class="punctuation">:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">404.html</span></span><br></pre></td></tr></table></figure><p>5.<code>butterfly.yml</code> 可以关掉默认的404页面</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># A simple 404 page</span></span><br><span class="line">error_404:</span><br><span class="line">  enable: false  <span class="comment"># 关闭</span></span><br><span class="line">  subtitle: <span class="string">&#x27;Page Not Found&#x27;</span></span><br><span class="line">  background: https:<span class="regexp">//i</span>.loli.net<span class="regexp">/2020/</span><span class="number">05</span><span class="regexp">/19/</span>aKOcLiyPl2JQdFD.png</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="修改滚动条"><a href="#修改滚动条" class="headerlink" title="修改滚动条"></a>修改滚动条</h3><p>1.创建一个css文件移动到 <code>\themes\butterfly\source\css</code>目录下。</p><p>2.引入方式</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># inject</span></span><br><span class="line"><span class="comment"># insert the code to head (before &#x27;`&lt;/head&gt;`&#x27; tag) and the bottom (before &#x27;`&lt;/body&gt;` tag&#x27;)</span></span><br><span class="line"><span class="string">插入代码到头部</span> <span class="string">`&lt;/head&gt;`之前和底部</span> <span class="string">`&lt;/body&gt;`之前</span></span><br><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;/css/mycss.css&quot;&gt;</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="comment">#- &lt;script src=&quot;×××&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><p>将以下代码复制到你所创建的 <code>css文件</code>,引入即可。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">/*</span> <span class="string">滚动条</span> <span class="string">*/</span></span><br><span class="line"><span class="string">::-webkit-scrollbar</span> &#123;</span><br><span class="line">  <span class="attr">width:</span> <span class="string">8px;</span></span><br><span class="line">  <span class="attr">height:</span> <span class="string">8px;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">::-webkit-scrollbar-track</span> &#123;</span><br><span class="line">  <span class="attr">background-color:</span> <span class="string">rgba(73</span>, <span class="number">177</span>, <span class="number">245</span>, <span class="number">0.2</span><span class="string">);</span></span><br><span class="line">  <span class="attr">border-radius:</span> <span class="string">2em;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">::-webkit-scrollbar-thumb</span> &#123;</span><br><span class="line">  <span class="attr">background-color:</span> <span class="comment">#49b1f5;</span></span><br><span class="line">  <span class="attr">background-image:</span> <span class="string">-webkit-linear-gradient(</span></span><br><span class="line">    <span class="string">45deg</span>,</span><br><span class="line">    <span class="string">rgba(255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.4</span><span class="string">)</span> <span class="number">25</span><span class="string">%</span>,</span><br><span class="line">    <span class="string">transparent</span> <span class="number">25</span><span class="string">%</span>,</span><br><span class="line">    <span class="string">transparent</span> <span class="number">50</span><span class="string">%</span>,</span><br><span class="line">    <span class="string">rgba(255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.4</span><span class="string">)</span> <span class="number">50</span><span class="string">%</span>,</span><br><span class="line">    <span class="string">rgba(255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.4</span><span class="string">)</span> <span class="number">75</span><span class="string">%</span>,</span><br><span class="line">    <span class="string">transparent</span> <span class="number">75</span><span class="string">%</span>,</span><br><span class="line">    <span class="string">transparent</span></span><br><span class="line">  <span class="string">);</span></span><br><span class="line">  <span class="attr">border-radius:</span> <span class="string">2em;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">::-webkit-scrollbar-corner</span> &#123;</span><br><span class="line">  <span class="attr">background-color:</span> <span class="string">transparent;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">::-moz-selection</span> &#123;</span><br><span class="line">  <span class="attr">color:</span> <span class="comment">#fff;</span></span><br><span class="line">  <span class="attr">background-color:</span> <span class="comment">#49b1f5;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="页脚渐变"><a href="#页脚渐变" class="headerlink" title="页脚渐变"></a>页脚渐变</h3><p>将以下代码复制到你所创建的 <code>css文件</code>,引入即可。</p><p>可参考：<code>修改滚动条</code>部分中的 <code>引入方式</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">/*</span> <span class="string">页脚footer</span> <span class="string">*/</span></span><br><span class="line"><span class="string">/*</span> <span class="string">渐变色滚动动画</span> <span class="string">*/</span></span><br><span class="line"><span class="string">@-webkit-keyframes</span> <span class="string">Gradient</span> &#123;</span><br><span class="line">    <span class="number">0</span><span class="string">%</span> &#123;</span><br><span class="line">        <span class="attr">background-position:</span> <span class="number">0</span> <span class="number">50</span><span class="string">%;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">50</span><span class="string">%</span> &#123;</span><br><span class="line">        <span class="attr">background-position:</span> <span class="number">100</span><span class="string">%</span> <span class="number">50</span><span class="string">%;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">100</span><span class="string">%</span> &#123;</span><br><span class="line">        <span class="attr">background-position:</span> <span class="number">0</span> <span class="number">50</span><span class="string">%;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">@-moz-keyframes</span> <span class="string">Gradient</span> &#123;</span><br><span class="line">    <span class="number">0</span><span class="string">%</span> &#123;</span><br><span class="line">        <span class="attr">background-position:</span> <span class="number">0</span> <span class="number">50</span><span class="string">%;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">50</span><span class="string">%</span> &#123;</span><br><span class="line">        <span class="attr">background-position:</span> <span class="number">100</span><span class="string">%</span> <span class="number">50</span><span class="string">%;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">100</span><span class="string">%</span> &#123;</span><br><span class="line">        <span class="attr">background-position:</span> <span class="number">0</span> <span class="number">50</span><span class="string">%;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">@keyframes</span> <span class="string">Gradient</span> &#123;</span><br><span class="line">    <span class="number">0</span><span class="string">%</span> &#123;</span><br><span class="line">        <span class="attr">background-position:</span> <span class="number">0</span> <span class="number">50</span><span class="string">%;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">50</span><span class="string">%</span> &#123;</span><br><span class="line">        <span class="attr">background-position:</span> <span class="number">100</span><span class="string">%</span> <span class="number">50</span><span class="string">%;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">100</span><span class="string">%</span> &#123;</span><br><span class="line">        <span class="attr">background-position:</span> <span class="number">0</span> <span class="number">50</span><span class="string">%;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#footer &#123;</span></span><br><span class="line">    <span class="attr">background:</span> <span class="string">linear-gradient(-45deg,</span> <span class="comment">#ee7752, #ce3e75, #23a6d5, #23d5ab);</span></span><br><span class="line">    <span class="attr">background-size:</span> <span class="number">400</span><span class="string">%</span> <span class="number">400</span><span class="string">%;</span></span><br><span class="line">    <span class="string">-webkit-animation:</span> <span class="string">Gradient</span> <span class="string">10s</span> <span class="string">ease</span> <span class="string">infinite;</span></span><br><span class="line">    <span class="string">-moz-animation:</span> <span class="string">Gradient</span> <span class="string">10s</span> <span class="string">ease</span> <span class="string">infinite;</span></span><br><span class="line">    <span class="attr">animation:</span> <span class="string">Gradient</span> <span class="string">10s</span> <span class="string">ease</span> <span class="string">infinite;</span></span><br><span class="line">    <span class="string">-o-user-select:</span> <span class="string">none;</span></span><br><span class="line">    <span class="string">-ms-user-select:</span> <span class="string">none;</span></span><br><span class="line">    <span class="string">-webkit-user-select:</span> <span class="string">none;</span></span><br><span class="line">    <span class="string">-moz-user-select:</span> <span class="string">none;</span></span><br><span class="line">    <span class="attr">user-select:</span> <span class="string">none;</span></span><br><span class="line">    <span class="attr">border-top-left-radius:</span> <span class="string">10px;</span></span><br><span class="line">    <span class="attr">border-top-right-radius:</span> <span class="string">10px;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#footer:before &#123;</span></span><br><span class="line">    <span class="attr">background-color:</span> <span class="string">rgba(0,</span> <span class="number">0</span><span class="string">,</span> <span class="number">0</span><span class="string">,</span> <span class="number">0</span><span class="string">);</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="更换背景及透明度"><a href="#更换背景及透明度" class="headerlink" title="更换背景及透明度"></a>更换背景及透明度</h3><h4 id="1-透明度"><a href="#1-透明度" class="headerlink" title="1.透明度"></a>1.透明度</h4><p>将以下代码复制到你所创建的 <code>css文件</code>,引入即可。</p><p>可参考：<code>修改滚动条</code>部分中的 <code>引入方式</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">/*</span> <span class="string">文章页背景</span> <span class="string">*/</span></span><br><span class="line"><span class="string">.layout_post&gt;#post</span> &#123;</span><br><span class="line">    <span class="string">/*</span> <span class="string">以下代表白色透明度为0.3</span> <span class="string">*/</span></span><br><span class="line">    <span class="attr">background:</span> <span class="string">rgba(255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">.3</span><span class="string">);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">/*</span> <span class="string">所有背景（包括首页卡片、文章页、页面页等）</span> <span class="string">/</span></span><br><span class="line"><span class="comment">#aside_content .card-widget, #recent-posts&gt;.recent-post-item, .layout_page&gt;div:first-child:not(.recent-posts), .layout_post&gt;#page, .layout_post&gt;#post, .read-mode .layout_post&gt;#post&#123;</span></span><br><span class="line">    <span class="string">/</span> <span class="string">以下代表白色透明度为0.3</span> <span class="string">*/</span></span><br><span class="line">    <span class="attr">background:</span> <span class="string">rgba(255,255,255,.3);</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure><h4 id="2-更换背景"><a href="#2-更换背景" class="headerlink" title="2.更换背景"></a>2.更换背景</h4><p>老规矩，复制到你所创建的 <code>css文件</code>，引入即可。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#web_bg</span> &#123;</span><br><span class="line">  <span class="attribute">background-image</span>: <span class="built_in">linear-gradient</span>(to top, <span class="number">#fff1eb</span> <span class="number">0%</span>, <span class="number">#ace0f9</span> <span class="number">100%</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>当然这是我的博客 <code>背景</code>。</p><p>如果你想更改，具体可以参考本博客文章：Hexo之更换背景及透明度</p><h3 id="Instantpage-预加载"><a href="#Instantpage-预加载" class="headerlink" title="Instantpage 预加载"></a>Instantpage 预加载</h3><p>实现流程</p><p>当鼠标悬停到链接上超过 65 毫秒时，Instantpage 会对该链接进行预加载，可以提升访问速度。</p><p>修改主题配置文件：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># https://instant.page/</span></span><br><span class="line"><span class="comment"># prefetch (预加载)</span></span><br><span class="line"><span class="attr">instantpage:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="Pangu"><a href="#Pangu" class="headerlink" title="Pangu"></a>Pangu</h3><pre><code>自动替你在网页中所有的中文字和半形的英文、数字、符号之间插入空白</code></pre><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># <span class="attr">https</span>:<span class="comment">//github.com/vinta/pangu.js</span></span><br><span class="line"># <span class="title class_">Insert</span> a space between <span class="title class_">Chinese</span> character and <span class="title class_">English</span> character (中英文之间添加空格)</span><br><span class="line"><span class="attr">pangu</span>:</span><br><span class="line">  <span class="attr">enable</span>: <span class="literal">false</span></span><br><span class="line">  <span class="attr">field</span>: post # site/post</span><br></pre></td></tr></table></figure><h3 id="Pjax"><a href="#Pjax" class="headerlink" title="Pjax"></a>Pjax</h3><pre><code>当用户点击链接，通过ajax更新页面需要变化的部分，然后使用HTML5的pushState修改浏览器的URL地址。这样可以不用重复加载相同的资源（css/js）， 从而提升网页的加载速度。</code></pre><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># <span class="title class_">Pjax</span> [<span class="title class_">Beta</span>]</span><br><span class="line"># <span class="title class_">It</span> may contain bugs and unstable, give feedback when you find the bugs.</span><br><span class="line"># <span class="attr">https</span>:<span class="comment">//github.com/MoOx/pjax</span></span><br><span class="line"><span class="attr">pjax</span>: </span><br><span class="line">  <span class="attr">enable</span>: <span class="literal">true</span></span><br><span class="line">  <span class="attr">exclude</span>:</span><br><span class="line">    - <span class="regexp">/music/</span></span><br><span class="line">    - <span class="regexp">/no-pjax/</span></span><br></pre></td></tr></table></figure><blockquote><p>目前pjax在butterfly的应用还不够稳定，具体参考butterfly和pjax文档内容<a href="https://github.com/MoOx/pjax">https://github.com/MoOx/pjax</a></p></blockquote><h3 id="Inject（引入外部css-x2F-js文件）"><a href="#Inject（引入外部css-x2F-js文件）" class="headerlink" title="Inject（引入外部css&#x2F;js文件）"></a>Inject（引入外部css&#x2F;js文件）</h3><p>实现流程<br>如想添加额外的js&#x2F;css&#x2F;meta等等东西，可以在Inject里添加，支持添加到head（标签之前）和bottom（标签之前）。<br>请注意：以标准的html格式添加内容<br>主题配置文件例如：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;/self.css&quot;&gt;</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">src=&quot;xxxx&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><p>留意: 如果你的網站根目錄不是’&#x2F;‘,使用本地圖片時，需加上你的根目錄。<br>例如：網站是 <code>https://yoursite.com/blog</code>，引用css&#x2F;xx.css，則設置為 <code>&lt;link rel=&quot;stylesheet&quot; href=&quot;/blog/css/xx.css&quot;&gt;</code></p><h3 id="图片放大查看模式"><a href="#图片放大查看模式" class="headerlink" title="图片放大查看模式"></a>图片放大查看模式</h3><p>butterfly主题提供两个模式：fancybox、medium_zoom</p><p>fancybox：放大图片查看时带有关闭、左右查看等一些操作按钮，需要点击空白处或者关闭按钮才能回到文章页。</p><p>medium_zoom：不带任何操作按钮，看完点击大图就能回到文章页。</p><p>两种方式，选择其一即可。</p><h4 id="fancybox模式"><a href="#fancybox模式" class="headerlink" title="fancybox模式"></a>fancybox模式</h4><p>配置 <code>butterfly.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># fancybox http://fancyapps.com/fancybox/3/</span></span><br><span class="line"><span class="attr">fancybox:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h4 id="medium-zoom模式"><a href="#medium-zoom模式" class="headerlink" title="medium_zoom模式"></a>medium_zoom模式</h4><p>配置 <code>butterfly.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">medium_zoom:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="图片懒加载"><a href="#图片懒加载" class="headerlink" title="图片懒加载"></a>图片懒加载</h3><p>1.新增 <code>hexo-lazyload-image</code>模块</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-lazyload-image --save</span><br></pre></td></tr></table></figure><p>2.在主目录配置文件 <code>_config.yml</code>增加配置</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">lazyload:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">field:</span> <span class="string">site</span> <span class="comment"># site全站/post文章页</span></span><br><span class="line">  <span class="attr">placeholder:</span></span><br><span class="line">  <span class="attr">blur:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><p>这个就是图片没加载出来的时候，出现一个动图转转转。</p><h3 id="Snackbar弹窗"><a href="#Snackbar弹窗" class="headerlink" title="Snackbar弹窗"></a>Snackbar弹窗</h3><p><code>Snackbar</code> 弹窗，根据自己爱好开启<br>配置 <code>butterfly.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Snackbar 弹窗</span></span><br><span class="line"><span class="comment"># https://github.com/polonel/SnackBar</span></span><br><span class="line"><span class="comment"># position 弹窗位置</span></span><br><span class="line"><span class="comment"># 可选 top-left / top-center / top-right / bottom-left / bottom-center / bottom-right</span></span><br><span class="line"><span class="attr">snackbar:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">bottom-left</span></span><br><span class="line">  <span class="attr">bg_light:</span> <span class="string">&#x27;#49b1f5&#x27;</span> <span class="comment">#light mode时弹窗背景</span></span><br><span class="line">  <span class="attr">bg_dark:</span> <span class="string">&#x27;#2d3035&#x27;</span> <span class="comment">#dark mode时弹窗背景</span></span><br></pre></td></tr></table></figure><p><code>开启后</code>，在你设置的位置会有 <code>可爱的小弹窗</code>出现。</p><p>大家可以尝试一下，按 <code>个人爱好</code>开启。</p><h3 id="移动端优化"><a href="#移动端优化" class="headerlink" title="移动端优化"></a>移动端优化</h3><p><code>\themes\butterfly\source\css\_third-party\normalize.min.css</code>添加如下css代码：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 移动端优化：去除归档、标签、最新文章、公告、、只保留网站统计 */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">800px</span>) &#123;</span><br><span class="line">    <span class="selector-id">#aside_content</span></span><br><span class="line">    <span class="selector-tag">div</span><span class="selector-pseudo">:not</span>(<span class="selector-pseudo">:last-child</span>) &#123;</span><br><span class="line">        <span class="attribute">display</span>: none;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">13px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="部分优化"><a href="#部分优化" class="headerlink" title="部分优化"></a>部分优化</h2><h3 id="Nginx开启Gzip压缩"><a href="#Nginx开启Gzip压缩" class="headerlink" title="Nginx开启Gzip压缩"></a>Nginx开启Gzip压缩</h3><p>　　Nginx的部分优化见此文:<a href="https://www.iots.vip/post/nginx-gzip.html">链接</a></p><h3 id="取消Google字体库加载"><a href="#取消Google字体库加载" class="headerlink" title="取消Google字体库加载"></a>取消Google字体库加载</h3><p>　　主题调用了Google字体库，天朝的GFW下，会导致字体库加载极其缓慢甚至无法加载。这就导致博客在加载时会有很长的等待时间(F12选择network可以查看加载时间)<br>解决方法： 修改主题配置文件 <code>_config.xml</code> 中的 font 字段。将 true 改为 false。(网上有朋友使用360的公共库，我试了觉得还是不够快。。这里索性改为 false 反而更快了)<br>CDN等设置能明显加速博客的打开速度，同时能够抵御一些小型攻击，由于操作简单这里就不过多赘述，需要注意的是，在同时开启了SSL(<a href="https://www.iots.vip/post/nginx-ssl-seo.html">Nginx开启SSL与重定向优化</a>)的时候，应该将回源设置为 HTTPS 回源方式。</p><h3 id="SEO优化设置"><a href="#SEO优化设置" class="headerlink" title="SEO优化设置"></a>SEO优化设置</h3><p>　　虽说写博客不是为了搜索排名来写，但是，一定的搜索引擎流量或许能够让博客被更多的人知晓，也就有可能认识到与你志同道合的朋友~ 这里记录一些简单的SEO做法</p><h4 id="1、添加robots-txt"><a href="#1、添加robots-txt" class="headerlink" title="1、添加robots.txt"></a>1、添加robots.txt</h4><p>　　<code>robots.txt</code> 是搜索引擎中访问网站的时候要查看的第一个文件。<code>robots.txt</code> 文件告诉蜘蛛程序在服务器上什么文件是可以被查看的。<br>这里推荐我这种写法(当然，hexo 的版本不同可能文件目录有所不同)</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># welcome to : www.iots.vip </span></span><br><span class="line">User-agent: *</span><br><span class="line"><span class="symbol">Allow:</span> /</span><br><span class="line"><span class="symbol">Allow:</span> <span class="keyword">/archives/</span></span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">Disallow:</span> <span class="keyword">/js/</span></span><br><span class="line"><span class="symbol">Disallow:</span> <span class="keyword">/css/</span></span><br><span class="line"><span class="symbol">Disallow:</span> <span class="keyword">/fonts/</span></span><br><span class="line"><span class="symbol">Disallow:</span> <span class="keyword">/vendors/</span></span><br><span class="line"><span class="symbol">Disallow:</span> <span class="keyword">/lib/</span></span><br><span class="line"><span class="symbol">Sitemap:</span> https:<span class="comment">//www.iots.vip/sitemap.xml</span></span><br></pre></td></tr></table></figure><p>这里会出现一些安全隐患（其实是360网站检测提示 <code>robots.txt</code> 可能泄露站点目录结构，实际上并无大碍），可以参考<a href="https://www.iots.vip/post/360robots-txt.html">此文</a>解决。</p><h4 id="2、安装sitemap插件"><a href="#2、安装sitemap插件" class="headerlink" title="2、安装sitemap插件"></a>2、安装sitemap插件</h4><p>　　sitemap 在 SEO 过程中有着十分重要的地位，同时也能限制蜘蛛对某些特定目录的爬取。 具体概念不多赘述。 hexo 有很方便的自动生成sitemap的插件，打开 Node.js command prompt，在站点的根目录下执行以下命令：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-generator-sitemap <span class="attr">--save</span><span class="selector-id">#sitemap</span><span class="selector-class">.xml</span> 提交谷歌搜素引擎</span><br><span class="line">npm install hexo-generator-baidu-sitemap <span class="attr">--save</span><span class="selector-id">#baidusitemap</span><span class="selector-class">.xml</span> 提交百度搜索引擎</span><br></pre></td></tr></table></figure><p>然后在站点配置文件 <code>_config.xml</code> 中添加：</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 自动生成sitemap</span></span><br><span class="line"><span class="symbol">sitemap:</span></span><br><span class="line"><span class="symbol">path:</span> sitemap.xml</span><br><span class="line"><span class="symbol">baidusitemap:</span></span><br><span class="line"><span class="symbol">path:</span> baidusitemap.xml</span><br></pre></td></tr></table></figure><h4 id="3、安装nofollow插件"><a href="#3、安装nofollow插件" class="headerlink" title="3、安装nofollow插件"></a>3、安装nofollow插件</h4><p>　　减少出站链接能够有效防止权重分散，hexo 有很方便的自动为出站链接添加 nofollow 的插件。<br>这里@liuzhichao 感谢其开源的 hexo-autonofollow 插件，打开 Node.js command prompt，在站点的根目录下执行以下命令：</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-autonofollow <span class="comment">--save</span></span><br></pre></td></tr></table></figure><p>该插件会将博客中的出站链接自动加上 <code>nofollow属性</code>，例外请在站点配置文件 <code>_config.xml</code> 中添加如下字段</p><figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">nofollow</span><span class="punctuation">:</span></span><br><span class="line"><span class="attribute">enable</span><span class="punctuation">:</span> <span class="string">true</span></span><br><span class="line"><span class="attribute">exclude</span><span class="punctuation">:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">www.iots.vip</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">友链地址</span></span><br></pre></td></tr></table></figure><p>这样，例外的链接将不会被加上 <code>nofollow属性</code>。<br>插件自动添加的属性为 ‘external nofollow noopener noreferrer’ 一般来说标准的 <code>nofollow属性</code> 只需要 <code>external nofollow</code> 即可，noopener noreferrer 估计是新闻上说的钓鱼漏洞的补救方法，不过这条属性会影响站长工具的友链检测，大家如果需要去掉这一条属性，可以在&#x2F;hexo根目录&#x2F;node_modules\hexo-autonofollow\lib中修改filter.js中</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rel</span>: <span class="string">&#x27;external nofollow noopener noreferrer&#x27;</span></span><br></pre></td></tr></table></figure><p>将 ‘noopener noreferrer’ 去掉，重新 <code>hexo g</code> 即可。</p><h3 id="文章密码"><a href="#文章密码" class="headerlink" title="文章密码"></a>文章密码</h3><p>　　 <del>2017年11月11日更新</del> : 原文<a href="https://blog.paddings.cn/2016/12/01/blog/hexo-password/">点此</a> 这里搬运过来做备份 (这种方式是不安全的，详情请点击<a href="https://www.iots.vip/post/hexo-password-crack.html">hexo文章密码访问的”破解”方法</a>)</p><h4 id="第一步"><a href="#第一步" class="headerlink" title="第一步"></a>第一步</h4><p>找到 <code>themes-&gt;next-&gt;layout-&gt;_partials-&gt;head.swig</code> 文件。添加如下代码(推荐加在所有的 <code>&lt;meta&gt;</code> 标签之后):</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">if</span>(<span class="string">&#x27;</span></span></span><span class="template-variable">&#123;&#123; <span class="name">page.password</span> &#125;&#125;</span><span class="language-xml">&#x27;)&#123;</span></span><br><span class="line"><span class="language-xml">if (prompt(&#x27;请输入文章密码&#x27;,&#x27;&#x27;) !== &#x27;</span><span class="template-variable">&#123;&#123; <span class="name">page.password</span> &#125;&#125;</span><span class="language-xml">&#x27;)&#123;</span></span><br><span class="line"><span class="language-xml">alert(&#x27;密码错误！&#x27;);</span></span><br><span class="line"><span class="language-xml">history.back();</span></span><br><span class="line"><span class="language-xml">&#125;</span></span><br><span class="line"><span class="language-xml">&#125;</span></span><br><span class="line"><span class="language-xml">&#125;)();</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h4 id="第二步"><a href="#第二步" class="headerlink" title="第二步"></a>第二步</h4><p>写博文的时候顶部的页面变量添加 <code>password: 密码</code> 即可，如:</p><hr><p>title: ‘2017-01-01’<br>permalink: post&#x2F;111111111.html<br>tags:</p><ul><li>心思随笔<br>date: 2017-01-01 00:00:00<br>password: 123</li></ul><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
          <category> Butterfly </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webpack-简易版实现</title>
      <link href="/posts/c9a3dda7/"/>
      <url>/posts/c9a3dda7/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="实现简易版webpack"><a href="#实现简易版webpack" class="headerlink" title="实现简易版webpack"></a>实现简易版webpack</h2><h3 id="前期准备"><a href="#前期准备" class="headerlink" title="前期准备"></a>前期准备</h3><h4 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h4><p>先初始化一个项目，结构树如下：</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string">-- forestpack</span></span><br><span class="line"><span class="string">    </span>|<span class="string">-- dist</span></span><br><span class="line"><span class="string">    </span>|<span class="string">   </span>|<span class="string">-- bundle.js</span></span><br><span class="line"><span class="string">    </span>|<span class="string">   </span>|<span class="string">-- index.html</span></span><br><span class="line"><span class="string">    </span>|<span class="string">-- lib</span></span><br><span class="line"><span class="string">    </span>|<span class="string">   </span>|<span class="string">-- compiler.js</span></span><br><span class="line"><span class="string">    </span>|<span class="string">   </span>|<span class="string">-- index.js</span></span><br><span class="line"><span class="string">    </span>|<span class="string">   </span>|<span class="string">-- parser.js</span></span><br><span class="line"><span class="string">    </span>|<span class="string">   </span>|<span class="string">-- test.js</span></span><br><span class="line"><span class="string">    </span>|<span class="string">-- src</span></span><br><span class="line"><span class="string">    </span>|<span class="string">   </span>|<span class="string">-- greeting.js</span></span><br><span class="line"><span class="string">    </span>|<span class="string">   </span>|<span class="string">-- index.js</span></span><br><span class="line"><span class="string">    </span>|<span class="string">-- forstpack.config.js</span></span><br><span class="line"><span class="string">    </span>|<span class="string">-- package.json</span></span><br></pre></td></tr></table></figure><p>每个文件&#x2F;文件夹对应含义：</p><ul><li><code>dist</code>：打包目录</li><li><code>lib</code>：核心文件，主要包括 <code>compiler</code> 和 <code>parser</code><ul><li><code>compiler.js</code>：编译相关。<code>Compiler</code> 为一个类, 并且有 <code>run</code> 方法去开启编译，还有构建 <code>module</code>（<code>buildModule</code>）和输出文件（<code>emitFiles</code>）</li><li><code>parser.js</code>：解析相关。包含解析 <code>AST</code>（<code>getAST</code>）、收集依赖（<code>getDependencies</code>）、转换（<code>es6转es5</code>）</li><li><code>index.js</code>：实例化 <code>Compiler</code> 类，并将配置参数（对应 <code>forstpack.config.js</code>）传入</li><li><code>test.js</code>：测试文件，用于测试方法函数输出 <code>console</code> 使用</li></ul></li><li><code>src</code>：源代码。也就对应我们的业务代码</li><li><code>forstpack.config.js</code>： 配置文件。类似 <code>webpack.config.js</code></li><li><code>package.json</code></li></ul><h4 id="完善基础文件"><a href="#完善基础文件" class="headerlink" title="完善基础文件"></a>完善基础文件</h4><p>基础文件需要先完善：<code>forstpack.config.js</code> 和 <code>src</code> 。</p><p>首先是 <code>forstpack.config.js</code> ：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">entry</span>: path.<span class="title function_">join</span>(__dirname, <span class="string">&quot;./src/index.js&quot;</span>),</span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">path</span>: path.<span class="title function_">join</span>(__dirname, <span class="string">&quot;./dist&quot;</span>),</span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&quot;bundle.js&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>其次是 <code>src</code> ，这里在 <code>src</code> 目录下定义两个文件：</p><ul><li><code>greeting.js</code> ：</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// greeting.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">greeting</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;你好&quot;</span> + name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>index.js</code> ：</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; greeting &#125; <span class="keyword">from</span> <span class="string">&quot;./greeting.js&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="title function_">greeting</span>(<span class="string">&quot;森林&quot;</span>));</span><br></pre></td></tr></table></figure><h3 id="后续完善"><a href="#后续完善" class="headerlink" title="后续完善"></a>后续完善</h3><h4 id="compile-js-编写"><a href="#compile-js-编写" class="headerlink" title="compile.js 编写"></a>compile.js 编写</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">class</span> <span class="title class_">Compiler</span> &#123;</span><br><span class="line">    <span class="comment">// 接收通过lib/index.js new Compiler(options).run()传入的参数，对应`forestpack.config.js`的配置</span></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">options</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; entry, output &#125; = options;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">entry</span> = entry;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">output</span> = output;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">modules</span> = [];</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 开启编译</span></span><br><span class="line">    <span class="title function_">run</span>(<span class="params"></span>) &#123;&#125;,</span><br><span class="line">    <span class="comment">// 构建模块相关</span></span><br><span class="line">    <span class="title function_">buildModule</span>(<span class="params">filename, isEntry</span>) &#123;</span><br><span class="line">        <span class="comment">// filename: 文件名称</span></span><br><span class="line">        <span class="comment">// isEntry: 是否是入口文件</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 输出文件</span></span><br><span class="line">    <span class="title function_">emitFiles</span>(<span class="params"></span>) &#123;&#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><code>compile.js</code> 主要做了几个事情：</p><ul><li>接收 <code>forestpack.config.js</code> 配置参数，并初始化 <code>entry</code> 、 <code>output</code></li><li>开启编译 <code>run</code> 方法。处理构建模块、收集依赖、输出文件等。</li><li><code>buildModule</code> 方法。主要用于构建模块（被 <code>run</code> 方法调用）</li><li><code>emitFiles</code> 方法。输出文件（同样被 <code>run</code> 方法调用）</li></ul><p>到这里，<code>compiler.js</code> 的大致结构已经出来了，但是得到模块的源码后，需要去解析，替换源码和获取模块的依赖项，也就对应我们下面需要完善的 <code>parser.js</code> 。</p><h4 id="parser-js-编写"><a href="#parser-js-编写" class="headerlink" title="parser.js 编写"></a>parser.js 编写</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="comment">// const babylon = require(&quot;babylon&quot;);</span></span><br><span class="line"><span class="keyword">const</span> parser = <span class="built_in">require</span>(<span class="string">&quot;@babel/parser&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> traverse = <span class="built_in">require</span>(<span class="string">&quot;@babel/traverse&quot;</span>).<span class="property">default</span>;</span><br><span class="line"><span class="keyword">const</span> &#123; transformFromAst &#125; = <span class="built_in">require</span>(<span class="string">&quot;babel-core&quot;</span>);</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="comment">// 解析我们的代码生成AST抽象语法树</span></span><br><span class="line">    <span class="attr">getAST</span>: <span class="function">(<span class="params">path</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> source = fs.<span class="title function_">readFileSync</span>(path, <span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> parser.<span class="title function_">parse</span>(source, &#123;</span><br><span class="line">            <span class="attr">sourceType</span>: <span class="string">&quot;module&quot;</span>, <span class="comment">//表示我们要解析的是ES模块</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 对AST节点进行递归遍历</span></span><br><span class="line">    <span class="attr">getDependencies</span>: <span class="function">(<span class="params">ast</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> dependencies = [];</span><br><span class="line">        <span class="title function_">traverse</span>(ast, &#123;</span><br><span class="line">            <span class="title class_">ImportDeclaration</span>: <span class="function">(<span class="params">&#123; node &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">                dependencies.<span class="title function_">push</span>(node.<span class="property">source</span>.<span class="property">value</span>);</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> dependencies;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 将获得的ES6的AST转化成ES5</span></span><br><span class="line">    <span class="attr">transform</span>: <span class="function">(<span class="params">ast</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; code &#125; = <span class="title function_">transformFromAst</span>(ast, <span class="literal">null</span>, &#123;</span><br><span class="line">            <span class="attr">presets</span>: [<span class="string">&quot;env&quot;</span>],</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> code;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>用到的几个 <code>babel</code> 包：</p><ul><li><code>@babel/parser</code>：用于将源码生成 <code>AST</code></li><li><code>@babel/traverse</code>：对 <code>AST</code> 节点进行递归遍历</li><li><code>babel-core</code>&#x2F;<code>@babel/preset-env</code>：将获得的 <code>ES6</code> 的 <code>AST</code> 转化成 <code>ES5</code></li></ul><p><code>parser.js</code>中主要就三个方法：</p><ul><li><code>getAST</code>： 将获取到的模块内容 解析成 <code>AST</code> 语法树</li><li><code>getDependencies</code>：遍历 <code>AST</code> ，将用到的依赖收集起来</li><li><code>transform</code>：把获得的 <code>ES6</code> 的 <code>AST</code> 转化成 <code>ES5</code></li></ul><h4 id="完善-compiler-js"><a href="#完善-compiler-js" class="headerlink" title="完善 compiler.js"></a>完善 compiler.js</h4><p>上面已经将 <code>compiler.js</code> 中会用到的函数占好位置，下面需要完善 <code>compiler.js</code> ，当然会用到 <code>parser.js</code> 中的一些方法</p><p>代码如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; getAST, getDependencies, transform &#125; = <span class="built_in">require</span>(<span class="string">&quot;./parser&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">class</span> <span class="title class_">Compiler</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">options</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; entry, output &#125; = options;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">entry</span> = entry;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">output</span> = output;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">modules</span> = [];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 开启编译</span></span><br><span class="line">    <span class="title function_">run</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> entryModule = <span class="variable language_">this</span>.<span class="title function_">buildModule</span>(<span class="variable language_">this</span>.<span class="property">entry</span>, <span class="literal">true</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">modules</span>.<span class="title function_">push</span>(entryModule);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">modules</span>.<span class="title function_">map</span>(<span class="function">(<span class="params">_module</span>) =&gt;</span> &#123;</span><br><span class="line">            _module.<span class="property">dependencies</span>.<span class="title function_">map</span>(<span class="function">(<span class="params">dependency</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">modules</span>.<span class="title function_">push</span>(<span class="variable language_">this</span>.<span class="title function_">buildModule</span>(dependency));</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// console.log(this.modules);</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">emitFiles</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 构建模块相关</span></span><br><span class="line">    <span class="title function_">buildModule</span>(<span class="params">filename, isEntry</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> ast;</span><br><span class="line">        <span class="keyword">if</span> (isEntry) &#123;</span><br><span class="line">            ast = <span class="title function_">getAST</span>(filename);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> absolutePath = path.<span class="title function_">join</span>(process.<span class="title function_">cwd</span>(), <span class="string">&quot;./src&quot;</span>, filename);</span><br><span class="line">            ast = <span class="title function_">getAST</span>(absolutePath);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            filename, <span class="comment">// 文件名称</span></span><br><span class="line">            <span class="attr">dependencies</span>: <span class="title function_">getDependencies</span>(ast), <span class="comment">// 依赖列表</span></span><br><span class="line">            <span class="attr">transformCode</span>: <span class="title function_">transform</span>(ast), <span class="comment">// 转化后的代码</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 输出文件</span></span><br><span class="line">    <span class="title function_">emitFiles</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> outputPath = path.<span class="title function_">join</span>(<span class="variable language_">this</span>.<span class="property">output</span>.<span class="property">path</span>, <span class="variable language_">this</span>.<span class="property">output</span>.<span class="property">filename</span>);</span><br><span class="line">        <span class="keyword">let</span> modules = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">modules</span>.<span class="title function_">map</span>(<span class="function">(<span class="params">_module</span>) =&gt;</span> &#123;</span><br><span class="line">        modules += <span class="string">`&#x27;<span class="subst">$&#123;_module.filename&#125;</span>&#x27; : function(require, module, exports) &#123;<span class="subst">$&#123;_module.transformCode&#125;</span>&#125;,`</span>;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> bundle = <span class="string">`</span></span><br><span class="line"><span class="string">            (function(modules) &#123;</span></span><br><span class="line"><span class="string">                function require(fileName) &#123;</span></span><br><span class="line"><span class="string">                    const fn = modules[fileName];</span></span><br><span class="line"><span class="string">                    const module = &#123; exports:&#123;&#125;&#125;;</span></span><br><span class="line"><span class="string">                    fn(require, module, module.exports)</span></span><br><span class="line"><span class="string">                    return module.exports</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">                require(&#x27;<span class="subst">$&#123;<span class="variable language_">this</span>.entry&#125;</span>&#x27;)</span></span><br><span class="line"><span class="string">            &#125;)(&#123;<span class="subst">$&#123;modules&#125;</span>&#125;)</span></span><br><span class="line"><span class="string">        `</span>;</span><br><span class="line">        fs.<span class="title function_">writeFileSync</span>(outputPath, bundle, <span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>这里主要来看下 <code>emitFiles</code> ：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">emitFiles</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> outputPath = path.<span class="title function_">join</span>(<span class="variable language_">this</span>.<span class="property">output</span>.<span class="property">path</span>, <span class="variable language_">this</span>.<span class="property">output</span>.<span class="property">filename</span>);</span><br><span class="line">    <span class="keyword">let</span> modules = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">modules</span>.<span class="title function_">map</span>(<span class="function">(<span class="params">_module</span>) =&gt;</span> &#123;</span><br><span class="line">        modules += <span class="string">`&#x27;<span class="subst">$&#123;_module.filename&#125;</span>&#x27; : function(require, module, exports) &#123;<span class="subst">$&#123;_module.transformCode&#125;</span>&#125;,`</span>;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> bundle = <span class="string">`</span></span><br><span class="line"><span class="string">        (function(modules) &#123;</span></span><br><span class="line"><span class="string">            function require(fileName) &#123;</span></span><br><span class="line"><span class="string">                const fn = modules[fileName];</span></span><br><span class="line"><span class="string">                const module = &#123; exports:&#123;&#125;&#125;;</span></span><br><span class="line"><span class="string">                fn(require, module, module.exports)</span></span><br><span class="line"><span class="string">                return module.exports</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">            require(&#x27;<span class="subst">$&#123;<span class="variable language_">this</span>.entry&#125;</span>&#x27;)</span></span><br><span class="line"><span class="string">        &#125;)(&#123;<span class="subst">$&#123;modules&#125;</span>&#125;)</span></span><br><span class="line"><span class="string">    `</span>;</span><br><span class="line"></span><br><span class="line">    fs.<span class="title function_">writeFileSync</span>(outputPath, bundle, <span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>我们先来了解下 <code>webpack</code> 的文件 📦 机制。下面一段代码是经过 <code>webpack</code> 打包精简过后的代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// dist/index.xxxx.js</span></span><br><span class="line">(<span class="keyword">function</span>(<span class="params">modules</span>) &#123;</span><br><span class="line">    <span class="comment">// 已经加载过的模块</span></span><br><span class="line">    <span class="keyword">var</span> installedModules = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 模块加载函数</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">__webpack_require__</span>(<span class="params">moduleId</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(installedModules[moduleId]) &#123;</span><br><span class="line">            <span class="keyword">return</span> installedModules[moduleId].<span class="property">exports</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> <span class="variable language_">module</span> = installedModules[moduleId] = &#123;</span><br><span class="line">            <span class="attr">i</span>: moduleId,</span><br><span class="line">            <span class="attr">l</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">exports</span>: &#123;&#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        modules[moduleId].<span class="title function_">call</span>(<span class="variable language_">module</span>.<span class="property">exports</span>, <span class="variable language_">module</span>, <span class="variable language_">module</span>.<span class="property">exports</span>, __webpack_require__);</span><br><span class="line">        <span class="variable language_">module</span>.<span class="property">l</span> = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">module</span>.<span class="property">exports</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">__webpack_require__</span>(<span class="number">0</span>);</span><br><span class="line">&#125;)([</span><br><span class="line">    <span class="comment">/* 0 module */</span></span><br><span class="line">    (<span class="keyword">function</span>(<span class="params"><span class="variable language_">module</span>, <span class="built_in">exports</span>, __webpack_require__</span>) &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="comment">/* 1 module */</span></span><br><span class="line">    (<span class="keyword">function</span>(<span class="params"><span class="variable language_">module</span>, <span class="built_in">exports</span>, __webpack_require__</span>) &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="comment">/* n module */</span></span><br><span class="line">    (<span class="keyword">function</span>(<span class="params"><span class="variable language_">module</span>, <span class="built_in">exports</span>, __webpack_require__</span>) &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;)</span><br><span class="line">]);</span><br></pre></td></tr></table></figure><p>简单分析下：</p><ul><li><code>webpack</code> 将所有模块(可以简单理解成文件)包裹于一个函数中，并传入默认参数，将所有模块放入一个数组中，取名为 <code>modules</code> ，并通过数组的下标来作为 <code>moduleId</code> 。</li><li>将 <code>modules</code> 传入一个自执行函数中，自执行函数中包含一个 <code>installedModules</code> 已经加载过的模块和一个模块加载函数，最后加载入口模块并返回。</li><li><code>__webpack_require__</code> 模块加载，先判断 <code>installedModules</code> 是否已加载，加载过了就直接返回 <code>exports</code> 数据，没有加载过该模块就通过 <code>modules[moduleId].call(module.exports, module, module.exports, __webpack_require__)</code> 执行模块并且将 <code>module.exports</code> 给返回。</li></ul><p>换个说法：</p><ul><li>经过 <code>webpack</code> 打包出来的是一个匿名闭包函数（<code>IIFE</code>）</li><li><code>modules</code> 是一个数组，每一项是一个模块初始化函数</li><li><code>__webpack_require__</code> 用来加载模块，返回 <code>module.exports</code></li><li>通过 <code>WEBPACK_REQUIRE_METHOD(0)</code> 启动程序</li></ul><h4 id="lib-x2F-index-js-入口文件编写"><a href="#lib-x2F-index-js-入口文件编写" class="headerlink" title="lib&#x2F;index.js 入口文件编写"></a>lib&#x2F;index.js 入口文件编写</h4><p>到这里，就剩最后一步了（似乎见到了胜利的曙光）。在 <code>lib</code> 目录创建 <code>index.js</code> ：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Compiler</span> = <span class="built_in">require</span>(<span class="string">&quot;./compiler&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> options = <span class="built_in">require</span>(<span class="string">&quot;../forestpack.config&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Compiler</span>(options).<span class="title function_">run</span>();</span><br></pre></td></tr></table></figure><p>这里逻辑就比较简单了：实例化 <code>Compiler</code> 类，并将配置参数（对应 <code>forstpack.config.js</code>）传入。</p><p>运行 <code>node lib/index.js</code> 就会在 <code>dist</code> 目录下生成 <code>bundle.js</code> 文件。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span> (<span class="params">modules</span>) &#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">require</span>(<span class="params">fileName</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> fn = modules[fileName];</span><br><span class="line">        <span class="keyword">const</span> <span class="variable language_">module</span> = &#123; <span class="attr">exports</span>: &#123;&#125; &#125;;</span><br><span class="line">        <span class="title function_">fn</span>(<span class="built_in">require</span>, <span class="variable language_">module</span>, <span class="variable language_">module</span>.<span class="property">exports</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">module</span>.<span class="property">exports</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">require</span>(<span class="string">&quot;/Users/fengshuan/Desktop/workspace/forestpack/src/index.js&quot;</span>);</span><br><span class="line">&#125;)(&#123;</span><br><span class="line">    <span class="string">&quot;/Users/fengshuan/Desktop/workspace/forestpack/src/index.js&quot;</span>: <span class="keyword">function</span> (<span class="params"></span></span><br><span class="line"><span class="params">        <span class="built_in">require</span>,</span></span><br><span class="line"><span class="params">        <span class="variable language_">module</span>,</span></span><br><span class="line"><span class="params">        <span class="built_in">exports</span></span></span><br><span class="line"><span class="params">    </span>) &#123;</span><br><span class="line">        <span class="string">&quot;use strict&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> _greeting = <span class="built_in">require</span>(<span class="string">&quot;./greeting.js&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">write</span>((<span class="number">0</span>, _greeting.<span class="property">greeting</span>)(<span class="string">&quot;森林&quot;</span>));</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;./greeting.js&quot;</span>: <span class="keyword">function</span> (<span class="params"><span class="built_in">require</span>, <span class="variable language_">module</span>, <span class="built_in">exports</span></span>) &#123;</span><br><span class="line">        <span class="string">&quot;use strict&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(<span class="built_in">exports</span>, <span class="string">&quot;__esModule&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">value</span>: <span class="literal">true</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="built_in">exports</span>.<span class="property">greeting</span> = greeting;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">greeting</span>(<span class="params">name</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;你好&quot;</span> + name;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>和上面用 <code>webpack</code> 打包生成的 <code>js</code> 文件作下对比，是不是很相似呢？</p><h4 id="来吧！展示"><a href="#来吧！展示" class="headerlink" title="来吧！展示"></a>来吧！展示</h4><p>我们在 <code>dist</code> 目录下创建 <code>index.html</code> 文件，引入打包生成的 <code>bundle.js</code> 文件：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./bundle.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>此时打开浏览器：</p><p>如你所愿，得到了我们预期的结果～</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> 打包/封装 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webpack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webpack-自学之路</title>
      <link href="/posts/2aceaaa9/"/>
      <url>/posts/2aceaaa9/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a href="https://webpack.js.org/"><img src="https://webpack.js.org/site-logo.1fcab817090e78435061.svg" alt="webpack logo"></a></p><p><a href="www.shouxicto.com/article/5068.html">Webpack 高级配置即优化</a></p><p>frontEnd&#x2F;0-2webpack\webpack-自学之路.md</p><a href="/posts/633a1a9/" title="webpack 和 gulp 的区别">webpack 和 gulp 的区别</a>`</br>`<a href="/posts/324dbcc7/" title="webpack-使用指南（阮一峰）">webpack-使用指南（阮一峰）</a>`</br>`<a href="/posts/4d079656/" title="webpack4-基本打包机制">webpack4-基本打包机制</a>`</br>`<a href="/posts/c9a3dda7/" title="webpack-简易版实现">webpack-简易版实现</a>`</br>`<a href="/posts/13fcc20/" title="webpack-loader">webpack-loader</a>`</br>`<a href="/posts/570219c2/" title="webpack-plugin">webpack-plugin</a>`</br>`<a href="/posts/9c2ae1bb/" title="webpack-HMR原理">webpack-HMR原理</a>`</br>`<a href="/posts/24696c81/" title="webpack-性能优化总结大全">webpack-性能优化总结大全</a>`</br>`<a href="/posts/ce8b16f6/" title="webpack-构建工具选择">webpack-构建工具选择</a>`</br>`<a href="/posts/fe106d98/" title="webpack-优化打包速度">webpack-优化打包速度</a>`</br>`]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> webpack </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webpack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webpack-HMR原理</title>
      <link href="/posts/9c2ae1bb/"/>
      <url>/posts/9c2ae1bb/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="Webpack中的HMR原理"><a href="#Webpack中的HMR原理" class="headerlink" title="Webpack中的HMR原理"></a>Webpack中的HMR原理</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>Hot Module Replacement（简称 HMR）。</p><p>其实是 <code>开启了express应用</code> ，添加了对 <code>webpack</code> 编译的监听，添加了和浏览器的 <code>websocket</code> 长连接，当文件变化触发 <code>webpack</code> 进行编译并完成后，会通过 <code>sokcet</code> 消息告诉浏览器准备刷新。而为了减少刷新的代价，就是 <code>不用刷新网页</code> ，而是 <code>刷新某个模块</code> ，<code>webpack-dev-server</code> 可以支持热更新，通过生成 文件的 <code>hash</code> 值来比对需要更新的模块，浏览器再进行热替换。</p><p>基本实现原理：在构建 <code>bundle</code> 的时候，加入一段 <code>HMR runtime</code> 的 <code>js</code> 、一段与服务沟通过的 <code>js</code> 。文件修改会触发 <code>webpack</code> 重新构建，服务器通过向浏览器发送更新消息，浏览器通过 <code>jsonp</code> 拉取更新的模块文件，<code>jsonp</code> 回调触发模块热替换逻辑。</p><h3 id="服务端"><a href="#服务端" class="headerlink" title="服务端"></a><code>服务端</code></h3><ul><li>启动 <code>webpack-dev-server</code> 服务器</li><li>创建 <code>webpack</code> 实例</li><li>创建 <code>server</code> 服务器</li><li>添加 <code>webpack</code> 的 <code>done</code> 事件回调</li><li>编译完成向客户端发送消息</li><li>创建 <code>express</code> 应用 <code>app</code></li><li>设置文件系统为内存文件系统</li><li>添加 <code>webpack-dev-middleware</code> 中间件</li><li>中间件负责返回生成的文件</li><li>启动 <code>webpack</code> 编译</li><li>创建 <code>http</code> 服务器并启动服务</li><li>使用 <code>sockjs</code> 在浏览器端和服务端之间建立一个 <code>websocket</code> 长连接</li><li>创建 <code>socket</code> 服务器</li></ul><h3 id="客户端"><a href="#客户端" class="headerlink" title="客户端"></a><code>客户端</code></h3><ul><li><code>webpack-dev-server/client</code> 端会监听到此 <code>hash</code> 消息</li><li>客户端收到 <code>ok</code> 消息后会执行 <code>reloadApp</code> 方法进行更新</li><li>在 <code>reloadApp</code> 中会进行判断，是否支持热更新，如果支持的话发生  <code>webpackHotUpdate</code> 事件，如果不支持就直接刷新浏览器</li><li>在 <code>webpack/hot/dev-server.js</code> 会监听 <code>webpackHotUpdate</code> 事件</li><li>在 <code>check</code> 方法里会调用 <code>module.hot.check</code> 方法</li><li><code>HotModuleReplacement.runtime</code> 请求 <code>Manifest</code></li><li>通过调用 <code>JsonpMainTemplate.runtime</code> 的 <code>hotDownloadManifest</code> 方法</li><li>调用 <code>JsonpMainTemplate.runtime</code>的 <code>hotDownloadUpdateChunk</code> 方法通过 <code>JSONP</code> 请求获取最新的模块代码</li><li>补丁 <code>js</code> 取回来或会调用 <code>JsonpMainTemplate.runtime.js</code> 的 <code>webpackHotUpdate</code> 方法</li><li>然后会调用 <code>HotModuleReplacement.runtime.js</code> 的 <code>hotAddUpdateChunk</code> 方法动态更新 模块代码</li><li>然后调用 <code>hotApply</code> 方法进行热更</li></ul><h3 id="热更新配置"><a href="#热更新配置" class="headerlink" title="热更新配置"></a>热更新配置</h3><p><strong>使用webpack-dev-server,设置 hot 属性为 true.</strong><br>写模块时，按照以下写法:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable language_">module</span>.<span class="property">hot</span>) &#123; <span class="comment">//判断是否有热加载</span></span><br><span class="line">    <span class="variable language_">module</span>.<span class="property">hot</span>.<span class="title function_">accept</span>(<span class="string">&#x27;./hmrTest.js&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123; <span class="comment">//热加载的模块路径</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Accepting the updated printMe module!&#x27;</span>); <span class="comment">//热加载的回调，即发生了模块更新时，执行什么 callback</span></span><br><span class="line">        <span class="title function_">printMe</span>();</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>缺点：更新逻辑得自己写。比如要使页面显示的内容生效，需要在回调中写入document.append(xxx)</p><p><strong>react 的热加载，使用 react-hot-loader</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; hot &#125; <span class="keyword">from</span> <span class="string">&#x27;react-hot-loader&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Record</span> = (<span class="params"></span>)=&gt;&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">hot</span>(<span class="variable language_">module</span>)(<span class="title class_">Record</span>);</span><br></pre></td></tr></table></figure><p>或</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable language_">module</span>.<span class="property">hot</span>) &#123;</span><br><span class="line">    <span class="variable language_">module</span>.<span class="property">hot</span>.<span class="title function_">accept</span>(<span class="string">&#x27;./App&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">NextApp</span> = <span class="built_in">require</span>(<span class="string">&#x27;./App&#x27;</span>)</span><br><span class="line">        <span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">NextApp</span> /&gt;</span></span>, rootEl)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="实现过程"><a href="#实现过程" class="headerlink" title="实现过程"></a>实现过程</h3><ol><li><code>watch</code> 编译过程、<code>devServer</code> 推送更新消息到浏览器</li><li>浏览器接收到服务端消息做出响应</li><li>对模块进行热更新或刷新页面</li></ol><h3 id="watch-编译过程、devServer-推送更新消息到浏览器"><a href="#watch-编译过程、devServer-推送更新消息到浏览器" class="headerlink" title="watch 编译过程、devServer 推送更新消息到浏览器"></a>watch 编译过程、devServer 推送更新消息到浏览器</h3><ol><li><code>webpack-dev-server</code> 里引用了 <code>webpack-dev-middleware</code> ，相关的 <code>watch</code> 逻辑就是在里面实现的。</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//webpack-dev-server/lib/Server.js</span></span><br><span class="line"><span class="title function_">setupDevMiddleware</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// middleware for serving webpack bundle</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">middleware</span> = <span class="title function_">webpackDevMiddleware</span>(</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">compiler</span>,</span><br><span class="line">        <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, <span class="variable language_">this</span>.<span class="property">options</span>, &#123; </span><br><span class="line">            <span class="attr">logLevel</span>: <span class="variable language_">this</span>.<span class="property">log</span>.<span class="property">options</span>.<span class="property">level</span> </span><br><span class="line">        &#125;)</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line">    <span class="comment">// webpack-dev-middleware/index.js</span></span><br><span class="line">    <span class="keyword">if</span> (!options.<span class="property">lazy</span>) &#123;</span><br><span class="line">        context.<span class="property">watching</span> = compiler.<span class="title function_">watch</span>(options.<span class="property">watchOptions</span>, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                context.<span class="property">log</span>.<span class="title function_">error</span>(err.<span class="property">stack</span> || err);</span><br><span class="line">                <span class="keyword">if</span> (err.<span class="property">details</span>) &#123;</span><br><span class="line">                    context.<span class="property">log</span>.<span class="title function_">error</span>(err.<span class="property">details</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        context.<span class="property">state</span> = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>以上代码可以看出，<code>webpack-dev-middleware</code> 是通过调用 <code>webpack</code> 的 <code>api</code> 对文件系统 <code>watch</code> 的。<code>watchOptions</code> 如果没有配置的话，会取默认值。值含义见：<a href="https://webpack.js.org/configuration/watch/">值含义</a></p><ol start="2"><li>当文件发生变化时，重新编译输出 <code>bundle.js。devServer</code> 下，是没有文件会输出到 <code>output.path</code> 目录下的，这时 <code>webpack</code> 是把文件输出到了内存中。<code>webpack</code> 中使用的操作内存的库是 <code>memory-fs</code> ，它是 <code>NodeJS</code> 原生 <code>fs</code> 模块内存版(<code>in-memory</code>)的完整功能实现，会将你请求的 <code>url</code> 映射到对应的内存区域当中，因此读写都比较快。</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack-dev-middleware/lib/fs.js</span></span><br><span class="line"><span class="keyword">const</span> isMemoryFs =</span><br><span class="line">    !isConfiguredFs &amp;&amp;</span><br><span class="line">    !compiler.<span class="property">compilers</span> &amp;&amp;</span><br><span class="line">    compiler.<span class="property">outputFileSystem</span> <span class="keyword">instanceof</span> <span class="title class_">MemoryFileSystem</span>;</span><br><span class="line">    ...</span><br><span class="line">    compiler.<span class="property">outputFileSystem</span> = fs;</span><br><span class="line">    fileSystem = fs;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isMemoryFs) &#123;</span><br><span class="line">        fileSystem = compiler.<span class="property">outputFileSystem</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        fileSystem = <span class="keyword">new</span> <span class="title class_">MemoryFileSystem</span>();</span><br><span class="line">        compiler.<span class="property">outputFileSystem</span> = fileSystem;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><ol start="3"><li><code>devServer</code> 通知浏览器端文件发生改变，在启动 <code>devServer</code> 的时候，<code>sockjs</code> 在服务端和浏览器端建立了一个 <code>webSocket</code> 长连接，以便将 <code>webpack</code> 编译和打包的各个阶段状态告知浏览器，最关键的步骤还是 <code>webpack-dev-server</code> 调用 <code>webpack api</code> 监听 <code>compile</code> 的 <code>done</code> 事件，当 <code>compile</code> 完成后，<code>webpack-dev-server</code> 通过 <code>_sendStatus</code> 方法将编译打包后的新模块 <code>hash</code> 值发送到浏览器端。</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack-dev-server/lib/Server.js</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">addHooks</span> = (<span class="params">compiler</span>) =&gt; &#123;</span><br><span class="line">    ...</span><br><span class="line">    done.<span class="title function_">tap</span>(<span class="string">&#x27;webpack-dev-server&#x27;</span>, <span class="function">(<span class="params">stats</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">_sendStats</span>(<span class="variable language_">this</span>.<span class="property">sockets</span>, <span class="variable language_">this</span>.<span class="title function_">getStats</span>(stats));</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_stats</span> = stats;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line">...</span><br><span class="line"><span class="comment">// send stats to a socket or multiple sockets</span></span><br><span class="line"><span class="title function_">_sendStats</span>(<span class="params">sockets, stats, force</span>) &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">sockWrite</span>(sockets, <span class="string">&#x27;hash&#x27;</span>, stats.<span class="property">hash</span>);</span><br><span class="line">    <span class="keyword">if</span> (stats.<span class="property">errors</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">sockWrite</span>(sockets, <span class="string">&#x27;errors&#x27;</span>, stats.<span class="property">errors</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (stats.<span class="property">warnings</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">sockWrite</span>(sockets, <span class="string">&#x27;warnings&#x27;</span>, stats.<span class="property">warnings</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">sockWrite</span>(sockets, <span class="string">&#x27;ok&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="浏览器接收到服务端消息做出响应"><a href="#浏览器接收到服务端消息做出响应" class="headerlink" title="浏览器接收到服务端消息做出响应"></a>浏览器接收到服务端消息做出响应</h3><ol><li>这里的主要逻辑位于 <code>webpack-dev-server/client-src</code> 中，<code>webpack-dev-server</code> 修改了 <code>webpack</code> 配置中的 <code>entry</code> 属性，在里面添加了 <code>webpack-dev-client</code> 的代码，这样在最后的 <code>bundle.js</code> 文件中就会有接收 <code>websocket</code> 消息的代码了。</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//webpack-dev-server/lib/utils/addEntries.js</span></span><br><span class="line"><span class="comment">/* @type &#123;string&#125; */</span></span><br><span class="line"><span class="keyword">const</span> clientEntry = <span class="string">`<span class="subst">$&#123;<span class="built_in">require</span>.resolve(</span></span></span><br><span class="line"><span class="subst"><span class="string">    <span class="string">&#x27;../../client/&#x27;</span></span></span></span><br><span class="line"><span class="subst"><span class="string">    )&#125;</span>?<span class="subst">$&#123;domain&#125;</span><span class="subst">$&#123;sockHost&#125;</span><span class="subst">$&#123;sockPath&#125;</span><span class="subst">$&#123;sockPort&#125;</span>`</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* @type &#123;(string[] | string)&#125; */</span></span><br><span class="line"><span class="keyword">let</span> hotEntry;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (options.<span class="property">hotOnly</span>) &#123;</span><br><span class="line">    hotEntry = <span class="built_in">require</span>.<span class="title function_">resolve</span>(<span class="string">&#x27;webpack/hot/only-dev-server&#x27;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (options.<span class="property">hot</span>) &#123;</span><br><span class="line">    hotEntry = <span class="built_in">require</span>.<span class="title function_">resolve</span>(<span class="string">&#x27;webpack/hot/dev-server&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">[].<span class="title function_">concat</span>(config).<span class="title function_">forEach</span>(<span class="function">(<span class="params">config</span>) =&gt;</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">const</span> additionalEntries = <span class="title function_">checkInject</span>(</span><br><span class="line">        options.<span class="property">injectClient</span>,</span><br><span class="line">        config,</span><br><span class="line">        webTarget</span><br><span class="line">    )</span><br><span class="line">    ? [clientEntry]</span><br><span class="line">    : [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (hotEntry &amp;&amp; <span class="title function_">checkInject</span>(options.<span class="property">injectHot</span>, config, <span class="literal">true</span>)) &#123;</span><br><span class="line">        additionalEntries.<span class="title function_">push</span>(hotEntry);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    config.<span class="property">entry</span> = <span class="title function_">prependEntry</span>(config.<span class="property">entry</span> || <span class="string">&#x27;./src&#x27;</span>, additionalEntries);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (options.<span class="property">hot</span> || options.<span class="property">hotOnly</span>) &#123;</span><br><span class="line">        config.<span class="property">plugins</span> = config.<span class="property">plugins</span> || [];</span><br><span class="line">        <span class="keyword">if</span> (!config.<span class="property">plugins</span>.<span class="title function_">find</span>(</span><br><span class="line">            <span class="function">(<span class="params">plugin</span>) =&gt;</span> plugin.<span class="property">constructor</span>.<span class="property">name</span> === <span class="string">&#x27;HotModuleReplacementPlugin&#x27;</span></span><br><span class="line">        )</span><br><span class="line">        ) &#123;</span><br><span class="line">            config.<span class="property">plugins</span>.<span class="title function_">push</span>(<span class="keyword">new</span> webpack.<span class="title class_">HotModuleReplacementPlugin</span>());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ol start="2"><li>以上代码可以看出，如果选择了热加载，输出的 <code>bundle.js</code> 会包含接收 <code>websocket</code> 消息的代码。而且 <code>plugin</code> 也会注入一个 <code>HotModuleReplacementPlugin</code> ，构建过程中热加载相关的逻辑都在这个插件中。这个插件主要处理两部分逻辑：</li></ol><ul><li>注入 <code>HMR runtime</code> 逻辑</li><li>找到修改的模块，生成一个补丁 <code>js</code> 文件和更新描述 <code>json</code> 文件<br>先看一张图，看看 <code>websocket</code> 中的消息长什么样子：<br><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/8/9/16c75bb62b71afd9~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp" alt="GitHub"><br>可以看到，接收的消息只有 <code>type</code> 和 <code>hash</code> 两个内容。在 <code>client</code> 里面的逻辑，他们分别对应不同的处理逻辑：</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack-dev-server/client-src/default/index.js</span></span><br><span class="line"><span class="title function_">hash</span>(<span class="params">hash</span>) &#123;</span><br><span class="line">    status.<span class="property">currentHash</span> = hash;</span><br><span class="line">&#125;,</span><br><span class="line">...</span><br><span class="line"><span class="title function_">ok</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">sendMessage</span>(<span class="string">&#x27;Ok&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (options.<span class="property">useWarningOverlay</span> || options.<span class="property">useErrorOverlay</span>) &#123;</span><br><span class="line">        overlay.<span class="title function_">clear</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (options.<span class="property">initial</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> (options.<span class="property">initial</span> = <span class="literal">false</span>);</span><br><span class="line">    &#125; <span class="comment">// eslint-disable-line no-return-assign</span></span><br><span class="line">    <span class="title function_">reloadApp</span>(options, status);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>可以看出，当接收到 <code>type</code> 为 <code>hash</code> 消息后会将 <code>hash</code> 值暂存起来，当接收到 <code>type</code> 为 <code>ok</code> 的消息后对应用执行 <code>reload</code> 操作，而 <code>hash</code> 消息是在 <code>ok</code> 消息之前的。再看看 <code>reload</code> 里面的处理逻辑：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack-dev-server/client-src/default/reloadApp.js</span></span><br><span class="line"><span class="keyword">if</span> (hot) &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">const</span> hotEmitter = <span class="built_in">require</span>(<span class="string">&#x27;webpack/hot/emitter&#x27;</span>);</span><br><span class="line">        hotEmitter.<span class="title function_">emit</span>(<span class="string">&#x27;webpackHotUpdate&#x27;</span>, currentHash);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> self !== <span class="string">&#x27;undefined&#x27;</span> &amp;&amp; self.<span class="property">window</span>) &#123;</span><br><span class="line">        self.<span class="title function_">postMessage</span>(<span class="string">`webpackHotUpdate<span class="subst">$&#123;currentHash&#125;</span>`</span>, <span class="string">&#x27;*&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (liveReload) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>可以看出，如果配置了模块热更新，就调用 <code>webpack/hot/emitter</code> 将最新 <code>hash</code> 值发送给 <code>webpack</code> ，然后将控制权交给 <code>webpack</code> 客户端代码。如果没有配置模块热更新，就进行 <code>liveReload</code> 的逻辑。<code>webpack/hot/dev-server</code> 中会监听 <code>webpack-dev-server/client-src</code> 发送的 <code>webpackHotUpdate</code> 消息，然后调用 <code>webpack/lib/HotModuleReplacement.runtime</code> 中的 <code>check</code> 方法，检测是否有新的更新：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack/hot/dev-server.js</span></span><br><span class="line"><span class="keyword">var</span> hotEmitter = <span class="built_in">require</span>(<span class="string">&quot;./emitter&quot;</span>);</span><br><span class="line">hotEmitter.<span class="title function_">on</span>(<span class="string">&quot;webpackHotUpdate&quot;</span>, <span class="keyword">function</span>(<span class="params">currentHash</span>) &#123;</span><br><span class="line">    lastHash = currentHash;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_">upToDate</span>() &amp;&amp; <span class="variable language_">module</span>.<span class="property">hot</span>.<span class="title function_">status</span>() === <span class="string">&quot;idle&quot;</span>) &#123;</span><br><span class="line">        <span class="title function_">log</span>(<span class="string">&quot;info&quot;</span>, <span class="string">&quot;[HMR] Checking for updates on the server...&quot;</span>);</span><br><span class="line">        <span class="title function_">check</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// webpack/lib/HotModuleReplacement.runtime</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hotCheck</span>(<span class="params">apply</span>) &#123;</span><br><span class="line">...</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">hotDownloadManifest</span>(hotRequestTimeout).<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">update</span>) &#123;</span><br><span class="line">        ...</span><br><span class="line">            <span class="comment">/*globals chunkId */</span></span><br><span class="line">            <span class="title function_">hotEnsureUpdateChunk</span>(chunkId);</span><br><span class="line">        ...</span><br><span class="line">        <span class="keyword">return</span> promise;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hotEnsureUpdateChunk</span>(<span class="params">chunkId</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!hotAvailableFilesMap[chunkId]) &#123;</span><br><span class="line">        hotWaitingFilesMap[chunkId] = <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        hotRequestedFilesMap[chunkId] = <span class="literal">true</span>;</span><br><span class="line">        hotWaitingFiles++;</span><br><span class="line">        <span class="title function_">hotDownloadUpdateChunk</span>(chunkId);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="5"><li>以上代码可以看出，在 <code>check</code> 过程中，主要调用了两个方法 <code>hotDownloadManifest</code> 和 <code>hotDownloadUpdateChunk。hotDownloadManifest</code> 是通过 <code>Ajax</code> 向服务器请求十分有更新的文件，如果有就返回对应的文件信息，<code>hotDownloadUpdateChunk</code> 是通过 <code>Jsonp</code> 的方式，请求最新的代码模块。如下图所示:</li></ol><p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/8/9/16c75bb64ef0a9d2~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp" alt="GitHub"></p><p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/8/9/16c75bb67d383ae4~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp" alt="GitHub"></p><p>补充，这两个文件的名称是可以配置的，如果没有配置，则取定义在 <code>WebpackOptionsDefaulter</code> 中的默认配置。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="title function_">set</span>(<span class="string">&quot;output.hotUpdateChunkFilename&quot;</span>, <span class="string">&quot;[id].[hash].hot-update.js&quot;</span>);</span><br><span class="line"><span class="variable language_">this</span>.<span class="title function_">set</span>(<span class="string">&quot;output.hotUpdateMainFilename&quot;</span>, <span class="string">&quot;[hash].hot-update.json&quot;</span>);</span><br></pre></td></tr></table></figure><h3 id="对模块进行热更新或刷新页面"><a href="#对模块进行热更新或刷新页面" class="headerlink" title="对模块进行热更新或刷新页面"></a>对模块进行热更新或刷新页面</h3><p>综上，我们获得了更新的内容。接下来就可以进行更新了。这部分的逻辑在 <code>webpack/lib/HotModuleReplacement.runtime</code> 中。</p><ol><li>首先，更新过的模块，现在都属于 <code>outdated</code> 的模块，所以先找出过期的模块及其依赖:</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack/lib/HotModuleReplacement.runtime</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getAffectedStuff</span>(<span class="params">updateModuleId</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> outdatedModules = [updateModuleId];</span><br><span class="line">    <span class="keyword">var</span> outdatedDependencies = &#123;&#125;;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&quot;accepted&quot;</span>,</span><br><span class="line">        <span class="attr">moduleId</span>: updateModuleId,</span><br><span class="line">        <span class="attr">outdatedModules</span>: outdatedModules,</span><br><span class="line">        <span class="attr">outdatedDependencies</span>: outdatedDependencies</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>根据调用的 <code>Api</code> 信息，对结果进行标注及处理。</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> (result.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;self-declined&quot;</span>:</span><br><span class="line">        ...</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;declined&quot;</span>:</span><br><span class="line">        ...</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;unaccepted&quot;</span>:</span><br><span class="line">        ...</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;accepted&quot;</span>:</span><br><span class="line">        <span class="keyword">if</span> (options.<span class="property">onAccepted</span>) options.<span class="title function_">onAccepted</span>(result);</span><br><span class="line">        doApply = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;disposed&quot;</span>:</span><br><span class="line">        <span class="keyword">if</span> (options.<span class="property">onDisposed</span>) options.<span class="title function_">onDisposed</span>(result);</span><br><span class="line">        doDispose = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;Unexception type &quot;</span> + result.<span class="property">type</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>从缓存中删除过期的模块和依赖</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// remove module from cache</span></span><br><span class="line"><span class="keyword">delete</span> installedModules[moduleId];</span><br><span class="line"></span><br><span class="line"><span class="comment">// when disposing there is no need to call dispose handler</span></span><br><span class="line"><span class="keyword">delete</span> outdatedDependencies[moduleId];</span><br><span class="line"></span><br><span class="line"><span class="comment">// remove &quot;parents&quot; references from all children</span></span><br><span class="line"><span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="variable language_">module</span>.<span class="property">children</span>.<span class="property">length</span>; j++) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// remove outdated dependency from module children</span></span><br><span class="line"><span class="keyword">var</span> dependency;</span><br><span class="line"><span class="keyword">var</span> moduleOutdatedDependencies;</span><br><span class="line"><span class="keyword">for</span> (moduleId <span class="keyword">in</span> outdatedDependencies) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>将新的模块添加到 <code>modules</code> 中，当下次调用 <strong>webpack_require</strong> (<code>webpack</code> 重写的 <code>require</code> 方法)方法的时候，就是获取到了新的模块代码了。</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// insert new code</span></span><br><span class="line"><span class="keyword">for</span> (moduleId <span class="keyword">in</span> appliedUpdate) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">hasOwnProperty</span>.<span class="title function_">call</span>(appliedUpdate, moduleId)) &#123;</span><br><span class="line">        modules[moduleId] = appliedUpdate[moduleId];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后就是错误的兼容了，如果热加载失败，将会刷新浏览器。</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> 打包/封装 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webpack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webpack-性能优化总结大全</title>
      <link href="/posts/24696c81/"/>
      <url>/posts/24696c81/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="Webpack性能优化总结大全"><a href="#Webpack性能优化总结大全" class="headerlink" title="Webpack性能优化总结大全"></a>Webpack性能优化总结大全</h2><h3 id="开发体验优化"><a href="#开发体验优化" class="headerlink" title="开发体验优化"></a>开发体验优化</h3><h4 id="优化-Loader-配置"><a href="#优化-Loader-配置" class="headerlink" title="优化 Loader 配置"></a>优化 Loader 配置</h4><p>由于 <code>Loader</code> 对文件的转换操作很耗时，所以需要让尽可能少的文件被 <code>Loader</code> 处理。可以通过 <code>test/include/exclude</code> 三个配置项来命中 <code>Loader</code> 要应用规则的文件。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span> .<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="variable language_">module</span> : &#123;</span><br><span class="line">        rules : [&#123;</span><br><span class="line">            <span class="comment">//如果项目源码中只有 文件，就不要写成/\jsx?$/，以提升正则表达式的性能</span></span><br><span class="line">            <span class="attr">test</span>: <span class="regexp">/\.js$/</span>,</span><br><span class="line">            <span class="comment">//babel -loader 支持缓存转换出的结果，通过 cacheDirectory 选项开启</span></span><br><span class="line">            <span class="attr">use</span>: [<span class="string">&#x27;babel-loader?cacheDirectory&#x27;</span>] ,</span><br><span class="line">            <span class="comment">//只对项目根目录下 src 目录中的文件采用 babel-loader</span></span><br><span class="line">            <span class="attr">include</span>: path.<span class="title function_">resolve</span>(__dirname,<span class="string">&#x27;src&#x27;</span>),</span><br><span class="line">        &#125;],</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://www.webpackjs.com/loaders/babel-loader/#babel-loader-%E5%BE%88%E6%85%A2-">webpack 官方文档</a></p><h4 id="优化-resolve-modules-配置"><a href="#优化-resolve-modules-配置" class="headerlink" title="优化 resolve.modules 配置"></a>优化 resolve.modules 配置</h4><p><code>resolve.modules</code> 的默认值是 <code>［&#39;node_modules&#39;］</code> ，含义是先去当前目录的 <code>node_modules</code> 目录下去找我们想找的模块，如果没找到就去上一级目录 <code>../node_modules</code> 中找，再没有就去 <code>../../node_modules</code> 中找，以此类推。这和 <code>Node.js</code> 的模块寻找机制很相似。当安装的第三方模块都放在项目根目录的 <code>node_modules</code> 目录下时，就没有必要按照默认的方式去一层层地寻找，可以指明存放第三方模块的绝对路径，以减少寻找</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">    resolve: &#123;</span><br><span class="line">        modules: [path.resolve( __dirname,&#x27;<span class="keyword">node</span> <span class="title">modules</span>&#x27;)]</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="优化-resolve-mainFields-配置"><a href="#优化-resolve-mainFields-配置" class="headerlink" title="优化 resolve.mainFields 配置"></a>优化 resolve.mainFields 配置</h4><p>在安装的第三方模块中都会有一个 <code>package.json</code> 文件，用于描述这个模块的属性，其中可以存在多个字段描述入口文件，原因是某些模块可以同时用于多个环境中，针对不同的运行环境需要使用不同的代码。</p><p><code>resolve.mainFields</code> 的默认值和当前的 <code>target</code> 配置有关系，对应的关系如下。</p><ul><li><code>target web</code> 或者 <code>webworker</code> 时，值是 <code>［&#39;browser&#39;,&#39;module&#39;,&#39;main&#39;]</code> 。</li><li><code>target</code> 为其他情况时，值是 <code>［ &#39;module&#39;,&#39;main&#39;]</code> 。</li></ul><p>以 <code>target</code> 等于 <code>web</code> 为例， <code>Webpack</code> 会先采用第三方模块中的 <code>browser</code> 字段去寻找模块的入口文件，如果不存在，就采用 <code>module</code> 字段，以此类推。</p><p>为了减少搜索步骤，在明确第三方模块的入口文件描述字段时，我们可以将它设置得尽量少。由于大多数第三方模块都采用 <code>main</code> 字段去描述入口文件的位置，所以可以这样配置：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span>.<span class="keyword">exports</span> = &#123;</span><br><span class="line">    resolve: &#123;</span><br><span class="line">    <span class="comment">//只采用 main 字段作为入口文件的描述字段，以减少搜索步骤</span></span><br><span class="line">        mainFields: [<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="优化-resolve-alias-配置"><a href="#优化-resolve-alias-配置" class="headerlink" title="优化 resolve.alias 配置"></a>优化 resolve.alias 配置</h4><p><code>resolve.alias</code> 配置项通过别名来将原导入路径映射成一个新的导入路径。</p><p>在实战项目中经常会依赖一些庞大的第三方模块，以 <code>React</code> 库为例，发布出去的 <code>React</code> 库中包含两套代码</p><ul><li>一套是采用 <code>CommonJS</code> 规范的模块化代码，这些文件都放在 <code>lib</code> 录下，以 <code>package.json</code> 中指定的入口文件 <code>react.js</code> 为模块的入口</li><li>一套是将 <code>React</code> 的所有相关代码打包好的完整代码放到一个单独的文件中， 这些代码没有采用模块化，可以直接执行。其中 <code>dist/react.js</code> 用于开发环境，里面包含检查和警告的代码。<code>dist/react.min.js</code> 用于线上环境，被最小化了。</li></ul><p>在默认情况下， <code>Webpack</code> 会从入口文件 <code>./node_modules/react/react.js</code> 开始递归解析和处理依赖的几十个文件，这会是一个很耗时的操作 通过配置 <code>resolve.alias</code> ，可以让 <code>Webpack</code> 在处理 <code>React</code> 库时，直接使用单独、完整的 <code>react.min.js</code> 文件,从而跳过耗时的递归解析操作.</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">    resolve: &#123;</span><br><span class="line">        <span class="regexp">//</span>使用 alias 将导入 react 的语句换成直接使用单独、完整的 react.min.js 文件，</span><br><span class="line">        <span class="regexp">//</span>减少耗时的递归解析操作</span><br><span class="line">        alias: &#123;</span><br><span class="line">            <span class="string">&#x27;react&#x27;</span>: path.resolve( __dirname ,<span class="string">&#x27;./node_modules/react/dist/react.min.js&#x27;</span>),</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> 但是，对某些库使用本优化方法后，会影响到使用 <code>Tree-Sharking</code> 去除无效代码的优化，因为打包好的完整文件中有部分代码在我们的项目中可能永远用不上。一般对整体性比较强的库采用本方法优化，因为完整文件中的代码是一个整体，每一行都是不可或缺的 但是对于一些工具类的库，则不建议用此方法。</p><h4 id="优化-resolve-extensions-配置"><a href="#优化-resolve-extensions-配置" class="headerlink" title="优化 resolve.extensions 配置"></a>优化 resolve.extensions 配置</h4><p>在导入语句没带文件后缀时，<code>Webpack</code> 会自动带上后缀去尝试询问文件是否存在。如果这个列表越长，或者正确的后缀越往后，就会造成尝试的次数越多，所以 <code>resolve .extensions</code> 的配置也会影响到构建的性能 在配置 <code>resolve.extensions</code> 时需要遵守 以下几点，以做到尽可能地优化构建性能。</p><ul><li>后缀尝试列表要尽可能小，不要将项目中不可能存在的情况写到后缀尝试列表中。</li><li>频率出现最高的文件后缀要优先放在最前面，以做到尽快退出寻找过程。</li><li>在源码中写导入语句时，要尽可能带上后缀 从而可以避免寻找过程。例如在确定的情况下将 <code>require ( &#39;./data &#39;）</code> 写成 <code>require （&#39;./data.json&#39;）</code></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span>.<span class="keyword">exports</span> = &#123;</span><br><span class="line">    resolve : &#123;</span><br><span class="line">        <span class="comment">//尽可能减少后缀尝试的可能性</span></span><br><span class="line">        extensions : [<span class="string">&#x27;js&#x27;</span>],</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="优化-module-noParse-配置"><a href="#优化-module-noParse-配置" class="headerlink" title="优化 module.noParse 配置"></a>优化 module.noParse 配置</h4><p><code>module.noParse</code> 配置项可以让 <code>Webpack</code> 忽略对部分没采用模块化的文件的递归解析处理，这样做的好处是能提高构建性能。原因是一些库如 <code>jQuery</code>。</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">module.<span class="attr">exports</span> <span class="operator">=</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="symbol">    module:</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="symbol">        noParse:</span> <span class="keyword">/jquery/</span>,</span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;;</span></span><br></pre></td></tr></table></figure><h4 id="使用-DllPlugin"><a href="#使用-DllPlugin" class="headerlink" title="使用 DllPlugin"></a>使用 DllPlugin</h4><p><code>DLLPlugin</code> 和 <code>DLLReferencePlugin</code> 用某种方法实现了拆分 <code>bundles</code>，同时还大大提升了构建的速度。</p><p>包含大量复用模块的动态链接库只需被编译一次，在之后的构建过程中被动态链接库包含的模块将不会重新编译，而是直接使用动态链接库中 的代码 由于动态链接库中大多数包含的是常用的第三方模块，例如 <code>react</code>、<code>react-dom</code> ，所以只要不升级这些模块的版本，动态链接库就不用重新编译。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//github.com/webpack/webpack/tree/master/examples/dll-user</span></span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">    <span class="comment">// mode: &quot;development || &quot;production&quot;,</span></span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> webpack.<span class="title function_ invoke__">DllReferencePlugin</span>(&#123;</span><br><span class="line">            <span class="attr">context</span>: path.<span class="title function_ invoke__">join</span>(__dirname, <span class="string">&quot;..&quot;</span>, <span class="string">&quot;dll&quot;</span>),</span><br><span class="line">            <span class="attr">manifest</span>: <span class="keyword">require</span>(<span class="string">&quot;../dll/dist/alpha-manifest.json&quot;</span>) <span class="comment">// eslint-disable-line</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> webpack.<span class="title function_ invoke__">DllReferencePlugin</span>(&#123;</span><br><span class="line">            <span class="attr">scope</span>: <span class="string">&quot;beta&quot;</span>,</span><br><span class="line">            <span class="attr">manifest</span>: <span class="keyword">require</span>(<span class="string">&quot;../dll/dist/beta-manifest.json&quot;</span>), <span class="comment">// eslint-disable-line</span></span><br><span class="line">            extensions: [<span class="string">&quot;.js&quot;</span>, <span class="string">&quot;.jsx&quot;</span>]</span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>这个理解起来不费劲，操作起来很费劲。所幸，在 <code>Webpack5</code> 中已经不用它了，而是用 <code>HardSourceWebpackPlugin</code> ，一样的优化效果，但是使用却及其简单</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">const</span> <span class="variable">HardSourceWebpackPlugin</span> = <span class="function"><span class="title">require</span>(<span class="string">&#x27;hard-source-webpack-plugin&#x27;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="variable">const</span> <span class="variable">plugins</span> = [</span><br><span class="line">    <span class="variable">new</span> <span class="function"><span class="title">HardSourceWebpackPlugin</span>()</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>更开心的是，这个插件，<code>webapck4</code> 就可以用啦，赶紧用起来吧～</p><p>注意：该插件与测量各流程耗时的插件 <code>speed-measure-webpack-plugin</code> 不兼容。</p><h4 id="使用-HappyPack"><a href="#使用-HappyPack" class="headerlink" title="使用 HappyPack"></a>使用 HappyPack</h4><p><code>Webpack</code> 是单线程模型的，也就是说 <code>Webpack</code> 需要一个一个地处理任务，不能同时处理多个任务。<code>HappyPack</code> 将任 务分解给多个子进程去并发执行，子进程处理完后再将结果发送给主进程,从而发挥多核 <code>CPU</code> 电脑的威力。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">HappyPack</span> = <span class="built_in">require</span>(<span class="string">&#x27;happypack&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> os = <span class="built_in">require</span>(<span class="string">&#x27;os&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> happyThreadPool = <span class="title class_">HappyPack</span>.<span class="title class_">ThreadPool</span>(&#123; <span class="attr">size</span>: os.<span class="title function_">cpus</span>().<span class="property">length</span> &#125;)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">test</span>: <span class="regexp">/\.js$/</span>,</span><br><span class="line">    <span class="comment">// loader: &#x27;babel-loader&#x27;,</span></span><br><span class="line">    <span class="attr">loader</span>: <span class="string">&#x27;happypack/loader?id=happy-babel-js&#x27;</span>, <span class="comment">// 增加新的HappyPack构建loader</span></span><br><span class="line">    <span class="attr">include</span>: [<span class="title function_">resolve</span>(<span class="string">&#x27;src&#x27;</span>)],</span><br><span class="line">    <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="attr">plugins</span>: [</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">HappyPack</span>(&#123;</span><br><span class="line">        <span class="attr">id</span>: <span class="string">&#x27;happy-babel-js&#x27;</span>,</span><br><span class="line">        <span class="attr">loaders</span>: [<span class="string">&#x27;babel-loader?cacheDirectory=true&#x27;</span>],</span><br><span class="line">        <span class="attr">threadPool</span>: happyThreadPool</span><br><span class="line">    &#125;)</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>在整个 <code>Webpack</code> 构建流程中，最耗时的流程可能就是 <code>Loader</code> 对文件的转换操作了，因为要转换的文件数据量巨大，而且这些转换操作都只能一个一个地处理 <code>HappyPack</code> 的核心原理就是将这部分任务分解到多个进程中去并行处理，从而减少总的构建时间。</p><h4 id="使用-ParallelUglifyPlugin"><a href="#使用-ParallelUglifyPlugin" class="headerlink" title="使用 ParallelUglifyPlugin"></a>使用 ParallelUglifyPlugin</h4><p><code>webpack</code> 默认提供了 <code>UglifyJS</code> 插件来压缩 <code>JS</code> 代码，但是它使用的是单线程压缩代码，也就是说多个 <code>js</code> 文件需要被压缩，它需要一个个文件进行压缩。所以说在正式环境打包压缩代码速度非常慢(因为压缩 <code>JS</code> 代码需要先把代码解析成用 <code>Object</code> 抽象表示的 <code>AST</code> 语法树，再去应用各种规则分析和处理 <code>AST</code> ，导致这个过程耗时非常大)。</p><p>当 <code>webpack</code> 有多个 <code>JS</code> 文件需要输出和压缩时候，原来会使用 <code>UglifyJS</code> 去一个个压缩并且输出，但是 <code>ParallelUglifyPlugin</code> 插件则会开启多个子进程，把对多个文件压缩的工作分别给多个子进程去完成，但是每个子进程还是通过 <code>UglifyJS</code> 去压缩代码。无非就是变成了并行处理该压缩了，并行处理多个子任务，效率会更加的提高。</p><h4 id="优化文件监听的性能"><a href="#优化文件监听的性能" class="headerlink" title="优化文件监听的性能"></a>优化文件监听的性能</h4><p>在开启监听模式时，默认情况下会监听配置的 <code>Entry</code> 文件和所有 <code>Entry</code> 递归依赖的文件，在这些文件中会有很多存在于 <code>node_modules</code> 下，因为如今的 <code>Web</code> 项目会依赖大量的第三方模块， 所以在大多数情况下我们都不可能去编辑 <code>node_modules</code> 下的文件，而是编辑自己建立的源码文件，而一个很大的优化点就是忽略 <code>node_modules</code> 下的文件，不监听它们。</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">module.export = &#123;</span><br><span class="line">    watchOptions : &#123;</span><br><span class="line">        <span class="regexp">//</span>不监听的 node_modules 目录下的文件</span><br><span class="line">        ignored : <span class="regexp">/node_modules/</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>采用这种方法优化后， <code>Webpack</code> 消耗的内存和 <code>CPU</code> 将会大大减少。</p><h3 id="输出质量优化"><a href="#输出质量优化" class="headerlink" title="输出质量优化"></a>输出质量优化</h3><p>优化 <code>webpack</code> 的输出结果，让打包的最终结果在浏览器运⾏快速⾼效。</p><h4 id="压缩代码"><a href="#压缩代码" class="headerlink" title="压缩代码"></a>压缩代码</h4><p>删除多余的代码、注释、简化代码的写法等等⽅式。可以利⽤ <code>webpack</code> 的 <code>UglifyJsPlugin</code> 和 <code>ParallelUglifyPlugin</code> 来压缩 <code>JS</code> ⽂件， 利⽤ <code>cssnano （css-loader?minimize）</code> 来压缩 <code>css</code></p><h4 id="Webpack-实现-CDN-的接入"><a href="#Webpack-实现-CDN-的接入" class="headerlink" title="Webpack 实现 CDN 的接入"></a>Webpack 实现 CDN 的接入</h4><p>总之，构建需要实现以下几点:</p><ul><li>静态资源的导入  <code>URL</code> 需要变成指向 <code>DNS</code> 服务的绝对路径的 <code>URL</code> ，而不是相对 <code>HTML</code> 文件的</li><li>静态资源的文件名需要带上由文件内容算出来的 <code>Hash</code> 值，以防止被缓存</li><li>将不同类型的资源放到不同域名的 <code>DNS</code> 服务上，以防止资源的并行加载被阻塞</li></ul><h4 id="使用-Tree-Shaking"><a href="#使用-Tree-Shaking" class="headerlink" title="使用 Tree Shaking"></a>使用 Tree Shaking</h4><p><code>Tree Shaking</code> 正常工作的前提：提交给 <code>Webpack</code> 的 <code>JavaScript</code> 代码必须采用了 <code>ES6</code> 的模块化语法，因为 <code>ES6</code> 模块化语法是静态的，可以进行静态分析。</p><p>首先，为了将采用 <code>ES6</code> 模块化的代码提交给 <code>Webpack</code> ，需要配置 <code>Babel</code> 以让其保留 <code>ES6</code> 模块化语句。修改 <code>.babelrc</code> 文件如下：</p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&#x27;presets&#x27;</span>:[</span><br><span class="line">        [</span><br><span class="line">            <span class="string">&#x27;env&#x27;</span>,&#123;</span><br><span class="line">                <span class="string">&#x27;module&#x27;</span>:false</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>第二个要求，需要使用 <code>UglifyJsPlugin</code> 插件。如果在 <code>mode:&quot;production&quot;</code> 模式，这个插件已经默认添加了，如果在其它模式下，可以手工添加它。</p><p>另外要记住的是打开 <code>optimization.usedExports</code> 。在 <code>mode: &quot;production&quot;</code> 模式下，它也是默认打开了的。它告诉 <code>webpack</code> 每个模块明确使用 <code>exports</code> 。这样之后， <code>webpack</code> 会在打包文件中添加诸如 <code>/* unused harmony export */</code> 这样的注释，其后 <code>UglifyJsPlugin</code> 插件会对这些注释作出理解。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">module.exports</span> <span class="string">=</span> &#123;</span><br><span class="line">    <span class="attr">mode:</span> <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">    <span class="attr">optimization:</span> &#123;</span><br><span class="line">        <span class="attr">minimize:</span> <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">minimizer:</span> [</span><br><span class="line">            <span class="string">new</span> <span class="string">UglifyJsPlugin()</span></span><br><span class="line">        ],</span><br><span class="line">        <span class="attr">usedExports:</span> <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">sideEffects:</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="提取公共代码"><a href="#提取公共代码" class="headerlink" title="提取公共代码"></a>提取公共代码</h4><p>大型网站通常由多个页面组成，每个页面都是一个独立的单页应用，但由于所有页面都采用同样的技术栈及同一套样式代码，就导致这些页面之间有很多相同的代码。可以使用 <code>splitChunks</code> 进行分包：</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">splitChunks:</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="symbol">    chunks:</span> <span class="string">&quot;async&quot;</span>,</span><br><span class="line"><span class="symbol">    minSize:</span> <span class="number">30000</span>,</span><br><span class="line"><span class="symbol">    minChunks:</span> <span class="number">1</span>,</span><br><span class="line"><span class="symbol">    maxAsyncRequests:</span> <span class="number">5</span>,</span><br><span class="line"><span class="symbol">    maxInitialRequests:</span> <span class="number">3</span>,</span><br><span class="line"><span class="symbol">    automaticNameDelimiter:</span> <span class="string">&#x27;~&#x27;</span>,</span><br><span class="line"><span class="symbol">    name:</span> true,</span><br><span class="line"><span class="symbol">    cacheGroups:</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="symbol">        vendors:</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="symbol">            test:</span> /[\\/]node_modules[\\/]/,</span><br><span class="line"><span class="symbol">            priority:</span> <span class="number">-10</span></span><br><span class="line">        <span class="punctuation">&#125;</span>,</span><br><span class="line"><span class="symbol">        default:</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="symbol">            minChunks:</span> <span class="number">2</span>,</span><br><span class="line"><span class="symbol">            priority:</span> <span class="number">-20</span>,</span><br><span class="line"><span class="symbol">            reuseExistingChunk:</span> true</span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h4 id="分割代码以按需加载"><a href="#分割代码以按需加载" class="headerlink" title="分割代码以按需加载"></a>分割代码以按需加载</h4><p><code>Webpack</code> 支持两种动态代码拆分技术：</p><ul><li>符合 <code>ECMAScript proposal</code> 的 <code>import()</code> 语法，推荐使用</li><li>传统的 <code>require.ensure</code></li></ul><p><code>import()</code> 用于动态加载模块，其引用的模块及子模块会被分割打包成一个独立的 <code>chunk</code> 。<code>Webpack</code> 还允许以注释的方式传参，进而更好的生成 <code>chunk</code> 。</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">//</span> single target</span><br><span class="line">import(</span><br><span class="line">    <span class="regexp">/* webpackChunkName: &quot;my-chunk-name&quot; */</span></span><br><span class="line">    <span class="regexp">/* webpackMode: &quot;lazy&quot; */</span></span><br><span class="line">    <span class="string">&#x27;module&#x27;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> multiple possible targets</span><br><span class="line">import(</span><br><span class="line"><span class="regexp">/* webpackInclude: /</span>\.json$<span class="regexp">/ */</span></span><br><span class="line"><span class="regexp">/* webpackExclude: /</span>\.noimport\.json$<span class="regexp">/ */</span></span><br><span class="line"><span class="regexp">/* webpackChunkName: &quot;my-chunk-name&quot; */</span></span><br><span class="line"><span class="regexp">/* webpackMode: &quot;lazy&quot; */</span></span><br><span class="line">`.<span class="regexp">/locale/</span><span class="variable">$&#123;language&#125;</span>`</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>回归到实际业务场景，页面基本上都是通过路由的方式呈现，如果按照路由的方式实现页面级的异步加载，岂不是方便很多。例如，<code>react</code> 中可使用 <code>loadable</code> :</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span><span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Route</span> &#125; <span class="keyword">from</span><span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; loadable &#125; <span class="keyword">from</span><span class="string">&#x27;react-common-lib&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Test</span> = <span class="title function_">loadable</span>(&#123;</span><br><span class="line">    <span class="attr">loader</span>: <span class="function">() =&gt;</span><span class="title function_">import</span>(<span class="string">&#x27;./test&#x27;</span>),</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">AppRouter</span> = (<span class="params"></span>) =&gt; (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/test&quot;</span> <span class="attr">exact</span> <span class="attr">component</span>=<span class="string">&#123;Test&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><h4 id="分析工具"><a href="#分析工具" class="headerlink" title="分析工具"></a>分析工具</h4><p>官方可视化工具：<a href="http://webpack.github.io/analyse/">http://webpack.github.io/analyse/</a></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> 打包/封装 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webpack </tag>
            
            <tag> 性能优化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webpack-构建工具选择</title>
      <link href="/posts/ce8b16f6/"/>
      <url>/posts/ce8b16f6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="构建工具选择"><a href="#构建工具选择" class="headerlink" title="构建工具选择"></a>构建工具选择</h3><p>针对不同的场景，选择最合适的工具</p><p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/12/17/16f12c6625059e8d~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp" alt="GitHub"></p><p>通过对比，不难看出，Webpack和Rollup在不同场景下，都能发挥自身优势作用。webpack作为打包工具，但是在定义模块输出的时候，webpack确不支持ESM，webpack插件系统庞大，确实有支持模块级的Tree-Shacking的插件，如webpack-deep-scope-analysis-plugin。但是粒度更细化的，一个模块里面的某个方法，本来如果没有被引用的话也可以去掉的，就不行了….这个时候，就要上rollup了。rollup它支持程序流分析，能更加正确的判断项目本身的代码是否有副作用，其实就是rollup的tree-shaking更干净。所以我们的结论是rollup 比较适合打包 js 的 sdk 或者封装的框架等，例如，vue 源码就是 rollup 打包的。而 webpack 比较适合打包一些应用，例如 SPA 或者同构项目等等。</p><p>结论:在开发应用时使用 Webpack，开发库时使用 Rollup</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> 打包/封装 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webpack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webpack-plugin</title>
      <link href="/posts/570219c2/"/>
      <url>/posts/570219c2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><code>webpack</code> 插件机制是整个 <code>webpack</code> 工具的骨架，而 <code>webpack</code> 本身也是利用这套插件机制构建出来的。</p><h2 id="Webpack-Plugin"><a href="#Webpack-Plugin" class="headerlink" title="Webpack Plugin"></a>Webpack Plugin</h2><p>专注处理 <code>webpack</code> 在编译过程中的某个特定的任务的功能模块，称为插件，最常见的如 <code>html-webpack-plugin</code> 。</p><h3 id="webpack-插件如何实现"><a href="#webpack-插件如何实现" class="headerlink" title="webpack 插件如何实现"></a>webpack 插件如何实现</h3><ul><li><code>webpack</code>本质是一个事件流机制，核心模块：<code>tabable(Sync + Async)Hooks</code> 构造出 &#x3D;&#x3D;&#x3D; <code>Compiler(编译)</code> + <code>Compiletion(创建bundles)</code></li><li><code>compiler</code> 对象代表了完整的 <code>webpack</code> 环境配置。这个对象在启动 <code>webpack</code> 时被一次性建立，并配置好所有可操作的设置，包括 <code>options</code> 、 <code>loader</code> 和 <code>plugin</code> 。当在 <code>webpack</code> 环境中应用一插件时，插件将收到此 <code>compiler</code> 对象的引用。可以使用它来访问 <code>webpack</code> 的主环境</li><li><code>compilation</code> 对象代表了一次资源版本构建。当运行 <code>webpack</code> 开发环境中间件时，每当检测到一个文件变化，就会创建一个新的 <code>compilation</code> ，从而生成一个新的编译资源。一个 <code>compilation</code> 对象表现了当前的模块资源、编译生成资源、变化的文件、以及被跟踪依赖的状态的信息。 <code>compilation</code> 对象也提供了很多关键时机的回调，以供插件做自定义处理时选择使用</li><li>创建一个插件函数，在其 <code>prototype</code> 上定义 <code>apply</code> 方法，指定一个 <code>webpack</code> 自身的事件钩子</li><li>函数内部处理 <code>webpack</code> 内部实例的特定数据</li><li>处理完成后，调用 <code>webpack</code> 提供的回调函数</li></ul><h3 id="完整的-webpack-插件需要满足以下几点规则和特征："><a href="#完整的-webpack-插件需要满足以下几点规则和特征：" class="headerlink" title="完整的 webpack 插件需要满足以下几点规则和特征："></a>完整的 webpack 插件需要满足以下几点规则和特征：</h3><ul><li>是一个独立的模块</li><li>模块对外暴露一个 <code>js</code> 函数</li><li>函数的原型 (<code>prototype</code>) 上定义了一个注入 <code>compiler</code> 对象的 <code>apply</code> 方法 <code>apply</code> 函数中需要有通过 <code>compiler</code> 对象挂载的 <code>webpack</code> 事件钩子，钩子的回调中能拿到当前编译的 <code>compilation</code> 对象，如果是异步编译插件的话可以拿到回调 <code>callback</code></li><li>完成自定义子编译流程并处理 <code>complition</code> 对象的内部数据</li><li>如果异步编译插件的话，数据处理完成后执行 <code>callback</code> 回调。</li></ul><h3 id="Webpakck插件的基本模型"><a href="#Webpakck插件的基本模型" class="headerlink" title="Webpakck插件的基本模型"></a>Webpakck插件的基本模型</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1、BasicPlugin.js 文件（独立模块）</span></span><br><span class="line"><span class="comment">// 2、模块对外暴露的 js 函数</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BasicPlugin</span>&#123; </span><br><span class="line">    <span class="comment">//在构造函数中获取用户为该插件传入的配置</span></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">pluginOptions</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">options</span> = pluginOptions;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="comment">//3、原型定义一个 apply 函数，并注入了 compiler 对象</span></span><br><span class="line">    <span class="title function_">apply</span>(<span class="params">compiler</span>) &#123; </span><br><span class="line">        <span class="comment">//4、挂载 webpack 事件钩子（这里挂载的是 emit 事件）</span></span><br><span class="line">        compiler.<span class="title function_">plugin</span>(<span class="string">&#x27;emit&#x27;</span>, <span class="keyword">function</span> (<span class="params">compilation, callback</span>) &#123;</span><br><span class="line">            <span class="comment">// ... 内部进行自定义的编译操作</span></span><br><span class="line">            <span class="comment">// 5、操作 compilation 对象的内部数据</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(compilation);</span><br><span class="line">            <span class="comment">// 6、执行 callback 回调</span></span><br><span class="line">            <span class="title function_">callback</span>();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// 7、暴露 js 函数</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title class_">BasicPlugin</span>;</span><br></pre></td></tr></table></figure><p><code>Webpack</code> 启动后，在读取配置的过程中会先执行 <code>new BasicPlugin(options)</code> 初始化一个 <code>BasicPlugin</code> 并获得其实例。<br>在初始化 <code>Compiler</code> 对象后，再调用  <code>basicPlugin.apply (compiler)</code> 为插件实例传入 <code>compiler</code> 对象。<br>插件实例在获取到 <code>compiler</code> 对象后，就可以通过 <code>compiler. plugin</code> （事件名称 ，回调函数）监听到 <code>Webpack</code> 广播的事件，并且可以通过 <code>compiler</code> 对象去操作 <code>Webpack</code>。</p><h3 id="入参Compiler对象解释"><a href="#入参Compiler对象解释" class="headerlink" title="入参Compiler对象解释"></a>入参Compiler对象解释</h3><p><code>compiler</code> 对象是 <code>webpack</code> 的编译器对象，<code>compiler</code> 对象会在启动 <code>webpack</code> 的时候被一次性地初始化，<code>compiler</code> 对象中包含了所有 <code>webpack</code> 可自定义操作的配置，例如 <code>loader</code> 的配置，<code>plugin</code> 的配置，<code>entry</code> 的配置等各种原始 <code>webpack</code> 配置等，在 <code>webpack</code> 插件中的自定义子编译流程中，我们肯定会用到 <code>compiler</code> 对象中的相关配置信息，我们相当于可以通过 <code>compiler</code> 对象拿到 <code>webpack</code> 的主环境所有的信息。<br><a href="https://github.com/webpack/webpack/blob/10282ea20648b465caec6448849f24fc34e1ba3e/lib/webpack.js#L30">webpack部分源码</a>：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack/lib/webpack.js</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Compiler</span> = <span class="built_in">require</span>(<span class="string">&quot;./Compiler&quot;</span>)  </span><br><span class="line"><span class="keyword">const</span> <span class="title function_">webpack</span> = (<span class="params">options, callback</span>) =&gt; &#123;</span><br><span class="line">    ...</span><br><span class="line">    options = <span class="keyword">new</span> <span class="title class_">WebpackOptionsDefaulter</span>().<span class="title function_">process</span>(options) <span class="comment">// 初始化 webpack 各配置参数</span></span><br><span class="line">    <span class="keyword">let</span> compiler = <span class="keyword">new</span> <span class="title class_">Compiler</span>(options.<span class="property">context</span>)     <span class="comment">// 初始化 compiler 对象，这里 options.context 为 process.cwd()</span></span><br><span class="line">    compiler.<span class="property">options</span> = options                      <span class="comment">// 往 compiler 添加初始化参数</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">NodeEnvironmentPlugin</span>().<span class="title function_">apply</span>(compiler)<span class="comment">// 往 compiler 添加 Node 环境相关方法</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> plugin <span class="keyword">of</span> options.<span class="property">plugins</span>) &#123;</span><br><span class="line">        plugin.<span class="title function_">apply</span>(compiler);</span><br><span class="line">    &#125;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Compilation-对象"><a href="#Compilation-对象" class="headerlink" title="Compilation 对象"></a>Compilation 对象</h3><p><code>compilation</code> 对象代表了一次单一的版本 <code>webpack</code> 构建和生成编译资源的过程。当运行 <code>webpack</code> 开发环境中间件时，每当检测到一个文件变化，一次新的编译将被创建，从而生成一组新的编译资源以及新的 <code>compilation</code> 对象。一个 <code>compilation</code> 对象包含了 当前的模块资源、编译生成资源、变化的文件、以及 被跟踪依赖的状态信息。编译对象也提供了很多关键点回调供插件做自定义处理时选择使用。</p><p><code>Compiler</code> 和 <code>Compilation</code> 的区别在于： <code>Compiler</code> 代表了整个 <code>Webpack</code> 从启动到关闭的生命周期，而 <code>Compilation</code> 只代表一次新的编译。</p><h3 id="Tapable-amp-Tapable-实例"><a href="#Tapable-amp-Tapable-实例" class="headerlink" title="Tapable &amp; Tapable 实例"></a>Tapable &amp; Tapable 实例</h3><p><code>webpack</code> 的插件架构主要基于 <code>Tapable</code> 实现的，<code>Tapable</code> 是 <code>webpack</code> 项目组的一个内部库，主要是抽象了一套插件机制。它类似于 <code>NodeJS</code> 的 <code>EventEmitter</code> 类，专注于自定义事件的触发和操作。<code>Compilation</code> 和 <code>Compiler</code> 都继承于 <code>Tapable</code> ，除此之外，<code>Tapable</code> 允许你通过回调函数的参数访问事件的生产者。<br><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/12/17/16f12c65e694bac6~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp" alt="GitHub"></p><p><code>webpack</code> 本质上是一种事件流的机制，它的工作流程就是将各个插件串联起来，而实现这一切的核心就是 <code>Tapable</code> ，<code>webpack</code> 中最核心的负责编译的 <code>Compiler</code> 和负责创建 <code>bundles</code> 的 <code>Compilation</code> 都是 <code>Tapable</code> 的实例，<code>Tapable</code> 能够让我们为 <code>javaScript</code> 模块添加并应用插件。 它可以被其它模块继承或混合。</p><h4 id="钩子"><a href="#钩子" class="headerlink" title="钩子"></a>钩子</h4><ul><li><code>SyncBailHook</code>：只要监听函数中有一个函数的返回值不为 <code>null</code>，则跳过剩下所有的逻辑。</li><li><code>SyncWaterfallHook</code>：上一个监听函数的返回值可以传给下一个监听函数。</li><li><code>SyncLoopHook</code>：当监听函数被触发的时候，如果该监听函数返回 <code>true</code> 时则这个监听函数会反复执行，如果返回 <code>undefined</code> 则表示退出循环。</li><li><code>AsyncParallelHook</code>：异步并发，不关心监听函数的返回值</li><li><code>AsyncParallelBailHook</code>：只要监听函数的返回值不为 <code>null</code> ，就会忽略后面的监听函数执行，直接跳跃到 <code>callAsync</code> 等触发函数绑定的回调函数，然后执行这个被绑定的回调函数</li><li><code>AsyncSeriesHook</code>：异步串行，不关心 <code>callback()</code> 的参数</li><li><code>AsyncSeriesBailHook</code>：<code>callback()</code> 的参数不为 <code>null</code> ，就会直接执行 <code>callAsync</code>等触发函数绑定的回调函数</li><li><code>AsyncSeriesWaterfallHook</code>：上一个监听函数的中的 <code>callback(err, data)</code> 的第二个参数,可以作为下一个监听函数的参数</li><li>同步钩子，用 <code>tap</code> 方式注册；</li><li>异步钩子，有三种注册&#x2F;发布的模式，<code>tap</code>、<code>tapAsync</code>、<code>tapPromise</code>。</li></ul><h4 id="Tapable-模型"><a href="#Tapable-模型" class="headerlink" title="Tapable 模型"></a>Tapable 模型</h4><p><code>Tapable</code> 简化后的模型，就是发布订阅者模式。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SyncHook</span>&#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">hooks</span> = &#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line">   </span><br><span class="line">  <span class="title function_">tap</span>(<span class="params">name,fn</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable language_">this</span>.<span class="property">hooks</span>[name])</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">hooks</span>[name] = []</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">hooks</span>[name].<span class="title function_">push</span>(fn) </span><br><span class="line">    &#125;  </span><br><span class="line"></span><br><span class="line">  <span class="title function_">call</span>(<span class="params">name</span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">hooks</span>[name].<span class="title function_">forEach</span>(<span class="function"><span class="params">hook</span>=&gt;</span><span class="title function_">hook</span>(...<span class="variable language_">arguments</span>))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Plugin调用流程"><a href="#Plugin调用流程" class="headerlink" title="Plugin调用流程"></a>Plugin调用流程</h2><ol><li>注册，类似于 <code>EventEmitter</code> 的 <code>on</code></li></ol><p><a href="https://github.com/webpack/tapable/blob/42b520760e138c23e7808881cb4322557e878307/lib/Tapable.js#L35">对应源码</a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">compiler.<span class="title function_">plugin</span>(<span class="string">&#x27;emit&#x27;</span>, <span class="function">(<span class="params">compilation, callback</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 在生成资源并输出到目录之前完成某些逻辑</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// Tapable.js</span></span><br><span class="line">options =&gt; &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">if</span>(hook !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> tapOpt = &#123;</span><br><span class="line">            <span class="attr">name</span>: options.<span class="property">fn</span>.<span class="property">name</span> || <span class="string">&quot;unnamed compat plugin&quot;</span>,</span><br><span class="line">            <span class="attr">stage</span>: options.<span class="property">stage</span> || <span class="number">0</span></span><br><span class="line">        &#125;;</span><br><span class="line">    <span class="keyword">if</span>(options.<span class="property">async</span>)</span><br><span class="line">        <span class="comment">// 将插件中异步钩子的回调函数注入</span></span><br><span class="line">        hook.<span class="title function_">tapAsync</span>(tapOpt, options.<span class="property">fn</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        hook.<span class="title function_">tap</span>(tapOpt, options.<span class="property">fn</span>);</span><br><span class="line">        returntrue;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ol start="2"><li>执行，类似于 <code>EventEmitter</code> 的 <code>emit</code></li></ol><p><a href="https://github.com/webpack/webpack/blob/e7c8fa414b718ac98d94a96e2553faceabfbc92f/lib/Compiler.js#L307">对应源码</a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">hooks</span>.<span class="property">emit</span>.<span class="title function_">callAsync</span>(compilation, <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="title function_">callback</span>(err);</span><br><span class="line">    outputPath = compilation.<span class="title function_">getPath</span>(<span class="variable language_">this</span>.<span class="property">outputPath</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">outputFileSystem</span>.<span class="title function_">mkdirp</span>(outputPath, emitFiles);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="Loader-amp-Plugin-开发调试"><a href="#Loader-amp-Plugin-开发调试" class="headerlink" title="Loader &amp; Plugin 开发调试"></a>Loader &amp; Plugin 开发调试</h2><h3 id="npm-link"><a href="#npm-link" class="headerlink" title="npm link"></a>npm link</h3><ol><li>确保正在开发的本地 <code>Loader</code> 模块的 <code>package.json</code> 已经配置好(最主要的 <code>main</code> 字段的入口文件指向要正确)</li><li>在本地的 <code>Npm</code> 模块根目录下执行 <code>npm link</code>，将本地模块注册到全局</li><li>在项目根目录下执行 <code>npm link loader-name</code> ，将第 2 步注册到全局的本地 <code>Npm</code> 模块链接到项目的 <code>node moduels</code> 下，其中的 <code>loader-name</code> 是指在第 1 步的 <code>package.json</code> 文件中配置的模块名称</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;name&quot;</span>: <span class="string">&quot;uploadtoserverplugin&quot;</span>,</span><br><span class="line">  <span class="string">&quot;version&quot;</span>: <span class="string">&quot;1.0.0&quot;</span>,</span><br><span class="line">  <span class="string">&quot;description&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="string">&quot;main&quot;</span>: <span class="string">&quot;index.js&quot;</span>,</span><br><span class="line">  <span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;test&quot;</span>: <span class="string">&quot;echo \ &quot;</span><span class="title class_">Error</span>: no test specified\<span class="string">&quot; &amp;&amp; exit 1&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;author&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="string">&quot;license&quot;</span>: <span class="string">&quot;ISC&quot;</span>,</span><br><span class="line">  <span class="string">&quot;devDependencies&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;scp2&quot;</span>: <span class="string">&quot;^0.5.0&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Npm link</code> 专门用于开发和调试本地的 <code>Npm</code> 模块，能做到在不发布模块的情况下， 将本地的一个正在开发的模块的源码链接到项目的 <code>node_modules</code> 目录下，让项目可以直接使 用本地的 <code>Npm</code> 模块。由于是通过软链接的方式实现的，编辑了本地的 <code>Npm</code> 模块的代码，所以在项目中也能使用到编辑后的代码。</p><p><code>Plugin</code> 部分也出过完整文章，可以看这里：<a href="https://mp.weixin.qq.com/s?__biz=MzI0MzIyMDM5Ng==&mid=2649825806&idx=1&sn=e46dbd274e240c4dcc4b778d8b30c67d&chksm=f175e8cdc60261db3c0caa44fd58e8d759526e5bb5b6e2caebba957a5996931cc68c18e69d37&scene=21#wechat_redirect">webpack 插件机制分析及开发调试</a></p><h3 id="Resolveloader"><a href="#Resolveloader" class="headerlink" title="Resolveloader"></a>Resolveloader</h3><p><code>ResolveLoader</code> 用于配置 <code>Webpack</code> 如何寻找 <code>Loader</code> ，它在默认情况下只会去 <code>node_modules</code> 目录下寻找。为了让 <code>Webpack</code> 加载放在本地项目中的 <code>Loader</code> ，需要修改 <code>resolveLoader.modules</code> 。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//假设本地项目中的 Loader 在项目目录的 ./loaders/loader-name 下</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">resolveLoader</span>:&#123;</span><br><span class="line">        <span class="comment">//去哪些目录下寻找 Loader ，有先后顺序之分</span></span><br><span class="line">        modules :[<span class="string">&#x27;node modules&#x27;</span>,<span class="string">&#x27;./loaders/&#x27;</span>],</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="webpack-常见的plugin有哪些"><a href="#webpack-常见的plugin有哪些" class="headerlink" title="webpack 常见的plugin有哪些"></a>webpack 常见的plugin有哪些</h3><ul><li><code>ProvidePlugin</code>：自动加载模块，代替 <code>require</code> 和 <code>import</code></li><li><code>html-webpack-plugin</code>可以根据模板自动生成 <code>html</code> 代码，并自动引用 <code>css</code> 和 <code>js</code> 文件</li><li><code>extract-text-webpack-plugin</code> 将 <code>js</code> 文件中引用的样式单独抽离成 <code>css</code> 文件</li><li><code>DefinePlugin</code> 编译时配置全局变量，这对开发模式和发布模式的构建允许不同的行为非常有用。</li><li><code>HotModuleReplacementPlugin</code> 热更新</li><li><code>optimize-css-assets-webpack-plugin</code> 不同组件中重复的 <code>css</code> 可以快速去重</li><li><code>webpack-bundle-analyzer</code> 一个 <code>webpack</code> 的 <code>bundle</code> 文件分析工具，将 <code>bundle</code> 文件以可交互缩放的 <code>treemap</code> 的形式展示。</li><li><code>compression-webpack-plugin</code> 生产环境可采用 <code>gzip</code> 压缩 <code>JS</code> 和 <code>CSS</code></li><li><code>happypack</code>：通过多进程模型，来加速代码构建</li><li><code>clean-wenpack-plugin</code> 清理每次打包下没有使用的文件</li><li><code>speed-measure-webpack-plugin</code>:可以看至 <code>U</code> 每个 <code>Loader</code>和 <code>Plugin</code> 执行耗时（整个打包耗时、每个 <code>Plugin</code> 和 <code>Loader</code> 耗时）</li><li><code>webpack-bundle-analyzer</code>:可视化 <code>Webpack</code> 输出文件的体积（业务组件、依赖第三方模块</li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> 打包/封装 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webpack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webpack-loader</title>
      <link href="/posts/13fcc20/"/>
      <url>/posts/13fcc20/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="Webpack-Loader"><a href="#Webpack-Loader" class="headerlink" title="Webpack Loader"></a>Webpack Loader</h2><p><code>Loader</code> 就像一个翻译员，能将源文件经过转化后输出新的结果，并且一个文件还可以链式地经过多个翻译员翻译。</p><h3 id="概念："><a href="#概念：" class="headerlink" title="概念："></a>概念：</h3><ul><li>一个 <code>Loader</code> 的职责是单一的，只需要完成一种转换</li><li>一个 <code>Loader</code> 其实就是一个 <code>Node.js</code> 模块，这个模块需要导出一个函数</li></ul><h3 id="开发-Loader-形式"><a href="#开发-Loader-形式" class="headerlink" title="开发 Loader 形式"></a>开发 <code>Loader</code> 形式</h3><ol><li>基本形式</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">function</span> (<span class="params">source</span>) &#123; </span><br><span class="line">    <span class="keyword">return</span> source; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>调用第三方模块</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sass= <span class="built_in">require</span>(<span class="string">&#x27;node-sass&#x27;</span>); </span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">function</span> (<span class="params">source</span>) &#123; </span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">sass</span>(source);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>由于 <code>Loader</code> 运行在 <code>Node.js</code> 中，所以我们可以调用任意 <code>Node.js</code> 自带的 <code>API</code> ，或者安装第三方模块进行调用</p><ol start="3"><li>调用 <code>Webpack</code> 的 <code>Api</code></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取用户为 Loader 传入的 options</span></span><br><span class="line"><span class="keyword">const</span> loaderUtils =<span class="built_in">require</span> (<span class="string">&#x27;loader-utils&#x27;</span>); </span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="function">(<span class="params">source</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> options= loaderUtils.<span class="title function_">getOptions</span>(<span class="variable language_">this</span>); </span><br><span class="line">    <span class="keyword">return</span> source; </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//返回sourceMap</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="function">(<span class="params">source</span>) =&gt;</span> &#123; </span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">callback</span>(<span class="literal">null</span>, source, sourceMaps); </span><br><span class="line">    <span class="comment">//当使用 this.callback 返回内容时 ，该 Loader 必须返回 undefined,</span></span><br><span class="line">    <span class="comment">//以让 Webpack 知道该 Loader 返回的结果在 this.callback 中，而不是 return中</span></span><br><span class="line">    <span class="keyword">return</span>; </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 异步</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="function">(<span class="params">source</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> callback = <span class="variable language_">this</span>.<span class="title function_">async</span>()</span><br><span class="line">    <span class="title function_">someAsyncOperation</span>(source, <span class="function">(<span class="params">err, result, sourceMaps, ast</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 通过 callback 返回异步执行后的结果</span></span><br><span class="line">        <span class="title function_">callback</span>(err, result, sourceMaps, ast)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//缓存加速</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="function">(<span class="params">source</span>) =&gt;</span> &#123; </span><br><span class="line">    <span class="comment">//关闭该 Loader 的缓存功能</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">cacheable</span>(<span class="literal">false</span>)</span><br><span class="line">    <span class="keyword">return</span> source </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>source</code> 参数是 <code>compiler</code> 传递给 <code>Loader</code> 的一个文件的原内容，这个函数需要返回处理后的内容，这里为了简单起见，直接将原内容返回了，相当于该 <code>Loader</code> 有做任何转换.这里结合了 <code>webpack</code> 的 <code>api</code> 和第三方模块之后，可以说 <code>loader</code> 可以做的事情真的非常非常多了…</p><p>更多的 <code>webpack Api</code> 可以看<a href="https://webpack.js.org/api/loaders">官方文档</a></p><h3 id="webpack有哪些常⻅的Loader"><a href="#webpack有哪些常⻅的Loader" class="headerlink" title="webpack有哪些常⻅的Loader"></a>webpack有哪些常⻅的Loader</h3><ul><li><code>file-loader</code>：把⽂件输出到⼀个⽂件夹中，在代码中通过相对 URL 去引⽤输出的⽂件</li><li><code>url-loader</code>：和 file-loader 类似，但是能在⽂件很⼩的情况下以 base64 的⽅式把⽂件内容注⼊到代码中去</li><li><code>source-map-loader</code>：加载额外的 Source Map ⽂件，以⽅便断点调试</li><li><code>image-loader</code>：加载并且压缩图⽚⽂件</li><li><code>babel-loader</code>：把 ES6 转换成 ES5</li><li><code>css-loader</code>：加载 CSS，⽀持模块化、压缩、⽂件导⼊等特性</li><li><code>style-loader</code>：把 CSS 代码注⼊到 JavaScript 中，通过 DOM 操作去加载 CSS。</li><li><code>eslint-loader</code>：通过 ESLint 检查 JavaScript 代码</li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> 打包/封装 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webpack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webpack4-基本打包机制</title>
      <link href="/posts/4d079656/"/>
      <url>/posts/4d079656/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="webpack4基本打包机制"><a href="#webpack4基本打包机制" class="headerlink" title="webpack4基本打包机制"></a>webpack4基本打包机制</h2><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9f4ef99bccb34946a83c2842b0ee1b0e~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp" alt="image.png"></p><p>本质上，<code>webpack</code> 是一个现代 <code>JavaScript</code> 应用程序的静态模块打包器(<code>module bundler</code>)。当 <code>webpack</code> 处理应用程序时，它会递归地构建一个依赖关系图(<code>dependency graph</code>)，其中包含应用程序需要的每个模块，然后将所有这些模块打包成一个或多个 <code>bundle</code> 。</p><h3 id="简单版打包模型"><a href="#简单版打包模型" class="headerlink" title="简单版打包模型"></a>简单版打包模型</h3><p>先从简单入手，当 <code>webpack</code> 的配置只有一个出口时，不考虑分包的情况，其实只得到了一个 <code>bundle.js</code> 的文件，这个文件里包含了所有用到的 <code>js</code> 模块，可以直接被加载执行。那么，可以分析一下它的打包思路，大概有以下4步：</p><ol><li>利用 <code>babel</code> 完成代码转换,并生成单个文件的依赖模块 <code>Map</code></li><li>从入口开始递归分析，并生成依赖图谱</li><li>将各个引用模块打包为一个立即执行函数</li><li>将最终的 <code>bundle</code> 文件写入 <code>bundle.js</code> 中</li></ol><p><a href="https://github.com/LuckyWinty/blog/tree/master/code/bundleBuild">见完整代码</a></p><h3 id="webpack打包过程"><a href="#webpack打包过程" class="headerlink" title="webpack打包过程"></a>webpack打包过程</h3><ol><li><strong>初始化参数</strong></li></ol><blockquote><p>解析 <code>webpack</code> 配置参数，合并 <code>shell</code> 传入和 <code>webpack.config.js</code> 文件配置的参数,形成最后的配置结果；</p></blockquote><ol start="2"><li><strong>开始编译</strong></li></ol><blockquote><p>用上一步得到的参数初始化 <code>Compiler</code> 对象，加载所有配置的插件，插件可监听 <code>webpack</code> 构建生命周期的事件节点，做出相应的反应，执行 <code>Compiler</code> 对象的 <code>run</code> 方法开始执行编译构建过程<br><strong>注</strong>：<code>webpack</code>的构建流程包括 <code>compile</code>、<code>make</code>、<code>build</code>、<code>seal</code>、<code>emit</code>阶段，执行完这些阶段就完成了构建过程。</p></blockquote><ol start="3"><li><strong>确定入口</strong></li></ol><blockquote><p>根据配置中的 <code>entry入口</code> ，开始解析文件并构建 <code>AST</code> 语法树，找出依赖，递归下去；</p></blockquote><ol start="4"><li><strong>编译模块</strong></li></ol><blockquote><p>递归中根据文件类型和 <code>loader</code> 配置，调用所有配置的 <code>loader</code> 对文件进行转换，再找出该模块依赖的模块，再递归本步骤，直到所有入口依赖的文件都经过了本步骤的处理</p></blockquote><ol start="5"><li><strong>完成模块编译</strong></li></ol><blockquote><p>在经过第4步使用 <code>Loader</code> 转换所有模块后， 得到了每个模块被编译后的最终内容及它们之间的依赖关系</p></blockquote><ol start="6"><li><strong>输出资源</strong></li></ol><blockquote><p>根据入口和模块之间的依赖关系，组装成包含多个模块的 <code>代码块Chunk</code> ，再将每个 <code>Chunk</code> 转换成一个单独的文件加入输出列表中，这是可以修改输出内容的最后机会</p></blockquote><ol start="7"><li><strong>输出完成</strong></li></ol><blockquote><p>在确定好输出内容后，根据配置确定输出的路径和文件名，将文件的内容写入文件系统中。</p></blockquote><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/71b263000fa94db792cf1e98d67a578a~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp"></p><p>整个流程概括为3个阶段，初始化、编译、输出。而在每个阶段中又会发生很多事件， <code>Webpack</code> 会将这些事件广播出来供 <code>Plugin</code> 使用。具体钩子，可以看<a href="https://webpack.js.org/api/compiler-hooks/#hooks">官方文档</a>。</p><h2 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h2><h3 id="entry-options-启动"><a href="#entry-options-启动" class="headerlink" title="entry-options 启动"></a>entry-options 启动</h3><p>从配置文件和 <code>Shell</code> 语句中读取与合并参数，得出最终的参数。</p><h3 id="run-实例化"><a href="#run-实例化" class="headerlink" title="run 实例化"></a>run 实例化</h3><p><code>compiler</code>：用上一步得到的参数初始化 <code>Compiler</code> 对象，加载所有配置的插件，执行对象的 <code>run</code> 方法开始执行编译</p><h2 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h2><ol><li>entry 确定入口</li></ol><blockquote><p> 根据配置中的 <code>entry</code> 找出所有的入口文件</p></blockquote><ol start="2"><li>make 编译模块</li></ol><blockquote><p>从入口文件出发，调用所有配置的 <code>Loader</code> 对模块进行翻译，再找出该模块依赖的模块，再递归本步骤直到所有入口依赖的文件都经过了本步骤的处理</p></blockquote><ol start="3"><li>build module 完成模块编译</li></ol><blockquote><p>经过上面一步使用 <code>Loader</code> 翻译完所有模块后，得到了每个模块被翻译后的最终内容以及它们之间的依赖关系</p></blockquote><ol start="4"><li>seal 输出资源</li></ol><blockquote><p>根据入口和模块之间的依赖关系，组装成一个个包含多个模块的 <code>Chunk</code> ，再把每个 <code>Chunk</code> 转换成一个单独的文件加入到输出列表，这步是可以修改输出内容的最后机会</p></blockquote><ol start="5"><li>emit 输出完成</li></ol><blockquote><p>在确定好输出内容后，根据配置确定输出的路径和文件名，把文件内容写入到文件系统</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> 打包/封装 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webpack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webpack-使用指南（阮一峰）</title>
      <link href="/posts/324dbcc7/"/>
      <url>/posts/324dbcc7/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="阮一峰仓库"><a href="#阮一峰仓库" class="headerlink" title="阮一峰仓库"></a><a href="https://github.com/ruanyf/webpack-demos">阮一峰仓库</a></h2><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>首先，全局安装Webpack和webpack-dev-server</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -g webpack webpack-dev-server</span><br></pre></td></tr></table></figure><p>然后，clone阮一峰的仓库</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/ruanyf/webpack-demos.git</span><br></pre></td></tr></table></figure><p>安装依赖</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> webpack-demos</span><br><span class="line">npm install</span><br></pre></td></tr></table></figure><p>然后再输入安装cli的指令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -g webpack-cli</span><br></pre></td></tr></table></figure><p>现在开始进入目录webpack-demos并且运行它们</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> demo_1</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure><p>上面的代码不会自动的打开你的浏览器，需要手动访问 <code>http://127.0.0.1:8080</code></p><h2 id="Webpack简介"><a href="#Webpack简介" class="headerlink" title="Webpack简介"></a>Webpack简介</h2><h3 id="局部安装"><a href="#局部安装" class="headerlink" title="局部安装"></a>局部安装</h3><p>全局webpack这会将你项目中的 webpack 锁定到指定版本，并且在使用不同的 webpack 版本的项目中，可能会导致构建失败。<br>所以我们需要在项目中安装局部webpack</p><p>首先，每一个项目一开始都需要初始化！</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init -y</span><br></pre></td></tr></table></figure><p>然后，会看到项目根目录下多了一个package.json文件，里面存储着我们项目所使用的各个包的版本</p><p>然后，安装webpack及webpack-cli</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev webpack  </span><br><span class="line">npm install --save-dev webpack-cli</span><br></pre></td></tr></table></figure><p>然后webpack会安装到我们的项目根目录下，同时会多了一个package-lock.json文件<br><img src="https://segmentfault.com/img/remote/1460000021706833"></p><p>Webpack用于构建Javascript模块脚本来给浏览器使用的前端工具。</p><h3 id="打包命令一（没有配置时）"><a href="#打包命令一（没有配置时）" class="headerlink" title="打包命令一（没有配置时）"></a>打包命令一（没有配置时）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">webpack main.js --output-filename bundle.js --output-path . --mode development</span><br></pre></td></tr></table></figure><p>简写</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">webpack main.js -o bundle.js --mode development</span><br></pre></td></tr></table></figure><h3 id="打包命令二（配置了package-json的scripts）"><a href="#打包命令二（配置了package-json的scripts）" class="headerlink" title="打包命令二（配置了package.json的scripts）"></a>打包命令二（配置了package.json的scripts）</h3><p>可以在 <code>package.json </code>中的 <code>scripts</code>选项中进行定制，如下所示</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;webpack-demo1&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;main.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;dev&quot;</span><span class="punctuation">:</span> <span class="string">&quot;webpack --mode development&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;webpack --mode production&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;license&quot;</span><span class="punctuation">:</span> <span class="string">&quot;MIT&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="打包命令三（配置了webpack-config-js）"><a href="#打包命令三（配置了webpack-config-js）" class="headerlink" title="打包命令三（配置了webpack.config.js）"></a>打包命令三（配置了webpack.config.js）</h3><p>由于webpack更新4.0后，很多要求的变严格了，如果不更新配置的话，不但会影响打包速度，而已会不断的输出提示。</p><p>创建一个webpack.config.js配置文件，这个文件就是一个CommonJS的模块（module）</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js的内容</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//这个配置文件就是一个JS文件，通过Mode中的模块操作，向外暴露一个配置对象</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="comment">//手动指定入口和出口</span></span><br><span class="line">  <span class="attr">entry</span>: path.<span class="title function_">join</span>(__dirname,<span class="string">&#x27;./main.js&#x27;</span>),<span class="comment">//入口，表示打包到哪个文件</span></span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">      <span class="attr">path</span>: path.<span class="title function_">join</span>(__dirname,<span class="string">&#x27;./&#x27;</span>),<span class="comment">//出口，表示输出到哪个目录</span></span><br><span class="line">      <span class="attr">filename</span>: <span class="string">&#x27;bundle.js&#x27;</span>,<span class="comment">//指定输出的文件的名称</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;development&#x27;</span>,<span class="comment">//设置mode模式</span></span><br><span class="line">  <span class="attr">watch</span>: <span class="literal">true</span>,<span class="comment">// 监听文件改动，自动打包</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>当建好 <code>webpack.config.js</code>后就能直接运行Webpack，而不加参数</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">webpack</span><br></pre></td></tr></table></figure><p>有一些必须知道的参数选项如下</p><ul><li><code>webpack</code>——开发时的构建命令</li><li><code>webpack -p</code>——发布产品时的构建命令</li><li><code>webpack --watch</code>——用于增量开发的构建</li><li><code>webpack -d</code>——包括source maps</li><li><code>webpack --colors</code>——让构建输出更好看</li></ul><h2 id="Demo-1——入口文件"><a href="#Demo-1——入口文件" class="headerlink" title="Demo_1——入口文件"></a>Demo_1——入口文件</h2><p>入口文件由Webpack读取，然后构建 <code>bundle.js</code></p><p>例如下面，<code>main.js</code>就是一个入口文件</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;&lt;h1&gt;Hello World&lt;/h1&gt;&#x27;</span>);</span><br></pre></td></tr></table></figure><p>index.html</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;bundle.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Webpack依据 <code>webpack.config.js</code>来构建 <code>bundle.js</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//这个配置文件就是一个JS文件，通过Mode中的模块操作，向外暴露一个配置对象</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="comment">//手动指定入口和出口</span></span><br><span class="line">  <span class="attr">entry</span>: path.<span class="title function_">join</span>(__dirname,<span class="string">&#x27;./main.js&#x27;</span>),<span class="comment">//入口，表示打包哪个文件</span></span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">        <span class="attr">path</span>: path.<span class="title function_">join</span>(__dirname,<span class="string">&#x27;./&#x27;</span>),<span class="comment">//指定打包好的文件，输入到哪个目录中</span></span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&#x27;bundle.js&#x27;</span><span class="comment">//指定输出的文件的名称</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">mode</span>: <span class="string">&#x27;development&#x27;</span><span class="comment">//设置mode</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>运行下面的命令然后访问 <code>http://127.0.0.1:8080</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> demo_1</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure><h2 id="Demo-2——多个入口文件"><a href="#Demo-2——多个入口文件" class="headerlink" title="Demo_2——多个入口文件"></a>Demo_2——多个入口文件</h2><p><code>Webpack</code>允许多个入口文件存在，在多页面的app中很有用，每个页面有不同的入口文件。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main1.js</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;&lt;h1&gt;Hello World&lt;/h1&gt;&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// main2.js</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;&lt;h2&gt;Hello Webpack&lt;/h2&gt;&#x27;</span>);</span><br></pre></td></tr></table></figure><p>index.html</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;bundle1.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;bundle2.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>webpack.config.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//这个配置文件就是一个JS文件，通过Mode中的模块操作，向外暴露一个配置对象</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="comment">//手动指定入口和出口</span></span><br><span class="line">  <span class="attr">entry</span>: path.<span class="title function_">join</span>(__dirname,<span class="string">&#x27;./main1.js&#x27;</span>),</span><br><span class="line">  <span class="attr">entry</span>: path.<span class="title function_">join</span>(__dirname,<span class="string">&#x27;./main2.js&#x27;</span>),</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">      <span class="attr">path</span>: path.<span class="title function_">join</span>(__dirname,<span class="string">&#x27;./&#x27;</span>),<span class="comment">//指定打包好的文件，输入到哪个目录中</span></span><br><span class="line">      <span class="attr">filename</span>: <span class="string">&#x27;[name].js&#x27;</span><span class="comment">//指定输出的文件的名称</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;development&#x27;</span><span class="comment">//设置mode</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>运行下面的命令然后访问 <code>http://127.0.0.1:8080</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> demo_2</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure><h2 id="Demo-3——Babel-loader"><a href="#Demo-3——Babel-loader" class="headerlink" title="Demo_3——Babel-loader"></a>Demo_3——Babel-loader</h2><p>加载器(Loaders)是预处理器，让webpack处理非js文件，将所有的文件转换为webpack能够处理的有效模块。</p><p>loader的两个目标</p><ul><li>识别出应该被loader转化的文件， 使用test属性</li><li>转换这些文件，使他们添加到依赖图中，最终添加到bundle中，使用use属性</li></ul><p>babel-loader 是一个将jsx、es6格式的文件转换为js文件的工具</p><p><code>main.jsx</code>是一个JSX文件</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.jsx</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">React</span> = <span class="built_in">require</span>(<span class="string">&#x27;react&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ReactDOM</span> = <span class="built_in">require</span>(<span class="string">&#x27;react-dom&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, world!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>,</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#wrapper&#x27;</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>index.html</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;wrapper&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;bundle.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>webpack.config.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">entry</span>: path.<span class="title function_">join</span>(__dirname,<span class="string">&#x27;./main.jsx&#x27;</span>),<span class="comment">//入口，表示打包哪个文件</span></span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">      <span class="attr">path</span>: path.<span class="title function_">join</span>(__dirname,<span class="string">&#x27;./&#x27;</span>),<span class="comment">//指定打包好的文件，输入到哪个目录中</span></span><br><span class="line">      <span class="attr">filename</span>: <span class="string">&#x27;bundle.js&#x27;</span><span class="comment">//指定输出的文件的名称</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;development&#x27;</span>,<span class="comment">//设置mode</span></span><br><span class="line">  <span class="attr">module</span>: &#123;</span><br><span class="line">    <span class="attr">rules</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.jsx?$/</span>,</span><br><span class="line">        <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        <span class="attr">use</span>: &#123;</span><br><span class="line">          <span class="attr">loader</span>: <span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">          <span class="attr">options</span>: &#123;</span><br><span class="line">            <span class="attr">presets</span>: [<span class="string">&#x27;es2015&#x27;</span>, <span class="string">&#x27;react&#x27;</span>]</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>在上面的代码里需要babel-loader的两个插件babel-preset-es2015和babel-preset-react来转换ES6和React(翻译：现在为废弃了，<a href="https://link.juejin.cn/?target=http://babeljs.io/docs/en/env/" title="http://babeljs.io/docs/en/env/">详情</a>)</p><h2 id="Demo-4——CSS-loader"><a href="#Demo-4——CSS-loader" class="headerlink" title="Demo_4——CSS-loader"></a>Demo_4——CSS-loader</h2><p>Webpack允许在JS文件中包含CSS，需要CSS-loader对这些CSS进行处理</p><p>main.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;./app.css&#x27;</span>);</span><br></pre></td></tr></table></figure><p>app.css</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: blue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>index.html</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;bundle.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>webpack.config.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">entry</span>: path.<span class="title function_">join</span>(__dirname,<span class="string">&#x27;./main.js&#x27;</span>),<span class="comment">//入口，表示打包哪个文件</span></span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">      <span class="attr">path</span>: path.<span class="title function_">join</span>(__dirname,<span class="string">&#x27;./&#x27;</span>),<span class="comment">//指定打包好的文件，输入到哪个目录中</span></span><br><span class="line">      <span class="attr">filename</span>: <span class="string">&#x27;bundle.js&#x27;</span><span class="comment">//指定输出的文件的名称</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;development&#x27;</span>,<span class="comment">//设置mode</span></span><br><span class="line">  <span class="attr">module</span>: &#123;</span><br><span class="line">    <span class="attr">rules</span>:[</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        <span class="attr">use</span>: [ <span class="string">&#x27;style-loader&#x27;</span>, <span class="string">&#x27;css-loader&#x27;</span> ]</span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>注意！必须使用两个加载器来转换CSS文件。CSS-loader用来读取CSS文件来转换，另一个Style-loader用来往HTML中插入 <code>&lt;style&gt;</code>标签。</p><p>然后打开server</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> demo_4</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure><p>事实上，Webpack将CSS文件的内容直接插入到 <code>index.html</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;bundle.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background-color</span>: blue;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">  </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Demo-5——Image-loader"><a href="#Demo-5——Image-loader" class="headerlink" title="Demo_5——Image loader"></a>Demo_5——Image loader</h2><p>Webpack能够将图片包含进JS文件中</p><p>main.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> img1 = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;img&quot;</span>);</span><br><span class="line">img1.<span class="property">src</span> = <span class="built_in">require</span>(<span class="string">&quot;./small.png&quot;</span>);</span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(img1);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> img2 = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;img&quot;</span>);</span><br><span class="line">img2.<span class="property">src</span> = <span class="built_in">require</span>(<span class="string">&quot;./big.png&quot;</span>);</span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(img2);</span><br></pre></td></tr></table></figure><p>index.html</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;bundle.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>webpack.config.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">entry</span>: path.<span class="title function_">join</span>(__dirname,<span class="string">&#x27;./main.js&#x27;</span>),<span class="comment">//入口，表示打包哪个文件</span></span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">      <span class="attr">path</span>: path.<span class="title function_">join</span>(__dirname,<span class="string">&#x27;./&#x27;</span>),<span class="comment">//指定打包好的文件，输入到哪个目录中</span></span><br><span class="line">      <span class="attr">filename</span>: <span class="string">&#x27;bundle.js&#x27;</span><span class="comment">//指定输出的文件的名称</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;development&#x27;</span>,<span class="comment">//设置mode</span></span><br><span class="line">  <span class="attr">module</span>: &#123;</span><br><span class="line">    <span class="attr">rules</span>:[</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.(png|jpg)$/</span>,</span><br><span class="line">        <span class="attr">use</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">loader</span>: <span class="string">&#x27;url-loader&#x27;</span>,</span><br><span class="line">            <span class="attr">options</span>: &#123;</span><br><span class="line">              <span class="attr">limit</span>: <span class="number">8192</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><code>url-loader</code>将image文件转为 <code>&lt;img&gt;</code>标签，如果图片大小&lt;8192字节，它将转换为Data url（翻译：图片变为Base64编码，减少请求次数），否则，他将转为普通文件URL。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;data:image/png;base64,iVBOR...uQmCC&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;4853ca667a2b8b8844eb2693ac1b2578.png&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p>运行下面的命令然后访问 <code>http://127.0.0.1:8080</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> demo_5</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure><h2 id="Demo-6——CSS-Module"><a href="#Demo-6——CSS-Module" class="headerlink" title="Demo_6——CSS Module"></a>Demo_6——CSS Module</h2><p><code>css-loader?modules</code>（请求参数为modules）能够使用CSS Module，CSS Module带给你的JS文件模块中的CSS一个局部作用域，也可以使用 <code>:global(selector)</code>让CSS变为全局作用。</p><p>index.html</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;h1&quot;</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span> <span class="attr">class</span>=<span class="string">&quot;h2&quot;</span>&gt;</span>Hello Webpack<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;example&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./bundle.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>app.css</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* local scope */</span></span><br><span class="line"><span class="selector-class">.h1</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>:red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* global scope */</span></span><br><span class="line">:<span class="built_in">global</span>(.h2) &#123;</span><br><span class="line">  <span class="attribute">color</span>: blue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>main.jsx</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">React</span> = <span class="built_in">require</span>(<span class="string">&#x27;react&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">ReactDOM</span> = <span class="built_in">require</span>(<span class="string">&#x27;react-dom&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> style = <span class="built_in">require</span>(<span class="string">&#x27;./app.css&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">className</span>=<span class="string">&#123;style.h1&#125;</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h2</span> <span class="attr">className</span>=<span class="string">&quot;h2&quot;</span>&gt;</span>Hello Webpack<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>,</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;example&#x27;</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>webpack.config.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">entry</span>: path.<span class="title function_">join</span>(__dirname,<span class="string">&#x27;./main.js&#x27;</span>),<span class="comment">//入口，表示打包哪个文件</span></span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">      <span class="attr">path</span>: path.<span class="title function_">join</span>(__dirname,<span class="string">&#x27;./&#x27;</span>),<span class="comment">//指定打包好的文件，输入到哪个目录中</span></span><br><span class="line">      <span class="attr">filename</span>: <span class="string">&#x27;bundle.js&#x27;</span><span class="comment">//指定输出的文件的名称</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;development&#x27;</span>,<span class="comment">//设置mode</span></span><br><span class="line">  <span class="attr">module</span>: &#123;</span><br><span class="line">    <span class="attr">rules</span>:[</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.js[x]?$/</span>,</span><br><span class="line">        <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        <span class="attr">use</span>: &#123;</span><br><span class="line">          <span class="attr">loader</span>: <span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">          <span class="attr">options</span>: &#123;</span><br><span class="line">            <span class="attr">presets</span>: [<span class="string">&#x27;es2015&#x27;</span>, <span class="string">&#x27;react&#x27;</span>]</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        <span class="attr">use</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">loader</span>: <span class="string">&#x27;style-loader&#x27;</span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">             <span class="attr">loader</span>: <span class="string">&#x27;css-loader&#x27;</span>,</span><br><span class="line">             <span class="attr">options</span>: &#123;</span><br><span class="line">               <span class="attr">modules</span>: <span class="literal">true</span></span><br><span class="line">             &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>访问<a href="https://link.juejin.cn/?target=http://127.0.0.1:8080" title="http://127.0.0.1:8080"> http://127.0.0.1:8080</a>会看到只有 <code>h1</code>是红色的，因为他的CSS是局部作用域，然后所以 <code>h2</code>都是蓝色的，因为它是全局作用域。</p><p>运行下面的命令然后访问 <code>http://127.0.0.1:8080</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> demo_6</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure><h2 id="Demo-7——UglifyJs-Plugin"><a href="#Demo-7——UglifyJs-Plugin" class="headerlink" title="Demo_7——UglifyJs Plugin"></a>Demo_7——UglifyJs Plugin</h2><p>Webpack用插件系统来扩展他的功能。例如，<a href="https://link.juejin.cn/?target=https://webpack.js.org/plugins/uglifyjs-webpack-plugin/" title="https://webpack.js.org/plugins/uglifyjs-webpack-plugin/">UglifyJs Plugin</a>，它用来压缩JS代码，使得JS文件体积变小。</p><p>main.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> longVariableName = <span class="string">&#x27;Hello&#x27;</span>;</span><br><span class="line">longVariableName += <span class="string">&#x27; World&#x27;</span>;</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;&lt;h1&gt;&#x27;</span> + longVariableName + <span class="string">&#x27;&lt;/h1&gt;&#x27;</span>);</span><br></pre></td></tr></table></figure><p>index.html</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;bundle.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>webpack.config.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">&#x27;webpack&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">UglifyJsPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;uglifyjs-webpack-plugin&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">entry</span>: path.<span class="title function_">join</span>(__dirname,<span class="string">&#x27;./main.js&#x27;</span>),<span class="comment">//入口，表示打包哪个文件</span></span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">      <span class="attr">path</span>: path.<span class="title function_">join</span>(__dirname,<span class="string">&#x27;./&#x27;</span>),<span class="comment">//指定打包好的文件，输入到哪个目录中</span></span><br><span class="line">      <span class="attr">filename</span>: <span class="string">&#x27;bundle.js&#x27;</span><span class="comment">//指定输出的文件的名称</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;development&#x27;</span>,<span class="comment">//设置mode</span></span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">UglifyJsPlugin</span>()</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>在访问服务器后，可以看到 <code>main.js</code>最小化为如下代码：</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o=<span class="string">&quot;Hello&quot;</span>;o+=<span class="string">&quot; World&quot;</span>,<span class="built_in">document</span>.write(<span class="string">&quot;&lt;h1&gt;&quot;</span>+o+<span class="string">&quot;&lt;/h1&gt;&quot;</span>)</span><br></pre></td></tr></table></figure><p>（翻译：是在 <code>bundle.js</code>的最后几个代码那，是这些代码）</p><p>运行下面的命令然后访问 <code>http://127.0.0.1:8080</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> demo_7</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure><h2 id="Demo-8——HTML-Webpack-Plugin和Open-Browser-Webpack-Plugin"><a href="#Demo-8——HTML-Webpack-Plugin和Open-Browser-Webpack-Plugin" class="headerlink" title="Demo_8——HTML Webpack Plugin和Open Browser Webpack Plugin"></a>Demo_8——HTML Webpack Plugin和Open Browser Webpack Plugin</h2><p>这个demo用来展示如何加载第三方插件</p><p><code>html-webpack-plugin</code>能为你创建 <code>index.html</code>，<code>open-browser-webpack-plugin</code>能够在Webpack加载时打开一个新的浏览器标签(tab)</p><p>main.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;&lt;h1&gt;Hello World&lt;/h1&gt;&#x27;</span>);</span><br></pre></td></tr></table></figure><p>webpack.config.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">HtmlwebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">OpenBrowserPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;open-browser-webpack-plugin&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">entry</span>: path.<span class="title function_">join</span>(__dirname,<span class="string">&#x27;./main.js&#x27;</span>),<span class="comment">//入口，表示打包哪个文件</span></span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">      <span class="attr">path</span>: path.<span class="title function_">join</span>(__dirname,<span class="string">&#x27;./&#x27;</span>),<span class="comment">//指定打包好的文件，输入到哪个目录中</span></span><br><span class="line">      <span class="attr">filename</span>: <span class="string">&#x27;bundle.js&#x27;</span><span class="comment">//指定输出的文件的名称</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;development&#x27;</span>,<span class="comment">//设置mode</span></span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">HtmlwebpackPlugin</span>(&#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;Webpack-demos&#x27;</span>,</span><br><span class="line">      <span class="attr">filename</span>: <span class="string">&#x27;index.html&#x27;</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">OpenBrowserPlugin</span>(&#123;</span><br><span class="line">      <span class="attr">url</span>: <span class="string">&#x27;http://localhost:8080&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>现在你不用手动创建 <code>index.html</code>也不用手动打开浏览器了。</p><h2 id="Demo-9——环境变量-Environment-flags"><a href="#Demo-9——环境变量-Environment-flags" class="headerlink" title="Demo_9——环境变量(Environment flags)"></a>Demo_9——环境变量(Environment flags)</h2><p>使用环境变量让一些代码只能在开发环境时使用。</p><p>main.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;&lt;h1&gt;Hello World&lt;/h1&gt;&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (__DEV__) &#123;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>index.html</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;bundle.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>webpack.config.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">&#x27;webpack&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> devFlagPlugin = <span class="keyword">new</span> webpack.<span class="title class_">DefinePlugin</span>(&#123;</span><br><span class="line">  <span class="attr">__DEV__</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(process.<span class="property">env</span>.<span class="property">DEBUG</span> || <span class="string">&#x27;false&#x27;</span>))</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">entry</span>: path.<span class="title function_">join</span>(__dirname,<span class="string">&#x27;./main.js&#x27;</span>),<span class="comment">//入口，表示打包哪个文件</span></span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">      <span class="attr">path</span>: path.<span class="title function_">join</span>(__dirname,<span class="string">&#x27;./&#x27;</span>),<span class="comment">//指定打包好的文件，输入到哪个目录中</span></span><br><span class="line">      <span class="attr">filename</span>: <span class="string">&#x27;bundle.js&#x27;</span><span class="comment">//指定输出的文件的名称</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;development&#x27;</span>,<span class="comment">//设置mode</span></span><br><span class="line">  <span class="attr">plugins</span>: [devFlagPlugin]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>现在传递环境变量给Webpack。打开 <code>demo09/package.json</code>，找到如下 <code>scripts</code>选项</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;webpack-demo_9&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;main.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;dev&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cross-env DEBUG=true webpack-dev-server --open&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;webpack --mode production&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;license&quot;</span><span class="punctuation">:</span> <span class="string">&quot;MIT&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>运行下面的命令然后访问 <code>http://127.0.0.1:8080</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> demo_9</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure><h2 id="Demo-10——代码分离"><a href="#Demo-10——代码分离" class="headerlink" title="Demo_10——代码分离"></a>Demo_10——代码分离</h2><p>在大型web应用中，将所有代码放入一个文件是十分低效的。Webpack允许你将大型JS文件分成多块。特别的，如果一些代码块只是在某些情况下需要，那么这些代码块会按需加载。</p><p>Webpack使用 <code>require.ensure</code>来定义一个分割点</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="built_in">require</span>.<span class="title function_">ensure</span>([<span class="string">&#x27;./a&#x27;</span>], <span class="keyword">function</span> (<span class="params"><span class="built_in">require</span></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> content = <span class="built_in">require</span>(<span class="string">&#x27;./a&#x27;</span>);   </span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">open</span>();</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;&lt;h1&gt;&#x27;</span> + content + <span class="string">&#x27;&lt;/h1&gt;&#x27;</span>);</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">close</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><code>require.ensure</code>告诉Webpack <code>./a,js</code>需要从 <code>bundle.js</code>中分离出来作为一个单独的块文件</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// a.js</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="string">&#x27;Hello World&#x27;</span>;</span><br></pre></td></tr></table></figure><p>现在Webpack关心依赖、输出文件、运行时的东西。你不必将多余的东西放到 <code>index.html</code>和 <code>webpack.config.js</code>中</p><p>index.html</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;bundle.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>webpack.config.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//这个配置文件就是一个JS文件，通过Mode中的模块操作，向外暴露一个配置对象</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="comment">//手动指定入口和出口</span></span><br><span class="line">  <span class="attr">entry</span>: path.<span class="title function_">join</span>(__dirname,<span class="string">&#x27;./main.js&#x27;</span>),<span class="comment">//入口，表示打包哪个文件</span></span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">      <span class="attr">path</span>: path.<span class="title function_">join</span>(__dirname,<span class="string">&#x27;./&#x27;</span>),<span class="comment">//指定打包好的文件，输入到哪个目录中</span></span><br><span class="line">      <span class="attr">filename</span>: <span class="string">&#x27;bundle.js&#x27;</span><span class="comment">//指定输出的文件的名称</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;development&#x27;</span><span class="comment">//设置mode</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>访问服务器后，你感觉不到任何不同。实际上，Webpack将构建 <code>main.js</code>和 <code>a.js</code>到不同的块中（<code>bundle.js</code>和 <code>0.bundle.js</code>），然后从 <code>bundle.js</code>中按需加载 <code>0.bundle.js</code></p><p>运行下面的命令然后访问 <code>http://127.0.0.1:8080</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> demo_10</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure><h2 id="Demo-11——bundle-loader下的代码分离"><a href="#Demo-11——bundle-loader下的代码分离" class="headerlink" title="Demo_11——bundle-loader下的代码分离"></a>Demo_11——bundle-loader下的代码分离</h2><p>另一个代码分割的方式是 <code>bundle-loader</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Now a.js is requested, it will be bundled into another file</span></span><br><span class="line"><span class="keyword">var</span> load = <span class="built_in">require</span>(<span class="string">&#x27;bundle-loader!./a.js&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// To wait until a.js is available (and get the exports)</span></span><br><span class="line"><span class="comment">//  you need to async wait for it.</span></span><br><span class="line"><span class="title function_">load</span>(<span class="keyword">function</span>(<span class="params">file</span>) &#123;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">open</span>();</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;&lt;h1&gt;&#x27;</span> + file + <span class="string">&#x27;&lt;/h1&gt;&#x27;</span>);</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">close</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><code>require(&#39;bundle-loader!./a.js&#39;)</code>告诉Webpack从其他块加载 <code>a.js</code></p><p>现在 <code>main.js</code>构建为 <code>bundle.js</code>，<code>a.js</code>构建为 <code>0.bundle.js</code></p><p>运行下面的命令然后访问 <code>http://127.0.0.1:8080</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> demo_11</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure><h2 id="Demo-12——通用块"><a href="#Demo-12——通用块" class="headerlink" title="Demo_12——通用块"></a>Demo_12——通用块</h2><p>在多个JS脚本中有通用块，通过 <code>CommonsChunkPlugin</code>你能提取不同文件中的通用部分，对于浏览器缓存来节省带宽是非常有用的。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main1.jsx</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">React</span> = <span class="built_in">require</span>(<span class="string">&#x27;react&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">ReactDOM</span> = <span class="built_in">require</span>(<span class="string">&#x27;react-dom&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>,</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// main2.jsx</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">React</span> = <span class="built_in">require</span>(<span class="string">&#x27;react&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">ReactDOM</span> = <span class="built_in">require</span>(<span class="string">&#x27;react-dom&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>Hello Webpack<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span>,</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>index.html</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;a&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;b&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;commons.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;bundle1.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;bundle2.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上面的 <code>commons.js</code>是 <code>main1.jsx</code>和 <code>main2.jsx</code>的通用部分。正如你想的，<code>commons.js</code>包括 <code>react</code>和 <code>react-dom</code></p><p>Webpack.config.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">&#x27;webpack&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">entry</span>: &#123;</span><br><span class="line">    <span class="attr">bundle1</span>: <span class="string">&#x27;./main1.jsx&#x27;</span>,</span><br><span class="line">    <span class="attr">bundle2</span>: <span class="string">&#x27;./main2.jsx&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;[name].js&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">module</span>: &#123;</span><br><span class="line">    <span class="attr">rules</span>:[</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.js[x]?$/</span>,</span><br><span class="line">        <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        <span class="attr">use</span>: &#123;</span><br><span class="line">          <span class="attr">loader</span>: <span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">          <span class="attr">options</span>: &#123;</span><br><span class="line">            <span class="attr">presets</span>: [<span class="string">&#x27;es2015&#x27;</span>, <span class="string">&#x27;react&#x27;</span>]</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="keyword">new</span> webpack.<span class="property">optimize</span>.<span class="title class_">CommonsChunkPlugin</span>(&#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;commons&quot;</span>,</span><br><span class="line">      <span class="comment">// (the commons chunk name)</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">filename</span>: <span class="string">&quot;commons.js&quot;</span>,</span><br><span class="line">      <span class="comment">// (the filename of the commons chunk)</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行下面的命令然后访问 <code>http://127.0.0.1:8080</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> demo_12</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure><h2 id="Demo-13——Vendor-chunk"><a href="#Demo-13——Vendor-chunk" class="headerlink" title="Demo_13——Vendor chunk"></a>Demo_13——Vendor chunk</h2><p>通过 <code>CommonsChunkPlugin</code>,你能从JS脚本提取官方库到单独的文件中</p><p>main.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> $ = <span class="built_in">require</span>(<span class="string">&#x27;jquery&#x27;</span>);</span><br><span class="line">$(<span class="string">&#x27;h1&#x27;</span>).<span class="title function_">text</span>(<span class="string">&#x27;Hello World&#x27;</span>);</span><br></pre></td></tr></table></figure><p>index.html</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;vendor.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;bundle.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>webpack.config.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">&#x27;webpack&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">entry</span>: &#123;</span><br><span class="line">    <span class="attr">app</span>: <span class="string">&#x27;./main.js&#x27;</span>,</span><br><span class="line">    <span class="attr">vendor</span>: [<span class="string">&#x27;jquery&#x27;</span>],</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;bundle.js&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="keyword">new</span> webpack.<span class="property">optimize</span>.<span class="title class_">CommonsChunkPlugin</span>(&#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;vendor&#x27;</span>,</span><br><span class="line">      <span class="attr">filename</span>: <span class="string">&#x27;vendor.js&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>在上面的代码中，<code>entry.vendor:[&#39;jquery&#39;]</code>告诉Webpack，<code>jquery</code>应该被包括到通用块 <code>vendor.js</code>中。</p><p>如果你想要一个模块作为全局变量来在不同的模块中使用，比如不用在每个文件中 <code>require(&#39;jquery&#39;)</code>，而是让 <code>$</code>或者 <code>jQuery</code>作为全局变量，需要使用 <code>ProvidePlugin</code>，它能够自动加载模块而不需要到处 <code>import</code>或者是 <code>require</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line">$(<span class="string">&#x27;h1&#x27;</span>).<span class="title function_">text</span>(<span class="string">&#x27;Hello World&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">&#x27;webpack&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">entry</span>: &#123;</span><br><span class="line">    <span class="attr">app</span>: <span class="string">&#x27;./main.js&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;bundle.js&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="keyword">new</span> webpack.<span class="title class_">ProvidePlugin</span>(&#123;</span><br><span class="line">      <span class="attr">$</span>: <span class="string">&#x27;jquery&#x27;</span>,</span><br><span class="line">      <span class="attr">jQuery</span>: <span class="string">&#x27;jquery&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>当然，在Demo13中，你需要自己全局加载 <code>jquery.js</code></p><p>运行下面的命令然后访问 <code>http://127.0.0.1:8080</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> demo_13</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure><h2 id="Demo-14——公开全局变量"><a href="#Demo-14——公开全局变量" class="headerlink" title="Demo_14——公开全局变量"></a>Demo_14——公开全局变量</h2><p>如果你想用一些全局变量，不需要在Webpack包中包含他们，你可以使用webpack.config.js里的 <code>externals</code>字段</p><p>例如，我们有一个 <code>data.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// data.js</span></span><br><span class="line"><span class="keyword">var</span> data = <span class="string">&#x27;Hello World&#x27;</span>;</span><br></pre></td></tr></table></figure><p>index.html</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;data.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;bundle.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>注意，Webpack只会构建 <code>bundle.js</code>, 而不会构建 <code>data.js</code></p><p>我们可以把 <code>data</code>作为全局变量</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&#x27;./main.jsx&#x27;</span>,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;bundle.js&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">module</span>: &#123;</span><br><span class="line">    <span class="attr">rules</span>:[</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.js[x]?$/</span>,</span><br><span class="line">        <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        <span class="attr">use</span>: &#123;</span><br><span class="line">          <span class="attr">loader</span>: <span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">          <span class="attr">options</span>: &#123;</span><br><span class="line">            <span class="attr">presets</span>: [<span class="string">&#x27;es2015&#x27;</span>, <span class="string">&#x27;react&#x27;</span>]</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">externals</span>: &#123;</span><br><span class="line">    <span class="comment">// require(&#x27;data&#x27;) is external and available</span></span><br><span class="line">    <span class="comment">//  on the global var data</span></span><br><span class="line">    <span class="string">&#x27;data&#x27;</span>: <span class="string">&#x27;data&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>此时，你可以 <code>require(&#39;data&#39;)</code>作为模块变量，实际上它是一个全局变量</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.jsx</span></span><br><span class="line"><span class="keyword">var</span> data = <span class="built_in">require</span>(<span class="string">&#x27;data&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">React</span> = <span class="built_in">require</span>(<span class="string">&#x27;react&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">ReactDOM</span> = <span class="built_in">require</span>(<span class="string">&#x27;react-dom&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;data&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>,</span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">body</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>同样可以将 <code>react</code>和 <code>react-dom</code>放入 <code>externals</code>，这样显著的降低构建 <code>bundle.js</code>的时间和文件大小</p><p>运行下面的命令然后访问 <code>http://127.0.0.1:8080</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> demo_14</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure><h2 id="Demo-15——React-router"><a href="#Demo-15——React-router" class="headerlink" title="Demo_15——React router"></a>Demo_15——React router</h2><p>这个Demo使用Webpack来构建React router的官方样例</p><p>先想象一个有控制板、收件箱、日历的小应用</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">+---------------------------------------------------------+</span><br><span class="line">|<span class="string"> +---------+ +-------+ +--------+                        </span>|</span><br><span class="line">|<span class="string"> </span>|<span class="string">Dashboard</span>|<span class="string"> </span>|<span class="string"> Inbox </span>|<span class="string"> </span>|<span class="string">Calendar</span>|<span class="string">      Logged in as Jane </span>|</span><br><span class="line">|<span class="string"> +---------+ +-------+ +--------+                        </span>|</span><br><span class="line">+---------------------------------------------------------+</span><br><span class="line">|<span class="string">                                                         </span>|</span><br><span class="line">|<span class="string">                        Dashboard                        </span>|</span><br><span class="line">|<span class="string">                                                         </span>|</span><br><span class="line">|<span class="string">                                                         </span>|</span><br><span class="line">|<span class="string">   +---------------------+    +----------------------+   </span>|</span><br><span class="line">|<span class="string">   </span>|<span class="string">                     </span>|<span class="string">    </span>|<span class="string">                      </span>|<span class="string">   </span>|</span><br><span class="line">|<span class="string">   </span>|<span class="string"> +              +    </span>|<span class="string">    +---------&gt;            </span>|<span class="string">   </span>|</span><br><span class="line">|<span class="string">   </span>|<span class="string"> </span>|<span class="string">              </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">                      </span>|<span class="string">   </span>|</span><br><span class="line">|<span class="string">   </span>|<span class="string"> </span>|<span class="string">   +          </span>|<span class="string">    </span>|<span class="string">    +-------------&gt;        </span>|<span class="string">   </span>|</span><br><span class="line">|<span class="string">   </span>|<span class="string"> </span>|<span class="string">   </span>|<span class="string">    +     </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">                      </span>|<span class="string">   </span>|</span><br><span class="line">|<span class="string">   </span>|<span class="string"> </span>|<span class="string">   </span>|<span class="string">    </span>|<span class="string">     </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">                      </span>|<span class="string">   </span>|</span><br><span class="line">|<span class="string">   +-+---+----+-----+----+    +----------------------+   </span>|</span><br><span class="line">|<span class="string">                                                         </span>|</span><br><span class="line">+---------------------------------------------------------+</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>webpack.config.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&#x27;./index.js&#x27;</span>,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;bundle.js&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">module</span>: &#123;</span><br><span class="line">    <span class="attr">rules</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        <span class="attr">use</span>: [ <span class="string">&#x27;style-loader&#x27;</span>, <span class="string">&#x27;css-loader&#x27;</span> ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.jsx?$/</span>,</span><br><span class="line">        <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        <span class="attr">use</span>: &#123;</span><br><span class="line">          <span class="attr">loader</span>: <span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">          <span class="attr">options</span>: &#123;</span><br><span class="line">            <span class="attr">presets</span>: [<span class="string">&#x27;es2015&#x27;</span>, <span class="string">&#x27;react&#x27;</span>]</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>index.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; render &#125; <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">BrowserRouter</span>, <span class="title class_">Switch</span>, <span class="title class_">Route</span>, <span class="title class_">Link</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./app.css&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">header</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/app&quot;</span>&gt;</span>Dashboard<span class="tag">&lt;/<span class="name">Link</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/inbox&quot;</span>&gt;</span>Inbox<span class="tag">&lt;/<span class="name">Link</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/calendar&quot;</span>&gt;</span>Calendar<span class="tag">&lt;/<span class="name">Link</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          Logged in as Jane</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">header</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">main</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Switch</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Route</span> <span class="attr">exact</span> <span class="attr">path</span>=<span class="string">&quot;/&quot;</span> <span class="attr">component</span>=<span class="string">&#123;Dashboard&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/app&quot;</span> <span class="attr">component</span>=<span class="string">&#123;Dashboard&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/inbox&quot;</span> <span class="attr">component</span>=<span class="string">&#123;Inbox&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/calendar&quot;</span> <span class="attr">component</span>=<span class="string">&#123;Calendar&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;*&quot;</span> <span class="attr">component</span>=<span class="string">&#123;Dashboard&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Switch</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">main</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dashboard</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>Dashboard<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Inbox</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>Inbox<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Calendar</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>Calendar<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title function_">render</span>((</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">BrowserRouter</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/&quot;</span> <span class="attr">component</span>=<span class="string">&#123;App&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">BrowserRouter</span>&gt;</span></span></span><br><span class="line">), <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#app&#x27;</span>));</span><br></pre></td></tr></table></figure><p>index.html</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;/bundle.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">htmL</span>&gt;</span></span><br></pre></td></tr></table></figure><p>运行下面的命令然后访问 <code>http://127.0.0.1:8080</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> demo_15</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> 打包/封装 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webpack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webpack-优化打包速度</title>
      <link href="/posts/fe106d98/"/>
      <url>/posts/fe106d98/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="优化思路"><a href="#优化思路" class="headerlink" title="优化思路"></a>优化思路</h2><p>既然许多情况下编译less模块不是必须的，那在这些情况下单独编译js模块就能大幅提升webpack的性能。毕竟less的编译、以及css的抽出都非常消耗时间。</p><h2 id="优化步骤"><a href="#优化步骤" class="headerlink" title="优化步骤"></a>优化步骤</h2><p>优化包含以下两步：</p><ul><li>区分编译目标，单独编译js?  还是单独编辑css？  还是js+css?</li><li>入口文件分离js和css</li></ul><h3 id="1-区分编译目标"><a href="#1-区分编译目标" class="headerlink" title="1 区分编译目标"></a>1 区分编译目标</h3><p>这一步比较简单，我们需要使用 <code>cross-env</code>这个插件，例如下面两条编译命令区分了编译js和编译js+css。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;build:js&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cross-env ctarget=all webpack&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;biuld:js+css&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cross-env ctarget=js webpack&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>这样我们就可以在webpack配置文件中通过 <code>process.env.ctarget</code>区分当前编译目标了。</p><h3 id="2-分离js和css"><a href="#2-分离js和css" class="headerlink" title="2 分离js和css"></a>2 分离js和css</h3><p>这一步需要通过webpack的loader来实现，可以使用现有的轮子 <code>string-replace-loader</code>。</p><p>这个loader可以在编译阶段修改代码，并且可以使用正则表达式进行替换。可以使用它来加载js文件，然后删除部分代码。下面的例子的作用是删除js文件中所有的less代码导入。</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">module</span>: &#123;</span><br><span class="line">        <span class="attr">rules</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/.js$/</span>,</span><br><span class="line">                <span class="attr">use</span>: (<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                    <span class="keyword">var</span> list = [<span class="string">&#x27;这里可以加上其他需要的loader&#x27;</span>]; </span><br><span class="line">                    <span class="comment">// 更具编译目标删除less的导入</span></span><br><span class="line">                    <span class="keyword">if</span> (process.env.ctarget === <span class="string">&#x27;js&#x27;</span>) &#123;</span><br><span class="line">                        list.<span class="built_in">push</span>(&#123;</span><br><span class="line">                            <span class="attr">loader</span>: <span class="string">&#x27;string-replace-loader&#x27;</span>,</span><br><span class="line">                            <span class="attr">options</span>: &#123;</span><br><span class="line">                                <span class="attr">search</span>: <span class="string">&#x27;^.+?require\\(.+(\\.less).+$&#x27;</span>,</span><br><span class="line">                                <span class="attr">replace</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">                                <span class="attr">flags</span>: <span class="string">&#x27;m&#x27;</span></span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;)</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">return</span> list;</span><br><span class="line">                &#125;) ()</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里在使用 <code>string-replace-loader</code>一定要加上 <code>flags: &#39;m&#39;</code>，否则无法进行多行匹配。</p><blockquote><p>如果要单独打包css我们可以写一个和 <code>string-replace-loader</code>作用相反的loader，只保留样式部分而删除其他js代码。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> 打包/封装 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webpack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>知识点</title>
      <link href="/posts/8c9aed93/"/>
      <url>/posts/8c9aed93/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="Java程序的基本结构"><a href="#Java程序的基本结构" class="headerlink" title="Java程序的基本结构"></a>Java程序的基本结构</h2><h3 id="Java程序（类）-x2F-静态方法（函数）库-x2F-数据类型"><a href="#Java程序（类）-x2F-静态方法（函数）库-x2F-数据类型" class="headerlink" title="Java程序（类）&#x2F;静态方法（函数）库&#x2F;数据类型"></a>Java程序（类）&#x2F;静态方法（函数）库&#x2F;数据类型</h3><ul><li>原始数据类型：定义整数、浮点数、布尔值</li><li>语句：声明、赋值、条件、循环、调用、返回</li><li>数组</li><li>静态方法：可以封装并重用代码，可作为独立的模块开发程序</li><li>字符串</li><li>标准输入&#x2F;输出</li><li>数据抽象：数据抽象封装和重用代码，可用于定义非原始数据类型，进而支持面向对象编程</li></ul><h3 id="原始数据类型及表达式"><a href="#原始数据类型及表达式" class="headerlink" title="原始数据类型及表达式"></a>原始数据类型及表达式</h3><h4 id="四种最基本的原始数据类型"><a href="#四种最基本的原始数据类型" class="headerlink" title="四种最基本的原始数据类型"></a>四种最基本的原始数据类型</h4><p>整型，及其算术运算符（int）——32位</p><p>浮点型，及其算术运算符（double）——64位</p><p>布尔型，其值{true、false}及其逻辑操作（boolean）</p><p>字符型，其值为可支持的英文字母数字字符和符号（char）</p><h4 id="其他五种原始数据类型"><a href="#其他五种原始数据类型" class="headerlink" title="其他五种原始数据类型"></a>其他五种原始数据类型</h4><p>64位整数，及其算术运算符（long）</p><p>16位整数，及其算术运算符（short）</p><p>16位字符，及其算术运算符（char）</p><p>8位整数，及其算术运算符（byte）</p><p>32位单精度实数，及其算术运算符（float）</p><h3 id="语句"><a href="#语句" class="headerlink" title="语句"></a>语句</h3><p>声明语句：创建某种类型的变量并用标识符为其命名</p><p>赋值语句：将（右侧表达式产生）某种类型的数值赋给一个单变量（左侧）</p><p>条件语句：简单地改变执行流程（根据指定条件，执行某个代码段）</p><p>循环语句：彻底地改变执行流程（若条件为真，反复执行该代码段）</p><p>调用语句及返回语句：和静态方法有关，是改变执行流程和代码组织的另一种形式</p><h4 id="起别名"><a href="#起别名" class="headerlink" title="起别名"></a>起别名</h4><p>数组名表示的是整个数组——如果将一个数组变量赋予另一个变量，那么两个变量将会指向同一个数组。例如以下这段代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span>[] a = <span class="keyword">new</span> <span class="title class_">int</span>[N];</span><br><span class="line">...</span><br><span class="line">a[i] = <span class="number">1234</span>;</span><br><span class="line">...</span><br><span class="line"><span class="type">int</span>[] b= a;</span><br><span class="line">...</span><br><span class="line">b[i] = <span class="number">5678</span>; <span class="comment">// a[i]的值也会变成5678</span></span><br></pre></td></tr></table></figure><h3 id="静态方法"><a href="#静态方法" class="headerlink" title="静态方法"></a>静态方法</h3><p>修饰符static将静态方法与实例方法区别开来。</p><p><img src="/image/%E7%9F%A5%E8%AF%86%E7%82%B9/1656564218608.png" alt="1656564218608"></p><h4 id="方法的性质"><a href="#方法的性质" class="headerlink" title="方法的性质"></a>方法的性质</h4><ul><li>参数按值传递</li><li>可被重载</li><li>只能返回一个值，但可以包含多个返回语句</li><li>可以产生副作用（接受输入、产生输出、修改数组、改变系统状态）</li></ul><h4 id="递归"><a href="#递归" class="headerlink" title="递归"></a>递归</h4><ul><li>递归总有一个最简单的实现方法——方法的第一条语句总是一个包含return的条件语句</li><li>递归调用总是去尝试解决一个规模更小的子问题，这样递归才能收敛到最简单的情况。</li><li>递归调用的父问题和尝试解决的子问题之间不应该有交集。</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 此为二分查找的递归实现</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">rank</span><span class="params">(<span class="type">int</span> key, <span class="type">int</span>[] a)</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> rank(key, a, <span class="number">0</span>,a.length - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">rank</span><span class="params">(<span class="type">int</span> key, <span class="type">int</span>[] a, <span class="type">int</span> ls, <span class="type">int</span> re)</span> &#123;</span><br><span class="line">  <span class="comment">// 如果key存在于a[]中，其索引应该位于ls与re之间</span></span><br><span class="line">  <span class="keyword">if</span> (ls &gt; re) &#123; <span class="keyword">return</span> -<span class="number">1</span>; &#125;</span><br><span class="line">  <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> ls + (re - ls) / <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">if</span> (key &lt; a[mid]) &#123; <span class="keyword">return</span> rank(key, a, ls, mid - <span class="number">1</span>); &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (key &gt; a[mid]) &#123; <span class="keyword">return</span> rank(key, a, mid + <span class="number">1</span>, re); &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123; <span class="keyword">return</span> mid; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h4><p>设计开发用例，对库中的所有方法进行测试</p><h4 id="外部库"><a href="#外部库" class="headerlink" title="外部库"></a>外部库</h4><p>系统标准库</p><ul><li>Math</li><li>Integer[*]</li><li>Double[*]</li><li>String[*]</li><li>StringBuilder</li><li>System</li></ul><p>导入的系统库</p><ul><li>java.util.Arrsys</li></ul><p>标准库</p><ul><li>StdIn</li><li>StdOut</li><li>StdDraw</li><li>StdRandom</li><li>StdStats</li><li>In[*]</li><li>Out[*]</li></ul><p>[*] 含有静态方法的数据类型的定义</p><p>使用方法</p><ol><li>先下载这些库的源代码并放入工作目录中</li><li>在程序开头使用import语句导入</li></ol><h3 id="API"><a href="#API" class="headerlink" title="API"></a>API</h3><p>应用程序编程接口：包含库的方法名称、签名、简单描述</p><p>目的：将调用和实现分离</p><h3 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h3><h4 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h4><p>String值和数字之间转换的API</p><table><thead><tr><th>public class Integer</th><th></th></tr></thead><tbody><tr><td>static int parseInt(String s)</td><td>将字符串s转换为整数</td></tr><tr><td>static String toString(int i)</td><td>将整数i转换为字符串</td></tr></tbody></table><table><thead><tr><th>public class Double</th><th></th></tr></thead><tbody><tr><td>static string parseDouble(String s)</td><td>将字符串s转换为浮点数</td></tr><tr><td>static String toString(double x)</td><td>将浮点数x转换为字符串</td></tr></tbody></table><h4 id="完成的二分查找代码段"><a href="#完成的二分查找代码段" class="headerlink" title="完成的二分查找代码段"></a>完成的二分查找代码段</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BinarySearch</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">rank</span><span class="params">(<span class="type">int</span> key, <span class="type">int</span>[] a)</span> &#123;</span><br><span class="line">    <span class="comment">// 数组必须是有序的</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">ls</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">re</span> <span class="operator">=</span> a.length - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (ls &lt;= re) &#123;</span><br><span class="line">      <span class="comment">// 被查找的键要么不存在，要么比如存在于a[ls..re]之中</span></span><br><span class="line">      <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> ls + (re - ls) / <span class="number">2</span>;</span><br><span class="line">      <span class="keyword">if</span> (key &lt; a[mid]) &#123; re = mid - <span class="number">1</span>; &#125;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (key &gt; a[mid]) &#123; ls = mid + <span class="number">1</span>; &#125;</span><br><span class="line">      <span class="keyword">else</span> &#123; <span class="keyword">return</span> mid; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">int</span>[] whitelist = In.readInts(args[<span class="number">0</span>]);</span><br><span class="line">    Arrays.sort(whitelist);</span><br><span class="line">    <span class="keyword">while</span> (!StdIn.isEmpty()) &#123;</span><br><span class="line">      <span class="comment">//读取键值，如果不存在于白名单中则将其打印出来</span></span><br><span class="line">      <span class="type">int</span> <span class="variable">key</span> <span class="operator">=</span> StdIn.readInt();</span><br><span class="line">      <span class="keyword">if</span> (rank(key, whitelist) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        StdOut.printIn(key);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="问答"><a href="#问答" class="headerlink" title="问答"></a>问答</h3><p>问：为什么数组的起始索引是0而不是1?<br>答：这个习惯来源于机器语言，那时要计算一个数组元素的地址需要将数组的起始地址加上该元素的索引。将起始索引设为1要么会浪费数组的第一个元素的空间，要么会花费额外的时间来将索引减1。</p><p>问：在Java中，一个静态方法能够将另一个静态方法作为参数吗?<br>答：不行，但问得好，因为有很多语言都能够这么做。</p><h2 id="数据抽象"><a href="#数据抽象" class="headerlink" title="数据抽象"></a>数据抽象</h2>]]></content>
      
      
      <categories>
          
          <category> 后端开发 </category>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Butterfly主题-标签外挂</title>
      <link href="/posts/75cd1967/"/>
      <url>/posts/75cd1967/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>更多细节请移步至 <a href="https://qianchenggit.github.io/2021/02/20/%E5%A4%96%E6%8C%82%E6%A0%87%E7%AD%BE/">添加Butterfly外挂标签样式</a></p><h2 id="标签外挂"><a href="#标签外挂" class="headerlink" title="标签外挂"></a>标签外挂</h2><p>标签外挂是Hexo独有的功能，并不是标准的Markdown格式。</p><p>以下的写法，只适用于Butterfly主题，用在其它主题上不会有效果，甚至可能会报错。使用前请留意</p><p>标签外挂虽然能为主题带来一些额外的功能和UI方面的强化，但是，标签外挂也有明显的限制，使用时请留意。</p><h3 id="Note语法"><a href="#Note语法" class="headerlink" title="Note语法"></a>Note语法</h3><p> 移植于next主题：（注意，书写不是 <code>markdown</code> 规范，而是 <code>hexo</code> 特有的功能，故在其它地方会显示不出效果）</p><p>在配置文件 <code>butterfly.yml</code>修改：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">note:</span></span><br><span class="line">  <span class="comment"># Note tag style values:</span></span><br><span class="line">  <span class="comment"># - simple    bs-callout old alert style. Default.</span></span><br><span class="line">  <span class="comment"># - modern    bs-callout new (v2-v3) alert style.</span></span><br><span class="line">  <span class="comment"># - flat      flat callout style with background, like on Mozilla or</span></span><br><span class="line">  <span class="attr">style:</span> <span class="string">flat</span></span><br><span class="line">  <span class="attr">icons:</span> <span class="literal">true</span>        <span class="comment"># 是否开启图片</span></span><br><span class="line">  <span class="attr">border_radius:</span> <span class="number">3</span></span><br><span class="line">  <span class="comment"># Offset lighter of background in % for modern and flat styles (modern: -12 | 12; flat: -18 | 6).</span></span><br><span class="line">  <span class="comment"># Offset also applied to label tag variables. This option can work with disabled note tag.</span></span><br><span class="line">  <span class="attr">light_bg_offset:</span> <span class="number">0</span></span><br></pre></td></tr></table></figure><p> 该标签有 <code>两种</code> 使用方法。</p><p> <code>用法1：默认模板</code></p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note <span class="selector-attr">[class]</span> <span class="selector-attr">[no-icon]</span> <span class="selector-attr">[style]</span> %&#125;</span><br><span class="line">Any <span class="attribute">content</span> (support inline tags too.io).</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><table><thead><tr><th>名称</th><th>用法</th></tr></thead><tbody><tr><td>class</td><td>【可选】标识，不同的标识有不同的配色（ default &#x2F; primary &#x2F; success &#x2F; info &#x2F; warning &#x2F; danger ）</td></tr><tr><td>no-icon</td><td>【可选】不显示 icon</td></tr><tr><td>style</td><td>【可选】可以覆盖配置中的 style（simple&#x2F;modern&#x2F;flat&#x2F;disabled）</td></tr></tbody></table><p>如下图所示</p><p><img src="https://pic-bed-1305292171.file.myqcloud.com/wv-blog/_post/hexo-noteimage-20220117234539263.png" alt="img"></p><p>用法2：自定义icon（3.2.0以上版本支持）</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note [color] [icon] [style] %&#125;</span><br><span class="line"><span class="title class_">Any</span> content (support inline tags too.<span class="property">io</span>).</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><table><thead><tr><th>名称</th><th>用法</th></tr></thead><tbody><tr><td>color</td><td>【可选】颜色(default &#x2F; blue &#x2F; pink &#x2F; red &#x2F; purple &#x2F; orange &#x2F; green)</td></tr><tr><td>icon</td><td>【可选】可配置自定义icon（只支持fontawesome图标，也可配置no-icon）</td></tr><tr><td>style</td><td>【可选】可以覆盖配置中的style（simple&#x2F;modern&#x2F;flat&#x2F;disabled）</td></tr></tbody></table><p>如下图所示</p><p><img src="https://pic-bed-1305292171.file.myqcloud.com/wv-blog/_post/hexo-noteimage-20220117234802507.png" alt="img"></p><h3 id="Gallery相册图库"><a href="#Gallery相册图库" class="headerlink" title="Gallery相册图库"></a>Gallery相册图库</h3><p><code>hexo new page xxx </code> 创建页面</p><p>然后在 xxx 页面中使用标签外挂 galleryGroup，具体用法请查看对应的内容。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;div</span> <span class="string">class=&quot;gallery-group-main&quot;&gt;</span></span><br><span class="line">&#123;<span class="string">%</span> <span class="string">galleryGroup</span> <span class="string">&#x27;name&#x27;</span> <span class="string">&#x27;description&#x27;</span> <span class="string">&#x27;子相册相对地址&#x27;</span> <span class="string">img-url</span> <span class="string">%</span>&#125;</span><br><span class="line">&#123;<span class="string">%</span> <span class="string">galleryGroup</span> <span class="string">&#x27;name&#x27;</span> <span class="string">&#x27;description&#x27;</span> <span class="string">&#x27;子相册相对地址&#x27;</span> <span class="string">img-url</span> <span class="string">%</span>&#125;</span><br><span class="line">&#123;<span class="string">%</span> <span class="string">galleryGroup</span> <span class="string">&#x27;name&#x27;</span> <span class="string">&#x27;description&#x27;</span> <span class="string">&#x27;子相册相对地址&#x27;</span> <span class="string">img-url</span> <span class="string">%</span>&#125;</span><br><span class="line"><span class="string">&lt;/div&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">name:</span> <span class="string">图库名字</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">图库描述</span></span><br><span class="line"><span class="attr">link:</span> <span class="string">链接子相册地址</span></span><br><span class="line"><span class="attr">img-url:</span> <span class="string">图库地址</span></span><br></pre></td></tr></table></figure><h3 id="Gallery相册"><a href="#Gallery相册" class="headerlink" title="Gallery相册"></a>Gallery相册</h3><p>子页面，通过 <code>hexo n page xxx</code> 来创建</p><p>然后使用标签外挂gallery，具体用法请查看对应的内容</p><p>可以根据 <code>图片长度</code> 自行排列</p><figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="template-tag">&#123;% <span class="name">gallery</span> %&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">// markdown 导入图片格式</span></span><br><span class="line"><span class="language-xml">![图片描述](url链接)</span></span><br><span class="line"><span class="language-xml"></span><span class="template-tag">&#123;% <span class="name">endgallery</span> %&#125;</span></span><br></pre></td></tr></table></figure><p><strong>因为这个功能是用在Hexo美化中，在此博客效果不显示。</strong></p><h3 id="tag-hide：文字标签隐藏"><a href="#tag-hide：文字标签隐藏" class="headerlink" title="tag-hide：文字标签隐藏"></a>tag-hide：文字标签隐藏</h3><p>这个可以提供一个 <code>按钮</code>，点击它，显示你隐藏的 <code>文字</code>、<code>图片</code>等。</p><blockquote><p>hideInline：这个可以隐藏 <code>文字</code>( content不能包含英文逗號，可用 <code>&amp;sbquo;</code>)</p></blockquote><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% hideInline <span class="attribute">content</span>,<span class="attribute">display</span>,bg,<span class="attribute">color</span> %&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Block：这个也是提供一个 <code>按钮</code>，而他可以隐藏 <code>文字</code>、<code>图片</code>、<code>代码块</code>等。( dispaly不能包含英文逗號，可用 <code>&amp;sbquo;</code>)</p></blockquote><figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="template-tag">&#123;% <span class="name">hideBlock</span> display,bg,color %&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">content</span></span><br><span class="line"><span class="language-xml"></span><span class="template-tag">&#123;% <span class="name">endhideBlock</span> %&#125;</span></span><br></pre></td></tr></table></figure><blockquote><p>Toggle：如果你需要展示的 <code>內容太多</code>，可以把它 <code>隐藏</code>在收缩框里，需要时再把它 <code>展开</code>。</p></blockquote><figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="template-tag">&#123;% <span class="name">hideToggle</span> display,bg,color %&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">content</span></span><br><span class="line"><span class="language-xml"></span><span class="template-tag">&#123;% <span class="name">endhideToggle</span> %&#125;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>content</td><td>文本内容</td></tr><tr><td>display</td><td>【可选】按钮显示的文字</td></tr><tr><td>bg</td><td>【可选】按钮背景颜色</td></tr><tr><td>color</td><td>【可选】按钮文字颜色</td></tr></tbody></table><p>Demo</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">您好</span><br><span class="line">&#123;% hideInline  别点我,diaplay,#FF7242,#fff %&#125;</span><br></pre></td></tr></table></figure><p>Demo</p><figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">座右铭座右铭！！</span></span><br><span class="line"><span class="language-xml"></span><span class="template-tag">&#123;% <span class="name">hideBlock</span>  别点我,#FF7242,#fff %&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">何其荣幸 何德何能</span></span><br><span class="line"><span class="language-xml"></span><span class="template-tag">&#123;% <span class="name">endhideBlock</span> %&#125;</span></span><br></pre></td></tr></table></figure><p>Demo</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;% hideToggle Wecome to my Blog %&#125;</span><br><span class="line"> 欢迎欢迎欢迎</span><br><span class="line"> MoYu‘s Blog</span><br><span class="line"> Gitee：https:<span class="regexp">//m</span>oyu-zc.gitee.io/</span><br><span class="line"> Github：https:<span class="regexp">//m</span>oyu-zc.github.io/</span><br><span class="line">&#123;% endhideToggle %&#125;</span><br></pre></td></tr></table></figure><h3 id="mermaid：图形绘制"><a href="#mermaid：图形绘制" class="headerlink" title="mermaid：图形绘制"></a>mermaid：图形绘制</h3><p>mermaid标签不允许嵌套于一些隐藏属性的标签外挂</p><p>例如: tag-hide內的标签外挂和tabs标签外挂，也不能压缩代码</p><p>这会导致mermaid图示无法正常显示，使用时请留意。</p><p>使用mermaid标签可以绘制 <code>Flowchart（流程图）</code>、<code>Sequence diagram（时序图 ）</code>、<code>Class Diagram（类别图）</code>、<code>State Diagram（状态图）</code>、<code>Gantt（甘特图）</code>和 <code>Pie Chart（圆形图）</code>，具体查看<a href="https://mermaid-js.github.io/mermaid/#/">mermaid文档</a><br>在配置文件 <code>butterfly.yml</code>中修改:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mermaid</span></span><br><span class="line"><span class="comment"># see https://github.com/mermaid-js/mermaid</span></span><br><span class="line"><span class="attr">mermaid:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># built-in themes: default/forest/dark/neutral</span></span><br><span class="line">  <span class="attr">theme:</span></span><br><span class="line">    <span class="attr">light:</span> <span class="string">default</span></span><br><span class="line">    <span class="attr">dark:</span> <span class="string">dark</span></span><br></pre></td></tr></table></figure><p><code>写法</code>：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 格式</span><br><span class="line">&#123;% mermaid %&#125;</span><br><span class="line">內容</span><br><span class="line">&#123;% endmermaid %&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Demo——饼状图构建</p></blockquote><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;% mermaid %&#125;</span><br><span class="line">pie</span><br><span class="line">   title Key elements <span class="keyword">in</span> Product X</span><br><span class="line">   <span class="string">&quot;A&quot;</span> : 50</span><br><span class="line">   <span class="string">&quot;B&quot;</span> : 20</span><br><span class="line">   <span class="string">&quot;C&quot;</span> : 10</span><br><span class="line">   <span class="string">&quot;D&quot;</span> :  5</span><br><span class="line">&#123;% endmermaid %&#125;</span><br></pre></td></tr></table></figure><p><strong>因为这个功能是用在Hexo美化中，在此博客效果不显示，具体可移步我的博客（最下方链接）</strong></p><h3 id="Tabs：标签页-选项卡切换"><a href="#Tabs：标签页-选项卡切换" class="headerlink" title="Tabs：标签页(选项卡切换)"></a>Tabs：标签页(选项卡切换)</h3><blockquote><p>构建语法：</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs Unique name, [index] %&#125;</span><br><span class="line">&lt;!-- tab [Tab caption] [@icon] --&gt;</span><br><span class="line">Any content (support inline tags too).</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br><span class="line"></span><br><span class="line">Unique name   : Unique name of tabs block tag without comma.</span><br><span class="line"><span class="code">                Will be used in #id&#x27;s as prefix for each tab with their index numbers.</span></span><br><span class="line"><span class="code">                If there are whitespaces in name, for generate #id all whitespaces will replaced by dashes.</span></span><br><span class="line"><span class="code">                Only for current url of post/page must be unique!</span></span><br><span class="line"><span class="code">[index]       : Index number of active tab.</span></span><br><span class="line"><span class="code">                If not specified, first tab (1) will be selected.</span></span><br><span class="line"><span class="code">                If index is -1, no tab will be selected. It&#x27;s will be something like spoiler.</span></span><br><span class="line"><span class="code">                Optional parameter.</span></span><br><span class="line"><span class="code">[Tab caption] : Caption of current tab.</span></span><br><span class="line"><span class="code">                If not caption specified, unique name with tab index suffix will be used as caption of tab.</span></span><br><span class="line"><span class="code">                If not caption specified, but specified icon, caption will empty.</span></span><br><span class="line"><span class="code">                Optional parameter.</span></span><br><span class="line"><span class="code">[@icon]       : FontAwesome icon name (full-name, look like &#x27;fas fa-font&#x27;)</span></span><br><span class="line"><span class="code">                Can be specified with or without space; e.g. &#x27;Tab caption @icon&#x27; similar to &#x27;Tab caption@icon&#x27;.</span></span><br><span class="line"><span class="code">                Optional parameter.</span></span><br></pre></td></tr></table></figure><blockquote><p>案例1：预设选择第一个默认</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test1 %&#125; </span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line">**<span class="title class_">This</span> is <span class="title class_">Tab</span> <span class="number">1.</span>**</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line">**<span class="title class_">This</span> is <span class="title class_">Tab</span> <span class="number">2.</span>**</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line">**<span class="title class_">This</span> is <span class="title class_">Tab</span> <span class="number">3.</span>**</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><p><img src="https://pic-bed-1305292171.file.myqcloud.com/wv-blog/_post/hexo-noteimage-20220117235825596.png"></p><blockquote><p>案例2：预设选择tabs</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test2, <span class="number">3</span> %&#125;</span><br><span class="line">标签页面内容不变</span><br></pre></td></tr></table></figure><blockquote><p>案例3：没有预设值</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test3, -<span class="number">1</span> %&#125;</span><br><span class="line">标签页面内容不变</span><br></pre></td></tr></table></figure><blockquote><p>案例3：没有预设值</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test4 %&#125;</span><br><span class="line">&lt;!-- tab 第一個<span class="title class_">Tab</span> --&gt;</span><br><span class="line">**tab名字為第一個<span class="title class_">Tab</span>**</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab @fab fa-apple-pay --&gt;</span><br><span class="line">**只有圖標 沒有<span class="title class_">Tab</span>名字**</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab 炸彈@fas fa-bomb --&gt;</span><br><span class="line">**名字+icon**</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><p><img src="https://pic-bed-1305292171.file.myqcloud.com/wv-blog/_post/hexo-noteimage-20220118000504259.png"></p><h3 id="Button：按钮"><a href="#Button：按钮" class="headerlink" title="Button：按钮"></a>Button：按钮</h3><blockquote><p>3.0 以上适用</p></blockquote><p><code>模板</code>：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btn [url],[text],[icon],[color] [style] [layout] [position] [size] %&#125;</span><br><span class="line">[url]         : 链接</span><br><span class="line">[text]        : 按钮文字</span><br><span class="line">[icon]        : [可选] 图标</span><br><span class="line">[color]       : [可选] 按钮背景颜色(默认style时）</span><br><span class="line"><span class="code">                      按鈕字體和邊框顔色(outline時)</span></span><br><span class="line"><span class="code">                      default/blue/pink/red/purple/orange/green</span></span><br><span class="line"><span class="code">[style]       : [可选] 按钮样式 默认实心</span></span><br><span class="line"><span class="code">                      outline/留空</span></span><br><span class="line"><span class="code">[layout]      : [可选] 按钮布局 默认为line</span></span><br><span class="line"><span class="code">                      block/留空</span></span><br><span class="line"><span class="code">[position]    : [可选] 按钮位置 前提是设置了layout為block 默认为左边</span></span><br><span class="line"><span class="code">                      center/right/留空</span></span><br><span class="line"><span class="code">[size]        : [可选] 按钮大小</span></span><br><span class="line"><span class="code">                      larger/留空</span></span><br></pre></td></tr></table></figure><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btn &#x27;https://moyu-zc.gitee.io/&#x27;,MoYu,far fa-hand-point-right,block %&#125;</span><br><span class="line">&#123;% btn &#x27;https://moyu-zc.gitee.io/&#x27;,MoYu,far fa-hand-point-right,block center larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://moyu-zc.gitee.io/&#x27;,MoYu,far fa-hand-point-right,block right outline larger %&#125;</span><br></pre></td></tr></table></figure><h3 id="inlineImg：内联展示图片"><a href="#inlineImg：内联展示图片" class="headerlink" title="inlineImg：内联展示图片"></a>inlineImg：内联展示图片</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% inlineImg [src] [height] %&#125;</span><br><span class="line"></span><br><span class="line">[src]      :    圖片鏈接</span><br><span class="line">[height]   ：   圖片高度限制【可選】</span><br></pre></td></tr></table></figure><blockquote><p>举例说明</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">markdown语法:![](url)</span><br><span class="line">&#123;% inlineImg url 150px %&#125;</span><br></pre></td></tr></table></figure><h3 id="label：高亮所需文字"><a href="#label：高亮所需文字" class="headerlink" title="label：高亮所需文字"></a>label：高亮所需文字</h3><blockquote><p>3.7.5及以上版本适用</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% label text color %&#125;</span><br><span class="line"><span class="attr">text</span>:文字</span><br><span class="line"><span class="attr">clolr</span>:【可选】背景颜色，默认为<span class="title function_">default</span>(<span class="keyword">default</span>/blue/pink/red/purple/orange/green)</span><br></pre></td></tr></table></figure><h3 id="timeline：时间线"><a href="#timeline：时间线" class="headerlink" title="timeline：时间线"></a>timeline：时间线</h3><blockquote><p>4.0.0以上支持</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline title,color %&#125;</span><br><span class="line">&lt;!-- timeline title --&gt;</span><br><span class="line">xxxxx</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&lt;!-- timeline title --&gt;</span><br><span class="line">xxxxx</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>title</td><td>标题&#x2F;时间线</td></tr><tr><td>color</td><td>timeline颜色default(留空) &#x2F; blue &#x2F; pink &#x2F; red &#x2F; purple &#x2F; orange &#x2F; green</td></tr></tbody></table><p><img src="https://pic-bed-1305292171.file.myqcloud.com/wv-blog/_post/hexo-noteimage-20220118001325610.png"></p><h3 id="flink"><a href="#flink" class="headerlink" title="flink"></a>flink</h3><blockquote><p>4.1.0 支持</p></blockquote><p>可在任何界面插入类似友情链接列表效果</p><p>内容格式与友情链接界面一样，支持 yml 格式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% flink %&#125;</span><br><span class="line">xxxxxx</span><br><span class="line">&#123;% endflink %&#125;</span><br></pre></td></tr></table></figure><p>Demo</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&#123;% flink %&#125;</span><br><span class="line"><span class="bullet">  -</span> class<span class="emphasis">_name: 友情链接</span></span><br><span class="line"><span class="emphasis">    class_</span>desc: 那些人，那些事</span><br><span class="line"><span class="code">    link_list:</span></span><br><span class="line"><span class="code">      - name: JerryC</span></span><br><span class="line"><span class="code">        link: https://jerryc.me/</span></span><br><span class="line"><span class="code">        avatar: https://jerryc.me/img/avatar.png</span></span><br><span class="line"><span class="code">        descr: 今日事,今日毕</span></span><br><span class="line"><span class="code">  </span></span><br><span class="line"><span class="code">      - name: Hexo</span></span><br><span class="line"><span class="code">        link: https://hexo.io/zh-tw/</span></span><br><span class="line"><span class="code">        avatar: https://d33wubrfki0l68.cloudfront.net/6657ba50e702d84afb32fe846bed54fba1a77add/827ae/logo.svg</span></span><br><span class="line"><span class="code">        descr: 快速、简单且强大的网誌框架</span></span><br><span class="line"><span class="code">  </span></span><br><span class="line"><span class="code">    - class_name: 网站</span></span><br><span class="line"><span class="code">      class_desc: 值得推荐的网站</span></span><br><span class="line"><span class="code">      link_list:</span></span><br><span class="line"><span class="code">        - name: Youtube</span></span><br><span class="line"><span class="code">          link: https://www.youtube.com/</span></span><br><span class="line"><span class="code">          avatar: https://i.loli.net/2020/05/14/9ZkGg8v3azHJfM1.png</span></span><br><span class="line"><span class="code">          descr: 视频网站</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="bullet">        -</span> name: Weibo</span><br><span class="line"><span class="code">          link: https://www.weibo.com/</span></span><br><span class="line"><span class="code">          avatar: https://i.loli.net/2020/05/14/TLJBum386vcnI1P.png</span></span><br><span class="line"><span class="code">          descr: 中国最大社交分享平台</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="bullet">        -</span> name: Twitter</span><br><span class="line"><span class="code">          link: https://twitter.com/</span></span><br><span class="line"><span class="code">          avatar: https://i.loli.net/2020/05/14/5VyHPQqR6LWF39a.png</span></span><br><span class="line"><span class="code">          descr: 社交分享平台</span></span><br><span class="line"><span class="code">  &#123;% endflink %&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
          <category> Butterfly </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>添加图标</title>
      <link href="/posts/446c5690/"/>
      <url>/posts/446c5690/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="如何在-Hexo-中使用插图"><a href="#如何在-Hexo-中使用插图" class="headerlink" title="如何在 Hexo 中使用插图"></a>如何在 Hexo 中使用插图</h2><p>我们编辑文章时或有或无的需要佐上那么几张图片来表达自己的想法, Hexo 中编辑文章的方式是直接写 Markdown 文件, 又没有直接上传图片的接口, 以下是博主从网上收集来的一些 Hexo 中引用图片的办法合集.</p><h3 id="办法1-直接使用-Markdown-提供的引用方法"><a href="#办法1-直接使用-Markdown-提供的引用方法" class="headerlink" title="办法1 直接使用 Markdown 提供的引用方法"></a>办法1 直接使用 Markdown 提供的引用方法</h3><p>在 <code>./source/images/</code> 目录下放置图片, 在 Markdown 中这样写</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% asset_img <span class="regexp">/images/</span>example.png example %&#125;</span><br></pre></td></tr></table></figure><p>这种方法很方便, 配合 livereload 或 browsersync 插件无论是在本地还是在线上都能看到效果, 但是如果您是用的 Markdown 编辑器, 这似乎就有些难受了, 因为在 Markdown 编辑器中是无法识别这样的图片路径的.</p><p>所以对图片的支持程度较差, 您放在 source_dir 下的图片引用后不会正确的显示在本地调试环境或线上, 二者只能取其一, 感觉很难受.</p><h3 id="办法2-使用在线图片存储服务"><a href="#办法2-使用在线图片存储服务" class="headerlink" title="办法2 使用在线图片存储服务."></a>办法2 使用在线图片存储服务.</h3><p>引用图片时, 将图片先上传到一个另外的服务器上, 得到该图片的在线地址, 然后在 Markdown 中引用.</p><p>国内外用户&#x2F;服务商有很多提供类似图床或对象存储的服务, 即外链.</p><ul><li><a href="http://pic.gimhoy.com/">Gimhoy图床</a></li><li><a href="http://yotuku.cn/">极简图床</a></li><li><a href="http://www.qiniu.com/">七牛</a></li><li><del><a href="http://weibotuchuang.sinaapp.com/bookmark.html">微博是个好图床</a> ( 2016.12.16 已挂 )</del></li></ul><p>这些在线图片存储服务使用便捷, 还自带 CDN 加速功能, 但缺点也很明显了, 图片存在别人服务器里面说不定哪天图就挂了, 总觉得不太放心.</p><h3 id="办法3-使用-Hexo-asset-image-插件"><a href="#办法3-使用-Hexo-asset-image-插件" class="headerlink" title="办法3 使用 Hexo-asset-image 插件"></a>办法3 使用 Hexo-asset-image 插件</h3><p><strong>2017年4月1日 在这个插件更新前 (当前版本 v0.0.3) , 不推荐使用这个插件. 原因是使用该插件后导致编译出的 html 文件中文字符会被转化为 unicode 编码, 不利于站内搜索和 SEO 优化. 你可以直接跳到办法4</strong></p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-asset-<span class="built_in">image</span> --<span class="built_in">save</span></span><br></pre></td></tr></table></figure><p><em>非官方插件, 该插件由 CodeFalling 维护, 底部有项目地址</em></p><p>安装该插件后在您项目根目录的 <code>./_config.yml</code> 中寻找到下面这一行, 将 <code>post_asset_folder</code> 的值设置为 <code>true</code>.</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">post_asset_folder:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>该设置会在您使用 <code>hexo new &quot;new post&quot;</code> 时在文章所在目录下生成一个同名文件夹, 您只需将图片放入该文件夹, 然后在需要放置图片的位置写入以下代码即可解决 办法1 出现的问题.</p><figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="template-tag">&#123;% <span class="name">asset_img</span> example.png example %&#125;</span></span><br></pre></td></tr></table></figure><h3 id="办法4-使用官方提供的办法"><a href="#办法4-使用官方提供的办法" class="headerlink" title="办法4 使用官方提供的办法"></a>办法4 使用官方提供的办法</h3><p>2017年4月1日更新</p><p>该方法类似办法3, 只是使用图片的方法由原生的 <code>![]()</code> 改为 Hexo 标签插件.</p><p>首先在您项目根目录的 <code>./_config.yml</code> 中寻找到下面这一行, 将 <code>post_asset_folder</code> 的值设置为 <code>true</code>. 原因办法3中已经介绍, 这里不再阐述.</p><p>然后在需要引用图片的地方写入以下代码即可</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% asset_img example.jpg <span class="keyword">this</span> <span class="keyword">is</span> title %&#125;</span><br></pre></td></tr></table></figure><p>如果你之前使用了 <code>hexo-asset-image</code> 插件的办法, 你可以使用我写的正则表达式一键替换.</p><p>查找</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!\[<span class="comment">([\S ]+)</span>\]\<span class="comment">((\S+)</span>\)</span><br></pre></td></tr></table></figure><p>替换为</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="template-variable">&#123;% asset_img <span class="variable">$2</span> <span class="variable">$1</span> %&#125;</span></span><br></pre></td></tr></table></figure><p>配合我的另一篇文章 <a href="https://blog.mutoe.com/2016/hexo-post-livereload-edit/">实时预览</a> , 写文章简直美滋滋.</p><h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>三种解决办法各有优劣, 博主做个简单的小结.</p><table><thead><tr><th>-</th><th>优点</th><th>缺点</th></tr></thead><tbody><tr><td>1 直接使用 Markdown 引用方法</td><td>图片资源统一存放, 便于管理</td><td>实时预览时排版效果不好</td></tr><tr><td>2 使用在线图片存储服务</td><td>方便移植, 不占用本地空间</td><td>使用不稳定, 不便于管理</td></tr><tr><td>3 使用 Hexo-asset-image 插件</td><td>文件结构更有条理</td><td>对中文支持不友好</td></tr><tr><td>4 使用官方提供的办法</td><td>官方支持</td><td>不适用原生 md 语法</td></tr></tbody></table><p>您可以根据自己的实际情况来进行选择, 不能说哪个办法是最好的, 但肯定有一个最适合您的.</p>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> icon </tag>
            
            <tag> iconfont </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>markdown使用方法</title>
      <link href="/posts/9d274e89/"/>
      <url>/posts/9d274e89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><code>Markdown</code> 语法差异比较多，不过常用的语法基本上在各个编辑器的快捷指令中都包含了，所以不用担心，下面我介绍一些常用的语法：</p><ul><li>标题：利用 <strong><code>#</code></strong> 符号可以设定标题，1个表示一级标题，2个表示二级标题，如此类推；</li><li>引用：利用 <strong><code>&gt;</code></strong> 可以创建引用块；</li><li>代码：利用 ** &#96;** 将待显示内容包起来即可；</li><li>代码块：利用 <strong><code>```</code></strong> 描述即可创建代码块；</li><li>斜体：利用 <strong><code>ctrl + I</code></strong> 即可实现斜体；</li><li>加粗：利用 <strong><code>ctrl + B</code></strong> 即可实现粗体；</li><li>线状：水平分割线可以用 <strong><code>---</code></strong> 或者 <strong><code>***</code></strong> 实现，下划线可以用 <strong><code>ctrl + U</code></strong> 实现，删除线可利用 <strong><code>~~</code></strong> 包裹实现；</li><li>列表：无序列表用 <strong><code>-</code></strong> ，有序列表用数字 <strong><code>+.</code></strong> 。</li></ul><h1 id="Markdown基本语法"><a href="#Markdown基本语法" class="headerlink" title="Markdown基本语法"></a>Markdown基本语法</h1><h2 id="Markdown-标题语法"><a href="#Markdown-标题语法" class="headerlink" title="Markdown 标题语法"></a>Markdown 标题语法</h2><p>要创建标题，请在单词或短语前面添加井号 (<code>#</code>) 。<code>#</code> 的数量代表了标题的级别。例如，添加三个 <code>#</code> 表示创建一个三级标题 (<code>&lt;h3&gt;</code>) (例如：<code>### My Header</code>)。</p><h3 id="可选语法"><a href="#可选语法" class="headerlink" title="可选语法"></a>可选语法</h3><p>还可以在文本下方添加任意数量的 &#x3D;&#x3D; 号来标识一级标题，或者 – 号来标识二级标题。</p><h2 id="Markdown-段落"><a href="#Markdown-段落" class="headerlink" title="Markdown 段落"></a>Markdown 段落</h2><p>要创建段落，请使用空白行将一行或多行文本进行分隔。</p><h2 id="Markdown-换行语法"><a href="#Markdown-换行语法" class="headerlink" title="Markdown 换行语法"></a>Markdown 换行语法</h2><p>在一行的末尾添加两个或多个空格，然后按回车键,即可创建一个换行(<code>&lt;br&gt;</code>)。</p><h2 id="Markdown-强调语法"><a href="#Markdown-强调语法" class="headerlink" title="Markdown 强调语法"></a>Markdown 强调语法</h2><p>通过将文本设置为粗体或斜体来强调其重要性。</p><h3 id="粗体（Bold）"><a href="#粗体（Bold）" class="headerlink" title="粗体（Bold）"></a>粗体（Bold）</h3><p>要加粗文本，请在单词或短语的前后各添加两个星号（asterisks）或下划线（underscores）。如需加粗一个单词或短语的中间部分用以表示强调的话，请在要加粗部分的两侧各添加两个星号（asterisks）。</p><h3 id="斜体（Italic）"><a href="#斜体（Italic）" class="headerlink" title="斜体（Italic）"></a>斜体（Italic）</h3><p>要用斜体显示文本，请在单词或短语前后添加一个星号（asterisk）或下划线（underscore）。要斜体突出单词的中间部分，请在字母前后各添加一个星号，中间不要带空格。</p><h3 id="粗体（Bold）和斜体（Italic）"><a href="#粗体（Bold）和斜体（Italic）" class="headerlink" title="粗体（Bold）和斜体（Italic）"></a>粗体（Bold）和斜体（Italic）</h3><p>要同时用粗体和斜体突出显示文本，请在单词或短语的前后各添加三个星号或下划线。要加粗并用斜体显示单词或短语的中间部分，请在要突出显示的部分前后各添加三个星号，中间不要带空格。</p><h2 id="Markdown-引用语法"><a href="#Markdown-引用语法" class="headerlink" title="Markdown 引用语法"></a>Markdown 引用语法</h2><p>要创建块引用，请在段落前添加一个 <code>&gt;</code> 符号。</p><h3 id="多个段落的块引用"><a href="#多个段落的块引用" class="headerlink" title="多个段落的块引用"></a>多个段落的块引用</h3><p>块引用可以包含多个段落。为段落之间的空白行添加一个 <code>&gt;</code> 符号。</p><h3 id="嵌套块引用"><a href="#嵌套块引用" class="headerlink" title="嵌套块引用"></a>嵌套块引用</h3><p>块引用可以嵌套。在要嵌套的段落前添加一个 <code>&gt;&gt;</code> 符号。</p><h3 id="带有其它元素的块引用"><a href="#带有其它元素的块引用" class="headerlink" title="带有其它元素的块引用"></a>带有其它元素的块引用</h3><p>块引用可以包含其他 Markdown 格式的元素。并非所有元素都可以使用。</p><h2 id="Markdown-列表语法"><a href="#Markdown-列表语法" class="headerlink" title="Markdown 列表语法"></a>Markdown 列表语法</h2><p>可以将多个条目组织成有序或无序列表。</p><h3 id="有序列表"><a href="#有序列表" class="headerlink" title="有序列表"></a>有序列表</h3><p>要创建有序列表，请在每个列表项前添加数字并紧跟一个英文句点。数字不必按数学顺序排列，但是列表应当以数字 1 起始。</p><h3 id="无序列表"><a href="#无序列表" class="headerlink" title="无序列表"></a>无序列表</h3><p>要创建无序列表，请在每个列表项前面添加破折号 (-)、星号 (*) 或加号 (+) 。缩进一个或多个列表项可创建嵌套列表。</p><h3 id="在列表中嵌套其他元素"><a href="#在列表中嵌套其他元素" class="headerlink" title="在列表中嵌套其他元素"></a>在列表中嵌套其他元素</h3><p>要在保留列表连续性的同时在列表中添加另一种元素，请将该元素缩进四个空格或一个制表符。</p><h2 id="Markdown-代码语法"><a href="#Markdown-代码语法" class="headerlink" title="Markdown 代码语法"></a>Markdown 代码语法</h2><p>要将单词或短语表示为代码，请将其包裹在反引号 (&#96;&#96;&#96;) 中。</p><h3 id="转义反引号"><a href="#转义反引号" class="headerlink" title="转义反引号"></a>转义反引号</h3><p>如果你要表示为代码的单词或短语中包含一个或多个反引号，则可以通过将单词或短语包裹在双反引号(&#96;&#96;&#96;&#96;)中。</p><h3 id="代码块"><a href="#代码块" class="headerlink" title="代码块"></a>代码块</h3><p>要创建代码块，请将代码块的每一行缩进至少四个空格或一个制表符。</p><h2 id="Markdown-分隔线语法"><a href="#Markdown-分隔线语法" class="headerlink" title="Markdown 分隔线语法"></a>Markdown 分隔线语法</h2><p>要创建分隔线，请在单独一行上使用三个或多个星号 (<code>***</code>)、破折号 (<code>---</code>) 或下划线 (<code>___</code>) ，并且不能包含其他内容。</p><h2 id="Markdown-链接语法"><a href="#Markdown-链接语法" class="headerlink" title="Markdown 链接语法"></a>Markdown 链接语法</h2><p>链接文本放在中括号内，链接地址放在后面的括号中，链接title可选。</p><p>超链接Markdown语法代码：<br><code>[超链接显示名](超链接地址 &quot;超链接title&quot;)</code></p><h3 id="给链接增加-Title"><a href="#给链接增加-Title" class="headerlink" title="给链接增加 Title"></a>给链接增加 Title</h3><p>链接title是当鼠标悬停在链接上时会出现的文字，这个title是可选的，它放在圆括号中链接地址后面，跟链接地址之间以空格分隔。<br><code>这是一个链接 [Markdown语法](https://markdown.com.cn &quot;最好的markdown教程&quot;)。</code></p><h3 id="网址和Email地址"><a href="#网址和Email地址" class="headerlink" title="网址和Email地址"></a>网址和Email地址</h3><p>使用尖括号可以很方便地把URL或者email地址变成可点击的链接。<br><code>&lt;https://markdown.com.cn&gt;</code></p><h3 id="带格式化的链接"><a href="#带格式化的链接" class="headerlink" title="带格式化的链接"></a>带格式化的链接</h3><p>强调链接：在链接语法前后增加星号。<br><code>I love supporting the **[EFF](https://eff.org)**.</code><br>要将链接表示为代码，请在方括号中添加反引号。<br><code>See the section on [</code>code <code>](#code).</code></p><h3 id="引用类型链接"><a href="#引用类型链接" class="headerlink" title="引用类型链接"></a>引用类型链接</h3><p>引用样式链接是一种特殊的链接，它使URL在Markdown中更易于显示和阅读。参考样式链接分为两部分：与文本保持内联的部分以及存储在文件中其他位置的部分，以使文本易于阅读。</p><h4 id="链接的第一部分格式"><a href="#链接的第一部分格式" class="headerlink" title="链接的第一部分格式"></a>链接的第一部分格式</h4><p>引用类型的链接的第一部分使用两组括号进行格式设置。第一组方括号包围应显示为链接的文本。第二组括号显示了一个标签，该标签用于指向您存储在文档其他位置的链接。</p><p>尽管不是必需的，可以在第一组和第二组括号之间包含一个空格。第二组括号中的标签不区分大小写，可以包含字母，数字，空格或标点符号。</p><p>以下示例格式对于链接的第一部分效果相同：</p><ul><li><code>[hobbit-hole][1]</code></li><li><code>[hobbit-hole] [1]</code></li></ul><h4 id="链接的第二部分格式"><a href="#链接的第二部分格式" class="headerlink" title="链接的第二部分格式"></a>链接的第二部分格式</h4><p>引用类型链接的第二部分使用以下属性设置格式：</p><ol><li>放在括号中的标签，其后紧跟一个冒号和至少一个空格（例如 <code>[label]:</code>）。</li><li>链接的URL，可以选择将其括在尖括号中。</li><li>链接的可选标题，可以将其括在双引号，单引号或括号中。</li></ol><p>可以将链接的第二部分放在Markdown文档中的任何位置。有些人将它们放在出现的段落之后，有些人则将它们放在文档的末尾（例如尾注或脚注）。</p><h2 id="Markdown-图片语法"><a href="#Markdown-图片语法" class="headerlink" title="Markdown 图片语法"></a>Markdown 图片语法</h2><p>要添加图像，请使用感叹号 (<code>!</code>), 然后在方括号增加替代文本，图片链接放在圆括号里，括号里的链接后可以增加一个可选的图片标题文本。</p><p>插入图片Markdown语法代码：<code>![图片alt](图片链接 &quot;图片title&quot;)</code>。</p><h3 id="链接图片"><a href="#链接图片" class="headerlink" title="链接图片"></a>链接图片</h3><p>给图片增加链接，请将图像的Markdown 括在方括号中，然后将链接添加在圆括号中。<br><code>[![沙漠中的岩石图片](/assets/img/shiprock.jpg &quot;Shiprock&quot;)](https://markdown.com.cn)</code></p><h2 id="Markdown-转义字符语法"><a href="#Markdown-转义字符语法" class="headerlink" title="Markdown 转义字符语法"></a>Markdown 转义字符语法</h2><p>要显示原本用于格式化 Markdown 文档的字符，请在字符前面添加反斜杠字符 \ 。</p><h3 id="可做转义的字符"><a href="#可做转义的字符" class="headerlink" title="可做转义的字符"></a>可做转义的字符</h3><p>以下列出的字符都可以通过使用反斜杠字符从而达到转义目的。</p><h3 id="特殊字符自动转义"><a href="#特殊字符自动转义" class="headerlink" title="特殊字符自动转义"></a>特殊字符自动转义</h3><p>在 HTML 文件中，有两个字符需要特殊处理： <code>&lt;</code> 和 <code>&amp;</code> 。 <code>&lt;</code> 符号用于起始标签，<code>&amp;</code> 符号则用于标记 HTML 实体，如果你只是想要使用这些符号，你必须要使用实体的形式，像是 <code>&amp;lt;</code> 和 <code>&amp;amp;</code>。</p><p><code>&amp;</code> 符号其实很容易让写作网页文件的人感到困扰，如果你要打「AT&amp;T」 ，你必须要写成「<code>AT&amp;amp;T</code>」 ，还得转换网址内的 <code>&amp;</code> 符号，如果你要链接到：</p><h2 id="Markdown-内嵌-HTML-标签"><a href="#Markdown-内嵌-HTML-标签" class="headerlink" title="Markdown 内嵌 HTML 标签"></a>Markdown 内嵌 HTML 标签</h2><p>对于 Markdown 涵盖范围之外的标签，都可以直接在文件里面用 HTML 本身。如需使用 HTML，不需要额外标注这是 HTML 或是 Markdown，只需 HTML 标签添加到 Markdown 文本中即可。</p><h3 id="行级內联标签"><a href="#行级內联标签" class="headerlink" title="行级內联标签"></a>行级內联标签</h3><p>HTML 的行级內联标签如 <code>&lt;span&gt;</code>、<code>&lt;cite&gt;</code>、<code>&lt;del&gt;</code> 不受限制，可以在 Markdown 的段落、列表或是标题里任意使用。依照个人习惯，甚至可以不用 Markdown 格式，而采用 HTML 标签来格式化。例如：如果比较喜欢 HTML 的 <code>&lt;a&gt;</code> 或 <code>&lt;img&gt;</code> 标签，可以直接使用这些标签，而不用 Markdown 提供的链接或是图片语法。当你需要更改元素的属性时（例如为文本指定颜色或更改图像的宽度），使用 HTML 标签更方便些。</p><p>HTML 行级內联标签和区块标签不同，在內联标签的范围内， Markdown 的语法是可以解析的。</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">This **word** is bold. This &lt;em&gt;word&lt;/em&gt; is italic.</span><br></pre></td></tr></table></figure><p>渲染效果如下:</p><p>This <strong>word</strong> is bold. This <em>word</em> is italic.</p><h3 id="区块标签"><a href="#区块标签" class="headerlink" title="区块标签"></a>区块标签</h3><p>区块元素──比如 <code>&lt;div&gt;</code>、<code>&lt;table&gt;</code>、<code>&lt;pre&gt;</code>、<code>&lt;p&gt;</code> 等标签，必须在前后加上空行，以便于内容区分。而且这些元素的开始与结尾标签，不可以用 tab 或是空白来缩进。Markdown 会自动识别这区块元素，避免在区块标签前后加上没有必要的 <code>&lt;p&gt;</code> 标签。</p><p>例如，在 Markdown 文件里加上一段 HTML 表格：</p><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">This <span class="literal">is</span> a regular paragraph.</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    </span><span class="language-xml"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        </span><span class="language-xml"><span class="tag">&lt;<span class="name">td</span>&gt;</span>Foo<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">This <span class="literal">is</span> another regular paragraph.</span><br></pre></td></tr></table></figure><p>请注意，Markdown 语法在 HTML 区块标签中将不会被进行处理。例如，你无法在 HTML 区块内使用 Markdown 形式的 <code>*强调*</code>。</p><h1 id="Markdown扩展语法"><a href="#Markdown扩展语法" class="headerlink" title="Markdown扩展语法"></a>Markdown扩展语法</h1><h2 id="Markdown-表格"><a href="#Markdown-表格" class="headerlink" title="Markdown 表格"></a>Markdown 表格</h2><p>要添加表，请使用三个或多个连字符（<code>---</code>）创建每列的标题，并使用管道（<code>|</code>）分隔每列。您可以选择在表的任一端添加管道。</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">| Syntax      | Description |</span><br><span class="line">| ----------- | ----------- |</span><br><span class="line">| Header      | Title       |</span><br><span class="line">| Paragraph   | Text        |</span><br></pre></td></tr></table></figure><p><strong>Tip:</strong> 使用连字符和管道创建表可能很麻烦。为了加快该过程，请尝试使用<a href="https://www.tablesgenerator.com/markdown_tables">Markdown Tables Generator</a>。使用图形界面构建表，然后将生成的Markdown格式的文本复制到文件中。</p><h3 id="对齐"><a href="#对齐" class="headerlink" title="对齐"></a>对齐</h3><p>您可以通过在标题行中的连字符的左侧，右侧或两侧添加冒号（<code>:</code>），将列中的文本对齐到左侧，右侧或中心。</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">| Syntax      | Description | Test Text     |</span><br><span class="line">| :---        |    :----:   |          ---: |</span><br><span class="line">| Header      | Title       | Here&#x27;s this   |</span><br><span class="line">| Paragraph   | Text        | And more      |</span><br></pre></td></tr></table></figure><h3 id="格式化表格中的文字"><a href="#格式化表格中的文字" class="headerlink" title="格式化表格中的文字"></a>格式化表格中的文字</h3><p>您可以在表格中设置文本格式。例如，您可以添加链接，代码（仅反引号（&#96;&#96;&#96;）中的单词或短语，而不是代码块）和强调。</p><p>您不能添加标题，块引用，列表，水平规则，图像或HTML标签。</p><h3 id="在表中转义管道字符"><a href="#在表中转义管道字符" class="headerlink" title="在表中转义管道字符"></a>在表中转义管道字符</h3><p>您可以使用表格的HTML字符代码（<code>&amp;#124;</code>）在表中显示竖线（<code>|</code>）字符。</p><h2 id="Markdown-围栏代码块"><a href="#Markdown-围栏代码块" class="headerlink" title="Markdown 围栏代码块"></a>Markdown 围栏代码块</h2><p>Markdown基本语法允许您通过将行缩进四个空格或一个制表符来创建代码块。如果发现不方便，请尝试使用受保护的代码块。根据Markdown处理器或编辑器的不同，您将在代码块之前和之后的行上使用三个反引号（(&#96;&#96;&#96;&#96;&#96;）或三个波浪号（~~~）。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;firstName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;John&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;lastName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Smith&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;age&quot;</span><span class="punctuation">:</span> <span class="number">25</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="语法高亮"><a href="#语法高亮" class="headerlink" title="语法高亮"></a>语法高亮</h3><p>许多Markdown处理器都支持受围栏代码块的语法突出显示。使用此功能，您可以为编写代码的任何语言添加颜色突出显示。要添加语法突出显示，请在受防护的代码块之前的反引号旁边指定一种语言。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;firstName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;John&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;lastName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Smith&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;age&quot;</span><span class="punctuation">:</span> <span class="number">25</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="Markdown-标题编号"><a href="#Markdown-标题编号" class="headerlink" title="Markdown 标题编号"></a>Markdown 标题编号</h2><p>许多Markdown处理器支持标题的自定义ID - 一些Markdown处理器会自动添加它们。添加自定义ID允许您直接链接到标题并使用CSS对其进行修改。要添加自定义标题ID，请在与标题相同的行上用大括号括起该自定义ID。</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">### My Great Heading &#123;#custom-id&#125;</span><br></pre></td></tr></table></figure><h3 id="链接到标题ID-headid"><a href="#链接到标题ID-headid" class="headerlink" title="链接到标题ID (#headid)"></a>链接到标题ID (#headid)</h3><p>通过创建带有数字符号（<code>#</code>）和自定义标题ID的<a href="(/basic-syntax/links.html">标准链接</a>，可以链接到文件中具有自定义ID的标题。<br>其他网站可以通过将自定义标题ID添加到网页的完整URL（例如 <code>[Heading IDs](https://markdown.com.cn/extended-syntax/heading-ids.html#headid)</code>）来链接到标题。</p><h2 id="Markdown-定义列表"><a href="#Markdown-定义列表" class="headerlink" title="Markdown 定义列表"></a>Markdown 定义列表</h2><p>一些Markdown处理器允许您创建术语及其对应定义的 <em>定义列表</em> 。要创建定义列表，请在第一行上键入术语。在下一行，键入一个冒号，后跟一个空格和定义。</p><h2 id="Markdown-删除线"><a href="#Markdown-删除线" class="headerlink" title="Markdown 删除线"></a>Markdown 删除线</h2><p>您可以通过在单词中心放置一条水平线来删除单词。结果看起来 <del>像这样</del> 。此功能使您可以指示某些单词是一个错误，要从文档中删除。若要删除单词，请在单词前后使用两个波浪号 <code>~~</code>。</p><h2 id="Markdown-任务列表语法"><a href="#Markdown-任务列表语法" class="headerlink" title="Markdown 任务列表语法"></a>Markdown 任务列表语法</h2><p>任务列表使您可以创建带有复选框的项目列表。在支持任务列表的Markdown应用程序中，复选框将显示在内容旁边。要创建任务列表，请在任务列表项之前添加破折号 <code>-</code>和方括号 <code>[ ]</code>，并在 <code>[ ]</code>前面加上空格。要选择一个复选框，请在方括号 <code>[x]</code>之间添加 x 。</p><h2 id="Markdown-使用-Emoji-表情"><a href="#Markdown-使用-Emoji-表情" class="headerlink" title="Markdown 使用 Emoji 表情"></a>Markdown 使用 Emoji 表情</h2><p>有两种方法可以将表情符号添加到Markdown文件中：将表情符号复制并粘贴到Markdown格式的文本中，或者键入 <em>emoji shortcodes</em> 。</p><h3 id="复制和粘贴表情符号"><a href="#复制和粘贴表情符号" class="headerlink" title="复制和粘贴表情符号"></a>复制和粘贴表情符号</h3><p>在大多数情况下，您可以简单地从<a href="https://emojipedia.org/">Emojipedia</a> 等来源复制表情符号并将其粘贴到文档中。许多Markdown应用程序会自动以Markdown格式的文本显示表情符号。从Markdown应用程序导出的HTML和PDF文件应显示表情符号。</p><p><strong>Tip:</strong> 如果您使用的是静态网站生成器，请确保将HTML页面编码为UTF-8。.</p><h3 id="使用表情符号简码"><a href="#使用表情符号简码" class="headerlink" title="使用表情符号简码"></a>使用表情符号简码</h3><p>一些Markdown应用程序允许您通过键入表情符号短代码来插入表情符号。这些以冒号开头和结尾，并包含表情符号的名称。</p><p><strong>Note:</strong> 注意：您可以使用此表情符号简码列表，但请记住，表情符号简码因应用程序而异。有关更多信息，请参阅Markdown应用程序的文档。</p>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
          <category> markdown </category>
          
      </categories>
      
      
        <tags>
            
            <tag> markdown </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用 Hexo+GitHub 搭建个人免费博客教程</title>
      <link href="/posts/59b4ab72/"/>
      <url>/posts/59b4ab72/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a href="https://zhuanlan.zhihu.com/p/26625249">GitHub+Hexo 搭建个人网站详细教程 - 知乎 (zhihu.com)</a></p><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>近些年来很多用户都喜欢使用 GitHub Pages 来搭建 Hexo 静态博客网站，其最吸引人的莫过于完全免费使用，并且非常稳定。</p><p>虽然搭建时比较麻烦，有点折腾，但是配置完成后，基本不需要操心维护的事，甚至放了几年都忘记了，打开来看文章依然还在。</p><p>本文就详细介绍下如何使用 Hexo + GitHub 搭建免费个人博客网站的教程。</p><p>为了照顾小白用户（第一次使用 GitHub 和 Hexo），尽可能详细，包括常见的坑和问题都有提示说明。下面目录中 <strong>第 3~5 步为最重要的步骤</strong> ，其他内容如果已经会的可以选择性跳过。</p><p>看起来有点繁杂，捋顺了倒也简单，认真跟教程走，完整操作一遍大概需要 30 分钟。</p><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><h3 id="GitHub-Pages-是什么？"><a href="#GitHub-Pages-是什么？" class="headerlink" title="# GitHub Pages 是什么？"></a><strong># GitHub Pages 是什么？</strong></h3><ul><li><a href="https://link.zhihu.com/?target=https://help.github.com/en/articles/what-is-github-pages">What is GitHub Pages? - GitHub Help</a></li></ul><p>GitHub Pages 是由 GitHub 官方提供的一种免费的静态站点托管服务，让我们可以在 GitHub 仓库里托管和发布自己的静态网站页面。</p><h3 id="Hexo-是什么？"><a href="#Hexo-是什么？" class="headerlink" title="# Hexo 是什么？"></a><strong># Hexo 是什么？</strong></h3><ul><li>官网：<a href="https://link.zhihu.com/?target=https://hexo.io/zh-cn/">hexo.io</a></li></ul><p>Hexo 是一个快速、简洁且高效的静态博客框架，它基于 Node.js 运行，可以将我们撰写的 Markdown 文档解析渲染成静态的 HTML 网页。</p><h3 id="Hexo-GitHub-文章发布原理"><a href="#Hexo-GitHub-文章发布原理" class="headerlink" title="# Hexo + GitHub 文章发布原理"></a><strong># Hexo + GitHub 文章发布原理</strong></h3><p>在本地撰写 Markdown 格式文章后，通过 Hexo 解析文档，渲染生成具有主题样式的 HTML 静态网页，再推送到 GitHub 上完成博文的发布。</p><p><img src="https://pic3.zhimg.com/80/v2-a193a47cf70fe6ecf156e5f3d34920ea_720w.jpg"></p><h3 id="优点和不足"><a href="#优点和不足" class="headerlink" title="# 优点和不足"></a><strong># 优点和不足</strong></h3><p> <strong>优点：</strong> 完全免费；静态站点，轻量快速；可按需求自由定制改造；托管在 GitHub，安全省心；迁移方便……</p><p> <strong>不足：</strong> 发文不便，依赖于本地环境；更适合个人博客使用；GitHub 在国内访问速度有点不快。</p><h2 id="1-准备"><a href="#1-准备" class="headerlink" title="1. 准备"></a>1. 准备</h2><h3 id="注意事项"><a href="#注意事项" class="headerlink" title="# 注意事项"></a><strong># 注意事项</strong></h3><ul><li>输入代码时，核对准确，最好切换成英文输入法；</li><li>将文中的 “用户名” 和 “邮箱” 替换为自己的 GitHub 账户名和绑定的邮箱；</li><li>统一使用 Git Bash 进行操作（支持 Win、Mac）；</li><li>小白请严格按步骤进行，不要跳！</li></ul><h3 id="环境搭建"><a href="#环境搭建" class="headerlink" title="# 环境搭建"></a><strong># 环境搭建</strong></h3><p>Hexo 基于 Node.js，搭建过程中还需要使用 npm（Node.js 已带） 和 git，因此先搭建本地操作环境，安装 Node.js 和 Git。</p><ul><li>Node.js：<a href="https://link.zhihu.com/?target=https://nodejs.org/zh-cn">https:&#x2F;&#x2F;<strong>nodejs.org&#x2F;zh-cn</strong></a></li><li>Git：<a href="https://link.zhihu.com/?target=https://git-scm.com/downloads">https:&#x2F;&#x2F;<strong>git-scm.com&#x2F;downloads</strong></a></li></ul><p>下载 Node.js 和 Git 程序并安装，一路点 “下一步” 按默认配置完成安装。</p><p>安装完成后，Win+R 输入 cmd 并打开，依次输入 <code>node -v</code>、<code>npm -v</code> 和 <code>git --version</code> 并回车，如下图出现程序版本号即可。</p><p><img src="https://pic1.zhimg.com/80/v2-27b47b5ae479ce7987851292a67774b0_720w.jpg"></p><h2 id="2-连接-Github"><a href="#2-连接-Github" class="headerlink" title="2. 连接 Github"></a>2. 连接 Github</h2><p>使用邮箱注册 <a href="https://link.zhihu.com/?target=https://github.com/">GitHub</a> 账户，选择免费账户（Free），并完成邮件验证。</p><p>右键 -&gt; Git Bash Here， <strong>设置用户名和邮箱</strong> ：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name &quot;GitHub 用户名&quot;</span><br><span class="line">git config --global user.email &quot;GitHub 邮箱&quot;</span><br></pre></td></tr></table></figure><p> <strong>创建 SSH 密匙</strong> ：</p><p>输入 <code>ssh-keygen -t rsa -C &quot;GitHub 邮箱&quot;</code>，然后一路回车。</p><p><strong>添加密匙：</strong></p><p>进入 [C:\Users\用户名.ssh] 目录（要勾选显示“隐藏的项目”），用记事本打开公钥 id_rsa.pub 文件并复制里面的内容。</p><p>登陆 GitHub ，进入 Settings 页面，选择左边栏的 SSH and GPG keys，点击 New SSH key。</p><p>Title 随便取个名字，粘贴复制的 id_rsa.pub 内容到 Key 中，点击 Add SSH key 完成添加。</p><p><img src="https://pic1.zhimg.com/80/v2-9125065afd24332d7cd84feb6a350730_720w.jpg"></p><p><strong>验证连接：</strong></p><p>打开 Git Bash，输入 <code>ssh -T git@github.com</code> 出现 “Are you sure……”，输入 yes 回车确认。</p><p><img src="https://pic3.zhimg.com/80/v2-b4c7524a2451f4ab42f9c22ea3c7b6be_720w.jpg"></p><p>显示 “Hi xxx! You’ve successfully……” 即连接成功。</p><h2 id="3-创建-Github-Pages-仓库"><a href="#3-创建-Github-Pages-仓库" class="headerlink" title="3. 创建 Github Pages 仓库"></a>3. 创建 Github Pages 仓库</h2><p>GitHub 主页右上角加号 -&gt; New repository：</p><ul><li>Repository name 中输入 <code>用户名.github.io</code></li><li>勾选 “Initialize this repository with a README”</li><li>Description 选填</li></ul><p>填好后点击 Create repository 创建。</p><p><img src="https://pic2.zhimg.com/80/v2-67a8165154f4c5f4a6333e76e78ed815_720w.jpg"></p><p>创建后默认自动启用 HTTPS，博客地址为：<code>https://用户名.github.io</code></p><h2 id="4-本地安装-Hexo-博客程序"><a href="#4-本地安装-Hexo-博客程序" class="headerlink" title="4. 本地安装 Hexo 博客程序"></a>4. 本地安装 Hexo 博客程序</h2><p>新建一个文件夹用来存放 Hexo 的程序文件，如 Hexo-Blog。打开该文件夹，右键 -&gt; Git Bash Here。</p><h3 id="4-1-安装-Hexo"><a href="#4-1-安装-Hexo" class="headerlink" title="# 4.1 安装 Hexo"></a><strong># 4.1 安装 Hexo</strong></h3><p>使用 npm 一键安装 Hexo 博客程序：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure><p>Mac 用户需要管理员权限（sudo），运行这条命令：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo npm install -g hexo-cli</span><br></pre></td></tr></table></figure><p>安装时间有点久（真的很慢！），界面也没任何反应， <strong>耐心等待</strong> ，安装完成后如下图。</p><p><img src="https://pic2.zhimg.com/80/v2-01e7fc8bb9280437deb437bf73a190a1_720w.jpg"></p><h3 id="4-2-Hexo-初始化和本地预览"><a href="#4-2-Hexo-初始化和本地预览" class="headerlink" title="# 4.2 Hexo 初始化和本地预览"></a><strong># 4.2 Hexo 初始化和本地预览</strong></h3><p><strong>初始化并安装所需组件：</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo init      # 初始化</span><br><span class="line">npm install    # 安装组件</span><br></pre></td></tr></table></figure><p>完成后依次输入下面命令， <strong>启动本地服务器进行预览</strong> ：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo g   # 生成页面</span><br><span class="line">hexo s   # 启动预览</span><br></pre></td></tr></table></figure><p>**访问 **<code>http://localhost:4000</code><strong>，出现 Hexo 默认页面，本地博客安装成功！</strong></p><p><img src="https://pic4.zhimg.com/80/v2-1c3baeecf1ef3bec5c8ef3f14639f68b_720w.jpg"></p><p> <strong>Tips：</strong> 如果出现页面加载不出来，可能是端口被占用了。Ctrl+C 关闭服务器，运行 <code>hexo server -p 5000</code> 更改端口号后重试。</p><p>Hexo 博客文件夹目录结构如下：</p><p><img src="https://pic1.zhimg.com/80/v2-264c75c0e493ae8cc5f283567c64ff2c_720w.jpg"></p><h2 id="5-部署-Hexo-到-GitHub-Pages"><a href="#5-部署-Hexo-到-GitHub-Pages" class="headerlink" title="5. 部署 Hexo 到 GitHub Pages"></a>5. 部署 Hexo 到 GitHub Pages</h2><p>本地博客测试成功后，就是上传到 GitHub 进行部署，使其能够在网络上访问。</p><p>首先 <strong>安装 hexo-deployer-git</strong> ：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><p>然后<strong>修改 _config.yml</strong> 文件末尾的 Deployment 部分，修改成如下：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repository: git@github.com:用户名/用户名.github.io.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure><p>完成后运行 <code>hexo d</code> 将网站上传部署到 GitHub Pages。</p><p>完成！这时访问我们的 GitHub 域名 <code>https://用户名.github.io</code> 就可以看到 Hexo 网站了。</p><h2 id="6-绑定域名（可选）"><a href="#6-绑定域名（可选）" class="headerlink" title="6. 绑定域名（可选）"></a>6. 绑定域名（可选）</h2><p>博客搭建完成使用的是 GitHub 的子域名（用户名.<a href="https://link.zhihu.com/?target=http://github.io">http:&#x2F;&#x2F;<strong>github.io</strong></a>），我们可以为 Hexo 博客绑定自己的域名替换 GitHub 域名，更加个性化和专业，也利于 SEO。</p><p>我们使用 <a href="https://link.zhihu.com/?target=https://www.namesilo.com/?rid=d27fa32do">Namesilo</a> 进行注册，便宜好用没啥套路，使用优惠码 <code>okoff</code> 优惠一美元，com 域名大概 50 块一年。</p><h3 id="6-1-域名注册和解析"><a href="#6-1-域名注册和解析" class="headerlink" title="# 6.1 域名注册和解析"></a><strong># 6.1 域名注册和解析</strong></h3><ul><li>域名注册和解析教程：<a href="https://zhuanlan.zhihu.com/p/33921436">Namesilo 域名购买及使用教程</a></li></ul><p>按上面教程注册并解析域名，在 DNS 设置部分，删除自带的记录，然后添加 CNAME 记录将 www 域名解析指向 <code>用户名.github.io</code>。</p><p><img src="https://pic3.zhimg.com/80/v2-d5d37c8ad523d8ab5c7c200fabc9585e_720w.jpg"></p><h3 id="6-2-绑定域名到-Hexo-博客"><a href="#6-2-绑定域名到-Hexo-博客" class="headerlink" title="# 6.2 绑定域名到 Hexo 博客"></a><strong># 6.2 绑定域名到 Hexo 博客</strong></h3><p>进入本地博客文件夹的 source 目录，打开记事本，里面输入自己的域名，如 <a href="http://www.example.com,保存名称为/">http://www.example.com，保存名称为</a> “CNAME”，格式为 “所有文件”（无 .txt 后缀）。</p><p>清除缓存等文件并重新发布网站：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo clean   # 清除缓存文件等</span><br><span class="line">hexo g       # 生成页面</span><br><span class="line">hexo s       # 启动预览</span><br></pre></td></tr></table></figure><p>现在就可以使用自己的域名访问 Hexo 博客了。</p><h3 id="6-3-开启-HTTPS"><a href="#6-3-开启-HTTPS" class="headerlink" title="# 6.3 开启 HTTPS"></a><strong># 6.3 开启 HTTPS</strong></h3><p>配置自己的域名后，需要我们手动开启 HTTPS。打开博客所在 GitHub 仓库，Settings -&gt; 下拉找到 GitHub Pages -&gt; 勾选 Enforce HTTPS。</p><p><img src="https://pic4.zhimg.com/80/v2-54f8744afc9746884e6b3acecfc5f8cf_720w.jpg"></p><p>HTTPS 证书部署成功需要一定时间，等大概几分钟再访问域名，就可以看到域名前面的小绿锁了，HTTPS 配置完成！</p><h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>Hexo 是一种纯静态的博客，我们必须要在本地完成文章的编辑再部署到 GitHub 上，依赖于本地环境。不能像 WordPress 或 Typecho 那样的动态博客一样能直接在浏览器中完成撰文和发布。</p>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 创建个人网站（基于GitHub + hexo） </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>前后端开发项目</title>
      <link href="/posts/be66a0ad/"/>
      <url>/posts/be66a0ad/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="JavaWeb项目"><a href="#JavaWeb项目" class="headerlink" title="JavaWeb项目"></a>JavaWeb项目</h1><h2 id="学之思在线考试系统"><a href="#学之思在线考试系统" class="headerlink" title="学之思在线考试系统"></a>学之思在线考试系统</h2><p>这个项目是是一款 Spring 技术栈 + Vue.js 的前后端分离的考试系统，分为学生端、用户端、小程序端，能覆盖到 PC 和移动端。。界面美观、设计友好、代码结构清晰，即使是应届生找工作，这个项目也是不错的练手手项目。</p><p>并且支持多种部署方式：集成部署、前后端分离部署、docker部署。</p><p>地址：<a href="https://github.com/mindskip/xzs">github.com&#x2F;mindskip&#x2F;xzs</a></p><h2 id="外卖系统"><a href="#外卖系统" class="headerlink" title="外卖系统"></a><strong>外卖系统</strong></h2><p>一个完整的外卖系统，包括手机端，后台管理。基于 Spring Boot 和 Vue 的前后端分离的外卖系统，包含完整的手机端，后台管理功能。</p><p>地址：<a href="gitee.com/microapp/flash-waimai">gitee.com&#x2F;microapp&#x2F;flash-waimai</a></p><h1 id="移动端项目"><a href="#移动端项目" class="headerlink" title="移动端项目"></a>移动端项目</h1><h2 id="仿美团外卖点餐"><a href="#仿美团外卖点餐" class="headerlink" title="仿美团外卖点餐"></a>仿美团外卖点餐</h2><p>前端用 vue+vuex+vue-router+axios，后端基于nodej.s的框架，数据库采用mongodb。功能涉及登录，定位，浏览商品，加购物车，下订单，支付(微信、支付宝扫码支付)，评价，个人信息更改。</p><p>项目地址：<a href="https://github.com/zwStar/vue-meituan">github.com&#x2F;zwStar&#x2F;vue-meituangithub.com&#x2F;zwStar&#x2F;vue-meituan</a></p><h2 id="精仿今日头条"><a href="#精仿今日头条" class="headerlink" title="精仿今日头条"></a>精仿今日头条</h2><p>数据是抓取今日头条App的数据。使用 RxJava + Retrofit + MVP 开发的开源项目。</p><p>项目地址：<a href="https://github.com/chaychan/TouTiao">github.com&#x2F;chaychan&#x2F;TouTiao</a></p><h2 id="iOS-仿抖音"><a href="#iOS-仿抖音" class="headerlink" title="iOS 仿抖音"></a>iOS 仿抖音</h2><p>这个抖音 Demo 适配 iPhone、iPad，同时兼容 iOS 8.0 - iOS 12.0系统。采用 Object-C 语言编写。标星 1.5K Star，项目地址：</p><p><a href="https://github.com/sshiqiao/douyin-ios-objectc">github.com&#x2F;sshiqiao&#x2F;douyin-ios-objectc</a></p><p>本项目共分为三个部分：抖音个人主页实现、网络视频相关功能实现、WebSocket 实现 IM 即时聊天功能。</p><h2 id="Android-仿抖音"><a href="#Android-仿抖音" class="headerlink" title="Android 仿抖音"></a>Android 仿抖音</h2><p>这个 Demo 涉及的技术要点如下：</p><p>Recycler + PagerSnapHelper 实现全屏切换播放效果，<br>使用 Lottie 库加载 Json 动画<br>BottomSheetDialogFragment 实现分享评论弹框功能<br>CoordinatorLayout + AppBarLayout 实现折叠布局。<br>该项目标星 1K Star，项目地址：<a href="https://github.com/running-libo/Tiktok">github.com&#x2F;running-libo&#x2F;Tiktok</a></p><h2 id="秀视频"><a href="#秀视频" class="headerlink" title="秀视频"></a>秀视频</h2><p>这个项目是一个短视频社交小程序，系统包括用户端和后台管理端。用户可以在小程序上发布自己的短视频，并且经过我们的平台加入滤镜或者背景音乐制作出独具特色的短视频。具备点赞、评论、下载、分享、转发等功能。技术栈如下：</p><p>前端: H5、CSS、JavaScript 、JQuery、Bootstrap、Themeleaf</p><p>后端：Spring Cloud、Spring Boot、Sping、Spring MVC、MyBatis、MySQL、Redis、Shiro</p><p>组件：Bootsrap-table、webUploader、PageHelper</p><p>项目地址：<a href="https://github.com/RAOE/show-videos">github.com&#x2F;RAOE&#x2F;show-videos</a></p><h2 id="斗鱼直播-APP"><a href="#斗鱼直播-APP" class="headerlink" title="斗鱼直播 APP"></a>斗鱼直播 APP</h2><p>flutter 重构的斗鱼直播 APP，首页、娱乐为Material组件；直播间、鱼吧为纯自定义编写。</p><p>地址：<a href="https://github.com/yukilzw/dy_flutter">github.com&#x2F;yukilzw&#x2F;dy_flutter</a></p><h2 id="仿网易云音乐"><a href="#仿网易云音乐" class="headerlink" title="仿网易云音乐"></a>仿网易云音乐</h2><p>基于 flutter 的仿网易云音乐软件，支持 iOS 和 Android。</p><p>地址：<a href="https://github.com/boyan01/flutter-netease-music">github.com&#x2F;boyan01&#x2F;flutter-netease-music</a></p><h2 id="高仿-B站"><a href="#高仿-B站" class="headerlink" title="高仿 B站"></a>高仿 B站</h2><p>基于 react + express 高仿B站 Web 移动端</p><p>链接：<a href="https://github.com/dxx/react-bilibili">github.com&#x2F;dxx&#x2F;react-bilibili</a></p>]]></content>
      
      
      <categories>
          
          <category> 项目开发 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>前端开发项目</title>
      <link href="/posts/25989421/"/>
      <url>/posts/25989421/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script>]]></content>
      
      
      <categories>
          
          <category> 项目开发 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>语法——SVG教程</title>
      <link href="/posts/fcfcda7a/"/>
      <url>/posts/fcfcda7a/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> 语法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SVG </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>语法——Typescript</title>
      <link href="/posts/9306a7a4/"/>
      <url>/posts/9306a7a4/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="为什么要使用-TypeScript-TypeScript-相对于-JavaScript-的优势是什么？"><a href="#为什么要使用-TypeScript-TypeScript-相对于-JavaScript-的优势是什么？" class="headerlink" title="为什么要使用 TypeScript ? TypeScript 相对于 JavaScript 的优势是什么？"></a>为什么要使用 TypeScript ? TypeScript 相对于 JavaScript 的优势是什么？</h2><h2 id="TypeScript-中-const-和-readonly-的区别？枚举和常量枚举的区别？接口和类型别名的区别？"><a href="#TypeScript-中-const-和-readonly-的区别？枚举和常量枚举的区别？接口和类型别名的区别？" class="headerlink" title="TypeScript 中 const 和 readonly 的区别？枚举和常量枚举的区别？接口和类型别名的区别？"></a>TypeScript 中 const 和 readonly 的区别？枚举和常量枚举的区别？接口和类型别名的区别？</h2><h2 id="TypeScript-中-any-类型的作用是什么？"><a href="#TypeScript-中-any-类型的作用是什么？" class="headerlink" title="TypeScript 中 any 类型的作用是什么？"></a>TypeScript 中 any 类型的作用是什么？</h2><h2 id="TypeScript-中-any、never、unknown-和-void-有什么区别？"><a href="#TypeScript-中-any、never、unknown-和-void-有什么区别？" class="headerlink" title="TypeScript 中 any、never、unknown 和 void 有什么区别？"></a>TypeScript 中 any、never、unknown 和 void 有什么区别？</h2><h2 id="TypeScript-中-interface-可以给-Function-x2F-Array-x2F-Class（Indexable）做声明吗？"><a href="#TypeScript-中-interface-可以给-Function-x2F-Array-x2F-Class（Indexable）做声明吗？" class="headerlink" title="TypeScript 中 interface 可以给 Function &#x2F; Array &#x2F; Class（Indexable）做声明吗？"></a>TypeScript 中 interface 可以给 Function &#x2F; Array &#x2F; Class（Indexable）做声明吗？</h2><h2 id="TypeScript-中可以使用-String、Number、Boolean、Symbol、Object-等给类型做声明吗？"><a href="#TypeScript-中可以使用-String、Number、Boolean、Symbol、Object-等给类型做声明吗？" class="headerlink" title="TypeScript 中可以使用 String、Number、Boolean、Symbol、Object 等给类型做声明吗？"></a>TypeScript 中可以使用 String、Number、Boolean、Symbol、Object 等给类型做声明吗？</h2><h2 id="TypeScript-中的-this-和-JavaScript-中的-this-有什么差异？"><a href="#TypeScript-中的-this-和-JavaScript-中的-this-有什么差异？" class="headerlink" title="TypeScript 中的 this 和 JavaScript 中的 this 有什么差异？"></a>TypeScript 中的 this 和 JavaScript 中的 this 有什么差异？</h2><h2 id="TypeScript-中使用-Unions-时有哪些注意事项？"><a href="#TypeScript-中使用-Unions-时有哪些注意事项？" class="headerlink" title="TypeScript 中使用 Unions 时有哪些注意事项？"></a>TypeScript 中使用 Unions 时有哪些注意事项？</h2><h2 id="TypeScript-如何设计-Class-的声明？"><a href="#TypeScript-如何设计-Class-的声明？" class="headerlink" title="TypeScript 如何设计 Class 的声明？"></a>TypeScript 如何设计 Class 的声明？</h2><h2 id="TypeScript-中如何联合枚举类型的-Key"><a href="#TypeScript-中如何联合枚举类型的-Key" class="headerlink" title="TypeScript 中如何联合枚举类型的 Key?"></a>TypeScript 中如何联合枚举类型的 Key?</h2><h2 id="TypeScript-中-、-、-、-、-等符号的含义？"><a href="#TypeScript-中-、-、-、-、-等符号的含义？" class="headerlink" title="TypeScript 中 ?.、??、!.、_、** 等符号的含义？"></a>TypeScript 中 ?.、??、!.、_、** 等符号的含义？</h2><h2 id="TypeScript-中预定义的有条件类型有哪些？"><a href="#TypeScript-中预定义的有条件类型有哪些？" class="headerlink" title="TypeScript 中预定义的有条件类型有哪些？"></a>TypeScript 中预定义的有条件类型有哪些？</h2><h2 id="简单介绍一下-TypeScript-模块的加载机制？"><a href="#简单介绍一下-TypeScript-模块的加载机制？" class="headerlink" title="简单介绍一下 TypeScript 模块的加载机制？"></a>简单介绍一下 TypeScript 模块的加载机制？</h2><h2 id="简单聊聊你对-TypeScript-类型兼容性的理解？抗变、双变、协变和逆变的简单理解？"><a href="#简单聊聊你对-TypeScript-类型兼容性的理解？抗变、双变、协变和逆变的简单理解？" class="headerlink" title="简单聊聊你对 TypeScript 类型兼容性的理解？抗变、双变、协变和逆变的简单理解？"></a>简单聊聊你对 TypeScript 类型兼容性的理解？抗变、双变、协变和逆变的简单理解？</h2><h2 id="TypeScript-中对象展开会有什么副作用吗？"><a href="#TypeScript-中对象展开会有什么副作用吗？" class="headerlink" title="TypeScript 中对象展开会有什么副作用吗？"></a>TypeScript 中对象展开会有什么副作用吗？</h2><h2 id="TypeScript-中-interface、type、enum-声明有作用域的功能吗？"><a href="#TypeScript-中-interface、type、enum-声明有作用域的功能吗？" class="headerlink" title="TypeScript 中 interface、type、enum 声明有作用域的功能吗？"></a>TypeScript 中 interface、type、enum 声明有作用域的功能吗？</h2><h2 id="TypeScript-中同名的-interface-或者同名的-interface-和-class-可以合并吗？"><a href="#TypeScript-中同名的-interface-或者同名的-interface-和-class-可以合并吗？" class="headerlink" title="TypeScript 中同名的 interface 或者同名的 interface 和 class 可以合并吗？"></a>TypeScript 中同名的 interface 或者同名的 interface 和 class 可以合并吗？</h2><h2 id="如何使-TypeScript-项目引入并识别编译为-JavaScript-的-npm-库包？"><a href="#如何使-TypeScript-项目引入并识别编译为-JavaScript-的-npm-库包？" class="headerlink" title="如何使 TypeScript 项目引入并识别编译为 JavaScript 的 npm 库包？"></a>如何使 TypeScript 项目引入并识别编译为 JavaScript 的 npm 库包？</h2><h2 id="TypeScript-的-tsconfig-json-中有哪些配置项信息？"><a href="#TypeScript-的-tsconfig-json-中有哪些配置项信息？" class="headerlink" title="TypeScript 的 tsconfig.json 中有哪些配置项信息？"></a>TypeScript 的 tsconfig.json 中有哪些配置项信息？</h2><h2 id="TypeScript-中如何设置模块导入的路径别名？"><a href="#TypeScript-中如何设置模块导入的路径别名？" class="headerlink" title="TypeScript 中如何设置模块导入的路径别名？"></a>TypeScript 中如何设置模块导入的路径别名？</h2>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> Typescript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Typescript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>编程范式</title>
      <link href="/posts/98a12616/"/>
      <url>/posts/98a12616/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="编程范式"><a href="#编程范式" class="headerlink" title="编程范式"></a>编程范式</h1><h2 id="列举你所了解的编程范式？"><a href="#列举你所了解的编程范式？" class="headerlink" title="列举你所了解的编程范式？"></a>列举你所了解的编程范式？</h2><p>编程范式（Programming paradigm）是指计算机编程的基本风格或者典型模式，可以简单理解为编程学科中实践出来的具有哲学和理论依据的一些经典原型。常见的编程范式有：</p><ul><li>面向过程（Process Oriented Programming，POP）</li><li>面向对象（Object Oriented Programming，OOP）</li><li>面向接口（Interface Oriented Programming， IOP）</li><li>面向切面（Aspect Oriented Programming，AOP）</li><li>函数式（Funtional Programming，FP）</li><li>响应式（Reactive Programming，RP）</li><li>函数响应式（Functional Reactive Programming，FRP）</li></ul><blockquote><p>阅读链接：：如果你对于编程范式的定义相对模糊，可以继续阅读 <a href="https://link.juejin.cn/?target=https://softwareengineering.stackexchange.com/questions/166442/what-is-the-precise-definition-of-programming-paradigm%23" title="https://softwareengineering.stackexchange.com/questions/166442/what-is-the-precise-definition-of-programming-paradigm#">What is the precise definition of programming paradigm?</a> 了解更多。</p></blockquote><p>不同的语言可以支持多种不同的编程范式，例如 C 语言支持 POP 范式，C++ 和 Java 语言支持 OOP 范式，Swift 语言则可以支持 FP 范式，而 Web 前端中的 JavaScript 可以支持上述列出的所有编程范式。</p>]]></content>
      
      
      <categories>
          
          <category> 计算机基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 编程范式 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>编译原理</title>
      <link href="/posts/118b8ca3/"/>
      <url>/posts/118b8ca3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script>]]></content>
      
      
      <categories>
          
          <category> 计算机基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 编译原理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>语法——网络/浏览器</title>
      <link href="/posts/d93c9f24/"/>
      <url>/posts/d93c9f24/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="网络-x2F-浏览器"><a href="#网络-x2F-浏览器" class="headerlink" title="网络&#x2F;浏览器"></a>网络&#x2F;浏览器</h1><h2 id="说说浏览器渲染流程"><a href="#说说浏览器渲染流程" class="headerlink" title="说说浏览器渲染流程"></a>说说浏览器渲染流程</h2><h3 id="浏览器的主进程：Browser进程"><a href="#浏览器的主进程：Browser进程" class="headerlink" title="浏览器的主进程：Browser进程"></a>浏览器的主进程：Browser进程</h3><ol><li>负责下载资源</li><li>创建销毁renderer进程</li><li>负责将renderer进程生成的位图渲染到页面上</li><li>与用户交互</li></ol><h3 id="浏览器内核：renderer进程"><a href="#浏览器内核：renderer进程" class="headerlink" title="浏览器内核：renderer进程"></a>浏览器内核：renderer进程</h3><h5 id="js引擎线程"><a href="#js引擎线程" class="headerlink" title="js引擎线程"></a>js引擎线程</h5><p>由一个主线程和多个web worder线程组成，web worker线程不能操作dom</p><h5 id="GUI线程"><a href="#GUI线程" class="headerlink" title="GUI线程"></a>GUI线程</h5><p>用于解析html生成DOM树，解析css生成CSSOM,布局layout、绘制paint。回流和重绘依赖该线程</p><h5 id="事件线程"><a href="#事件线程" class="headerlink" title="事件线程"></a>事件线程</h5><p>当事件触发时，该线程将事件的回调函数放入callback queue（任务队列）中，等待js引擎线程处理</p><h5 id="定时触发线程"><a href="#定时触发线程" class="headerlink" title="定时触发线程"></a>定时触发线程</h5><p>setTimeout和setInterval由该线程来记时，记时结束，将回调函数放入任务队列</p><h5 id="http请求线程"><a href="#http请求线程" class="headerlink" title="http请求线程"></a>http请求线程</h5><p>每有一个http请求就开一个该线程，每当检测到状态变更就会产生一个状态变更事件，如果这个事件由对应的回掉函数，将这个函数放入任务队列</p><h5 id="任务队列轮询线程"><a href="#任务队列轮询线程" class="headerlink" title="任务队列轮询线程"></a>任务队列轮询线程</h5><p>用于轮询监听任务队列</p><h3 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h3><ol><li>获取html文件</li><li>从上到下解析html</li><li>并行请求资源(css资源不会阻塞html解析，但是会阻塞页面渲染。js资源会组织html解析）</li><li>生成DOM tree 和 style rules</li><li>构建render tree</li><li>执行布局过程(layout、也叫回流)，确定元素在屏幕上的具体坐标</li><li>绘制到屏幕上(paint)</li></ol><h3 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h3><h5 id="DOMContentLoaded"><a href="#DOMContentLoaded" class="headerlink" title="DOMContentLoaded"></a>DOMContentLoaded</h5><p>当初始的HTML文档被完全加载和解析完成(script脚本执行完，所属的script脚本之前的样式表加载解析完成)之后，DOMContentLoaded事件被触发</p><h5 id="onload"><a href="#onload" class="headerlink" title="onload"></a>onload</h5><p>所有资源加载完成触发window的onload事件</p><h5 id="参考流程图：www-processon-com-view-5a6861…"><a href="#参考流程图：www-processon-com-view-5a6861…" class="headerlink" title="参考流程图：www.processon.com/view/5a6861…"></a>参考流程图：<a href="https://link.juejin.cn/?target=https://www.processon.com/view/5a68611fe4b010a6e72f0d6f" title="https://www.processon.com/view/5a68611fe4b010a6e72f0d6f">www.processon.com/view/5a6861…</a></h5><h2 id="说说http2-0"><a href="#说说http2-0" class="headerlink" title="说说http2.0"></a>说说http2.0</h2><p>http2.0是对SPDY协议的一个升级版。和http1.0相比主要有以下特性：</p><ul><li>二进制分帧</li><li>首部压缩</li><li>多路复用</li><li>请求优先级</li><li>服务端推送(server push)</li></ul><p>详细可参考： <a href="https://juejin.cn/post/6844903545532071943" title="https://juejin.cn/post/6844903545532071943">HTTP—-HTTP2.0新特性</a></p><h2 id="如何处理浏览器中表单项的密码自动填充问题"><a href="#如何处理浏览器中表单项的密码自动填充问题" class="headerlink" title="如何处理浏览器中表单项的密码自动填充问题"></a>如何处理浏览器中表单项的密码自动填充问题</h2>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> 语法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 网络/浏览器 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>性能优化</title>
      <link href="/posts/fc854d4d/"/>
      <url>/posts/fc854d4d/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a href="https://juejin.cn/post/7108522191758557215">Javascript 代码性能优化31条</a></p><h2 id="性能优化之脚本预加载"><a href="#性能优化之脚本预加载" class="headerlink" title="性能优化之脚本预加载"></a>性能优化之脚本预加载</h2><p>每个 <code>&lt;script&gt;</code> 标签初始加载时都会阻塞页面渲染，减少页面包含的 <code>&lt;script&gt; </code>标签数量，有助于提高页面的渲染速度。</p><p>同时，不仅是针对外链脚本，内嵌脚本的数量同样也要限制。</p><p>浏览器在解析HTML页面的过程中每遇到一个 <code>script</code> 标签，都会因执行脚本而导致一定的延时，因此最小化延迟时间将会明显改善页面的总体性能。</p><h3 id="1-直接减少JS脚本文件大小并限制HTTP请求数"><a href="#1-直接减少JS脚本文件大小并限制HTTP请求数" class="headerlink" title="1. 直接减少JS脚本文件大小并限制HTTP请求数"></a>1. 直接减少JS脚本文件大小并限制HTTP请求数</h3><h3 id="2-设置dns-prefetch属性"><a href="#2-设置dns-prefetch属性" class="headerlink" title="2. 设置dns-prefetch属性"></a>2. 设置dns-prefetch属性</h3><p>域名转化为ip是一个比较耗时的过程，dns-prefetch能让浏览器空闲的时候帮你做这件事。尤其大型网站会使用多域名，这时候更加需要dns预取。</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//来自百度首页</span><br><span class="line">&lt;link rel<span class="operator">=</span><span class="string">&quot;dns-prefetch&quot;</span> href<span class="operator">=</span><span class="string">&quot;//www.baidu.com&quot;</span>&gt;</span><br></pre></td></tr></table></figure><h3 id="3-设置prefetch属性"><a href="#3-设置prefetch属性" class="headerlink" title="3. 设置prefetch属性"></a>3. 设置prefetch属性</h3><p>prefetch一般用来预加载可能使用的资源，一般是对用户行为的一种判断，浏览器会在空闲的时候加载prefetch的资源。</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;link <span class="attribute">rel</span>=<span class="string">&quot;prefetch&quot;</span> <span class="attribute">href</span>=<span class="string">&quot;http://www.example.com/&quot;</span>&gt;</span><br></pre></td></tr></table></figure><h3 id="3-设置preload属性"><a href="#3-设置preload属性" class="headerlink" title="3. 设置preload属性"></a>3. 设置preload属性</h3><p>和prefetch不同，prefecth通常是加载接下来可能用到的页面资源，而preload是加载当前页面要用的脚本、样式、字体、图片等资源。所以preload不是空闲时加载，它的优先级更强，并且会占用http请求数量。</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;link <span class="attribute">rel</span>=<span class="string">&#x27;preload&#x27;</span> <span class="attribute">href</span>=<span class="string">&#x27;style.css&#x27;</span> <span class="attribute">as</span>=<span class="string">&quot;style&quot;</span> <span class="attribute">onload</span>=<span class="string">&quot;console.log(&#x27;style loaded&#x27;)&quot;</span></span><br></pre></td></tr></table></figure><p>as值包括</p><ul><li>“script”</li><li>“style”</li><li>“image”</li><li>“media”</li><li>“document”<br>onload方法是资源加载完成的回调函数</li></ul><h3 id="4-延迟脚本——属性defer-x2F-async"><a href="#4-延迟脚本——属性defer-x2F-async" class="headerlink" title="4. 延迟脚本——属性defer&#x2F;async"></a>4. 延迟脚本——属性defer&#x2F;async</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//defer-Html4引入</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">defer</span> <span class="attr">src</span>=<span class="string">&quot;script.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">//async-Html5引入</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">async</span> <span class="attr">src</span>=<span class="string">&quot;script.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>defer和async</p><p>相同点：异步(并行)加载资源</p><p>不同点：</p><ul><li>async——<strong>异步加载</strong>脚本文件，加载完立即执行（如果文件未完成解析，会造成阻塞）</li><li>defer——脚本文件加载和文档解析<strong>同步</strong>进行，但是需要<strong>等待文档解析完成</strong>再<strong>执行脚本文件</strong>。</li></ul><p>因为async加载的资源是加载完执行，所以它比不能保证顺序，而defer会按顺序执行脚本。</p><h3 id="动态创建DOM标签"><a href="#动态创建DOM标签" class="headerlink" title="动态创建DOM标签"></a>动态创建DOM标签</h3><p>以动态创建DOM标签的方式，对文档的加载事件进行监听，当文档加载完成后再动态的创建script标签来引入JS脚本文件。</p><h2 id="React性能优化"><a href="#React性能优化" class="headerlink" title="React性能优化"></a>React性能优化</h2><h3 id="shouldComponentUpdate"><a href="#shouldComponentUpdate" class="headerlink" title="shouldComponentUpdate"></a>shouldComponentUpdate</h3><p>举例：下面是antd-design-mobile的Modal组件中对的内部蒙层组件的处理</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> lazyRenderProps &#123;</span><br><span class="line">  <span class="attr">style</span>: &#123;&#125;;</span><br><span class="line">  visible?: <span class="built_in">boolean</span>;</span><br><span class="line">  className?: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">LazyRender</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span>&lt;lazyRenderProps, <span class="built_in">any</span>&gt; &#123;</span><br><span class="line">  <span class="title function_">shouldComponentUpdate</span>(<span class="params">nextProps: lazyRenderProps</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> !!nextProps.<span class="property">visible</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">props</span>: <span class="built_in">any</span> = &#123; ...<span class="variable language_">this</span>.<span class="property">props</span> &#125;;</span><br><span class="line">    <span class="keyword">delete</span> props.<span class="property">visible</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> &#123;<span class="attr">...props</span>&#125; /&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="immutable"><a href="#immutable" class="headerlink" title="immutable"></a>immutable</h3><p>像上面这种只比较了一个visible属性，并且它是string类型，如果是一个object类型那么就不能直接比较了，这时候使用immutable库更好一些。</p><p>immutable优势：</p><ul><li>性能更好</li><li>更加安全<br>immutable劣势：</li><li>库比较大(压缩后大约16k)</li><li>api和js不兼容</li></ul><p>解决方案：seamless-immutable<br>seamless-immutable这个库没有完整实现Persistent Data Structure，而是使用了Object.defineProperty扩展了JS的Object和Array对象，所以保持了相同的Api，同时库的代码量更少，压缩后大约2k</p><h3 id="基于key的优化"><a href="#基于key的优化" class="headerlink" title="基于key的优化"></a>基于key的优化</h3><p>文档中已经强调，key需要保证在当前的作用域中唯一，不要使用当前循环的index(尤其在长列表中)。<br>参考 <a href="https://link.juejin.cn/?target=https://reactjs.org/docs/reconciliation.html%23keys" title="https://reactjs.org/docs/reconciliation.html#keys">reactjs.org&#x2F;docs&#x2F;reconc…</a></p><h2 id="编译性能"><a href="#编译性能" class="headerlink" title="编译性能"></a>编译性能</h2><h2 id="监控"><a href="#监控" class="headerlink" title="监控"></a>监控</h2><h2 id="白屏检测"><a href="#白屏检测" class="headerlink" title="白屏检测"></a>白屏检测</h2><h2 id="SEO"><a href="#SEO" class="headerlink" title="SEO"></a>SEO</h2><h2 id="Service-Worker"><a href="#Service-Worker" class="headerlink" title="Service Worker"></a>Service Worker</h2><h2 id="性能指标"><a href="#性能指标" class="headerlink" title="性能指标"></a>性能指标</h2><ul><li>FP（First Paint）首次绘制</li><li>FCP (First Contentful Paint) 首次内容绘制</li><li>LCP（Largest Contentful Paint）最大内容绘制</li><li>DCL (DocumentContentLoaded) dom加载完成</li><li>L （Onload）页面加载完成</li><li>TTI（Time To Interactive）可交互</li><li>TBT （Total Blocking Time）页面阻塞总时长</li><li>FID （First Input Delay）首次输入延迟</li><li>CLS （Cumlative Layout Shift）累计布局偏移</li><li>SI (Speed Index) 首次显示页面可见部分的平均时间</li></ul><h2 id="检测方式"><a href="#检测方式" class="headerlink" title="检测方式"></a>检测方式</h2><ul><li>F12 lighthouse 生成渲染报告 (要科学上网)</li></ul><p>F12 performance 查看页面渲染过程</p><p><a href="https://security.feishu.cn/link/safety?target=https://web.dev/measure/?from=from_parent_mindnote&scene=ccm&logParams=%7B%22location%22:%22ccm_mindnote%22%7D&lang=zh-CN">Measure (web.dev)</a></p><h2 id="计算方式"><a href="#计算方式" class="headerlink" title="计算方式"></a>计算方式</h2><ul><li>浏览器的Performance</li></ul><h2 id="服务器"><a href="#服务器" class="headerlink" title="服务器"></a>服务器</h2><ul><li>使用cdn</li><li>使用浏览器缓存</li><li>启用gzip</li><li>配置etag</li><li>ajax使用get请求（get可以被缓存，post不会）</li><li>避免图片src为空</li><li>尽早输出内容（服务端渲染）</li></ul><h2 id="页面内容"><a href="#页面内容" class="headerlink" title="页面内容"></a>页面内容</h2><ul><li>减少http请求</li><li>减少dns查询</li><li>避免重定向</li><li>缓存ajax请求</li><li>延迟加载</li><li>预加载</li><li>减少dom元素数量</li><li>划分内容到不同域名</li><li>减少iframe使用</li><li>减少404</li></ul><h2 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h2><ul><li>减少cookie大小</li></ul><p>静态资源使用无cookie的域名</p><h2 id="移动端"><a href="#移动端" class="headerlink" title="移动端"></a>移动端</h2><ul><li>保持单个文件小于25kb</li><li>打包内容为分段multipart文档</li></ul><h2 id="图片"><a href="#图片" class="headerlink" title="图片"></a>图片</h2><ul><li>尽可能使用webp</li><li>css sprite（雪碧图）</li><li>不要在html中缩放图片</li><li>使用体积小，可缓存的favicon.ico</li></ul><h2 id="JS脚本"><a href="#JS脚本" class="headerlink" title="JS脚本"></a>JS脚本</h2><ul><li>减少页面中外链脚本文件数量</li><li>删除重复脚本</li><li>script 放页面底部</li><li>使用外部 js 和 css</li><li>压缩 css js</li><li>减少 dom 操作</li><li>使用高效的事件处理</li></ul><h2 id="CSS脚本"><a href="#CSS脚本" class="headerlink" title="CSS脚本"></a>CSS脚本</h2><ul><li>把样式表放在head内</li><li>不用使用css表达式</li><li>使用link代替@import</li><li>不要使用filter（不是css3的filter，ie的东西）</li></ul><h3 id="网站性能优化"><a href="#网站性能优化" class="headerlink" title="网站性能优化"></a><a href="https://gitee.com/souyunku/NewDevBooks/blob/master/docs/HTML/HTML%E4%B8%AD%E7%BA%A7%E9%9D%A2%E8%AF%95%E9%A2%98%E6%B1%87%E6%80%BB%E5%8F%8A%E7%AD%94%E6%A1%88%EF%BC%882021%E5%B9%B4HTML%E9%9D%A2%E8%AF%95%E9%A2%98%E5%8F%8A%E7%AD%94%E6%A1%88%E5%A4%A7%E5%85%A8%EF%BC%89.md#10%E5%A6%82%E4%BD%95%E8%BF%9B%E8%A1%8C%E7%BD%91%E7%AB%99%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96">网站性能优化</a></h3><p><code>content</code>方面</p><p><strong>1、</strong> 减少 <code>HTTP</code>请求：合并文件、<code>CSS</code>精灵、<code>inline Image</code>、减少独立文件个数</p><p><strong>2、</strong> 减少 <code>DNS</code>查询时间：<code>DNS</code>缓存、将资源分布到恰当数量的主机名</p><p><strong>3、</strong> 减少 <code>DOM</code>元素数量</p><p><strong>4、</strong> 减少用户访问网页时的等待时间：使用gzip压缩网页内容</p><p><code>Server</code>方面</p><p><strong>1、</strong> 使用 <code>CDN</code></p><p><strong>2、</strong> 配置 <code>ETag</code></p><p><strong>3、</strong> 对组件使用 <code>Gzip</code>压缩</p><p><code>Cookie</code>方面</p><p><strong>1、</strong> 减小 <code>cookie</code>大小</p><p><code>css</code>方面</p><p><strong>1、</strong> 将样式表放到页面顶部</p><p><strong>2、</strong> 不使用 <code>CSS</code>表达式</p><p><strong>3、</strong> 使用 <code>&lt;link&gt;</code>不使用 <code>@import</code></p><p><code>Javascript</code>方面</p><p><strong>1、</strong> 将脚本放到页面底部</p><p><strong>2、</strong> 将 <code>javascript</code>和 <code>css</code>从外部引入</p><p><strong>3、</strong> 压缩 <code>javascript</code>和 <code>css</code></p><p><strong>4、</strong> 删除不需要的脚本</p><p><strong>5、</strong> 减少 <code>DOM</code> 访问</p><p>图片方面</p><p><strong>1、</strong> 优化图片：根据实际颜色需要选择色深、压缩</p><p><strong>2、</strong> 优化 <code>css</code> 精灵</p><p><strong>3、</strong> 不要在 <code>HTML</code> 中拉伸图片</p><h3 id="优化页面加载速度的法则"><a href="#优化页面加载速度的法则" class="headerlink" title="优化页面加载速度的法则"></a>优化页面加载速度的法则</h3><p>减少http请求</p><p>gulp值是对静态资源做流式处理，处理后未做有效的优化整合，也就是会所gulp忽略了系统层面的处理。</p><h1 id="web性能优化"><a href="#web性能优化" class="headerlink" title="web性能优化"></a>web性能优化</h1><h2 id="降低请求量"><a href="#降低请求量" class="headerlink" title="降低请求量"></a>降低请求量</h2><p>合并资源</p><p>减少http请求数</p><p>minify&#x2F;gzip压缩</p><p>webp</p><p>lazyload（懒加载）</p><h2 id="缓存"><a href="#缓存" class="headerlink" title="缓存"></a>缓存</h2><p>http协议缓存请求</p><p>离线缓存manifest</p><p>离线数据缓存localstorage</p><h2 id="加快请求速度"><a href="#加快请求速度" class="headerlink" title="加快请求速度"></a>加快请求速度</h2><p>预解析DNS</p><p>减少域名数</p><p>并行加载</p><p>CDN分发</p><h2 id="渲染"><a href="#渲染" class="headerlink" title="渲染"></a>渲染</h2><p>JS&#x2F;CSS优化</p><p>加载顺序</p><p>服务端渲染</p><p>pipeline</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> 性能优化 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 性能优化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>语法-基于Nodejs设计api接口</title>
      <link href="/posts/10fc5ca1/"/>
      <url>/posts/10fc5ca1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><hr><h2 id="Hello-world"><a href="#Hello-world" class="headerlink" title="Hello world"></a>Hello world</h2><p>用Node.js实现一个HTTP服务器程序非常简单。</p><p>这里实现一个最简单的Web程序，对于所有请求，都返回Hello world!</p><p>1、新建一个文件夹 <code>apiDemo</code> 在里面新建一个 <code>server.js</code>写入：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">//</span> 导入http模块</span><br><span class="line">var http = require(<span class="string">&#x27;http&#x27;</span>);</span><br><span class="line"><span class="regexp">//</span> 创建http server，并传入回调函数</span><br><span class="line">http.createServer(<span class="keyword">function</span>(request, response) &#123;</span><br><span class="line">    <span class="regexp">//</span> 回调函数接收request和response</span><br><span class="line">    <span class="regexp">//</span> 获取http请求的method和url</span><br><span class="line">    console.log(request.method + <span class="string">&#x27;:&#x27;</span> + request.url);</span><br><span class="line">    <span class="regexp">//</span> 将http响应<span class="number">200</span>写入response,同时设置Content-Type：text/html</span><br><span class="line">    response.writeHead(<span class="number">200</span>, &#123; <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;text/html&#x27;</span> &#125;);</span><br><span class="line">    <span class="regexp">//</span> 将http响应的html内容写入response</span><br><span class="line">    response.end(<span class="string">&#x27;&lt;h1&gt;Hello world!&lt;/h1&gt;&#x27;</span>);</span><br><span class="line">&#125;).listen(<span class="number">8080</span>); <span class="regexp">//</span> 让服务器监听<span class="number">8000</span>端口</span><br><span class="line"></span><br><span class="line">console.log(<span class="string">&#x27;Server running at http://127.0.0.1:8080/&#x27;</span>);</span><br></pre></td></tr></table></figure><p>2、在终端调试框中输入：</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">node</span> <span class="title">server</span>.js</span><br></pre></td></tr></table></figure><p>3、直接在浏览器中输入：<code>http://127.0.0.1:8080/</code> ，就可以看到服务器响应的内容：</p><p><img src="/image/api%E6%8E%A5%E5%8F%A3%E8%AE%BE%E8%AE%A1_nodejs/1651458864618.png"></p><p>4、同时，在命令提示符窗口中，可以看到程序打印的请求信息：</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">GET:</span> /</span><br><span class="line"><span class="symbol">GET:</span> /favicon.ico</span><br></pre></td></tr></table></figure><p>这里，主要需要了解的是：</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http.create<span class="constructor">Server(<span class="params">function</span>(<span class="params">request</span>, <span class="params">response</span>)</span>&#123;<span class="operator"></span></span><br><span class="line"><span class="operator">    ...</span></span><br><span class="line"><span class="operator"></span>&#125;).listen(×××);</span><br></pre></td></tr></table></figure><p>作用：创建一个http服务，里面传一个回调函数，函数中包含两个参数分别是（request，response）。</p><p>其中request是请求对象，response是响应对象。</p><p>并对端口×××进行监听。<br>可以根据 <code>request</code>对象拿到请求头的一些信息，如: <code>request.url</code>–返回请求路径<br>响应成功后：<br><code>response.writeHead()</code>————发送一个响应头给请求<br><code>response.end(&#39;xxx&#39;)</code>————响应成功 返回xxx</p><h2 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h2><p>我们是想当访问 <code>http://127.0.0.1:8080/</code>的时候返回当前目录的index.html。<br>也就是说当 <code>request.url === &#39;/&#39;</code>是 <code>true</code>时就可以确定当前请求的是根目录了，</p><figure class="highlight qml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="built_in">url</span> = request.url;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">url</span>);</span><br><span class="line"><span class="comment">// &#x27;/&#x27;</span></span><br></pre></td></tr></table></figure><p>我们能创建一个服务，并且能使用 <code>response.end(&#39;Hello world!&#39;);</code>返回“Hello world!”。如果想返回一个文件则需要用到Node.js的一个模块了—— <strong>fs 文件系统</strong> 。<br>它是Node当中处理文件的模块，首先引入：</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">var fs</span>= require(<span class="string">&#x27;fs&#x27;</span>);</span><br></pre></td></tr></table></figure><p>可以使用 <code>fs.readFile()</code>来读取文件</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fs.read<span class="constructor">File(&#x27;.<span class="operator">/</span><span class="params">index</span>.<span class="params">html</span>&#x27;, <span class="params">function</span>(<span class="params">err</span>, <span class="params">data</span>)</span>  &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) throw err;</span><br><span class="line">  console.log(data);</span><br><span class="line"><span class="comment">// &lt;Buffer 3c 21 44 4f 4...&gt;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>回调函数 有两个参数 (err, data)，其中 data 是文件的内容，以二进制形式返回。</p><p>然后我们就可以编写代码了，当访问根目录时，返回index.html文件</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http= <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> fs= <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> server= http.<span class="title function_">createServer</span>(<span class="keyword">function</span>(<span class="params">request, response</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> url = request.<span class="property">url</span>;</span><br><span class="line">    <span class="keyword">if</span>(url === <span class="string">&#x27;/&#x27;</span>)&#123;</span><br><span class="line">        fs.<span class="title function_">readFile</span>(<span class="string">&#x27;./index.html&#x27;</span>, <span class="keyword">function</span>(<span class="params">err, data</span>)&#123;</span><br><span class="line">          <span class="keyword">if</span>(!err)&#123;</span><br><span class="line">            response.<span class="title function_">writeHead</span>(<span class="number">200</span>, &#123;<span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;text/html;charset=UTF-8&quot;</span>&#125;);</span><br><span class="line">            response.<span class="title function_">end</span>(data)</span><br><span class="line">          &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">              <span class="keyword">throw</span> err;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;错误&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">server.<span class="title function_">listen</span>(<span class="number">8080</span>, <span class="string">&#x27;127.0.0.1&#x27;</span>);</span><br></pre></td></tr></table></figure><p>然后在当前目录下新建 <code>index.html</code>，在这里我们可以写一个ajax请求，一会我们点击按钮来实现ajax请求一组数据：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;box&quot;</span>&gt;</span>看不到看不到<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;success()&quot;</span>&gt;</span>我是按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">success</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> http= <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span></span><br><span class="line"><span class="language-javascript">        http.<span class="property">onreadystatechange</span>= <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span>(http.<span class="property">status</span> == <span class="number">200</span> &amp;&amp; http.<span class="property">readyState</span> == <span class="number">4</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> msg= http.<span class="property">responseText</span>;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> box= <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;box&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">                box.<span class="property">innerHTML</span>= <span class="title class_">JSON</span>.<span class="title function_">parse</span>(msg).<span class="property">name</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//发送请求</span></span></span><br><span class="line"><span class="language-javascript">        http.<span class="title function_">open</span>(<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;/data&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        http.<span class="title function_">send</span>();</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这段代码是点击按钮的时候 会向 <code>/data</code>发起一个ajsx请求,</p><h2 id="实现简单的API接口"><a href="#实现简单的API接口" class="headerlink" title="实现简单的API接口"></a>实现简单的API接口</h2><p>既然能访问根目录时可以返回html文件，那我们可以自己设定一个url，当请求这个url是我们就给它返回一组json数据。正常来讲这些数据应该是从数据库读取的，在这里只模拟一组json数据，在当前目录新建一个 <code>data.json</code>：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;尼古拉丁 * 赵四&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>所以当前的目录结构是：</p><p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/12/14/167abd4998736425~tplv-t2oaga2asx-zoom-in-crop-mark:1304:0:0:0.awebp" alt="41544775041_.pic.jpg"></p><p>然后我们可以在server.js中判断一下，当请求的url是 <code>/data</code>时，则返回data.json：</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(url<span class="operator"> === </span>&#x27;/data&#x27;)&#123;</span><br><span class="line">    fs.read<span class="constructor">File(&#x27;.<span class="operator">/</span><span class="params">data</span>.<span class="params">json</span>&#x27;, <span class="params">function</span>(<span class="params">err</span>, <span class="params">data</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!err)&#123;</span><br><span class="line">            response.write<span class="constructor">Head(200, &#123;<span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span>&#125;)</span>;</span><br><span class="line">            response.<span class="keyword">end</span>(data);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            throw err;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后打开浏览器 <code>http://127.0.0.1:8080</code> 后，就会出现index.html页面，点击出现的按钮就会触发一个对 <code>/data</code>的ajax请求，当server.js接受到请求后，就会判断 <code>url === &#39;/data&#39;</code>，然后它就会吧  <code>data.json</code>返回给我们。</p><p>最后的实现是点击按钮出现 <strong>尼古拉丁 * 赵四</strong></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> 语法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> api </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>语法——NodeJS</title>
      <link href="/posts/31e53543/"/>
      <url>/posts/31e53543/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="NodeJS"><a href="#NodeJS" class="headerlink" title="NodeJS"></a>NodeJS</h1><h2 id="浏览器和NodeJS中的事件循环（EventLoop）"><a href="#浏览器和NodeJS中的事件循环（EventLoop）" class="headerlink" title="浏览器和NodeJS中的事件循环（EventLoop）"></a>浏览器和NodeJS中的事件循环（EventLoop）</h2><h3 id="浏览器"><a href="#浏览器" class="headerlink" title="浏览器"></a>浏览器</h3><p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/10/5/16d99c58b974a59d~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp"></p><p>如图：浏览器中相对简单，共有两个事件队列，当主线程空闲时会清空Microtask queue(微任务队列)依次执行Task Queue(宏任务队列)中的回调函数，每执行完一个之后再清空Microtask queue。</p><blockquote><p>“当前执行栈” -&gt; “micro-task” -&gt; “task queue中取一个回调” -&gt; “micro-task” -&gt; … (不断消费task queue) -&gt; “micro-task”</p></blockquote><h3 id="NodeJS-1"><a href="#NodeJS-1" class="headerlink" title="NodeJS"></a>NodeJS</h3><p>node中机制和浏览器有一些差异。node中的task queue是分为几个阶段，清空micro-task是在一个阶段结束之后(浏览器中是每一个任务结束之后)，各个阶段如下：</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">   ┌───────────────────────┐</span><br><span class="line">┌─&gt;│        timers         │&lt;————— 执行 setTimeout()、setInterval() 的回调</span><br><span class="line">│  └──────────┬────────────┘</span><br><span class="line">|             |&lt;<span class="comment">-- 执行所有 Next Tick Queue 以及 MicroTask Queue 的回调</span></span><br><span class="line">│  ┌──────────┴────────────┐</span><br><span class="line">│  │     pending callbacks │&lt;————— 执行由上一个 Tick 延迟下来的 I/O 回调（待完善，可忽略）</span><br><span class="line">│  └──────────┬────────────┘</span><br><span class="line">|             |&lt;<span class="comment">-- 执行所有 Next Tick Queue 以及 MicroTask Queue 的回调</span></span><br><span class="line">│  ┌──────────┴────────────┐</span><br><span class="line">│  │     idle, <span class="built_in">prepare</span>     │&lt;————— 内部调用（可忽略）</span><br><span class="line">│  └──────────┬────────────┘   </span><br><span class="line">|             |&lt;<span class="comment">-- 执行所有 Next Tick Queue 以及 MicroTask Queue 的回调</span></span><br><span class="line">|             |                   ┌───────────────┐</span><br><span class="line">│  ┌──────────┴────────────┐      │   incoming:   │ - (执行几乎所有的回调，除了 <span class="built_in">close</span> callbacks 以及 timers 调度的回调和 setImmediate() 调度的回调，在恰当的时机将会阻塞在此阶段)</span><br><span class="line">│  │         poll          │&lt;─────┤  connections, │ </span><br><span class="line">│  └──────────┬────────────┘      │   data, etc.  │ </span><br><span class="line">│             |                   |               | </span><br><span class="line">|             |                   └───────────────┘</span><br><span class="line">|             |&lt;<span class="comment">-- 执行所有 Next Tick Queue 以及 MicroTask Queue 的回调</span></span><br><span class="line">|  ┌──────────┴────────────┐  </span><br><span class="line">│  │        check          │&lt;————— setImmediate() 的回调将会在这个阶段执行</span><br><span class="line">│  └──────────┬────────────┘</span><br><span class="line">|             |&lt;<span class="comment">-- 执行所有 Next Tick Queue 以及 MicroTask Queue 的回调</span></span><br><span class="line">│  ┌──────────┴────────────┐</span><br><span class="line">└──┤    <span class="built_in">close</span> callbacks    │&lt;————— <span class="built_in">socket</span>.on(<span class="string">&#x27;close&#x27;</span>, ...)</span><br><span class="line">   └───────────────────────┘</span><br></pre></td></tr></table></figure><p>这里我们主要关注其中的3个阶段：timer、poll和check，其中poll队列相对复杂：</p><blockquote><p>轮询 阶段有两个重要的功能：</p><p>1、计算应该阻塞和轮询 I&#x2F;O 的时间。</p><p>2、然后，处理 轮询 队列里的事件。</p></blockquote><blockquote><p>当事件循环进入 轮询 阶段且 没有计划计时器时 ，将发生以下两种情况之一：</p><p>1、如果轮询队列不是空的，事件循环将循环访问其回调队列并同步执行它们，直到队列已用尽，或者达到了与系统相关的硬限制。</p><p>2、如果轮询队列是空的，还有两件事发生：</p><p>a、如果脚本已按 setImmediate() 排定，则事件循环将结束 轮询 阶段，并继续 check阶段以执行这些计划脚本。</p><p>b、如果脚本 尚未 按 setImmediate()排定，则事件循环将等待回调添加到队列中，然后立即执行。</p></blockquote><blockquote><p>一旦轮询队列为空，事件循环将检查已达到时间阈值的计时器。如果一个或多个计时器已准备就绪，则事件循环将绕回计时器阶段以执行这些计时器的回调。</p></blockquote><p>细节请参考<a href="https://link.juejin.cn/?target=https://nodejs.org/en/docs/guides/event-loop-timers-and-nexttick/%23poll" title="https://nodejs.org/en/docs/guides/event-loop-timers-and-nexttick/#poll">The Node.js Event Loop, Timers, and process.nextTick()</a><br>中文：<a href="https://link.juejin.cn/?target=https://nodejs.org/zh-cn/docs/guides/event-loop-timers-and-nexttick/" title="https://nodejs.org/zh-cn/docs/guides/event-loop-timers-and-nexttick/">Node.js 事件循环，定时器和 process.nextTick()</a></p><h3 id="通过程序理解浏览器和node中的差异"><a href="#通过程序理解浏览器和node中的差异" class="headerlink" title="通过程序理解浏览器和node中的差异"></a>通过程序理解浏览器和node中的差异</h3><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">&quot;timer1&quot;</span>);</span><br><span class="line">  Promise.resolve().then(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">&quot;promise1&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">&quot;timer2&quot;</span>);</span><br><span class="line">  Promise.resolve().then(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">&quot;promise2&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br></pre></td></tr></table></figure><p>在浏览器中的顺序是：timer1 -&gt; promise1 -&gt; timer2 -&gt; pormise2</p><p>node中顺序是： timer1 -&gt; timer2 -&gt; promise1 -&gt; promise2</p><p><em><strong>这道题目很好的说明了node中的micro-task是在一个阶段的任务执行完之后才清空的。</strong></em></p><h2 id="实现一个node中的EventEmiter"><a href="#实现一个node中的EventEmiter" class="headerlink" title="实现一个node中的EventEmiter"></a>实现一个node中的EventEmiter</h2><p>简单实现：</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">EventsEmiter</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">events</span> = &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">on</span>(<span class="params"><span class="keyword">type</span>, fn</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> events = <span class="variable language_">this</span>.<span class="property">events</span>;</span><br><span class="line">    <span class="keyword">if</span> (!events[<span class="keyword">type</span>]) &#123;</span><br><span class="line">      events[<span class="keyword">type</span>] = [fn];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      events[<span class="keyword">type</span>].<span class="title function_">push</span>(fn);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">emit</span>(<span class="params"><span class="keyword">type</span>, ...res</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> events = <span class="variable language_">this</span>.<span class="property">events</span>;</span><br><span class="line">    <span class="keyword">if</span> (events[<span class="keyword">type</span>]) &#123;</span><br><span class="line">      events[<span class="keyword">type</span>].<span class="title function_">forEach</span>(<span class="function"><span class="params">fn</span> =&gt;</span> fn.<span class="title function_">apply</span>(<span class="variable language_">this</span>, res));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">remove</span>(<span class="params"><span class="keyword">type</span>, fn</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> events = <span class="variable language_">this</span>.<span class="property">events</span>;</span><br><span class="line">    <span class="keyword">if</span> (events[<span class="keyword">type</span>]) &#123;</span><br><span class="line">      events[<span class="keyword">type</span>] = events[<span class="keyword">type</span>].<span class="title function_">filer</span>(<span class="function"><span class="params">lisener</span> =&gt;</span> lisener !== fn);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="实现一个node中util模块的promisify方法"><a href="#实现一个node中util模块的promisify方法" class="headerlink" title="实现一个node中util模块的promisify方法"></a>实现一个node中util模块的promisify方法</h2><figure class="highlight zephir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fs = <span class="keyword">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> read = fs.readFile;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">promisify</span><span class="params">(fn)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span><span class="params">(...args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Promise((resolve, reject) =&gt; &#123;</span><br><span class="line">      <span class="function"><span class="keyword">fn</span><span class="params">(...args, <span class="params">(err, data)</span> =&gt; &#123;</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="keyword">if</span> <span class="params">(err)</span> &#123;</span></span></span><br><span class="line"><span class="params"><span class="function">          reject<span class="params">(err)</span>;</span></span></span><br><span class="line"><span class="params"><span class="function">        &#125;</span></span></span><br><span class="line"><span class="params"><span class="function">        resolve<span class="params">(data)</span>;</span></span></span><br><span class="line"><span class="params"><span class="function">      &#125;)</span></span>;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 回调用法</span></span><br><span class="line"><span class="comment">// read(&quot;./test.json&quot;, (err, data) =&gt; &#123;</span></span><br><span class="line"><span class="comment">//   if (err) &#123;</span></span><br><span class="line"><span class="comment">//     console.error(&quot;err&quot;, err);</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">//   console.log(&quot;data&quot;, data.toString());</span></span><br><span class="line"><span class="comment">// &#125;);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// promise用法</span></span><br><span class="line"><span class="keyword">let</span> readPromise = promisify(read);</span><br><span class="line"></span><br><span class="line">readPromise(<span class="string">&quot;./test.json&quot;</span>).then(res =&gt; &#123;</span><br><span class="line">  console.log(<span class="string">&quot;data&quot;</span>, res.toString());</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="如何实现一个自定义流"><a href="#如何实现一个自定义流" class="headerlink" title="如何实现一个自定义流"></a>如何实现一个自定义流</h2><p>根据所创建的流类型，新的流类必须实现一个或多个特定的方法，如下图所示:</p><table><thead><tr><th>用例</th><th>类</th><th>需实现的方法</th></tr></thead><tbody><tr><td>只读流</td><td><a href="/s/YuDKX1" title="/s/YuDKX1"><code>Readable</code></a></td><td><code>&lt;a target=&quot;_blank&quot; rel=&quot;nofollow&quot; href=&quot;/s/5hv4Rd&quot; title=&quot;/s/5hv4Rd&quot;&gt;_read&lt;/a&gt;</code></td></tr><tr><td>只写流</td><td><a href="/s/9JUnJ8" title="/s/9JUnJ8"><code>Writable</code></a></td><td><code>&lt;a target=&quot;_blank&quot; rel=&quot;nofollow&quot; href=&quot;/s/8MvCPB&quot; title=&quot;/s/8MvCPB&quot;&gt;_write&lt;/a&gt;</code>,<code>&lt;a target=&quot;_blank&quot; rel=&quot;nofollow&quot; href=&quot;/s/7qpAhU&quot; title=&quot;/s/7qpAhU&quot;&gt;_writev&lt;/a&gt;</code>,<code>&lt;a target=&quot;_blank&quot; rel=&quot;nofollow&quot; href=&quot;/s/ehUmqz&quot; title=&quot;/s/ehUmqz&quot;&gt;_final&lt;/a&gt;</code></td></tr><tr><td>可读可写流</td><td><a href="/s/2iRabr" title="/s/2iRabr"><code>Duplex</code></a></td><td><code>&lt;a target=&quot;_blank&quot; rel=&quot;nofollow&quot; href=&quot;/s/5hv4Rd&quot; title=&quot;/s/5hv4Rd&quot;&gt;_read&lt;/a&gt;</code>,<code>&lt;a target=&quot;_blank&quot; rel=&quot;nofollow&quot; href=&quot;/s/8MvCPB&quot; title=&quot;/s/8MvCPB&quot;&gt;_write&lt;/a&gt;</code>,<code>&lt;a target=&quot;_blank&quot; rel=&quot;nofollow&quot; href=&quot;/s/7qpAhU&quot; title=&quot;/s/7qpAhU&quot;&gt;_writev&lt;/a&gt;</code>,<code>&lt;a target=&quot;_blank&quot; rel=&quot;nofollow&quot; href=&quot;/s/ehUmqz&quot; title=&quot;/s/ehUmqz&quot;&gt;_final&lt;/a&gt;</code></td></tr><tr><td>对写入的数据进行操作，然后读取结果</td><td><a href="/s/fhVJQM" title="/s/fhVJQM"><code>Transform</code></a></td><td><code>&lt;a target=&quot;_blank&quot; rel=&quot;nofollow&quot; href=&quot;/s/N8nFbP&quot; title=&quot;/s/N8nFbP&quot;&gt;_transform&lt;/a&gt;</code>,<code>&lt;a target=&quot;_blank&quot; rel=&quot;nofollow&quot; href=&quot;/s/mErApk&quot; title=&quot;/s/mErApk&quot;&gt;_flush&lt;/a&gt;</code>,<code>&lt;a target=&quot;_blank&quot; rel=&quot;nofollow&quot; href=&quot;/s/ehUmqz&quot; title=&quot;/s/ehUmqz&quot;&gt;_final&lt;/a&gt;</code></td></tr></tbody></table><p>以双工流为例：</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; Duplex &#125; = require(<span class="string">&#x27;stream&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Myduplex</span> <span class="title">extends</span>  <span class="title">Duplex</span> &#123;</span><br><span class="line">  <span class="keyword">constructor</span>(arr, opt) &#123;</span><br><span class="line">    <span class="keyword">super</span>(opt);</span><br><span class="line">    <span class="keyword">this</span>.arr = arr</span><br><span class="line">    <span class="keyword">this</span>.index = <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//实现可读流部分</span></span><br><span class="line">  _read(size) &#123;</span><br><span class="line">    <span class="keyword">this</span>.index++</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>.index === <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.push(<span class="literal">null</span>) </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.push(<span class="keyword">this</span>.index.toString())</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//实现可写流</span></span><br><span class="line">  _write(chunk, encoding, callback) &#123;</span><br><span class="line">    <span class="keyword">this</span>.arr.push(chunk.toString())</span><br><span class="line">    callback()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>更多内容可以参考我的另一篇文章：<a href="https://juejin.cn/post/6844903557066391565" title="https://juejin.cn/post/6844903557066391565">说说node中可读流和可写流</a><br>和 <a href="https://link.juejin.cn/?target=https://nodejs.org/dist/latest-v12.x/docs/api/stream.html" title="https://nodejs.org/dist/latest-v12.x/docs/api/stream.html">nodejs官网</a></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> 语法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> NodeJS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>前端算法</title>
      <link href="/posts/aa046a31/"/>
      <url>/posts/aa046a31/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h1><h2 id="实现一个reduce方法"><a href="#实现一个reduce方法" class="headerlink" title="实现一个reduce方法"></a>实现一个reduce方法</h2><p>注意边界条件：1、数组长度为0，并且reduce没有传入初始参数时，抛出错误。2、reduce有返回值。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">myReduce</span> = <span class="keyword">function</span>(<span class="params">fn, initial</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">length</span> === <span class="number">0</span> &amp;&amp; !initial) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;no initial and array is empty&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> start = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">let</span> pre = <span class="variable language_">this</span>[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">if</span> (initial) &#123;</span><br><span class="line">    start = <span class="number">0</span>;</span><br><span class="line">    pre = initial;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = start; i &lt; <span class="variable language_">this</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">let</span> current = <span class="variable language_">this</span>[i];</span><br><span class="line">    pre = fn.<span class="title function_">call</span>(<span class="variable language_">this</span>, pre, current, i);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> pre;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="实现一个promise-all方法，要求保留错误并且并发数为3"><a href="#实现一个promise-all方法，要求保留错误并且并发数为3" class="headerlink" title="实现一个promise.all方法，要求保留错误并且并发数为3"></a>实现一个promise.all方法，要求保留错误并且并发数为3</h2><p>标准的all方法是遇到错误会立即将promise置为失败态，并触发error回调。保留错误的定义为：promise遇到错误保存在返回的结果中。</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">promiseall</span>(<span class="params">promises</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> Promise(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">    let result = [];</span><br><span class="line">    let flag = <span class="number">0</span>;</span><br><span class="line">    let taskQueue = promises.<span class="built_in">slice</span>(<span class="number">0</span>, <span class="number">3</span>); <span class="comment">//任务队列，初始为最大并发数3</span></span><br><span class="line">    let others = promises.<span class="built_in">slice</span>(<span class="number">3</span>); <span class="comment">//排队的任务</span></span><br><span class="line"></span><br><span class="line">    taskQueue.forEach(<span class="function">(<span class="params">promise, i</span>) =&gt;</span> &#123;</span><br><span class="line">      singleTaskRun(promise, i);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    let i = <span class="number">3</span>; <span class="comment">//新的任务从索引3开始</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">next</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (others.<span class="built_in">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      const newTask = others.shift();</span><br><span class="line">      singleTaskRun(newTask, i++);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">singleTaskRun</span>(<span class="params">promise, i</span>) &#123;</span><br><span class="line">      promise</span><br><span class="line">        .then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">          check();</span><br><span class="line">          result[i] = res;</span><br><span class="line">          next();</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">          check();</span><br><span class="line">          result[i] = err;</span><br><span class="line">          next();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">check</span>(<span class="params"></span>) &#123;</span><br><span class="line">      flag++;</span><br><span class="line">      <span class="keyword">if</span> (flag === promises.<span class="built_in">length</span>) &#123;</span><br><span class="line">        resolve(result);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>测试代码：</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">let p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">(resolve, reject)</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    resolve(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br><span class="line">let p2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">(resolve, reject)</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    resolve(<span class="string">&quot;2&quot;</span>);</span><br><span class="line">  &#125;, <span class="number">1500</span>);</span><br><span class="line">&#125;);</span><br><span class="line">let p3 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">(resolve, reject)</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    resolve(<span class="string">&quot;3&quot;</span>);</span><br><span class="line">  &#125;, <span class="number">2000</span>);</span><br><span class="line">&#125;);</span><br><span class="line">let p4 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">(resolve, reject)</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    resolve(<span class="string">&quot;4&quot;</span>);</span><br><span class="line">  &#125;, <span class="number">2500</span>);</span><br><span class="line">&#125;);</span><br><span class="line">let p_e = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">(resolve, reject)</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="regexp">//</span> <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;出错&quot;</span>);</span><br><span class="line">  reject(<span class="string">&quot;错误&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">let p5 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">(resolve, reject)</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    resolve(<span class="string">&quot;5&quot;</span>);</span><br><span class="line">  &#125;, <span class="number">5000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">let all = promiseall([p_e, p1, p3, p2, p4, p5]);</span><br><span class="line">all.<span class="keyword">then</span>(</span><br><span class="line">  data =&gt; &#123;</span><br><span class="line">    console.log(<span class="string">&quot;data&quot;</span>, data);    <span class="regexp">//</span> [ <span class="string">&#x27;错误&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;5&#x27;</span> ]</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h2 id="不用递归函数求一个二叉树的高度"><a href="#不用递归函数求一个二叉树的高度" class="headerlink" title="不用递归函数求一个二叉树的高度"></a>不用递归函数求一个二叉树的高度</h2><p>先看一下递归的实现(二叉树的深度优先遍历)：</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getBinaryTreeHeigth</span></span>(node) &#123;</span><br><span class="line">  let maxDeep = <span class="number">0</span>;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">next</span></span>(n, deep) &#123;</span><br><span class="line">    deep++;</span><br><span class="line">    <span class="keyword">if</span> (n.l) &#123;</span><br><span class="line">      let <span class="keyword">new</span><span class="type">Deep</span> = next(n.l, deep);</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">new</span><span class="type">Deep</span> &gt; maxDeep) &#123;</span><br><span class="line">        maxDeep = <span class="keyword">new</span><span class="type">Deep</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (n.r) &#123;</span><br><span class="line">      let <span class="keyword">new</span><span class="type">Deep</span> = next(n.r, deep);</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">new</span><span class="type">Deep</span> &gt; maxDeep) &#123;</span><br><span class="line">        maxDeep = <span class="keyword">new</span><span class="type">Deep</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> deep;</span><br><span class="line">  &#125;</span><br><span class="line">  next(node, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span> maxDeep;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Node</span></span>(v, l, r) &#123;</span><br><span class="line">  <span class="built_in">this</span>.v = v;</span><br><span class="line">  <span class="built_in">this</span>.l = l;</span><br><span class="line">  <span class="built_in">this</span>.r = r;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>非递归的实现(二叉树的广度优先遍历)：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">function <span class="title">getBinaryTreeHeigth</span><span class="params">(node)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!node) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">const</span> queue = [node];</span><br><span class="line">  let deep = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> (queue.length) &#123;</span><br><span class="line">    deep++;</span><br><span class="line">    <span class="keyword">for</span> (let i = <span class="number">0</span>; i &lt; queue.length; i++) &#123;</span><br><span class="line">      <span class="type">const</span> cur = queue.<span class="built_in">pop</span>();</span><br><span class="line">      <span class="keyword">if</span> (cur.l) &#123;</span><br><span class="line">        queue.<span class="built_in">unshift</span>(cur.l);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (cur.r) &#123;</span><br><span class="line">        queue.<span class="built_in">unshift</span>(cur.r);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> deep;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">function <span class="title">Node</span><span class="params">(v, l, r)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.v = v;</span><br><span class="line">  <span class="keyword">this</span>.l = l;</span><br><span class="line">  <span class="keyword">this</span>.r = r;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="js中求两个大数相加"><a href="#js中求两个大数相加" class="headerlink" title="js中求两个大数相加"></a>js中求两个大数相加</h2><p>给定两个以字符串形式表示的非负整数 num1 和 num2,返回它们的和，仍用字符串表示。</p><blockquote><p>输入：num1 &#x3D; ‘1234’, num2 &#x3D; ‘987’</p><p>输出：’2221’</p></blockquote><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> big<span class="constructor">IntAdd(<span class="params">str1</span>, <span class="params">str2</span>)</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> result = <span class="literal">[]</span>;</span><br><span class="line">  <span class="keyword">let</span> ary1 = str1.split(<span class="string">&quot;&quot;</span>);</span><br><span class="line">  <span class="keyword">let</span> ary2 = str2.split(<span class="string">&quot;&quot;</span>);</span><br><span class="line">  <span class="keyword">let</span> flag = <span class="literal">false</span>; <span class="comment">//是否进位</span></span><br><span class="line">  <span class="keyword">while</span> (ary1.length<span class="operator"> || </span>ary2.length) &#123;</span><br><span class="line">    <span class="keyword">let</span> result_c = sigle<span class="constructor">_pos_add(<span class="params">ary1</span>.<span class="params">pop</span>()</span>, ary2.pop<span class="literal">()</span>);</span><br><span class="line">    <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">      result_c = result_c + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    result.unshift(result_c % <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (result_c &gt;= <span class="number">10</span>) &#123;</span><br><span class="line">      flag = <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      flag = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(flag) &#123;</span><br><span class="line">    result.unshift(<span class="character">&#x27;1&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  return result.join(<span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> sigle<span class="constructor">_pos_add(<span class="params">str1_c</span>, <span class="params">str2_c</span>)</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> l = (r = <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> (str1_c) &#123;</span><br><span class="line">    l = <span class="constructor">Number(<span class="params">str1_c</span>)</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (str2_c) &#123;</span><br><span class="line">    r = <span class="constructor">Number(<span class="params">str2_c</span>)</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  return l + r;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>测试代码：</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> str1 = <span class="string">&quot;1234&quot;</span>;</span><br><span class="line"><span class="type">const</span> str2 = <span class="string">&quot;987654321&quot;</span>;</span><br><span class="line"><span class="type">const</span> str3 = <span class="string">&quot;4566786445677555&quot;</span>;</span><br><span class="line"><span class="type">const</span> str4 = <span class="string">&quot;987&quot;</span>;</span><br><span class="line"></span><br><span class="line">console.<span class="built_in">log</span>(<span class="built_in">bigIntAdd</span>(str1, str4))  <span class="comment">//&#x27;2221&#x27;</span></span><br><span class="line">console.<span class="built_in">log</span>(<span class="built_in">bigIntAdd</span>(str2, str3))  <span class="comment">//&#x27;4566787433331876&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="实现一个数组随机打乱算法"><a href="#实现一个数组随机打乱算法" class="headerlink" title="实现一个数组随机打乱算法"></a>实现一个数组随机打乱算法</h2><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> dis<span class="constructor">Order(<span class="params">ary</span>)</span> &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; ary.length; i++) &#123;</span><br><span class="line">    <span class="keyword">let</span> randomIndex = <span class="module-access"><span class="module"><span class="identifier">Math</span>.</span></span>floor(<span class="module-access"><span class="module"><span class="identifier">Math</span>.</span></span>random<span class="literal">()</span><span class="operator"> * </span>ary.length);</span><br><span class="line">    swap(ary, i, randomIndex);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> swap(ary, a, b) &#123;</span><br><span class="line">  <span class="keyword">let</span> temp = ary<span class="literal">[<span class="identifier">a</span>]</span>;</span><br><span class="line">  ary<span class="literal">[<span class="identifier">a</span>]</span> = ary<span class="literal">[<span class="identifier">b</span>]</span>;</span><br><span class="line">  ary<span class="literal">[<span class="identifier">b</span>]</span> = temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> ary = <span class="literal">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>]</span>;</span><br><span class="line">dis<span class="constructor">Order(<span class="params">ary</span>)</span>;</span><br><span class="line"></span><br><span class="line">console.log(ary);</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="给数字增加“逗号”分隔"><a href="#给数字增加“逗号”分隔" class="headerlink" title="给数字增加“逗号”分隔"></a>给数字增加“逗号”分隔</h2><blockquote><p>输入： ‘“123456789.012”‘  输出：123,456,789.012</p></blockquote><h4 id="正则解法："><a href="#正则解法：" class="headerlink" title="正则解法："></a>正则解法：</h4><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">parseNumber</span>(<span class="params">num</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!num) <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="keyword">return</span> num.<span class="built_in">replace</span>(<span class="regexp">/(\d)(?=(\d&#123;3&#125;)+(\.|$))/g</span>, <span class="string">&quot;$1,&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="非正则："><a href="#非正则：" class="headerlink" title="非正则："></a>非正则：</h4><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">function formatNumber(<span class="built_in">num</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="built_in">num</span>) <span class="built_in">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="built_in">let</span> [int, <span class="built_in">float</span>] = <span class="built_in">num</span>.<span class="built_in">split</span>(<span class="string">&quot;.&quot;</span>);</span><br><span class="line">  <span class="built_in">let</span> intArr = int.<span class="built_in">split</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">  <span class="built_in">let</span> result = [];</span><br><span class="line">  <span class="built_in">let</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> (intArr.<span class="built_in">length</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (i !== <span class="number">0</span> &amp;&amp; i <span class="symbol">%</span> <span class="number">3</span> === <span class="number">0</span>) &#123;</span><br><span class="line">      result.unshift(intArr.<span class="built_in">pop</span>() + <span class="string">&quot;,&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      result.unshift(intArr.<span class="built_in">pop</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    i++;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">return</span> result.<span class="built_in">join</span>(<span class="string">&quot;&quot;</span>) + <span class="string">&quot;.&quot;</span> + (<span class="built_in">float</span> ? <span class="built_in">float</span> : <span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>作者：寒东设计师<br>链接：<a href="https://juejin.cn/post/6844903969345503240">https://juejin.cn/post/6844903969345503240</a><br>来源：稀土掘金<br>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处</p><ul><li><a href="https://juejin.cn/post/6844903969345503240#6-1" title="#6-1">实现一个reduce方法</a></li><li><a href="https://juejin.cn/post/6844903969345503240#6-2" title="#6-2">实现一个promise.all方法，要求保留错误并且并发数为3</a></li><li><a href="https://juejin.cn/post/6844903969345503240#6-3" title="#6-3">不用递归函数求一个二叉树的高度</a></li><li><a href="https://juejin.cn/post/6844903969345503240#6-4" title="#6-4">js中求两个大数相加</a></li><li><a href="https://juejin.cn/post/6844903969345503240#6-5" title="#6-5">实现一个数组随机打乱算法</a></li><li><a href="https://juejin.cn/post/6844903969345503240#6-6" title="#6-6">给数字增加“逗号”分隔符</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 计算机基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 前端算法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CSS-自学之路</title>
      <link href="/posts/f03c58b1/"/>
      <url>/posts/f03c58b1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="CSS渲染"><a href="#CSS渲染" class="headerlink" title="CSS渲染"></a>CSS渲染</h2><h3 id="CSS-渲染规则"><a href="#CSS-渲染规则" class="headerlink" title="CSS 渲染规则"></a>CSS 渲染规则</h3><p>渲染规则：<strong>从上到下，从右到左</strong>进行渲染。</p><a href="/posts/d69b3681/" title="浏览器输入url回车之后发生了什么">浏览器输入url回车之后发生了什么</a><h2 id="规范CSS的命名和书写"><a href="#规范CSS的命名和书写" class="headerlink" title="规范CSS的命名和书写"></a>规范CSS的命名和书写</h2><a href="/posts/dadb628e/" title="规范CSS的命名和书写">规范CSS的命名和书写</a><h2 id="CSS属性继承"><a href="#CSS属性继承" class="headerlink" title="CSS属性继承"></a>CSS属性继承</h2><a href="/posts/4a2f482e/" title="CSS属性继承">CSS属性继承</a><h2 id="样式与选择器"><a href="#样式与选择器" class="headerlink" title="样式与选择器"></a>样式与选择器</h2><a href="/posts/3158911a/" title="样式与选择器">样式与选择器</a><h2 id="盒模型"><a href="#盒模型" class="headerlink" title="盒模型"></a>盒模型</h2><p>盒模型：在网页中，一个元素占有空间的大小由四个部分组成。</p><blockquote><ul><li>元素的内容（content）</li><li>元素的内边距（padding）</li><li>元素的边框（border）</li><li>元素的外边距（margin）<br>这四个部分占有的空间中，有的部分可以显示相应的内容，而有的部分只用来分隔相邻的区域或区域。4个部分一起构成了 <code>css</code>中元素的盒模型。</li></ul></blockquote><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">二维视图</button></li><li class="tab"><button type="button" data-href="#super-2">三维视图</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><img src="/image/CSS-%E8%87%AA%E5%AD%A6%E4%B9%8B%E8%B7%AF/1665061654322.png" alt="1665061654322"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><img src="/image/CSS-%E8%87%AA%E5%AD%A6%E4%B9%8B%E8%B7%AF/1665061668874.png" alt="1665061668874"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>在CSS中，盒子模型可以分成：</p><ul><li>W3C标准盒模型</li><li>IE盒模型<br>默认情况下，盒子模型为W3C标准盒模型</li></ul><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">W3C标准盒模型</button></li><li class="tab"><button type="button" data-href="#super-2">IE怪异盒模型</button></li><li class="tab"><button type="button" data-href="#super-3">两边距重叠问题（margin合并）</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>标准盒模型是浏览器默认的盒子模型<br>标准模式：按照W3C标准解析执行代码<br><img src="/image/CSS-%E8%87%AA%E5%AD%A6%E4%B9%8B%E8%B7%AF/1665061804714.png" alt="1665061804714"><br>在标准盒模型下：</p><ul><li>盒子总宽度 &#x3D; 宽度 + 内边距 + 边框 + 外边距</li><li>盒子总高度 &#x3D; 高度 + 内边距 + 边框 + 外边距<br>即width&amp;height仅仅只包含内容高度，不包含外边距与边框，所以width有240px</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>怪异模式：浏览器各自有解析方式<br><img src="/image/CSS-%E8%87%AA%E5%AD%A6%E4%B9%8B%E8%B7%AF/1665061814354.png" alt="1665061814354"><br>从图中可以得到，IE盒模型中：</p><ul><li>盒子总宽度 &#x3D; 宽度 + 外边距</li><li>盒子总高度 &#x3D; 高度 + 外边距<br>即width&amp;height包含内边距&amp;边框，所以如果在IE盒模型下，width是200px</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><ul><li>垂直排列时<ul><li>间距取较大值</li><li>皆为正数 &#x3D;&#x3D;&gt; 取较大值</li><li>皆为负数 &#x3D;&#x3D;&gt; 取绝对值的较大值</li><li>一正一负 &#x3D;&#x3D;&gt; 取和</li><li>父子元素margin合并</li><li>两个盒子相邻时</li><li></li></ul></li><li>水平排列时<ul><li>间距取相加值</li></ul></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">box-sizing属性</button></li><li class="tab"><button type="button" data-href="#super-2">border-radius属性(CSS3)</button></li><li class="tab"><button type="button" data-href="#super-3">overflow属性</button></li><li class="tab"><button type="button" data-href="#super-4">box-shadow属性（CSS3）</button></li><li class="tab"><button type="button" data-href="#super-5">outline属性</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>作用：更改用于计算元素宽&#x2F;高的默认的CSS盒模型</p><ul><li>content-box 默认值<ul><li>盒子实际宽度 &#x3D; padding + border + width</li><li>盒子实际高度 &#x3D; padding + border + height</li></ul></li><li>border-box 默认值<ul><li>盒子实际宽度 &#x3D; width</li><li>盒子实际高度 &#x3D; height</li></ul></li><li>inherit 从父元素继承</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>设置边框圆角<br>纯圆：50% 宽高一样<br>半圆角：<code>height/2 + px</code></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>作用：定义内容溢出后的处理方式（是否裁剪）。</p><ol><li>visible  &#x3D;&#x3D;&gt;   不做处理（溢出）</li><li>hidden   &#x3D;&#x3D;&gt;   隐藏溢出内容且不出现滚动条（直接裁剪）。</li><li>scroll   &#x3D;&#x3D;&gt;   隐藏溢出内容且溢出内容以滚动条方式呈现（间接裁剪）。</li><li>auto     &#x3D;&#x3D;&gt;   当内容没有溢出时不出现滚动条；当内容溢出容器时出现滚动条，按需出现滚动条。此为body对象和textarea的默认值。</li><li>clip     &#x3D;&#x3D;&gt;   当内联内容溢出块容器时，将溢出部分裁剪。</li><li>ellipsis &#x3D;&#x3D;&gt;   当内联内容溢出块容器时，将溢出部分替换为（…）。</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>以逗号分割列表来描述一个或多个阴影效果。<br><img src="/image/CSS-%E8%87%AA%E5%AD%A6%E4%B9%8B%E8%B7%AF/1665326340716.png" alt="1665326340716"><br><code>box-shadow: 5px 5px 10px 0 rgba(0, 0, 0, .2);</code><br>属性值介绍：前两个是偏移量，第三个是模糊区域度，第四个是拓展区域度，第五个是颜色（最后一个是透明度）</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p>用来设置一个或多个单独的轮廓属性的简写属性。<br>轮廓和边框的区别：</p><blockquote><p>轮廓不占据空间，不影响布局，其被描绘在内容之上。<br><code>outline: [&lt;outline-width&gt; || &lt;outline-style&gt; || &lt;outline-color&gt;]</code><br><code>outline-width: &lt;length&gt; | thin | medium | thick</code><br><code>outline-style: solid | dashed | dotted | ...</code><br><code>outline-color: &lt;color&gt; | invert</code></p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="包含块——可视化格式模型"><a href="#包含块——可视化格式模型" class="headerlink" title="包含块——可视化格式模型"></a>包含块——可视化格式模型</h2><h3 id="包含块的确定"><a href="#包含块的确定" class="headerlink" title="包含块的确定"></a>包含块的确定</h3><p>确定一个元素的包含块的过程完全依赖于这个元素的 position 属性：</p><ol><li>static、relative、sticky：包含块可能由它的最近的祖先块元素的<strong>内容区</strong>的边缘组成。也可能会建立格式化上下文(比如说 table container, flex container, grid container, 或者是block container 自身)。</li><li>absolute：包含块就是由它的最近的 position 的值不是 static 的祖先元素的<strong>内边距区</strong>的边缘组成。<blockquote><p>❗注意以上两个，一个是内容区、一个是内容边距区</p></blockquote></li><li>fixed：在连续媒体的情况下包含块是窗口视图（viewport）,分页媒体下的情况下包含块是分页区域(page area)。</li><li>如果position值是absolute或fixed，包含块也可能是由满足以下条件的最近父级元素的<strong>内边距区</strong>的边缘组成的：<ol><li><code>transform</code> 或 <code>perspective</code> 的值不是 <code>none</code></li><li><code>will-change</code> 的值是 <code>transform</code> 或 <code>perspective</code></li><li><code>filter</code> 的值不是 <code>none</code> 或 <code>will-change</code> 的值是 <code>filter</code>(只在 Firefox 下生效)</li><li><code>contain</code> 的值是 <code>paint</code> (例如: <code>contain: paint;</code>)</li></ol></li></ol><h3 id="元素竖向的百分比设定是相对于容器的高度吗？"><a href="#元素竖向的百分比设定是相对于容器的高度吗？" class="headerlink" title="元素竖向的百分比设定是相对于容器的高度吗？"></a>元素竖向的百分比设定是相对于容器的高度吗？</h3><p>如果某些属性被赋予一个百分值的话，它的计算值是由这个元素的包含块计算而来的。这些属性包括盒模型属性和偏移属性：</p><ol><li>height、top、bottom：通过包含块的 height 的值。如果包含块的 height 值会根据它的内容变化，而且包含块的 position 属性的值被赋予 relative 或 static ，那么，这些值的计算值为 auto。</li><li>width、left、right、padding、margin 这些属性由包含块的 width 属性的值来计算它的百分值。<br>这里特别强调padding和margin讲的是上下左右四个都是根据包含块的width</li></ol><h2 id="块级格式化上下文BFC"><a href="#块级格式化上下文BFC" class="headerlink" title="块级格式化上下文BFC"></a>块级格式化上下文BFC</h2><a href="/posts/9c0bf13f/" title="块级格式化上下文BFC">块级格式化上下文BFC</a><h2 id="定位position"><a href="#定位position" class="headerlink" title="定位position"></a>定位position</h2><p><strong>注意：</strong></p><p><strong>如果设置了position属性，但是没有设置【top、left、right、bottom】属性，那么position属性不会生效。</strong></p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">默认值：static</button></li><li class="tab"><button type="button" data-href="#super-2">相对定位：relative</button></li><li class="tab"><button type="button" data-href="#super-3">绝对定位：absolute</button></li><li class="tab"><button type="button" data-href="#super-4">固定定位：fixed</button></li><li class="tab"><button type="button" data-href="#super-5">粘性定位：stricky</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>没有定位，元素出现在正常的流中</p><blockquote><p>此时 top, bottom, left, right，z-index属性无效）</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>相对于自身原本的位置进行定位</p><blockquote><p><code>top</code>、<code>bottom</code>、<code>left</code>、<code>right</code>生效<br>不脱离文档流，空间保留</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><ol><li>基于根元素进行定位<br>默认情况下，元素使用绝对定位之后，它是相对于浏览器屏幕左上角为参考点进行定位的，准确点说，是相对于浏览器内容可见区域的左上角为原点。</li><li>基于父级元素进行定位<br>需给父元素设置【position】属性，属性值取【relative、absolute、fixed、sticky】四种都可以。<br>若没有，向上级溯源，寻找最近的设置了【position】属性的祖先元素进行绝对定位（就近原则）。</li></ol><blockquote><p><code>top</code>、<code>bottom</code>、<code>left</code>、<code>right</code>生效<br>脱离文档流不占空间</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>相对于浏览器窗口进行定位，元素位置在窗口滚动时不变</p><blockquote><p><code>top</code>、<code>bottom</code>、<code>left</code>、<code>right</code>生效<br>脱离文档流</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p>在相对定位 <code>relative</code>和固定定位 <code>fixed</code>之间切换。</p><blockquote><p>一旦元素窗口移动到设定的位置，就会固定定位。<br><code>top</code>、<code>bottom</code>、<code>left</code>、<code>right</code>生效</p></blockquote><p>sticky粘性定位不生效的原因</p><blockquote><p>父元素不能添加【overflow：hidden；】或者【overflow：auto；】属性值。<br>元素自身必须设置【top、left、right、bottom】四个属性之一，否则就相当于静态定位。<br>父元素的高度必须大于使用了sticky粘性定位元素的高度。<br>sticky定位只能够在其父元素里面生效。</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="内容布局方式"><a href="#内容布局方式" class="headerlink" title="内容布局方式"></a>内容布局方式</h2><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">float——浮动</button></li><li class="tab"><button type="button" data-href="#super-2">flexbox——弹性盒</button></li><li class="tab"><button type="button" data-href="#super-3">grid</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>早期布局方式，通过元素浮动方式，需要清除浮动<br>详细内容：<a href="/posts/b1b6556a/" title="内容布局方式-float">内容布局方式-float</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>弹性布局，当前流行<br>任一容器都可以指定为flex布局，只要用 dispaly: flex; 进行设置。<br>目的：提供一种个更加高效的方式来对容器的条目进行布局、对齐和分配空间。<br>可以控制的弹性项如下：</p><ol><li>大小，基于内容可用空间</li><li>流动方向，水平&#x2F;垂直，正向&#x2F;反向</li><li>两条轴上的对齐与分布</li><li>顺序，与源代码中的顺序无关<br>缺点：对大型项目的支持不如bootstrap好，手机上兼容性有一定问题。<br>适用场景：</li><li>水平垂直居中</li><li>网站底部标签列表的布局，可以更好的控制上面列出的弹性项。<br>详细内容：<a href="/posts/d5b120e2/" title="内容布局方式">内容布局方式</a></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>网格布局，兼容不好</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p><img src="/image/CSS-%E8%87%AA%E5%AD%A6%E4%B9%8B%E8%B7%AF/1656850891347.png" alt="1656850891347"></p><h2 id="display与visibility"><a href="#display与visibility" class="headerlink" title="display与visibility"></a>display与visibility</h2><p>display：指定用于元素的呈现框的类型</p><h3 id="display常用属性值"><a href="#display常用属性值" class="headerlink" title="display常用属性值"></a>display常用属性值</h3><ol><li>none：指定对象为隐藏对象。与visibility属性的hidden值不同，被隐藏对象不保留其物理空间。</li><li>inline：指定对象为内联元素。</li><li>inline-block：指定对象为内联块级元素。</li><li>block：指定对象为块级元素。</li><li>flex：指定对象为弹性盒。</li><li>table:</li><li>list-term</li><li>inhert</li></ol><h3 id="display-none与visibility-hidden的区别"><a href="#display-none与visibility-hidden的区别" class="headerlink" title="display: none与visibility: hidden的区别"></a>display: none与visibility: hidden的区别</h3><ol><li><p>dispaly: none 不保留被隐藏对象的物理空间；<br>visibility: hidden 保留被隐藏对象的物理空间。</p></li><li><p>dispaly: none 隐藏该元素及其所有后代元素。给后代元素设置非none也没用。<br>visibility具有继承性，给父元素设置visibility: hidden；子元素也会继承这个属性。但是如果重新给子元素设置visibility: visible,则子元素又会显示出来。</p></li><li><p>浏览器渲染的时候会涉及到重绘与回流的问题，</p><ol><li>前者隐藏后脱离文档流，不占据页面空间引发回流</li><li>后者隐藏后还占用空间，只引起重绘。</li></ol><blockquote><p>因此优化时：建议用visibility: hidden替换display: none</p></blockquote></li><li><p>CSS3的transition支持visibility属性，但是不支持display</p><blockquote><p>由于transition可以延迟执行，因此可以配合visibility使用纯css实现hover延时显示效果。</p></blockquote></li></ol><h3 id="inline、block、inlineblock的区别"><a href="#inline、block、inlineblock的区别" class="headerlink" title="inline、block、inlineblock的区别"></a>inline、block、inlineblock的区别</h3><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">inline特点</button></li><li class="tab"><button type="button" data-href="#super-2">block特点</button></li><li class="tab"><button type="button" data-href="#super-3">inline-block特点</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><ol><li>内联元素会在一条直线上排列，在同一行从左至右水平排列。直到一行排不下，才会换行。</li><li>内联元素设置width、height、margin上下、padding上下无效（竖直无效）。</li><li>内联元素设置line-height，margin左右、padding左右有效（水平有效）。</li><li>内联元素的宽高随标签里的内容而变化。</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><ol><li>独占一行，多个block元素另起一行，默认情况下，block元素宽度自动填满其父元素宽度</li><li>block元素可以设置width、height属性。块元素即使设置了宽度，仍然是独占一行。</li><li>block元素可以设置margin和padding属性。</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>让block元素不再独占一行，多个block元素可以同排一行，且元素具有block的属性，可设置宽高</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><table><thead><tr><th align="center"></th><th align="center">默认宽度</th><th align="center">可设置宽高</th><th align="center">起始位置</th></tr></thead><tbody><tr><td align="center">inline</td><td align="center">内容宽度</td><td align="center">否</td><td align="center">同行</td></tr><tr><td align="center">block</td><td align="center">父级元素</td><td align="center">是</td><td align="center">换新行</td></tr><tr><td align="center">inline-block</td><td align="center">内容宽度</td><td align="center">是</td><td align="center">可与inline元素同行显示</td></tr></tbody></table><h3 id="display-inline-block-显示间隙"><a href="#display-inline-block-显示间隙" class="headerlink" title="display: inline-block 显示间隙"></a>display: inline-block 显示间隙</h3><p>在CSS布局中，如果我们想要将一些元素在同一行显示，其中的一种方法就是把要同行显示的元素设置display属性为inline-block。但是你会发现这些同行显示的inline-block元素之间经常会出现一定的空隙，这就是“换行符&#x2F;空格间隙问题”。</p><h3 id="CSS里的visibility属性有个collapse属性值？在不同浏览器下以后什么区别？"><a href="#CSS里的visibility属性有个collapse属性值？在不同浏览器下以后什么区别？" class="headerlink" title="CSS里的visibility属性有个collapse属性值？在不同浏览器下以后什么区别？"></a>CSS里的visibility属性有个collapse属性值？在不同浏览器下以后什么区别？</h3><p>对于一般的元素，它的表现跟hidden是一样的，位置还留着只是内容被隐藏了。</p><p>对于table相关的元素，例如table行，table group，table列，table column group，它的表现跟display: none一样，它们占用的空间也会释放。</p><ol><li>IE6及更早版本不支持。</li><li>在谷歌浏览器里，使用collapse值和使用hidden值没有什么区别。（我在chrome里试，是和下面列出的浏览器一样的，因此删掉这句话）</li><li>在火狐浏览器、Opera和IE11里，使用collapse值的效果就如它的字面意思：table的行会消失，它的下面一行会补充它的位置，及display: none效果。</li></ol><h2 id="变形"><a href="#变形" class="headerlink" title="变形"></a>变形</h2><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">transform</button></li><li class="tab"><button type="button" data-href="#super-2">transform-origin</button></li><li class="tab"><button type="button" data-href="#super-3">perspective</button></li><li class="tab"><button type="button" data-href="#super-4">transform-3d</button></li><li class="tab"><button type="button" data-href="#super-5">backface-visibility</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>四个常用功能—其实前三个最常用，最后一个基本用不到</p><ul><li><p>rotate()     &#x3D;&#x3D;&gt; 旋转</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">transform: rotate(<span class="number">45</span>deg)  <span class="regexp">//</span>默认沿着z轴顺时针旋转</span><br><span class="line"><span class="regexp">//</span> 右边可变为 rotateX<span class="regexp">/rotateY/</span>rotateZ 更改旋转中心轴</span><br></pre></td></tr></table></figure><p>经验：加单位deg</p></li><li><p>translate()  &#x3D;&#x3D;&gt; 平移</p><ul><li>translateX() &#x3D;&#x3D;&gt; 正值向右，负值向左</li><li>translateY() &#x3D;&#x3D;&gt; 正值向下，负值向上<br>语法：</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//n表示数字</span><br><span class="line"><span class="attribute">transform</span>: <span class="built_in">translateX</span>(npx);//加了这个属性的元素沿着X轴走了几像素</span><br><span class="line"><span class="attribute">transform</span>: translateY（npx）;//类似如上</span><br><span class="line"><span class="attribute">transform</span>: <span class="built_in">translateZ</span>(npx);//这个需要结合视距<span class="attribute">perspective</span>考虑</span><br></pre></td></tr></table></figure><p>经验一：</p><blockquote><p>要多查阅MDN文档</p></blockquote><p>经验二：</p><blockquote><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">left: <span class="number">50</span>%;</span><br><span class="line">top: <span class="number">50</span>%;</span><br><span class="line">translate(<span class="number">-50</span>%,<span class="number">-50</span>%);  <span class="comment">//这三句话可做绝对定位元素的居中</span></span><br></pre></td></tr></table></figure></blockquote></li><li><p>scale()      &#x3D;&#x3D;&gt; 胀缩</p><ul><li>scaleX(2)    &#x3D;&#x3D;&gt; 扩大两倍</li><li>scaleY(0.5)  &#x3D;&#x3D;&gt; 缩小两倍</li></ul></li><li><p>skew()       &#x3D;&#x3D;&gt; 倾斜</p><ul><li>skewX()      &#x3D;&#x3D;&gt; x轴不动，y轴向x轴倾斜</li><li>skewY()      &#x3D;&#x3D;&gt; y轴不动，x轴向y轴倾斜</li></ul></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>改变原来坐标轴的轴心</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>呈现空间感<br><code>perspective: none | &lt;length&gt;;</code><br><code>perspective-origin: ;</code></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><ul><li>translate3d()   &#x3D;&#x3D;&gt;<ul><li>translateX()          &#x3D;&#x3D;&gt;</li><li>translateY()          &#x3D;&#x3D;&gt;</li><li>translateZ(<code>&lt;length&gt;</code>)  &#x3D;&#x3D;&gt;</li></ul></li><li>scale3d()       &#x3D;&#x3D;&gt;<ul><li>scaleX(2)             &#x3D;&#x3D;&gt;</li><li>scaleY(0.5)           &#x3D;&#x3D;&gt;</li><li>scaleZ(0.5)           &#x3D;&#x3D;&gt;</li></ul></li><li>rotate3d()      &#x3D;&#x3D;&gt;<ul><li>rotateX()             &#x3D;&#x3D;&gt;</li><li>rotateY()             &#x3D;&#x3D;&gt;</li><li>rotateZ()             &#x3D;&#x3D;&gt;</li></ul></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p>图片背后内容是否可见<br><code>backface-visibility: visible | hidden;</code></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="动画"><a href="#动画" class="headerlink" title="动画"></a>动画</h2><p><a href="http://js.jirengu.com/wimavupixu/1/">我是代码实例</a></p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">transition</button></li><li class="tab"><button type="button" data-href="#super-2">animation</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><ul><li>过渡属性：一个属性从A值过渡到B值（补充中间帧）</li><li>最常用语法：<blockquote><p>transition: 属性名 过渡时长 过渡方式 延迟;</p></blockquote></li></ul><table><thead><tr><th align="center">属性</th><th align="center">属性值</th><th align="center">作用</th></tr></thead><tbody><tr><td align="center">transition-property</td><td align="center">属性名通常为all</td><td align="center">过渡属性</td></tr><tr><td align="center">transition-duration</td><td align="center"></td><td align="center">过渡时间</td></tr><tr><td align="center">transition-timing-function</td><td align="center">过渡方式最常用linear线性，ease非线性（默认）</td><td align="center">过渡方式</td></tr><tr><td align="center">transition-delay</td><td align="center">很少用</td><td align="center">延迟</td></tr></tbody></table><ul><li>经验：并不是所有属性都能过渡<br>例如</li></ul><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">display</span>: none/<span class="keyword">block</span>        ---&gt;</span> display: <span class="keyword">block</span>/none则没法过渡（元素不占位置）</span><br><span class="line"><span class="function"><span class="title">visibility</span>: hidden/visible ---&gt;</span> visibility: visible/hidden则可以过渡（元素占位置）</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>步骤：1.声明关键帧 2.添加动画</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">声明关键帧语法</button></li><li class="tab"><button type="button" data-href="#super-2">添加动画语法</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><img src="/image/CSS-%E8%87%AA%E5%AD%A6%E4%B9%8B%E8%B7%AF/1663898473754.png" alt="1663898473754"><br>左边的用不到，右边的最常用</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>缩写语法：<br><code>animation: 时长 | 过渡方式 | 延迟 | 次数 | 方向 | 填充模式 | 是否暂停 | 动画名;</code></p><table><thead><tr><th align="center">属性</th><th align="center">属性值</th><th align="center">作用</th></tr></thead><tbody><tr><td align="center">animation-duration</td><td align="center"></td><td align="center"></td></tr><tr><td align="center">animation-timing-function</td><td align="center"></td><td align="center"></td></tr><tr><td align="center">animation-delay</td><td align="center"></td><td align="center"></td></tr><tr><td align="center">animation-iteration-count</td><td align="center"></td><td align="center"></td></tr><tr><td align="center">animation-direction</td><td align="center">reverse&#x2F;alternate&#x2F;alternate-reverse</td><td align="center"></td></tr><tr><td align="center">animation-fill-mode</td><td align="center">none&#x2F;forwords&#x2F;backwords&#x2F;both</td><td align="center">规定动画在播放前后，其动画效果是否可见</td></tr><tr><td align="center">animation-play-state</td><td align="center">paused&#x2F;running</td><td align="center"></td></tr><tr><td align="center">animation-name</td><td align="center"></td><td align="center"></td></tr></tbody></table><blockquote><p>其中<br>时长，动画名必不可缺；<br>过渡方式 方向 次数 填充模式最常更改</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="响应式设计"><a href="#响应式设计" class="headerlink" title="响应式设计"></a>响应式设计</h2><h3 id="响应式设计、基本原理、兼容低版本的IE"><a href="#响应式设计、基本原理、兼容低版本的IE" class="headerlink" title="响应式设计、基本原理、兼容低版本的IE"></a>响应式设计、基本原理、兼容低版本的IE</h3><p>响应式网站设计：一个网站&#x2F;APP，其布局效果可以适用于多个终端屏幕尺寸。</p><p>基本原理：通过媒体查询检测不同的设备屏幕尺寸做处理。页面头部必须有meta声明的viewport。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><ol><li>设置viewport&#x2F;scale</li><li>使用非固定宽度</li><li>媒体查询-不同尺寸，不同样式</li><li>Rem单位</li><li>优先考虑移动端</li></ol><p>1、<code>@media (min-width: 501px) and (max-width: 768px) &#123; ×××; &#125;</code></p><p>2、<code>&lt;link rel=&quot;stylesheet&quot; media=&quot;screen and (max-width: 500px)&quot; href=&quot;./css/style.css&quot;&gt;</code></p><h2 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h2><h3 id="CSS优化、提高性能的方法有哪些？"><a href="#CSS优化、提高性能的方法有哪些？" class="headerlink" title="CSS优化、提高性能的方法有哪些？"></a>CSS优化、提高性能的方法有哪些？</h3><p><a href="https://juejin.im/post/5b6133a351882519d346853f">掘金 - CSS性能优化的8个技巧</a></p><p>主要从文件大小、影响渲染的因素（回流与重绘）两方面考虑。</p><h3 id="png、jpg、gif-这些图片格式解释一下，分别什么时候用。了解webp"><a href="#png、jpg、gif-这些图片格式解释一下，分别什么时候用。了解webp" class="headerlink" title="png、jpg、gif 这些图片格式解释一下，分别什么时候用。了解webp"></a>png、jpg、gif 这些图片格式解释一下，分别什么时候用。了解webp</h3><p>以下来源：<a href="https://juejin.im/book/5b936540f265da0a9624b04b/section/5b98ceb46fb9a05d3154f6bd">前端性能优化原理与实践-图片篇</a></p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">PNG</button></li><li class="tab"><button type="button" data-href="#super-2">JPG</button></li><li class="tab"><button type="button" data-href="#super-3">GIF</button></li><li class="tab"><button type="button" data-href="#super-4">WebP</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>关键词：无损压缩、质量高、体积大、支持透明<br>主要用来呈现小的 Logo、颜色简单且对比强烈的图片或背景等。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>关键字：有损压缩、体积小、加载快、不支持透明<br>经常作为大的背景图、轮播图或 Banner 图出现。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>一种位图文件格式，以8位色重现真色彩的图像。<br>可以实现动画效果</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>关键字：年轻的全能型选手<br>是 Google 专为 Web 开发的一种旨在加快图片加载速度的图片格式，它支持有损压缩和无损压缩。<br>WebP 像 JPEG 一样对细节丰富的图片信手拈来，像 PNG 一样支持透明，像 GIF 一样可以显示动态图片——它集多种图片文件格式的优点于一身。但兼容性差<br><a href="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200709142132788-1668237597.png"><img src="https://img2020.cnblogs.com/blog/1019981/202007/1019981-20200709142132788-1668237597.png"></a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="小概念"><a href="#小概念" class="headerlink" title="小概念"></a>小概念</h2><h3 id="浏览器的私有属性"><a href="#浏览器的私有属性" class="headerlink" title="浏览器的私有属性"></a>浏览器的私有属性</h3><table><thead><tr><th>浏览器</th><th>属性前缀</th></tr></thead><tbody><tr><td>chrome、safari</td><td>-webkit-</td></tr><tr><td>firefox</td><td>-moz-</td></tr><tr><td>IE</td><td>-ms-</td></tr><tr><td>opera</td><td>-o-</td></tr></tbody></table><h3 id="常见的-规则"><a href="#常见的-规则" class="headerlink" title="常见的@规则"></a>常见的@规则</h3><ol><li>@ 标识符 ×××;</li><li>@ 标识符 {};</li></ol><table><thead><tr><th>规则</th><th>作用</th><th>规则</th><th>作用</th></tr></thead><tbody><tr><td>@media</td><td>媒体查询</td><td>@import</td><td></td></tr><tr><td>@keyframes</td><td>动画制作</td><td>@namespace</td><td></td></tr><tr><td>@font-face</td><td>字体</td><td>@page</td><td></td></tr><tr><td>@charset</td><td>编码方式</td><td>@supports</td><td></td></tr><tr><td></td><td></td><td>@document</td><td></td></tr></tbody></table><h3 id="手动写动画，最小时间间隔？"><a href="#手动写动画，最小时间间隔？" class="headerlink" title="手动写动画，最小时间间隔？"></a>手动写动画，最小时间间隔？</h3><p>17ms，红宝书原话：</p><blockquote><p>大多数电脑显示器的刷新频率是60HZ，大概相当于每秒重绘60次。大多数浏览器都会对重绘操作加以限制，不超过显示器的重绘频率，因为即使超过那个频率用户体验也不会有提升。因此，最平滑动画的最佳循环间隔是1000ms&#x2F;60，大概相当于17ms。以这个循环间隔重绘的动画是最平滑的，因为这个速度是最接近浏览器的最高限速。为了适应17ms的循环间隔，多重动画可能需要加以节制，以便不会完成太快。</p></blockquote><h3 id="网页中应该使用奇数还是偶数的字体大小"><a href="#网页中应该使用奇数还是偶数的字体大小" class="headerlink" title="网页中应该使用奇数还是偶数的字体大小?"></a>网页中应该使用奇数还是偶数的字体大小?</h3><p>偶数。</p><ol><li>相对来说偶数字号比较容易和页面中其他部分的字号构成一个比例关系。</li><li>低版本的浏览器ie6会把奇数字体强制转化为偶数，即13px渲染为14px。</li><li>Windows 自带的点阵宋体（中易宋体）从 Vista 开始只提供 12、14、16 px 这三个大小的点阵，而 13、15、17 px 时用的是小一号的点阵（即每个字占的空间大了 1 px，但点阵没变），于是略显稀疏。</li></ol><h3 id="伪类和伪元素的区别"><a href="#伪类和伪元素的区别" class="headerlink" title="伪类和伪元素的区别"></a>伪类和伪元素的区别</h3><table><thead><tr><th>col1</th><th>伪类</th><th>伪元素</th></tr></thead><tbody><tr><td></td><td>根据元素的特征分类，而不是名字、属性、内容</td><td>建立对超出文档语言指定的文档树的抽象</td></tr><tr><td></td><td>可以出现在选择器的任何位置</td><td>只能跟在选择器的最后一个简单选择器后面</td></tr></tbody></table><p>在 <code>CSS3</code>的规范里，单冒号表示伪类，伪元素的语法被修改成使用双冒。伪元素并不存在与 <code>dom</code>中，只存在于页面之中。</p><ul><li>伪类本质上是为了弥补常规 <code>CSS</code>选择器的不足，以便获取到更多信息；</li><li>伪元素本质上是创建了一个有内容的虚拟容器；</li><li><code>CSS3</code>中伪类和伪元素的语法不同；</li><li>可以同时使用多个伪类，而只能同时使用一个伪元素。</li><li>都不会出现在源文档或者文档树中</li></ul><h3 id="常见的兼容性问题"><a href="#常见的兼容性问题" class="headerlink" title="常见的兼容性问题"></a>常见的兼容性问题</h3><h3 id="善于使用父元素的padding而不使用子元素的margin"><a href="#善于使用父元素的padding而不使用子元素的margin" class="headerlink" title="善于使用父元素的padding而不使用子元素的margin"></a>善于使用父元素的padding而不使用子元素的margin</h3><p>margin属性本意用于来描述兄弟与兄弟元素之间的关系不是用于描述父子元素之间的关系。</p><p>描述父子元素的关系最好使用给其父元素设置 padding 属性。</p><h3 id="color属性"><a href="#color属性" class="headerlink" title="color属性"></a>color属性</h3><p>三种描述方式</p><ul><li>RGBRed（红）Green（绿）Blue（蓝）</li><li>RGBARed（红）Green（绿）Blue（蓝）Alpha（0~1）</li><li>HEX#RRGGBB（每一位16进制表示）</li></ul><h3 id="background属性"><a href="#background属性" class="headerlink" title="background属性"></a>background属性</h3><p>background-color:</p><p>background-image: <code>&lt;image&gt; | url() | none;</code></p><p>background-repeat: repeat-x | repeated-y | [repeat | space | round | no-repeat]</p><p>background-attachment: scroll | fixed | local</p><p>background-position:</p><p>linear-gradient: 渐变</p><p>radial-gradient: 镜像渐变</p><p>repeating-gradient:</p><h2 id="布局应用及应用代码"><a href="#布局应用及应用代码" class="headerlink" title="布局应用及应用代码"></a>布局应用及应用代码</h2>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> CSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 自学之路 </tag>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Html-自学之路</title>
      <link href="/posts/be493c43/"/>
      <url>/posts/be493c43/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="Html页面的基础（文档）结构"><a href="#Html页面的基础（文档）结构" class="headerlink" title="Html页面的基础（文档）结构"></a>Html页面的基础（文档）结构</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// 文档声明</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span> </span><br><span class="line">  // 文档头部</span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-handlebars"><span class="language-xml"></span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml"></span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">  // 文档主体</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">  <span class="tag">&lt;<span class="name">body</span>&gt;</span> </span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>我的第⼀个标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span> </span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>我的第⼀个段落。<span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span> </span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span></span></span><br></pre></td></tr></table></figure><h3 id="文档声明"><a href="#文档声明" class="headerlink" title="文档声明"></a>文档声明</h3><h4 id="DTD（文档类型定义）"><a href="#DTD（文档类型定义）" class="headerlink" title="DTD（文档类型定义）"></a>DTD（文档类型定义）</h4><p><code>&lt;!DOCTYPE html&gt;</code></p><h4 id="DTD的文档类型"><a href="#DTD的文档类型" class="headerlink" title="DTD的文档类型"></a>DTD的文档类型</h4><p>三种文档类型：S（Strict）、T（Transitional）、F（Frameset）。</p><ul><li>Strict：如果需要干净的标记，免于表现层的混乱，请使用此类型。请与层叠样式表（CSS）配合使用。</li><li>Transitional：DTD 可包含 W3C 所期望移入样式表的呈现属性和元素。如果使用了不支持层叠样式表（CSS）的浏览器以至于不得不使用 HTML 的呈现特性时使用</li><li>Frameset： DTD 应当被用于带有框架的文档。除 frameset 元素取代了 body 元素之外，Frameset DTD 等同于 Transitional DTD</li></ul><p>html5基本上没有XHTML 1.0 Transitional严格的要求，并且简化了很多东西可以直接使用 <code>&lt;!DOCTYPE HTML&gt;</code></p><h4 id="DTD的作用"><a href="#DTD的作用" class="headerlink" title="DTD的作用"></a>DTD的作用</h4><ol><li>通过 DTD，每一个 XML 文件均可携带一个有关其自身格式的描述。</li><li>通过 DTD，独立的团体可一致地使用某个标准的 DTD 来交换数据。</li><li>应用程序可使用某个标准 DTD 来验证从外部接收到的数据。</li><li>可以使用 DTD 来验证自身数据。</li></ol><h3 id="文档头部"><a href="#文档头部" class="headerlink" title="文档头部"></a>文档头部</h3><ol><li><code>&lt;head&gt;</code>：网页头部，其内容不会出现在网页中，主要帮助浏览器或者搜索引擎来解析网页</li><li><code>&lt;meta&gt;</code>：设置网页的元数据</li></ol><blockquote><p>1、<code>&lt;meta charset=&quot;UTF-8&quot;&gt;</code>，解决中文乱码问题，<code>charset </code>是指定网页的字符集。</p><p>2、<code>name </code>：数据的属性名；<code>content</code>：指定数据的内容</p><ul><li><code>keywords</code>表示网站的关键字，当搜索’HTML5,前端,CSS3’这些关键词，就会出现我们编写的网页。例：<br><code>&lt;meta name=&quot;keywords&quot; content=&quot;HTML5,前端,CSS3&quot;&gt;</code></li><li><code>description</code>用于指定网站的描述,出现在搜索引擎的搜索结果中。例：<br><code>&lt;meta name=&quot;description&quot; content=&quot;这是一个不错的网站&quot;&gt;</code></li><li><code>author</code>表明作者信息。例：<br><code>&lt;meta name=&quot;author&quot; content=&quot;SuperQ&quot;&gt;</code></li><li><code>http-equiv</code>，意思是几秒后跳转到什么地址。例：<br><code>&lt;meta http-equiv=&quot;refresh&quot; content=&quot;秒数;url=跳转地址&quot;&gt;</code></li></ul></blockquote><ol start="3"><li><code>&lt;link&gt;</code>：用于外链资源</li><li><code>&lt;title&gt;</code>：其内容显示在浏览器的标题栏，搜索引擎根据title中的内容来判断网页的主要内容</li><li><code>&lt;style type=&quot;text/css&quot;&gt;</code>：用于内部样式</li><li><code>&lt;script&gt;</code>：用于加载脚本文件（如JavaScript）</li></ol><h3 id="文档主体"><a href="#文档主体" class="headerlink" title="文档主体"></a>文档主体</h3><p><code>&lt;body&gt;</code>：网页主体，网页中所有可见的内容都写在body里</p><h3 id="html注释"><a href="#html注释" class="headerlink" title="html注释"></a>html注释</h3><p>注释代码之前，我们先选定内容。</p><p>现在编译器非常强大， 我们将光标放在这里其实也可以，我们按下快捷键 <code>Ctrl+/</code>就可以成功注释。</p><p><code>&lt;!--- 这是注释内容 -&gt;</code></p><h2 id="SEO（搜索引擎优化）"><a href="#SEO（搜索引擎优化）" class="headerlink" title="SEO（搜索引擎优化）"></a>SEO（搜索引擎优化）</h2><h3 id="TDK-标签"><a href="#TDK-标签" class="headerlink" title="TDK 标签"></a>TDK 标签</h3><p>title、description、keywords</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">title 网站标题</button></li><li class="tab"><button type="button" data-href="#super-2">description 网站说明</button></li><li class="tab"><button type="button" data-href="#super-3">keywords 关键字</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>title 具有不可替代性，是我们网站内的第一个重要的标签，是搜索引擎了解网页的入口和对网页的入口主题归属的最佳判断点。因此如果我们想我们的网站被搜索引擎搜索到我们的这个title就不能乱写了。</p><ul><li>建议格式这样写：网站名（产品名）- 网站介绍（尽量不要超过30个汉字）<br><code>&lt;title&gt;京东(JD.COM)-正品低价、品质保障、配送及时、轻松购物！&lt;/title&gt;</code></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>提倡：description 作为网站的总体业务和主题概括， 一般采用“我们是…”、“我们提供…”、“电话： xxx”，一般这个具体内容不需要我们考虑，是由专门的SEO人员来写的。<br><code>&lt;meta name=&quot;description&quot; content=&quot;京东JD.COM-专业的综合网上购物商城,销售家电、数码通讯、电脑、家居百货、服装服饰、母婴、图书、食品等数万个品牌优质商品.便捷、诚信的服务，为您提供愉悦的网上购物体验!&quot;/&gt;</code></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>keywords是页面的关键词，也是搜索引擎关注点之一。<br>keywords最好限制为6~ 8个关键词,关键词之间用英文逗号隔开,采用关键词1,关键词2的形式。<br><code>&lt;meta name=&quot;Keywords&quot; content=&quot;网上购物,网上商城,手机,笔记本,电脑,MP3,CD,VCD,DV,相机,数码,配件,手表,存储卡,京东&quot; /&gt;</code></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="alt-属性"><a href="#alt-属性" class="headerlink" title="alt 属性"></a>alt 属性</h3><p>网页中的alt属性是用来对图片进行说明的，这里有两方面的作用，</p><ul><li>告诉搜索引擎图片的信息。</li><li>在图片加载不出来时，告诉我们这个图片大致时什么内容。</li></ul><blockquote><p>在网站中我们不能每个图片都加alt，最好的办法还是在网页中重点图片（logo等）使用alt标识，这样对搜索引擎爬行网页重要图片很有帮助，对于提高网站关键词权重也会很有好处的。</p></blockquote><h3 id="Logo-优化"><a href="#Logo-优化" class="headerlink" title="Logo 优化"></a>Logo 优化</h3><p>logo里面首先放一个h1标签，目的是为了提权，告诉搜索引擎，这个地方很重要。</p><p>h1 里面再放一一个链接，可以返回首页的，把logo的背景图片给链接即可</p><p>为了搜索引擎收录我们，我们链接里面要放文字(网站名称) ，但是文字不要显示出来。</p><blockquote><p>方法1：text-indent移到盒子外面( text-indent: -9999px) ,然后overflow:hidden ,淘宝的做法。<br>方法2：直接给font-size:0;就看不到文字了,京东的做法。<br>最后给链接一个title属性,这样鼠标放到logo上就可以看到提示文字了。</p></blockquote><h3 id="HTML-语义化"><a href="#HTML-语义化" class="headerlink" title="HTML 语义化"></a>HTML 语义化</h3><p>由于<strong>搜索引擎</strong>直面<strong>网页HTML代码</strong>，如果代码具备语义化，搜索引擎就能直接读懂网页表达的意思。</p><blockquote><p>重要的文字使用 <code>strong</code>突出<br>合理使用各级的 <code>h标签</code><br>使用Html5新增的 <code>section</code>、<code>article</code>、<code>nav</code>等语义化标签</p></blockquote><h2 id="HTML语义化"><a href="#HTML语义化" class="headerlink" title="HTML语义化"></a>HTML语义化</h2><p>根据标签的语义，浏览器会给定一个默认样式。</p><blockquote><p>判断网页标签语义化是否良好的一个简单方法：去掉样式，看网页结构是否组织良好有序、是否仍具有可读性</p></blockquote><h3 id="语义化的作用"><a href="#语义化的作用" class="headerlink" title="语义化的作用"></a>语义化的作用</h3><p>1）用正确的标签做正确的事情；<br>2）让页面的内容结构化，结构更清晰，便于让浏览器、搜索引擎解析；<br>3）搜索引擎的爬虫依赖于HTML标记来确定上下文和各个关键字的权重，有利于SEO；<br>4）⽅便其他设备解析（如屏幕阅读器、盲⼈阅读器、移动设备）并渲染⽹页；<br>5）便于团队开发和维护，语义化更具可读性，遵循W3C标准的团队都遵循这个标准，可以减少差异化。</p><h3 id="语义化使用注意点"><a href="#语义化使用注意点" class="headerlink" title="语义化使用注意点"></a>语义化使用注意点</h3><ol><li>尽可能少使用无语义 <code>span</code>和 <code>div</code>标签</li><li>在语义不明显，既可以使用 <code>p</code>也可以使用 <code>div</code>的地方 &#x3D;&#x3D;&gt; 尽量用 <code>p</code>(<code>p</code>在默认情况下有上下间距，对兼容特殊终端有利)</li><li>不要使用纯样式标签，如 <code>b</code>、<code>u</code> &#x3D;&#x3D;&gt; 改用 <code>CSS</code>设置</li><li>需要强调的文本，可以包含在 <code>strong</code>或者 <code>em</code>标签中，<code>strong</code>默认样式是加粗（不要用 <code>b</code>），<code>em</code>默认样式是斜体（不用 <code>i</code>）</li><li>使用表格时：<ul><li>标题要用 <code>caption</code></li><li>表头用 <code>thead</code></li><li>主体部分用 <code>tbody</code>包围</li><li>尾部用 <code>tfoot</code>包围<br>表头和单元格要区分开，表头用 <code>th</code>，单元格用 <code>td</code></li></ul></li><li>表单域用 <code>fieldset</code>标签包起来，并用 <code>legend</code>标签说明表单的用途</li><li><code>input</code>标签对应的说明文本需要使用到 <code>label</code>标签 &#x3D;&#x3D;&gt; <code>input</code>标签设置 <code>id</code>属性 + <code>label</code>标签设置 <code>for=someId</code> &#x3D; 说明文本和相对应的 <code>input</code>相关联</li></ol><h2 id="空-void-元素-x2F-行内元素-x2F-块级元素"><a href="#空-void-元素-x2F-行内元素-x2F-块级元素" class="headerlink" title="空(void)元素&#x2F;行内元素&#x2F;块级元素"></a>空(void)元素&#x2F;行内元素&#x2F;块级元素</h2><h3 id="常见空、行内、块内、行内块级元素"><a href="#常见空、行内、块内、行内块级元素" class="headerlink" title="常见空、行内、块内、行内块级元素"></a>常见空、行内、块内、行内块级元素</h3><a href="/posts/a241b8cb/" title="常见空、行内、块内、行内块级元素">常见空、行内、块内、行内块级元素</a><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">空元素</button></li><li class="tab"><button type="button" data-href="#super-2">行内元素（内联标签）</button></li><li class="tab"><button type="button" data-href="#super-3">块级元素</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>定义：没有HTML内容的标签。<br>特征：在开始标签中闭合，例如 <code>&lt;br /&gt;</code>。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>声明方式：通过设置css的 <code>display:inline;</code>和 <code>float</code>。<br>特征：<br>1.和其他元素都在一行上<br>2.高、行高及外边距和内边距部分可改变<br>3.宽度只与内容有关<br>4.行内元素只能容纳文本或者其他行内元素</p><p>不可以设置宽高，其宽度随着内容增加，高度随字体大小而改变，内联元素可以设置外边界，但是外边界不对上下起作用，只能对左右起作用。</p><blockquote><p>水平方向的padding-left、padding-right、margin-left、margin-right都产生边距效果<br>竖直方向的padding-top、padding-bottom、margin-top、margin-bottom却不会产生边距效果</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><ul><li>非块级可通过css的display: block;将其更改为块级元素；</li><li>float也具有此功能。<br>1.总在新行上开始，占据一整行<br>2.默认情况下，其宽度自动填满其父元素宽度<br>3.宽度始终是与浏览器宽度一样，与内容无关<br>4.它可以容纳内联元素和其他块元素<br>5.display属性为block</li></ul><blockquote><p>块级元素的垂直相邻外边距margin会合并。</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="行内元素和块级元素有什么区别？"><a href="#行内元素和块级元素有什么区别？" class="headerlink" title="行内元素和块级元素有什么区别？"></a>行内元素和块级元素有什么区别？</h2><p>1.行内元素会在一条直线上排列（默认宽度只与内容有关），都是同一行的，水平方向排列。块级元素各占据一行（默认宽度为父元素的100%），垂直方向排列。块级元素从新行开始，结束接着一个断行。<br>2.块级元素可以包含行内元素和块级元素。行内元素不能包含块级元素，只能包含文本或者其它行内元素。<br>3.行内元素设置width无效，height无效(可以设置line-height)，margin上下无效，padding上下无效</p><h2 id="块级元素和内联元素之间的转换"><a href="#块级元素和内联元素之间的转换" class="headerlink" title="块级元素和内联元素之间的转换"></a>块级元素和内联元素之间的转换</h2><h3 id="1-display"><a href="#1-display" class="headerlink" title="1.display"></a>1.display</h3><p>块元素默认display: block;<br>行内非替换元素(a,span)默认为display：inline;<br>行内替换元素(input)默认为display: inline-block;</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">a</span><span class="selector-class">.display</span>: none;      <span class="comment">/*不显示该元素，也不会保留该元素原先占有的文档流位置。*/</span></span><br><span class="line"><span class="selector-tag">b</span><span class="selector-class">.display</span>: block;     <span class="comment">/*转换为块级元素。*/</span></span><br><span class="line">c<span class="selector-class">.display</span>: inline;     <span class="comment">/*转换为行内元素。*/</span></span><br><span class="line">d<span class="selector-class">.display</span>: inline-block;<span class="comment">/*转换为行内块级元素。其实仍为行内元素，但是可以设置width及height属性等*/</span></span><br></pre></td></tr></table></figure><h3 id="2-float"><a href="#2-float" class="headerlink" title="2.float"></a>2.float</h3><p>当把行内元素设置完float:left&#x2F;right后，该行内元素的display属性会被赋予block值，且拥有浮动特性。行内元素去除了之间的莫名空白。</p><h3 id="3-position"><a href="#3-position" class="headerlink" title="3.position"></a>3.position</h3><p>当为行内元素进行定位时，position:absolute与position:fixed.都会使得原先的行内元素变为块级元素。</p><h2 id="常用实体字符"><a href="#常用实体字符" class="headerlink" title="常用实体字符"></a>常用实体字符</h2><table><thead><tr><th align="center">实体字符</th><th align="center">编码</th><th>编号</th></tr></thead><tbody><tr><td align="center">空格</td><td align="center">&amp;nbsp;</td><td>&amp;#60</td></tr><tr><td align="center">“</td><td align="center">&quot;</td><td>&amp;#34</td></tr><tr><td align="center">&gt;</td><td align="center">&gt;</td><td>&amp;#62</td></tr><tr><td align="center">&lt;</td><td align="center">&lt;</td><td>&amp;#60</td></tr><tr><td align="center">©</td><td align="center">&amp;copy;</td><td>&amp;#169</td></tr><tr><td align="center">&amp;</td><td align="center">&amp;</td><td>&amp;#38</td></tr></tbody></table><h2 id="样式-x2F-脚本链入方式"><a href="#样式-x2F-脚本链入方式" class="headerlink" title="样式&#x2F;脚本链入方式"></a>样式&#x2F;脚本链入方式</h2><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">样式导入方式</button></li><li class="tab"><button type="button" data-href="#super-2">脚本导入方式</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><table><thead><tr><th align="center"></th><th align="center">行内样式</th><th align="center">内联样式表</th><th align="center">外联样式表</th></tr></thead><tbody><tr><td align="center"></td><td align="center">inline style</td><td align="center">internal style sheet</td><td align="center">external style sheet</td></tr><tr><td align="center">方法</td><td align="center">直接写入元素的style属性</td><td align="center"><code>&lt;style&gt;&lt;/style&gt;</code>代码块</td><td align="center"><code>&lt;link&gt;</code>导入外部文件</td></tr><tr><td align="center">特点</td><td align="center">大量重复代码，无法复用<br /> 特殊效果无法实现（比如鼠标移入的hover效果）</td><td align="center"></td><td align="center"></td></tr></tbody></table><p>外联样式表<br><code>&lt;link rel=&quot;stylesheet&quot; href=&quot;style.css&quot; type=&quot;text/css&quot; media=&quot;all&quot;&gt;</code></p><blockquote><ul><li>rel&#x3D;”stylesheet”  &#x3D;&#x3D;&gt; 当前文档与资源的关系（stylesheet、icon）</li><li>href&#x3D;”style.css”  &#x3D;&#x3D;&gt; 外链资源的目标地址（.css、.png）</li><li>type&#x3D;”text&#x2F;css”   &#x3D;&#x3D;&gt; 外链资源的MIME地址(text&#x2F;css、image&#x2F;png)</li><li>media&#x3D;”all”       &#x3D;&#x3D;&gt; 对资源生效的媒体设备</li></ul></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><table><thead><tr><th align="center"></th><th align="center">行内脚本</th><th align="center">内联脚本</th><th align="center">外联脚本</th></tr></thead><tbody><tr><td align="center"></td><td align="center">inline script</td><td align="center">internal script</td><td align="center">external script</td></tr><tr><td align="center">方法</td><td align="center">on[EventName]事件触发</td><td align="center"><code>&lt;script&gt;&lt;/script&gt;</code>代码块</td><td align="center"><code>&lt;scrpit&gt;&lt;/script&gt;</code>导入外部文件</td></tr></tbody></table><p>外联脚本：<br><code>&lt;script src=&quot;app.js&quot; type=&quot;text/javascript&quot; charset=&quot;utf-8&quot; crossorigin=&quot;anonymous&quot; async defer&gt;&lt;/script&gt;</code></p><blockquote><ul><li>src&#x3D;”app.js”            &#x3D;&#x3D;&gt; 脚本目标地址</li><li>type&#x3D;”text&#x2F;javascript”  &#x3D;&#x3D;&gt; 脚本类型</li><li>charset&#x3D;”utf-8”         &#x3D;&#x3D;&gt; 脚本编码地址</li><li>crossorigin&#x3D;”anonymous” &#x3D;&#x3D;&gt; 跨域时的脚本处理方式</li><li>async&#x2F;defer             &#x3D;&#x3D;&gt; 脚本执行方式<blockquote><p>async：立即执行<br>defer：HTML解析完成后执行<br>布尔属性<br>并行加载脚本<br>同时设置时，优先考虑async规则</p></blockquote></li></ul></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> Html </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Html </tag>
            
            <tag> 自学之路 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Html5新特性</title>
      <link href="/posts/32da561b/"/>
      <url>/posts/32da561b/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="HTML5新增特性"><a href="#HTML5新增特性" class="headerlink" title="HTML5新增特性"></a>HTML5新增特性</h3><ol><li>绘画元素<br><code>&lt;canvas&gt;</code>、<code>&lt;svg&gt;</code></li><li>媒体播放元素<br><code>&lt;video&gt;</code>、<code>&lt;audio&gt;</code></li><li><code>web</code>存储方式<br><code>localStorage</code>、<code>sessionStorage</code></li><li>新增语义化标签<br><code>&lt;header&gt;</code>、<code>&lt;nav&gt;</code>、<code>&lt;article&gt;</code>、<code>&lt;section&gt;</code>、<code>&lt;footer&gt;</code>、<code>&lt;aside&gt;</code>、<code>&lt;figcaption&gt;</code>、<code>&lt;figure&gt;</code></li><li>新增 <code>input</code>类型<br><code>calendar</code>、<code>email</code>、<code>url</code>、<code>search</code>、<code>Date pickers(date、month、week、time、datetime、datetime-local)</code>、<code>color</code>、<code>number</code></li><li>新增表单元素<br><code>datalist</code>、<code>keygen</code>、<code>output</code></li><li>新增控件元素<br><code>webworker</code>、<code>websockt</code>、<code>Geolocation</code></li><li>移除元素<ol><li>显现层元素：<code>basefont</code>、<code>big</code>、<code>center</code>、<code>font</code>、<code>s</code>、<code>strike</code>、<code>tt</code>、<code>u</code></li><li>产生负面影响的元素：<code>frame</code>、<code>frameset</code>、<code>noframes</code></li></ol></li></ol><h3 id="新增语义化标签"><a href="#新增语义化标签" class="headerlink" title="新增语义化标签"></a>新增语义化标签</h3><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">header</button></li><li class="tab"><button type="button" data-href="#super-2">nav</button></li><li class="tab"><button type="button" data-href="#super-3">article</button></li><li class="tab"><button type="button" data-href="#super-4">section</button></li><li class="tab"><button type="button" data-href="#super-5">footer</button></li><li class="tab"><button type="button" data-href="#super-6">aside</button></li><li class="tab"><button type="button" data-href="#super-7">figcaption</button></li><li class="tab"><button type="button" data-href="#super-8">figure</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-6"><ul><li>表示一个和其余页面内容几乎无关的部分</li><li>主要场景<ol><li>包含在article标签中作为主要内容的附属信息<ul><li>参考资料</li><li>名称解释</li><li>相关引用</li><li>个人资料</li></ul></li><li>article标签之外，页面或者站点全局的附属信息<ul><li>侧边栏</li><li>广告</li></ul></li></ol></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-7"><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-8"><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="video-x2F-audio标签的属性"><a href="#video-x2F-audio标签的属性" class="headerlink" title="video&#x2F;audio标签的属性"></a>video&#x2F;audio标签的属性</h3><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">video标签</button></li><li class="tab"><button type="button" data-href="#super-2">audio标签</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><code>controls=&quot;×××&quot;</code><br><img src="https://img-blog.csdn.net/20151204222806382" alt="这里写图片描述"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><code>control=&quot;×××&quot;</code><br><img src="https://img-blog.csdn.net/20151204224049494" alt="这里写图片描述"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="Html5拖放——拖放（drag和drop）"><a href="#Html5拖放——拖放（drag和drop）" class="headerlink" title="Html5拖放——拖放（drag和drop）"></a>Html5拖放——拖放（drag和drop）</h3><p>拖动相关设置：<br>（1）设置元素为可拖放：<br>把 draggable 属性设置为 true ：<br>   <code>&lt;img draggable=&quot;true&quot; /&gt;</code><br>（2）规定拖动元素：<br>ondragstart 和 setData()</p><p>ondragstart 属性调用了一个函数，drag(event)，它规定了被拖动的数据<br>dataTransfer.setData() 方法设置被拖数据的数据类型和值：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">drag</span>(<span class="params">ev</span>) &#123;</span><br><span class="line">   ev.<span class="property">dataTransfer</span>.<span class="title function_">setData</span>(<span class="string">&quot;Text&quot;</span>, ev.<span class="property">target</span>.<span class="property">id</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>数据类型是 “Text”，值是可拖动元素的 id (“drag1”)</p><p>（3）放到何处 - ondragover：</p><p>ondragover 事件规定在何处放置被拖动的数据；</p><p>默认地，无法将数据&#x2F;元素放置到其他元素中。如果需要设置允许放置，我们必须阻止对元素的默认处理方式。</p><p>调用 ondragover 事件的 event.preventDefault() 方法：<br><code>event.preventDefault()</code><br>（4）进行放置 - ondrop：</p><p>当放置被拖数据时，会发生 drop 事件；</p><p>ondrop 属性调用了一个函数，drop(event)：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">drop</span>(<span class="params">ev</span>) &#123;</span><br><span class="line">   ev.<span class="title function_">preventDefault</span>();</span><br><span class="line">   <span class="keyword">var</span> data=ev.<span class="property">dataTransfer</span>.<span class="title function_">getData</span>(<span class="string">&quot;Text&quot;</span>);</span><br><span class="line">   ev.<span class="property">target</span>.<span class="title function_">appendChild</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(data));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>（5）注意点：</p><p>a.调用 preventDefault() 来避免浏览器对数据的默认处理（drop 事件的默认行为是以链接形式打开）</p><p>b.通过 dataTransfer.getData(“Text”) 方法获得被拖的数据。该方法将返回在 setData() 方法中设置为相同类型的任何数据</p><p>c.被拖数据是被拖元素的 id (“drag1”)</p><p>d.把被拖元素追加到放置元素（目标元素）中</p><h3 id="Web数据存储"><a href="#Web数据存储" class="headerlink" title="Web数据存储"></a>Web数据存储</h3><ul><li>localStorage长期存储数据，浏览器关闭后数据不丢失</li><li>sessionStorage的数据在浏览器关闭后自动删除</li></ul><h3 id="input类型"><a href="#input类型" class="headerlink" title="input类型"></a>input类型</h3><p><code>type=&#39;×××&#39;</code></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> Html </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Html5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>语法-图标使用方法</title>
      <link href="/posts/42629f2c/"/>
      <url>/posts/42629f2c/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Font-Awesome图标"><a href="#Font-Awesome图标" class="headerlink" title="Font Awesome图标"></a>Font Awesome图标</h1><h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><p>要使用Font Awesome图标，请在HTML页面的 部分中添加以下行：</p><p>1、国内推荐 CDN：</p><p><code>&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.css&quot;&gt;</code></p><p>2、海外推荐 CDN</p><p><code>&lt;link rel=&quot;stylesheet&quot; href=&quot;**https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css&quot;&gt;</code></p><p>3、直接下载到本地</p><p><a href="https://static.runoob.com/download/font-awesome-4.7.0.zip">Download</a></p><blockquote><p><strong>注意：</strong> 不太建议下载来安装，直接在 html 文档头部引用 CDN 文件即可。</p><p><strong>注意：</strong> 本教程使用的是 4.7.0 版本。</p></blockquote><h2 id="图标类型"><a href="#图标类型" class="headerlink" title="图标类型"></a>图标类型</h2><p><a href="https://www.runoob.com/font-awesome/fontawesome-reference.html">Font Awesome 参考手册</a></p><p><a href="https://www.runoob.com/font-awesome/fontawesome-icons-brand.html">品牌图标</a></p><p><a href="https://www.runoob.com/font-awesome/fontawesome-icons-chart.html">图表图标</a></p><p><a href="https://www.runoob.com/font-awesome/fontawesome-icons-currency.html">货币图标</a></p><p><a href="https://www.runoob.com/font-awesome/fontawesome-icons-directional.html">方向图标</a></p><p><a href="https://www.runoob.com/font-awesome/fontawesome-icons-filetype.html">文件类型图标</a></p><p><a href="https://www.runoob.com/font-awesome/fontawesome-icons-form.html">表单图标</a></p><p><a href="https://www.runoob.com/font-awesome/fontawesome-icons-gender.html">性别图标</a></p><p><a href="https://www.runoob.com/font-awesome/fontawesome-icons-hand.html">手势图标</a></p><p><a href="https://www.runoob.com/font-awesome/ffontawesome-icons-medical.html">医疗图标</a></p><p><a href="https://www.runoob.com/font-awesome/fontawesome-icons-payment.html">付款图标</a></p><p><a href="https://www.runoob.com/font-awesome/fontawesome-icons-spinner.html">加载中图标</a></p><p><a href="https://www.runoob.com/font-awesome/fontawesome-icons-text.html">文本图标</a></p><p><a href="https://www.runoob.com/font-awesome/fontawesome-icons-transportation.html">交通工具图标</a></p><p><a href="https://www.runoob.com/font-awesome/fontawesome-icons-video.html">音&#x2F;视频图标</a></p><p><a href="https://www.runoob.com/font-awesome/fontawesome-icons-webapp.html">Web应用图标</a></p><h1 id="阿里云"><a href="#阿里云" class="headerlink" title="阿里云"></a>阿里云</h1><p><a href="https://www.iconfont.cn/home/index?spm=a313x.7781069.1998910419.2">参考</a></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> 语法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iconfont </tag>
            
            <tag> Font Awesome </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>暂定</title>
      <link href="/posts/224ee14b/"/>
      <url>/posts/224ee14b/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="使用link-rel-x3D-amp-34-shortcut-icon-amp-34-为网页标题加图标"><a href="#使用link-rel-x3D-amp-34-shortcut-icon-amp-34-为网页标题加图标" class="headerlink" title="使用link rel&#x3D;&amp;#34;shortcut icon&amp;#34;为网页标题加图标"></a>使用link rel&#x3D;&amp;#34;shortcut icon&amp;#34;为网页标题加图标</h2><p><code>&lt;title&gt;会员卡券&lt;/title&gt;</code></p><p><code>&lt;link rel=&quot;shortcut icon&quot; href=&quot;http://GT/img/favicon.png&quot; type=&quot;image/x-icon&quot;&gt;</code></p><p>实现的效果就是这样：</p><p><img src="https://images2017.cnblogs.com/blog/1074458/201709/1074458-20170908132851319-522668898.png"><img src="/image/%E5%B0%8F%E6%8A%80%E5%B7%A7/1655654996558.png" alt="1655654996558"><img src="https://images2017.cnblogs.com/blog/1074458/201709/1074458-20170908140017319-1056040699.png"><img src="https://images2017.cnblogs.com/blog/1074458/201709/1074458-20170908132851319-522668898.png"></p><p>添加收藏夹也会有</p><p><img src="https://images2017.cnblogs.com/blog/1074458/201709/1074458-20170908140017319-1056040699.png"><img src="/image/%E5%B0%8F%E6%8A%80%E5%B7%A7/1655655008921.png" alt="1655655008921"></p><p>通过查询资料，网络上有两种写法：</p><p>语句一：<br><code>code</code></p><p>语句二：</p><p><code>&lt;link rel=&quot;icon&quot; href=&quot;图片地址&quot; type=&quot;image/gif&quot; /&gt;</code></p><p><img src="https://images2017.cnblogs.com/blog/1074458/201709/1074458-20170908135100226-1038231165.png">type可以设置多种图片类型。如：gif&#x2F;png&#x2F;ico</p><p>一般的图标尺寸都是16px*16px</p><p><img src="https://images2017.cnblogs.com/blog/1074458/201709/1074458-20170908135100226-1038231165.png"><img src="/image/%E5%B0%8F%E6%8A%80%E5%B7%A7/1655655155244.png" alt="1655655155244"><img src="https://images2017.cnblogs.com/blog/1074458/201709/1074458-20170908135100226-1038231165.png"></p><p>静态的图标文件使用：</p><p><code>&lt;link rel=&quot;shortcut icon&quot; href=&quot;1.png&quot; type=&quot;image/x-icon&quot; /&gt;</code></p><p>动态图 gif（动画也是16*16）使用：</p><p><code>&lt;link rel=&quot;icon&quot; href=&quot;1.gif&quot; type=&quot;image/gif&quot; &gt;</code></p><p>关于shortcut icon和icon代码的区别介绍</p><p>有一个博客有写 <a href="http://blog.csdn.net/ssisse/article/details/51705626">http://blog.csdn.net/ssisse/article/details/51705626</a> 链接放在这里 方便以后看</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> 语法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> icon </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>计算机组成原理</title>
      <link href="/posts/8d4b7ae1/"/>
      <url>/posts/8d4b7ae1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script>]]></content>
      
      
      <categories>
          
          <category> 计算机基础 </category>
          
          <category> 组成原理 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 组成原理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据结构和算法</title>
      <link href="/posts/a3530314/"/>
      <url>/posts/a3530314/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="复杂度"><a href="#复杂度" class="headerlink" title="复杂度"></a>复杂度</h2><h3 id="大O表示法"><a href="#大O表示法" class="headerlink" title="大O表示法"></a>大O表示法</h3><ul><li>O(1) 常量阶</li><li>O(logn) 对数阶</li><li>O(n) 线性阶</li><li>O(nlogn) 线性对数阶</li><li>O(n²) 平方阶 O(n^k) K方阶</li><li>O(2^n) 指数阶</li><li>O(n!) 阶乘阶</li></ul><h3 id="复杂度-1"><a href="#复杂度-1" class="headerlink" title="复杂度"></a>复杂度</h3><p>时间复杂度<br>空间复杂度<br>最好时间复杂度：在最理想的情况下，执行这段代码的时间复杂度。<br>最坏时间复杂度：在最糟糕的情况下，执行这段代码的时间复杂度<br>平均时间复杂度：用代码在所有情况下执行的次数的加权平均值表示<br>平摊时间复杂度：在代码执行的所有复杂度情况中绝大部分是低级别的复杂度，个别情况是高级别复杂度且发生具有时序关系时，可以将个别高级别复杂度均摊到低级别复杂度上。基本上均摊结果就等于低级别复杂度。</p><p>刷题计划</p><ul><li><a href="https://security.feishu.cn/link/safety?target=https://leetcode-cn.com/study-plan/algorithms/?progress=2vmobjd&from=from_parent_mindnote&scene=ccm&logParams=%7B%22location%22:%22ccm_mindnote%22%7D&lang=zh-CN">「算法」 - 学习计划 - 力扣（LeetCode）全球极客挚爱的技术成长平台 (leetcode-cn.com)</a></li><li><a href="https://security.feishu.cn/link/safety?target=https://leetcode-cn.com/study-plan/data-structures/?from=from_parent_mindnote&scene=ccm&logParams=%7B%22location%22:%22ccm_mindnote%22%7D&lang=zh-CN">「数据结构」 - 学习计划 - 力扣（LeetCode）全球极客挚爱的技术成长平台 (leetcode-cn.com)</a></li><li><a href="https://security.feishu.cn/link/safety?target=https://leetcode-cn.com/study-plan/lcof/?from=from_parent_mindnote&scene=ccm&logParams=%7B%22location%22:%22ccm_mindnote%22%7D&lang=zh-CN">「剑指 Offer」 - 学习计划 - 力扣（LeetCode）全球极客挚爱的技术成长平台 (leetcode-cn.com)</a></li></ul><h2 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h2><h2 id="链表"><a href="#链表" class="headerlink" title="链表"></a>链表</h2><h3 id="单链表"><a href="#单链表" class="headerlink" title="单链表"></a>单链表</h3><h3 id="双链表"><a href="#双链表" class="headerlink" title="双链表"></a>双链表</h3><p>解题思路</p><blockquote><p>理解指针的引用和含义：将某个变量赋值给指针，实际上就是将这个变量的地址赋值给指针，或者反过来说，指针中存储了这个变量的内存地址，指向了这个变量，通过指针就能找到这个变量。</p></blockquote><ul><li>警惕指针丢失和内存泄漏</li><li>利用哨兵简化实现难度</li><li>重点留意边界条件处理</li><li>举例画图，辅助思考</li></ul><h2 id="队列"><a href="#队列" class="headerlink" title="队列"></a>队列</h2><h2 id="栈"><a href="#栈" class="headerlink" title="栈"></a>栈</h2><p>特点：先进后出，后进先出</p><h2 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h2><p>冒泡排序<br>插入排序<br>选择排序<br>快速排序<br>归并排序<br>堆排序</p><ul><li>堆必须是个完全二叉树</li><li>堆中的每个节点的值必须 ≥ 或者 ≤ 每个子节点的值<br>希尔排序</li></ul><h2 id="搜索"><a href="#搜索" class="headerlink" title="搜索"></a>搜索</h2><h3 id="BFC-广度优先遍历"><a href="#BFC-广度优先遍历" class="headerlink" title="BFC 广度优先遍历"></a>BFC 广度优先遍历</h3><h3 id="DFS-深度优先遍历"><a href="#DFS-深度优先遍历" class="headerlink" title="DFS 深度优先遍历"></a>DFS 深度优先遍历</h3><h2 id="树"><a href="#树" class="headerlink" title="树"></a>树</h2><p><img src="/image/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95/1656860209180.png" alt="1656860209180"><br><img src="/image/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95/1656860343948.png" alt="1656860343948"></p><ul><li>满二叉树：除根节点以外，每个子节点都有2个叶子节点</li><li>完全二叉树：除最后一层节点外，上层节点必须达到最大，并且最后一层子节点向左排列</li><li>二叉搜索树<ul><li>特点：在树中任意一个节点，左边的每个节点，都要小于这个节点，而右边的都要大于这个节点</li><li>优点：支持快速查找、插入、删除等</li><li>缺点：针对有重复数据的情况下，查找、插入、删除的时间复杂度会和高度成正比，会退化成链表和完全二叉树，所以就有了平衡二叉树</li></ul></li></ul><h3 id="遍历方式"><a href="#遍历方式" class="headerlink" title="遍历方式"></a>遍历方式</h3><ul><li>前序：先打印当前叶子根节点，在打印他的左叶子节点，然后是右叶子节点</li><li>中序：先打印它的左叶子节点，然后打印当前叶子节点的跟节点，最后打印右节点</li><li>后序：先打印它的左叶子节点，然后打印右叶子节点，最后打印跟节点</li><li>层序遍历<br><img src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/all/boxcnirG2vXyY4TgXxJJ2G0Cbpf?mount_node_token=bmncnsQc1yLWkuqlAXdRvQuG5kg&mount_point=mindnote_image" alt="img"><img src="/image/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95/1656860359582.png" alt="1656860359582"></li></ul><p>平衡二叉树：二叉树中任意一个节点的左右子树的高度相差不能大于1</p><p>红黑树<br>特点</p><ul><li>跟节点是黑色的</li><li>每个叶子节点都是黑色的null节点，也就是说，红色节点是被黑色节点隔开的</li><li>每个节点，从该节点到达其可达叶子节点的所有路径，都包含相同数目的黑色节点</li></ul><h2 id="图"><a href="#图" class="headerlink" title="图"></a><a href="https://ufkqhva2uf.feishu.cn/docs/doccnwHXBILHprsioNn6p3n69Oq?from=from_parent_mindnote">图</a></h2><p>树中的元素被称为节点，而图中的元素则被称为顶点，图中的一个顶点与任意其他顶点建立连接关系，这种关系被称为边，跟顶点相连接的边的条数被称为度。</p><h3 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h3><p>有向图：边有方向<br>无向图：边没有方向<br>带权图：每条边都有一个权重，可以通过权重来表示关系</p><h3 id="邻接矩阵存储"><a href="#邻接矩阵存储" class="headerlink" title="邻接矩阵存储"></a>邻接矩阵存储</h3><p>邻接矩阵是通过二维数组去存储的</p><p>无向图</p><ul><li>如果顶点 i 和顶点 j 之间有边，我们就将 A[i][j] 和 A[j][i] 标记为1</li></ul><p>有向图</p><ul><li>如果顶点 i 和顶点 j 之间，有一条箭头从顶点 i 指向顶点 j 的边，那我们就将 A[i][j] 标记为1，同理，从顶点 J 指向顶点 I，那就将 A[J][I] 标记为1</li></ul><p>带权图</p><ul><li>数组中就存储相应的权重<br><img src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/all/boxcn1iFGEiKbs8og0iWrkOo4O5?mount_node_token=bmncnsQc1yLWkuqlAXdRvQuG5kg&mount_point=mindnote_image">优点</li><li>存储方式简单，直接，基于数组，在获取两个顶点的关系时，非常高效</li><li>方便计算，通过邻接矩阵存储图，可以将很多图的运算转换为矩阵之间的运算<br>缺点</li><li>如果存储的是顶点很多，单每个顶点的边并不多，就会造成空间浪费</li></ul><h3 id="邻接表"><a href="#邻接表" class="headerlink" title="邻接表"></a>邻接表</h3><h2 id="动态规划-DP"><a href="#动态规划-DP" class="headerlink" title="动态规划 DP"></a>动态规划 DP</h2><p><a href="https://security.feishu.cn/link/safety?target=https://oi-wiki.org/dp/basic/?from=from_parent_mindnote&scene=ccm&logParams=%7B%22location%22:%22ccm_mindnote%22%7D&lang=zh-CN">动态规划基础 - OI Wiki (oi-wiki.org)</a></p><h2 id="贪心算法"><a href="#贪心算法" class="headerlink" title="贪心算法"></a>贪心算法</h2><h2 id="二分查找"><a href="#二分查找" class="headerlink" title="二分查找"></a><a href="https://ufkqhva2uf.feishu.cn/docs/doccnE9dRmuvBzAgqgEqPgUiICh?from=from_parent_mindnote">二分查找</a></h2><p>二分查找是通过每次计算数组中间的值，并通过low和high记录一个最高和最低值，并且每次循环计算的时候，不算缩小low和high的差距，最终并返回结果<br>二分查找适合有序的数组，时间复杂度为O(logn)</p>]]></content>
      
      
      <categories>
          
          <category> 计算机基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构和算法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据库</title>
      <link href="/posts/14ea6df7/"/>
      <url>/posts/14ea6df7/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="数据库绪论"><a href="#数据库绪论" class="headerlink" title="数据库绪论"></a>数据库绪论</h1><h2 id="1、简述三层模式、两级映射，分别有什么作用？"><a href="#1、简述三层模式、两级映射，分别有什么作用？" class="headerlink" title="1、简述三层模式、两级映射，分别有什么作用？"></a>1、简述三层模式、两级映射，分别有什么作用？</h2><p>模式（逻辑模式）：是数据库中全体数据的逻辑结构和特征的描述，是数据库系统模式结构的中间层，即不涉及数据的物理存储细节，也与具体应用程序开发工具语言无关。<br>外模式（用户模式）：是用户能看见和使用的局部数据的逻辑结构和特征描述，是与某一应用有关的数据的逻辑表示，是模式的子集，一个数据库可以有多个外模式。<br>内模式（存储模式）：数据物理结构和存储方式的描述，是数据在数据库内部的表示方式，如存储方式是按照某个属性升序存储，什么索引等。<br>外模式模式映像：当模式发生改变，数据库管理员对外模式模式映像作相应改变，可使外模式不变，从而应用程序不用修改。保证数据与程序的逻辑独立性。<br>模式内模式映像：当数据库的存储结构改变了，由数据库管理员对模式内模式映像作相应改变，可以保持模式不变，从而应用程序也不必改变，保证了数据与程序的物理独立性。<br>三级模式使用户能逻辑地抽象地处理数据而不关心数据在计算机内具体表示方式与存储方式，两级映像保证了数据库系统中的数据有较高的逻辑独立性和物理独立性。</p><h2 id="2、说出至少三种数据库类型（层次，网状，关系）并简要解释了一下"><a href="#2、说出至少三种数据库类型（层次，网状，关系）并简要解释了一下" class="headerlink" title="2、说出至少三种数据库类型（层次，网状，关系）并简要解释了一下"></a>2、说出至少三种数据库类型（层次，网状，关系）并简要解释了一下</h2><p>层次模型：用树形结构来表示各类实体以及实体间的联系，有且只有一个节点没有双亲节点（根节点），其他的都有且只有一个双亲节点。只能直接表示的是一对多联系。<br>优点：效率高结构清晰，性能优于关系数据库，不低于网状。<br>缺点：现实世界很多联系都不是层次的，如节点间多对多联系，还有一个节点具有多个双亲的情况都不好表示。</p><p>网状模型：对于非层次关系的联系，用层次表示非树形结构是很不直接的，网状模型可以很好的表示，它允许有一个以上的节点没有双亲，一个节点也可以有多个双亲，可以更直接地描述现实世界。<br>优点：更直接描述现实世界，性能也较好，存取效率也较高。<br>缺点：结构比较复杂不利于掌握，用户编程还得了解系统结构细节，加重了编程的负担。</p><p>关系模型：通常来看关系就是一张规范二维表，实体还是实体间的联系都用关系来表示，对数据的检索和更新结果也是关系。<br>优点：概念单一，用户易懂易用，而且存取路径是对用户透明的，从而有更高的数据独立性和安全性，也简化程序员的工作。<br>缺点：查询效率往往不如格式化数据模型，为了提高性能，增加开发DBMS难度。</p><h1 id="关系数据库"><a href="#关系数据库" class="headerlink" title="关系数据库"></a>关系数据库</h1><h2 id="3、简述关系与关系模式的区别。"><a href="#3、简述关系与关系模式的区别。" class="headerlink" title="3、简述关系与关系模式的区别。"></a>3、简述关系与关系模式的区别。</h2><p>关系实质是一张二维表，关系模式是对关系的描述，关系是关系模式在某一时刻的状态或内容。<br>关系模式是静态的、稳定的，而关系是动态的，随时间不断变化的，因为关系操作不断更新数据库中的数据。<br>通俗的说：关系是一张二维表，关系模式是表格的描述（表头），关系名是表名，元组是一行，属性是列，分量是一条记录中的一个列值。</p><h2 id="4、什么是关系数据库？关系和二维表有什么区别？"><a href="#4、什么是关系数据库？关系和二维表有什么区别？" class="headerlink" title="4、什么是关系数据库？关系和二维表有什么区别？"></a>4、什么是关系数据库？关系和二维表有什么区别？</h2><p>关系数据库，是建立在关系数据库模型基础上的数据库，借助于集合代数等概念和方法来处理数据库中的数据。<br>在关系模型中，数据结构表示为一个二维表，一个关系就是一个二维表（但不是任意一个二维表都能表示一个关系。表中的第一行通常称为属性名，表中的每一个元组和属性都是不可再分的，且元组的次序是无关紧要的。</p><h2 id="5、关系的完整性（实体完整性、参照完整性、用户自定义）和数据库主键的约束性"><a href="#5、关系的完整性（实体完整性、参照完整性、用户自定义）和数据库主键的约束性" class="headerlink" title="5、关系的完整性（实体完整性、参照完整性、用户自定义）和数据库主键的约束性"></a>5、关系的完整性（实体完整性、参照完整性、用户自定义）和数据库主键的约束性</h2><p>实体完整性：关系的主码不能取空值，如果主码由若干属性组成都不能为空。实体以主码作为唯一性标识。<br>参照完整性：一个关系中的外码，或者取空值（若属性组全为空），或者等于它参照的那个关系的主码值。<br>用户自定义完整性：针对具体关系数据库的约束。</p><h1 id="数据库语言SQL"><a href="#数据库语言SQL" class="headerlink" title="数据库语言SQL"></a>数据库语言SQL</h1><h2 id="6、什么是DDL、DML、DCL？（数据库语言有哪几种？）"><a href="#6、什么是DDL、DML、DCL？（数据库语言有哪几种？）" class="headerlink" title="6、什么是DDL、DML、DCL？（数据库语言有哪几种？）"></a>6、什么是DDL、DML、DCL？（数据库语言有哪几种？）</h2><p>数据定义语言（DDL）：Create、Drop、Alter<br>数据操纵语言（DML）：Insert、Update、Delete<br>数据控制语言（DCL）：Grant、Revoke<br>数据查询语言：Select</p><h2 id="7、什么是视图，有什么作用？在数据库哪层？"><a href="#7、什么是视图，有什么作用？在数据库哪层？" class="headerlink" title="7、什么是视图，有什么作用？在数据库哪层？"></a>7、什么是视图，有什么作用？在数据库哪层？</h2><p>视图：是从一个或几个基本表导出的表，是一个虚表，数据库只存放视图的定义，不存放视图对应的数据，数据仍放在原来的基本表，基本表数据改变，通过视图查询也改变了，</p><h1 id="数据库设计"><a href="#数据库设计" class="headerlink" title="数据库设计"></a>数据库设计</h1><h2 id="8、简述数据库设计的几个阶段"><a href="#8、简述数据库设计的几个阶段" class="headerlink" title="8、简述数据库设计的几个阶段"></a>8、简述数据库设计的几个阶段</h2><p>需求分析：详细调查现实世界要处理的对象，充分了解各种需求，在此基础确定新系统的功能。<br>概念结构设计：经常采用自顶向下需求分析，自底向上概念结构设计。对需求分析收集到的数据进行分类组织形成实体、实体的属性，确定实体之间联系，设计分E-R图。逐一设计分E-R图，最后将所有分E-R图综合成一个系统的E-R图。<br>逻辑结构设计：一般来讲把E-R图向关系模型转换，一个实体型转换为一个关系模式。一个一对一联系可以独立也可以和任意一端合并，一个一对多联系可以独立也可以和N端对应的关系模式合并，一个多对多联系独立转换为一个关系模式。对数据模型规范化，还根据具体需求设计相应的视图。<br>数据库物理设计：关系模式存取方法的选择，比如索引、聚簇、哈希等存储方式。还应该确定数据库的存取结构，目前许多计算机有多个磁盘或磁盘阵列，因此可以将表和索引放在不同的磁盘上，在查询时磁盘驱动器并行工作，可以提高物理IO读写效率，也可以将比较大的表放在两个磁盘上，以加快存取速度。<br>数据库的实施与维护：比如备份与恢复等待。</p><h2 id="9、什么是E-R图"><a href="#9、什么是E-R图" class="headerlink" title="9、什么是E-R图"></a>9、什么是E-R图</h2><p>E-R图：实体-联系图，在概念结构设计中，对需求分析收集到的数据进行分类组织,形成实体的属性，确定实体之间联系，设计E-R图。</p><h2 id="10、分别解释1NF、2NF、3NF、BCNF、4NF"><a href="#10、分别解释1NF、2NF、3NF、BCNF、4NF" class="headerlink" title="10、分别解释1NF、2NF、3NF、BCNF、4NF"></a>10、分别解释1NF、2NF、3NF、BCNF、4NF</h2><p>范式：关系数据库中的关系是要满足一定要求的，满足不同程度的要求的为不同范式。<br>规范化：一个低一级范式关系模式通过模式分解可以转化为若干个高一级范式的关系模式的集合。<br>1NF：满足最低要求的叫第一范式，每一个分量必须是一个不可分的数据项。<br>2NF：消除关系中的部分函数依赖就称为第二范式，部分函数依赖就是非主属性不完全依赖于码。<br>3NF：每一个非主属性既不部分依赖于码，也不传递依赖于码。<br>BCND：所有非主属性对每一个码都是完全函数依赖，没有任何属性完全依赖于非码的任何属性，就是除了码外一定不能有决定因素。</p><h1 id="数据库并发控制"><a href="#数据库并发控制" class="headerlink" title="数据库并发控制"></a>数据库并发控制</h1><h2 id="11、什么是事物，并发控制是保证事物的？"><a href="#11、什么是事物，并发控制是保证事物的？" class="headerlink" title="11、什么是事物，并发控制是保证事物的？"></a>11、什么是事物，并发控制是保证事物的？</h2><p>事物：是一系列的数据操作，这些操作要么全不做，要么全做，不可分割。运行过程中发生某种故障不能继续执行，全部回滚到开始状态。<br>并发控制中多个用户存取数据库时候可能会产生多个事物同时存取同一个数据的情况，不加控制就会破坏事物的一致性，为了保证事物的一致性所以进行并发控制。</p><h2 id="12、ACID（事物的四个性质）"><a href="#12、ACID（事物的四个性质）" class="headerlink" title="12、ACID（事物的四个性质）"></a>12、ACID（事物的四个性质）</h2><p>A原子性：要么都做，要么都不做。<br>C一致性：如果运行中发生故障，必须回滚。不能让数据不一致。比如两人转钱，一半坏了，不一致俩人都没有钱。<br>I隔离性：一个事物不能被其他事物干扰。<br>D持续性：事物一旦提交，他对数据库的改变就应该是永久的。接下来的操作和故障不应该对刚才结果有任何影响。</p><h2 id="13、数据库中锁有什么作用？什么是只读锁、什么是只写锁？"><a href="#13、数据库中锁有什么作用？什么是只读锁、什么是只写锁？" class="headerlink" title="13、数据库中锁有什么作用？什么是只读锁、什么是只写锁？"></a>13、数据库中锁有什么作用？什么是只读锁、什么是只写锁？</h2><p>一个事物对数据加锁可以保证事物的四个特性，加锁后其他事物不能更新此数据对象，不会产生数据不一致性。<br>写锁（排他锁&#x2F; X锁）：加写锁其他事物不能在对这个数据加任何类型锁，释放之前不能读取和修改。<br>读锁（共享锁&#x2F; S锁）：事物对数据加读锁，其他事物可以读但不可以修改，可以加读锁不能加写锁。</p><h2 id="14、什么是触发器，有什么作用？"><a href="#14、什么是触发器，有什么作用？" class="headerlink" title="14、什么是触发器，有什么作用？"></a>14、什么是触发器，有什么作用？</h2><p>用户定义在关系表上的一类由事件驱动的特殊过程，一旦定义了，用户对表的增、删、改操作均有数据库系统自动激活相应触发器<br>触发器可以分为语句触发器和行级触发器，触发器动作体是一个匿名PL&#x2F;SQL过程块，语句级触发器可以在语句执行前或后执行，而行级触发在触发器所影响的每一行触发一次。行触发器用户可以用new和old引用数据，语句级不能。</p><h2 id="15、什么是脏读？幻读？不可重复读？"><a href="#15、什么是脏读？幻读？不可重复读？" class="headerlink" title="15、什么是脏读？幻读？不可重复读？"></a>15、什么是脏读？幻读？不可重复读？</h2><p>1、脏读：事务 A 读取了事务 B 更新的数据，然后 B 回滚操作，那么 A 读取到的数据是脏数据<br>2、不可重复读：事务 A 多次读取同一数据，事务 B 在事务 A 多次读取的过程中，对数据作了更新并提交，导致事务 A 多次读取同一数据时，结果 不一致。<br>3、幻读：系统管理员 A 将数据库中所有学生的成绩从具体分数改为 ABCDE 等级，但是系统管理员 B 就在这个时候插入了一条具体分数的记录，当系统管理员 A 改结束后发现还有一条记录没有改过来，就好像发生了幻觉一样，这就叫幻读。<br>不可重复读侧重于修改，幻读侧重于新增或删除（多了或少量行），脏读是一个事务回滚影响另外一个事务。</p><h2 id="补：什么是活锁和死锁？解决办法是什么？"><a href="#补：什么是活锁和死锁？解决办法是什么？" class="headerlink" title="补：什么是活锁和死锁？解决办法是什么？"></a>补：什么是活锁和死锁？解决办法是什么？</h2><p>1、 活锁：由于系统调度原因，某些事务的加锁请求得不到响应而永远等待下去，称为<br>活锁。<br>解决办法：采用合理的调度方法，如先来先服务策略。<br>2、死锁：两个或多个事务都已封锁了一些数据对象，然后又都请求对方被封锁的数据对象，两个事务永远不能结束，形成死锁。<br>预防：一次封锁法：要求每个事务必须一次将所有要使用的事务加锁，否则不能继续执行。<br>顺序封锁法：预先对数据对象规定一个封锁顺序，所有事务都按这个顺序实行封锁。<br>诊断与解除：超时法：如果一个事务的等待时间超过了规定的时限，就认为发生了死锁。<br>等待图法：等待图是一个有向图，正运行的事务表示节点，事务等待的情况表示边，如果图中存在回路，则表示系统中存在回路。</p>]]></content>
      
      
      <categories>
          
          <category> 计算机基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据库 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>操作系统</title>
      <link href="/posts/d04bd5bc/"/>
      <url>/posts/d04bd5bc/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="操作系统概述"><a href="#操作系统概述" class="headerlink" title="操作系统概述"></a>操作系统概述</h1><h2 id="35、操作系统用到了那些数据结构？举例说明"><a href="#35、操作系统用到了那些数据结构？举例说明" class="headerlink" title="35、操作系统用到了那些数据结构？举例说明"></a>35、操作系统用到了那些数据结构？举例说明</h2><p>进程调度后备队列，先进先出算法<br>短进程优先算法用了堆<br>动态分区分配，首次适应算法。在此算法中，空闲区链按起始地址递增顺序排列，在进行内存分配时，从链首开始顺序查找，直到找到一个能满足其大小要求的空闲区为止。循环首次适应算，循环链表。<br>目前广泛流行公用缓冲池，池中的缓冲区可供多个进程共享。它把相同类型的缓冲区链成一个队列<br>索引顺序文件：记录分组，索引表中为每组中的第一个记录建立一个索引项，组与组之间关键字必须有序，组中关键字可以无序。通过索引表找到所在组。<br>散列文件：没有 顺序特征。<br>文件分配磁盘块方式：链接分配，索引分配。<br>系统调用的过程？操作系统的组成？<br>内核提供一系列具备预定功能的多内核函数，通过一组称为系统调用（system call)的接口呈现给用户。系统调用把应用程序的请求传给内核，调用相应的的内核函数完成所需的处理，将处理结果返回给应用程序。<br>系统调用通常包括：进程控制、文件系统控制、内存管理、网络管理，进程通信等。<br>基本功能：处理机管理，处理器的分配和运行实施有效的管理，如进程控制，同步，通信，调度。存储器管理，对内存分配、保护、扩充。设备管理，对计算机系统内的所有设备实施有效管理，比如设备分配，缓冲和虚拟，设备传输控制，设备独立性。文件管理，有效的支持文件的存储、检索和修改等操作，解决文件的共享、保护问题，比如文件存储空间管理、目录管理、文件操作管理。用户接口，方便用户使用操作系统，通常有命令接口，程序接口，图形接口。</p><h2 id="36、什么是微内核？-什么是shell？"><a href="#36、什么是微内核？-什么是shell？" class="headerlink" title="36、什么是微内核？ 什么是shell？"></a>36、什么是微内核？ 什么是shell？</h2><p>操作系统：操作系统是控制和管理整个计算机系统硬件和软件资源，并合理组织调度计算机的工作和资源分配。进程管理 存储管理 设备管理 文件管理<br>微内核：操作系统的一种体系结构，将最基本的功能保留在内核，基于客户服务器模式的微内核结构，将操作系统划分两大部分，微内核和服务器，把操作系统绝大部分功能都放在服务器中实现，交互借助于微内核通信。优点：每个服务进程允许在独立用户进程中，即每个服务器失败不会引起系统其他服务器崩溃，可靠性好。还具有良好的灵活性，可以方便增删服务功能，便于维护修改服务器代码不会影响其他部分，适合分布式处理的计算环境。缺点：效率不高，所有用户进程都要通过微内核相互通信。<br>Shell：编程人员通过系统调用，api接口来使用操作系统提供的功能，普通用户不编程，所以操作系统给普通用户提供一个shell与用户交互，shell就是覆盖在操作系统上的一个用户界面，可以是图形的比如window，也可以是文本，比如linux，用户可以输入命令操作系统，不是进行直接系统调用。</p><h1 id="进程管理"><a href="#进程管理" class="headerlink" title="进程管理"></a>进程管理</h1><h2 id="37、作业与进程的区别"><a href="#37、作业与进程的区别" class="headerlink" title="37、作业与进程的区别"></a>37、作业与进程的区别</h2><p>一个进程是一个程序对某个数据集的执行过程，是分配资源的基本单位。作业是用户需要计算机完成的某项任务，是要求计算机所做工作的集合。</p><h2 id="38、进程和程序有什么区别？"><a href="#38、进程和程序有什么区别？" class="headerlink" title="38、进程和程序有什么区别？"></a>38、进程和程序有什么区别？</h2><p>进程是程序及其数据在计算机上的一次运行活动，是一个动态概念，而程序是一组有序的指令集合，是一种静态的概念<br>进程是程序的一次执行过程它是动态地创建和消亡的具有一定的生命周期是暂时存在的，程序则是一组代码集合，是永久存在可长期保存的。<br>进程可以创建进程，程序不能创建新程序。</p><h2 id="39、进程和线程有什么区别？什么是进程树？"><a href="#39、进程和线程有什么区别？什么是进程树？" class="headerlink" title="39、进程和线程有什么区别？什么是进程树？"></a>39、进程和线程有什么区别？什么是进程树？</h2><p>进程是资源拥有的基本单位，线程是独立调度的基本单位，而不用有系统资源，当可访问其隶属进程的系统资源，不仅进程之间可以并发，同一进程内的多个线程也能，进一步提高了并发度，由于创建和撤销进程系统都要为之分配或回收资源，保存当前环境等开销远大于创建或撤销线程。<br>进程树是一个形象化的比喻，比如一个进程启动了一个程序，而启动的这个进程就是原来那个进程的子进程，形成的一种树形的结构。</p><h2 id="40、简述进程的状态与转换"><a href="#40、简述进程的状态与转换" class="headerlink" title="40、简述进程的状态与转换"></a>40、简述进程的状态与转换</h2><p>新建完进程分配了必要资源，进入就绪状态，这时只需要得到处理就进程就能运行，进入运行状态后，需要等待某个资源进入阻塞状态，资源到位了进入就绪队列等待处理机。运行完事进入终止状态，资源回收。</p><h2 id="41、进程间的通信有几种方式？"><a href="#41、进程间的通信有几种方式？" class="headerlink" title="41、进程间的通信有几种方式？"></a>41、进程间的通信有几种方式？</h2><p>共享存储：在通信进程之间存在一块可直接访问的共享空间，通过对这段空间的读写实现进程之间的信息交换，在对共享空间进行写&#x2F;读操作时，需要使用同步互斥工具。<br>消息传递：数据交换是以格式化的消息为但单位，操作系统提供的消息传递方式，有直接通信方式和间接通信方式。<br>管道通信：管道就是连接一个读进程和一个写进程以实现他们之间通信的一个共享文件，向管道提供输入的发送进程以字符流形式将大量数据送入管道，接受管道输出的进程，则从管道中接受数据，为了协调双方通信，管道机制需提供互斥、同步和确定对方的存在。</p><h2 id="42、什么叫饥饿？"><a href="#42、什么叫饥饿？" class="headerlink" title="42、什么叫饥饿？"></a>42、什么叫饥饿？</h2><p>短作业优先算法时候，长作业一直得不到处理机</p><h2 id="43、进程的调度算法有哪些-分别简述"><a href="#43、进程的调度算法有哪些-分别简述" class="headerlink" title="43、进程的调度算法有哪些?分别简述"></a>43、进程的调度算法有哪些?分别简述</h2><p>先来先服务，缺点短作业可能等待很长时间，平均响应时间很慢。<br>短任务优先算法：平均响应时间最优，分为抢占和非抢占，容易饿死长任务。<br>高响应比：优先权&#x3D;等待时间+要求服务时间&#x2F;要求服务时间既照顾了短作业，又不会使长作业得不到服务。<br>分时（时间片）：选择适当时间片，过大退化成FCFS过小切换所用时间多。<br>优先级：静态优先级不变，动态优先级，执行了降低优先级。<br>多级反馈队列调度算法：设置多个就绪队列，并为各个队列赋予不同优先级，第一个队列优先级最高，依次降低，各队列中进程内时间片的大小也不相同，最高优先级的时间片最小，依次升高。当一个进程进入内存后，先进入优先级最高队尾，等待调度，当运行时候如果在该时间片结束，便可撤离了，没完成就进入第二个队列末尾等待，依次进行，如果在最后一个队列执行一次还没完成，就在这队列继续排队。仅当第一队列空闲时候，调度程序才会调度第二队中进程运行，优先级高的队列空闲，优先级低才会被调度，如果优先级低的队列正在执行，优先级高队列有进程进入，则调度程序把正在执行的进程放在这队的末尾，优先级高的先执行。<br>实时最早截止时间优先（EDF）：开始截止时间确定优先级。<br>最低松弛度优先（LLF）：根据任务紧急程度来确定优先级。</p><h2 id="44、什么是软实时，什么是硬实时？"><a href="#44、什么是软实时，什么是硬实时？" class="headerlink" title="44、什么是软实时，什么是硬实时？"></a>44、什么是软实时，什么是硬实时？</h2><p>硬实时系统有一个刚性的、不可改变的时间限制，它不允许任何超出时限的错误。超时错误会带来损害甚至导致系统失败、或者导致系统不能实现它的预期目标。<br>软实时系统的时限是一个柔性灵活的，它可以容忍偶然的超时错误。失败造成的后果并不严重，仅仅是轻微的降低了系统的吞吐量。</p><h2 id="45、什么是PV操作？简述PV操作要点及注意事项。"><a href="#45、什么是PV操作？简述PV操作要点及注意事项。" class="headerlink" title="45、什么是PV操作？简述PV操作要点及注意事项。"></a>45、什么是PV操作？简述PV操作要点及注意事项。</h2><p>信号量是最早出现的用来解决进程同步与互斥问题的机制，包括一个称为信号量的变量及对它进行的两个原语操作p操作和v操作，这两个操作是不可中断的程序段，称为原语。<br>P原语操作的动作是：信号量减1；若减1后仍大于或等于零，则进程继续执行；若减1后小于零，则该进程被阻塞后进入与该信号相对应的队列中V原语操作的动作是：信号量加1；若相加结果大于零，则进程继续执行；若相加结果小于或等于零，则从该信号的等待队列中唤醒一等待进程。<br>信号量必须成对使用。且在P,V愿语执行期间不允许有中断的发生。P,V原语不但可以解决进程管理当中的互斥问题，而且我们还可以利用此方法解决进程同步与进程通信的问题。同步时候信号量初始为0，互斥时候为1。</p><h2 id="46、什么是死锁？有什么解决办法？"><a href="#46、什么是死锁？有什么解决办法？" class="headerlink" title="46、什么是死锁？有什么解决办法？"></a>46、什么是死锁？有什么解决办法？</h2><p>死锁：多个进程因竞争资源而造成的一种僵局，若无外力作用，这些进程都将无法向前推进。原因：是资源的争夺，或进程推进顺序非法。<br>必要条件：资源为临界资源、进程所获得资源在用完之前不可强行夺走，只能主动释放，进程已经保持了至少一个资源，但有提出了新的资源请求，但该资源以被占用了，循环等待条件，存在一种进程资源的循环等待链。<br>预防死锁：这是一种较简单和直观的事先预防的方法。方法是通过设置某些限制条件，去破坏产生死锁的四个必要条件中的一个或者几个，来预防发生死锁。但是由于所施加的限制条件往往太严格，可能会导致系统资源利用率和系统吞吐量降低。<br>避免死锁：该方法同样是属于事先预防的策略，但它并不须事先采取各种限制措施去破坏产生死锁的的四个必要条件，而是在资源的动态分配过程中，用某种方法去防止系统进入不安全状态，从而避免发生死锁。<br>检测死锁：这种方法并不须事先采取任何限制性措施，也不必检查系统是否已经进入不安全区，此方法允许系统在运行过程中发生死锁。但可通过系统所设置的检测机构，及时地检测出死锁的发生，并精确地确定与死锁有关的进程和资源，然后采取适当措施，从系统中将已发生的死锁清除掉。<br>解除死锁：这是与检测死锁相配套的一种措施。当检测到系统中已发生死锁时，须将进程从死锁状态中解脱出来。常用的实施方法是撤销或挂起一些进程，以便回收一些资源，再将这些资源分配给已处于阻塞状态的进程，使之转为就绪状态，以继续运行。</p><h1 id="内存管理"><a href="#内存管理" class="headerlink" title="内存管理"></a>内存管理</h1><h2 id="47、简述内存的连续分配管理方式"><a href="#47、简述内存的连续分配管理方式" class="headerlink" title="47、简述内存的连续分配管理方式"></a>47、简述内存的连续分配管理方式</h2><p>固定分区分配，划分若干个固定大小区域，建立分区说明表，容易产生内部碎片。<br>动态分区分配，又称可变分区分配，是一种动态划分内存的分区方法。不预先划分，而是在进程装入内存时候，根据进程大小动态的建立分区。并使分区大小正好适合进程的需要。因此系统中分区的大小数目是可变的。会产生外部碎片。可用紧凑技术解决，不时的动态整理。<br>首次适应，空闲分区以地址递增次序链接，找到一个能满足要求的分区。<br>最佳适应：分区按容量递增形成分区链。<br>最坏适应：分区按容量递减形式分区链。<br>临近适应：循环首次适应，从上次查找结束位置开始继续查找。</p><h2 id="48、程序装入和链接。"><a href="#48、程序装入和链接。" class="headerlink" title="48、程序装入和链接。"></a>48、程序装入和链接。</h2><p>编译：将源代码编译成若干个目标模块<br>链接：链接程序将编译后形成的目标模块，以及所需库函数链接在一起，形成一个完整的装入模块。链接分为静态，装入时动态，运行时动态<br>装入：由装入程序装入模块装入内存中运行。分为绝对装入，可重定位，静态重定位一次性完成，动态重定位。</p><h2 id="49、常用内存保护方法有哪些？"><a href="#49、常用内存保护方法有哪些？" class="headerlink" title="49、常用内存保护方法有哪些？"></a>49、常用内存保护方法有哪些？</h2><p>页表机制里，页表寄存器中有页表起始地址，和页表长度，比较页号和页表长度如果大于页表长度则产生越界中断。</p><h2 id="50、什么是交换技术？什么是覆盖技术？及其区别"><a href="#50、什么是交换技术？什么是覆盖技术？及其区别" class="headerlink" title="50、什么是交换技术？什么是覆盖技术？及其区别"></a>50、什么是交换技术？什么是覆盖技术？及其区别</h2><p>覆盖：把一个用户空间分成一个固定分区和若干个覆盖区，活跃部分放入固定区，其余部分先放即将访问的进覆盖区，其他需要时候在调入覆盖原有的段。<br>交换：把处于等待状态的程序从内存移到外存，腾出空间这叫换出，然后把准备好竞争CPU运行的程序从外存调入内存，这叫换入。</p><h2 id="51、什么是拼接技术？"><a href="#51、什么是拼接技术？" class="headerlink" title="51、什么是拼接技术？"></a>51、什么是拼接技术？</h2><p>就是紧凑技术：动态分区分配回收时候，将其余空闲分区合并为一个大的空闲分区。</p><h2 id="52、简述内存的非连续非配管理方式（段、页）"><a href="#52、简述内存的非连续非配管理方式（段、页）" class="headerlink" title="52、简述内存的非连续非配管理方式（段、页）"></a>52、简述内存的非连续非配管理方式（段、页）</h2><p>非连续分配根据分区大小是否固定分为，分页存储管理和分段存储管理。分页存储管理方式又根据是否要把作业的所有页面都装入内存分为基本分页存储方式，和请求分页存储方式<br>基本分页存储管理方式：把主存空间分为大小相等且固定的块，相对较小，作为主存的基本单位，每个进程也以块为单位进行划分，进程在执行时，以块为单位逐个申请主存中的块空间。与固定分区技术的区别是块的大小相对于分区较多，而且进程也按照块进行划分，进程运行时按块申请主存可用空间并执行，只会在最后一个不完整块产生内部碎片。<br>进程在执行过程中需要申请主存空间，就是要为每个页面分配主存中的可用叶框，这就产生了页和叶匡的一一对应。页面大小要适中，太小页表长，页内碎片增大，降低内存的利用率。一般每页大小4KB，所以页内偏移量12位，页号20位，地址最多2的20此方页。<br>页表：为了便于在内存中找到进程的每个页面所对应的物理块，系统为每个进程创建一张页表，记录页面在内存中对应的物理块号，页表一般在内存中。页表作用是实现从页号到物理块号的映射。页表寄存器PTR存放页表在内存地址，和页表长度。进程未执行放在进程控制块中，执行存入。<br>TLB快表：若页表全部放在内存中，则存取一个数据或一条指令至少要访问两次内存，一次是访问页表，确定物理地址，一次是取数据和指令。这显然比通常执行指令慢一倍，所以增加一个具有并行查找能力的高速缓存存储器–快表。又称联想寄存器，用来存放当前访问的若干表项，比较的时候是将页与块表中的所有页号同时进行比较，找到取出，如果没有则访问主存中页表，读出后同时放入快表中，以便后面可能再次访问，但若块表以满则按着一定算法对旧页表进行替换。<br>页表占空间太大可以用两级页表，进程执行只需调入最高级页表就可以，进程的页表和进程本身的页面，可以再后面的执行中再调入。<br>分段管理：分页是从计算机角度考虑设计，提高内存利用率，而且通过硬件机制，对用户完全透明，分段管理方式的提出考虑了用户程序员以满足编程方便，信息保护和共享等多方面需求。段内要求连续，段间不要求连续，作业地址空间是二维的。最大段长64KB，段号为16位，段内偏移量为16位。段式系统中段号和段内偏移量必须由用户显示提供。段表映射了逻辑空间和内存空间。段表项记录了起址和段长。分段系统共享是通过两个作业的段表中相应表指向被共享的段的同一个物理副本实现的。不能修改的代码称为纯代码和可重入代码这样代码不能修改数据是可以共享的。<br>段页式：将两种存储管理方法结合起来，形成了段页式存储管理方式。作业地址空间首先分成若干逻辑段，每段都有自己段号，然后每一段分成若干大小固定的页。对内存空间管理仍然和分页一样。逻辑地址三部分，段号，页号，偏移量。段表项报考段号，页表长度，页表起始地址。页表项包括页号和块号。</p><h2 id="53、简述虚拟存储器的原理"><a href="#53、简述虚拟存储器的原理" class="headerlink" title="53、简述虚拟存储器的原理"></a>53、简述虚拟存储器的原理</h2><p>传统存储管理方式一次性，驻留性不换出。局部性原理，空间局部性，一旦程序访问了某个存储单元，在不久之后，其附近的存储单元页将被访问，指令通常说顺序存放，顺序执行的，数据也一般以数组等方式簇聚存储的。时间局部性，某一指令一旦执行，不久以后该指令可能再次执行，数据被访问过，不久以后数据有可能再次被访问。原因是程序有循环。基于局部性原理，在程序装入时候，可以将程序的一部分装入内存，其余部分留在外存，就可以启动程序执行，在程序执行过程中，访问的信息不存在内存，由系统将所需的部分调入内存然后继续执行程序，另一方面将暂时不使用的内存换出道外存。从而腾出空间存放将要掉入内存的信息，这样系统好像为用户提供了一个比实际内存大的多的存储器，称为虚拟存储器。<br>实现：请求分页，请求分段，请求段页式存储管理<br>硬件支持：内存外存，也表机制，中断机构，地址变换机构。<br>请求分页管理方式：建立在基本分页管理方式，为了支持虚拟存储器功能，增加了请求调页和页面置换功能。每当要访问的页面不在内存时候，便产生了一个缺页中断，请求操作系统将所缺的页面调入内存，此时将缺页进程阻塞，调完唤醒，内存有空闲块则分配，将要掉入的页装入该块，并修改页表中相应表项，若此时没有空闲块，则按着一定算法置换。修改过还写回，与一般中断比可以再指令执行期间产生和处理中断信号。</p><h2 id="54、简述各种页面置换算法（LRU、CLOCK）LRU是如何实现的？"><a href="#54、简述各种页面置换算法（LRU、CLOCK）LRU是如何实现的？" class="headerlink" title="54、简述各种页面置换算法（LRU、CLOCK）LRU是如何实现的？"></a>54、简述各种页面置换算法（LRU、CLOCK）LRU是如何实现的？</h2><p>最佳，以后不会使用的淘汰。不可能实现。<br>先进先出：优先淘汰最早进入内存的页面。<br>最近最久未使用LRU置换算法：淘汰最近最长时间未访问过的页面，该算法未每个页面设置一个访问字段，来记录页面自上次被访问以来所经历的时间，淘汰页面时候选择现有页面中值最大的。需要栈支持。可利用一个特殊的栈来保存当前使用的各个页面的页面号。每当进程访问某页面时，便将页面的页面号从栈中移出，将它压入栈顶。因此，栈顶始终是最新被访问页面的编号民，而栈底则是最近最久未使用的页面的页面号。<br>Clock算法：LRU接近最佳置换算法，性能好但是开销大，FIFO简单但是性能差，CLOCK算法比较小的开销接近LRU的性能，最近未用（NRU），给每一帧关联一个附加位，称为使用位，当某一页首次装入主存，该帧使用位设置1，随后再被访问页被置1，替换算法把候选帧集合看成一个循环缓冲区，并且有一个指针与之关联， 当某一页被替换时该指针被设置成指向缓冲区的下一帧。当需要替换一页时候，操作系统扫描缓冲区，以查找使用位为0的一帧，每当遇到为1的改0，如果所有都为0则替换第一个，所有都为1则全改0一圈回来后替换第一个，由于循环检查各页情况，所以CLOCK。<br>优化：加一个修改位，改了的为1， 系统先找没访问过页没修改过的，不对使用位修改，找不到的找没访问，改了的，这次过去使用位改0，找不到，回原点从新来，这回一定能找到了。由于修改的页面需要写回。这样节省时间。</p><h2 id="55、什么是TLB（快表）？有什么用？原理？"><a href="#55、什么是TLB（快表）？有什么用？原理？" class="headerlink" title="55、什么是TLB（快表）？有什么用？原理？"></a>55、什么是TLB（快表）？有什么用？原理？</h2><p>TLB块表：若页表全部放在内存中，则存取一个数据或一条指令至少要访问两次内存，一次是访问页表，确定物理地址，一次是取数据和指令。这显然比通常执行指令慢一倍，所以增加一个具有并行查找能力的高速缓存存储器–快表。又称联想寄存器，用来存放当前访问的若干表项，比较的时候是将页与块表中的所有页号同时进行比较，找到取出，如果没有则访问主存中页表，读出后同时放入快表中，以便后面可能再次访问，但若块表以满则按着一定算法对旧页表进行替换。</p><h1 id="IO管理和文件"><a href="#IO管理和文件" class="headerlink" title="IO管理和文件"></a>IO管理和文件</h1><h2 id="56、什么是设备无关性？"><a href="#56、什么是设备无关性？" class="headerlink" title="56、什么是设备无关性？"></a>56、什么是设备无关性？</h2><p>应用程序独立于具体使用的物理设备。为了实现设备独立性，在程序中使用逻辑设备名来请求，使用某类设备，在系统中设置逻辑设备表。用于将逻辑设备名映射为物理设备名。这样多个进程可以分时使用同一个设备了。</p><h2 id="57、磁盘调度算法有哪些？"><a href="#57、磁盘调度算法有哪些？" class="headerlink" title="57、磁盘调度算法有哪些？"></a>57、磁盘调度算法有哪些？</h2><p>先来先服务：仅适用于请求磁盘IO的进程数目较少的场合最简单的一种磁盘调度算法，根据进程请求访问磁盘的先后次序进行调度。优点：简单，公平，每一个请求的进程都能够得到处理，不会出现长期得不到处理的进程。缺点：未对寻道进行优化，致使平均寻道时间可能较长。<br>最短寻道时间优先：该算法选择这样的进程，其要求访问的磁道，与当前磁头所在的磁道距离最近，以使每次的寻道时间最短，但这种算法不能保证平均寻道时间最短优点：较FCFS有更好的寻道性能缺点：可能导致老进程饥饿，可能会出现磁臂黏着<br>扫描算法：也叫电梯调度算法在SSTF算法基础上优化而得到，可以防止老进程饥饿。该算法不仅考虑到被访问磁道和当前磁头之间的距离，更优先考虑的是磁头当前的移动方向。(应该选取同方向且距离最近的磁道访问。)优点：磁头双向移动，不会产生饥饿，平均寻道时间短。缺点：可能会出现磁臂黏着<br>循环扫描算法：为了减少延迟，CSCAN规定磁头单向移动，当从里到最外后，磁头立即返回到最里的欲访问磁道，然后继续向外。优点：磁头单向移动，不会产生饥饿，平均寻道时间短。</p><h2 id="58、文件共享的方式又哪些？"><a href="#58、文件共享的方式又哪些？" class="headerlink" title="58、文件共享的方式又哪些？"></a>58、文件共享的方式又哪些？</h2><p>硬连接：基于索引节点的共享方式，诸如文件的物理地址以及其他的文件属性等信息，不再是放在目录项中，而是放在索引节点中。文件目录只设置文件名以及指向相应索引节点的指针，索引节点还应有一个链接计数。<br>软连接：符号链为让B共享用户A的一个共享文件F，可以由系统创建一个LINK类型的新文件也取名为F，并将文件F写入用户B的目录中，指向这个链接文件，其实就是快捷方式。</p><h2 id="59、文件分配方式有哪些？"><a href="#59、文件分配方式有哪些？" class="headerlink" title="59、文件分配方式有哪些？"></a>59、文件分配方式有哪些？</h2><p>连续分配：每个文件在磁盘上占一组连续块，支持顺序访问和直接访问，优点是简单，存取速度快。缺点是文件长度不宜动态增加。增加需大量移动。<br>链接分配：采取离散分配，消除外部碎片，提高了磁盘利用率，根据当前需要分配必需的盘块，当文件动态增长时，可以动态再为它分配盘块。隐式链接：每个文件对应一个磁盘块的链表，磁盘块分布在磁盘的任何地方，除最后一个盘块外，每个盘块都由指向下一个盘块的指针。显示连链接：把指针显式存放在内存中一张连接表中，该表在整个磁盘设置一张，每个表项中存放链接指针，即下一个盘块号。显著提高了检索速度，大大减少了访问磁盘的次数，由于分配给文件的所有盘块号都放在该表中，故称该表为文件分配表（FAT）<br>索引分配：把每个文件的所有盘块号都集中放在一起构成索引块表。为了处理大文件，可以链接多个索引块，也可以多层索引。<br>混合索引：把多种索引分配方式相结合的分配方式。</p><h2 id="60、文件存储空间管理"><a href="#60、文件存储空间管理" class="headerlink" title="60、文件存储空间管理"></a>60、文件存储空间管理</h2><p>空闲表法：与内存动态分配相似<br>空闲链表法：将所有空闲盘区拉成一条空闲链。<br>位示图：磁盘上每个盘块都有一个二进制位与之对应</p><h2 id="61、简述缓冲池原理"><a href="#61、简述缓冲池原理" class="headerlink" title="61、简述缓冲池原理"></a>61、简述缓冲池原理</h2><p>缓冲池：由多个系统公用的缓冲区组成，缓冲区按其使用情况可以形成三个队列，空缓冲队列、装满输入数据的缓冲队列（输入队列）和装满输出数据的队列（输出队列），还有四个缓冲区：用于收容输入数据缓冲区、用于提取输入数据的工作缓冲区、用于收容输出数据的工作缓冲区以及用于提取输出数据的工作缓冲区。<br>当输入进程需要输入数据时，从空缓冲队列队首摘下一个空缓冲区，把它作为收容输入工作缓冲区，然后把输入数据输入其中，装满后再挂到输入队列末尾。当计算机进程要输入数据时，便从输入队列取得一个空缓冲区作为提取输入工作缓冲区，计算进程从中提取数据，数据用完后再将它挂到空缓冲队列尾。当计算机进程需要输入数据时，便从空缓冲队列的队首取得空缓冲区，作为收容输出工作缓冲区，当其中装满输出数据后，再将它挂到输出队列队尾。当要输出时，有输出进程从输出队列中取得一个装满输出数据的缓冲区，作为提取输出工作缓冲区，提取完挂到空缓冲队列队尾。</p>]]></content>
      
      
      <categories>
          
          <category> 计算机基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 操作系统 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo博客-插入各类文件</title>
      <link href="/posts/ec28b29e/"/>
      <url>/posts/ec28b29e/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="Hexo博客-插入各类文件"><a href="#Hexo博客-插入各类文件" class="headerlink" title="Hexo博客-插入各类文件"></a>Hexo博客-插入各类文件</h2><h3 id="插入个人博客"><a href="#插入个人博客" class="headerlink" title="插入个人博客"></a>插入个人博客</h3><h4 id="方式一："><a href="#方式一：" class="headerlink" title="方式一："></a><strong>方式一：</strong></h4><p>  鉴于 <code>Hexo</code> 在 <code>generate</code> 的时候会直接在 <code>pubilc</code> 目录下生成 <code>html</code> 文件,因此可以通过生产地址引用另一篇文章。<br>  格式：<code>/年/月/日/博客名称/</code><br>  缺点：这种方式存在不足，一旦另一篇博客的时间修改了，链接失效</p><h4 id="方式二：（推荐）"><a href="#方式二：（推荐）" class="headerlink" title="方式二：（推荐）"></a><strong>方式二：（推荐）</strong></h4><p>  该种方式实现的链接为永久链接<br>  格式如下：</p><figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="template-tag">&#123;% <span class="name">post_path</span> 文章文件名(不要后缀) %&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="template-tag">&#123;% <span class="name">post_link</span> 文章文件名(不要后缀) 显示文字(可自定义) %&#125;</span></span><br></pre></td></tr></table></figure><pre><code>* 文章文件名(不要后缀)：文章名称。如果文章不存在，这段代码将会被直接忽略。* 显示文字(可自定义)：该链接的标题。如果置空，则自动提取文章的标题</code></pre><p>  这里的<code>post_link</code> 是有什么特殊含义吗？还是仅仅指 <code>_post</code> 文件夹下的内容？<br>    刚刚尝试发现在_post文件夹下的名为2019子文件夹下面的内容可以通过把2019加到文章名前面引用成功，类似这样：<br>    <code>&#123;% post_link 2019/我的文章名称 点击这里查看这篇文章 %&#125;</code><br>  <a href="https://hexo.io/docs/tag-plugins">参考:hexo-tag-plugins</a></p><h4 id="方式三：使用-html-lt-a-gt-标签实现，如下："><a href="#方式三：使用-html-lt-a-gt-标签实现，如下：" class="headerlink" title="方式三：使用 html &lt;a&gt; 标签实现，如下："></a>方式三：使用 <code>html &lt;a&gt;</code> 标签实现，如下：</h4><figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;</span></span></span><span class="template-tag">&#123;% <span class="name">post_path</span> &#x27;hexo blog&#x27; %&#125;</span><span class="language-xml"><span class="tag"><span class="string">#安装&quot;</span>&gt;</span>hexo 安装<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h4 id="hexo-链接到站内文章指定锚点"><a href="#hexo-链接到站内文章指定锚点" class="headerlink" title="hexo 链接到站内文章指定锚点"></a>hexo 链接到站内文章指定锚点</h4><p>关于 <code>hexo</code> 如何跳转到站内文章的锚点链接，官网文档没任何描，本文总结如下几种方式：</p><h5 id="hexo-标题与-id-关系"><a href="#hexo-标题与-id-关系" class="headerlink" title="hexo 标题与 id 关系"></a>hexo 标题与 id 关系</h5><p><code>hexo markdown</code> 文章里面如果使用 <code>## 文章二级标题</code> 生成标题，标题会自动生成 <code>id=&quot;文章二级标题&quot;</code> 。<br>如果标题中间有 <code>半角空格</code> 或者 <code>全角空格</code> ，空格都会变成连字符，如：</p><ul><li>一个半角空格 <code>## hello world</code> 或 多个半角 <code>## hello world</code> 或 多个全角空格 <code>## hello　　　world</code> 。</li><li>其生成的 <code>id</code> 会变成 <code>id=&quot;hello-world&quot;</code>，多个空格会合并成一个连字符。</li></ul><h5 id="当前文章锚点跳转"><a href="#当前文章锚点跳转" class="headerlink" title="当前文章锚点跳转"></a>当前文章锚点跳转</h5><p>使用 <code>markdown</code> 内置的链接方式即可，其中如果有空格，需要把空格换成连字符 <code>-</code> ，如</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[跳转到本文锚点](<span class="regexp">/2016/</span><span class="number">7</span><span class="regexp">/11/</span>title.html<span class="comment">#功能介绍)</span></span><br></pre></td></tr></table></figure><h3 id="插入外部链接"><a href="#插入外部链接" class="headerlink" title="插入外部链接"></a>插入外部链接</h3><p>直接使用全路径即可，如下：</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[hexo 引用文章](https://hexo.io/zh-cn/docs/tag-plugins#<span class="variable">%E5</span><span class="variable">%BC</span><span class="variable">%95</span><span class="variable">%E7</span><span class="variable">%94</span><span class="variable">%A8</span><span class="variable">%E6</span><span class="variable">%96</span><span class="variable">%87</span><span class="variable">%E7</span><span class="variable">%AB</span><span class="variable">%A0</span>)</span><br></pre></td></tr></table></figure><h3 id="插入-markdown文件"><a href="#插入-markdown文件" class="headerlink" title="插入 markdown文件"></a>插入 markdown文件</h3><p>安装 <code>hexo-include-markdown</code></p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm <span class="keyword">install</span> hexo-<span class="keyword">include</span>-markdown --save</span><br></pre></td></tr></table></figure><p>在总的 <code>_config.yml</code> 里添加</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">include_markdown:</span><br><span class="line">  dir: source/      # Base directory of template markdown</span><br><span class="line">  verbose: true     # If you want to check the path of markdown that use <span class="comment">&lt;!-- md --&gt;</span> tag , please set the true.</span><br></pre></td></tr></table></figure><p>在 <code>md</code> 文件里添加相对于 <code>source</code> 的路径</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- md path/to/template.md --&gt;</span></span><br></pre></td></tr></table></figure><p><a href="https://github.com/tea3/hexo-include-markdown">参考:hexo-include-markdown</a></p><h3 id="插入代码文件"><a href="#插入代码文件" class="headerlink" title="插入代码文件"></a>插入代码文件</h3><p>先修改总的 <code>_config.yml</code><br><code>code_dir: ./ #</code> 表示从 <code>source</code> 目录开始<br>然后在要插入代码的md文件里相对 <code>source</code> 目录写文件路径</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% include_code [title] [<span class="keyword">lan</span><span class="variable">g:language</span>] path/<span class="keyword">to</span>/<span class="keyword">file</span> %&#125;</span><br></pre></td></tr></table></figure><p><a href="https://hexo.io/docs/tag-plugins">参考:hexo-tag-plugins</a></p><h3 id="插入图片、视频等其他文件"><a href="#插入图片、视频等其他文件" class="headerlink" title="插入图片、视频等其他文件"></a>插入图片、视频等其他文件</h3><p>插入视频、图片等等，网上可收集的实在多，不赘述。归根结底，要么写 <code>Markdown</code> 语法，要么参考官网添加 <code>tag</code> 的方式，即如下网址：<br><a href="https://hexo.io/docs/tag-plugins">hexo-tag-plugins英文说明</a><br><a href="https://hexo.io/zh-cn/docs/tag-plugins.html">hexo-tag-plugins中文说明</a></p>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
          <category> markdown </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Markdown </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>正则表达式</title>
      <link href="/posts/2f57a694/"/>
      <url>/posts/2f57a694/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><a href="/posts/81d5af05/" title="常用正则表达式">常用正则表达式</a><a href="/posts/751daa02/" title="jQuery.validator.addMethod实例">jQuery.validator.addMethod实例</a><h2 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h2><p><img src="https://www.runoob.com/wp-content/uploads/2014/03/CEBB49BB-B1AD-4539-AC7A-B40DDC62D1B2.jpg"></p><ul><li><code>^</code> 为匹配输入字符串的开始位置</li><li><code>[0-9]+</code> 匹配多个数字，<code>[0-9]</code> 匹配单个数字，<code>+</code> 匹配一个或者多个</li><li><code>abc</code> 匹配字母 <code>abc </code>并以 <code>abc</code> 结尾</li><li><code>$</code> 为匹配输入字符串的结束位置</li></ul><p>我们在写用户注册表单时，只允许用户名包含字符 <code>a-z</code>、数字 <code>0-9</code>、下划线 <code>_</code>和连接字符 **<code>-</code>**，并设置用户名的长度，我们就可以使用以下正则表达式来设定。</p><p><img src="https://www.runoob.com/wp-content/uploads/2018/09/regexp-cn.png"></p><p><img src="https://www.runoob.com/wp-content/uploads/2014/03/regexp-metachar-2020-11-23.png"></p><h2 id="普通字符"><a href="#普通字符" class="headerlink" title="普通字符"></a>普通字符</h2><table><thead><tr><th align="center">字符</th><th>功能</th></tr></thead><tbody><tr><td align="center">[abc]</td><td>匹配 […] 中的所有abc字符</td></tr><tr><td align="center">[^abc]</td><td>匹配 […] 除了abc字符的所有字符</td></tr><tr><td align="center">[A-Z]</td><td>[A-Z] 匹配所有大写字母</td></tr><tr><td align="center">[a-z]</td><td>[a-z] 表示所有小写字母</td></tr><tr><td align="center">\b, \B</td><td>匹配单词&#x2F;非单词边界</td></tr><tr><td align="center">\d</td><td>匹配0~9的所有数字</td></tr><tr><td align="center">\D</td><td>匹配非数字</td></tr><tr><td align="center">\w</td><td>匹配字母、数字、下划线，等价于[A-Za-z0-9_]</td></tr><tr><td align="center">\W</td><td>匹配所有的非单词字符</td></tr><tr><td align="center">\o</td><td>匹配NULL</td></tr></tbody></table><h2 id="非打印字符"><a href="#非打印字符" class="headerlink" title="非打印字符"></a>非打印字符</h2><table><thead><tr><th>字符</th><th>描述</th></tr></thead><tbody><tr><td>\v</td><td>匹配一个垂直制表符</td></tr><tr><td>\f</td><td>匹配一个换页符</td></tr><tr><td>\n</td><td>匹配一个换行符</td></tr><tr><td>\r</td><td>匹配一个回车符</td></tr><tr><td>\s</td><td>匹配任何空白字符，包括空格、制表符、换页符等等</td></tr><tr><td>\S</td><td>匹配任何非空白字符</td></tr><tr><td>\t</td><td>匹配一个制表符</td></tr></tbody></table><h2 id="特殊字符"><a href="#特殊字符" class="headerlink" title="特殊字符"></a>特殊字符</h2><table><thead><tr><th>特别字符</th><th>描述</th></tr></thead><tbody><tr><td>^,$</td><td>匹配输入字符串的开始&#x2F;结尾位置；<br />要匹配 ^ 字符本身，请使用\^；<br />要匹配 $ 字符本身，请使用\$</td></tr><tr><td>( )</td><td>标记一个子表达式的开始和结束位置</td></tr><tr><td>*</td><td>匹配前面的子表达式零次或多次；<br />要匹配 * 字符，请使用 \*</td></tr><tr><td>+</td><td>匹配前面的子表达式一次或多次；<br />要匹配 + 字符，请使用 \</td></tr><tr><td>.</td><td>匹配除换行符 \n 之外的任何单字符；<br />要匹配 . 字符，请使用 \.</td></tr><tr><td>[</td><td>标记一个中括号表达式的开始；<br />要匹配 [ 字符，请使用 \</td></tr><tr><td>?</td><td>匹配前面的子表达式零次或一次，或指明一个非贪婪限定符；<br />要匹配 ? 字符，请使用\?</td></tr><tr><td>\</td><td>将下一个字符标记为或特殊字符、或原义字符、或向后引用、或八进制转义符；<br />例如， ‘n’ 匹配字符 ‘n’；’\n’ 匹配换行符；序列 ‘\\‘ 匹配 “\“，而 ‘\(‘ 则匹配 “(“</td></tr><tr><td>{</td><td>标记限定符表达式的开始；<br />要匹配 {，请使用\{</td></tr></tbody></table><h2 id="限定符"><a href="#限定符" class="headerlink" title="限定符"></a>限定符</h2><p>限定符用来指定正则表达式的一个给定组件必须要出现多少次才能满足匹配。有 <code>*</code>或 <code>+</code>或 <code>?</code>或 <code>&#123;n&#125;</code> 或 <code>&#123;n,&#125;</code>或 <code>&#123;n,m&#125;</code> 共6种。</p><table><thead><tr><th>字符</th><th>描述</th></tr></thead><tbody><tr><td>*</td><td>匹配前面的子表达式零次或多次。等价于{0,}。</td></tr><tr><td>+</td><td>匹配前面的子表达式一次或多次。等价于 {1,}。</td></tr><tr><td>?</td><td>匹配前面的子表达式零次或一次。等价于 {0,1}。</td></tr><tr><td>{n}</td><td>n 是一个非负整数。匹配确定的 n 次。</td></tr><tr><td>{n,}</td><td>n 是一个非负整数。至少匹配n 次。’o{1,}’ 等价于 ‘o+’。’o{0,}’ 则等价于 ‘o*’。</td></tr><tr><td>{n,m}</td><td>m 和 n 均为非负整数，其中n &lt;&#x3D; m。最少匹配 n 次且最多匹配 m 次。’o{0,1}’ 等价于 ‘o?’。</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 面对对象 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 正则 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常用正则表达式</title>
      <link href="/posts/81d5af05/"/>
      <url>/posts/81d5af05/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="常用正则表达式"><a href="#常用正则表达式" class="headerlink" title="常用正则表达式"></a>常用正则表达式</h1><h2 id="校验数字的表达式"><a href="#校验数字的表达式" class="headerlink" title="校验数字的表达式"></a><strong>校验数字的表达式</strong></h2><p>1、数字：<code>^[0-9]*$</code></p><p>2、n位的数字：<code>^\d&#123;n&#125;$</code></p><p>3、至少n位的数字：<code>^\d&#123;n,&#125;$</code></p><p>4、m-n位的数字：<code>^\d&#123;m,n&#125;$</code></p><p>5、零和非零开头的数字：<code>^(0|[1-9][0-9]*)$</code></p><p>6、非零开头的最多带两位小数的数字：<code>^([1-9][0-9]*)+(.[0-9]&#123;1,2&#125;)?$</code></p><p>7、带1-2位小数的正数或负数：<code>^(</code></p><p>8、正数、负数、小数：<code>^(\-|\+)?\d+(\.\d+)?$</code></p><p>9、有两位小数的正实数：<code>^[0-9]+(.[0-9]&#123;2&#125;)?$</code></p><p>10、有1~3位小数的正实数：<code>^[0-9]+(.[0-9]&#123;1,3&#125;)?$</code></p><p>11、非零的正整数：<code>^[1-9]\d*$</code> 或  <code>^([1-9][0-9]*)&#123;1,3&#125;$</code> 或 <code>^\+?[1-9][0-9]*$</code></p><p>12、非零的负整数：<code>^\-[1-9][]0-9&quot;*$</code> 或 <code>^-[1-9]\d*$</code></p><p>13、非负整数：<code>^\d+$</code> 或 <code>^[1-9]\d*|0$</code></p><p>14、非正整数：<code>^-[1-9]\d*|0$</code> 或 <code>^-[1-9]\d*|0$</code></p><h2 id="校验字符的表达式"><a href="#校验字符的表达式" class="headerlink" title="校验字符的表达式"></a><strong>校验字符的表达式</strong></h2><p>1、汉字：<code>^[\u4e00-\u9fa5]&#123;0,&#125;$</code></p><p>2、英文和数字：<code>^[A-Za-z0-9]+$</code> 或 <code>^[A-Za-z0-9]&#123;4,40&#125;$</code></p><p>3、长度为3-20的所有字符：<code>^.&#123;3,20&#125;$</code></p><p>3、由26个英文字母组成的字符串：<code>^[A-Za-z]+$</code></p><p>5、由26个大写英文字母组成的字符串：<code>^[A-Z]+$</code></p><p>6、由26个小写英文字母组成的字符串：<code>^[a-z]+$</code></p><p>7、由数字和26个英文字母组成的字符串：<code>^[A-Za-z0-9]+$</code></p><p>8、由数字、26个英文字母或者下划线组成的字符串：<code>^\w+$ </code>或 <code>^\w&#123;3,20&#125;$</code></p><p>9、中文、英文、数字包括下划线：<code>^[\u4E00-\u9FA5A-Za-z0-9_]+$</code></p><p>10、中文、英文、数字但不包括下划线等符号：<code>^[\u4E00-\u9FA5A-Za-z0-9]+$</code> 或 <code>^[\u4E00-\u9FA5A-Za-z0-9]&#123;2,20&#125;$</code></p><p>11、可以输入含有 <code>^%&amp;&#39;,;=?$</code>等字符：<code>[^%&amp;&#39;,;=?$\x22]+</code></p><p>12、禁止输入含有<del>的字符：&#96;[^</del>\x22]+&#96;</p><h2 id="特殊需求表达式"><a href="#特殊需求表达式" class="headerlink" title="特殊需求表达式"></a><strong>特殊需求表达式</strong></h2><p>1、Email地址：<code>^\w+([-+.]\w+)</code></p><p>2、域名：<code>[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;(/.[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;)+/.?</code></p><p>3、 InternetURL：<code>[a-zA-z]+://[^\s]*</code> 或 <code>^http://([\w-]+</code></p><p>4、手机号码：<code>^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d&#123;8&#125;$</code></p><p>5、电话号码(“XXX-XXXXXXX”、”XXXX-XXXXXXXX”、”XXX-XXXXXXX”、”XXX-XXXXXXXX”、”XXXXXXX”和”XXXXXXXX)：<code>^(</code></p><p>6、国内电话号码(0511-4405222、021-87888822)：<code>\d&#123;3&#125;-\d&#123;8&#125;|\d&#123;4&#125;-\d&#123;7&#125;</code></p><p>7、身份证号(15位、18位数字)：<code>^\d&#123;15&#125;|\d&#123;18&#125;$</code></p><p>8、短身份证号码(数字、字母x结尾)：<code>^([0-9])&#123;7,18&#125;(x|X)?$$</code>或</p><p>9、帐号是否合法(字母开头，允许5-16字节，允许字母数字下划线)：<code>^[a-zA-Z][a-zA-Z0-9_]&#123;4,15&#125;$</code></p><p>10、密码(以字母开头，长度在6~18之间，只能包含字母、数字和下划线)：<code>^[a-zA-Z]\w&#123;5,17&#125;$</code></p><p>11、强密码(必须包含大小写字母和数字的组合，不能使用特殊字符，长度在8-10之间)：<code>^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).&#123;8,10&#125;$</code></p><p>12、日期格式：<code>^\d&#123;4&#125;-\d&#123;1,2&#125;-\d&#123;1,2&#125;</code></p><p>13、一年的12个月(01～09和1～12)：<code>^(0?[1-9]|1[0-2])$</code></p><p>14 、一个月的31天(01～09和1～31)：<code>^((0?[1-9])|((1|2)[0-9])|30|31)$</code></p><p>15、钱的输入格式：</p><ul><li>有四种钱的表示形式我们可以接受:”10000.00” 和 “10,000.00”, 和没有 “分” 的 “10000” 和 “10,000”：<code>^[1-9][0-9]*$</code></li><li>这表示任意一个不以0开头的数字,但是,这也意味着一个字符”0”不通过,所以我们采用下面的形式：<code>^(0|[1-9][0-9]*)$</code></li><li>一个0或者一个不以0开头的数字.我们还可以允许开头有一个负号：<code>^(0|-?[1-9][0-9]*)$</code></li><li>这表示一个0或者一个可能为负的开头不为0的数字.让用户以0开头好了.把负号的也去掉,因为钱总不能是负的吧.下面我们要加的是说明可能的小数部分：<code>^[0-9]+(.[0-9]+)?$</code></li><li>5.必须说明的是,小数点后面至少应该有1位数,所以”10.”是不通过的,但是 “10” 和 “10.2” 是通过的：<code>^[0-9]+(.[0-9]&#123;2&#125;)?$</code></li><li>6.这样我们规定小数点后面必须有两位,如果你认为太苛刻了,可以这样：<code>^[0-9]+(.[0-9]&#123;1,2&#125;)?$</code></li><li>这样就允许用户只写一位小数.下面我们该考虑数字中的逗号了,我们可以这样：<code>^[0-9]&#123;1,3&#125;(,[0-9]&#123;3&#125;)*(.[0-9]&#123;1,2&#125;)?$</code></li><li>1到3个数字,后面跟着任意个 逗号+3个数字,逗号成为可选,而不是必须：<code>^([0-9]+|[0-9]&#123;1,3&#125;(,[0-9]&#123;3&#125;)*)(.[0-9]&#123;1,2&#125;)?$</code></li></ul><p>16、xml文件：<code>^([a-zA-Z]+-?)+[a-zA-Z0-9]+</code></p><p>17、中文字符的正则表达式：<code>[\u4e00-\u9fa5]</code></p><p>18、双字节字符(包括汉字在内，可以用来计算字符串的长度(一个双字节字符长度计2，ASCII字符计1))：<code>[^\x00-\xff]</code></p><p>19、空白行的正则表达式(可以用来删除空白行)：<code>\n\s*\r</code></p><p>21、首尾空白字符的正则表达式(可以用来删除行首行尾的空白字符(包括空格、制表符、换页符等等)，非常有用的表达式)：<code>^\s*|\s*$</code> 或 <code>(^\s*)|(\s*$)</code></p><p>22、 腾讯QQ号 (腾讯QQ号从10000开始)：<code>[1-9][0-9]&#123;4,&#125;</code></p><p>23、中国邮政编码(中国邮政编码为6位数字)：<code>[1-9]\d&#123;5&#125;(?!\d)</code></p><p>24、IP地址(提取IP地址时有用)：<code>\d+</code></p><p>25、 IP地址：<code>((?:(?:25[0-5]|2[0-4]</code></p><h2 id="常用的正则表达式（仅做收集，涉及不深）"><a href="#常用的正则表达式（仅做收集，涉及不深）" class="headerlink" title="常用的正则表达式（仅做收集，涉及不深）"></a>常用的正则表达式（仅做收集，涉及不深）</h2><p>**&#x2F;&#x2F;**（1）匹配16进制颜色值</p><p><strong>var color &#x3D; &#x2F;#([0-9a-fA-F]{6}|[0-9a-fA-F]{3})&#x2F;g;</strong></p><p>**&#x2F;&#x2F;**（2）匹配日期，如yyyy-mm-dd格式</p><p><strong>var date &#x3D; &#x2F;^[0-9]{4}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])$&#x2F;;</strong></p><p>**&#x2F;&#x2F;**（3）匹配qq号</p><p><strong>var qq &#x3D; &#x2F;^[1-9][0-9]{4,10}$&#x2F;g;</strong></p><p>**&#x2F;&#x2F;**（4）手机号码正则</p><p><strong>var phone &#x3D; &#x2F;^1[34578]\d{9}$&#x2F;g;</strong></p><p>**&#x2F;&#x2F;**（5）用户名正则</p><p><strong>var username &#x3D; &#x2F;^[a-zA-Z$][a-zA-Z0-9_$]{4,16}$&#x2F;;</strong></p><p>**&#x2F;&#x2F;**（6）Email正则</p><p><strong>var email &#x3D; &#x2F;^([A-Za-z0-9_-.])+@([A-Za-z0-9_-.])+.([A-Za-z]{2,4})$&#x2F;;</strong></p><p>**&#x2F;&#x2F;**（7）身份证号（18位）正则</p><p><strong>var cP &#x3D; &#x2F;^[1-9]\d{5}(18|19|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$&#x2F;;</strong></p><p>**&#x2F;&#x2F;**（8）URL正则</p><p>*<em>var urlP&#x3D; &#x2F;^((https?|ftp|file)://)?([\da-z.-]+).([a-z.]{2,6})([/\w .-]</em>)<em>/?$&#x2F;;</em>*</p><p><strong>&#x2F;&#x2F; (9)ipv4</strong>地址正则</p><p><strong>var ipP &#x3D; &#x2F;^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?).){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$&#x2F;;</strong></p><p>**&#x2F;&#x2F; (10)&#x2F;&#x2F;**车牌号正则</p><p>**var cPattern &#x3D; &#x2F;^[**京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[A-Z]{1}[A-Z0-9]{4}[A-Z0-9挂学警港澳]{1}$&#x2F;;</p><p>**&#x2F;&#x2F; (11)**强密码(必须包含大小写字母和数字的组合，不能使用特殊字符，长度在8-10之间)：var pwd &#x3D; &#x2F;^(?&#x3D;.\d)(?&#x3D;.[a-z])(?&#x3D;.[A-Z]).{8,10}$&#x2F;</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 面对对象 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 正则 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>jQuery.validator.addMethod实例</title>
      <link href="/posts/751daa02/"/>
      <url>/posts/751daa02/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="jQuery-validator-addMethod实例"><a href="#jQuery-validator-addMethod实例" class="headerlink" title="jQuery.validator.addMethod实例"></a>jQuery.validator.addMethod实例</h1><p>需要引入 <code>&lt;script type=&quot;text/javascript&quot; src=&quot;./js/jquery-validation/jquery.validate.min.js&quot; &gt;&lt;/script&gt;</code></p><h2 id="手机号码验证"><a href="#手机号码验证" class="headerlink" title="手机号码验证"></a>手机号码验证</h2><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 手机号码验证</span></span><br><span class="line">jQuery.validator.addMethod(<span class="string">&quot;mobile&quot;</span>, <span class="keyword">function</span>(<span class="params">value, element</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="built_in">length</span> = value.<span class="built_in">length</span>;</span><br><span class="line">    <span class="keyword">var</span> mobile = <span class="regexp">/^(((13[0-9]&#123;1&#125;)|(15[0-9]&#123;1&#125;))+\d&#123;8&#125;)$/</span>;</span><br><span class="line">    <span class="keyword">return</span> this.optional(element) || (<span class="built_in">length</span> == <span class="number">11</span> &amp;&amp; mobile.test(value));</span><br><span class="line">&#125;, <span class="string">&quot;手机号码格式错误&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="字母和数字的验证"><a href="#字母和数字的验证" class="headerlink" title="字母和数字的验证"></a>字母和数字的验证</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 字母和数字的验证</span></span><br><span class="line">jQuery.<span class="property">validator</span>.<span class="title function_">addMethod</span>(<span class="string">&quot;chrnum&quot;</span>, <span class="keyword">function</span>(<span class="params">value, element</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> chrnum = <span class="regexp">/^([a-zA-Z0-9]+)$/</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">optional</span>(element) || (chrnum.<span class="title function_">test</span>(value));</span><br><span class="line">&#125;, <span class="string">&quot;只能输入数字和字母(字符A-Z, a-z, 0-9)&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="中文验证"><a href="#中文验证" class="headerlink" title="中文验证"></a>中文验证</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 中文验证</span></span><br><span class="line">jQuery.<span class="property">validator</span>.<span class="title function_">addMethod</span>(<span class="string">&quot;chinese&quot;</span>, <span class="keyword">function</span>(<span class="params">value, element</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> chinese = <span class="regexp">/^[\u4e00-\u9fa5]+$/</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">optional</span>(element) || (chinese.<span class="title function_">test</span>(value));</span><br><span class="line">&#125;, <span class="string">&quot;只能输入中文&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="IP地址验证"><a href="#IP地址验证" class="headerlink" title="IP地址验证"></a>IP地址验证</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// IP地址验证</span></span><br><span class="line">jQuery.<span class="property">validator</span>.<span class="title function_">addMethod</span>(<span class="string">&quot;ip&quot;</span>, <span class="keyword">function</span>(<span class="params">value, element</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> ip = <span class="regexp">/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.)&#123;3&#125;(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">optional</span>(element) || (ip.<span class="title function_">test</span>(value) &amp;&amp; (<span class="title class_">RegExp</span>.<span class="property">$1</span> &lt; <span class="number">256</span> &amp;&amp; <span class="title class_">RegExp</span>.<span class="property">$2</span> &lt; <span class="number">256</span> &amp;&amp; <span class="title class_">RegExp</span>.<span class="property">$3</span> &lt; <span class="number">256</span> &amp;&amp; <span class="title class_">RegExp</span>.<span class="property">$4</span> &lt; <span class="number">256</span>));</span><br><span class="line">&#125;, <span class="string">&quot;Ip地址格式错误&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="QQ号码验证"><a href="#QQ号码验证" class="headerlink" title="QQ号码验证"></a>QQ号码验证</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// QQ号码验证</span></span><br><span class="line">jQuery.<span class="property">validator</span>.<span class="title function_">addMethod</span>(<span class="string">&quot;qq&quot;</span>, <span class="keyword">function</span>(<span class="params">value, element</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> tel = <span class="regexp">/^[1-9]\d&#123;4,9&#125;$/</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">optional</span>(element) || (tel.<span class="title function_">test</span>(value));</span><br><span class="line">&#125;, <span class="string">&quot;QQ号码格式错误&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="电子邮箱验证"><a href="#电子邮箱验证" class="headerlink" title="电子邮箱验证"></a>电子邮箱验证</h2><figure class="highlight wren"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 电子邮箱验证</span></span><br><span class="line"><span class="variable">jQuery</span>.<span class="property">validator</span>.<span class="property">addMethod</span>(<span class="string">&quot;checkEmail&quot;</span>, <span class="title function_">function</span>(<span class="params">value</span>, <span class="params">element</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">email</span> <span class="operator">=</span> <span class="string">&quot;/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]&#123;2,&#125;)$/&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">optional</span>(<span class="variable">element</span>) <span class="operator">||</span> (<span class="variable">email</span>.<span class="property">test</span>(<span class="variable">value</span>));</span><br><span class="line">&#125;, <span class="string">&quot;电子邮箱格式错误&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="下拉框验证"><a href="#下拉框验证" class="headerlink" title="下拉框验证"></a>下拉框验证</h2><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 下拉框验证</span></span><br><span class="line">$.validator.addMethod(<span class="string">&quot;selectNone&quot;</span>, <span class="keyword">function</span>(<span class="params">value, element</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> value == <span class="string">&quot;请选择&quot;</span>;</span><br><span class="line">&#125;, <span class="string">&quot;必须选择一项&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="字节长度验证"><a href="#字节长度验证" class="headerlink" title="字节长度验证"></a>字节长度验证</h2><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 字节长度验证</span></span><br><span class="line">jQuery.validator.addMethod(<span class="string">&quot;byteRangeLength&quot;</span>, <span class="keyword">function</span>(<span class="params">value, element, param</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="built_in">length</span> = value.<span class="built_in">length</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; value.<span class="built_in">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (value.charCodeAt(i) &gt; <span class="number">127</span>) &#123;</span><br><span class="line">            <span class="built_in">length</span>++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> this.optional(element) || (<span class="built_in">length</span> &gt;= param[<span class="number">0</span>] &amp;&amp; <span class="built_in">length</span> &lt;= param[<span class="number">1</span>]);</span><br><span class="line">&#125;, $.validator.format(<span class="string">&quot;请确保输入的值在&#123;0&#125;-&#123;1&#125;个字节之间(一个中文字算2个字节)&quot;</span>));</span><br></pre></td></tr></table></figure><h2 id="电话号码验证"><a href="#电话号码验证" class="headerlink" title="电话号码验证"></a>电话号码验证</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 电话号码验证</span></span><br><span class="line">jQuery.<span class="property">validator</span>.<span class="title function_">addMethod</span>(<span class="string">&quot;phone&quot;</span>, <span class="keyword">function</span>(<span class="params">value, element</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> tel = <span class="regexp">/^(0[0-9]&#123;2,3&#125;\-)?([2-9][0-9]&#123;6,7&#125;)+(\-[0-9]&#123;1,4&#125;)?$/</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">optional</span>(element) || (tel.<span class="title function_">test</span>(value));</span><br><span class="line">&#125;, <span class="string">&quot;电话号码格式错误&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="邮政编码验证"><a href="#邮政编码验证" class="headerlink" title="邮政编码验证"></a>邮政编码验证</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 邮政编码验证</span></span><br><span class="line">jQuery.<span class="property">validator</span>.<span class="title function_">addMethod</span>(<span class="string">&quot;zipCode&quot;</span>, <span class="keyword">function</span>(<span class="params">value, element</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> tel = <span class="regexp">/^[0-9]&#123;6&#125;$/</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">optional</span>(element) || (tel.<span class="title function_">test</span>(value));</span><br><span class="line">&#125;, <span class="string">&quot;邮政编码格式错误&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="验证名称是否重复"><a href="#验证名称是否重复" class="headerlink" title="验证名称是否重复"></a>验证名称是否重复</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//验证名称是否重复</span></span><br><span class="line">jQuery.validator.<span class="title function_ invoke__">addMethod</span>(<span class="string">&quot;checkName&quot;</span>, function(value, element) &#123;</span><br><span class="line">    <span class="keyword">var</span> returnMsg = <span class="literal">true</span>;</span><br><span class="line">    jQuery.<span class="title function_ invoke__">ajax</span>(&#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&quot;get&quot;</span>,</span><br><span class="line">        <span class="attr">url</span>: <span class="string">&quot;url&quot;</span>,  </span><br><span class="line">        <span class="attr">async</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">cache</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">data</span>: &#123;   </span><br><span class="line">            <span class="attr">toinName</span>: value,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&quot;get&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">dataType</span>:<span class="string">&quot;html&quot;</span>,</span><br><span class="line">        <span class="attr">scriptCharset</span>:<span class="string">&quot;UTF-8&quot;</span>,</span><br><span class="line">        <span class="attr">success</span>:function(msg) &#123;</span><br><span class="line">            <span class="keyword">if</span>(msg == <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">                returnMsg=<span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);  </span><br><span class="line">    <span class="keyword">return</span> returnMsg;</span><br><span class="line">&#125;, <span class="string">&quot;此名称已经被占用！请您更换其它名称&quot;</span>);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript </category>
          
          <category> 面对对象 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> jQuery </tag>
            
            <tag> 正则 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VScode常用扩展插件</title>
      <link href="/posts/2a1268b5/"/>
      <url>/posts/2a1268b5/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="VScode插件"><a href="#VScode插件" class="headerlink" title="VScode插件"></a>VScode插件</h1><h2 id="主题及图标"><a href="#主题及图标" class="headerlink" title="主题及图标"></a>主题及图标</h2><table><thead><tr><th>插件名</th><th>功能</th></tr></thead><tbody><tr><td>One Dark Pro</td><td><code>VScode</code>的最佳选择</td></tr><tr><td>GitHub Theme</td><td>黑白两款皮肤</td></tr><tr><td>Material Theme</td><td>集成了多种主题皮肤，搭配<code>Material Icon Theme</code>更佳</td></tr><tr><td>Material Icon Theme</td><td>扁平化的主题图标库</td></tr><tr><td>vscode-icons</td><td><code>VScode</code>官方图标库，为<code>VScode</code>资源目录树加上图标</td></tr><tr><td>Emoji</td><td>按<code>f1</code>输入<code>emoji</code>，可以看到有三个选项，分别是<br />      1、<code>emoji</code>表情<br />      2、<code>markdown</code>下的<code>emoji</code><br />      3、<code>unicode</code>下的<code>emoji</code><br />选中一个模式回车进入列表，再回车即可输入到代码中</td></tr><tr><td>:emojisense:</td><td>快捷键：<code>ctrl + i</code></td></tr></tbody></table><h2 id="功能强化"><a href="#功能强化" class="headerlink" title="功能强化"></a>功能强化</h2><table><thead><tr><th>插件名</th><th>功能</th></tr></thead><tbody><tr><td>Chinese (Simplified) Language Pack for<br />Visual Studio Code</td><td>编辑器汉化语言包<br />在<code>locale.json</code>中添加<code>&quot;locale&quot;: &quot;zh-cn&quot;</code>，即可载入中文（简体）语言包</td></tr><tr><td>Code Runner</td><td>代码运行器，快捷键：<code>Ctrl + Alt + M</code>，一键运行多种语言运行代码片段或代码文件</td></tr><tr><td>Debugger for Chrome</td><td>前端调试</td></tr><tr><td>Image Preview</td><td>鼠标悬浮在链接上，可预览图片</td></tr><tr><td>Live Server</td><td>本地静态服务器</td></tr><tr><td>Markdown Preview Enhanced</td><td><code>markdown</code>编辑和预览，边编辑<code>markdonwn</code>边预览</td></tr><tr><td>Regex Previewer</td><td>预览正则表达式效果</td></tr><tr><td>settings sync</td><td><code>VScode</code>配置同步到云端，同步所有设置和插件</td></tr><tr><td>SVG Viewer</td><td>预览<code>SVG</code>文件</td></tr><tr><td>TODO Tree</td><td>使用<code>TODO</code>来标记代码，提高可读性；<br />提供可视化窗口来查看和管理<code>TODO Tree</code></td></tr><tr><td>wakatime</td><td>编程时间及行为跟踪统计</td></tr></tbody></table><h2 id="Git-集成"><a href="#Git-集成" class="headerlink" title="Git 集成"></a>Git 集成</h2><table><thead><tr><th>插件名</th><th>功能</th></tr></thead><tbody><tr><td>GitHub Pull requests</td><td>在<code>VScode</code>中查看和管理<code>GitHub</code>拉取请求和问题</td></tr><tr><td>Git Graph</td><td><code>Git</code>图形化显示和操作</td></tr><tr><td>GitHistory</td><td>可查看和搜索<code>Git</code>日志以及图形和详细信息；<br />同时还支持分支比较，分支管理等操作</td></tr></tbody></table><h2 id="编程美化"><a href="#编程美化" class="headerlink" title="编程美化"></a>编程美化</h2><table><thead><tr><th>插件名</th><th>功能</th></tr></thead><tbody><tr><td>Beautify</td><td>在代码文件右键鼠标一键格式化<code>HTML</code>、<code>JS</code>、<code>CSS</code></td></tr><tr><td>Beautify css&#x2F;sass&#x2F;scss&#x2F;less</td><td></td></tr><tr><td>Bracket Pair Colorizer</td><td>因为此功能现在内置于<code>VScode</code>，此扩展已弃用</td></tr><tr><td>Bracket Pair Colorizer 2</td><td>常用括号显示不同颜色，让层次结构一目了然；<br />还支持用户自定义符号</td></tr><tr><td>change-case</td><td>更改命名风格</td></tr><tr><td>Codelf</td><td>给变量起名的神器</td></tr><tr><td>Code Spell Checker</td><td>拼写检查程序，检查不常见的单词，如果单词拼写错误，会给出警告提示</td></tr><tr><td>Color Info</td><td>提供<code>CSS</code>中使用颜色的相关信息<br />只需在颜色上悬停光标，就可以预览色块中色彩模型的（<code>HEX</code>、<code>RGB</code>、<code>HSL</code>、<code>CMYK</code>）相关信息</td></tr><tr><td>Color Picker</td><td>输入<code>pick color</code>，调出调色板</td></tr><tr><td>EditorConfig for VS Code</td><td>代码风格统一</td></tr><tr><td>formate: CSS&#x2F;LESS&#x2F;SCSS formatter</td><td><code>CSS</code>样式美化，<code>VScode</code>内置<code>CSS</code>格式化功能，支持<code>less</code>、<code>scss</code></td></tr><tr><td>Highlight Matching Tag</td><td>突出显示匹配的开始&#x2F;结束标签</td></tr><tr><td>Minify</td><td>用于压缩合并<code>JS</code>和<code>CSS</code>文件的应用程序；<code>&lt;br /&gt;</code>提供自定义设置，以及自动压缩保存并导出为<code>.min</code>文件的选项；<code>&lt;br /&gt;</code>可分别通过<code>uglify-js</code>、<code>clean-css</code>、<code>html-minifier</code>与<code>JS</code>、<code>CSS</code>、<code>HTML</code>协同工作</td></tr><tr><td>Prettier - Code formatter</td><td>自动格式化代</td></tr><tr><td>Trailing Spaces</td><td>显示尾随空格</td></tr></tbody></table><h2 id="绘图"><a href="#绘图" class="headerlink" title="绘图"></a>绘图</h2><table><thead><tr><th>插件名</th><th>功能</th></tr></thead><tbody><tr><td>Markmap</td><td>思维导图神器</td></tr><tr><td>Polacode</td><td>代码截图</td></tr><tr><td>Polacode-2020</td><td>可将代码转化成图片</td></tr><tr><td>vscode-drawio</td><td>可在<code>VScode</code>里画流程图<br />新建<code>.drawio</code>后缀文件并拖入<code>VScode</code>中，即可得到流程图界面</td></tr></tbody></table><h2 id="前端开发"><a href="#前端开发" class="headerlink" title="前端开发"></a>前端开发</h2><table><thead><tr><th>插件名</th><th>功能</th></tr></thead><tbody><tr><td>Auto Complate Tag</td><td>自动添加<code>HTML/XML</code>关闭标签</td></tr><tr><td>Auto Close Tag</td><td>自动添加<code>HTML/XML</code>关闭标签</td></tr><tr><td>Auto Rename Tag</td><td>自动重命名配对的<code>HTML/XML</code>标记，修改开始标签，结束标签会同步修改</td></tr><tr><td>canvas-snippets</td><td></td></tr><tr><td>css-auto-prefix</td><td></td></tr><tr><td>CSS Peek</td><td><code>CSS</code>样式查看器，可快速查看<code>CSS</code>样式，非常方便快捷</td></tr><tr><td>ESLint</td><td>规范<code>js</code>代码书写规则，可自定义规则</td></tr><tr><td>HTML Boilerplate</td><td>使用<code>HTML</code>模版，避免重写<code>HTML</code>头部和正文标签的苦恼。<br />在空文件中输入<code>HTML</code>，并按<code>Tab</code>键，即可生成干净的文档结构</td></tr><tr><td>HTML Snippets</td><td><code>HTML</code>代码片段，该插件可为你提供<code>HTML</code>标签的代码提示，不用键入尖括号了</td></tr><tr><td>JavaScript (ES6) code snippets</td><td><code>ES6</code>语法智能提示，以及快速输入</td></tr><tr><td>json2ts</td><td>自动把<code>json</code>格式转成<code>ts</code>的类型，复制<code>json</code>之后按<code>ctrl + alt + v</code>即可</td></tr><tr><td>koroFileHeader</td><td>自动添加头部注释和函数注释的插件；<br />支持自定义内容，需要在<code>settings.json</code>中进行自定义配置</td></tr><tr><td>Live Sass Compiler</td><td><code>SASS</code>实时编译</td></tr><tr><td>npm</td><td>支持运行<code>package.json</code>文件中定义的<code>npm</code>脚本<br />根据<code>package.json</code>中定义的依赖项验证已安装的模块</td></tr><tr><td>Npm Intellisense</td><td>可自动完成导入语句中的<code>npm</code>模块</td></tr><tr><td>open in browser</td><td>快速打开<code>HTML</code>文件到浏览器预览</td></tr><tr><td>Path Intellisense</td><td>智能路径提示，方便快速引入文件</td></tr><tr><td>px to rem &amp; rpx (cssrem)</td><td>自动换算单位的插件，自动换算单位的插件</td></tr><tr><td>Turbo Console Log</td><td>快速添加<code>console.log</code>信息，<code>JS debug</code>必备快捷键<br />      1、<code>ctrl + alt + l</code>选中变量之后，使用这个快捷键生成<code>console.log</code><br />      2、<code>alt + shift + c</code>注释所有<code>console.log</code><br />      3、<code>alt + shift + u</code>启用所有<code>console.log</code><br />      4、<code>alt + shift + d</code>删除所有<code>console.log</code></td></tr><tr><td>Vetur</td><td><code>Vue</code>开发者必备，内含<code>语法高亮</code>、<code>智能提示</code>、<code>emmet</code>、<code>错误提示</code>、<code>格式化</code>、<code>自动补全</code>、<code>debugger</code>等实用功能</td></tr></tbody></table><h2 id="数据库及数据分析"><a href="#数据库及数据分析" class="headerlink" title="数据库及数据分析"></a>数据库及数据分析</h2><table><thead><tr><th>插件名</th><th>功能</th></tr></thead><tbody><tr><td>Data Preview</td><td>预览数据文件</td></tr><tr><td>MongoDB for VS Code</td><td><code>MongoDB</code>数据库支持</td></tr><tr><td>MySQL</td><td>支持<code>MySQL/MariaDB</code>、<code>Microsoft SQL Server</code>、<code>PostgreSQL</code>、<code>Redis</code>、<code>ElasticSearch</code></td></tr><tr><td>Oracle Developer Tools for VS Code</td><td><code>Oracle</code>数据库支持</td></tr><tr><td>Sort lines</td><td>对当前文本排序</td></tr><tr><td>SQL Server (mssql)</td><td><code>Microsoft SQL Server</code>数据库支持</td></tr></tbody></table><h2 id="摸鱼插件"><a href="#摸鱼插件" class="headerlink" title="摸鱼插件"></a>摸鱼插件</h2><table><thead><tr><th>插件名</th><th>功能</th></tr></thead><tbody><tr><td>LeetCode</td><td>刷题神器</td></tr><tr><td>VSC Netease Music</td><td>网易云音乐（程序员版）</td></tr><tr><td>daily anime</td><td>追番神器</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> VScode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 扩展插件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webpack 和 gulp 的区别</title>
      <link href="/posts/633a1a9/"/>
      <url>/posts/633a1a9/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><table><thead><tr><th></th><th>gulp</th><th>webpack</th></tr></thead><tbody><tr><td>定位</td><td>强调：规范前端开发的流程</td><td>前端模块化方案</td></tr><tr><td>目标</td><td>自动化和优化开发工作流，为通用website开发而生</td><td>通用模块打包加载器，为移动端大型SPA应用而生</td></tr><tr><td>学习难度</td><td>易于学习，易于使用，api总共只有5个方法</td><td>有大量新的概念和api，有详尽的官方文档</td></tr><tr><td>使用场景</td><td>基于流的作用方式，合适多页面应用开发</td><td>一切皆模块的特点，适合单页面应用开发</td></tr><tr><td>作业方式</td><td>对输入（gulp.src）的js，ts，scss，less等资源文件进行打包（bundle）、编译（compile）、压缩、重命名等处理后（guld.dest）到指定目录中去，为了构建而打包</td><td>对入口文件（entry）递归解析生成依赖关系图，然后将所有以来打包在一起，在打包之前将所有依赖转译成可打包的js模块，为了打包而构建</td></tr><tr><td>使用方式</td><td>常规js开发，编写一些列构建任务（task）</td><td>编辑各种JSON配置</td></tr><tr><td>优点</td><td>适合多页面开发，易于学习，易于使用，接口优雅</td><td>可以打包一切资源，适配各种模块系统</td></tr><tr><td>缺点</td><td>在大页面应用方面输出乏力，而且对流行的大页面技术有些难以处理(比如vue但文件组织，使用gulp处理就会很困难，而webpack一个loader就能轻松搞定)</td><td>不适合多页应用开发，灵活度高但同时配置很繁琐复杂，”打包一切”这个优点对于HTTP1.1尤其重要，因为所有资源打包在一起能明显减少浏览器访问页面时的请求数量，从而减少应用程序必须等待的时间。但这个有点可能会随着HTTP&#x2F;2的流行而变得不那么突出，因为HTTP&#x2F;2的多路复用可以有效解决客服端并行请求的瓶颈问题。</td></tr><tr><td>结论</td><td>浏览器多页应用（MPA）首选方案</td><td>浏览器单页应用（SPA）首选方案</td></tr><tr><td></td><td>是一个基于流的自动化构建工具，不包括模块化的功能，通过配置一系列的task，例如文件压缩合并、雪碧图、启动server、版本控制等，然后定义执行顺序来让gulp执行task，从而构建前端项目的流程</td><td>是一个自动化模块打包工具，把开发中的所有资源（图片、js文件、css文件等）都看成模块，通过loader（加载器）和plugins（插件）对资源进行处理，划分成不同的模块，需要哪个加载哪个，实现按需加载的功能，入口引入的更多是js文件</td></tr></tbody></table><h2 id="gulp和webpack的对比："><a href="#gulp和webpack的对比：" class="headerlink" title="gulp和webpack的对比："></a>gulp和webpack的对比：</h2><p>gulp 是工具链、构建工具，可以配合各种插件做js压缩，css压缩，less编译 替代手工实现自动化工作</p><ol><li>构建工具</li><li>自动化</li><li>提高效率用</li></ol><p>webpack 是文件打包工具，可以把项目的各种js文、css文件等打包合并成一个或多个文件，主要用于模块化方案，预编译模块的方案</p><ol><li>打包工具</li><li>模块化</li><li>编译模块代码方案</li></ol>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> 打包/封装 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> gulp </tag>
            
            <tag> webpack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vuejs目录结构</title>
      <link href="/posts/334d8235/"/>
      <url>/posts/334d8235/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://www.runoob.com/wp-content/uploads/2017/01/B6E593E3-F284-4C58-A610-94C6ACDAD485.jpg" alt="img"></p><table><thead><tr><th>目录&#x2F;文件</th><th>说明</th></tr></thead><tbody><tr><td>build</td><td>项目构建(webpack)相关代码</td></tr><tr><td>config</td><td>配置目录，包括端口号等。我们初学可以使用默认的。</td></tr><tr><td>node_modules</td><td>npm 加载的项目依赖模块</td></tr><tr><td>src</td><td>要开发的目录，基本上要做的事情都在这个目录里。<br />里面包含了几个目录及文件：<br />* assets: 放置一些图片，如logo等。<br />* components: 目录里面放了一个组件文件，可以不用。<br />* App.vue: 项目入口文件，我们也可以直接将组件写这里，而不使用 components 目录。<br />* main.js: 项目的核心文件。</td></tr><tr><td>static</td><td>静态资源目录，如图片、字体等。</td></tr><tr><td>test</td><td>初始测试目录，可删除</td></tr><tr><td>.xxxx文件</td><td>这些是一些配置文件，包括语法配置，git配置等。</td></tr><tr><td>index.html</td><td>首页入口文件，你可以添加一些 meta 信息或统计代码啥的。</td></tr><tr><td>package.json</td><td>项目配置文件。</td></tr><tr><td>README.md</td><td>项目的说明文档，markdown 格式</td></tr></tbody></table><p>重新打开页面 <a href="http://localhost:8080/%EF%BC%8C%E4%B8%80%E8%88%AC%E4%BF%AE%E6%94%B9%E5%90%8E%E4%BC%9A%E8%87%AA%E5%8A%A8%E5%88%B7%E6%96%B0%EF%BC%8C%E6%98%BE%E7%A4%BA%E6%95%88%E6%9E%9C%E5%A6%82%E4%B8%8B%E6%89%80%E7%A4%BA![img](https://www.runoob.com/wp-content/uploads/2017/01/AEDE7289-0479-4F14-A9C9-898470E5620E.jpg)">http://localhost:8080/，一般修改后会自动刷新，显示效果如下所示![img](https://www.runoob.com/wp-content/uploads/2017/01/AEDE7289-0479-4F14-A9C9-898470E5620E.jpg)</a></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Axios封装 + API接口管理</title>
      <link href="/posts/74c981b0/"/>
      <url>/posts/74c981b0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Axios封装-API接口管理"><a href="#Axios封装-API接口管理" class="headerlink" title="Axios封装 + API接口管理"></a>Axios封装 + API接口管理</h1><p>axios的封装和api接口的统一管理，其实主要目的就是在帮助我们简化代码和利于后期的更新维护。</p><h2 id="axios的封装"><a href="#axios的封装" class="headerlink" title="axios的封装"></a>axios的封装</h2><p>在vue项目中，和后台交互获取数据这块，我们通常使用的是axios库，它是基于promise的http库，可运行在浏览器端和node.js中。</p><p>优秀的特性，例如拦截请求和响应、取消请求、转换json、客户端防御XSRF等。</p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install axios; <span class="regexp">//</span> 安装axios复制代码</span><br></pre></td></tr></table></figure><h3 id="引入"><a href="#引入" class="headerlink" title="引入"></a>引入</h3><p>在项目的src目录中，新建一个request文件夹，然后在里面新建一个http.js和一个api.js文件。http.js文件用来封装axios，api.js用来统一管理接口。</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在http.js中引入axios</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>; <span class="comment">// 引入axios</span></span><br><span class="line"><span class="keyword">import</span> QS <span class="keyword">from</span> <span class="string">&#x27;qs&#x27;</span>; <span class="comment">// 引入qs模块，用来序列化post类型的数据</span></span><br><span class="line"><span class="comment">// vant的toast提示框组件，大家可根据自己的ui组件更改。</span></span><br><span class="line"><span class="keyword">import</span> &#123; Toast &#125; <span class="keyword">from</span> <span class="string">&#x27;vant&#x27;</span>; </span><br></pre></td></tr></table></figure><h3 id="环境切换"><a href="#环境切换" class="headerlink" title="环境切换"></a>环境切换</h3><p>项目环境可能有开发环境、测试环境和生产环境。</p><p>通过node的环境变量来匹配我默认的接口url前缀。axios.defaults.baseURL可以设置axios的默认请求地址。</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 环境的切换</span></span><br><span class="line"><span class="keyword">if</span> (process.<span class="keyword">env</span>.NODE_ENV == <span class="string">&#x27;development&#x27;</span>) &#123;  </span><br><span class="line">    axios.defaults.baseURL = <span class="string">&#x27;https://www.baidu.com&#x27;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (process.<span class="keyword">env</span>.NODE_ENV == <span class="string">&#x27;debug&#x27;</span>) &#123;  </span><br><span class="line">    axios.defaults.baseURL = <span class="string">&#x27;https://www.ceshi.com&#x27;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (process.<span class="keyword">env</span>.NODE_ENV == <span class="string">&#x27;production&#x27;</span>) &#123;  </span><br><span class="line">    axios.defaults.baseURL = <span class="string">&#x27;https://www.production.com&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="设置请求超时"><a href="#设置请求超时" class="headerlink" title="设置请求超时"></a>设置请求超时</h3><p>通过axios.defaults.timeout设置默认的请求超时时间。例如超过了10s，就会告知用户当前请求超时，请刷新等。</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">axios.defaults.timeout</span> = <span class="number">10000</span><span class="comment">;</span></span><br></pre></td></tr></table></figure><h3 id="post请求头的设置"><a href="#post请求头的设置" class="headerlink" title="post请求头的设置"></a>post请求头的设置</h3><p>post请求的时候，加上一个请求头，在这里进行一个默认的设置，即设置post的请求头为 <code>application/x-www-form-urlencoded;charset=UTF-8</code></p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">axios.defaults.headers.post[<span class="symbol">&#x27;Content</span>-<span class="keyword">Type</span>&#x27;] = <span class="symbol">&#x27;application</span>/x-www-form-urlencoded;charset=UTF-<span class="number">8</span>&#x27;;</span><br></pre></td></tr></table></figure><ul><li>请求拦截</li></ul><p>在发送请求前可以进行一个请求的拦截，为什么要拦截呢，我们拦截请求是用来做什么的呢？比如，有些请求是需要用户登录之后才能访问的，或者post请求的时候，我们需要序列化我们提交的数据。这时候，我们可以在请求被发送之前进行一个拦截，从而进行我们想要的操作。</p><h3 id="请求拦截"><a href="#请求拦截" class="headerlink" title="请求拦截"></a>请求拦截</h3><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 先导入vuex,因为我们要使用到里面的状态对象</span></span><br><span class="line"><span class="comment">// vuex的路径根据自己的路径去写</span></span><br><span class="line">import store from &#x27;@/store/index&#x27;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 请求拦截器axios.interceptors.request.use(  </span></span><br><span class="line">    config =&gt; &#123;  </span><br><span class="line">        <span class="comment">// 每次发送请求之前判断vuex中是否存在token  </span></span><br><span class="line">        <span class="comment">// 如果存在，则统一在http请求的header都加上token，这样后台根据token判断你的登录情况</span></span><br><span class="line">        <span class="comment">// 即使本地存在token，也有可能token是过期的，所以在响应拦截器中要对返回状态进行判断 </span></span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">token</span> = store.state.<span class="keyword">token</span>;  </span><br><span class="line">        <span class="keyword">token</span> &amp;&amp; (config.headers.Authorization = <span class="keyword">token</span>);  </span><br><span class="line">        <span class="keyword">return</span> config;  </span><br><span class="line">    &#125;,  </span><br><span class="line">    <span class="keyword">error</span> =&gt; &#123;  </span><br><span class="line">        <span class="keyword">return</span> Promise.<span class="keyword">error</span>(<span class="keyword">error</span>);  </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>这里说一下token，一般是在登录完成之后，将用户的token通过localStorage或者cookie存在本地，然后用户每次在进入页面的时候（即在main.js中），会首先从本地存储中读取token，如果token存在说明用户已经登陆过，则更新vuex中的token状态。然后，在每次请求接口的时候，都会在请求的header中携带token，后台人员就可以根据你携带的token来判断你的登录是否过期，如果没有携带，则说明没有登录过。这时候或许有些小伙伴会有疑问了，就是每个请求都携带token，那么要是一个页面不需要用户登录就可以访问的怎么办呢？其实，你前端的请求可以携带token，但是后台可以选择不接收啊！</p><h3 id="响应的拦截"><a href="#响应的拦截" class="headerlink" title="响应的拦截"></a>响应的拦截</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 响应拦截器</span></span><br><span class="line">axios.interceptors.response.<span class="keyword">use</span>(  </span><br><span class="line">    response =&gt; &#123;   </span><br><span class="line">        <span class="comment">// 如果返回的状态码为200，说明接口请求成功，可以正常拿到数据   </span></span><br><span class="line">        <span class="comment">// 否则的话抛出错误</span></span><br><span class="line">        <span class="keyword">if</span> (response.status === <span class="number">200</span>) &#123;  </span><br><span class="line">            <span class="keyword">return</span> Promise.<span class="title function_ invoke__">resolve</span>(response);  </span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;  </span><br><span class="line">            <span class="keyword">return</span> Promise.<span class="title function_ invoke__">reject</span>(response);  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;,  </span><br><span class="line">    <span class="comment">// 服务器状态码不是2开头的的情况</span></span><br><span class="line">    <span class="comment">// 这里可以跟你们的后台开发人员协商好统一的错误状态码  </span></span><br><span class="line">    <span class="comment">// 然后根据返回的状态码进行一些操作，例如登录过期提示，错误提示等等</span></span><br><span class="line">    <span class="comment">// 下面列举几个常见的操作，其他需求可自行扩展</span></span><br><span class="line">    error =&gt; &#123;  </span><br><span class="line">        <span class="keyword">if</span> (error.response.status) &#123;  </span><br><span class="line">            <span class="keyword">switch</span> (error.response.status) &#123;  </span><br><span class="line">                <span class="comment">// 401: 未登录</span></span><br><span class="line">                <span class="comment">// 未登录则跳转登录页面，并携带当前页面的路径</span></span><br><span class="line">                <span class="comment">// 在登录成功后返回当前页面，这一步需要在登录页操作。  </span></span><br><span class="line">                <span class="keyword">case</span> <span class="number">401</span>:  </span><br><span class="line">                    router.<span class="title function_ invoke__">replace</span>(&#123;    </span><br><span class="line">                        <span class="attr">path</span>: <span class="string">&#x27;/login&#x27;</span>,    </span><br><span class="line">                        <span class="attr">query</span>: &#123; </span><br><span class="line">                            <span class="attr">redirect</span>: router.currentRoute.fullPath </span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 403 token过期</span></span><br><span class="line">                <span class="comment">// 登录过期对用户进行提示</span></span><br><span class="line">                <span class="comment">// 清除本地token和清空vuex中token对象</span></span><br><span class="line">                <span class="comment">// 跳转登录页面  </span></span><br><span class="line">                <span class="keyword">case</span> <span class="number">403</span>:</span><br><span class="line">                     <span class="title function_ invoke__">Toast</span>(&#123;</span><br><span class="line">                        <span class="attr">message</span>: <span class="string">&#x27;登录过期，请重新登录&#x27;</span>,</span><br><span class="line">                        <span class="attr">duration</span>: <span class="number">1000</span>,</span><br><span class="line">                        <span class="attr">forbidClick</span>: <span class="literal">true</span></span><br><span class="line">                    &#125;);</span><br><span class="line">                    <span class="comment">// 清除token</span></span><br><span class="line">                    localStorage.<span class="title function_ invoke__">removeItem</span>(<span class="string">&#x27;token&#x27;</span>);</span><br><span class="line">                    store.<span class="title function_ invoke__">commit</span>(<span class="string">&#x27;loginSuccess&#x27;</span>, <span class="literal">null</span>);</span><br><span class="line">                    <span class="comment">// 跳转登录页面，并将要浏览的页面fullPath传过去，登录成功后跳转需要访问的页面 </span></span><br><span class="line">                    <span class="title function_ invoke__">setTimeout</span>(() =&gt; &#123;    </span><br><span class="line">                        router.<span class="title function_ invoke__">replace</span>(&#123;        </span><br><span class="line">                            <span class="attr">path</span>: <span class="string">&#x27;/login&#x27;</span>,        </span><br><span class="line">                            <span class="attr">query</span>: &#123; </span><br><span class="line">                                <span class="attr">redirect</span>: router.currentRoute.fullPath </span><br><span class="line">                            &#125;    </span><br><span class="line">                        &#125;);  </span><br><span class="line">                    &#125;, <span class="number">1000</span>);  </span><br><span class="line">                    <span class="keyword">break</span>; </span><br><span class="line"></span><br><span class="line">                <span class="comment">// 404请求不存在</span></span><br><span class="line">                <span class="keyword">case</span> <span class="number">404</span>:</span><br><span class="line">                    <span class="title function_ invoke__">Toast</span>(&#123;</span><br><span class="line">                        <span class="attr">message</span>: <span class="string">&#x27;网络请求不存在&#x27;</span>,</span><br><span class="line">                        <span class="attr">duration</span>: <span class="number">1500</span>,</span><br><span class="line">                        <span class="attr">forbidClick</span>: <span class="literal">true</span></span><br><span class="line">                    &#125;);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="comment">// 其他错误，直接抛出错误提示</span></span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    <span class="title function_ invoke__">Toast</span>(&#123;</span><br><span class="line">                        <span class="attr">message</span>: error.response.data.message,</span><br><span class="line">                        <span class="attr">duration</span>: <span class="number">1500</span>,</span><br><span class="line">                        <span class="attr">forbidClick</span>: <span class="literal">true</span></span><br><span class="line">                    &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> Promise.<span class="title function_ invoke__">reject</span>(error.response);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>响应拦截器很好理解，就是服务器返回给我们的数据，我们在拿到之前可以对他进行一些处理。例如上面的思想：如果后台返回的状态码是200，则正常返回数据，否则的根据错误的状态码类型进行一些我们需要的错误，其实这里主要就是进行了错误的统一处理和没登录或登录过期后调整登录页的一个操作。</p><p><strong>要注意的是，上面的Toast()方法，是我引入的vant库中的toast轻提示组件，你根据你的ui库，对应使用你的一个提示组件。</strong></p><h3 id="封装get方法和post方法"><a href="#封装get方法和post方法" class="headerlink" title="封装get方法和post方法"></a>封装get方法和post方法</h3><p>我们常用的ajax请求方法有get、post、put等方法，相信小伙伴都不会陌生。axios对应的也有很多类似的方法，不清楚的可以看下文档。但是为了简化我们的代码，我们还是要对其进行一个简单的封装。下面我们主要封装两个方法：get和post。</p><p> <strong>get方法</strong> ：我们通过定义一个get函数，get函数有两个参数，第一个参数表示我们要请求的url地址，第二个参数是我们要携带的请求参数。get函数返回一个promise对象，当axios其请求成功时resolve服务器返回 值，请求失败时reject错误值。最后通过export抛出get函数。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * get方法，对应get请求</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; url [请求的url地址]</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; params [请求时携带的参数]</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">get</span>(<span class="params">url, params</span>)&#123;  </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span>&#123;  </span><br><span class="line">        axios.<span class="title function_">get</span>(url, &#123;  </span><br><span class="line">            <span class="attr">params</span>: params  </span><br><span class="line">        &#125;).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">resolve</span>(res.<span class="property">data</span>);</span><br><span class="line">        &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span>&#123;</span><br><span class="line">            <span class="title function_">reject</span>(err.<span class="property">data</span>)  </span><br><span class="line">    &#125;)  </span><br><span class="line">&#125;);&#125;</span><br></pre></td></tr></table></figure><p> <strong>post方法：</strong> 原理同get基本一样，但是要注意的是，post方法必须要使用对提交从参数对象进行序列化的操作，所以这里我们通过node的qs模块来序列化我们的参数。这个很重要，如果没有序列化操作，后台是拿不到你提交的数据的。这就是文章开头我们import QS from ‘qs’;的原因。如果不明白序列化是什么意思的，就百度一下吧，答案一大堆。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * post方法，对应post请求 </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; url [请求的url地址] </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; params [请求时携带的参数] </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">post</span>(<span class="params">url, params</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">         axios.<span class="title function_">post</span>(url, <span class="variable constant_">QS</span>.<span class="title function_">stringify</span>(params))</span><br><span class="line">        .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">resolve</span>(res.<span class="property">data</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span>&#123;</span><br><span class="line">            <span class="title function_">reject</span>(err.<span class="property">data</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里有个小细节说下，<code>axios.get()</code>方法和 <code>axios.post()</code>在提交数据时参数的书写方式还是有区别的。区别就是，get的第二个参数是一个{}，然后这个对象的params属性值是一个参数对象的。而post的第二个参数就是一个参数对象。两者略微的区别要留意哦！</p><h2 id="axios的封装基本就完成了，下面再简单说下api的统一管理。"><a href="#axios的封装基本就完成了，下面再简单说下api的统一管理。" class="headerlink" title="axios的封装基本就完成了，下面再简单说下api的统一管理。"></a>axios的封装基本就完成了，下面再简单说下api的统一管理。</h2><p>整齐的api就像电路板一样，即使再复杂也能很清晰整个线路。上面说了，我们会新建一个api.js,然后在这个文件中存放我们所有的api接口。</p><ul><li>首先我们在api.js中引入我们封装的get和post方法</li></ul><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**   </span></span><br><span class="line"><span class="comment"> * api接口统一管理</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">get</span>, post &#125; <span class="keyword">from</span> <span class="string">&#x27;./http&#x27;</span></span><br></pre></td></tr></table></figure><p>现在，例如我们有这样一个接口，是一个post请求：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span>www.baiodu.com<span class="regexp">/api/</span>v1<span class="regexp">/users/my</span>_address/address_edit_before</span><br></pre></td></tr></table></figure><p>我们可以在api.js中这样封装：</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> apiAddress = p =&gt; post(<span class="string">&#x27;api/v1/users/my_address/address_edit_before&#x27;</span>, p);</span><br></pre></td></tr></table></figure><p>我们定义了一个 <code>apiAddress</code>方法，这个方法有一个参数p，p是我们请求接口时携带的参数对象。而后调用了我们封装的 <code>post</code>方法，<code>post</code>方法的第一个参数是我们的接口地址，第二个参数是 <code>apiAddress</code>的p参数，即请求接口时携带的参数对象。最后通过export导出 <code>apiAddress</code>。</p><p>然后在我们的页面中可以这样调用我们的api接口：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; apiAddress &#125; <span class="keyword">from</span> <span class="string">&#x27;@/request/api&#x27;</span>;<span class="comment">// 导入我们的api接口</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;  </span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Address&#x27;</span>,  </span><br><span class="line">    created () &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">onLoad</span>();</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">methods</span>: &#123;  </span><br><span class="line">        <span class="comment">// 获取数据  </span></span><br><span class="line">        <span class="title function_">onLoad</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="comment">// 调用api接口，并且提供了两个参数  </span></span><br><span class="line">            <span class="title function_">apiAddress</span>(&#123;  </span><br><span class="line">                <span class="attr">type</span>: <span class="number">0</span>,  </span><br><span class="line">                <span class="attr">sort</span>: <span class="number">1</span>  </span><br><span class="line">            &#125;).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="comment">// 获取数据成功后的其他操作</span></span><br><span class="line">                ………………  </span><br><span class="line">            &#125;)  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其他的api接口，就在pai.js中继续往下面扩展就可以了。友情提示，为每个接口写好注释哦！！！</p><p>api接口管理的一个好处就是，我们把api统一集中起来，如果后期需要修改接口，我们就直接在api.js中找到对应的修改就好了，而不用去每一个页面查找我们的接口然后再修改会很麻烦。关键是，万一修改的量比较大，就规格gg了。还有就是如果直接在我们的业务代码修改接口，一不小心还容易动到我们的业务代码造成不必要的麻烦。</p><p>好了，最后把完成的axios封装代码奉上。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**axios封装</span></span><br><span class="line"><span class="comment"> * 请求拦截、相应拦截、错误统一处理</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;<span class="keyword">import</span> <span class="variable constant_">QS</span> <span class="keyword">from</span> <span class="string">&#x27;qs&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Toast</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;vant&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;../store/index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 环境的切换</span></span><br><span class="line"><span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> == <span class="string">&#x27;development&#x27;</span>) &#123;  </span><br><span class="line">    axios.<span class="property">defaults</span>.<span class="property">baseURL</span> = <span class="string">&#x27;/api&#x27;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> == <span class="string">&#x27;debug&#x27;</span>) &#123;  </span><br><span class="line">    axios.<span class="property">defaults</span>.<span class="property">baseURL</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> == <span class="string">&#x27;production&#x27;</span>) &#123;  </span><br><span class="line">    axios.<span class="property">defaults</span>.<span class="property">baseURL</span> = <span class="string">&#x27;http://api.123dailu.com/&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 请求超时时间</span></span><br><span class="line">axios.<span class="property">defaults</span>.<span class="property">timeout</span> = <span class="number">10000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// post请求头</span></span><br><span class="line">axios.<span class="property">defaults</span>.<span class="property">headers</span>.<span class="property">post</span>[<span class="string">&#x27;Content-Type&#x27;</span>] = <span class="string">&#x27;application/x-www-form-urlencoded;charset=UTF-8&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 请求拦截器</span></span><br><span class="line">axios.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(  </span><br><span class="line">    <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 每次发送请求之前判断是否存在token，如果存在，则统一在http请求的header都加上token，不用每次请求都手动添加了</span></span><br><span class="line">        <span class="comment">// 即使本地存在token，也有可能token是过期的，所以在响应拦截器中要对返回状态进行判断</span></span><br><span class="line">        <span class="keyword">const</span> token = store.<span class="property">state</span>.<span class="property">token</span>;  </span><br><span class="line">        token &amp;&amp; (config.<span class="property">headers</span>.<span class="property">Authorization</span> = token);  </span><br><span class="line">        <span class="keyword">return</span> config;  </span><br><span class="line">    &#125;,  </span><br><span class="line">    <span class="function"><span class="params">error</span> =&gt;</span> &#123;  </span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">error</span>(error);  </span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 响应拦截器</span></span><br><span class="line">axios.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(  </span><br><span class="line">    <span class="function"><span class="params">response</span> =&gt;</span> &#123;  </span><br><span class="line">        <span class="keyword">if</span> (response.<span class="property">status</span> === <span class="number">200</span>) &#123;  </span><br><span class="line">            <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(response);  </span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;  </span><br><span class="line">            <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(response);  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 服务器状态码不是200的情况  </span></span><br><span class="line">    <span class="function"><span class="params">error</span> =&gt;</span> &#123;  </span><br><span class="line">        <span class="keyword">if</span> (error.<span class="property">response</span>.<span class="property">status</span>) &#123;  </span><br><span class="line">            <span class="keyword">switch</span> (error.<span class="property">response</span>.<span class="property">status</span>) &#123;  </span><br><span class="line">                <span class="comment">// 401: 未登录  </span></span><br><span class="line">                <span class="comment">// 未登录则跳转登录页面，并携带当前页面的路径  </span></span><br><span class="line">                <span class="comment">// 在登录成功后返回当前页面，这一步需要在登录页操作。  </span></span><br><span class="line">                <span class="keyword">case</span> <span class="number">401</span>:  </span><br><span class="line">                    router.<span class="title function_">replace</span>(&#123;  </span><br><span class="line">                        <span class="attr">path</span>: <span class="string">&#x27;/login&#x27;</span>,  </span><br><span class="line">                        <span class="attr">query</span>: &#123; <span class="attr">redirect</span>: router.<span class="property">currentRoute</span>.<span class="property">fullPath</span> &#125; </span><br><span class="line">                    &#125;);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="comment">// 403 token过期  </span></span><br><span class="line">                <span class="comment">// 登录过期对用户进行提示  </span></span><br><span class="line">                <span class="comment">// 清除本地token和清空vuex中token对象  </span></span><br><span class="line">                <span class="comment">// 跳转登录页面  </span></span><br><span class="line">                <span class="keyword">case</span> <span class="number">403</span>:   </span><br><span class="line">                    <span class="title class_">Toast</span>(&#123;  </span><br><span class="line">                        <span class="attr">message</span>: <span class="string">&#x27;登录过期，请重新登录&#x27;</span>,  </span><br><span class="line">                        <span class="attr">duration</span>: <span class="number">1000</span>,  </span><br><span class="line">                        <span class="attr">forbidClick</span>: <span class="literal">true</span>  </span><br><span class="line">                    &#125;);  </span><br><span class="line">                    <span class="comment">// 清除token  </span></span><br><span class="line">                    <span class="variable language_">localStorage</span>.<span class="title function_">removeItem</span>(<span class="string">&#x27;token&#x27;</span>);  </span><br><span class="line">                    store.<span class="title function_">commit</span>(<span class="string">&#x27;loginSuccess&#x27;</span>, <span class="literal">null</span>);  </span><br><span class="line">                    <span class="comment">// 跳转登录页面，并将要浏览的页面fullPath传过去，登录成功后跳转需要访问的页面</span></span><br><span class="line">                    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;  </span><br><span class="line">                        router.<span class="title function_">replace</span>(&#123;    </span><br><span class="line">                            <span class="attr">path</span>: <span class="string">&#x27;/login&#x27;</span>,    </span><br><span class="line">                            <span class="attr">query</span>: &#123; </span><br><span class="line">                                <span class="attr">redirect</span>: router.<span class="property">currentRoute</span>.<span class="property">fullPath</span> </span><br><span class="line">                            &#125;  </span><br><span class="line">                        &#125;);  </span><br><span class="line">                    &#125;, <span class="number">1000</span>);  </span><br><span class="line">                    <span class="keyword">break</span>; </span><br><span class="line">                <span class="comment">// 404请求不存在  </span></span><br><span class="line">                <span class="keyword">case</span> <span class="number">404</span>:  </span><br><span class="line">                    <span class="title class_">Toast</span>(&#123;  </span><br><span class="line">                        <span class="attr">message</span>: <span class="string">&#x27;网络请求不存在&#x27;</span>,  </span><br><span class="line">                        <span class="attr">duration</span>: <span class="number">1500</span>,  </span><br><span class="line">                        <span class="attr">forbidClick</span>: <span class="literal">true</span>  </span><br><span class="line">                    &#125;);  </span><br><span class="line">                <span class="keyword">break</span>;  </span><br><span class="line">                <span class="comment">// 其他错误，直接抛出错误提示  </span></span><br><span class="line">                <span class="attr">default</span>:  </span><br><span class="line">                    <span class="title class_">Toast</span>(&#123;  </span><br><span class="line">                        <span class="attr">message</span>: error.<span class="property">response</span>.<span class="property">data</span>.<span class="property">message</span>,  </span><br><span class="line">                        <span class="attr">duration</span>: <span class="number">1500</span>,  </span><br><span class="line">                        <span class="attr">forbidClick</span>: <span class="literal">true</span>  </span><br><span class="line">                    &#125;);  </span><br><span class="line">            &#125;  </span><br><span class="line">            <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error.<span class="property">response</span>);  </span><br><span class="line">        &#125;   </span><br><span class="line">    &#125;</span><br><span class="line">);</span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * get方法，对应get请求 </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; url [请求的url地址] </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; params [请求时携带的参数] </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">get</span>(<span class="params">url, params</span>)&#123;  </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span>&#123;  </span><br><span class="line">        axios.<span class="title function_">get</span>(url, &#123;  </span><br><span class="line">            <span class="attr">params</span>: params  </span><br><span class="line">        &#125;)  </span><br><span class="line">        .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;  </span><br><span class="line">            <span class="title function_">resolve</span>(res.<span class="property">data</span>);  </span><br><span class="line">        &#125;)  </span><br><span class="line">        .<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123;  </span><br><span class="line">            <span class="title function_">reject</span>(err.<span class="property">data</span>)  </span><br><span class="line">        &#125;)  </span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * post方法，对应post请求 </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; url [请求的url地址] </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; params [请求时携带的参数] </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">post</span>(<span class="params">url, params</span>) &#123;  </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;   </span><br><span class="line">        axios.<span class="title function_">post</span>(url, <span class="variable constant_">QS</span>.<span class="title function_">stringify</span>(params))  </span><br><span class="line">        .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;  </span><br><span class="line">            <span class="title function_">resolve</span>(res.<span class="property">data</span>);  </span><br><span class="line">        &#125;)  </span><br><span class="line">        .<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123;  </span><br><span class="line">            <span class="title function_">reject</span>(err.<span class="property">data</span>)  </span><br><span class="line">        &#125;)  </span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="axios封装的优化"><a href="#axios封装的优化" class="headerlink" title="axios封装的优化"></a>axios封装的优化</h1><p>axios的封装根据需求的不同而不同。这里非常感谢评论里一些很中肯的建议，我也对此进行了思考和针对不同需求的改善。主要有以下改变：</p><p><strong>1.优化axios封装，去掉之前的get和post</strong></p><p><strong>2.断网情况处理</strong></p><p><strong>3.更加模块化的api管理</strong></p><p><strong>4.接口域名有多个的情况</strong></p><p><strong>5.api挂载到vue.prototype上省去引入的步骤</strong></p><p>http.js中axios封装的优化，先直接贴代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * axios封装</span></span><br><span class="line"><span class="comment"> * 请求拦截、响应拦截、错误统一处理</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;../router&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;../store/index&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Toast</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;vant&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * 提示函数 </span></span><br><span class="line"><span class="comment"> * 禁止点击蒙层、显示一秒后关闭</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">tip</span> = msg =&gt; &#123;  </span><br><span class="line">    <span class="title class_">Toast</span>(&#123;  </span><br><span class="line">        <span class="attr">message</span>: msg,  </span><br><span class="line">        <span class="attr">duration</span>: <span class="number">1000</span>,  </span><br><span class="line">        <span class="attr">forbidClick</span>: <span class="literal">true</span>  </span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * 跳转登录页</span></span><br><span class="line"><span class="comment"> * 携带当前页面路由，以期在登录页面完成登录后返回当前页面</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">toLogin</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    router.<span class="title function_">replace</span>(&#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;/login&#x27;</span>,  </span><br><span class="line">        <span class="attr">query</span>: &#123;</span><br><span class="line">            <span class="attr">redirect</span>: router.<span class="property">currentRoute</span>.<span class="property">fullPath</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * 请求失败后的错误统一处理 </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Number</span>&#125; status 请求失败的状态码</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">errorHandle</span> = (<span class="params">status, other</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 状态码判断</span></span><br><span class="line">    <span class="keyword">switch</span> (status) &#123;</span><br><span class="line">        <span class="comment">// 401: 未登录状态，跳转登录页</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">401</span>:</span><br><span class="line">            <span class="title function_">toLogin</span>();</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="comment">// 403 token过期</span></span><br><span class="line">        <span class="comment">// 清除token并跳转登录页</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">403</span>:</span><br><span class="line">            <span class="title function_">tip</span>(<span class="string">&#x27;登录过期，请重新登录&#x27;</span>);</span><br><span class="line">            <span class="variable language_">localStorage</span>.<span class="title function_">removeItem</span>(<span class="string">&#x27;token&#x27;</span>);</span><br><span class="line">            store.<span class="title function_">commit</span>(<span class="string">&#x27;loginSuccess&#x27;</span>, <span class="literal">null</span>);</span><br><span class="line">            <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="title function_">toLogin</span>();</span><br><span class="line">            &#125;, <span class="number">1000</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="comment">// 404请求不存在</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">404</span>:</span><br><span class="line">            <span class="title function_">tip</span>(<span class="string">&#x27;请求的资源不存在&#x27;</span>); </span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="attr">default</span>:</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(other);   </span><br><span class="line">        &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建axios实例</span></span><br><span class="line"><span class="keyword">var</span> instance = axios.<span class="title function_">create</span>(&#123;    <span class="attr">timeout</span>: <span class="number">1000</span> * <span class="number">12</span>&#125;);</span><br><span class="line"><span class="comment">// 设置post请求头</span></span><br><span class="line">instance.<span class="property">defaults</span>.<span class="property">headers</span>.<span class="property">post</span>[<span class="string">&#x27;Content-Type&#x27;</span>] = <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>;</span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * 请求拦截器 </span></span><br><span class="line"><span class="comment"> * 每次请求前，如果存在token则在请求头中携带token </span></span><br><span class="line"><span class="comment"> */</span> </span><br><span class="line">instance.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(  </span><br><span class="line">    <span class="function"><span class="params">config</span> =&gt;</span> &#123;  </span><br><span class="line">        <span class="comment">// 登录流程控制中，根据本地是否存在token判断用户的登录情况  </span></span><br><span class="line">        <span class="comment">// 但是即使token存在，也有可能token是过期的，所以在每次的请求头中携带token  </span></span><br><span class="line">        <span class="comment">// 后台根据携带的token判断用户的登录情况，并返回给我们对应的状态码  </span></span><br><span class="line">        <span class="comment">// 而后我们可以在响应拦截器中，根据状态码进行一些统一的操作。  </span></span><br><span class="line">        <span class="keyword">const</span> token = store.<span class="property">state</span>.<span class="property">token</span>;  </span><br><span class="line">        token &amp;&amp; (config.<span class="property">headers</span>.<span class="property">Authorization</span> = token);  </span><br><span class="line">        <span class="keyword">return</span> config;  </span><br><span class="line">    &#125;,  </span><br><span class="line">    <span class="function"><span class="params">error</span> =&gt;</span> <span class="title class_">Promise</span>.<span class="title function_">error</span>(error))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 响应拦截器</span></span><br><span class="line">instance.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(  </span><br><span class="line">    <span class="comment">// 请求成功</span></span><br><span class="line">    <span class="function"><span class="params">res</span> =&gt;</span> res.<span class="property">status</span> === <span class="number">200</span> ? <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(res) : <span class="title class_">Promise</span>.<span class="title function_">reject</span>(res),  </span><br><span class="line">    <span class="comment">// 请求失败</span></span><br><span class="line">    <span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; response &#125; = error;</span><br><span class="line">        <span class="keyword">if</span> (response) &#123;</span><br><span class="line">            <span class="comment">// 请求已发出，但是不在2xx的范围 </span></span><br><span class="line">            <span class="title function_">errorHandle</span>(response.<span class="property">status</span>, response.<span class="property">data</span>.<span class="property">message</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(response);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 处理断网的情况</span></span><br><span class="line">            <span class="comment">// eg:请求超时或断网时，更新state的network状态</span></span><br><span class="line">            <span class="comment">// network状态在app.vue中控制着一个全局的断网提示组件的显示隐藏</span></span><br><span class="line">            <span class="comment">// 关于断网组件中的刷新重新获取数据，会在断网组件中说明</span></span><br><span class="line">            <span class="keyword">if</span> (!<span class="variable language_">window</span>.<span class="property">navigator</span>.<span class="property">onLine</span>) &#123;</span><br><span class="line">               store.<span class="title function_">commit</span>(<span class="string">&#x27;changeNetwork&#x27;</span>, <span class="literal">false</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> instance;</span><br></pre></td></tr></table></figure><p>这个axios和之前的大同小异，做了如下几点改变：</p><p>1.去掉了之前get和post方法的封装，通过创建一个axios实例然后export default方法导出，这样使用起来更灵活一些。</p><p>2.去掉了通过环境变量控制baseUrl的值。考虑到接口会有多个不同域名的情况，所以准备通过js变量来控制接口域名。这点具体在api里会介绍。</p><p>3.增加了请求超时，即断网状态的处理。说下思路，当断网时，通过更新vuex中network的状态来控制断网提示组件的显示隐藏。断网提示一般会有重新加载数据的操作，这步会在后面对应的地方介绍。</p><p>4.公用函数进行抽出，简化代码，尽量保证单一职责原则。</p><p><strong>下面说下api这块，考虑到一下需求：</strong></p><p>1.更加模块化</p><p>2.更方便多人开发，有效减少解决命名冲突</p><p>3.处理接口域名有多个情况</p><p>这里这里呢新建了一个api文件夹，里面有一个index.js和一个base.js，以及多个根据模块划分的接口js文件。index.js是一个api的出口，base.js管理接口域名，其他js则用来管理各个模块的接口。</p><p>先放index.js代码：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">/** </span><br><span class="line"> * api接口的统一出口</span><br><span class="line"> */</span><br><span class="line"><span class="regexp">//</span> 文章模块接口</span><br><span class="line">import article from <span class="string">&#x27;@/api/article&#x27;</span>;</span><br><span class="line"><span class="regexp">//</span> 其他模块的接口……</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> 导出接口</span><br><span class="line">export default &#123;  </span><br><span class="line">    article,</span><br><span class="line">    <span class="regexp">//</span> ……</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>index.js是一个api接口的出口，这样就可以把api接口根据功能划分为多个模块，利于多人协作开发，比如一个人只负责一个模块的开发等，还能方便每个模块中接口的命名哦。</p><p>base.js:</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 接口域名的管理</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">base</span> = &#123;  </span><br><span class="line">    sq: <span class="string">&#x27;https://xxxx111111.com/api/v1&#x27;</span>,  </span><br><span class="line">    bd: <span class="string">&#x27;http://xxxxx22222.com/api&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export <span class="literal">default</span> <span class="keyword">base</span>;</span><br></pre></td></tr></table></figure><p>通过base.js来管理我们的接口域名，不管有多少个都可以通过这里进行接口的定义。即使修改起来，也是很方便的。</p><p>最后就是接口模块的说明，例如上面的article.js:</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * article模块接口列表</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">import <span class="keyword">base</span> <span class="keyword">from</span> <span class="string">&#x27;./base&#x27;</span>; <span class="comment">// 导入接口域名列表</span></span><br><span class="line">import axios <span class="keyword">from</span> <span class="string">&#x27;@/utils/http&#x27;</span>; <span class="comment">// 导入http中创建的axios实例</span></span><br><span class="line">import qs <span class="keyword">from</span> <span class="string">&#x27;qs&#x27;</span>; <span class="comment">// 根据需求是否导入qs模块</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> article = &#123;  </span><br><span class="line">    <span class="comment">// 新闻列表  </span></span><br><span class="line">    articleList () &#123;  </span><br><span class="line">        <span class="keyword">return</span> axios.<span class="keyword">get</span>(`$&#123;<span class="keyword">base</span>.sq&#125;/topics`);  </span><br><span class="line">    &#125;,  </span><br><span class="line">    <span class="comment">// 新闻详情,演示  </span></span><br><span class="line">    articleDetail (id, <span class="keyword">params</span>) &#123;  </span><br><span class="line">        <span class="keyword">return</span> axios.<span class="keyword">get</span>(`$&#123;<span class="keyword">base</span>.sq&#125;/topic/$&#123;id&#125;`, &#123;  </span><br><span class="line">            <span class="keyword">params</span>: <span class="keyword">params</span>  </span><br><span class="line">        &#125;);  </span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// post提交  </span></span><br><span class="line">    login (<span class="keyword">params</span>) &#123;  </span><br><span class="line">        <span class="keyword">return</span> axios.post(`$&#123;<span class="keyword">base</span>.sq&#125;/accesstoken`, qs.stringify(<span class="keyword">params</span>));  </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 其他接口…………</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export <span class="literal">default</span> article;</span><br></pre></td></tr></table></figure><p>1.通过直接引入我们封装好的axios实例，然后定义接口、调用axios实例并返回，可以更灵活的使用axios，比如你可以对post请求时提交的数据进行一个qs序列化的处理等。</p><p>2.请求的配置更灵活，你可以针对某个需求进行一个不同的配置。关于配置的优先级，axios文档说的很清楚，这个顺序是：在 <code>lib/defaults.js</code> 找到的库的默认值，然后是实例的 <code>defaults</code> 属性，最后是请求的 <code>config</code> 参数。后者将优先于前者。</p><p>3.restful风格的接口，也可以通过这种方式灵活的设置api接口地址。</p><p>最后，为了方便api的调用，我们需要将其挂载到vue的原型上。在main.js中：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App&#x27;</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;./router&#x27;</span> <span class="comment">// 导入路由文件</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./store&#x27;</span> <span class="comment">// 导入vuex文件</span></span><br><span class="line"><span class="keyword">import</span> api <span class="keyword">from</span> <span class="string">&#x27;./api&#x27;</span> <span class="comment">// 导入api接口</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">$api</span> = api; <span class="comment">// 将api挂载到vue的原型上</span></span><br></pre></td></tr></table></figure><p>然后我们可以在页面中这样调用接口，eg：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;  </span><br><span class="line">    <span class="built_in">onLoad</span>(id) &#123;  </span><br><span class="line">        this.<span class="variable">$api</span><span class="selector-class">.article</span><span class="selector-class">.articleDetail</span>(id, &#123;  </span><br><span class="line">            api: <span class="number">123</span>  </span><br><span class="line">        &#125;)<span class="selector-class">.then</span>(res=&gt; &#123;</span><br><span class="line">            <span class="comment">// 执行某些操作  </span></span><br><span class="line">        &#125;)  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>再提一下断网的处理，这里只做一个简单的示例：</p><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span>  </span></span><br><span class="line"><span class="language-xml">    </span><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span>  </span></span><br><span class="line"><span class="language-xml">        </span><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;!network&quot;</span>&gt;</span>  </span></span><br><span class="line"><span class="language-xml">            </span><span class="language-xml"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>我没网了<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><span class="language-xml">  </span></span><br><span class="line"><span class="language-xml">            </span><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> @<span class="attr">click</span>=<span class="string">&quot;onRefresh&quot;</span>&gt;</span>刷新<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><span class="language-xml">  </span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><span class="language-xml">  </span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">router-view</span>/&gt;</span>  </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">import</span> </span></span><span class="language-xquery">&#123; mapState &#125;</span><span class="language-xml"><span class="language-javascript"> <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">export</span> <span class="keyword">default</span> </span></span><span class="language-xquery">&#123;  </span></span><br><span class="line"><span class="language-xquery">       <span class="built_in"> name</span>: <span class="string">&#x27;App&#x27;</span>,  </span></span><br><span class="line"><span class="language-xquery">        computed: &#123;  </span></span><br><span class="line"><span class="language-xquery">            ...mapState([<span class="string">&#x27;network&#x27;</span>])  </span></span><br><span class="line"><span class="language-xquery">        &#125;</span><span class="language-xml">,  </span></span><br><span class="line"><span class="language-xml">        methods: </span><span class="language-xquery">&#123;  </span></span><br><span class="line"><span class="language-xquery">            // 通过跳转一个空页面再返回的方式来实现刷新当前页面数据的目的</span></span><br><span class="line"><span class="language-xquery">            onRefresh () &#123;  </span></span><br><span class="line"><span class="language-xquery">                this.<span class="variable">$router</span><span class="built_in">.replace</span>(<span class="string">&#x27;/refresh&#x27;</span>)  </span></span><br><span class="line"><span class="language-xquery">            &#125;</span><span class="language-xml">  </span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">    &#125;</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>这是app.vue，这里简单演示一下断网。在http.js中介绍了，我们会在断网的时候，来更新vue中network的状态，那么这里我们根据network的状态来判断是否需要加载这个断网组件。断网情况下，加载断网组件，不加载对应页面的组件。当点击刷新的时候，我们通过跳转refesh页面然后立即返回的方式来实现重新获取数据的操作。因此我们需要新建一个refresh.vue页面，并在其 <code>beforeRouteEnter</code>钩子中再返回当前页面。</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// refresh.vue</span></span><br><span class="line">beforeRouteEnter (to, from, next) &#123;</span><br><span class="line">    next(<span class="function"><span class="params">vm</span> =&gt;</span> &#123;  </span><br><span class="line">        vm.<span class="symbol">$router</span>.<span class="built_in">replace</span>(from.fullPath)  </span><br><span class="line">    &#125;)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> axios </tag>
            
            <tag> api接口 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>自定义侧边栏</title>
      <link href="/posts/901ffb1c/"/>
      <url>/posts/901ffb1c/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><hr><h3 id="侧边栏版块即widget"><a href="#侧边栏版块即widget" class="headerlink" title="侧边栏版块即widget"></a>侧边栏版块即widget</h3><p>可添加自己的widget，也可以对已有的widget进行排序（除 <strong>博客资料</strong> 和 <strong>公告</strong> 两个版块已固定，其余都可以进行自由排序）</p><h3 id="widget排序"><a href="#widget排序" class="headerlink" title="widget排序"></a>widget排序</h3><p>只需要配置 sort_order 就行。（使用了 <strong>Flex</strong> 布局的 <strong>order</strong> 属性，具体可查看 mozilla 文档。简单来讲，就是配置数字來实现排序，如果不配置，则默认为0。数字越小，排序越靠前。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">aside:</span></span><br><span class="line"> <span class="string">...</span></span><br><span class="line">  <span class="attr">card_recent_post:</span></span><br><span class="line">    <span class="attr">sort_order:</span> <span class="comment"># Don&#x27;t modify the setting unless you know how it works</span></span><br><span class="line">  <span class="attr">card_categories:</span></span><br><span class="line">    <span class="attr">sort_order:</span> <span class="comment"># Don&#x27;t modify the setting unless you know how it works</span></span><br><span class="line">  <span class="attr">card_tags:</span></span><br><span class="line">    <span class="attr">sort_order:</span> <span class="comment"># Don&#x27;t modify the setting unless you know how it works</span></span><br><span class="line">  <span class="attr">card_archives:</span></span><br><span class="line">    <span class="attr">sort_order:</span> <span class="comment"># Don&#x27;t modify the setting unless you know how it works</span></span><br><span class="line">  <span class="attr">card_webinfo:</span></span><br><span class="line">    <span class="attr">sort_order:</span> <span class="comment"># Don&#x27;t modify the setting unless you know how it works</span></span><br><span class="line"></span><br><span class="line"><span class="attr">newest_comments:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">sort_order:</span> <span class="comment"># Don&#x27;t modify the setting unless you know how it works</span></span><br></pre></td></tr></table></figure><h3 id="如何自定义widget"><a href="#如何自定义widget" class="headerlink" title="如何自定义widget"></a>如何自定义widget</h3><h4 id="创建widget-yml"><a href="#创建widget-yml" class="headerlink" title="创建widget.yml"></a>创建widget.yml</h4><p>在Hexo博客目录中的 <strong>source&#x2F;_data</strong>（如果没有 <strong>_data</strong> 文件夹，请自行创建），创建一个文件 <strong>widget.yml</strong></p><h4 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">top:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">class_name:</span></span><br><span class="line">  <span class="attr">id_name:</span></span><br><span class="line">  <span class="attr">name:</span></span><br><span class="line">  <span class="attr">icon:</span></span><br><span class="line">  <span class="attr">html:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">bottom:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">class_name:</span></span><br><span class="line">  <span class="attr">id_name:</span></span><br><span class="line">  <span class="attr">name:</span></span><br><span class="line">  <span class="attr">icon:</span></span><br><span class="line">  <span class="attr">order:</span></span><br><span class="line">  <span class="attr">html:</span></span><br></pre></td></tr></table></figure><p>参数详解</p><p>top: 创建的 widget 会出现在非 sticky 区域（即所有页面都会显示)</p><p>bottom: 创建的 widget 会出现在 sticky 区域（除了文章页都会显示)</p><table><thead><tr><th align="center">参数</th><th>解释</th></tr></thead><tbody><tr><td align="center">class_name</td><td>所创建的 widget 父类 class 名（可选）</td></tr><tr><td align="center">id_name</td><td>所创建的 widget 父类 id 名（可选）</td></tr><tr><td align="center">name</td><td>所创建的 widget 标题</td></tr><tr><td align="center">icon</td><td>所创建的 widget 图标</td></tr><tr><td align="center">order</td><td>所创建的 widget 排序（可选）</td></tr><tr><td align="center">html</td><td>所创建的 widget 相关代码</td></tr></tbody></table><p>生成的 <strong>代码</strong> 为</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card-widget 所写的 class_name&quot;</span> <span class="attr">id</span>=<span class="string">&quot;所写的 id_name&quot;</span> <span class="attr">style</span>=<span class="string">&quot;order: 所写的 order&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item-headline&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;所写的 icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>所写的 name<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item-content&quot;</span>&gt;</span></span><br><span class="line">        所写的 html</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>如果你需要对添加的 widget 进行 UI 调整，请自行添加 css 到 inject 去。</p><h4 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h4><h5 id="以-访客地图-为例子"><a href="#以-访客地图-为例子" class="headerlink" title="以 访客地图 为例子"></a>以 访客地图 为例子</h5><ol><li>获取访客地图的 html 代码</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">id</span>=<span class="string">&quot;clstr_globe&quot;</span> <span class="attr">src</span>=<span class="string">&quot;//clustrmaps.com/globe.js?d=5V2tOKp8qAdRM-i8eu7ETTO9ugt5uKbbG-U7Yj8uMl8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>创建 widget.yml</li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">bottom:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">user-map</span></span><br><span class="line">      <span class="attr">id_name:</span> <span class="string">user-map</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">访客地图</span></span><br><span class="line">      <span class="attr">icon:</span> <span class="string">fas</span> <span class="string">fa-heartbeat</span></span><br><span class="line">      <span class="attr">order:</span></span><br><span class="line">      <span class="attr">html:</span> <span class="string">&#x27;</span></span><br></pre></td></tr></table></figure><p>运行 hexo</p><p><a href="https://www.google.com/">I&#39;m an inline-style link</a></p>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>添加相册</title>
      <link href="/posts/7a854cb2/"/>
      <url>/posts/7a854cb2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="添加相册"><a href="#添加相册" class="headerlink" title="添加相册"></a>添加相册</h1><h2 id="方案"><a href="#方案" class="headerlink" title="方案"></a>方案</h2><p>在github上新建一个仓库，主要用于存储图片，可以通过url访问到，也方便管理<br>将要放到相册的图片处理成json格式的数据，然后进行访问，这里json的格式需要配合要使用的样式，所以需要处理成特定格式的json数据，下面会给出<br>图片裁剪，因为相册显示的样式最好是正方形的的图片，这里使用脚本处理一下<br>图片压缩，相册显示的图片是压缩后的图片，提高加载的速度，打开后的图片是原图。</p><h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><h3 id="github操作"><a href="#github操作" class="headerlink" title="github操作"></a>github操作</h3><p>建立一个用于存储相册的仓库，我这里建立了名为BlogPicturep的仓库<br>关于git的命令行操作和配置不再给出</p><h3 id="博客操作"><a href="#博客操作" class="headerlink" title="博客操作"></a>博客操作</h3><ul><li>在博客的source文件夹下建立一个photos文件夹</li></ul><p><img src="https://img-blog.csdnimg.cn/2020031510333829.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI3NDM5ODE5,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ul><li>如果是通过hexo new 的方式创建的记得把index.md文件删掉，我试过不删掉就渲染不出来。</li><li>将样式文件放到photos文件夹下，样式文件我都放到了github上：<a href="https://github.com/hanlinbei/hanlinbei.github.io/tree/master/photos">https://github.com/hanlinbei/hanlinbei.github.io/tree/master/photos</a> 在github上一般很难下载单个文件夹，在这里我可以推荐一个gitzip的谷歌浏览器插件，可以右键很方便的把文件打包成一个压缩包下载，不必下载整个项目。整个项目很难下载得下来。</li><li>修改ins.js文件，主要是里面的render函数</li><li>其中的url对应到你的github放图片的地址</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> render = function render(res) &#123;</span><br><span class="line">    <span class="keyword">var</span> ulTmpl = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>, len2 = res.list.length; j &lt; len2; j++) &#123;</span><br><span class="line">        <span class="keyword">var</span> data = res.list[j].arr;</span><br><span class="line">        <span class="keyword">var</span> liTmpl = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, <span class="built_in">len</span> = data.link.length; i &lt; <span class="built_in">len</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">var</span> minSrc = <span class="string">&#x27;https://raw.githubusercontent.com/lawlite19/blog-back-up/master/min_photos/&#x27;</span> + data.link[i];</span><br><span class="line">            <span class="keyword">var</span> src = <span class="string">&#x27;https://raw.githubusercontent.com/lawlite19/blog-back-up/master/photos/&#x27;</span> + data.link[i];</span><br><span class="line">            <span class="keyword">var</span> <span class="keyword">type</span> = data.<span class="keyword">type</span>[i];</span><br><span class="line">            <span class="keyword">var</span> target = src + (<span class="keyword">type</span> === <span class="string">&#x27;video&#x27;</span> ? <span class="string">&#x27;.mp4&#x27;</span> : <span class="string">&#x27;.jpg&#x27;</span>);</span><br><span class="line">            src += <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            liTmpl += <span class="string">&#x27;&lt;ul class=&quot;img-box-ul&quot;&gt;&#x27;</span> + liTmpl + <span class="string">&#x27;&lt;/ul&gt;\</span></span><br><span class="line"><span class="string">            &lt;/section&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20200315103355457.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI3NDM5ODE5,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><img src="https://img-blog.csdnimg.cn/202003151034044.png" alt="在这里插入图片描述"></p><p>地址一定是点击这个download后浏览器框上出现得地址</p><p><img src="https://img-blog.csdnimg.cn/202003151034044.png" alt="在这里插入图片描述"></p><h2 id="图片处理"><a href="#图片处理" class="headerlink" title="图片处理"></a>图片处理</h2><p>python脚本文件都放在了这里：<a href="https://github.com/hanlinbei/BlogPicture">https://github.com/hanlinbei/BlogPicture</a></p><p>(1). 裁剪图片<br>去图片的中间部分，裁剪为正方形<br>对应的裁剪函数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">cut_by_ratio</span>(<span class="params">self</span>):</span><br><span class="line">   <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">按照图片长宽进行分割</span></span><br><span class="line"><span class="string">取中间的部分，裁剪成正方形</span></span><br><span class="line"><span class="string">   &quot;&quot;&quot;</span>   </span><br><span class="line">    im = Image.<span class="built_in">open</span>(self.infile)   </span><br><span class="line">    (x, y) = im.size   </span><br><span class="line">    <span class="keyword">if</span> x &gt; y:   </span><br><span class="line">region = (<span class="built_in">int</span>(x/<span class="number">2</span>-y/<span class="number">2</span>), <span class="number">0</span>, <span class="built_in">int</span>(x/<span class="number">2</span>+y/<span class="number">2</span>), y)   </span><br><span class="line">        <span class="comment">#裁切图片   </span></span><br><span class="line">        crop_img = im.crop(region)   </span><br><span class="line">        <span class="comment">#保存裁切后的图片   </span></span><br><span class="line">        crop_img.save(self.outfile)</span><br><span class="line">    <span class="keyword">elif</span> x &lt; y:   </span><br><span class="line">        region = (<span class="number">0</span>, <span class="built_in">int</span>(y/<span class="number">2</span>-x/<span class="number">2</span>), x, <span class="built_in">int</span>(y/<span class="number">2</span>+x/<span class="number">2</span>))</span><br><span class="line">        <span class="comment">#裁切图片   </span></span><br><span class="line">        crop_img = im.crop(region)   </span><br><span class="line">        <span class="comment">#保存裁切后的图片   </span></span><br><span class="line">        crop_img.save(self.outfile)</span><br></pre></td></tr></table></figure><p>(2) 压缩图片<br>把图片进行压缩，方便相册的加载</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">compress</span>(<span class="params">choose, des_dir, src_dir, file_list</span>):</span><br><span class="line">   <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">压缩算法，img.thumbnail对图片进行压缩，</span></span><br><span class="line"><span class="string">参数   </span></span><br><span class="line"><span class="string">choose: str</span></span><br><span class="line"><span class="string">        选择压缩的比例，有4个选项，越大压缩后的图片越小</span></span><br><span class="line"><span class="string">   &quot;&quot;&quot;</span></span><br><span class="line">   <span class="keyword">if</span> choose == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">       scale = SIZE_normal</span><br><span class="line">   <span class="keyword">if</span> choose == <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">       scale = SIZE_small</span><br><span class="line">   <span class="keyword">if</span> choose == <span class="string">&#x27;3&#x27;</span>:</span><br><span class="line">       scale = SIZE_more_small</span><br><span class="line">   <span class="keyword">if</span> choose == <span class="string">&#x27;4&#x27;</span>:</span><br><span class="line">       scale = SIZE_more_small_small</span><br><span class="line">   <span class="keyword">for</span> infile <span class="keyword">in</span> file_list:</span><br><span class="line">       img = Image.<span class="built_in">open</span>(src_dir+infile)</span><br><span class="line">       <span class="comment"># size_of_file = os.path.getsize(infile)</span></span><br><span class="line">       w, h = img.size</span><br><span class="line">       img.thumbnail((<span class="built_in">int</span>(w/scale), <span class="built_in">int</span>(h/scale)))</span><br><span class="line">       img.save(des_dir + infile)</span><br></pre></td></tr></table></figure><h2 id="github提交"><a href="#github提交" class="headerlink" title="github提交"></a>github提交</h2><p>处理完成之后需要将处理后的图片提交到github上</p><p>这里同样使用脚本的方式，需要将git命令行配置到环境变量中</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">git_operation</span>():</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">git 命令行函数，将仓库提交</span></span><br><span class="line"><span class="string">需要安装git命令行工具，并且添加到环境变量中</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">    os.system(<span class="string">&#x27;git add --all&#x27;</span>)</span><br><span class="line">    os.system(<span class="string">&#x27;git commit -m &quot;add photos&quot;&#x27;</span>)</span><br><span class="line">    os.system(<span class="string">&#x27;git push origin master&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="json数据处理"><a href="#json数据处理" class="headerlink" title="json数据处理"></a>json数据处理</h2><p>下面就需要将图片信息处理成json数据格式了，这里为重点<br>最终需要的json格式的数据如下图：</p><p><img src="https://img-blog.csdnimg.cn/20200315103424843.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI3NDM5ODE5,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>这里我采用的方式是读取图片的名字作为其中的text的内容，图片的命名如下图</p><p><img src="https://img-blog.csdnimg.cn/20200315103434868.png" alt="在这里插入图片描述"></p><p>最前面是日期，然后用_进行分隔<br>后面是图片的描述信息，注意不要包含_和.符号 这个命名一定要规范，不能有问题。<br>实现代码：<br>注意代码中…&#x2F;blog&#x2F;source&#x2F;photos&#x2F;data.json是对应到我的博客的路径，这里根据需要改成自己博客的路径</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">handle_photo</span>():</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">根据图片的文件名处理成需要的json格式的数据</span></span><br><span class="line"><span class="string">最后将data.json文件存到博客的source/photos文件夹下</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    src_dir, des_dir = <span class="string">&quot;photos/&quot;</span>, <span class="string">&quot;min_photos/&quot;</span></span><br><span class="line">    file_list = list_img_file(src_dir)</span><br><span class="line">    list_info = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(file_list)):</span><br><span class="line">        filename = file_list[i]</span><br><span class="line">        date_str, info = filename.split(<span class="string">&quot;_&quot;</span>)</span><br><span class="line">        info, _ = info.split(<span class="string">&quot;.&quot;</span>)</span><br><span class="line">        date = datetime.strptime(date_str, <span class="string">&quot;%Y-%m-%d&quot;</span>)</span><br><span class="line">        year_month = date_str[<span class="number">0</span>:<span class="number">7</span>]</span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">0</span>:  </span><br><span class="line">    <span class="comment"># 处理第一个文件</span></span><br><span class="line">            new_dict = &#123;<span class="string">&quot;date&quot;</span>: year_month, <span class="string">&quot;arr&quot;</span>:&#123;<span class="string">&#x27;year&#x27;</span>: date.year,</span><br><span class="line">                                                   <span class="string">&#x27;month&#x27;</span>: date.month,</span><br><span class="line">                                                   <span class="string">&#x27;link&#x27;</span>: [filename],</span><br><span class="line">                                                   <span class="string">&#x27;text&#x27;</span>: [info],</span><br><span class="line">                                                   <span class="string">&#x27;type&#x27;</span>: [<span class="string">&#x27;image&#x27;</span>]</span><br><span class="line">                                                  &#125;</span><br><span class="line">                       &#125;</span><br><span class="line">            list_info.append(new_dict)</span><br><span class="line">        <span class="keyword">elif</span> year_month != list_info[-<span class="number">1</span>][<span class="string">&#x27;date&#x27;</span>]:  </span><br><span class="line">    <span class="comment"># 不是最后的一个日期，就新建一个dict</span></span><br><span class="line">            new_dict = &#123;<span class="string">&quot;date&quot;</span>: year_month, <span class="string">&quot;arr&quot;</span>:&#123;<span class="string">&#x27;year&#x27;</span>: date.year,</span><br><span class="line">                                                   <span class="string">&#x27;month&#x27;</span>: date.month,</span><br><span class="line">                                                   <span class="string">&#x27;link&#x27;</span>: [filename],</span><br><span class="line">                                                   <span class="string">&#x27;text&#x27;</span>: [info],</span><br><span class="line">                                                   <span class="string">&#x27;type&#x27;</span>: [<span class="string">&#x27;image&#x27;</span>]</span><br><span class="line">                                                   &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">            list_info.append(new_dict)</span><br><span class="line">        <span class="keyword">else</span>:  </span><br><span class="line">    <span class="comment"># 同一个日期</span></span><br><span class="line">            list_info[-<span class="number">1</span>][<span class="string">&#x27;arr&#x27;</span>][<span class="string">&#x27;link&#x27;</span>].append(filename)</span><br><span class="line">            list_info[-<span class="number">1</span>][<span class="string">&#x27;arr&#x27;</span>][<span class="string">&#x27;text&#x27;</span>].append(info)</span><br><span class="line">            list_info[-<span class="number">1</span>][<span class="string">&#x27;arr&#x27;</span>][<span class="string">&#x27;type&#x27;</span>].append(<span class="string">&#x27;image&#x27;</span>)</span><br><span class="line">    list_info.reverse()  </span><br><span class="line">    <span class="comment"># 翻转</span></span><br><span class="line">    final_dict = &#123;<span class="string">&quot;list&quot;</span>: list_info&#125;</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;../lawlite19.github.io/source/photos/data.json&quot;</span>,<span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> fp:</span><br><span class="line">       json.dump(final_dict, fp)</span><br></pre></td></tr></table></figure><p>每次图片有改动都需要执行此脚本文件<br>效果展示</p><p><img src="https://img-blog.csdnimg.cn/2020031510345189.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI3NDM5ODE5,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h2 id="可能会遇到得问题"><a href="#可能会遇到得问题" class="headerlink" title="可能会遇到得问题"></a>可能会遇到得问题</h2><h3 id="缩略图不显示"><a href="#缩略图不显示" class="headerlink" title="缩略图不显示"></a>缩略图不显示</h3><p>首先，去下载“empty.png” 点这里<br>直接右键另存，保存为“empty.png”。名字也要一样，别问为什么，实现了，自己再去看源码。<br>在你博客的本地仓库source下新建一个文件夹命名为assets,再在assets下新建一个文件夹命名为img。最后把empty.png放到img里面。我的结果如下：</p><p><img src="https://img-blog.csdnimg.cn/20200315103504493.png" alt="在这里插入图片描述"></p><p>这样做好像就完事了，可以成功看到缩略图显示出来。其实操作本不复杂严格按照教程来，细心点</p><h3 id="网页没有渲染出来"><a href="#网页没有渲染出来" class="headerlink" title="网页没有渲染出来"></a>网页没有渲染出来</h3><p>如果是github操作一定要及时查看邮件，如果渲染不出来有错误你会收到github发送过来的邮件</p><p><img src="https://img-blog.csdnimg.cn/20200315103512825.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI3NDM5ODE5,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>如果没有错误记得请一下浏览器的缓存，可能会是浏览器缓存造成的 刷新还是原来的页面。</p>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> icon </tag>
            
            <tag> iconfont </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>添加图标</title>
      <link href="/posts/446c5690/"/>
      <url>/posts/446c5690/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><hr><h2 id="iconfont"><a href="#iconfont" class="headerlink" title="iconfont"></a>iconfont</h2><p>国内最出名的莫过于iconfont,功能很强大且图标内容很丰富的矢量图标库。很多Font Awesome不支持的图标都可以在这里找到。同时，iconfont支持选择需要的图标生成css链接，减少不必要的CSS加载。</p><h3 id="註册账号"><a href="#註册账号" class="headerlink" title="註册账号"></a>註册账号</h3><p>打开iconfont的网站，点击导航栏的人像图标，会跳出註册界面，按要求註册账号。</p><h3 id="添加图标入库"><a href="#添加图标入库" class="headerlink" title="添加图标入库"></a>添加图标入库</h3><p>选择自己需要的图标，把鼠标移到图标上，会显示三个按钮（依次是添加入库、收藏和下载），而我们需要的是把图标添加入库</p><p>添加入库后，你可以看到网站右上角购物车图标显示了1字，代表图标已经添加入库，点击购物车图标，会弹出侧边栏显示详情。</p><p>已选择的图标会显示在上面，你可以重复上面的操作，把需要的图标添加入库，然后点击添加到项目。</p><p>接下来会要求选择项目名称，没有的自己创建一个。</p><h3 id="生成CSS链接"><a href="#生成CSS链接" class="headerlink" title="生成CSS链接"></a>生成CSS链接</h3><p>在添加到项目之后，会跳到项目的详情界面。点击Font class，然后再点击暂无代码，点击生成文字。网站会自动生成CSS链接，我们只需要复製链接就行。</p><h3 id="添加链接进主题配置文件"><a href="#添加链接进主题配置文件" class="headerlink" title="添加链接进主题配置文件"></a>添加链接进主题配置文件</h3><p>打开主题配置文件，找到inject配置，按要求把链接填入</p><p>在我们需要使用的地方填入icon，例如Menu，图片使用格式为iconfont icon名字</p><p>运行Butterfly之后，你就可以看到menu的图标生效了</p>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> icon </tag>
            
            <tag> iconfont </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo-域名设置+收录</title>
      <link href="/posts/3dffb9ae/"/>
      <url>/posts/3dffb9ae/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo-使用阿里iconfont图标</title>
      <link href="/posts/d6162140/"/>
      <url>/posts/d6162140/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>iconfont 获取<br>可以先在首页搜索你想要的图标，然后添加到购物车中，然后把购物车中的图标添加到项目中，如果没有项目的话可以新建一个项目。<br>生成在线链接<br>点击 font class 按钮直接就可以生成链接了<br>复制生成的链接地址，在浏览器窗口查看</p><p>引入字体样式<br>可以选择直接把字体样式下载引入到博客中，或者直接把刚才的链接引入，这里我就先选择下载到本地</p><p>把刚才查看的 css 代码另存为 &#x2F;themes&#x2F;Butterfly&#x2F;source&#x2F;css&#x2F; 中，命名为 iconfont.css<br>在 _config.butterfly.yml 中引入样式文件</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 插入代码到头部 `<span class="tag">&lt;/<span class="name">head</span>&gt;</span>` 之前 和 底部 `<span class="tag">&lt;/<span class="name">body</span>&gt;</span>` 之前</span><br><span class="line">inject:</span><br><span class="line">  head:</span><br><span class="line"># - <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/xxx.css&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/css/iconfont.css&quot;</span>&gt;</span></span><br><span class="line">  bottom:</span><br><span class="line">    # - <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;xxxx&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>我的博客主题是 Butterfly 根据自己的主题参考即可</p><p>开始使用<br>在 _config.butterfly.yml 中添加</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">social:</span><br><span class="line">  iconfont <span class="attribute">icon-git</span>: <span class="attribute">https</span>:<span class="comment">//github.com/03DuLi || Github</span></span><br><span class="line">  iconfont <span class="attribute">icon-email</span>: <span class="attribute">mailto</span>:duli2476<span class="variable">@163</span>.com || Email</span><br><span class="line">  iconfont <span class="attribute">icon-gitee1</span>: <span class="attribute">https</span>:<span class="comment">//gitee.com/dulily || Gitee</span></span><br><span class="line">  iconfont <span class="attribute">icon-csdn1</span>: <span class="attribute">https</span>:<span class="comment">//mp.csdn.net/console/article?spm=1010.2135.3001.5128 || CSDN</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>注：这里我只是引入了图标样式。没有引入图标的其他字体文件，可以根据自己的需要引入文件</p><p>样式可以查看我的博客哦<br>————————————————<br>版权声明：本文为CSDN博主「风如也」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。<br>原文链接：<a href="https://blog.csdn.net/qq_38157825/article/details/112783457">https://blog.csdn.net/qq_38157825/article/details/112783457</a></p>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo之更换背景及透明度</title>
      <link href="/posts/776d7eef/"/>
      <url>/posts/776d7eef/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
          <category> 魔改 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Butterfly主题-初始配置</title>
      <link href="/posts/b2d11da8/"/>
      <url>/posts/b2d11da8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Butterfly主题美化"><a href="#Butterfly主题美化" class="headerlink" title="Butterfly主题美化"></a>Butterfly主题美化</h1><h2 id="前置说明"><a href="#前置说明" class="headerlink" title="前置说明"></a>前置说明</h2><p> <code>node</code> 和 <code>hexo</code> 的安装过程，分别见<a href="">node</a>、<a href="">hexo</a>。</p><p>直接从初始化博客开始。</p><h2 id="初始化博客"><a href="#初始化博客" class="headerlink" title="初始化博客"></a>初始化博客</h2><p>输入一下命令，并等待程序初始化完成。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo init MyHexoBlog</span><br></pre></td></tr></table></figure><p>此时已初始化完成。</p><h2 id="安装主题"><a href="#安装主题" class="headerlink" title="安装主题"></a>安装主题</h2><p>在博客根目录里</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> -b master https://github.com/jerryc127/hexo-theme-butterfly.git themes/Butterfly</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>如果想要安装比较新，选择 dev 分支，即</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> -b dev https://github.com/jerryc127/hexo-theme-butterfly.git themes/Butterfly</span><br></pre></td></tr></table></figure><p>等待克隆完成。</p><h2 id="启用主题"><a href="#启用主题" class="headerlink" title="启用主题"></a>启用主题</h2><p>修改站点配置文件 <code>_config.yml</code> ，把主题改为 <code>Butterfly</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">theme:</span> <span class="string">Butterfly</span></span><br></pre></td></tr></table></figure><blockquote><p>如果没有 <code>pug</code> 以及 <code>stylus</code> 的渲染器，请自行下载安装：<br><code>npm install hexo-renderer-pug hexo-renderer-stylus --save or yarn add hexo-renderer-pug hexo-renderer-stylus</code></p></blockquote><h2 id="主题页面配置"><a href="#主题页面配置" class="headerlink" title="主题页面配置"></a>主题页面配置</h2><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">Front-matter（内容导航）</button></li><li class="tab"><button type="button" data-href="#super-2">标签页</button></li><li class="tab"><button type="button" data-href="#super-3">分类页</button></li><li class="tab"><button type="button" data-href="#super-4">留言板</button></li><li class="tab"><button type="button" data-href="#super-5">友情链接</button></li><li class="tab"><button type="button" data-href="#super-6">日志</button></li><li class="tab"><button type="button" data-href="#super-7">about页面</button></li><li class="tab"><button type="button" data-href="#super-8">myself</button></li><li class="tab"><button type="button" data-href="#super-9">音乐界面</button></li><li class="tab"><button type="button" data-href="#super-10">电影界面</button></li><li class="tab"><button type="button" data-href="#super-11">404頁面</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><ul><li>Page Front-matter 用于页面配置</li><li>Post Front-matter 用于文章页配置<div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">Page Front-matter</button></li><li class="tab"><button type="button" data-href="#super-2">Post Front-matter</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><ul><li>修改 <code>scaffolds</code> 中的 <code>page</code> 样板</li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">(页面标题)</span></span><br><span class="line"><span class="attr">date:</span> <span class="string">(页面创建日期)</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">(tags、categories、link这三个页面需要配置)</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">(頁面描述)</span></span><br><span class="line"><span class="attr">keywords:</span> <span class="string">(页面关键字)</span></span><br><span class="line"><span class="attr">top_img:</span> <span class="string">(设置顶部图)</span></span><br><span class="line"><span class="attr">aside:</span> <span class="string">(显示侧边栏，默认为true)</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><ul><li>修改 <code>scaffolds</code> 中的 <code>post</code> 样板</li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span></span><br><span class="line"><span class="attr">date:</span></span><br><span class="line"><span class="attr">categories:</span></span><br><span class="line"><span class="attr">tags:</span></span><br><span class="line"><span class="attr">keywords:</span></span><br><span class="line"><span class="attr">description:</span></span><br><span class="line"><span class="attr">updated:</span></span><br><span class="line"><span class="attr">top_img:</span> <span class="string">（除非特定需要，可以不写）</span></span><br><span class="line"><span class="attr">comments:</span> </span><br><span class="line"><span class="attr">copyright:</span> <span class="string">是否显示版权</span> <span class="string">（除非特定文章设置，可以不写）</span></span><br><span class="line"><span class="attr">highlight_shrink:</span> </span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><ol><li>前往 <code>Hexo</code> 博客的根目录</li><li>输入 <code>hexo new page tags</code></li><li>找到 <code>source/tags/index.md</code> 文件</li><li>修改这个文件：</li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">title:</span> <span class="string">标签</span></span><br><span class="line"><span class="attr">layout:</span> <span class="string">&quot;tags&quot;</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2022-04-12 16:23:58</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">&quot;tags&quot;</span></span><br></pre></td></tr></table></figure><p>以后上传文章的md文件中，可以在标题头中加入 <code>tags</code></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><ol><li>前往 <code>Hexo</code> 博客的根目录</li><li>输入 <code>hexo new page categories</code></li><li>找到 <code>source/categories/index.md</code> 文件</li><li>修改这个文件</li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">title:</span> <span class="string">文章分类</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2022-04-16 16:23:58</span></span><br><span class="line"><span class="attr">updated:</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">&quot;categories&quot;</span></span><br><span class="line"><span class="attr">comments:</span></span><br></pre></td></tr></table></figure><p>以后上传文章的md文件中，可以在标题头中加入 <code>categories</code></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><ul><li>前往 <code>Hexo</code> 博客的根目录</li><li>输入 <code>hexo new page messageboard</code></li><li>找到 <code>source/categories/index.md</code> 文件</li><li>修改这个文件</li></ul><p>出现 <code>source/messageboard/index.md</code>文件：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">留言板</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2022-04-20 16:23:58</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">messageboard</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><ol><li>前往 <code>Hexo</code> 博客的根目录</li><li>命令行输入 <code>hexo new page link</code></li><li>找到 <code>source/link/index.md</code> 文件</li><li>修改这个文件：</li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">title:</span> <span class="string">友情链接</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2022-04-24 16:23:58</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">&quot;link&quot;</span></span><br></pre></td></tr></table></figure><ol start="5"><li>添加友链<br>在 <code>Hexo</code> 博客目录中的 <code>source/_data</code> ，创建一个文件 <code>link.yml</code></li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">学习网站</span></span><br><span class="line">  <span class="attr">class_desc:</span> <span class="string">好好学习</span> <span class="string">|</span> <span class="string">天天向上</span></span><br><span class="line">  <span class="attr">link_list:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">菜鸟教程</span></span><br><span class="line">      <span class="attr">link:</span> <span class="string">https://www.runoob.com/</span></span><br><span class="line">      <span class="attr">avatar:</span> </span><br><span class="line">      <span class="attr">descr:</span></span><br><span class="line"></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">图片上传网络</span></span><br><span class="line">      <span class="attr">link:</span> <span class="string">https://sm.ms/</span></span><br><span class="line">      <span class="attr">avatar:</span> </span><br><span class="line">      <span class="attr">descr:</span></span><br></pre></td></tr></table></figure><ol start="6"><li>友情链接界面设置<br>需要添加友情链接，可以在 <code>Butterfly.yml</code> 配置<br>可在友情链接上写上自己的个人资料，方便其他人添加。</li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Flink:</span></span><br><span class="line">  <span class="attr">headline:</span> <span class="string">友情链接</span></span><br><span class="line">  <span class="attr">info_headline:</span> <span class="string">我的Blog资料</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">Blog</span> <span class="string">名字：</span> <span class="string">superQ博客</span></span><br><span class="line">  <span class="attr">address:</span> <span class="string">Blog</span> <span class="string">地址：</span> <span class="string">https://superq314.github.io/</span></span><br><span class="line">  <span class="attr">avatar:</span> <span class="string">Blog</span> <span class="string">头像：</span> </span><br><span class="line">  <span class="attr">info:</span> <span class="string">Blog</span> <span class="string">简介：</span> </span><br><span class="line">  <span class="attr">comment:</span> <span class="string">如果需要交换友链,请留言</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-6"><ul><li>前往 <code>Hexo</code> 博客的根目录</li><li>命令行输入 <code>hexo new page timeline</code></li><li>找到 <code>source/link/index.md</code> 文件</li><li>修改这个文件：</li></ul><p>出现 <code>source/timeline/index.md</code>文件：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">日志</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2018-01-05 00:00:00</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">timeline</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-7"><ul><li>前往 <code>Hexo</code> 博客的根目录</li><li>命令行输入 <code>hexo new page about</code></li><li>找到 <code>source/link/index.md</code> 文件</li><li>修改这个文件：</li></ul><p>出现 <code>source/about/index.md</code>文件：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">关于</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2018-01-05 00:00:00</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">about</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-8"><ul><li>前往 <code>Hexo</code> 博客的根目录</li><li>命令行输入 <code>hexo new page myself</code></li><li>找到 <code>source/link/index.md</code> 文件</li><li>修改这个文件：</li></ul><p>出现 <code>source/myself/index.md</code>文件：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">This</span> <span class="string">is</span> <span class="string">me</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2018-01-05 00:00:00</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">myself</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-9"><p><a href="%60https://github.com/MoePlayer/hexo-tag-aplayer/blob/master/docs/README-zh_cn.md%60">音乐界面参考</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-10"><p><a href="%60https://github.com/mythsman/hexo-douban%60">电影界面参考</a></p><p><a href="https://github.com/mythsman/hexo-douban">使用hexo-douban插件</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-11"><p>主題內置了一個簡單的404頁面，可在設置中開啟</p><p>本地預覽時，訪問出錯的網站是不會跳到404頁面的。</p><p>如需本地預覽，請訪問<a href="http://localhost:4000/404.html">http://localhost:4000/404.html</a></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># A simple 404 pageerror_404:</span></span><br><span class="line"><span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">subtitle:</span> <span class="string">&quot;頁面沒有找到&quot;</span></span><br><span class="line">  <span class="attr">background:</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="语言"><a href="#语言" class="headerlink" title="语言"></a>语言</h2><p>修改站点配置文件 <code>_config.yml</code><br>默认语言是 <code>en</code><br>主题支持三种语言</p><ul><li>default(en)</li><li>zh-CN (简体中文)</li><li>zh-TW (繁体中文)</li></ul><h2 id="网站资料"><a href="#网站资料" class="headerlink" title="网站资料"></a>网站资料</h2><p>修改网站各种资料，例如标题、副标题和邮箱等个人资料，请修改博客根目录的 <code>_config.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">title:</span> <span class="string">小康博客</span><span class="comment"># 标题名字</span></span><br><span class="line"><span class="attr">subtitle:</span> <span class="string">&#x27;小康博客&#x27;</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">&#x27;一个收藏回忆与分享技术的地方！&#x27;</span><span class="comment"># 签名</span></span><br><span class="line"><span class="attr">keywords:</span> <span class="string">关键词</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">作者</span><span class="comment"># 作者名字</span></span><br><span class="line"><span class="attr">language:</span> <span class="string">zh-CN</span><span class="comment"># 默认en  可以改为这个</span></span><br><span class="line"><span class="attr">timezone:</span> <span class="string">&#x27;时区&#x27;</span></span><br><span class="line"><span class="attr">email:</span> <span class="string">邮箱</span></span><br></pre></td></tr></table></figure><h2 id="导航菜单栏"><a href="#导航菜单栏" class="headerlink" title="导航菜单栏"></a>导航菜单栏</h2><p>主目录下 <code>\source\_config.butterfly.yml</code>:</p><blockquote><p>格式必须是</p><p>名称: &#x2F;xxxx&#x2F; || 图标名 <code>/xxx/</code> 。菜单名称可自己修改</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="string">首页:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-home</span></span><br><span class="line">  <span class="string">时间轴:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-archive</span></span><br><span class="line">  <span class="string">标籤:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-tags</span></span><br><span class="line">  <span class="string">分类:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-folder-open</span></span><br><span class="line">  <span class="string">清单</span> <span class="string">||</span> <span class="attr">fa fa-heartbeat:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">音乐</span> <span class="string">||</span> <span class="string">/music/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-music</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">照片</span> <span class="string">||</span> <span class="string">/Gallery/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-picture-o</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">电影</span> <span class="string">||</span> <span class="string">/movies/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-film</span></span><br><span class="line">  <span class="string">友链:</span> <span class="string">/link/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-link</span></span><br><span class="line">  <span class="string">关于:</span> <span class="string">/about/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-heart</span></span><br></pre></td></tr></table></figure><h2 id="代码块基本样式"><a href="#代码块基本样式" class="headerlink" title="代码块基本样式"></a>代码块基本样式</h2><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">代码高亮主题</button></li><li class="tab"><button type="button" data-href="#super-2">代码启用复制功能</button></li><li class="tab"><button type="button" data-href="#super-3">代码语言展示</button></li><li class="tab"><button type="button" data-href="#super-4">代码自动换行(有无横向滚动条)</button></li><li class="tab"><button type="button" data-href="#super-5">代码框展开/关闭</button></li><li class="tab"><button type="button" data-href="#super-6">代码高度限制</button></li><li class="tab"><button type="button" data-href="#super-7">代码块样式总览</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><code>Butterfly</code> 支持了 <code>Material Theme</code> 全部5种代码高亮样式：</p><ul><li>default</li><li>darker</li><li>pale night</li><li>light</li><li>ocean</li></ul><p>配置 <code>butterfly.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">highlight_theme:</span> <span class="string">light</span> <span class="comment"># 代码高亮主题</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>配置 <code>butterfly.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">highlight_copy:</span> <span class="literal">true</span> <span class="comment"># 代码是否启用复制功能</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">highlight_lang:</span> <span class="literal">true</span> <span class="comment"># 是否显示代码块语言</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>在默认情况下，<code>hexo-highlight</code> 在编译的时候不会实现代码自动换行。如果你不希望在代码块的区域里有横向滚动条的话，那么你可以考虑开启这个功能。<br>配置 <code>butterfly.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">code_word_wrap:</span> <span class="literal">true</span> <span class="comment"># 代码自动换行</span></span><br></pre></td></tr></table></figure><p>然后找到你站点的 <code>Hexo</code> 配置文件 <code>_config.yml</code> ，将 <code>line_number</code> 改成 <code>false</code> :</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">highlight:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">line_number:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">auto_detect:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">tab_replace:</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p>在默认情况下，代码框自动展开，可设置是否所有代码框都关闭状态，点击 <code>&gt;</code>可展开代码</p><ul><li>true 全部代码框不展开，需点击&gt;打开</li><li>false 代码框展开，有&gt;点击按钮</li><li>none 不显示&gt;按钮</li><li>修改 主题配置文件</li></ul><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">highlight_shrink: <span class="literal">true</span> <span class="meta">#代码框不展开，需点击 <span class="string">&#x27;&gt;&#x27;</span> 打开</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-6"><blockquote><p>3.7.0 及以上支持</p></blockquote><p>可配置代码高度限制，超出的部分会隐藏，并显示展开按钮。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">highlight_height_limit:</span> <span class="literal">false</span> <span class="comment"># unit: px</span></span><br></pre></td></tr></table></figure><p>注意：</p><blockquote><ul><li>单位是 px，直接添加数字，如 200</li><li>实际限制高度为 highlight_height_limit + 30 px ，多增加 30px 限制，目的是避免代码高度只超出highlight_height_limit 一点时，出现展开按钮，展开没内容。</li><li>不适用于隐藏后的代码块（ css 设置 display: none）</li></ul></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-7"><p>主目录下 <code>/source/_data</code>–<code>butterfly.yml</code>:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 代码块样式</span></span><br><span class="line"><span class="attr">highlight_theme:</span> <span class="string">mac</span> <span class="comment"># default/darker/pale night/light/ocean/mac /false/  前面的参数任选一项为代码块显示效果</span></span><br><span class="line"><span class="attr">highlight_copy:</span> <span class="literal">true</span> <span class="comment"># 是否显示复制按钮</span></span><br><span class="line"><span class="attr">highlight_lang:</span> <span class="literal">true</span> <span class="comment"># 是否显示代码块语言</span></span><br><span class="line"><span class="attr">highlight_shrink:</span> <span class="literal">false</span> <span class="comment">#true:打开文章默认折叠代码块内容/false:打开文章默认展开代码块/none:关闭代码折叠按钮</span></span><br><span class="line"><span class="attr">code_word_wrap:</span> <span class="literal">false</span>  <span class="comment"># 关闭滚动条</span></span><br><span class="line"><span class="attr">highlight_height_limit:</span> <span class="literal">false</span> <span class="comment"># unit: px</span></span><br></pre></td></tr></table></figure><p>然后找到 Hexo 配置文件 <code>_config.yml</code>，将 <code>line_number</code>改成 <code>false</code>:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">highlight:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">line_number:</span> <span class="literal">false</span> <span class="comment"># 改为false</span></span><br><span class="line">  <span class="attr">auto_detect:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">tab_replace:</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="各类图片设置"><a href="#各类图片设置" class="headerlink" title="各类图片设置"></a>各类图片设置</h2><p>图片可以使用 <code>网上的图片</code>(即使用该 <code>图片链接</code>)，也可以使用 <code>\themes\butterfly\source\img</code>下的图片。</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">网站图标</button></li><li class="tab"><button type="button" data-href="#super-2">头像</button></li><li class="tab"><button type="button" data-href="#super-3">主页面图片</button></li><li class="tab"><button type="button" data-href="#super-4">子标签页图片</button></li><li class="tab"><button type="button" data-href="#super-5">推荐</button></li><li class="tab"><button type="button" data-href="#super-6">文章列表封面</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Favicon（网站图标）</span></span><br><span class="line"><span class="attr">favicon:</span> <span class="string">/img/favicon.png</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Avatar (头像)</span></span><br><span class="line"><span class="attr">avatar:</span></span><br><span class="line">  <span class="attr">img:</span> <span class="string">/img/tit.png</span></span><br><span class="line">  <span class="attr">effect:</span> <span class="literal">false</span> <span class="comment"># 是否开启头像一直转圈</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># The banner image of home page (主页的横幅图像)</span></span><br><span class="line"><span class="attr">index_img:</span> <span class="string">/img/index_img.jpg</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># The banner image of archive page</span></span><br><span class="line"><span class="attr">archive_img:</span> <span class="string">/img/tag.jpg</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><ol><li>主页的顶部图可以在 <code>butterfly.yml</code>设置 <code>index_img</code></li><li><code>archives </code>页的顶部图可以在 <code>Butterfly.yml </code>设置 <code>archive_img</code></li><li>其他 <code>page页</code>的顶部图可以在各自的md页面设置 <code>front-matter</code>中的 <code>top_img</code></li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">favicon:</span> <span class="string">/img/favicon.png</span></span><br><span class="line"><span class="attr">avatar:</span></span><br><span class="line">  <span class="attr">img:</span> <span class="string">/img/tit.png</span></span><br><span class="line">  <span class="attr">effect:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">index_img:</span> <span class="string">/img/index_img.jpg</span></span><br><span class="line"><span class="attr">default_top_img:</span> <span class="string">/img/tag.jpg</span> <span class="comment">#这个推荐：不加入可能部分标签页不出现图片</span></span><br><span class="line"><span class="attr">archive_img:</span> <span class="string">/img/tag.jpg</span></span><br><span class="line"><span class="attr">tag_img:</span> <span class="string">/img/tag.jpg</span></span><br><span class="line"><span class="attr">category_img:</span> <span class="string">/img/tag.jpg</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-6"><p>在 <code>\source\_data</code>中的 <code>butterfly.yml</code>修改：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">cover:</span></span><br><span class="line">  <span class="comment"># display the cover or not (是否显示文章封面)</span></span><br><span class="line">  <span class="attr">index_enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">aside_enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">archives_enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># the position of cover in home page (封面显示的位置)</span></span><br><span class="line">  <span class="comment"># left/right/both  </span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">both</span></span><br><span class="line">  <span class="attr">default_cover:</span></span><br></pre></td></tr></table></figure><p>文章封面设置：</p><p><code>一个</code>:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">default_cover:</span> <span class="string">https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg</span></span><br></pre></td></tr></table></figure><p><code>多个</code>:</p><p>此时会 <code>随机</code>选择一张。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">default_cover:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">https://upimage.alexhchu.com/2020/10/21/671e773d973ae.jpg</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">https://upimage.alexhchu.com/2020/10/21/f5ac68ddaaf64.jpg</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">https://upimage.alexhchu.com/2020/10/21/5fecb0b094b73.jpg</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="社交图标"><a href="#社交图标" class="headerlink" title="社交图标"></a>社交图标</h2><p><code>Butterfly</code> 支持 <a href="https://fontawesome.com/v4.7.0/"><code>font-awesome v4</code></a> 和 <a href="https://fontawesome.com/icons?from=io"><code>font-awesome v5</code></a>.<br>如需开启 <a href="https://fontawesome.com/icons?from=io"><code>font-awesome v5</code></a>, 需要在 <code>Butterfly.yml</code> 上开启</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">CDN_USE:</span></span><br><span class="line">  <span class="attr">css:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">https://use.fontawesome.com/releases/v5.8.1/css/all.css</span></span><br></pre></td></tr></table></figure><p>无论 <code>V4</code> 还是 <code>V5</code> , 书写格式都是一样的 <code>图标名：url || 描述性文字</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">social:</span></span><br><span class="line">  <span class="attr">fa fa-qq:</span> <span class="string">tencent://AddContact/?fromId=50&amp;fromSubId=1&amp;subcmd=all&amp;uin=535668586</span> <span class="string">||</span> <span class="string">QQ</span></span><br><span class="line">  <span class="attr">fa fa-envelope:</span> <span class="string">mailto:sviptzk@163.com</span> <span class="string">||</span> <span class="string">Email</span></span><br><span class="line">  <span class="attr">fa fa-rss:</span> <span class="string">/atom.xml</span> </span><br></pre></td></tr></table></figure><h2 id="主页文章节选-自动节选和文章页-description"><a href="#主页文章节选-自动节选和文章页-description" class="headerlink" title="主页文章节选 (自动节选和文章页 description)"></a>主页文章节选 (自动节选和文章页 description)</h2><p>因为主题 <code>UI</code> 的关系，主页文章节选只支持自动节选和文章页 <code>description</code> 。优先选择自动节选。<br>在 <code>butterfly.yml</code> 里可以开启 <code>auto_excerpt</code> 的选项，你的文章将会在自动截取部分显示在主页。（默认显示 150 个字）。</p><p>在butterfly里，有四种可供选择</p><ol><li>description： 只显示description</li><li>both： 优先选择description，如果没有配置description，则显示自动节选的内容</li><li>auto_excerpt：只显示自动节选</li><li>false： 不显示文章内容</li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">auto_excerpt:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">length:</span> <span class="number">150</span></span><br></pre></td></tr></table></figure><p>如果没有开启 <code>自动节选</code> ，则会显示文章页 <code>front-matter</code> 里面设置的 <code>description</code> 。</p><blockquote><p>注意：如果开启了自动节选功能，代码块的显示将有可能不正常。</p></blockquote><h2 id="顶部图"><a href="#顶部图" class="headerlink" title="顶部图"></a>顶部图</h2><p>顶部图有2种配置：具体 <code>url</code> 和（留空、<code>true</code> 、 <code>false</code> ，三个效果一样）</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">page 页</button></li><li class="tab"><button type="button" data-href="#super-2">post 页</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>当具体<strong>url</strong>时<br>主页的顶部图可以在 <code>Butterfly.yml</code> 设置 <code>index_img；</code><br><code>archives</code> 页的顶部图可以在 <code>Butterfly.yml</code> 设置 <code>archive_img；</code><br>其他 <code>page</code> 页的顶部图可以在各自的 <code>md</code> 页面设置 <code>front-matter</code> 中的 <code>top_img。</code></p><blockquote><p>页面如果没有设置各自的 <code>top_img</code> ，则会显示 <code>default_top_img</code> 图片<br>当顶部图留空，<code>true</code> 和 <code>false</code><br>主页会显示纯颜色的顶部图<br>其他 <code>page</code> 的顶部图没有设置时，也会显示纯颜色的顶部图</p></blockquote><p>主题配置文件改为 <code>disable_top_img: true</code>即可关掉顶部图</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><code>post</code>页的顶部图会优先显示各自 <code>front-matter</code> 中的 <code>top_img</code> , 如果没有设置，则会缩略图（即各自 <code>front-matter</code> 中的 <code>cover</code> )，如果没有则会显示显示 <code>default_top_img</code> 图片</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="文章页相关配置"><a href="#文章页相关配置" class="headerlink" title="文章页相关配置"></a>文章页相关配置</h2><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">文章meta显示</button></li><li class="tab"><button type="button" data-href="#super-2">文章版权信息</button></li><li class="tab"><button type="button" data-href="#super-3">文章打赏</button></li><li class="tab"><button type="button" data-href="#super-4">文章置顶</button></li><li class="tab"><button type="button" data-href="#super-5">文章隐藏</button></li><li class="tab"><button type="button" data-href="#super-6">TOC目录</button></li><li class="tab"><button type="button" data-href="#super-7">相关文章</button></li><li class="tab"><button type="button" data-href="#super-8">文章锚点</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>这个选项是用来显示文章的相关信息的。配置 <code>butterfly.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">post_meta:</span></span><br><span class="line">  <span class="attr">page:</span></span><br><span class="line">    <span class="attr">date_type:</span> <span class="string">both</span> <span class="comment"># created or updated or both 主页文章日期是创建日或者更新日或都显示</span></span><br><span class="line">    <span class="attr">date_format:</span> <span class="string">relative</span> <span class="comment"># date/relative 显示日期还是相对日期</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="literal">true</span> <span class="comment"># true or false 主页是否显示分类</span></span><br><span class="line">    <span class="attr">tags:</span> <span class="literal">true</span> <span class="comment"># true or false 主页是否显示标籤</span></span><br><span class="line">    <span class="attr">label:</span> <span class="literal">true</span> <span class="comment"># true or false 显示描述性文字</span></span><br><span class="line">  </span><br><span class="line">  <span class="attr">post:</span></span><br><span class="line">    <span class="attr">date_type:</span> <span class="string">both</span> <span class="comment"># created or updated or both 文章页日期是创建日或者更新日或都显示</span></span><br><span class="line">    <span class="attr">date_format:</span> <span class="string">relative</span> <span class="comment"># date/relative 显示日期还是相对日期</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="literal">true</span> <span class="comment"># true or false 文章页是否显示分类</span></span><br><span class="line">    <span class="attr">tags:</span> <span class="literal">true</span> <span class="comment"># true or false 文章页是否显示标籤</span></span><br><span class="line">    <span class="attr">label:</span> <span class="literal">true</span> <span class="comment"># true or false 显示描述性文字</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>为你的博客文章展示文章版权和许可协议。配置 <code>butterfly.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">post_copyright:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">license:</span> <span class="string">CC</span> <span class="string">BY-NC-SA</span> <span class="number">4.0</span></span><br><span class="line">  <span class="attr">license_url:</span> <span class="string">https://creativecommons.org/licenses/by-nc-sa/4.0/</span></span><br></pre></td></tr></table></figure><p>如果有文章（例如：转载文章）不需要显示版权，可以在文章 <code>Front-matter</code> 单独设置</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">copyright:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>在你每篇文章的结尾，可以添加打赏按钮。相关二维码可以自行配置</p><p>没有提供二维码的，可配置icon图片，然后在link上添加相应的打赏链接。用户点击图片就会跳转到对应链接去。</p><p>link可以不写，会默认为图片的链接。</p><p>配置 <code>butterfly.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sponsor/reward</span></span><br><span class="line">  <span class="attr">reward:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">QR_code:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">itemlist:</span></span><br><span class="line">          <span class="attr">img:</span> <span class="string">/img/wechat.jpg</span></span><br><span class="line">  <span class="attr">link:</span> </span><br><span class="line">          <span class="attr">text:</span> <span class="string">微信</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">itemlist:</span></span><br><span class="line">          <span class="attr">img:</span> <span class="string">/img/alipay.jpg</span></span><br><span class="line">  <span class="attr">link:</span> </span><br><span class="line">          <span class="attr">text:</span> <span class="string">支付宝</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>要为你一些文章置顶，你需要如下步骤:</p><ol><li>打开 <code>hexo</code> 工作目录</li><li><code>npm uninstall hexo-generator-index --save</code> 然后 <code>npm install hexo-generator-index-pin-top --save</code></li><li>你要在文章的 <code>front-matter</code> 区域里添加 <code>top: True</code> 属性来把这篇文章置顶。</li><li>你可以参考<a href="https://github.com/netcan/hexo-generator-index-pin-top">hexo-generator-index-pin-top</a>这个仓库来了解更多细节。</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p>参考 <a href="https://github.com/printempw/hexo-hide-posts/blob/master/README_ZH.md">https://github.com/printempw/hexo-hide-posts/blob/master/README_ZH.md</a><br>在文章的 <code>Front-matter</code> 添加</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">hide:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-6"><p>在文章页，会有一个目录，用于显示 <code>TOC</code> 。 手机端默认显示按钮。<br>配置 <code>butterfly.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># toc(目录)</span></span><br><span class="line"><span class="attr">toc:</span></span><br><span class="line">  <span class="attr">post:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">page:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">number:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">expand:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">style_simple:</span> <span class="literal">false</span> <span class="comment"># for post</span></span><br></pre></td></tr></table></figure><p>为特定的文章配置是否显示TOC和特定的目录章节数字<br>在你的文章 <code>md</code> 文件的头部，加入 <code>toc_number</code> 和 <code>toc</code> 项，并配置 <code>true</code> 或者 <code>false</code> 即可。</p><table><thead><tr><th>属性</th><th>解释</th></tr></thead><tbody><tr><td>post</td><td>文章页是否显示 TOC</td></tr><tr><td>page</td><td>普通页面是否显示 TOC</td></tr><tr><td>number</td><td>是否显示章节数</td></tr><tr><td>expand</td><td>是否展开 TOC</td></tr><tr><td>style_simple</td><td>简洁模式（侧边栏只显示 TOC, 只对文章页有效 ）</td></tr></tbody></table><p>配置之后你的特定的文章将会拥有它自己的目录数字的显示与否，而不会受全局的配置影响。</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">自动打开 TOC</button></li><li class="tab"><button type="button" data-href="#super-2">为特定的文章配置</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>可选择进入文章页面时，是否自动打开 <code>sidebar</code> 显示 <code>TOC</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">auto_open_sidebar:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>在.md文章的头部，加入toc_number和toc，并配置true或者false即可。</p><p>主题会优先判断文章Markdown的Front-matter是否有配置，如有，则以Front-matter的配置为準。否则，以主题配置文件中的配置为準</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-7"><p>相关文章推荐的原理是根据文章 <code>tags</code> 的比重来推荐<br>配置 <code>butterfly.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">related_post:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment"># 是否开启</span></span><br><span class="line">  <span class="attr">limit:</span> <span class="number">6</span> <span class="comment"># 显示推荐文章数目</span></span><br><span class="line">  <span class="attr">date_type:</span> <span class="string">created</span> <span class="comment"># or created or updated 文章日期显示创建日或者更新日</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-8"><p>开启文章锚点后，当你在文章页进行滚动时，文章链接会根据标题ID进行替换<br>(注意: 每替换一次，会留下一个歷史记录。所以如果一篇文章有很多锚点的话，网页的歷史记录会很多。)</p><p>修改 主题配置文件</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># anchor</span></span><br><span class="line"><span class="comment"># when you scroll in post , the url will update according to header id.</span></span><br><span class="line"><span class="attr">anchor:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="Footer-设置"><a href="#Footer-设置" class="headerlink" title="Footer 设置"></a>Footer 设置</h2><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">博客年份</button></li><li class="tab"><button type="button" data-href="#super-2">页脚自定义文本</button></li><li class="tab"><button type="button" data-href="#super-3">ICP</button></li><li class="tab"><button type="button" data-href="#super-4">底部信息总览</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p><code>since</code> 是一个来展示你站点起始时间的选项。它位于页面的最底部。<br>配置 <code>butterfly.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">footer:</span></span><br><span class="line">  <span class="attr">owner:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">since:</span> <span class="number">2020</span> <span class="comment"># 博客年份</span></span><br><span class="line">  <span class="attr">custom_text:</span> <span class="string">Hi,</span> <span class="string">welcome</span> <span class="string">to</span> <span class="string">my</span> <span class="string">&lt;a</span> <span class="string">href=&quot;https://zhu-dongya.gitee.io/&quot;&gt;blog&lt;/a&gt;!</span></span><br><span class="line">  <span class="attr">copyright:</span> <span class="literal">true</span> <span class="comment"># Copyright of theme and framework</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><code>footer_custom_text</code> 是一个给你用来在页脚自定义文本的选项。通常你可以在这里写声明文本等。支持 <code>HTML</code> 。<br>配置 <code>butterfly.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">footer_custom_text:</span> <span class="string">Hi,</span> <span class="string">welcome</span> <span class="string">to</span> <span class="string">my</span> <span class="string">`&lt;a</span> <span class="string">href=&quot;https://www.antmoe.com/&quot;&gt;`blog</span> <span class="string">`&lt;/a&gt;`!</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>对于部分有备案的域名，可以在 <code>ICP</code> 配置显示。<br>配置 <code>butterfly.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">ICP:</span>  <span class="comment"># Chinese ICP License   #最后一句</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">url:</span> <span class="string">http://www.beian.miit.gov.cn/</span></span><br><span class="line">  <span class="attr">text:</span> <span class="string">粤ICP备xxxx</span></span><br><span class="line">  <span class="attr">icon:</span> <span class="string">/img/icp.png</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Footer</span></span><br><span class="line"><span class="comment"># Settings--------------------------------------</span></span><br><span class="line"><span class="attr">footer:</span></span><br><span class="line">  <span class="attr">owner:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">since:</span> <span class="number">2020</span></span><br><span class="line">  <span class="attr">custom_text:</span> <span class="number">11111</span></span><br><span class="line">  <span class="attr">copyright:</span> <span class="literal">true</span><span class="comment"># false： Hexo那句不显示</span></span><br><span class="line">  <span class="attr">ICP:</span> <span class="comment"># Chinese ICP License# 最后一句</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">http://www.beian.gov.cn</span></span><br><span class="line">    <span class="attr">text:</span> <span class="string">豫ICP备20001029号</span></span><br><span class="line">    <span class="attr">icon:</span> <span class="string">/img/icp.png</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/img_convert/99df40eb0ea4a5a9acc17422404e0c20.png" alt="26"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="右下角按钮"><a href="#右下角按钮" class="headerlink" title="右下角按钮"></a>右下角按钮</h2><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">简繁转换</button></li><li class="tab"><button type="button" data-href="#super-2">夜间模式</button></li><li class="tab"><button type="button" data-href="#super-3">阅读模式</button></li><li class="tab"><button type="button" data-href="#super-4">改变字体大小按钮</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>右下角会有简繁转换按钮。<br>配置 <code>butterfly.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">translate:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># 默认按钮显示文字(网站是简体，应设置为&#x27;default: 繁&#x27;)</span></span><br><span class="line">  <span class="attr">default:</span> <span class="string">简</span></span><br><span class="line">  <span class="comment">#网站默认语言，1: 繁体中文, 2: 简体中文</span></span><br><span class="line">  <span class="attr">defaultEncoding:</span> <span class="number">1</span></span><br><span class="line">  <span class="comment">#延迟时间,若不在前, 要设定延迟翻译时间, 如100表示100ms,默认为0</span></span><br><span class="line">  <span class="attr">translateDelay:</span> <span class="number">0</span></span><br><span class="line">  <span class="comment">#博客网址</span></span><br><span class="line">  <span class="attr">cookieDomain:</span> <span class="string">&#x27;https://jerryc.me/&#x27;</span></span><br><span class="line">  <span class="comment">#当文字是简体时，按钮显示的文字</span></span><br><span class="line">  <span class="attr">msgToTraditionalChinese:</span> <span class="string">&#x27;繁&#x27;</span></span><br><span class="line">  <span class="comment">#当文字是繁体时，按钮显示的文字</span></span><br><span class="line">  <span class="attr">msgToSimplifiedChinese:</span> <span class="string">&#x27;简&#x27;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>右下角会有夜间模式按钮<br>配置 <code>butterfly.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 夜间模式</span></span><br><span class="line"><span class="attr">darkmode:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># dark mode和 light mode切换按钮</span></span><br><span class="line">  <span class="attr">button:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">autoChangeMode:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><blockquote><p>V2.0.0开始增加一个选项，可开啓自动切换 <code>light mode</code> 和 <code>dark mode</code><br>autoChangeMode: 1 跟随系统而变化，不支持的浏览器 &#x2F; 系统将按照时间晚上6点到早上6点之间切换为 <code>dark mode</code><br>autoChangeMode: 2 只按照时间 晚上6点到早上6点之间切换为 <code>dark mode</code> , 其余时间为 <code>light mode</code><br>autoChangeMode: <code>false</code> 取消自动切换</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 自动切换 dark mode和 light mode</span></span><br><span class="line"><span class="attr">autoChangeMode:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>阅读模式下会去掉除文章外的内容，避免干扰閲读。<br>只会出现在文章页面，右下角会有閲读模式按钮。<br>配置 <code>butterfly.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">readmode:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>可以改变字体大小（最小能到 10px，最大能到 20px）<br>修改主题配置文件</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Change font size</span></span><br><span class="line"><span class="attr">change_font_size:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="侧边栏设置"><a href="#侧边栏设置" class="headerlink" title="侧边栏设置"></a>侧边栏设置</h2><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">主页侧边排版</button></li><li class="tab"><button type="button" data-href="#super-2">公告</button></li><li class="tab"><button type="button" data-href="#super-3">访问人数</button></li><li class="tab"><button type="button" data-href="#super-4">运行时间</button></li><li class="tab"><button type="button" data-href="#super-5">自定义侧边栏</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>可自行决定哪个项目需要显示，可决定位置。（至少需要显示一个）</p><p>配置 <code>butterfly.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">aside:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">hide:</span> <span class="literal">true</span>                                  <span class="comment"># 除了主页，其他页都隐藏侧边栏</span></span><br><span class="line">  <span class="attr">button:</span> <span class="literal">true</span>      <span class="comment"># 侧边栏收缩按钮</span></span><br><span class="line">  <span class="attr">mobile:</span> <span class="literal">true</span>                                <span class="comment"># 手機頁面（ 顯示寬度 &lt; 768px ）是否顯示aside內容</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">right</span>                             <span class="comment"># left or right</span></span><br><span class="line">  <span class="attr">card_author:</span>                                <span class="comment"># 作者卡片</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">description:</span></span><br><span class="line">    <span class="attr">button:</span></span><br><span class="line">      <span class="attr">enable:</span> <span class="literal">true</span>                           <span class="comment"># 我把访问GitHub按钮关了</span></span><br><span class="line">      <span class="attr">icon:</span> <span class="string">fab</span> <span class="string">fa-github</span></span><br><span class="line">      <span class="attr">text:</span> <span class="string">Follow</span> <span class="string">Me~</span></span><br><span class="line">      <span class="attr">link:</span> <span class="string">https://github.com/zhu-dongya</span></span><br><span class="line">  <span class="attr">card_announcement:</span>                          <span class="comment"># 公告卡片</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">content:</span> <span class="string">Hey</span> <span class="string">gus,</span> <span class="string">welcome</span> <span class="string">to</span> <span class="string">my</span> <span class="string">blog.</span></span><br><span class="line">  <span class="attr">card_recent_post:</span>                           <span class="comment"># 最新文章</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">limit:</span> <span class="number">5</span>                                  <span class="comment"># if set 0 will show all</span></span><br><span class="line">    <span class="attr">sort:</span> <span class="string">date</span>                                <span class="comment"># date or updated</span></span><br><span class="line">    <span class="attr">sort_order:</span>                               <span class="comment"># Don&#x27;t modify the setting unless you know how it works</span></span><br><span class="line">  <span class="attr">card_categories:</span>                            <span class="comment"># 分类卡片</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">limit:</span> <span class="number">8</span>                                  <span class="comment"># if set 0 will show all</span></span><br><span class="line">    <span class="attr">expand:</span> <span class="string">none</span>                              <span class="comment"># none/true/false</span></span><br><span class="line">    <span class="attr">sort_order:</span>                               <span class="comment"># Don&#x27;t modify the setting unless you know how it works</span></span><br><span class="line">  <span class="attr">card_tags:</span>                                  <span class="comment"># 标签卡片</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">limit:</span> <span class="number">40</span>                                 <span class="comment"># if set 0 will show all</span></span><br><span class="line">    <span class="attr">color:</span> <span class="literal">true</span>                               <span class="comment"># 是否开启标签颜色</span></span><br><span class="line">    <span class="attr">sort_order:</span>                               <span class="comment"># Don&#x27;t modify the setting unless you know how it works</span></span><br><span class="line">  <span class="attr">card_archives:</span>                              <span class="comment"># 时间归档</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">false</span>                             <span class="comment"># 我给关了</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">monthly</span>                             <span class="comment"># yearly or monthly</span></span><br><span class="line">    <span class="attr">format:</span> <span class="string">MMMM</span> <span class="string">YYYY</span>                         <span class="comment"># eg: YYYY年MM月</span></span><br><span class="line">    <span class="attr">order:</span> <span class="number">-1</span>                                 <span class="comment"># Sort of order. 1, asc for ascending; -1, desc for descending</span></span><br><span class="line">    <span class="attr">limit:</span> <span class="number">8</span>                                  <span class="comment"># if set 0 will show all</span></span><br><span class="line">    <span class="attr">sort_order:</span>                               <span class="comment"># Don&#x27;t modify the setting unless you know how it works</span></span><br><span class="line">  <span class="attr">card_webinfo:</span>                               <span class="comment"># 网站资讯，显示文章数目、访客数、总访问量、最后更新时间</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">post_count:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">last_push_date:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">sort_order:</span>                               <span class="comment"># Don&#x27;t modify the setting unless you know how it works</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>在 <code>\source\_data</code>中 <code>butterfly.yml</code>修改：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">card_announcement:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">content:</span> <span class="string">This</span> <span class="string">is</span> <span class="string">my</span> <span class="string">Blog</span>  <span class="comment"># 修改此处</span></span><br></pre></td></tr></table></figure><p><a href="https://img-blog.csdnimg.cn/img_convert/cde27820ef999ab58a2a33e239330970.png"><img src="https://img-blog.csdnimg.cn/img_convert/cde27820ef999ab58a2a33e239330970.png" alt="17"></a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>访问 <code>busuanzi</code> 的官方网站查看更多的介绍。<br>配置 <code>butterfly.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 访问人数</span></span><br><span class="line"><span class="attr">busuanzi:</span></span><br><span class="line">  <span class="attr">site_uv:</span> <span class="literal">true</span><span class="comment"># 是否开启本站访客数</span></span><br><span class="line">  <span class="attr">site_pv:</span> <span class="literal">true</span> <span class="comment"># 是否开启本站访客数</span></span><br><span class="line">  <span class="attr">page_pv:</span> <span class="literal">true</span> <span class="comment"># 是否开启文章页阅读量</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>网页已运行时间<br>配置 <code>butterfly.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 网页运行时间</span></span><br><span class="line"><span class="attr">runtimeshow:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">start_date:</span> <span class="number">16</span><span class="string">/4/2022</span> <span class="number">03</span><span class="string">:14:00</span></span><br><span class="line">  <span class="comment"># 格式: 月/日/年 时间</span></span><br><span class="line">  <span class="comment"># 也可以写成 年/月/日 时间</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-5"><p>  适用于&gt;&#x3D;3.8.0<br>  参考链接：<a href="https://butterfly.js.org/posts/ea33ab97/">https://butterfly.js.org/posts/ea33ab97/</a></p><blockquote><p>自定义widget参考步骤<br>在hexo博客项目根目录source&#x2F;_data文件夹中创建widget.yml文件，格式参考如下所示</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">top</span>:</span><br><span class="line">  - <span class="attr">class_name</span>: # 【可选】所创建的widget父类<span class="keyword">class</span>名</span><br><span class="line">    <span class="attr">id_name</span>:    # 【可选】所创建的widget父类id名</span><br><span class="line">    <span class="attr">name</span>:       # 【可选】所创建的widget标题</span><br><span class="line">    <span class="attr">icon</span>:       # 【可选】所创建的widget图标</span><br><span class="line">    <span class="attr">html</span>:       # 【可选】所创建的widget相关代码</span><br><span class="line"></span><br><span class="line"><span class="attr">bottom</span>:</span><br><span class="line">  - <span class="attr">class_name</span>:</span><br><span class="line">    <span class="attr">id_name</span>:</span><br><span class="line">    <span class="attr">name</span>:</span><br><span class="line">    <span class="attr">icon</span>:</span><br><span class="line">    <span class="attr">order</span>:       # 【可选】所创建的widget排序</span><br><span class="line">    <span class="attr">html</span>:</span><br></pre></td></tr></table></figure><p>  以网站资讯侧边栏为例，说明如下<br><img src="https://pic-bed-1305292171.file.myqcloud.com/wv-blog/_post/hexo-noteimage-20220115000825327.png"></p><p>  对应代码生成参考如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;div <span class="keyword">class</span>=<span class="string">&quot;card-widget 所寫的 class_name&quot;</span> id=<span class="string">&quot;所寫的 id_name&quot;</span> style=<span class="string">&quot;order: 所寫的 order&quot;</span>&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item-headline&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;所寫的 icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>所寫的 name<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item-content&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        所寫的 html</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><blockquote><p>“访客地图案例说明”</p></blockquote><p>a.获取访客地图的html代码</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span> id=<span class="string">&quot;clstr_globe&quot;</span> src=<span class="string">&quot;//clustrmaps.com/globe.js?d=5V2tOKp8qAdRM-i8eu7ETTO9ugt5uKbbG-U7Yj8uMl8&quot;</span>&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>b.创建widget.yml文件</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">bottom</span>:</span><br><span class="line">    - <span class="attr">class_name</span>: user-map</span><br><span class="line">      <span class="attr">id_name</span>: user-map</span><br><span class="line">      <span class="attr">name</span>: 访客地图</span><br><span class="line">      <span class="attr">icon</span>: fas fa-heartbeat</span><br><span class="line">      <span class="attr">order</span>:</span><br><span class="line">      <span class="attr">html</span>: <span class="string">&#x27;&lt;script type=&quot;text/javascript&quot; id=&quot;clstr_globe&quot; src=&quot;//clustrmaps.com/globe.js?d=5V2tOKp8qAdRM-i8eu7ETTO9ugt5uKbbG-U7Yj8uMl8&quot;&gt;&lt;/script&gt;&#x27;</span></span><br></pre></td></tr></table></figure><p>c.运行hexo项目，查看结果<br><img src="https://pic-bed-1305292171.file.myqcloud.com/wv-blog/_post/hexo-noteimage-20220115001159346.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="标签外挂"><a href="#标签外挂" class="headerlink" title="标签外挂"></a>标签外挂</h2><p>详情请见 <a href="/posts/75cd1967/" title="Butterfly主题-标签外挂">Butterfly主题-标签外挂</a></p><h2 id="评论"><a href="#评论" class="headerlink" title="评论"></a>评论</h2><p>评论我只觉得 <code>Valine</code> 好用。配置遵循 <a href="https://github.com/xCss/Valine">Valine</a></p><h2 id="分享"><a href="#分享" class="headerlink" title="分享"></a>分享</h2><p>我选择默认的 <code>Sharejs</code> 就好</p><h2 id="搜索系统"><a href="#搜索系统" class="headerlink" title="搜索系统"></a>搜索系统</h2><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">Algolia</button></li><li class="tab"><button type="button" data-href="#super-2">本地搜索系统</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><ol><li>你需要安装 <a href="https://github.com/oncletom/hexo-algolia">hexo-algolia</a> 或 <a href="https://github.com/LouisBarranqueiro/hexo-algoliasearch">hexo-algoliasearch</a>. 根据它们的説明文档去做相应的配置。</li><li>配置 <code>butterfly.yml</code></li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">algolia_search:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">hits:</span></span><br><span class="line">  <span class="attr">per_page:</span> <span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="attr">labels:</span></span><br><span class="line">  <span class="attr">input_placeholder:</span> <span class="string">Search</span> <span class="string">for</span> <span class="string">Posts</span></span><br><span class="line">  <span class="attr">hits_empty:</span> <span class="string">&quot;We didn&#x27;t find any results for the search: $&#123;query&#125;&quot;</span> <span class="comment"># if there are no result</span></span><br><span class="line">  <span class="attr">hits_stats:</span> <span class="string">&#x27;$&#123;hits&#125; results found in $&#123;time&#125; ms&#x27;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><ol><li>需要安装插件<a href="https://github.com/PaicHyperionDev/hexo-generator-search">hexo-generator-search</a>，不然 <code>hexo g</code> 直接报错。根据文档去做相应配置。注意格式只支持 <code>xml</code></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-generator-search --save</span><br></pre></td></tr></table></figure><ol start="2"><li>配置 <code>butterfly.yml</code></li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">local_search:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">  <span class="attr">input_placeholder:</span> <span class="string">Search</span> <span class="string">for</span> <span class="string">Posts</span></span><br><span class="line">  <span class="attr">hits_empty:</span> <span class="string">&quot;We didn&#x27;t find any results for the search: $&#123;query&#125;&quot;</span> <span class="comment"># 如果没有查到内容相关内容显示</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="网页验证"><a href="#网页验证" class="headerlink" title="网页验证"></a>网页验证</h2><p>如果需要搜索引擎收录网站，可能需要登录对应搜索引擎的管理平台进行提交。<br>各自的验证码可从各自管理平台拿到<br>配置 <code>butterfly.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Google Webmaster tools verification setting</span></span><br><span class="line"><span class="comment"># See: https://www.google.com/webmasters/</span></span><br><span class="line"><span class="attr">google_site_verification:</span></span><br><span class="line"><span class="comment"># Bing Webmaster tools verification setting</span></span><br><span class="line"><span class="comment"># See: https://www.bing.com/webmaster/</span></span><br><span class="line"><span class="attr">bing_site_verification:</span></span><br><span class="line"><span class="comment"># Yandex Webmaster tools verification setting</span></span><br><span class="line"><span class="comment"># See: https://webmaster.yandex.ru/</span></span><br><span class="line"><span class="attr">yandex_site_verification:</span></span><br><span class="line"><span class="comment"># Baidu Webmaster tools verification setting</span></span><br><span class="line"><span class="comment"># See: https://ziyuan.baidu.com/site/</span></span><br><span class="line"><span class="attr">baidu_site_verification:</span></span><br><span class="line"><span class="comment"># 360 Webmaster tools verification setting</span></span><br><span class="line"><span class="comment"># see http://zhanzhang.so.com/</span></span><br><span class="line"><span class="attr">qihu_site_verification:</span></span><br></pre></td></tr></table></figure><h2 id="分析统计"><a href="#分析统计" class="headerlink" title="分析统计"></a>分析统计</h2><p>统计找到各个平台找到代码即可</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">baidu_analytics:</span> <span class="comment">#百度统计</span></span><br><span class="line"><span class="attr">google_analytics:</span> <span class="comment"># 谷歌分析通常以 `UA-` 打头</span></span><br><span class="line"><span class="attr">tencent_analytics:</span> <span class="comment">#腾讯分析</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
          <category> Butterfly </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>计算机网络</title>
      <link href="/posts/e255a10a/"/>
      <url>/posts/e255a10a/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="HTTP-常用状态码及其含义"><a href="#HTTP-常用状态码及其含义" class="headerlink" title="HTTP-常用状态码及其含义"></a><strong>HTTP-常用状态码及其含义</strong></h3><table><thead><tr><th>状态码</th><th>类别</th><th>释义</th><th>例</th></tr></thead><tbody><tr><td>1××</td><td>信息状态码</td><td>接收的请求正在处理</td><td>100(Continue)<br /><strong>101(Switching Protocols) 切换请求协议</strong></td></tr><tr><td>2××</td><td>请求成功状态码</td><td>请求正常处理完毕</td><td><strong>200(OK) 请求成功</strong><br />204(Not Content) 预见请求<br />206(Partial Content) 范围请求，如果有Range和 if-range 将返回206</td></tr><tr><td>3××</td><td>重定向状态码</td><td>需要进行附加操作以完成请求</td><td><strong>301(Moved Permanently) 永久性重定向，返回新 <code>url</code><br />302(Move Temporarily) 临时重定向，继续使用原有 <code>url</code></strong><br />303(See other)<br />304(Not Modified)</td></tr><tr><td>4××</td><td>客户端错误状态码</td><td>服务器无法处理请求</td><td><strong>400(Bad Request) 客户端请求的语法错误</strong><br />401(Unauthorized) 认证失败<br /><strong>403(Forbidden) 服务端接受到了请求，但是拒绝访问<br />404(Not Found) 文件不存在</strong><br />405请求方式错误<br />415 未知的媒体类型</td></tr><tr><td>5××</td><td>服务端错误状态码</td><td>服务器处理请求出错</td><td><strong>500(Internal Server Error)  服务器内部错误</strong><br />502 网关错误<br />503(Service Unavailable) 服务器繁忙</td></tr></tbody></table><h4 id="状态码-301和302的区别"><a href="#状态码-301和302的区别" class="headerlink" title="状态码-301和302的区别"></a><strong>状态码-301和302的区别</strong></h4><p>301和302都有重定向的含义，但有区别。</p><ul><li>301：（永久性转移）请求的网页（资源）已被永久移动到新位置。服务器返回此响应时，会返回新的资源地址。</li><li>302：（暂时性转移）服务器目前正从不同地址的网页响应请求，但客户端应继续使用原有地址来进行以后的请求。</li></ul><h3 id="HTTP-常用的请求方式，区别和用途"><a href="#HTTP-常用的请求方式，区别和用途" class="headerlink" title="HTTP 常用的请求方式，区别和用途"></a><strong>HTTP 常用的请求方式，区别和用途</strong></h3><table><thead><tr><th>请求方式</th><th>用途</th></tr></thead><tbody><tr><td>get</td><td>对服务器资源获取的简单请求</td></tr><tr><td>post</td><td>用于发送包含用户提交数据的请求</td></tr><tr><td>put</td><td>向服务器提交数据，以修改数据</td></tr><tr><td>delete</td><td>删除服务器上的某些资源</td></tr><tr><td>head</td><td>请求页面的首部，获取资源的元信息</td></tr><tr><td>connect</td><td>用于ssl隧道的基于代理的请求</td></tr><tr><td>options</td><td>返回所有可用的方法，常用于跨域</td></tr><tr><td>trace</td><td>追踪请求-响应的传输路径</td></tr></tbody></table><p>其中，POST、DELETE、PUT、GET的含义分别对应增、删、改、查。</p><h4 id="GET和POST的区别"><a href="#GET和POST的区别" class="headerlink" title="GET和POST的区别"></a><strong>GET和POST的区别</strong></h4><a href="/posts/d73b0b5a/" title="HTTP中get和post的区别">HTTP中get和post的区别</a><h4 id="XMLHttpRequest"><a href="#XMLHttpRequest" class="headerlink" title="XMLHttpRequest"></a><strong>XMLHttpRequest</strong></h4><p>XMLHttpRequest是一个 API，它为客户端提供了在客户端和服务器之间传输数据的功能。它提供了一个通过URL来获取数据的简单方式，并且不会使整个页面刷新。这使得网页只更新一部分页面而不会打扰到用户。XMLHttpRequest在AJAX中被大量使用。</p><ul><li>使用XMLHttpRequest</li><li>POST方法，浏览器会先发送Header再发送Data。</li><li>GET方法，Header和Data会一起发送。</li></ul><h3 id="浏览器地址栏中输入url到显示主页的过程"><a href="#浏览器地址栏中输入url到显示主页的过程" class="headerlink" title="浏览器地址栏中输入url到显示主页的过程"></a><strong>浏览器地址栏中输入url到显示主页的过程</strong></h3><a href="/posts/d69b3681/" title="浏览器输入url回车之后发生了什么">浏览器输入url回车之后发生了什么</a><h3 id="HTTP-如何实现长连接？在什么时候会超时？"><a href="#HTTP-如何实现长连接？在什么时候会超时？" class="headerlink" title="HTTP 如何实现长连接？在什么时候会超时？"></a><strong>HTTP 如何实现长连接？在什么时候会超时？</strong></h3><h4 id="什么是-HTTP-的长连接？"><a href="#什么是-HTTP-的长连接？" class="headerlink" title="什么是 HTTP 的长连接？"></a><strong>什么是 HTTP 的长连接？</strong></h4><ol><li>HTTP 分为长连接和短连接， <strong>本质上说的是 TCP 的长短连接</strong> 。TCP 连接是一个双向的通道，它是可以保持一段时间不关闭的，因此 TCP 连接才具有真正的长连接和短连接这一说法。</li><li>TCP 长连接可以复用一个 TCP 连接，来发起多次的 HTTP 请求，这样就可以减少资源消耗，比如一次请求 HTML，如果是短连接的话，可能还需要请求后续的 JS&#x2F;CSS。</li></ol><h4 id="如何设置长连接？"><a href="#如何设置长连接？" class="headerlink" title="如何设置长连接？"></a><strong>如何设置长连接？</strong></h4><p>通过在头部（请求和响应头）设置 <strong>Connection</strong> 字段指定为 <code>keep-alive</code>，HTTP&#x2F;1.0 协议支持，但是是默认关闭的，从 HTTP&#x2F;1.1 以后，连接默认都是长连接。</p><h4 id="在什么时候会超时呢？"><a href="#在什么时候会超时呢？" class="headerlink" title="在什么时候会超时呢？"></a><strong>在什么时候会超时呢？</strong></h4><ul><li>HTTP 一般会有 httpd 守护进程，里面可以设置  <strong>keep-alive timeout</strong> ，当 tcp 连接闲置超过这个时间就会关闭，也可以在 HTTP 的 header 里面设置超时时间</li><li>TCP 的 <strong>keep-alive</strong> 包含三个参数，支持在系统内核的 net.ipv4 里面设置；当 TCP 连接之后，闲置了  <strong>tcp_keepalive_time</strong> ，则会发生侦测包，如果没有收到对方的 ACK，那么会每隔 tcp_keepalive_intvl 再发一次，直到发送了  <strong>tcp_keepalive_probes</strong> ，就会丢弃该连接。</li></ul><p><code>tcp_keepalive_intvl = 15</code></p><p><code>tcp_keepalive_probes = 5</code></p><p><code>tcp_keepalive_time = 1800</code></p><h4 id="在交互过程中如果数据传送完了，还不想断开连接怎么办，怎么维持？"><a href="#在交互过程中如果数据传送完了，还不想断开连接怎么办，怎么维持？" class="headerlink" title="在交互过程中如果数据传送完了，还不想断开连接怎么办，怎么维持？"></a><strong>在交互过程中如果数据传送完了，还不想断开连接怎么办，怎么维持？</strong></h4><p>HTTP中，响应体的<strong>Connection</strong>字段指定为 <code>keep-alive</code></p><h3 id="URI-和-URL-的区别"><a href="#URI-和-URL-的区别" class="headerlink" title="URI 和 URL 的区别"></a><strong>URI 和 URL 的区别</strong></h3><p><img src="https://mmbiz.qpic.cn/mmbiz_png/PMZOEonJxWeP0w7dibn7l3skTzywDDCouVFWeDVtlenx2aGKfoQEgwjdD6OFT0vwFMtLiaJfaLcPHHaKOAFKKnrQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><ul><li>URI，全称是Uniform Resource Identifier，中文翻译是统一资源标志符，主要作用是唯一标识一个资源。</li><li>URL，全称是Uniform Resource Location)，中文翻译是统一资源定位符，主要作用是提供资源的路径。</li></ul><p>URI像是身份证，可以唯一标识一个人，而URL更像一个住址，可以通过URL找到这个人。</p><h3 id="计算机网络体系结构"><a href="#计算机网络体系结构" class="headerlink" title="计算机网络体系结构"></a><strong>计算机网络体系结构</strong></h3><p>三种结构：OSI七层模型、TCP&#x2F;IP四层模型、五层体系结构。</p><p>简单说，OSI是一个理论上的网络通信模型，TCP&#x2F;IP是实际上的网络通信模型，五层结构就是为了介绍网络原理而折中的网络通信模型。</p><p><img src="https://pic3.zhimg.com/80/v2-c21d3ee1bd237370ea4a41e4bffab03a_720w.jpg"></p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">OSI 七层模型</button></li><li class="tab"><button type="button" data-href="#super-2">TCP/IP 四层模型</button></li><li class="tab"><button type="button" data-href="#super-3">网络五层体系结构</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>OSI 七层模型是国际标准化组织制定的一个用于计算机或通信系统间互联的标准体系。</p><ul><li>应用层：负责给应用程序提供统一的接口，协议有：<strong>HTTP、FTP、SMTP、SNMP、DNS</strong></li><li>表示层：数据的表示、安全、压缩。确保一个系统的应用层所发送的信息可以被另一个系统的应用层识别</li><li>会话层：建立、管理、终止会话，对应主机进程，指本地主机与远程主机正在进行的通信会话</li><li>传输层：负责端到端的数据传输，协议有 <strong>TCP、UDP</strong></li><li>网络层：负责数据的路由、转发、分片，协议有 <strong>ICMP、IGMP、IP</strong></li><li>数据链路层：负责数据的封帧和差错检测，以及 MAC 寻址</li><li>物理层：建立、维护、断开物理连接</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><ul><li>应用层：对应于<strong>OSI参考模型的应用层、表示层、会话层</strong>。</li><li>传输层: 对应<strong>OSI参考模型的传输层</strong>，为应用层实体提供端到端的通信功能，保证了数据包的顺序传送及数据的完整性。</li><li>网际层：对应于<strong>OSI参考模型的网络层</strong>，主要解决主机到主机的通信问题。</li><li>网络接口层：对应于<strong>OSI参考模型的数据链路层、物理层</strong>。</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><ul><li>应用层：对应于OSI参考模型的（应用层、表示层、会话层）</li><li>传输层：对应于OSI参考模型的传输层</li><li>网络层：对应于OSI参考模型的网络层</li><li>数据链路层：对应于OSI参考模型的数据链路层</li><li>物理层：对应于OSI参考模型的物理层</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="五层计算机网络体系结构中，每一层对应的网络协议"><a href="#五层计算机网络体系结构中，每一层对应的网络协议" class="headerlink" title="五层计算机网络体系结构中，每一层对应的网络协议"></a><strong>五层计算机网络体系结构中，每一层对应的网络协议</strong></h4><p><img src="https://pic1.zhimg.com/80/v2-16d4858be906057dee9dcb3c8a92780c_720w.jpg"></p><h4 id="那么数据在各层之间是怎么传输的呢？"><a href="#那么数据在各层之间是怎么传输的呢？" class="headerlink" title="那么数据在各层之间是怎么传输的呢？"></a><strong>那么数据在各层之间是怎么传输的呢？</strong></h4><p>对于发送方而言，从上层到下层层层包装，对于接收方而言，从下层到上层，层层解开包装。</p><ul><li>发送方的应用进程向接收方的应用进程传送数据</li><li>AP先将数据交给本主机的应用层，应用层加上本层的控制信息H5就变成了下一层的数据单元</li><li>传输层收到这个数据单元后，加上本层的控制信息H4，再交给网络层，成为网络层的数据单元</li><li>到了数据链路层，控制信息被分成两部分，分别加到本层数据单元的首部（H2）和尾部（T2）</li><li>最后的物理层，进行比特流的传输</li></ul><p><img src="https://mmbiz.qpic.cn/mmbiz_png/PMZOEonJxWeP0w7dibn7l3skTzywDDCouYjoMVXLOEMj2ZUxmCMj217QqywXHz3wSHuHlyJNXV6iaxPHuNP3icXOw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片">这个过程类似写信，写一封信，每到一层，就加一个信封，写一些地址的信息。到了目的地之后，又一层层解封，传向下一个目的地。</p><h3 id="HTTP-x3D-gt-HTTPS"><a href="#HTTP-x3D-gt-HTTPS" class="headerlink" title="HTTP &#x3D;&gt; HTTPS"></a><strong>HTTP &#x3D;&gt; HTTPS</strong></h3><h4 id="HTTP-1-0-x2F-1-1-x2F-2-0"><a href="#HTTP-1-0-x2F-1-1-x2F-2-0" class="headerlink" title="HTTP-1.0&#x2F;1.1&#x2F;2.0"></a><strong>HTTP-1.0&#x2F;1.1&#x2F;2.0</strong></h4><p>主要考察：</p><ul><li><strong>HTTP-1.0</strong> 默认是短连接，可以强制开启</li><li><strong>HTTP-1.1</strong> 默认长连接</li><li><strong>HTTP-2.0 <strong>采用</strong>多路复用</strong></li></ul><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">HTTP/1.0</button></li><li class="tab"><button type="button" data-href="#super-2">HTTP/1.1</button></li><li class="tab"><button type="button" data-href="#super-3">HTTP/2.0</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><ul><li>默认使用 <strong>短连接</strong> ，每次请求都需要建立一个TCP连接。</li><li>可以设置 <code>Connection: keep-alive</code> 这个字段，强制开启长连接。</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><ul><li>引入 <strong>持久连接</strong>，即TCP连接默认不关闭，可以被多个请求复用。</li><li>分块传输编码，即服务端没产生一块数据，就发送一块，用”流模式”取代”缓存模式”。</li><li>管道机制，即在同一个TCP连接里面，客户端可以同时发送多个请求。</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><ul><li>二进制协议，1.1版本的头信息是文本（ASCII编码），数据体可以是文本或者二进制；2.0中，头信息和数据体都是二进制。</li><li>完全多路复用，在一个连接里，客户端和浏览器都可以同时发送多个请求或回应，而且不用按照顺序一一对应。</li><li>报头压缩，HTTP协议不带有状态，每次请求都必须附上所有信息。Http&#x2F;2.0引入了头信息压缩机制，使用gzip或compress压缩后再发送。</li><li>服务端推送，允许服务器未经请求，主动向客户端发送资源。</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="HTTP-x2F-3"><a href="#HTTP-x2F-3" class="headerlink" title="HTTP&#x2F;3"></a><strong>HTTP&#x2F;3</strong></h4><p>HTTP&#x2F;3主要有两大变化， <strong>传输层基于UDP</strong> 、使用 <strong>QUIC保证UDP可靠性</strong> 。</p><p>HTTP&#x2F;2存在的一些问题，比如重传等等，都是由于TCP本身的特性导致的，所以HTTP&#x2F;3在QUIC的基础上进行发展而来，QUIC（Quick UDP Connections）直译为快速UDP网络连接，底层使用UDP进行数据传输。</p><p>HTTP&#x2F;3主要有这些特点：</p><ul><li>使用UDP作为传输层进行通信</li><li>在UDP的基础上QUIC协议保证了HTTP&#x2F;3的安全性，在传输的过程中就完成了TLS加密握手</li><li>HTTPS 要建⽴⼀个连接，要花费 6 次交互，先是建⽴三次握⼿，然后是 TLS&#x2F;1.3 的三次握⼿。QUIC 直接把以往的 TCP 和 TLS&#x2F;1.3 的 6 次交互合并成了 <strong>3</strong> 次，减少了交互次数。</li><li>QUIC 有⾃⼰的⼀套机制可以保证传输的可靠性的。当某个流发⽣丢包时，只会阻塞这个流，其他流不会受到影响。</li></ul><p>我们拿一张图看一下HTTP协议的变迁：</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/PMZOEonJxWeP0w7dibn7l3skTzywDDCouS9ibbF3HSX0ibvApdXmfH7HesOuSSyaQyXhQJTL7Bkcd9fY6M7QeSib3Q/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><h4 id="HTTP报文"><a href="#HTTP报文" class="headerlink" title="HTTP报文"></a>HTTP报文</h4><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">HTTP请求报文</button></li><li class="tab"><button type="button" data-href="#super-2">HTTP响应报文</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>HTTP 请求报文的格式如下：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">GET</span> / HTTP/<span class="number">1</span>.<span class="number">1</span></span><br><span class="line"><span class="attribute">User</span>-Agent: Mozilla/<span class="number">5</span>.<span class="number">0</span> (Macintosh; Intel Mac OS X <span class="number">10</span>_10_5)</span><br><span class="line"><span class="attribute">Accept</span>: */*</span><br></pre></td></tr></table></figure><p>HTTP 请求报文的第一行叫做请求行，后面的行叫做首部行，首部行后还可以跟一个实体主体。请求首部之后有一个空行，这个空行不能省略，它用来划分首部与实体。</p><p>请求行包含三个字段：</p><ul><li>方法字段：包括POST、GET等请方法。</li><li>URL 字段</li><li>HTTP 版本字段。</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>HTTP 响应报文的格式如下：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">HTTP</span>/<span class="number">1</span>.<span class="number">0</span> <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Content</span>-Type: text/plain</span><br><span class="line"><span class="attribute">Content</span>-Length: <span class="number">137582</span></span><br><span class="line"><span class="attribute">Expires</span>: Thu, <span class="number">05</span> Dec <span class="number">1997</span> <span class="number">16</span>:<span class="number">00</span>:<span class="number">00</span> GMT</span><br><span class="line"><span class="attribute">Last</span>-Modified: Wed, <span class="number">5</span> August <span class="number">1996</span> <span class="number">15</span>:<span class="number">55</span>:<span class="number">28</span> GMT</span><br><span class="line"><span class="attribute">Server</span>: Apache <span class="number">0</span>.<span class="number">84</span></span><br><span class="line"><span class="section">&lt;html&gt;</span></span><br><span class="line">  <span class="section">&lt;body&gt;</span><span class="attribute">Hello</span> World&lt;/body&gt;</span><br><span class="line"><span class="section">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure><p>HTTP 响应报文的第一行叫做 <strong>状态行</strong> ，后面的行是 <strong>首部行</strong> ，最后是 <strong>实体主体</strong> 。</p><ul><li><p><strong>状态行</strong>包含了三个字段：协议版本字段、状态码和相应的状态信息。</p></li><li><p><strong>实体部分</strong>是报文的主要部分，它包含了所请求的对象。</p></li><li><p><strong>首部行</strong>首部可以分为四种首部，请求首部、响应首部、通用首部和实体首部。通用首部和实体首部在请求报文和响应报文中都可以设置，区别在于请求首部和响应首部。</p><ul><li>常见的请求首部有 Accept 可接收媒体资源的类型、Accept-Charset 可接收的字符集、Host 请求的主机名。</li><li>常见的响应首部有 ETag 资源的匹配信息，Location 客户端重定向的 URI。</li><li>常见的通用首部有 Cache-Control 控制缓存策略、Connection 管理持久连接。</li><li>常见的实体首部有 Content-Length 实体主体的大小、Expires 实体主体的过期时间、Last-Modified 资源的最后修改时间。</li></ul></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="HTTP协议"><a href="#HTTP协议" class="headerlink" title="HTTP协议"></a><strong>HTTP协议</strong></h4><p>HTTP是属于应用层的协议，它是基于TCP&#x2F;IP的，所以它只是规定一些要传输的内容，以及头部信息，然后通过TCP协议进行传输，依靠IP协议进行寻址，通过一幅最简单的图来描述：</p><p><img src="https://segmentfault.com/img/remote/1460000018556044?w=315&h=108" alt="http-1" title="http-1"></p><p>客户端发出请求，服务端进行响应，就是这么简单。在整个过程中，没有任何加密的东西，所以它是不安全的，中间人可以进行拦截，获取传输和响应的数据，造成数据泄露。</p><h4 id="HTTP-协议是无状态的，如何使它有状态"><a href="#HTTP-协议是无状态的，如何使它有状态" class="headerlink" title="HTTP 协议是无状态的，如何使它有状态"></a><strong>HTTP 协议是无状态的，如何使它有状态</strong></h4><p>无状态，是客户端的状态：</p><blockquote><p>★ 当浏览器第一次发送请求给服务器时，服务器响应了；</p><p>如果同个浏览器发起第二次请求给服务器时，它还是会响应，但是呢，服务器不知道你就是刚才的那个浏览器。</p><p>简言之，HTTP协议中服务端不会保存客户端的任何信息，所以是无状态协议。</p></blockquote><h4 id="数字签名-数字证书"><a href="#数字签名-数字证书" class="headerlink" title="数字签名 数字证书"></a><strong>数字签名 数字证书</strong></h4><p>HTTPS原理跟数字证书有关，需要掌握HTTPS原理。</p><p>数字证书：在互联网通讯中标志通讯各方身份信息的一个数字认证，在网上用它来识别对方的身份。它的出现，是为了避免身份被篡改冒充的。比如HTTPS的数字证书，就是为了避免公钥被中间人冒充篡改：</p><p><img src="https://pic3.zhimg.com/80/v2-82ff87bab5731fbb04980296e2b57682_720w.jpg"></p><p><strong>数字证书构成</strong></p><ul><li><strong>公钥</strong>和<strong>个人等信息</strong>，经过Hash摘要算法加密，形成<strong>消息摘要</strong></li><li>将<strong>消息摘要</strong>拿到拥有公信力的认证中心（CA），用它的私钥对消息摘要加密，形成 <strong>数字签名</strong></li><li><strong>公钥</strong>和<strong>个人信息</strong>、<strong>数字签名</strong>共同构成 <strong>数字证书</strong></li></ul><h4 id="对称加密与非对称加密的区别"><a href="#对称加密与非对称加密的区别" class="headerlink" title="对称加密与非对称加密的区别"></a><strong>对称加密与非对称加密的区别</strong></h4><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">对称加密</button></li><li class="tab"><button type="button" data-href="#super-2">非对称加密</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>加密和解密使用同一密钥</p><p>优点：运算速度较快</p><p>缺点：如何安全将密钥传输给另一方。</p><p>常见的对称加密算法：DES、AES等。</p><p><img src="https://pic4.zhimg.com/80/v2-7243afc7200a003e3dfe4eda131ee2e3_720w.jpg"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>指的是加密和解密使用不同的密钥（即公钥和私钥）。公钥与私钥是成对存在的，如果用公钥对数据进行加密，只有对应的私钥才能解密。</p><p>常见的非对称加密算法：RSA。</p><p><img src="https://pic1.zhimg.com/80/v2-ca59e19646a1eb5a57a8d526e4ea3338_720w.jpg"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="HTTPS"><a href="#HTTPS" class="headerlink" title="HTTPS"></a><strong>HTTPS</strong></h4><p>在http的基础上，增加了 TLS&#x2F;SSL 协议进行加密传输、身份认证网络协议，通过数字证书、加密算法（RSA）、非对称加密进行传输</p><p><strong>HTTPS &#x3D; HTTP+SSL&#x2F;TLS</strong> ，可以理解HTTPS是身披SSL(Secure Socket Layer，安全套接层)的HTTP。</p><ul><li>对称加密</li></ul><blockquote><p>客户端和服务端都采用一样的密钥，比如DES、AES</p></blockquote><ul><li>非对称加密</li></ul><blockquote><p>客户端和服务端都采用不同的密钥，一把作为私钥，一把作为公钥，公钥加密的信息只能被私钥加密，反之，私钥加密的信息，只能被公钥解密。</p></blockquote><h4 id="HTTPS-工作流程"><a href="#HTTPS-工作流程" class="headerlink" title="HTTPS 工作流程"></a><strong>HTTPS 工作流程</strong></h4><p>要点：<strong>公私钥、数字证书、加密、对称加密、非对称加密</strong></p><ul><li>HTTPS &#x3D; HTTP + SSL&#x2F;TLS，也就是用SSL&#x2F;TLS对数据进行加密和解密，Http进行传输。</li><li>SSL，即Secure Sockets Layer（安全套接层协议），是网络通信提供安全及数据完整性的一种安全协议。</li><li>TLS，即Transport Layer Security(安全传输层协议)，它是SSL3.0的后续版本。</li></ul><p><img src="https://pic2.zhimg.com/80/v2-6273d3dc5947ed3d0b17b3ddd32de725_720w.jpg"></p><ol><li>客户端发起HTTPS请求，连接到服务器的443端口。</li><li>服务器必须要有一套数字证书（证书内容有公钥、证书颁发机构、失效日期等）。</li><li>服务器将自己的数字证书发送给客户端（公钥在证书里面，私钥由服务器持有）。</li><li>客户端收到数字证书之后，会验证证书的合法性。如果证书验证通过，就会生成一个随机的对称密钥，用证书的公钥加密。</li><li>客户端将公钥加密后的密钥发送到服务器。</li><li>服务器接收到客户端发来的密文密钥之后，用自己之前保留的私钥对其进行非对称解密，解密之后就得到客户端的密钥，然后用客户端密钥对返回数据进行对称加密，酱紫传输的数据都是密文啦。</li><li>服务器将加密后的密文返回到客户端。</li><li>客户端收到后，用自己的密钥对其进行对称解密，得到服务器返回的数据。</li></ol><h4 id="HTTP-与-HTTPS-的区别"><a href="#HTTP-与-HTTPS-的区别" class="headerlink" title="HTTP 与 HTTPS 的区别"></a><strong>HTTP 与 HTTPS 的区别</strong></h4><p>从<strong>安全性</strong>、<strong>数据是否加密</strong>、<strong>默认端口</strong>等这几个方面回答。</p><p>HTTP：超文本传输协议，基于TCP&#x2F;IP通信协议来传递明文数据的协议。</p><p>HTTP会存在以下<strong>问题</strong> ：</p><ul><li>请求信息是明文传输，容易被窃听截取（窃听风险）</li><li>没有验证对方身份，存在被冒充的风险（冒充风险）</li><li>数据的完整性未校验，容易被中间人篡改（篡改风险）</li></ul><p>HTTPS 在 HTTP 与 TCP 层之间加⼊ SSL&#x2F;TLS 协议，解决以下风险：</p><ul><li><strong>信息加密</strong> ：交互信息⽆法被窃取。</li><li><strong>校验机制</strong> ：⽆法篡改通信内容，篡改了就不能正常显示。</li><li><strong>身份证书</strong> ：能证明淘宝是真淘宝。</li></ul><p>所以SSL&#x2F;TLS 协议是能保证通信是安全的。</p><p>主要区别如下：</p><table><thead><tr><th>属性</th><th>Http</th><th>Https</th></tr></thead><tbody><tr><td>安全性</td><td>不安全</td><td>安全</td></tr><tr><td>默认端口</td><td>80</td><td>443</td></tr><tr><td>资源消耗</td><td>较少</td><td>较多</td></tr><tr><td>是否需要证书</td><td>不需要</td><td>需要</td></tr><tr><td>报文是否加密</td><td>明文</td><td>加密</td></tr></tbody></table><h3 id="Session和Cookie的区别"><a href="#Session和Cookie的区别" class="headerlink" title="Session和Cookie的区别"></a><strong>Session和Cookie的区别</strong></h3><p>记录状态主要有两个办法：Session、Cookie。</p><ul><li>Session：服务器和客户端一次会话的过程。Session利用Cookie进行信息处理的，当用户首先进行了请求后，服务端就在用户浏览器上创建了一个Cookie，当这个Session结束时，其实就是意味着这个Cookie就过期了。Session对象存储着特定用户会话所需的属性及配置信息。</li><li>Cookie：保存在客户端的一小块文本串的数据。客户端向服务器发起请求时，服务端会向客户端发送一个Cookie，客户端就把Cookie保存起来。在客户端下次向同一服务器再发起请求时，Cookie被携带发送到服务器。服务器就是根据这个Cookie来确认身份的。</li></ul><h4 id="Session和Cookie的区别主要有这些："><a href="#Session和Cookie的区别主要有这些：" class="headerlink" title="Session和Cookie的区别主要有这些："></a><strong>Session和Cookie的区别主要有这些：</strong></h4><table><thead><tr><th></th><th>Session</th><th>Cookie</th></tr></thead><tbody><tr><td>存储位置</td><td>服务器</td><td>客户端</td></tr><tr><td>存储数据类型</td><td>任意数据类型<br />可用于保持一些常用变量信息</td><td>ASCII</td></tr><tr><td>安全性</td><td>较高</td><td>较低</td></tr><tr><td>存储空间小</td><td>大</td><td>小</td></tr><tr><td>有效期</td><td>较短<br />超时或者客户端关闭都会失效</td><td>可设置长时间保持</td></tr></tbody></table><h4 id="Session-和-Cookie的关联"><a href="#Session-和-Cookie的关联" class="headerlink" title="Session 和 Cookie的关联"></a><strong>Session 和 Cookie的关联</strong></h4><p><img src="https://pic4.zhimg.com/80/v2-3a0d423ac0c21b22f061d839afb8aab7_720w.jpg" alt="img"></p><ul><li>用户第一次请求服务器时，服务器根据用户提交的信息，创建对应的Session，请求返回时将此Session的唯一标识信息SessionID返回给浏览器，浏览器接收到服务器返回的SessionID信息后，会将此信息存入Cookie中，同时Cookie记录此SessionID是属于哪个域名。</li><li>当用户第二次访问服务器时，请求会自动判断此域名下是否存在Cookie信息，如果存在，则自动将Cookie信息也发送给服务端，服务端会从Cookie中获取SessionID，再根据 SessionID查找对应的 Session信息，如果没有找到，说明用户没有登录或者登录失效，如果找到Session证明用户已经登录可执行后面操作。</li></ul><h4 id="分布式环境下Session的处理方式"><a href="#分布式环境下Session的处理方式" class="headerlink" title="分布式环境下Session的处理方式"></a><strong>分布式环境下Session的处理方式</strong></h4><p>分布式环境下，客户端请求经过负载均衡，可能会分配到不同的服务器上，假如一个用户的请求两次没有落到同一台服务器上，那么在新的服务器上就没有记录用户状态的Session。</p><p>这时候怎么办呢？</p><p>可以使用Redis等分布式缓存来存储Session，在多台服务器之间共享。</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/PMZOEonJxWeP0w7dibn7l3skTzywDDCouhlhrmnDC6LHBaZ6ZL5HHIvKKZuARrxycamdJpcjRRnge3004v1rbdg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><h4 id="客户端无法使用Cookie怎么办？"><a href="#客户端无法使用Cookie怎么办？" class="headerlink" title="客户端无法使用Cookie怎么办？"></a><strong>客户端无法使用Cookie怎么办？</strong></h4><p>有可能客户端无法使用Cookie，比如浏览器禁用Cookie，或者客户端是安卓、IOS等等。</p><p>这时候怎么办？SessionID怎么存？怎么传给服务端呢？</p><p>首先是SessionID的存储，可以使用客户端的本地存储，比如浏览器的sessionStorage。</p><p>接下来怎么传呢？</p><ul><li>拼接到URL里：直接把SessionID作为URL的请求参数</li><li>放到请求头里：把SessionID放到请求的Header里，比较常用。</li></ul><h3 id="WebSocket与socket的区别"><a href="#WebSocket与socket的区别" class="headerlink" title="WebSocket与socket的区别"></a><strong>WebSocket与socket的区别</strong></h3><ul><li><strong>Socket</strong> <strong>&#x3D;</strong> <strong>IP地址 + 端口 + 协议</strong></li></ul><blockquote><p>★ 具体来说，Socket是一套标准，它完成了对TCP&#x2F;IP的高度封装，屏蔽网络细节，以方便开发者更好地进行网络编程。</p></blockquote><ul><li>WebSocket：持久化协议，伴随H5而出，用来解决<strong>HTTP不支持持久化连接</strong>的问题。</li><li>WebSocket：应用层通信协议</li><li>Socket：<strong>网编编程的标准接口</strong></li></ul><h4 id="端口号及对应服务"><a href="#端口号及对应服务" class="headerlink" title="端口号及对应服务"></a><strong>端口号及对应服务</strong></h4><table><thead><tr><th>端口</th><th>服务</th></tr></thead><tbody><tr><td>21</td><td>FTP(文件传输协议)</td></tr><tr><td>22</td><td>SSH</td></tr><tr><td>23</td><td>Telnet(远程登录)服务</td></tr><tr><td>25</td><td>SMTP(简单邮件传输协议)</td></tr><tr><td>53</td><td>DNS域名服务器</td></tr><tr><td>80</td><td>HTTP超文本传输协议</td></tr><tr><td>110</td><td>POP3邮件协议3</td></tr><tr><td>443</td><td>HTTPS</td></tr><tr><td>1080</td><td>Sockets</td></tr><tr><td>1521</td><td>Oracle数据库默认端口</td></tr><tr><td>3306</td><td>MySQL服务默认端口</td></tr></tbody></table><h3 id="forward和redirect的区别"><a href="#forward和redirect的区别" class="headerlink" title="forward和redirect的区别"></a><strong>forward和redirect的区别</strong></h3><ul><li><strong>直接转发方式（Forward）</strong>：客户端和浏览器只发出一次请求，Servlet、HTML、JSP或其它信息资源，由第二个信息资源响应该请求，在请求对象request中，保存的对象对于每个信息资源是共享的。</li><li><strong>间接转发方式（Redirect）</strong>：实际是两次HTTP请求，服务器端在响应第一次请求的时候，让浏览器再向另外一个URL发出请求，从而达到转发的目的。</li></ul><p>看下这两个图，可以更容易理解一些:</p><ul><li>Redirect 的工作原理：</li></ul><p><img src="https://pic1.zhimg.com/80/v2-5d056c03218601f9c1ceb039be486708_720w.jpg"></p><ul><li>forward 的工作原理</li></ul><p><img src="https://pic4.zhimg.com/80/v2-9d5646635cf3907b1c1cbfb01d3188bf_720w.jpg"></p><h3 id="IP地址分类"><a href="#IP地址分类" class="headerlink" title="IP地址分类"></a><strong>IP地址分类</strong></h3><p>IP地址&#x3D;网络号+主机号。</p><ol><li>网络号：标志主机所连接的网络地址表示属于互联网的哪一个网络。</li><li>主机号：标志主机地址表示其属于该网络中的哪一台主机。</li></ol><p>IP地址分为A，B，C，D，E五大类：</p><ul><li>A类地址(1~126)：以0开头，网络号占前8位，主机号占后面24位。</li><li>B类地址(128~191)：以10开头，网络号占前16位，主机号占后面16位。</li><li>C类地址(192~223)：以110开头，网络号占前24位，主机号占后面8位。</li><li>D类地址(224~239)：以1110开头，保留位多播地址。</li><li>E类地址(240~255)：以11110开头，保留位为将来使用</li></ul><p><img src="https://pic4.zhimg.com/80/v2-f376714d7166c8f6fe51532a1192894b_720w.jpg"></p><h3 id="IP地址和MAC地址的区别及各自作用"><a href="#IP地址和MAC地址的区别及各自作用" class="headerlink" title="IP地址和MAC地址的区别及各自作用"></a><strong>IP地址和MAC地址的区别及各自作用</strong></h3><p>IP 地址主要用来网络寻址用的，就是大致定位你在哪里</p><p>MAC 地址，则是身份的唯一象征，通过 MAC 来唯一确认这人是不是就是你，MAC 地址不具备寻址的功能。</p><h3 id="ARP协议的工作过程"><a href="#ARP协议的工作过程" class="headerlink" title="ARP协议的工作过程"></a><strong>ARP协议的工作过程</strong></h3><p>ARP 协议， <strong>Address Resolution Protocol</strong> ，地址解析协议，用于实现IP地址到MAC地址的映射。</p><ol><li>每台主机都会在自己的ARP缓冲区中建立一个ARP列表，以表示IP地址和MAC地址的对应关系。</li><li>当源主机需要将一个数据包要发送到目的主机时，会首先检查自己的ARP列表，是否存在该IP地址对应的MAC地址；如果有﹐就直接将数据包发送到这个MAC地址；如果没有，就向本地网段发起一个ARP请求的广播包，查询此目的主机对应的MAC地址。此ARP请求的数据包里，包括源主机的IP地址、硬件地址、以及目的主机的IP地址。</li><li>网络中所有的主机收到这个ARP请求后，会检查数据包中的目的IP是否和自己的IP地址一致。如果不相同，就会忽略此数据包；如果相同，该主机首先将发送端的MAC地址和IP地址添加到自己的ARP列表中，如果ARP表中已经存在该IP的信息，则将其覆盖，然后给源主机发送一个 ARP响应数据包，告诉对方自己是它需要查找的MAC地址。</li><li>源主机收到这个ARP响应数据包后，将得到的目的主机的IP地址和MAC地址添加到自己的ARP列表中，并利用此信息开始数据的传输。如果源主机一直没有收到ARP响应数据包，表示ARP查询失败。</li></ol><h3 id="TCP-和-UDP"><a href="#TCP-和-UDP" class="headerlink" title="TCP 和 UDP"></a><strong>TCP 和 UDP</strong></h3><h4 id="TCP和UDP的区别"><a href="#TCP和UDP的区别" class="headerlink" title="TCP和UDP的区别"></a><strong>TCP和UDP的区别</strong></h4><p><strong>思路：</strong> 这道题，校招的时候，问的概率高点，概念性的东西， <strong>TCP是面向连接，而UDP是无连接</strong> 。</p><table><thead><tr><th></th><th>TCP</th><th>UDP</th></tr></thead><tbody><tr><td>是否面向连接</td><td>面向连接</td><td>面向无连接</td></tr><tr><td>是否可靠</td><td>可靠</td><td>不可靠</td></tr><tr><td>传输数据</td><td>有序</td><td>不保证无序性</td></tr><tr><td>传输速度</td><td>慢</td><td>快</td></tr><tr><td>数据边界</td><td>不保存</td><td>保留</td></tr><tr><td>报文格式</td><td>面向字节流</td><td>面向报文</td></tr><tr><td>适用场景</td><td>网页、邮件</td><td>语音、广播</td></tr></tbody></table><h4 id="TCP-和-UDP-分别对应的常见应用层协议"><a href="#TCP-和-UDP-分别对应的常见应用层协议" class="headerlink" title="TCP 和 UDP 分别对应的常见应用层协议"></a><strong>TCP 和 UDP 分别对应的常见应用层协议</strong></h4><p><strong>基于可靠的TCP协议</strong></p><ul><li><strong>FTP</strong>：文件传输协议，默认端口(20用于传输数据，21用于传输控制信息)</li><li><strong>SSH</strong>：安全外壳协议，默认端口 22</li><li><strong>TELNET</strong>：远程登陆协议，默认端口23</li><li><strong>SMTP</strong>：简单邮件传输协议，默认端口25</li><li><strong>HTTP</strong>：超文本传输协议，默认端口80</li></ul><p><strong>基于不可靠的UDP协议</strong></p><ul><li><strong>DNS</strong>：用于域名解析服务，将域名地址转换为 IP 地址，默认端口 53</li><li><strong>TFTP</strong>：简单文件传输协议，默认端口69</li><li><strong>SNMP</strong>：简单网络管理协议，用来管理网络设备的，通过UDP端口161接收，只有Trap信息采用UDP端口162。</li></ul><h4 id="TCP-和-UDP-应用场景"><a href="#TCP-和-UDP-应用场景" class="headerlink" title="TCP 和 UDP 应用场景"></a><strong>TCP 和 UDP 应用场景</strong></h4><p>TCP 应用场景：</p><p>效率要求相对低，但对准确性要求相对高的场景。因为传输中需要对数据确认、重发、排序等操作，相比之下效率没有 UDP 高。</p><p>UDP 应用场景：</p><p>效率要求相对高，对准确性要求相对低的场景。</p><h3 id="ICMP协议的功能"><a href="#ICMP协议的功能" class="headerlink" title="ICMP协议的功能"></a><strong>ICMP协议的功能</strong></h3><p>ICMP,Internet Control Message Protocol ,Internet控制消息协议。</p><ul><li>ICMP协议是一种面向无连接的协议，用于传输出错报告控制信息。</li><li>它是一个非常重要的协议，它对于网络安全具有极其重要的意义。它属于网络层协议，主要用于在主机与路由器之间传递控制信息，包括<strong>报告错误、交换受限控制和状态信息</strong>等。</li><li>当遇到IP数据无法访问目标、IP路由器无法按当前的传输速率转发数据包等情况时，会自动发送ICMP消息。</li></ul><p>比如我们日常使用得比较多的 <strong>ping</strong> ，就是基于ICMP的。</p><h3 id="说下ping的原理"><a href="#说下ping的原理" class="headerlink" title="说下ping的原理"></a><strong>说下ping的原理</strong></h3><blockquote><p>★ ping， <strong>Packet Internet Groper</strong> ，是一种因特网包探索器，用于测试网络连接量的程序。Ping是工作在TCP&#x2F;IP网络体系结构中应用层的一个服务命令， 主要是向特定的目的主机发送ICMP（Internet Control Message Protocol 因特网报文控制协议） 请求报文，测试目的站是否可达及了解其有关状态<br>”</p></blockquote><p>一般来说，ping可以用来检测网络通不通。它是基于 <code>ICMP</code>协议工作的。假设<strong>机器A</strong> ping <strong>机器B</strong> ，工作过程如下：</p><ol><li>ping通知系统，新建一个固定格式的ICMP请求数据包</li><li>ICMP协议，将该数据包和目标机器B的IP地址打包，一起转交给IP协议层</li><li>IP层协议将本机IP地址为源地址，机器B的IP地址为目标地址，加上一些其他的控制信息，构建一个IP数据包</li><li>先获取目标机器B的MAC地址。</li><li>数据链路层构建一个数据帧，目的地址是IP层传过来的 <strong>MAC地址</strong> ，源地址是本机的<strong>MAC地址</strong></li><li>机器B收到后，对比目标地址，和自己本机的MAC地址是否一致，符合就处理返回，不符合就丢弃。</li><li>根据目的主机返回的ICMP回送回答报文中的时间戳，从而计算出往返时间</li><li>最终显示结果有这几项：发送到目的主机的IP地址、发送 &amp; 收到 &amp; 丢失的分组数、往返时间的最小、最大&amp; 平均值</li></ol><h3 id="TCP-三次握手机制"><a href="#TCP-三次握手机制" class="headerlink" title="TCP 三次握手机制"></a><strong>TCP 三次握手机制</strong></h3><p>需要记住：通讯过程  客户端、服务器的对应状态</p><p>TCP提供可靠的连接服务，连接是通过三次握手进行初始化的。</p><p>三次握手的目的：同步连接双方的序列号和确认号并交换TCP窗口大小信息。</p><p>流程图：</p><p><img src="https://pic1.zhimg.com/80/v2-245b7a106bae594ff2a84d1a305a3764_720w.jpg"></p><p>刚开始客户端处于closed的状态，服务端处于listen状态。然后：</p><ul><li>第一次握手：客户端给服务端发一个SYN报文，并指明客户端的初始化序列号<strong>ISN(client)<strong>。此时客户端处于</strong>SYN_Send状态</strong>。</li><li>第二次握手：服务器收到客户端的SYN报文之后，会以自己的SYN报文作为应答，并且也是指定了自己的初始化序列号<strong>ISN(server)<strong>，同时会把客户端的</strong>ISN ＋1</strong> &#x3D;&gt; <strong>ACK</strong>，表示自己已经收到了客户端的SYN，此时服务器处于<strong>SYN_RCVD****状态</strong>。</li><li>第三次握手：客户端收到SYN报文之后，会发送一个ACK报文，当然，也是一样把服务器的<strong>ISN +1 &#x3D;&gt; ACK</strong>，表示已经收到了服务端的SYN报文，此时客户端处于<strong>established状态</strong>。</li><li>服务器收到ACK报文之后，也处于<strong>established状态</strong>，此时，双方以建立起了链接</li></ul><h4 id="为什么握手不能是两次呢？"><a href="#为什么握手不能是两次呢？" class="headerlink" title="为什么握手不能是两次呢？"></a><strong>为什么握手不能是两次呢？</strong></h4><p>第一次握手：客户端发送网络包，服务端收到了。</p><p>这样服务端就能得出结论:客户端的发送能力、服务端的接收能力是正常的。<br>第二次握手：服务端发包，客户端收到了。</p><p>这样客户端就能得出结论:服务端的接收、发送能力，客户端的接收、发送能力是正常的。不过此时服务器并不能确认客户端的接收能力是否正常。<br>第三次握手：客户端发包，服务端收到了。</p><p>这样服务端就能得出结论:客户端的接收、发送能力正常，服务器自己的发送、接收能力也正常。</p><h4 id="三次握手中每一次没收到报文会发生什么情况？"><a href="#三次握手中每一次没收到报文会发生什么情况？" class="headerlink" title="三次握手中每一次没收到报文会发生什么情况？"></a><strong>三次握手中每一次没收到报文会发生什么情况？</strong></h4><ul><li><p>第一次握手服务端未收到SYN报文</p><p>服务端不会进行任何的动作，而客户端由于一段时间内没有收到服务端发来的确认报文，等待一段时间后会重新发送SYN报文，如果仍然没有回应，会重复这个过程，直到发送次数超过最大重传次数限制，就会返回连接建立失败。</p></li><li><p>第二次握手客户端未收到服务端响应的ACK报文</p><p>客户端会继续重传，直到次数限制；而服务端此时会阻塞在accept()处，等待客户端发送ACK报文</p></li><li><p>第三次握手服务端为收到客户端发送过来的ACK报文</p><p>服务端同样会采用类似客户端的超时重传机制，如果重试次数超过限制，则accept()调用返回-1，服务端建立连接失败；而此时客户端认为自己已经建立连接成功，因此开始向服务端发送数据，但是服务端的accept()系统调用已经返回，此时不在监听状态，因此服务端接收到客户端发送来的数据时会发送RST报文给客户端，消除客户端单方面建立连接的状态。</p></li></ul><h4 id="第二次握手传回了-ACK，为什么还要传回-SYN？"><a href="#第二次握手传回了-ACK，为什么还要传回-SYN？" class="headerlink" title="第二次握手传回了 ACK，为什么还要传回 SYN？"></a><strong>第二次握手传回了 ACK，为什么还要传回 SYN？</strong></h4><p>ACK是为了告诉客户端传来的数据已经接收无误。</p><p>而传回SYN是为了告诉客户端，服务端响应的确实是客户端发送的报文。</p><h4 id="第3次握手可以携带数据吗？"><a href="#第3次握手可以携带数据吗？" class="headerlink" title="第3次握手可以携带数据吗？"></a><strong>第3次握手可以携带数据吗？</strong></h4><p>第3次握手是可以携带数据的。</p><p>此时客户端已经处于ESTABLISHED状态。对于客户端来说，它已经建立连接成功，并且确认服务端的接收和发送能力是正常的。</p><p>第一次握手不能携带数据是出于安全的考虑，因为如果允许携带数据，攻击者每次在SYN报文中携带大量数据，就会导致服务端消耗更多的时间和空间去处理这些报文，会造成CPU和内存的消耗。</p><h3 id="说说半连接队列和-SYN-Flood-攻击的关系？"><a href="#说说半连接队列和-SYN-Flood-攻击的关系？" class="headerlink" title="说说半连接队列和 SYN Flood 攻击的关系？"></a><strong>说说半连接队列和 SYN Flood 攻击的关系？</strong></h3><h4 id="什么是半连接队列？"><a href="#什么是半连接队列？" class="headerlink" title="什么是半连接队列？"></a><strong>什么是半连接队列？</strong></h4><p>TCP 进入三次握手前，服务端会从 <strong>CLOSED</strong> 状态变为 <strong>LISTEN</strong> 状态, 同时在内部创建了两个队列：半连接队列（SYN 队列）和全连接队列（ACCEPT 队列）。</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/PMZOEonJxWeP0w7dibn7l3skTzywDDCouIcNMcQdCBPnqPqEwR0kHpjPvbkIhTsCrNjbPomUVicBHRyHnC4TB73Q/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"><br>三次握手中创建的队列</p><p>顾名思义，半连接队列存放的是三次握手未完成的连接，全连接队列存放的是完成三次握手的连接。</p><ul><li>TCP 三次握手时，客户端发送 SYN 到服务端，服务端收到之后，便回复  <strong>ACK 和 SYN</strong> ，状态由  <strong>LISTEN 变为 SYN_RCVD</strong> ，此时这个连接就被推入了  <strong>SYN 队列</strong> ，即半连接队列。</li><li>当客户端回复 ACK, 服务端接收后，三次握手就完成了。这时连接会等待被具体的应用取走，在被取走之前，它被推入 ACCEPT 队列，即全连接队列。</li></ul><h4 id="什么是SYN-Flood-？"><a href="#什么是SYN-Flood-？" class="headerlink" title="什么是SYN Flood ？"></a><strong>什么是SYN Flood ？</strong></h4><p>SYN Flood 是一种典型的 DDos 攻击，它在短时间内，伪造 <strong>不存在的 IP 地址</strong> , 向服务器发送大量SYN 报文。当服务器回复 SYN+ACK 报文后，不会收到 ACK 回应报文，那么SYN队列里的连接旧不会出对队，久⽽久之就会占满服务端的 <strong>SYN</strong> 接收队列（半连接队列），使得服务器不能为正常⽤户服务。</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/PMZOEonJxWeP0w7dibn7l3skTzywDDCouwBlNnPhnVPPAtmU4cgauRm0ho2MA8rMhTwbwAG2brMzI7LfGLUOHyA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><h4 id="那有什么应对方案呢？"><a href="#那有什么应对方案呢？" class="headerlink" title="那有什么应对方案呢？"></a><strong>那有什么应对方案呢？</strong></h4><p>主要有 <strong>syn cookie</strong> 和 <strong>SYN Proxy 防火墙</strong>等。</p><ul><li><strong>syn cookie</strong> ：在收到 SYN 包后，服务器根据一定的方法，以数据包的源地址、端口等信息为参数计算出一个 cookie 值作为自己的 SYNACK 包的序列号，回复 SYN+ACK 后，服务器并不立即分配资源进行处理，等收到发送方的 ACK 包后，重新根据数据包的源地址、端口计算该包中的确认序列号是否正确，如果正确则建立连接，否则丢弃该包。</li><li><strong>SYN Proxy 防火墙</strong> ：服务器防火墙会对收到的每一个 SYN 报文进行代理和回应，并保持半连接。等发送方将 ACK 包返回后，再重新构造 SYN 包发到服务器，建立真正的 TCP 连接。</li></ul><h3 id="TCP-四次挥手过程"><a href="#TCP-四次挥手过程" class="headerlink" title="TCP 四次挥手过程"></a><strong>TCP 四次挥手过程</strong></h3><p><img src="https://pic2.zhimg.com/80/v2-5ab61a8e3d4b30c5f7fb661b3daead71_720w.jpg"></p><ol><li>第一次挥手(FIN&#x3D;1,seq&#x3D;u)，客户端发送一个FIN报文，报文中会指定一个序列号。发送完毕后，客户端进入<strong>FIN_WAIT_1状态</strong>。</li><li>第二次挥手(ACK&#x3D;1,ack&#x3D;u+1,seq &#x3D;v)，服务端收到 FIN 报文之后，会发送 ACK 报文，且把客户端的序列号值 + 1 作为 ACK 报文的序列号值，表明已经收到客户端的报文。发送完毕后，服务器端进入<strong>CLOSE_WAIT状态</strong>，客户端接收到这个确认包之后，进入<strong>FIN_WAIT_2状态</strong>。</li><li>第三次挥手(FIN&#x3D;1,ACK1,seq&#x3D;w,ack&#x3D;u+1)，如果服务端也想断开连接了，发送一个FIN 报文，且指定一个序列号。发送完毕后，服务器端进入<strong>LAST_ACK状态</strong>，等待来自客户端的最后一个<strong>ACK</strong>。</li><li>第四次挥手(ACK&#x3D;1,seq&#x3D;u+1,ack&#x3D;w+1)，客户端接收到来自服务器端的关闭请求，发送一个确认包FIN，并进入<strong>TIME_WAIT状态</strong>， 等待某个固定时间<strong>（2MSL）</strong>之后，没有收到服务器端的ACK ，认为服务器端已经正常关闭连接，于是自己也关闭连接，进入<strong>CLOSED状态</strong>。</li><li>服务端接收到这个ACK确认包之后，关闭连接，进入<strong>CLOSED状态</strong>。</li></ol><h4 id="☆TCP-四次挥手过程中，需要等待2MSL-才进入CLOSED关闭状态☆"><a href="#☆TCP-四次挥手过程中，需要等待2MSL-才进入CLOSED关闭状态☆" class="headerlink" title="☆TCP 四次挥手过程中，需要等待2MSL,才进入CLOSED关闭状态☆"></a><strong>☆TCP 四次挥手过程中，需要等待2MSL,才进入CLOSED关闭状态☆</strong></h4><p><strong>询问频率特别高</strong></p><p><img src="https://pic4.zhimg.com/80/v2-23c7f55ac62cf64274ffbe8018dddb9f_720w.jpg"></p><p>2MSL， 即两个最大段生命周期。假设 <strong>主动发起挥手的是客户端</strong> ，那么需要2MSL的原因是：</p><ul><li><strong>1.为了保证客户端发送的最后一个ACK报文段能够到达服务端。</strong> 这个ACK报文段有可能丢失，因而使处在<strong>LAST-ACK</strong>状态的服务端就收不到对已发送的<strong>FIN + ACK</strong>报文段的确认。服务端会超时重传这个FIN+ACK 报文段，而客户端就能在 2MSL 时间内（ <strong>超时 + 1MSL 传输</strong> ）收到这个重传的 FIN+ACK 报文段。接着客户端重传一次确认，重新启动2MSL计时器。最后，客户端和服务器都正常进入到<strong>CLOSED</strong>状态。</li><li><strong>2. 防止已失效的连接请求报文段出现在本连接中</strong> 。客户端在发送完最后一个ACK报文段后，再经过时间2MSL，就可以使本连接持续的时间内所产生的所有报文段都从网络中消失。这样就可以使下一个连接中不会出现这种旧的连接请求报文段。</li></ul><h4 id="为什么等待的时间是2MSL？"><a href="#为什么等待的时间是2MSL？" class="headerlink" title="为什么等待的时间是2MSL？"></a><strong>为什么等待的时间是2MSL？</strong></h4><p>MSL 是 Maximum Segment Lifetime，报⽂最⼤⽣存时间，它是任何报⽂在⽹络上存在的最⻓时间，超过这个时间报⽂将被丢弃。</p><p>TIME_WAIT 等待 2 倍的 MSL，⽐较合理的解释是：⽹络中可能存在来⾃发送⽅的数据包，当这些发送⽅的数据包被接收⽅处理后⼜会向对⽅发送响应，所以⼀来⼀回需要等待 <strong>2</strong> 倍的时间。</p><h4 id="保活计时器有什么用？"><a href="#保活计时器有什么用？" class="headerlink" title="保活计时器有什么用？"></a><strong>保活计时器有什么用？</strong></h4><p>除时间等待计时器外，TCP 还有一个保活计时器（keepalive timer）。</p><p>设想这样的场景：客户已主动与服务器建立了 TCP 连接。但后来客户端的主机突然发生故障。显然，服务器以后就不能再收到客户端发来的数据。因此，应当有措施使服务器不要再白白等待下去。这就需要使用保活计时器了。</p><p>服务器每收到一次客户端的数据，就重新设置保活计时器，时间的设置通常是两个小时。若两个小时都没有收到客户端的数据，服务端就发送一个探测报文段，以后则每隔 75 秒钟发送一次。若连续发送 10 个探测报文段后仍然无客户端的响应，服务端就认为客户端出了故障，接着就关闭这个连接。</p><h4 id="CLOSE-WAIT-和-TIME-WAIT-的状态和意义？"><a href="#CLOSE-WAIT-和-TIME-WAIT-的状态和意义？" class="headerlink" title="CLOSE-WAIT 和 TIME-WAIT 的状态和意义？"></a><strong>CLOSE-WAIT 和 TIME-WAIT 的状态和意义？</strong></h4><blockquote><p><strong>CLOSE-WAIT状态有什么意义？</strong></p></blockquote><p>服务端收到客户端关闭连接的请求并确认之后，就会进入CLOSE-WAIT状态。此时服务端可能还有一些数据没有传输完成，因此不能立即关闭连接，而CLOSE-WAIT状态就是为了保证服务端在关闭连接之前将待发送的数据处理完。</p><blockquote><p><strong>TIME-WAIT有什么意义？</strong></p></blockquote><p>TIME-WAIT状态发生在第四次挥手，当客户端向服务端发送ACK确认报文后进入TIME-WAIT状态。</p><p>它存在的意义主要是两个：</p><ul><li><p><strong>防⽌旧连接的数据包</strong></p><p>如果客户端收到服务端的FIN报文之后立即关闭连接，但是此时服务端对应的端口并没有关闭，如果客户端在相同端口建立新的连接，可能会导致新连接收到旧连接残留的数据包，导致不可预料的异常发生。</p></li><li><p><strong>保证连接正确关闭</strong></p><p>假设客户端最后一次发送的ACK包在传输的时候丢失了，由于TCP协议的超时重传机制，服务端将重发FIN报文，如果客户端没有维持TIME-WAIT状态而直接关闭的话，当收到服务端重新发送的FIN包时，客户端就会使用RST包来响应服务端，导致服务端以为有错误发生，然而实际关闭连接过程是正常的。</p></li></ul><h4 id="TIME-WAIT-状态过多会导致什么问题？怎么解决？"><a href="#TIME-WAIT-状态过多会导致什么问题？怎么解决？" class="headerlink" title="TIME_WAIT 状态过多会导致什么问题？怎么解决？"></a><strong>TIME_WAIT 状态过多会导致什么问题？怎么解决？</strong></h4><blockquote><p><strong>TIME_WAIT 状态过多会导致什么问题?</strong></p></blockquote><p>如果服务器有处于 TIME-WAIT 状态的 TCP，则说明是由服务器⽅主动发起的断开请求。</p><p>过多的 TIME-WAIT 状态主要的危害有两种：</p><p>第⼀是内存资源占⽤；</p><p>第⼆是对端⼝资源的占⽤，⼀个 TCP 连接⾄少消耗⼀个本地端⼝；</p><h4 id="怎么解决TIME-WAIT-状态过多？"><a href="#怎么解决TIME-WAIT-状态过多？" class="headerlink" title="怎么解决TIME_WAIT 状态过多？"></a><strong>怎么解决TIME_WAIT 状态过多？</strong></h4><ul><li>服务器可以设置SO_REUSEADDR套接字来通知内核，如果端口被占用，但是TCP连接位于TIME_WAIT 状态时可以重用端口。</li><li>还可以使用长连接的方式来减少TCP的连接和断开，在长连接的业务里往往不需要考虑TIME_WAIT状态</li></ul><h4 id="如果服务器出现了大量CLOSE-WAIT状态如何解决"><a href="#如果服务器出现了大量CLOSE-WAIT状态如何解决" class="headerlink" title="如果服务器出现了大量CLOSE_WAIT状态如何解决"></a><strong>如果服务器出现了大量CLOSE_WAIT状态如何解决</strong></h4><ul><li>服务器端收到客户端发送的 <code>FIN</code>后，TCP协议栈就会自动发送ACK，接着进入<strong>CLOSE_WAIT</strong>状态。</li><li>但是如果服务器端不执行socket的close()操作，那么就没法进入LAST_ACK,导致大量连接处于<strong>CLOSE_WAIT</strong>状态</li><li>所以，如果服务器出现了大量<strong>CLOSE_WAIT</strong>状态，一般是程序Bug，或者关闭socket不及时。</li></ul><h3 id="TCP-的粘包和拆包"><a href="#TCP-的粘包和拆包" class="headerlink" title="TCP 的粘包和拆包"></a><strong>TCP 的粘包和拆包</strong></h3><p>TCP是面向流，没有界限的一串数据。TCP底层并不了解上层业务数据的具体含义，它会根据TCP缓冲区的实际情况进行包的划分，所以在业务上认为，一 <strong>个完整的包可能会被TCP拆分成多个包进行发送</strong> ， <strong>也有可能把多个小的包封装成一个大的数据包发送</strong> ，这就是所谓的TCP粘包和拆包问题。</p><p><img src="https://pic3.zhimg.com/80/v2-c9ff4bf21f8f26e940eaa48446328e22_720w.jpg"></p><p><strong>为什么会产生粘包和拆包呢?</strong></p><ul><li>要发送的数据小于TCP发送缓冲区的大小，TCP将多次写入缓冲区的数据一次发送出去，将会发生粘包；</li><li>接收数据端的应用层没有及时读取接收缓冲区中的数据，将发生粘包；</li><li>要发送的数据大于TCP发送缓冲区剩余空间大小，将会发生拆包；</li><li>待发送数据大于MSS（最大报文长度），TCP在传输前将进行拆包。即TCP报文长度-TCP头部长度&gt;MSS。</li></ul><p><strong>解决方案：</strong></p><ul><li>发送端将每个数据包封装为固定长度</li><li>在数据尾部增加特殊字符进行分割</li><li>将数据分为两部分，一部分是头部，一部分是内容体；其中头部结构大小固定，且有一个字段声明内容体的大小。</li></ul><h3 id="TCP-流量控制"><a href="#TCP-流量控制" class="headerlink" title="TCP-流量控制"></a><strong>TCP-流量控制</strong></h3><p>TCP三次握手，发送端和接收端进入到ESTABLISHED状态，它们即可以愉快地传输数据啦。</p><p>但是发送端不能疯狂地向接收端发送数据，因为接收端接收不过来的话，接收方只能把处理不过来的数据存在缓存区里。如果缓存区都满了，发送方还在疯狂发送数据的话，接收方只能把收到的数据包丢掉，这就浪费了网络资源啦。</p><blockquote><p>★ TCP 提供一种机制可以让发送端根据接收端的实际接收能力控制发送的数据量，这就是 <strong>流量控制</strong> 。<br>”</p></blockquote><p>TCP通过滑动窗口来控制流量，我们看下流量控制的<strong>简要流程</strong>吧：</p><p>首先双方三次握手，初始化各自的窗口大小，均为 400 个字节。</p><p><img src="https://pic1.zhimg.com/80/v2-986b62cafdbfbc45aa64cfd9c9917114_720w.jpg"></p><ol><li>假如当前发送方给接收方发送了200个字节，那么，发送方的 <code>SND.NXT</code>会右移200个字节，也就是说当前的可用窗口减少了200 个字节。</li><li>接受方收到后，放到缓冲队列里面，REV.WND &#x3D;400-200&#x3D;200字节，所以win&#x3D;200字节返回给发送方。接收方会在 ACK 的报文首部带上缩小后的滑动窗口200字节</li><li>发送方又发送200字节过来，200字节到达，继续放到缓冲队列。不过这时候，由于大量负载的原因，接受方处理不了这么多字节，只能处理100字节，剩余的100字节继续放到缓冲队列。这时候，REV.WND &#x3D; 400-200-100&#x3D;100字节，即win&#x3D;100返回发送方。</li><li>发送方继续干活，发送100字节过来，这时候，接受窗口win变为0。</li><li>发送方停止发送，开启一个定时任务，每隔一段时间，就去询问接受方，直到win大于0，才继续开始发送。</li></ol><h3 id="TCP-滑动窗口"><a href="#TCP-滑动窗口" class="headerlink" title="TCP-滑动窗口"></a><strong>TCP-滑动窗口</strong></h3><p><strong>思路讲解：</strong> TCP滑动窗口是个高频考点，我们需要知道TCP报文首部有个字段<strong>win</strong>控制窗口大小的，同时也需要掌握，滑动窗口是怎么滑的。</p><p>TCP 发送一个数据，如果需要收到确认应答，才会发送下一个数据。这样的话就会有个缺点：效率会比较低。</p><blockquote><p>★ 这就好像我们面对面在聊天，你说完一句，我应答之后，你才能说下一句。那么，如果我在忙其他事情，没有能够及时回复你呢？你说完一句后，要等到我忙完回复你，你才说下句，这显然不现实，效率太低。<br>”</p></blockquote><p>为了解决这个问题，TCP引入了 <strong>窗口</strong> ，它是操作系统开辟的一个缓存空间。窗口大小值表示无需等待确认应答，而可以继续发送数据的最大值。</p><p>TCP头部有个字段叫win，也即那个 <strong>16位的窗口大小</strong> ，它告诉对方本端的TCP接收缓冲区还能容纳多少字节的数据，这样对方就可以控制发送数据的速度，从而达到<strong>流量控制</strong>的目的。</p><blockquote><p>★ 通俗点讲，就是接受方每次收到数据包，在发送确认报文的时候，同时告诉发送方，自己的缓存区还有多少空余空间，缓冲区的空余空间，我们就称之为接受窗口大小。这就是win。<br>”</p></blockquote><p>TCP 滑动窗口分为两种: 发送窗口和接收窗口。<strong>发送端的滑动窗口</strong>包含四大部分，如下：</p><ul><li>已发送且已收到ACK确认</li><li>已发送但未收到ACK确认</li><li>未发送但可以发送</li><li>未发送也不可以发送</li></ul><p><img src="https://pic1.zhimg.com/80/v2-ad570770e061565c3a39fbc999ce9a28_720w.jpg"></p><ul><li>虚线矩形框，就是发送窗口。</li><li>SND.WND: 表示发送窗口的大小,上图虚线框的格子数是14个，即发送窗口大小是14。</li><li>SND.NXT：下一个发送的位置，它指向未发送但可以发送的第一个字节的序列号。</li><li>SND.UNA: 一个绝对指针，它指向的是已发送但未确认的第一个字节的序列号。</li></ul><p>接收方的滑动窗口包含三大部分，如下：</p><ul><li>已成功接收并确认</li><li>未收到数据但可以接收</li><li>未收到数据并不可以接收的数据</li></ul><p><img src="https://pic3.zhimg.com/80/v2-288d6df65cdfa7c3a3350d2ac0f0397a_720w.jpg"></p><ul><li>虚线矩形框，就是接收窗口。</li><li>REV.WND: 表示接收窗口的大小,上图虚线框的格子就是9个。</li><li>REV.NXT:下一个接收的位置，它指向未收到但可以接收的第一个字节的序列号。</li></ul><h3 id="TCP-拥塞控制"><a href="#TCP-拥塞控制" class="headerlink" title="TCP-拥塞控制"></a><strong>TCP-拥塞控制</strong></h3><p><strong>思路讲解：</strong> 高频考点，需要掌握跟<strong>流量控制</strong>的区别。</p><p>拥塞控制：<strong>作用于网络，防止过多的数据包注入到网络中，避免出现网络负载过大的情况。</strong></p><p><strong>主要目标：最大化利用网络上瓶颈链路的带宽。</strong></p><p>跟<strong>流量控制</strong>的区别？</p><ul><li>流量控制：作用于接收者，根据 <strong>接收端的实际接收能力控制发送速度</strong> ，防止分组丢失的。</li></ul><p>可以把网络链路比喻成一根水管，如果想最大化利用网络来传输数据，那就是尽快让水管达到最佳充满状态。</p><p><img src="https://pic1.zhimg.com/80/v2-aee11f05c2522dfe1a93e2cb5266c2fc_720w.jpg"></p><p>发送方维护一个<strong>拥塞窗口cwnd（congestion window）</strong> 的变量，用来估算在一段时间内这条链路可以承载和运输的数据量。它大小代表着网络的拥塞程度，并且是动态变化的，但是为了达到最大的传输效率，我们该如何知道这条水管的运送效率是多少呢？</p><p>一个比较简单的方法就是不断增加传输的水量，直到水管快要爆裂为止（对应到网络上就是发生丢包），用 TCP的描述就是：</p><blockquote><p>★ 只要网络中没有出现拥塞，拥塞窗口的值就可以再增大一些，以便把更多的数据包发送出去，但只要网络出现拥塞，拥塞窗口的值就应该减小一些，以减少注入到网络中的数据包数。</p></blockquote><p>实际上，拥塞控制主要有这几种常用算法</p><ul><li>慢启动</li><li>拥塞避免</li><li>拥塞发生</li><li>快速恢复</li></ul><p><img src="/image/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/1656859043870.png" alt="1656859043870"></p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">慢启动</button></li><li class="tab"><button type="button" data-href="#super-2">拥塞避免</button></li><li class="tab"><button type="button" data-href="#super-3">拥塞发生</button></li><li class="tab"><button type="button" data-href="#super-4">快速恢复</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>慢启动算法：TCP建立连接完成后，先探测网络的拥塞程度。由小到大逐渐增加拥塞窗口的大小，如果没有出现丢包， <strong>每收到一个ACK，就将拥塞窗口cwnd大小+1（单位是MSS）</strong>。<strong>每轮次</strong>发送窗口增加一倍，呈指数增长，这个过程就是在不断试探网络的拥塞程度，超出阈值则会导致网络拥塞；如果出现丢包，拥塞窗口就减半，进入拥塞避免阶段。</p><ul><li>TCP连接完成，初始化cwnd &#x3D; 1，表明可以传一个MSS单位大小的数据。</li><li>每当收到一个ACK，cwnd+1;</li><li>每当过了一个RTT，cwnd就增加一倍; 呈指数让升</li></ul><p><img src="https://pic3.zhimg.com/80/v2-afa39dc300d2dc1fe03f2e76356c3a12_720w.jpg"></p><p>为了防止cwnd增长过大引起网络拥塞，还需设置一个 <strong>慢启动阀值ssthresh</strong> （slow start threshold）状态变量。当 <code>cwnd</code>到达该阀值后，就好像水管被关小了水龙头一样，减少拥塞状态。即当<strong>cwnd &gt;ssthresh</strong>时，进入了<strong>拥塞避免</strong>算法。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p>慢启动阀值ssthresh是65535字节，<code>cwnd</code>到达<strong>慢启动阀值</strong>后，指数增长转变为线性增长，避免过快导致网络拥塞问题：</p><ul><li>每收到一个ACK时，cwnd &#x3D; cwnd + 1&#x2F;cwnd</li><li>当每过一个RTT时，cwnd &#x3D; cwnd + 1</li></ul><p><img src="https://pic3.zhimg.com/80/v2-3cbed3f4792b23f7441ae352134097c6_720w.jpg"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>当网络拥塞发生<strong>丢包</strong>时，会有两种情况：</p><ul><li>RTO超时重传</li><li>快速重传</li></ul><p>如果是发生了 <strong>RTO超时重传</strong> ，就会使用拥塞发生算法</p><ul><li>慢启动阀值sshthresh &#x3D; cwnd &#x2F;2</li><li>cwnd 重置为 1</li><li>进入新的慢启动过程</li></ul><p><img src="https://pic3.zhimg.com/80/v2-d6f0ae834507afe19de4f5e630340fb2_720w.jpg"></p><p>这真的是 <strong>辛辛苦苦几十年，一朝回到解放前</strong> 。其实还有更好的处理方式，就是 <strong>快速重传</strong> 。发送方收到3个连续重复的ACK时，就会快速地重传，不必等待<strong>RTO超时</strong>再重传。</p><p><img src="https://pic2.zhimg.com/80/v2-01eff11b4555af8a412d4403a39e98a5_720w.jpg"></p><p>慢启动阀值ssthresh 和 cwnd 变化如下：</p><ul><li>拥塞窗口大小 cwnd &#x3D; cwnd&#x2F;2</li><li>慢启动阀值 ssthresh &#x3D; cwnd</li><li>进入快速恢复算法</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><p>快速重传和快速恢复算法一般同时使用。快速恢复算法认为，还有3个重复ACK收到，说明网络也没那么糟糕，所以没有必要像RTO超时那么强烈。</p><p>正如前面所说，进入快速恢复之前，cwnd 和 sshthresh已被更新：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- cwnd = cwnd /2</span><br><span class="line">- sshthresh = cwnd</span><br></pre></td></tr></table></figure><p>然后，真正的快速算法如下：</p><ul><li>cwnd &#x3D; sshthresh + 3</li><li>重传重复的那几个ACK（即丢失的那几个数据包）</li><li>如果再收到重复的 ACK，那么 cwnd &#x3D; cwnd +1</li><li>如果收到新数据的 ACK 后, cwnd &#x3D; sshthresh。因为收到新数据的 ACK，表明恢复过程已经结束，可以再次进入了拥塞避免的算法了。</li></ul><p><img src="https://pic2.zhimg.com/80/v2-0c268ce0c2fb44d4992357df85bb9c19_720w.jpg"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="TCP-如何确保可靠性"><a href="#TCP-如何确保可靠性" class="headerlink" title="TCP 如何确保可靠性"></a><strong>TCP 如何确保可靠性</strong></h3><p>TCP是可靠的连接，依靠以下几点：连接和断开的可靠性（三次握手，四次挥手）、有状态（哪些数据发送了，哪些没发）、可控制（超时重传、流量控制、拥塞控制等）</p><ul><li>首先，TCP的连接是基于 <strong>三次握手</strong> ，而断开则是基于 <strong>四次挥手</strong> 。确保连接和断开的可靠性。</li><li>其次，TCP的可靠性，还体现在 <strong>有状态</strong> ;TCP会记录哪些数据发送了，哪些数据被接收了，哪些没有被接受，并且保证数据包按序到达，保证数据传输不出差错。</li><li>再次，TCP的可靠性，还体现在 <strong>可控制</strong> 。它有数据包校验、ACK应答、 超时重传(发送方) 、失序数据重传（接收方）、丢弃重复数据、流量控制（滑动窗口）和拥塞控制等机制。<ul><li><strong>数据包校验</strong>：目的是检测数据在传输过程中的任何变化，若校验出包有错，则丢弃报文段并且不给出响应，这时 TCP 发送数据端超时后会重发数据；</li><li><strong>ACK应答</strong>：当 TCP 收到发自 TCP 连接另一端的数据，它将发送一个确认。这个确认不是立即发送，通常将推迟几分之一秒；</li><li>**超时重发(发送方)**：当 TCP 发出一个段后，它启动一个定时器，等待目的端确认收到这个报文段。如果不能及时收到一个确认，将重发这个报文段；</li><li>**失序数据重传(接收方)**：既然 TCP 报文段作为 IP 数据报来传输，而 IP 数据报的到达可能会失序，因此 TCP 报文段的到达也可能会失序。TCP 将对失序数据进行重新排序，然后才交给应用层；</li><li><strong>丢弃重复数据</strong>：对于重复数据，能够丢弃重复数据</li><li>**流量控制(滑动窗口)**：TCP 连接的每一方都有固定大小的缓冲空间。TCP 的接收端只允许另一端发送接收端缓冲区所能接纳的数据，这可以防止较快主机致使较慢主机的缓冲区溢出，这就是流量控制。TCP 使用的流量控制协议是可变大小的滑动窗口协议。</li></ul></li></ul><h3 id="TCP-报文首部含有的字段及其作用"><a href="#TCP-报文首部含有的字段及其作用" class="headerlink" title="TCP 报文首部含有的字段及其作用"></a><strong>TCP 报文首部含有的字段及其作用</strong></h3><p><img src="https://pic2.zhimg.com/80/v2-af1c05a8bbf5beaef1cf0d7fa1b0bd41_720w.jpg"></p><ul><li><strong>16位端口号</strong> ：源端口号，主机该报文段是来自哪里；目标端口号，要传给哪个上层协议或应用程序</li><li><strong>32位序号</strong> ：一次TCP通信（从TCP连接建立到断开）过程中某一个传输方向上的字节流的每个字节的编号。</li><li><strong>32位确认号</strong> ：用作对另一方发送的tcp报文段的响应。其值是收到的TCP报文段的序号值加1。</li><li><strong>4位头部长度</strong> ：表示tcp头部有多少个32bit字（4字节）。因为4位最大能标识15，所以TCP头部最长是60字节。</li><li><strong>6位标志位</strong> ：URG(紧急指针是否有效)，ACk（表示确认号是否有效），PSH（缓冲区尚未填满），RST（表示要求对方重新建立连接），SYN（建立连接消息标志接），FIN（表示告知对方本端要关闭连接了）</li><li><strong>16位窗口大小</strong> ：是TCP流量控制的一个手段。这里说的窗口，指的是接收通告窗口。它告诉对方本端的TCP接收缓冲区还能容纳多少字节的数据，这样对方就可以控制发送数据的速度。</li><li><strong>16位校验和</strong> ：由发送端填充，接收端对TCP报文段执行CRC算法以检验TCP报文段在传输过程中是否损坏。注意，这个校验不仅包括TCP头部，也包括数据部分。这也是TCP可靠传输的一个重要保障。</li><li><strong>16位紧急指针</strong> ：一个正的偏移量。它和序号字段的值相加表示最后一个紧急数据的下一字节的序号。因此，确切地说，这个字段是紧急指针相对当前序号的偏移，不妨称之为紧急偏移。TCP的紧急指针是发送端向接收端发送紧急数据的方法。</li></ul><h3 id="TCP-重传机制"><a href="#TCP-重传机制" class="headerlink" title="TCP-重传机制"></a><strong>TCP-重传机制</strong></h3><p><strong>思路讲解：</strong> TCP的重传机制，也是道非常高频的面试题。包括 <strong>超时重传、快速重传、带选择确认的重传（SACK）、重复SACK四种</strong> 。</p><div class="tabs" id="super"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#super-1">超时重传</button></li><li class="tab"><button type="button" data-href="#super-2">快速重传</button></li><li class="tab"><button type="button" data-href="#super-3">带选择确认的重传（SACK）</button></li><li class="tab"><button type="button" data-href="#super-4">重复SACK（D-SACK）</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="super-1"><p>超时重传：TCP协议保证数据可靠性的另一个重要机制，其原理是在发送某一个数据以后就开启一个计时器，在一定时间内如果没有得到发送的数据报的ACK报文，那么就重新发送数据，直到发送成功为止。</p><p>这个一定时间内，一般是多少比较合理呢？来看下什么叫 <strong>RTT（Round-Trip Time，往返时间）</strong> 。</p><p><img src="https://pic1.zhimg.com/80/v2-33ed03c0b232a6b40750a05e72395834_720w.jpg"></p><p>RTT就是数据完全发送完，到收到确认信号的时间，即数据包的一次往返时间。超时重传时间，就是RTO（Retransmission Timeout)。</p><p>那么，<strong>RTO到底设置多大呢？</strong></p><ul><li>如果RTO设置很大，等了很久都没重发，这样肯定就不行。</li><li>如果RTO设置很小，那很可能数据都没有丢失，就开始重发了，这会导致网络阻塞，从而恶性循环，导致更多的超时出现。</li></ul><p>一般来说，RTO略微大于RTT，效果是最佳的。其实，RTO有个标准方法的计算公式，也叫 <strong>Jacobson &#x2F; Karels 算法</strong> 。一起来看下吧：</p><p><strong>1. 首先计算SRTT（即计算平滑的RTT）</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SRTT = (1 - α) * SRTT + α * RTT  //求 SRTT 的加权平均</span><br></pre></td></tr></table></figure><p><strong>2. 其次，计算RTTVAR (round-trip time variation)</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RTTVAR = (1 - β) * RTTVAR + β * (|RTT - SRTT|) //计算 SRTT 与真实值的差距</span><br></pre></td></tr></table></figure><p><strong>3. 最后，得出最终的RTO</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RTO = µ * SRTT + ∂ * RTTVAR  =  SRTT + 4·RTTVAR  </span><br></pre></td></tr></table></figure><p>一般情况，α、β等的参数取值如下：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">α = 0.125，β = 0.25， μ = 1，∂ = 4</span><br></pre></td></tr></table></figure><p>别问这些参数是怎么来的，它们是大量实践，调出的最优参数。</p><p>超时重传不是十分完美的重传方案，它有这些缺点：</p><blockquote><p>★</p></blockquote><ul><li>当一个报文丢失时，会等待一定的超时周期，才重传分组，增加了端到端的时延。</li><li>当一个报文丢失时，在其等待超时的过程中，可能会出现这种情况：其后的报文段已经被接收端接收但却迟迟得不到确认，发送端会认为也丢失了，从而引起不必要的重传，既浪费资源也浪费时间。</li></ul><p>并且，对于TCP，如果发生一次超时重传，时间间隔下次就会加倍。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-2"><p><strong>快速重传</strong>：可解决超时重发的时间等待问题。它不以时间驱动，而是以数据驱动。它是基于接收端的反馈信息来引发重传的。快速重传流程如下：</p><p><img src="https://pic3.zhimg.com/80/v2-f24801fb963518c9ca1eec2b421a305e_720w.jpg"></p><p>发送方发送了 1，2，3，4，5,6份数据:</p><ul><li>第一份 Seq&#x3D;1 先送到了，于是就 Ack回2；</li><li>第二份 Seq&#x3D;2 也送到了，于是ACK回3；</li><li>第三份 Seq&#x3D;3 由于网络等某些原因，没送到；</li><li>第四份 Seq&#x3D;4 送到了，但是由于Seq&#x3D;3没收到。因此ACK还是回3；</li><li>后面的 Seq&#x3D;5,6的也送到了，ACK还是回复3，因为Seq&#x3D;3没有收到。</li><li>发送方连着收到三个重复冗余ACK&#x3D;3的确认（其实是4个哈，但是因为前面的一个是正常的ACK，后面三个才是重复冗余的），于是知道哪个报文段在传输过程中丢失了；发送方在定时器过期之前，重传该报文段。</li><li>最后，接收方收到了 Seq&#x3D;3，此时因为 Seq&#x3D;4，5，6都收到了，于是它回ACK&#x3D;7。</li></ul><p>但是呢，<strong>快速重传</strong>也可能有问题：ACK只向告知发送方，最大的有序报文段。到底是哪个报文丢失了呢？ <strong>并不确定</strong> ！那到底该重传多少个包呢？</p><blockquote><p>★ 是重传 Seq&#x3D;3 ？还是重传 Seq&#x3D;3、Seq&#x3D;4、Seq&#x3D;5、Seq&#x3D;6 呢？因为发送端并不清楚这三个连续的 ACK&#x3D;3 是谁传回来的。</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-3"><p>为了解决：<strong>应该重传多少个包</strong>的问题? TCP提供了 <strong>带选择确认的重传</strong> （即SACK，Selective Acknowledgment）</p><blockquote><p>★ <strong>SACK机制</strong>就是，在快速重传的基础上，接收方返回最近收到报文段的序列号范围，这样发送方就知道接收方哪些数据包是没收到的。这样就很清楚应该重传哪些数据包啦。</p></blockquote><p><img src="https://pic4.zhimg.com/80/v2-9ceac05b4042f2b55deee28981ed803b_720w.jpg"></p><p>如上图中，发送方收到了三次同样的ACK&#x3D;30的确认报文，于是就会触发快速重发机制，通过SACK信息发现只有 <code>30~39</code>这段数据丢失，于是重发时，就只选择了这个 <code>30~39</code>的TCP报文段进行重发。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="super-4"><blockquote><p>★ D-SACK，英文是Duplicate SACK，是在SACK的基础上做了一些扩展，主要用来告诉发送方，有哪些数据包，自己重复接受了。DSACK的目的是帮助发送方判断，是否发生了包失序、ACK丢失、包重复或伪重传。让TCP可以更好的做网络流控。来看个图吧：</p></blockquote><p><img src="https://pic3.zhimg.com/80/v2-4f3d6756eaac5ab2be8a08ea1ccc7416_720w.jpg"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
      
      <categories>
          
          <category> 计算机基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 计算机网络 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gulp</title>
      <link href="/posts/4cc2ef8a/"/>
      <url>/posts/4cc2ef8a/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="gulp"><a href="#gulp" class="headerlink" title="gulp"></a>gulp</h3><h4 id="使用流程"><a href="#使用流程" class="headerlink" title="使用流程"></a>使用流程</h4><ol><li>通过gulp.task注册任务</li><li>通过gulp.src方法获取到想要处理的文件流</li><li>然后把文件流通过pipe方法导入到gulp插件中</li><li>最后把经过插件处理后的流再通过pipe方法导入到gulp.dest中</li><li>gulp.dest方法则把流中的内容写入到文件中</li></ol><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">gulp<span class="selector-class">.tast</span>(<span class="string">&#x27;scss&#x27;</span>, () =&gt; &#123;</span><br><span class="line">    return gulp<span class="selector-class">.src</span>(<span class="string">&#x27;app/sass/!*.sass&#x27;</span>)</span><br><span class="line">        <span class="selector-class">.pipe</span>(<span class="built_in">sass</span>())</span><br><span class="line">        <span class="selector-class">.pipe</span>(<span class="built_in">gulp</span>(<span class="string">&#x27;dist/css&#x27;</span>))</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="核心api"><a href="#核心api" class="headerlink" title="核心api"></a>核心api</h3><table><thead><tr><th>api</th><th>描述</th></tr></thead><tbody><tr><td>task</td><td>创建一个任务</td></tr><tr><td>series</td><td>顺序执行多个任务</td></tr><tr><td>prallel</td><td>并行执行多个任务</td></tr><tr><td>src</td><td>读取数据资源转换成stream</td></tr><tr><td>pipe</td><td>管道-可以在中间对数据进行处理</td></tr><tr><td>dest</td><td>输出数据到目标路径</td></tr><tr><td>on</td><td>事件监听</td></tr><tr><td>watch</td><td>数据源监听</td></tr></tbody></table><p><strong>注册任务</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gulp.<span class="title function_">task</span>(name[,deps],fn)</span><br></pre></td></tr></table></figure><p>参数：<br>name是任务名称，执行任务时，使用这个名称<br>deps 是当前定义的任务需要依赖的其他任务，为一个数组。当前定义的任务会在所有依赖的任务执行完毕后才开始执行。<br>如果没有依赖，则可省略这个参数<br>fn是一个回掉函数，代表这个任务要做的事情</p><p><strong>读取文件</strong><br>将本地文件读取到gulp内存中</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gulp.<span class="title function_">src</span>(globs[, options])</span><br></pre></td></tr></table></figure><p>参数：<br>globs是读取目标源文件的路径<br>opttions是一个可配置对象 通常不需要用到</p><p><strong>输出到文件</strong><br>将内存中数据输出到本地文件中</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gulp.<span class="title function_">dest</span>(path[,options])</span><br></pre></td></tr></table></figure><p>参数：<br>path是将数据输出目标文件路径<br>opttions是一个可配置对象 通常不需要用到</p><p><strong>监视文件变化</strong><br>用来监视某个或某些文件发生变化，可以在变化的时候，执行一个回掉函数，利用它来执行相应的任务</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gulp.<span class="title function_">watch</span>(globs[,opts]),tasks);</span><br></pre></td></tr></table></figure><p>globs是要监视的文件匹配模式 ，规则和用法与gulp.src方法中的glob相同 opts是一个可配置对象 通常不需要用到 tasks是文件变化后要执行的任务，为一个数组</p><h2 id="gulp插件"><a href="#gulp插件" class="headerlink" title="gulp插件"></a>gulp插件</h2><p>我们要处理文件的合并、压缩等操作，接口中没有提供，都放在了插件中。</p><h3 id="1-4-1插件下载："><a href="#1-4-1插件下载：" class="headerlink" title="1.4.1插件下载："></a>1.4.1插件下载：</h3><blockquote><p>npm install 插件名 –save-dev</p></blockquote><p>gulp-concat : 合并文件(js&#x2F;css)</p><p>gulp-uglify : 压缩js文件</p><p>gulp-rename : 文件重命名</p><p>gulp-less : 编译less</p><p>gulp-sass：编译sass</p><p>gulp-clean-css : 压缩css文件</p><p>gulp-livereload : 实时自动编译刷新</p><p>gulp-htmlmin：压缩html文件</p><p>gulp-connect：热加载，配置一个服务器</p><p>gulp-load-plugins：打包插件（里面包含了其他所有插件）</p><h3 id="1-4-2使用插件："><a href="#1-4-2使用插件：" class="headerlink" title="1.4.2使用插件："></a>1.4.2使用插件：</h3><p>通过 npm install 插件名 –save-dev 安装插件到当前的项目<br>可以在gulpfile.js顶部通过require引入此插件<br>也可以在创建任务的时候使用 gulp-load-plugins插件 这个插件会自动帮你加载package.json文件里的gulp插件，不需要每个依次引入<br>在gulpfile.js声明</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> gulp = <span class="built_in">require</span>(<span class="string">&quot;gulp&quot;</span>); <span class="comment">//引入gulp模块</span></span><br><span class="line"><span class="keyword">const</span> $ = <span class="built_in">require</span>(<span class="string">&quot;gulp-load-plugins&quot;</span>)(); <span class="comment">//引入gulp-load-plugins</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p>在使用过中，不需要使用require依次引入每一个插件，直接使用$.插件名称()的效果与require效果一致</p><p><strong>合并文件：</strong> gulp-concat</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;concat-js&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.<span class="title function_">src</span>(<span class="string">&#x27;app/!*.js&#x27;</span>) <span class="comment">//合并的文件</span></span><br><span class="line">         .<span class="title function_">pipe</span>(<span class="title function_">concat</span>(<span class="string">&#x27;all.js&#x27;</span>)) <span class="comment">//执行合并</span></span><br><span class="line">         .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&#x27;dist/js&#x27;</span>)) <span class="comment">//输出文件</span></span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p><strong>编译Sass：</strong> gulp-sass</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;sass-css&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">   <span class="keyword">return</span> gulp.<span class="title function_">src</span>(<span class="string">&#x27;app/sass/!*.sass&#x27;</span>) <span class="comment">//编译的文件</span></span><br><span class="line">        .<span class="title function_">pipe</span>(<span class="title function_">sass</span>()) <span class="comment">//执行编译</span></span><br><span class="line">        .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&#x27;dist/css&#x27;</span>)) <span class="comment">//输出文件</span></span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p><strong>编译less：</strong> gulp-less</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;less-css&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">   <span class="keyword">return</span> gulp.<span class="title function_">src</span>(<span class="string">&#x27;app/less/!*.less&#x27;</span>) <span class="comment">//编译的文件</span></span><br><span class="line">        .<span class="title function_">pipe</span>(<span class="title function_">less</span>()) <span class="comment">//执行编译</span></span><br><span class="line">        .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&#x27;dist/css&#x27;</span>); <span class="comment">//输出文件</span></span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p><strong>自动前缀：</strong> gulp-autoprefixer</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;autoprefixer&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">   <span class="keyword">return</span> gulp.<span class="title function_">src</span>(<span class="string">&#x27;app/css/*.css&#x27;</span>) <span class="comment">//编译的文件</span></span><br><span class="line">        .<span class="title function_">pipe</span>(<span class="title function_">autoprefixer</span>()) <span class="comment">//执行编译</span></span><br><span class="line">        .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&#x27;dist/css&#x27;</span>); <span class="comment">//输出文件</span></span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p><strong>压缩图片：</strong> gulp-imagemin</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;imagemin&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">   <span class="keyword">return</span> gulp.<span class="title function_">src</span>(<span class="string">&#x27;app/images/*.&#123;jpg,png,JPG,PNG&#125;&#x27;</span>) <span class="comment">//优化的图片</span></span><br><span class="line">        .<span class="title function_">pipe</span>(<span class="title function_">imagemin</span>()) <span class="comment">//执行优化</span></span><br><span class="line">        .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&#x27;dist/images&#x27;</span>)) <span class="comment">//输出</span></span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p><strong>压缩html文件：</strong> gulp-minify-html</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;min-html&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">   <span class="keyword">return</span> gulp.<span class="title function_">src</span>(<span class="string">&#x27;app/html/*.html&#x27;</span>) <span class="comment">//压缩的文件</span></span><br><span class="line">        .<span class="title function_">pipe</span>(<span class="title function_">minifyHtml</span>()) <span class="comment">//执行压缩</span></span><br><span class="line">        .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&#x27;dist/html&#x27;</span>)) <span class="comment">//输出文件</span></span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p><strong>压缩css文件：</strong> gulp-minify-css</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;min-css&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">   <span class="keyword">return</span> gulp.<span class="title function_">src</span>(<span class="string">&#x27;app/css/*.css&#x27;</span>) <span class="comment">//压缩的文件</span></span><br><span class="line">        .<span class="title function_">pipe</span>(<span class="title function_">minifyCss</span>()) <span class="comment">//执行压缩</span></span><br><span class="line">        .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&#x27;dist/css&#x27;</span>)) <span class="comment">//输出文件</span></span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p><strong>压缩js文件：</strong> gulp-uglify</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;min-js&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">   <span class="keyword">return</span> gulp.<span class="title function_">src</span>(<span class="string">&#x27;app/js/*.js&#x27;</span>) <span class="comment">//压缩的文件</span></span><br><span class="line">        .<span class="title function_">pipe</span>(<span class="title function_">uglify</span>()) <span class="comment">//执行压缩</span></span><br><span class="line">        .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&#x27;dist/js&#x27;</span>)) <span class="comment">//输出文件</span></span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p><strong>重命名js文件：</strong> gulp-rename</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;rename-js&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">   <span class="keyword">return</span> gulp.<span class="title function_">src</span>(<span class="string">&#x27;app/js/*.js&#x27;</span>) <span class="comment">//重命名的文件</span></span><br><span class="line">        .<span class="title function_">pipe</span>(<span class="title function_">rename</span>(<span class="string">&#x27;app.min.js&#x27;</span>)) <span class="comment">//执行重命名及重命名名字</span></span><br><span class="line">        .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&#x27;dist/js&#x27;</span>)) <span class="comment">//输出文件</span></span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p><strong>es6转es5：</strong>  <a href="https://link.juejin.cn/?target=mailto:gulp-babel@7.0.1" title="mailto:gulp-babel@7.0.1">gulp-babel@7.0.1</a> babel-core babel-preset-es2015</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//导入的时候只要导入一个即可：</span></span><br><span class="line"><span class="keyword">const</span> babel = <span class="built_in">require</span>(<span class="string">&#x27;gulp-babel&#x27;</span>)</span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;babel-js&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.<span class="title function_">src</span>(<span class="string">&#x27;./src/js/**&#x27;</span>) <span class="comment">//转码的文件</span></span><br><span class="line">     .<span class="title function_">pipe</span>(<span class="title function_">babel</span>(&#123;<span class="attr">presets</span>:[<span class="string">&#x27;es2015&#x27;</span>]<span class="comment">// 设置转码规则</span></span><br><span class="line">     .<span class="title function_">pipe</span>(<span class="title function_">uglify</span>()) <span class="comment">//执行转码</span></span><br><span class="line">     .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&#x27;./dist/js&#x27;</span>)) <span class="comment">//输出文件</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p><strong>创建本地服务器：</strong> gulp-connect</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;server&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> connect.<span class="title function_">server</span>(&#123;</span><br><span class="line">        <span class="attr">root</span>:<span class="string">&#x27;dist&#x27;</span>, <span class="comment">//服务器的根目录</span></span><br><span class="line">        <span class="attr">port</span>:<span class="number">8080</span>,  <span class="comment">//服务器的地址，没有此配置项默认也是 8080</span></span><br><span class="line">        <span class="attr">livereload</span>:<span class="literal">true</span> <span class="comment">//启用实时刷新的功能</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p><strong>实时预览：</strong> gulp-connect</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;reload&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.<span class="title function_">src</span>(<span class="string">&#x27;app/index.html&#x27;</span>) <span class="comment">//指定源文件</span></span><br><span class="line">        .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&#x27;dist&#x27;</span>)) <span class="comment">//拷贝到dist目录</span></span><br><span class="line">        .<span class="title function_">pipe</span>(connect.<span class="title function_">reload</span>()) <span class="comment">//通知浏览器重启</span></span><br><span class="line">&#125;);</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p><strong>代码检查：</strong> gulp-jshint</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;jslint&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.<span class="title function_">src</span>(<span class="string">&#x27;app/!*.js&#x27;</span>) <span class="comment">//检查的文件</span></span><br><span class="line">        .<span class="title function_">pipe</span>(<span class="title function_">jshint</span>()) <span class="comment">//执行代码检查</span></span><br><span class="line">        .<span class="title function_">pipe</span>(jshint.<span class="title function_">reporter</span>()) <span class="comment">// 输出检查结果</span></span><br><span class="line">&#125;);</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p><strong>清除目标文件夹：</strong>  gulp-clean</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;clean&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.<span class="title function_">src</span>(<span class="string">&#x27;./dist&#x27;</span>)  <span class="comment">//清除的文件夹</span></span><br><span class="line">               .<span class="title function_">pipe</span>(<span class="title function_">clean</span>()) <span class="comment">//执行清除</span></span><br><span class="line">&#125;);</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><h3 id="1-4-3使用gulp-watch-监听文件变化，自动执行任务"><a href="#1-4-3使用gulp-watch-监听文件变化，自动执行任务" class="headerlink" title="1.4.3使用gulp.watch()监听文件变化，自动执行任务"></a>1.4.3使用gulp.watch()监听文件变化，自动执行任务</h3><p>创建auto任务</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">gulp.<span class="title function_">task</span>( <span class="string">&#x27;auto&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">  gulp.<span class="title function_">watch</span>( <span class="string">&#x27;app/!*.js&#x27;</span>, [<span class="string">&#x27;concat-js&#x27;</span>] );</span><br><span class="line">  gulp.<span class="title function_">watch</span>( <span class="string">&#x27;app/sass/!*.sass&#x27;</span>, [<span class="string">&#x27;sass-css&#x27;</span>] );</span><br><span class="line">  gulp.<span class="title function_">watch</span>( <span class="string">&#x27;app/less/!*.less&#x27;</span>, [<span class="string">&#x27;less-css&#x27;</span>] );</span><br><span class="line">  gulp.<span class="title function_">watch</span>( <span class="string">&#x27;app/css/*.css&#x27;</span>, [<span class="string">&#x27;autoprefixer&#x27;</span>] );</span><br><span class="line">  gulp.<span class="title function_">watch</span>(<span class="string">&#x27;app/images/*.&#123;jpg,png,JPG,PNG&#125;&#x27;</span>, [<span class="string">&#x27;imagemin&#x27;</span>] );</span><br><span class="line">  gulp.<span class="title function_">watch</span>( <span class="string">&#x27;app/html/*.html&#x27;</span>, [<span class="string">&#x27;min-html&#x27;</span>] );</span><br><span class="line">  gulp.<span class="title function_">watch</span>( <span class="string">&#x27;app/css/*.css&#x27;</span>, [<span class="string">&#x27;min-css&#x27;</span>] );</span><br><span class="line">  gulp.<span class="title function_">watch</span>( <span class="string">&#x27;app/js/*.js&#x27;</span>, [<span class="string">&#x27;min-js&#x27;</span>] );</span><br><span class="line">  gulp.<span class="title function_">watch</span>( <span class="string">&#x27;./src/js/**&#x27;</span>, [<span class="string">&#x27;babel-js&#x27;</span>] );</span><br><span class="line">  gulp.<span class="title function_">watch</span>( <span class="string">&#x27;app/index.html&#x27;</span>, [<span class="string">&#x27;reload&#x27;</span>] );</span><br><span class="line">  gulp.<span class="title function_">watch</span>( <span class="string">&#x27;app/!*.js&#x27;</span>, [<span class="string">&#x27;jslint&#x27;</span>] );</span><br><span class="line">&#125; );</span><br><span class="line">gulp.<span class="title function_">task</span>( <span class="string">&#x27;default&#x27;</span>, [<span class="string">&#x27;auto&#x27;</span>] ); <span class="comment">//设置auto为默认任务</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><p>命令行执行 gulp</p><h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><p>本文就用一个实际的例子把这几个api全部串联起来，我将实现一个这样的功能：</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/786f73278dc64027960cc68438fcaf06~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp" alt="流程管理"></p><h4 id="全局安装gulp"><a href="#全局安装gulp" class="headerlink" title="全局安装gulp"></a>全局安装gulp</h4><p>首先确保你已经正确安装了nodejs环境，然后以全局方式安装gulp环境</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install gulp -g</span><br></pre></td></tr></table></figure><p>然后切换到你的项目文件夹中，为项目单独安装gulp开发依赖</p><blockquote><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install gulp --<span class="built_in">save</span>-<span class="built_in">dev</span></span><br></pre></td></tr></table></figure></blockquote><h4 id="项目根目录新建gulpfile-js文件"><a href="#项目根目录新建gulpfile-js文件" class="headerlink" title="项目根目录新建gulpfile.js文件"></a>项目根目录新建gulpfile.js文件</h4><h5 id="文件头引入模块"><a href="#文件头引入模块" class="headerlink" title="文件头引入模块"></a>文件头引入模块</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// gulpfile.js</span></span><br><span class="line"><span class="keyword">const</span> gulp = <span class="built_in">require</span>(<span class="string">&quot;gulp&quot;</span>);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 合并文件插件</span></span><br><span class="line"><span class="comment"> * gulp的插件很多，有4000多个，足够满足大家日常的各种需求，而且插件写起来也超级简单</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> concat = <span class="built_in">require</span>(<span class="string">&quot;gulp-concat&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> through2 = <span class="built_in">require</span>(<span class="string">&quot;through2&quot;</span>);</span><br></pre></td></tr></table></figure><h5 id="创建合并文件任务"><a href="#创建合并文件任务" class="headerlink" title="创建合并文件任务"></a>创建合并文件任务</h5><p>新建合并任务，读取 <code>20201108</code>目录下所有 <code>txt</code>文件，合并为 <code>20201108.txt</code>文件并存储在 <code>demo</code>文件夹下</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// task 为创建gulp子任务</span></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;concat&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.<span class="title function_">src</span>(<span class="string">&#x27;./20201108/*.txt&#x27;</span>) <span class="comment">// src: 读取文件转化为可读流，参数可以是文件通配符匹配</span></span><br><span class="line">.<span class="title function_">pipe</span>(<span class="title function_">gulpConcat</span>(<span class="string">&#x27;20201108.txt&#x27;</span>)) <span class="comment">// pipe:管道，把gulp的执行步骤一步步串联起来，也是gulp的核心</span></span><br><span class="line">.<span class="title function_">pipe</span>(<span class="title function_">dest</span>(<span class="string">&#x27;./demo/&#x27;</span>)) <span class="comment">// dest：存放文件</span></span><br><span class="line">.<span class="title function_">on</span>(<span class="string">&#x27;end&#x27;</span>, <span class="function">() =&gt;</span> &#123; <span class="comment">// 事件监听</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;concat: 文件合并完成&#x27;</span>);</span><br><span class="line">     &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h5 id="创建文件去除空行任务"><a href="#创建文件去除空行任务" class="headerlink" title="创建文件去除空行任务"></a>创建文件去除空行任务</h5><p>因为是需要顺序执行子任务，所以用的 <code>series</code>，如果是需要并行执行的话用 <code>parallel</code></p><p>代码中的 <code>through2</code>主要是用来做文件流转换过滤，写 <code>gulp</code>插件必备，下一节会大概的介绍一下</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">gulp.task(<span class="string">&#x27;format&#x27;</span>, gulp.series(<span class="string">&#x27;concat&#x27;</span>, () =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.src(<span class="string">&#x27;./demo/20201108.txt&#x27;</span>)</span><br><span class="line">      .pipe(through2.obj(<span class="keyword">function</span> (<span class="params">file, encoding, cb</span>) &#123; <span class="comment">// through2：文件流转换，写gulp插件必备，下面会大概的介绍一下</span></span><br><span class="line">          let contents = file.contents.toString();</span><br><span class="line">          contents = contents</span><br><span class="line">              .<span class="built_in">replace</span>(<span class="regexp">/(\n[\s\t]\r\n)/g</span>, <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">              .<span class="built_in">replace</span>(<span class="regexp">/^[\n\r\n\t]|[\n\r\n\t]$/g</span>, <span class="string">&quot;&quot;</span>); <span class="comment">// 去除空行</span></span><br><span class="line">          let lines = contents.<span class="built_in">split</span>(<span class="regexp">/\n/g</span>);</span><br><span class="line">          totalLine = lines.<span class="built_in">length</span>;</span><br><span class="line">          contents = lines.join(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">          file.contents = <span class="built_in">Buffer</span>.from(contents);</span><br><span class="line">          this.<span class="built_in">push</span>(file);</span><br><span class="line">          cb();</span><br><span class="line">      &#125;))</span><br><span class="line">  .pipe(dest(<span class="string">&#x27;./demo/&#x27;</span>))</span><br><span class="line">  .on(<span class="string">&#x27;end&#x27;</span>, () =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">&#x27;format: 去除空行完成&#x27;</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;))</span><br></pre></td></tr></table></figure><h5 id="创建监听任务"><a href="#创建监听任务" class="headerlink" title="创建监听任务"></a>创建监听任务</h5><p>当 <code>20201108</code>文件夹下的文件有写入操作时，去执行 <code>format</code>任务，<code>format</code>任务又依赖 <code>concat</code>任务执行</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;watch&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 因为是需要顺序执行子任务，所以用的concat，如果是需要并行执行的话用parallel</span></span><br><span class="line">  gulp.<span class="title function_">watch</span>(<span class="string">&#x27;./20201108/*.txt&#x27;</span>, gulp.<span class="title function_">series</span>(<span class="string">&#x27;format&#x27;</span>, <span class="function">(<span class="params">cb</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">cb</span>();</span><br><span class="line">  &#125;)).<span class="title function_">on</span>(<span class="string">&#x27;change&#x27;</span>, <span class="function">() =&gt;</span> &#123; <span class="comment">// 更多事件监听可以查看官方文档</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;watch: 文件被改变&#x27;</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h5 id="在项目目录下执行"><a href="#在项目目录下执行" class="headerlink" title="在项目目录下执行"></a>在项目目录下执行</h5><p>以上几步的代码合并到一个 <code>gulpfile.js</code>文件中即可运行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 监控20201108文件夹下所有文件变化，则执行format子任务</span></span><br><span class="line">$ gulp watch</span><br></pre></td></tr></table></figure><p>下图为命令行中输入日志</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f427f3836be84251894df87b614a6881~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp" alt="图片"></p><p>看了上面的 <code>demo</code>可能大家会对 <code>through2</code>比较好奇吧，接下来会大概介绍一下</p><h3 id="gulp插件机制"><a href="#gulp插件机制" class="headerlink" title="gulp插件机制"></a>gulp插件机制</h3><p>我们先提一提 <code>gulp</code>的机制，<code>gulp</code>内部的实现很简单，用了三个sdk实现 <code>undertaker</code>，<code>vinyl-fs</code>, <code>glob-watcher</code></p><ul><li>undertaker: 主要用来实现gulp的子任务流程管理</li><li>vinyl-fs: <code>.src</code> 接口可以匹配一个文件 <strong>通配符</strong> ，将匹配到的文件转为 <code>Vinyl Stream</code>(流)，<code>gulp</code>理念就是万物皆可流</li><li>glob-watcher: 也就是去实现 <code>gulp.watch</code>功能，监控文件流变化</li></ul><p>核心就是把文件转换成 <code>Stream</code>流，然后对 <code>Stream</code>进行操作。</p><p>所以 <code>gulp</code>采用 <code>pipe</code>(管道)的概念，意味着顺着管道流淌，然后我们对于 <code>gulp</code>的插件，也很好理解了，就是在管道中间有个过滤站，对流进行过滤处理，这就用到了上面提到的 <code>through2</code>，这个插件主要的作用也是对流文件进行处理，类似的插件还有 <code>map-stream</code>等，不过 <code>gulp</code>的主流的插件都是基于 <code>through2</code>编写的.</p><p>例如上面的例子（文件去除空行任务），单独封装一下，使用的时候就是一个简单的插件</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// gulp-file-format.jsmodule.exports = () =&gt; &#123;</span></span><br><span class="line">  <span class="keyword">return</span> through2.obj(<span class="keyword">function</span> (<span class="params">file, encoding, cb</span>) &#123;</span><br><span class="line">let contents = file.contents.toString();</span><br><span class="line">contents = contents</span><br><span class="line">  .<span class="built_in">replace</span>(<span class="regexp">/(\n[\s\t]\r\n)/g</span>, <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">  .<span class="built_in">replace</span>(<span class="regexp">/^[\n\r\n\t]|[\n\r\n\t]$/g</span>, <span class="string">&quot;&quot;</span>); <span class="comment">// 去除空行</span></span><br><span class="line">let lines = contents.<span class="built_in">split</span>(<span class="regexp">/\n/g</span>);</span><br><span class="line">totalLine = lines.<span class="built_in">length</span>;</span><br><span class="line">contents = lines.join(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">file.contents = <span class="built_in">Buffer</span>.from(contents);</span><br><span class="line">this.<span class="built_in">push</span>(file);</span><br><span class="line">cb();</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>替换文件去除空行任务</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> gulpFormact = <span class="built_in">require</span>(<span class="string">&#x27;gulp-file-format.js&#x27;</span>);</span><br><span class="line"></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;format&#x27;</span>, gulp.<span class="title function_">series</span>(<span class="string">&#x27;concat&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.<span class="title function_">src</span>(<span class="string">&#x27;./demo/20201108.txt&#x27;</span>)</span><br><span class="line">     .<span class="title function_">pipe</span>(<span class="title function_">gulpFormact</span>())</span><br><span class="line">     .<span class="title function_">pipe</span>(<span class="title function_">dest</span>(<span class="string">&#x27;./demo/&#x27;</span>))</span><br><span class="line">     .<span class="title function_">on</span>(<span class="string">&#x27;end&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;format: 去除空行完成&#x27;</span>);</span><br><span class="line">     &#125;)</span><br><span class="line">&#125;))</span><br></pre></td></tr></table></figure><p>这就是一个很简单的 <code>gulp</code>插件了，是不是很简单，比 <code>webpack</code>的插件简单多了</p><p>下面讲一个日常中对于重复工作提效写的一个脚本，讲讲思路，让大家对gulp的使用场景有个更深的理解。</p><h3 id="实际应用案例思路拆解-支付中间页改版后数据统计"><a href="#实际应用案例思路拆解-支付中间页改版后数据统计" class="headerlink" title="实际应用案例思路拆解-支付中间页改版后数据统计"></a>实际应用案例思路拆解-支付中间页改版后数据统计</h3><p>由于实际的代码涉及到一些敏感数据，所以这个段落只是讲一下解决这个实际问题的思路拆解，怎么去用 <code>gulp</code>完成想要的结果，不贴详细的代码了。</p><p>例如，作者最近做了一个支付中间页的改版</p><p>我需要统计从这个支付中间页转化的用户产生了多少收入，人工流程如下：</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3533d085794549b5b520ec01c28e338e~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp" alt="统计流程"></p><p>把以上几个步骤拆解成 <code>gulp</code>的任务，用 <code>gulp</code>的任务机制管理起来，每一个任务可以单独执行，又可以统一执行</p><ol><li>export：下载用户uid</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导出uid表</span></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;export&#x27;</span>, <span class="function">() =&gt;</span> &#123;&#125;)</span><br></pre></td></tr></table></figure><ol start="2"><li>concat：合并文件并去重</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 对excel文件进行合并去重</span></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;cocat&#x27;</span>, <span class="function">() =&gt;</span> &#123;&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure><ol start="3"><li>money：循环uid，远程请求接口，拿到支付金额</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取每一个uid的支付金额</span></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;money&#x27;</span>, <span class="function">() =&gt;</span> &#123;&#125;)</span><br></pre></td></tr></table></figure><ol start="4"><li>total: 汇总数据，生成汇总excel表格并输出</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 数据汇总</span></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;total&#x27;</span>, gulp.<span class="title function_">series</span>(<span class="string">&#x27;export&#x27;</span>, <span class="string">&#x27;concat&#x27;</span>, <span class="string">&#x27;money&#x27;</span>, <span class="function">(<span class="params">cb</span>) =&gt;</span> &#123;</span><br><span class="line"> <span class="comment">//...</span></span><br><span class="line">&#125;))</span><br></pre></td></tr></table></figure><ol start="5"><li>执行命令</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gulp total</span><br></pre></td></tr></table></figure><p>以上任务都可以独立执行，也可以合并执行</p><h3 id="更复杂的应用场景-转转sdk生成命令工具"><a href="#更复杂的应用场景-转转sdk生成命令工具" class="headerlink" title="更复杂的应用场景-转转sdk生成命令工具"></a>更复杂的应用场景-转转sdk生成命令工具</h3><p>更复杂的应用场景可以查看我们之前产出的一套 <code>sdk</code>命令生成工具：<a href="https://link.juejin.cn/?target=https://github.com/zhuanzhuanfe/commander-tools" title="https://github.com/zhuanzhuanfe/commander-tools">commander-tools</a>，现已在 <code>github</code>开源，在转转支撑团队的维护下功能越来强大，主要实现以下命令:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;lint&quot;</span>: <span class="string">&quot;commander-tools run lint&quot;</span>, <span class="regexp">//</span> 校验</span><br><span class="line">    <span class="string">&quot;fix&quot;</span>: <span class="string">&quot;commander-tools run lint --fix&quot;</span>, <span class="regexp">//</span> 修复</span><br><span class="line">    <span class="string">&quot;staged&quot;</span>: <span class="string">&quot;commander-tools run lint --staged&quot;</span>,</span><br><span class="line">    <span class="string">&quot;staged-fix&quot;</span>: <span class="string">&quot;commander-tools run lint --staged --fix&quot;</span>,</span><br><span class="line">    <span class="string">&quot;dev&quot;</span>: <span class="string">&quot;commander-tools run dev&quot;</span>, <span class="regexp">//</span> 启动本地调试服务</span><br><span class="line">    <span class="string">&quot;compile&quot;</span>: <span class="string">&quot;commander-tools run compile&quot;</span>, <span class="regexp">//</span> 编译</span><br><span class="line">    <span class="string">&quot;dist&quot;</span>: <span class="string">&quot;commander-tools run dist&quot;</span>, <span class="regexp">//</span> 外链打包</span><br><span class="line">    <span class="string">&quot;analyz&quot;</span>: <span class="string">&quot;commander-tools run dist --analyz&quot;</span>, <span class="regexp">//</span> 代码分析</span><br><span class="line">    <span class="string">&quot;build&quot;</span>: <span class="string">&quot;commander-tools run build&quot;</span>,</span><br><span class="line">    <span class="string">&quot;pub&quot;</span>: <span class="string">&quot;commander-tools run pub&quot;</span>, <span class="regexp">//</span> 发布正式版</span><br><span class="line">    <span class="string">&quot;pub-beta&quot;</span>: <span class="string">&quot;commander-tools run pub-beta&quot;</span>, <span class="regexp">//</span> 发布beta版本</span><br><span class="line">    <span class="string">&quot;unpub&quot;</span>: <span class="string">&quot;commander-tools run unpub&quot;</span>, <span class="regexp">//</span> 卸载版本</span><br><span class="line">    <span class="string">&quot;doc&quot;</span>: <span class="string">&quot;commander-tools run doc&quot;</span>, <span class="regexp">//</span> 预览文档</span><br><span class="line">    <span class="string">&quot;build-doc&quot;</span>: <span class="string">&quot;commander-tools run build-doc&quot;</span>, <span class="regexp">//</span> 生成文档</span><br><span class="line">    <span class="string">&quot;doc-upload&quot;</span>: <span class="string">&quot;commander-tools run doc-upload&quot;</span> <span class="regexp">//</span> 文档上传ftp</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>例如：一个上传注释文档的功能</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm run doc-upload</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 上传文档</span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line"><span class="keyword">const</span> chalk = <span class="built_in">require</span>(<span class="string">&#x27;chalk&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> ftp = <span class="built_in">require</span>(<span class="string">&#x27;vinyl-ftp&#x27;</span>)</span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;doc-upload&#x27;</span>, gulp.<span class="title function_">series</span>(<span class="string">&#x27;build-doc&#x27;</span>, <span class="function"><span class="params">done</span> =&gt;</span> &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(chalk.<span class="title function_">green</span>(<span class="string">&#x27;running doc-upload&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!ftpConfig) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(chalk.<span class="title function_">red</span>(<span class="string">&#x27;请配置 ftp.config.js&#x27;</span>))</span><br><span class="line">  process.<span class="title function_">exit</span>(<span class="number">1</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> businessLine = <span class="title function_">getBusinessLine</span>(program)</span><br><span class="line">  <span class="keyword">const</span> &#123; name &#125; = packageJson</span><br><span class="line">  <span class="keyword">const</span> conn = ftp.<span class="title function_">create</span>(&#123;</span><br><span class="line">    <span class="attr">parallel</span>: <span class="number">10</span>,</span><br><span class="line">    <span class="attr">log</span>: fancyLog,</span><br><span class="line">    ...ftpConfig</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> pipe = gulp</span><br><span class="line">    .<span class="title function_">src</span>(<span class="string">`<span class="subst">$&#123;cwd&#125;</span>/<span class="subst">$&#123;program.docsDirName || <span class="string">&#x27;docs&#x27;</span>&#125;</span>/**/*`</span>)</span><br><span class="line">    .<span class="title function_">pipe</span>(conn.<span class="title function_">dest</span>(<span class="string">`/<span class="subst">$&#123;businessLine&#125;</span>/<span class="subst">$&#123;name&#125;</span>/`</span>))</span><br><span class="line">    .<span class="title function_">on</span>(<span class="string">&#x27;end&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(chalk.<span class="title function_">green</span>(<span class="string">&#x27;Success: 文档上传成功&#x27;</span>))</span><br><span class="line">      ftp.<span class="property">docUrl</span> &amp;&amp; <span class="title function_">open</span>(ftp.<span class="property">docUrl</span>)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> pipe</span><br><span class="line">&#125;</span><br><span class="line">&#125;))</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> 打包/封装 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> gulp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git-常用指令</title>
      <link href="/posts/9983a820/"/>
      <url>/posts/9983a820/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Git-常用指令"><a href="#Git-常用指令" class="headerlink" title="Git - 常用指令"></a>Git - 常用指令</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">makdir hello-world    <span class="comment">//创建一个项目hello-world</span></span><br><span class="line">cd hello-world       <span class="comment">//打开这个项目</span></span><br><span class="line">git <span class="keyword">init</span>             <span class="comment">//初始化</span></span><br><span class="line">touch README</span><br><span class="line">git <span class="keyword">add</span> README        <span class="comment">//更新README文件</span></span><br><span class="line">git commit-m <span class="string">&#x27;first commit&#x27;</span>     <span class="comment">//提交更新，并注释信息“first commit”</span></span><br><span class="line">git remote <span class="keyword">add</span> origin git@github.com:defnngj/hello-world.git     <span class="comment">//连接远程github项目</span></span><br><span class="line">git push -u origin master     <span class="comment">//将本地项目更新到github项目上去</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git-使用时可能遇到的问题</title>
      <link href="/posts/131126ae/"/>
      <url>/posts/131126ae/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Git-使用时可能遇到的问题"><a href="#Git-使用时可能遇到的问题" class="headerlink" title="Git - 使用时可能遇到的问题"></a>Git - 使用时可能遇到的问题</h1><h2 id="问题：fatal-not-a-git-repository-or-any-of-the-parent-directories"><a href="#问题：fatal-not-a-git-repository-or-any-of-the-parent-directories" class="headerlink" title="问题：fatal: not a git repository (or any of the parent directories)"></a>问题：<code>fatal: not a git repository (or any of the parent directories)</code></h2><p>输入：<code>git add readme.txt</code>，出现提示：<br><code>fatal: not a git repository (or any of the parent directories)</code>。</p><p>解决方法：<br>Git命令必须在Git仓库目录内执行（<code>git init</code>除外），在仓库目录外执行是没有意义的。</p><h2 id="问题：fatal-pathspec-39-readme-txt-39-did-not-match-any-files"><a href="#问题：fatal-pathspec-39-readme-txt-39-did-not-match-any-files" class="headerlink" title="问题：fatal: pathspec &#39;readme.txt&#39; did not match any files"></a>问题：<code>fatal: pathspec &#39;readme.txt&#39; did not match any files</code></h2><p>输入：<code>git add readme.txt</code>，出现提示：<br><img src="/image/index-5/1649931630623.png" alt="img"><br>说明Git仓库目录文件夹里没有 <code>readme.txt</code>这个文件</p><p>解决方法：<br>去库的文件夹下创建好readme.txt后<br><img src="/image/index-5/1649931664474.png"><br>再次输入 <code>git add readme.txt</code><br><img src="/image/index-5/1649931693630.png" alt="img"></p><h2 id="问题：warning-LF-will-be-replaced-by-CRLF-in-（具体的一个文件）"><a href="#问题：warning-LF-will-be-replaced-by-CRLF-in-（具体的一个文件）" class="headerlink" title="问题：warning: LF will be replaced by CRLF in ******（具体的一个文件）"></a>问题：<code>warning: LF will be replaced by CRLF in ******（具体的一个文件）</code></h2><p>当输入：<code>git add readme.txt</code>，出现这样的提示：<br>原因：<br>LF和CRLF其实都是换行符，但是不同的是，LF是linux和Unix系统的换行符，CRLF是window 系统的换行符。<br>为了解决跨平台项目的协作问题，git提供了一个“换行符自动转换”的功能，并且这个功能是默认处于“自动模式”，即开启状态。</p><p>解决方法：<br>最简单的一种办法就是把自动转换功能关掉即可。<br>输入命令 ：<br>git config core.autocrlf false (仅对当前git仓库有效）<br>git config –global core.autocrlf false (全局有效，不设置推荐全局）</p><h2 id="问题：Failed-to-connect-to-github-com-port-443-after-21098-ms-Timed-out"><a href="#问题：Failed-to-connect-to-github-com-port-443-after-21098-ms-Timed-out" class="headerlink" title="问题：Failed to connect to github.com port 443 after 21098 ms: Timed out"></a>问题：<code>Failed to connect to github.com port 443 after 21098 ms: Timed out</code></h2><p>当输入：，连接github仓库时，出现这样的提示：<br><code>Failed to connect to github.com port 443 after 21098 ms: Timed out</code><br>原因： 这样的问题往往是由于网络慢访问超时，这时候我们可以在终端选择使用设置代理和取消代理的命令解决。</p><p>解决方法：<br>1、设置代理：<br><code>git config --global https.proxy</code><br>2、取消代理：<br><code>git config --global --unset https.proxy</code></p><p>解决步骤：我们直接在终端先输入设置代理的命令，再输入取消代理的命令即可解决</p><h2 id="问题：fatal-remote-origin-already-exists"><a href="#问题：fatal-remote-origin-already-exists" class="headerlink" title="问题：fatal: remote origin already exists"></a>问题：<code>fatal: remote origin already exists</code></h2><p>当输入： <code>git remote add origin https://gitee.com/(github/码云账号)/(github/码云项目名).gitgit add readme.txt</code>，出现这样的提示：<br><code>fatal: remote origin already exists.</code><br>此时，我们可以先 git remote -v 查看远程库信息：<br><img src="https://ask.qcloudimg.com/http-save/yehe-1011815/cc9dbe9f9fa1f1354ea0d2b08cfd93af.png?imageView2/2/w/1620"><br>可以看到，本地库已经关联了 <code>origin</code>的远程库，并且，该远程库指向GitHub。</p><p>解决办法：<br>1、先输入 <code>git remote rm origin</code>(删除关联的origin的远程库)<br>2、再输入 <code>git remote add origin git@github.com:(github名)/(git项目名).git </code>就不会报错了！<br>3、如果输入 <code>git remote rm origin </code>还是报错的话，<code>error: Could not remove config section &#39;remote.origin&#39;. </code>我们需要修改gitconfig文件的内容<br>4、找到你的github的安装路径，我的是 <code>C:\Users\ASUS\AppData\Local\GitHub\PortableGit_ca477551eeb4aea0e4ae9fcd3358bd96720bb5c8\etc</code><br>5、找到一个名为gitconfig的文件，打开它把里面的 <code>[remote &quot;origin&quot;]</code>那一行删掉就好了！</p><h2 id="问题：error-src-refspec-master-does-not-match-any"><a href="#问题：error-src-refspec-master-does-not-match-any" class="headerlink" title="问题：error:src refspec master does not match any"></a>问题：<code>error:src refspec master does not match any</code></h2><p>当输入：，出现这样的提示：<br><code>error:src refspec master does not match any</code></p><p>原因分析：<br>引起该错误的原因是目录中没有文件，空目录是不能提交上去的</p><p>解决办法：<br><code>touch README</code><br><code>git add README</code><br><code>git commit –m &#39;first commit&#39;</code><br><code>git push origin master</code><br><code>git init</code>，这一步之后创建了一个名为.git的文件夹，不过它在默认状态下是隐藏的，系统将隐藏文件夹显示出来，可以看到有这样一个文件夹。<br>github上传项目方法：<br><code>http://www.oschina.net/question/159132_86728</code><br>在你的电脑上装好git</p><p>大致流程是：<br>1、 在github上创建项目<br>2、 使用$ git clone <a href="https://github/xx%E8%B4%A6%E5%8F%B7/xx%E9%A1%B9%E7%9B%AE.git%E5%85%8B%E9%9A%86%E5%88%B0%E6%9C%AC%E5%9C%B0">https://github/xx账号/xx项目.git克隆到本地</a><br>3、 编辑项目<br>4、 git add .(将改动添加到暂存区)<br>5、 git commit –m”提交说明”<br>6、 git push origin 将本地更改推送到远程master分支</p><p>这样你就完成了向远程仓库的推送<br>如果在github的remote上已经有了文件，会出现错误。此时应当先pull一下，即：<br><code>git pull origin master</code><br>然后再进行：<br><code>git push origin master</code></p><h2 id="问题：Permission-denied-public-key"><a href="#问题：Permission-denied-public-key" class="headerlink" title="问题：Permission denied (public key)"></a>问题：<code>Permission denied (public key)</code></h2><p>当输入：<code>ssh -T git@github.com</code>，出现这样的提示<br><code>Permission denied (public key).</code>因为新生成的key不能加入ssh就会导致连接不上github。</p><p>解决办法如下：<br>1、先输入 <code>ssh-agent</code>，再输入 <code>ssh−agent</code>，再输入 <code>ssh-add ~/.ssh/id_key</code>，这样就可以了。<br>2、如果还是不行的话，输入 <code>ssh-add~/.ssh/id_key </code>命令后出现报错 <code>Could not open a connection toyour authentication agent.</code>解决方法是key用Git Gui的ssh工具生成，这样生成的时候key就直接保存在ssh中了，不需要再ssh-add命令加入了，其它的user，token等配置都用命令行来做。<br>3、最好检查一下在你复制id_rsa.pub文件的内容时有没有产生多余的空格或空行，有些编辑器会帮你添加这些的。</p><h2 id="问题：error-failed-to-push-som-refs-to"><a href="#问题：error-failed-to-push-som-refs-to" class="headerlink" title="问题：error:failed to push som refs to ......."></a>问题：<code>error:failed to push som refs to .......</code></h2><p>当输入：<code>git push origin master,</code>出现这样的提示：<code>error:failed to push som refs to .......</code></p><p>解决办法如下：<br>1、先输入 <code>git pull origin master</code>&#x2F;&#x2F;先把远程服务器github上面的文件拉下来<br>2、再输入 <code>git push origin master</code><br>3、如果出现报错 <code>fatal:Couldn&#39;t find remote ref master</code>或者 <code>fatal: &#39;origin&#39; does not appear to be a git repository</code>以及 <code>fatal: Could not read from remote repository.</code><br>4、则需要重新输入 <code>git remote add origin git@github.com:djqiang/gitdemo.git</code></p>]]></content>
      
      
      <categories>
          
          <category> Git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git-bug分支</title>
      <link href="/posts/a71bafb4/"/>
      <url>/posts/a71bafb4/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Git-bug分支"><a href="#Git-bug分支" class="headerlink" title="Git - bug分支"></a>Git - bug分支</h1><p><a href="https://www.liaoxuefeng.com/wiki/896043488029600/900388704535136">请查看具体内容</a></p><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>修复bug时，我们会通过创建新的bug分支进行修复，然后合并，最后删除；</p><p>当手头工作没有完成时，先把工作现场 <code>git stash</code>一下，然后去修复bug，修复后，再 <code>git stash pop</code>，回到工作现场；</p><p>在master分支上修复的bug，想要合并到当前dev分支，可以用 <code>git cherry-pick &lt;commit&gt;</code>命令，把bug提交的修改“复制”到当前分支，避免重复劳动。</p>]]></content>
      
      
      <categories>
          
          <category> Git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git-创建与合并分支</title>
      <link href="/posts/90f6c624/"/>
      <url>/posts/90f6c624/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Git-创建与合并分支"><a href="#Git-创建与合并分支" class="headerlink" title="Git - 创建与合并分支"></a>Git - 创建与合并分支</h1><p><a href="https://www.liaoxuefeng.com/wiki/896043488029600/900003767775424">请查看具体内容</a></p><h2 id="总结命令"><a href="#总结命令" class="headerlink" title="总结命令"></a>总结命令</h2><p>查看分支：<code>git branch</code></p><p>创建分支：<code>git branch name</code></p><p>切换分支：<code>git checkout name</code></p><p>创建+切换分支：<code>git checkout –b name</code></p><p>合并某分支到当前分支：<code>git merge name</code></p><p>删除分支：<code>git branch –d name</code></p>]]></content>
      
      
      <categories>
          
          <category> Git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git-使用教程</title>
      <link href="/posts/84e344b9/"/>
      <url>/posts/84e344b9/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Git-使用教程"><a href="#Git-使用教程" class="headerlink" title="Git - 使用教程"></a>Git - 使用教程</h1><h2 id="创建版本库"><a href="#创建版本库" class="headerlink" title="创建版本库"></a>创建版本库</h2><p>即仓库，英文名repository，简单理解为目录，目录里所有文件都可以被Git管理起来，每个文件的修改，删除，Git都能跟踪，以便任何时刻都可以追踪历史，或者在将来某个时刻还可以将文件“还原”。</p><p>所以创建一个版本库也非常简单，如下，我设置为A盘 –-&gt; html_demo文件夹，新建一个demo版本库。</p><p><img src="/image/index-1/1649931042169.png"></p><p>1、命令 pwd——显示当前demo版本库所在的路径。</p><p>2、命令 git init——生成.git文件夹，使得git可以跟踪管理这个仓库，如下：</p><p><img src="/image/index-1/1649931221172.png"></p><h3 id="将文件添加至版本库"><a href="#将文件添加至版本库" class="headerlink" title="将文件添加至版本库"></a>将文件添加至版本库</h3><p>在版本库demo目录下新建一个记事本文件 readme.txt</p><p>第一步：使用命令 <code>git add </code>添加到暂存区。</p><p><img src="/image/index-5/1649931693630.png"></p><p>注：<code>git add .</code> 一次性提交全部文件。</p><p>如果没有任何提示，说明已经添加成功。</p><p>第二步：使用命令 <code>git commit</code>提交到仓库。</p><p><img src="/image/index-1/1649931992275.png"></p><p><code>-m</code>：输入本次提交的说明，可以输入任意内容，方便从历史记录里找到改动记录。</p><p>第三步：使用命令 <code>git status</code>查看是否还有文件未提交。</p><p><img src="/image/index-1/1649932028339.png"></p><p>说明没有文件未提交。</p><h2 id="查看工作区状态"><a href="#查看工作区状态" class="headerlink" title="查看工作区状态"></a>查看工作区状态</h2><ul><li>要随时掌握工作区的状态，使用 <code>git status</code>命令。</li><li>如果 <code>git status</code>告诉你有文件被修改过，用 <code>git diff</code>可以查看修改内容。</li></ul><h2 id="远程仓库"><a href="#远程仓库" class="headerlink" title="远程仓库"></a>远程仓库</h2><h3 id="前提：创建GitHub账户"><a href="#前提：创建GitHub账户" class="headerlink" title="前提：创建GitHub账户"></a>前提：创建GitHub账户</h3><h3 id="创建远程仓库"><a href="#创建远程仓库" class="headerlink" title="创建远程仓库"></a>创建远程仓库</h3><p>本地Git仓库和Github仓库之间的传输是通过SSH加密的。</p><h4 id="第一步：创建SSH-Key"><a href="#第一步：创建SSH-Key" class="headerlink" title="第一步：创建SSH Key"></a>第一步：创建SSH Key</h4><p>查看用户主目录下的.ssh目录，找到id_rsa和id_rsa.pub这两个文件，如果没有此文件，打开命令行，输入如下命令：</p><p><code>ssh-keygen -t rsa –C “youremail@example.com”</code></p><p>由于我本地此前运行过一次，所以本地有，如下所示：</p><p><img src="https://pic3.zhimg.com/80/v2-20d104a189e0c4c920498d62469c1552_720w.jpg"></p><p>id_rsa是私钥，不能泄露出去，id_rsa.pub是公钥，可以放心地告诉任何人。</p><h4 id="第二步：登录github"><a href="#第二步：登录github" class="headerlink" title="第二步：登录github"></a>第二步：登录github</h4><p>打开“Account settings”中的“SSH Keys”页面，然后点击“Add SSH Key”，填上任意title，在Key文本框里黏贴 <code>id_rsa.pub</code>文件的内容。</p><p><img src="https://pic2.zhimg.com/80/v2-c7546a7705a83f46bd82c7b44ac38f55_720w.jpg"></p><p>点击 Add Key，你就应该可以看到已经添加的key。</p><p><img src="https://pic2.zhimg.com/80/v2-eb37c4f1f9bff11c9306386018e89465_720w.jpg"></p><h3 id="删除远程仓库"><a href="#删除远程仓库" class="headerlink" title="删除远程仓库"></a>删除远程仓库</h3><p>如果添加的时候地址写错了，或者就是想删除远程库，可以用 <code>git remote rm &lt;name&gt;</code>命令。</p><p>使用前，建议先用 <code>git remote -v</code>查看远程库信息：</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git remote -v</span><br><span class="line">origin  git<span class="keyword">@github</span>.<span class="attribute">com</span>:michaelliao/learn-git.git (fetch)</span><br><span class="line">origin  git<span class="keyword">@github</span>.<span class="attribute">com</span>:michaelliao/learn-git.git (push)</span><br></pre></td></tr></table></figure><p>然后，根据名字删除，比如删除 <code>origin</code>：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$</span> git remote <span class="built_in">rm</span> origin</span><br></pre></td></tr></table></figure><p>此处的“删除”其实是解除了本地和远程的绑定关系，并不是物理上删除了远程库。远程库本身并没有任何改动。要真正删除远程库，需要登录到GitHub，在后台页面找到删除按钮再删除。</p><h3 id="创建远程仓库-1"><a href="#创建远程仓库-1" class="headerlink" title="创建远程仓库"></a>创建远程仓库</h3><p>现在的情景是：我们已经在本地创建了一个Git仓库后，又想在github创建一个Git仓库，并且希望这两个仓库进行远程同步，这样github的仓库可以作为备份，又可以其他人通过该仓库来协作。</p><p>首先，登录github上，然后在右上角找到“create a new repo”创建一个新的仓库。如下：</p><p><img src="https://pic3.zhimg.com/80/v2-044b0f2143423da8ead81e8cdd93cf92_720w.jpg"></p><p>在Repository name填入testgit，其他保持默认设置，点击“Create repository”按钮，就成功地创建了一个新的Git仓库：</p><p><img src="https://pic4.zhimg.com/80/v2-b5ea16049c9c69ff9fce3ed841605407_720w.jpg"></p><p>目前，在GitHub上的这个testgit仓库还是空的，GitHub告诉我们，可以从这个仓库克隆出新的仓库，也可以把一个已有的本地仓库与之关联，然后，把本地仓库的内容推送到GitHub仓库。</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">现在，我们根据GitHub的提示，在本地的testgit仓库下运行命令：</span><br></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote add origin https:<span class="regexp">//gi</span>thub.com<span class="regexp">/tugenhua0707/</span>testgit.git</span><br></pre></td></tr></table></figure><p>所有的如下：</p><p><img src="https://pic3.zhimg.com/80/v2-c862a425b87eee36326e49e67397d292_720w.jpg"></p><p>把本地库的内容推送到远程，使用 <code> git push</code>命令，实际上是把当前分支 <code>master</code>推送到远程。</p><p>由于远程库是空的，我们第一次推送 <code>master</code>分支时，加上了 <code>–u</code>参数，Git不但会把本地的 <code>master</code>分支内容推送的远程新的 <code>master</code>分支，还会把本地的 <code>master</code>分支和远程的 <code>master</code>分支关联起来，在以后的推送或者拉取时就可以简化命令。推送成功后，可以立刻在github页面中看到远程库的内容已经和本地一模一样了，上面的要输入github的用户名和密码如下所示：</p><p><img src="https://pic1.zhimg.com/80/v2-9ff3182d6256c26f94dff72e3d06ebbc_720w.jpg"></p><p>从现在起，只要本地作了提交，就可以通过如下命令：</p><p><code>git push origin master</code></p><p>把本地 <code>master</code>分支的最新修改推送到github上了，现在你就拥有了真正的分布式版本库了。</p><h3 id="克隆远程仓库"><a href="#克隆远程仓库" class="headerlink" title="克隆远程仓库"></a>克隆远程仓库</h3><p>上面我们了解了先有本地库，后有远程库时候，如何关联远程库。</p><p>现在我们想，假如远程库有新的内容了，我想克隆到本地来 如何克隆呢？</p><p>首先，登录github，创建一个新的仓库，名字叫testgit2.如下：</p><p><img src="https://pic4.zhimg.com/80/v2-f0fc0d64cad20ce60ac8c65a2241d71b_720w.jpg"></p><p>如下，我们看到：</p><p><img src="https://pic4.zhimg.com/80/v2-4d4ededd84604ca6c2f36cbdeefb8633_720w.jpg"></p><p>现在，远程库已经准备好了，下一步是使用命令 <code>git clone，</code>克隆一个本地库了。如下所示：</p><p><img src="https://pic3.zhimg.com/80/v2-e0d86da4a80c40350b1a9e7db25bb776_720w.jpg"></p><p>进入 <code>testgit2</code>目录，已经存在 <code>README.md</code>文件</p><p><img src="https://pic2.zhimg.com/80/v2-6a2e48966004fa5ac328ad04b40fe721_720w.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git-安装教程</title>
      <link href="/posts/b364958a/"/>
      <url>/posts/b364958a/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Git-安装教程"><a href="#Git-安装教程" class="headerlink" title="Git - 安装教程"></a>Git - 安装教程</h1><h2 id="git的定义"><a href="#git的定义" class="headerlink" title="git的定义"></a>git的定义</h2><p>开源的<strong>分布式版本控制系统</strong></p><p>工作原理 &#x2F; 流程：</p><p><img src="https://pic2.zhimg.com/80/v2-3bc9d5f2c49a713c776e69676d7d56c5_720w.jpg"></p><p>Workspace：工作区<br>Index &#x2F; Stage：暂存区<br>Repository：仓库区（或本地仓库）<br>Remote：远程仓库</p><h2 id="如何安装git"><a href="#如何安装git" class="headerlink" title="如何安装git"></a>如何安装git</h2><p>网上搜索git，进入官网后</p><p><img src="/image/index-0/1649930198926.png"></p><p>选择并下载电脑对应的安装包，如下图所示：</p><p><img src="/image/index-0/1649930346740.png"></p><p>然后进行默认安装。安装完成后，在开始菜单里面找到”git–&gt;git bash“，如下图所示：</p><p><img src="https://file+.vscode-resource.vscode-webview.net/a%3A/html_demo/myHexoPorn/source/_posts/git/image/index-0/1649930441610.png" alt="img"></p><p>点击后，弹出命令窗口，输入“git version”，显示如下数据，表面安装成功；</p><p><img src="/image/index-0/1649930538317.png"></p><p>配置相关信息：</p><p>安装完成后，还需要进行最后一步设置，在命令行输入如下指令：</p><p>因为Git是分布式版本控制系统，所以需要填写用户名和邮箱作为一个标识。</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config <span class="attr">--global</span> user<span class="selector-class">.name</span>  <span class="string">&quot;Github用户名&quot;</span></span><br><span class="line">git config <span class="attr">--global</span> user<span class="selector-class">.email</span>  <span class="string">&quot;email地址（注册使用）&quot;</span></span><br></pre></td></tr></table></figure><p>注意：git config –global 参数，有了这个参数，表示你这台机器上所有的Git仓库都会使用这个配置，当然你也可以对某个仓库指定的不同的用户名和邮箱。</p>]]></content>
      
      
      <categories>
          
          <category> Git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>电脑快捷键及对应功能</title>
      <link href="/posts/c2c00802/"/>
      <url>/posts/c2c00802/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="以下快捷键皆以WIN10为例"><a href="#以下快捷键皆以WIN10为例" class="headerlink" title="以下快捷键皆以WIN10为例"></a>以下快捷键皆以WIN10为例</h1><table><thead><tr><th align="center">按键</th><th>功能</th><th>常用</th></tr></thead><tbody><tr><td align="center">win+shift+S</td><td>截图（可选四种截图方式：矩形截图、任意形状截图、窗口截图、全窗口截图）</td><td>√</td></tr><tr><td align="center">PrintScreen</td><td>全屏截图并保存至剪切板中（无任何提示）</td><td></td></tr><tr><td align="center">PrintScreen+Alt</td><td>截取当前焦点所在的活动窗口（无任何提示）</td><td></td></tr><tr><td align="center">NumLock</td><td>数字锁定键，控制小键盘区的数字输入</td><td>√</td></tr><tr><td align="center">F2</td><td>重命名项目</td><td>√</td></tr><tr><td align="center">F5</td><td>刷新</td><td>√</td></tr><tr><td align="center">F6</td><td>在资源管理器及浏览器中定位到地址栏</td><td></td></tr><tr><td align="center">F11</td><td>全屏</td><td>√</td></tr><tr><td align="center">win + D</td><td>显示桌面（Desktop）</td><td></td></tr><tr><td align="center">win + E</td><td>打开Windows资源管理器（我的电脑）</td><td></td></tr><tr><td align="center">win + F</td><td>快速打开搜索窗口</td><td></td></tr><tr><td align="center">win + L</td><td>快速锁屏</td><td></td></tr><tr><td align="center">win + P</td><td>投影屏幕</td><td></td></tr><tr><td align="center">win + Q&#x2F;S</td><td>打开任务栏的搜索框</td><td></td></tr><tr><td align="center">win + R</td><td>调出“运行”命令，可以进行一些复杂的命令操作</td><td></td></tr><tr><td align="center">win + T</td><td>桌面底部任务栏应用切换</td><td></td></tr><tr><td align="center">win + Space</td><td>切换输入法</td><td></td></tr><tr><td align="center">win + Tab</td><td>激活任务视图</td><td></td></tr><tr><td align="center">win + ;</td><td>调出 Emoji 表情</td><td></td></tr><tr><td align="center">win + Shift + S</td><td>Windows自带截图</td><td></td></tr><tr><td align="center">win + ctrl + D</td><td>创建一个新的虚拟桌面</td><td></td></tr><tr><td align="center">win + ctrl + F4</td><td>关闭虚拟桌面</td><td></td></tr><tr><td align="center">ctrl + Alt + delete</td><td>调出任务管理器、注销或者切换用户，电脑死机的时候，也可以关闭</td><td></td></tr><tr><td align="center">ctrl + X</td><td>剪切</td><td></td></tr><tr><td align="center">ctrl + C</td><td>复制</td><td></td></tr><tr><td align="center">ctrl + V</td><td>粘贴</td><td></td></tr><tr><td align="center">ctrl + Z</td><td>撤销</td><td></td></tr><tr><td align="center">ctrl + Shift + Esc</td><td>打开任务管理器</td><td></td></tr><tr><td align="center">ctrl + Shift</td><td>切换输入法</td><td></td></tr><tr><td align="center">ctrl + F4</td><td>Win资源管理器中切至地址栏；媒体播放中停止</td><td></td></tr><tr><td align="center">ctrl + F5</td><td>页面强制刷新</td><td></td></tr><tr><td align="center">ctrl + Esc</td><td>打开开始菜单</td><td></td></tr><tr><td align="center">ctrl + Alt + 方向键</td><td>旋转桌面</td><td></td></tr><tr><td align="center">ctrl + F</td><td>查找 Find</td><td></td></tr><tr><td align="center">ctrl + O</td><td>打开 Open</td><td></td></tr><tr><td align="center">ctrl + P</td><td>打印 Print</td><td></td></tr><tr><td align="center">Alt + Tab</td><td>切换当前程序 （加Shift反向）</td><td></td></tr><tr><td align="center">Alt + Esc</td><td>切换当前程序 （加Shift反向）</td><td></td></tr></tbody></table><p>　</p>]]></content>
      
      
      <categories>
          
          <category> 编程技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 电脑快捷键 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常见图片格式及其优缺点</title>
      <link href="/posts/82f30315/"/>
      <url>/posts/82f30315/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="前置知识：二进制位数与色彩的关系"><a href="#前置知识：二进制位数与色彩的关系" class="headerlink" title="前置知识：二进制位数与色彩的关系"></a>前置知识：二进制位数与色彩的关系</h3><p>　　在计算机中，像素用二进制数来表示。不同的图片格式中像素与二进制位数之间的对应关系是不同的，<br>　　一个像素对应的二进制位数越多，它可以表示的颜色种类就越多，成像效果也就越清晰，文件体积相应也会越大</p><h3 id="常见图片格式及其优缺点"><a href="#常见图片格式及其优缺点" class="headerlink" title="常见图片格式及其优缺点"></a>常见图片格式及其优缺点</h3><p>图像文件主要可分为两个类别：<strong>栅格图像文件</strong>和<strong>矢量图像文件</strong>。</p><p>栅格格式：适合用于图像和图片；</p><p>矢量格式：适用用于Logo徽标，图标和数字图形。</p><h4 id="栅格图像文件格式"><a href="#栅格图像文件格式" class="headerlink" title="栅格图像文件格式"></a>栅格图像文件格式</h4><p>最常见的栅格图像格式包括JPEG，GIF和PNG三种。</p><p>栅格图像文件类型为静态图像，其中每个像素均基于其分辨率具有定义的颜色，位置和比例。</p><p>由于静态的，无法随心所欲地调整图像的大小，否则原始设计和像素将简单地被拉伸以填充额外的空间。最终会产生模糊，像素化或其他失真的图像。</p><p>一般情况下，在互联网上看到的绝大多数照片或图像都使用栅格图像格式。</p><h4 id="矢量图像文件格式"><a href="#矢量图像文件格式" class="headerlink" title="矢量图像文件格式"></a>矢量图像文件格式</h4><p>最常见的矢量图像格式包括SVG，EPS，AI和PDF这四种。</p><p>与静态栅格图像文件格式（每个设计形状和颜色都与一个像素相关联）不同，矢量图像格式更加灵活。</p><p>矢量图形使用笛卡尔平面上的直线和曲线系统（即通过数学公式计算获得的），该系统相对于总面积（而不是任何单个像素）进行缩放。</p><p>这意味着我们可以无限扩大原始图像分辨率，又不会损失质量或失真。</p><blockquote><p>矢量图像一般称为图形，即它是一种几何形状，而不是单纯的像素图；</p><p>栅格图像（位图）则称为图像，在固定的尺寸内包含一定数量的像素。</p></blockquote><h3 id="15种常见的图像文件类型（格式）"><a href="#15种常见的图像文件类型（格式）" class="headerlink" title="15种常见的图像文件类型（格式）"></a>15种常见的图像文件类型（格式）</h3><p>接下来，将介绍15种最为常见的图像文件格式，从Web栅格图像到矢量图形，再到图像编辑软件文件。</p><p>讨论每种格式的优缺点以及最理想的应用场景。</p><h4 id="JPEG（或JPG）-最为常见的图像格式"><a href="#JPEG（或JPG）-最为常见的图像格式" class="headerlink" title="JPEG（或JPG）- 最为常见的图像格式"></a>JPEG（或JPG）- 最为常见的图像格式</h4><p>一种有损压缩的<strong>栅格图像格式</strong>，适合作为共享图像。既然JPEG是“有损的”图像，也就是说使用此格式时，若减小文件大小，在一定程度上也会降低图像质量。</p><p>JPEG是目前互联网上最常用的图像文件类型之一，因为它的可压缩性及浏览器&#x2F;操作系统广泛支持。</p><p>大多数社交媒体平台会自动将上传的图像文件转换为JPEG，且会根据不同场景使用固定的尺寸大小来控制图片的分辨率。</p><p><strong>优缺点</strong></p><ul><li>优点：体积小，加载快，通用浏览器和操作系统广泛支持。</li><li>缺点：有损图像压缩可能导致较差的文本可读性。</li></ul><p><strong>应用场景</strong></p><ul><li>博客和文章图像（如用户头像，产品图片等）的不错选择。</li><li>不要将JPEG格式用于信息图表（拥有很多小文本）或教程截图，因为图像里面的文字至关重要。</li></ul><h4 id="PNG-–-Web广泛使用的图像格式"><a href="#PNG-–-Web广泛使用的图像格式" class="headerlink" title="PNG – Web广泛使用的图像格式"></a>PNG – Web广泛使用的图像格式</h4><p>一种<strong>栅格图形格式</strong>，但支持无损压缩，保证颜色之间的细节和对比度。</p><p>特别是，PNG提供比JPEG更好的文本可读性。</p><p>这使得PNG成为信息图形，横幅Banner，屏幕截图以及其他同时包含图像和文本的图形的最佳表达方式。<br><strong>优缺点</strong></p><ul><li>优点：无损压缩，质量高，支持透明。</li><li>缺点：如果文件过多（特别是高分辨率图像），可能会严重影响网站加载速度。</li></ul><p><strong>应用场景</strong></p><ul><li>信息图表，横幅，博客图形，屏幕截图，优惠券和其他包含文本的视觉效果的不错选择。</li><li>不要在网站上使用高分辨率的照片，因为文件体积可能会高达几MB。</li></ul><h4 id="GIF-–-动画图像格式"><a href="#GIF-–-动画图像格式" class="headerlink" title="GIF – 动画图像格式"></a>GIF – 动画图像格式</h4><p>英文全称为“Graphics Interchange Format”，属于另一种<strong>栅格<strong><strong>图像</strong></strong>格式</strong>。该格式也使用了无损压缩，且将图像“约束”为8 bits&#x2F;每个像素，并限制为256色调色板。</p><p>GIF格式也是最有名的（和最常用）的动画图像，因为它的8-bit限制保证了动画体积更小和互联网友好。</p><p><strong>优缺点</strong></p><ul><li>优点：更小的文件体积和动画支持。</li><li>缺点：8-bit限制代表图像质量受限。</li></ul><p><strong>应用场景</strong></p><ul><li>使用动画GIF不仅可以“增加内容趣味”，还可以在教程和指南中演示相关操作和流程。</li><li>如果你需要比8-bit彩色图像更清晰的图片不要用这种格式（JPEG最多可支持24-bit）。</li></ul><h4 id="WebP-–-JPEG-amp-PNG最佳替代图像格式"><a href="#WebP-–-JPEG-amp-PNG最佳替代图像格式" class="headerlink" title="WebP – JPEG&amp;PNG最佳替代图像格式"></a>WebP – JPEG&amp;PNG最佳替代图像格式</h4><p><strong>优缺点</strong></p><ul><li>优点：较小的文件即可获得相同或更好的图像质量。</li><li>缺点：并非所有浏览器和图像编辑器都支持。</li></ul><p><strong>使用场景</strong></p><ul><li>JPEG和PNG文件最佳替代格式，可节省带宽并提升网站加载速度。如果网站使用的是WordPress内容管理系统，可参考“<a href="https://www.wbolt.com/how-to-use-webp-images-on-wordpress.html">如何实现WordPress网站使用WebP格式图片</a>”文章，如何实现根据不同浏览器传输合适的图片格式。</li></ul><h4 id="TIFF-–-扫描仪最佳拍档图像格式"><a href="#TIFF-–-扫描仪最佳拍档图像格式" class="headerlink" title="TIFF – 扫描仪最佳拍档图像格式"></a>TIFF – 扫描仪最佳拍档图像格式</h4><p>TIFF是本图像文件类型指南不应该缺少的一种格式。</p><p>英文全称为“Tagged Image File Format”，是一种<strong>栅格图像格式</strong>，最常用于存储和编辑图像，以便于将来打印。</p><p>该格式不支持任何压缩，图像质量是该格式的首要保证。</p><p><strong>优缺点</strong></p><ul><li>优点：高质量文件适合存储或印刷出版。</li><li>缺点：不支持压缩导致图像文件体积过大；非常有限的浏览器支持。</li></ul><p><strong>使用场景</strong></p><ul><li>存储和准备要出版印刷的图像和图形。</li><li>许多扫描仪以该格式文件保存高质量扫描文档或图片。</li></ul><h4 id="HEIF-–-手机照片常见图像格式"><a href="#HEIF-–-手机照片常见图像格式" class="headerlink" title="HEIF – 手机照片常见图像格式"></a>HEIF – 手机照片常见图像格式</h4><p>英文全称为“High Efficiency Image File Format”，是由MPEG视频格式背后的技术团队开发的图像格式，是JPEG的直接竞争对手。</p><p>HEIF压缩效率理论值几乎是JPEG的两倍，换言之，文件大小相同的情况下，HEIF图像质量可以提高一倍。</p><p>这是一种基于像素映射的<strong>栅格图像格式</strong>，无法做到按比例放大图像而不会降低质量。</p><p><strong>优缺点</strong></p><ul><li>优点：相对于JPG来说，同等质量下，可以做到压缩效率更高。</li><li>缺点：浏览器不支持和有限的操作系统支持。</li></ul><p><strong>使用场景</strong></p><ul><li>一些较新的手机和设备使用它来存储照片，以保证照片质量。</li></ul><h4 id="SVG-–-可缩放矢量图形格式"><a href="#SVG-–-可缩放矢量图形格式" class="headerlink" title="SVG – 可缩放矢量图形格式"></a>SVG – 可缩放矢量图形格式</h4><p>可伸缩<strong>矢量图形格式</strong>（通常称为SVG），由W3C开发的一种标记语言，可以在浏览器中直接渲染为二维图像。</p><p>它不像栅格格式那样依赖像素，而是使用XML文本以类似于数学方程式计算勾勒形状和线条获得图形。</p><p>也就是说，可以在不损失任何质量的情况下无限放大SVG图像。</p><p><strong>优缺点</strong></p><ul><li>优点：体积小和无损缩放，可用于简单的插图，形状和文本。</li><li>缺点：对于图像或复杂图形而言，不是理想的格式。</li></ul><p><strong>使用场景</strong></p><ul><li>SVG适用于作为Logo，图标，简单插画以及任何响应式设计所需的自由缩放内容的格式。<br>Tips：<a href="https://www.wbolt.com/how-to-safely-enable-wordpress-svg-support.html">如何实现WordPress博客支持SVG格式图像上传</a>？</li></ul><h4 id="EPS-–-插画-x2F-排版设计矢量图像格式"><a href="#EPS-–-插画-x2F-排版设计矢量图像格式" class="headerlink" title="EPS – 插画&#x2F;排版设计矢量图像格式"></a>EPS – 插画&#x2F;排版设计矢量图像格式</h4><p>英文全称为“Encapsulated PostScript”，属于<strong>矢量图像文件</strong>，一般为Adobe Illustrator和其他插插画软件（如CorelDraw）的一种保存格式。</p><p>与SVG文件相似，EPS实际上是一个基于文本的文档格式，该文档使用代码表达形状和线条，而不是映射像素和颜色。因此，EPS文件也支持无损缩放。</p><p><strong>优缺点</strong></p><ul><li>优点：无损缩放，打印机支持的文档和设计。</li><li>缺点：有限的软件支持，一般为IIIustrator、Quard Xpress、PageMaker等软件；Photoshop和Coreldraw可打开但不能编辑。</li></ul><p><strong>使用场景</strong></p><ul><li>使用Adobe Illustrator或其他页面排版软件时，用于存储，保存和打印。</li></ul><h4 id="PDF-–-电子书常用文档格式"><a href="#PDF-–-电子书常用文档格式" class="headerlink" title="PDF – 电子书常用文档格式"></a>PDF – 电子书常用文档格式</h4><p>英文全称为“Portable Document Format”，该格式主要用于文本文档的存储，保存和读取。</p><p>但是，PDF文件实际上基于为EPS矢量图像文件提供支持的PostScript语言，也可以用于保存图像和插画。</p><p><strong>优缺点</strong></p><ul><li>优点：可索引和可搜索的文本使其非常适合作为图表或报告格式；可以包含链接，CTA按钮和其他交互式元素；无损可伸缩性。</li><li>缺点：不能包含在Web内容中，必须作为独立文件加载读取。</li></ul><p><strong>使用场景</strong></p><ul><li>创建一个交互式的可视报告或信息图表作为内容补充时，PDF是最佳选择。</li></ul><h4 id="PSD-–-Photoshop文档格式"><a href="#PSD-–-Photoshop文档格式" class="headerlink" title="PSD – Photoshop文档格式"></a>PSD – Photoshop文档格式</h4><p>非常常见，大部分对该格式应该都不会感到陌生。PSD文件格式是一种用于保存图像文档的图像格式，为Adobe Photoshop软件特有的格式。</p><p><strong>PSD不是网络安全图像格式</strong> ，不兼容任何浏览器或标准图像查看器或编辑器。</p><p><strong>优缺点</strong></p><ul><li>优点：所有过滤器，透明度，路径和编辑都是完全可自定义和可逆的；无损图像格式。</li><li>缺点：部分文件体积太大。</li></ul><p><strong>使用场景</strong></p><ul><li>用于存储Photoshop项目。</li></ul><h4 id="AI-–-Adobe-Illustrator文档格式"><a href="#AI-–-Adobe-Illustrator文档格式" class="headerlink" title="AI – Adobe Illustrator文档格式"></a>AI – Adobe Illustrator文档格式</h4><p>AI是Adobe专门开发的另一种图像格式，不仅可以保存图像，还可以保存项目状态。</p><p>像PSD一样， <strong>它不用于网络</strong> ，也不兼容任何浏览器或大多数默认图像查看器。</p><p>与PSD文件不同是，AI文件可以自由缩放，但质量不会有任何损失。</p><p><strong>优缺点</strong></p><ul><li>优点：所有笔画，线条，形状，过滤器都是可自定义和可逆的；可自由放大或缩小插画大小。</li><li>缺点：有些PSD文件体积太大了。</li></ul><p><strong>使用场景</strong></p><ul><li>在完成之前和之后保存和存储Adobe Illustrator项目。</li></ul><h4 id="XCF-—GIMP图像编辑工具专属格式"><a href="#XCF-—GIMP图像编辑工具专属格式" class="headerlink" title="XCF —GIMP图像编辑工具专属格式"></a>XCF —GIMP图像编辑工具专属格式</h4><p>英文全称为“eXperimental Computing Facility”，是开源图像编辑器GIMP特有的图像文件类型。类同与Photoshop特有的PSD文件格式，支持保存路径，透明度，滤镜等。</p><p>同样，这是用于存储项目的计算机文件类型， <strong>任何浏览器或默认图像查看器均不支持</strong> 。</p><p><strong>优缺点</strong></p><ul><li>优点：所有路径，过滤器和形状都是可自定义和可逆的；无损图像质量。</li><li>缺点：文件体积有时候会很庞大。</li></ul><p><strong>使用场景</strong></p><ul><li>用于存储GIMP项目。</li></ul><h4 id="INDD-–-Adobe-InDesign文档格式"><a href="#INDD-–-Adobe-InDesign文档格式" class="headerlink" title="INDD – Adobe InDesign文档格式"></a>INDD – Adobe InDesign文档格式</h4><p>INDD是Adobe InDesign软件特定的文件类型，用于保存该软件的项目文件，包括页面内容，样式，色板等。</p><p>尽管有时称为图像文件格式，但它倾向于用于展现文字以外的视觉元素。。</p><p>任何浏览器或默认图像查看器均不支持该<strong>格式</strong> ，因为<strong>它不是网络安全格式</strong> 。</p><p><strong>优缺点</strong></p><ul><li>存储具有可自定义元素的大型多页设计项目。</li></ul><p><strong>使用场景</strong></p><ul><li>图形设计师和产品艺术家主要使用它来设计和制作海报，传单，杂志，小册子等。</li></ul><h4 id="Raw-–-数码相机图像存储文件格式"><a href="#Raw-–-数码相机图像存储文件格式" class="headerlink" title="Raw – 数码相机图像存储文件格式"></a>Raw – 数码相机图像存储文件格式</h4><p>Raw图像格式是数码相机用来存储高质量图像以供后期制作和编辑的文件类型。</p><p>RAW文件在一张图片中包含多达16,384种不同的颜色，而不是JPEG文件仅包含256种颜色。也就是说RAW文件在调整颜色和对比度等后期处理时，有着更大的灵活性。</p><p> <strong>RAW图像不适合用于网络演示或共享</strong> ，并且主流浏览器或图像查看器兼容性极差，一般需要使用专业的相机图像处理软件处理。</p><p><strong>优缺点</strong></p><ul><li>优点：更高质量的图片，色彩变化更大。</li><li>缺点：图像大胖子文件（RAW文件体积随便就20-40MB）。</li></ul><p><strong>使用场景</strong></p><ul><li>以最高质量保存照片以进行后期处理和编辑。</li></ul><h3 id="图像文件类型常见问题解答"><a href="#图像文件类型常见问题解答" class="headerlink" title="图像文件类型常见问题解答"></a>图像文件类型常见问题解答</h3><h4 id="文件的最为常见的3种图像文件类型是什么？"><a href="#文件的最为常见的3种图像文件类型是什么？" class="headerlink" title="文件的最为常见的3种图像文件类型是什么？"></a>文件的最为常见的3种图像文件类型是什么？</h4><p>根据与Web使用相关的数据，三种最常见的图像文件类型分别为PNG，JPEG和SVG。</p><p><img src="https://static.wbolt.com/wp-content/uploads/2020/10/image-file-types-stats.png" alt="图像文件格式的使用情况统计" title="图像文件格式的使用情况统计"></p><p>图像文件格式的使用情况统计（图像来源：<a href="https://www.wbolt.com/go?_=b31aaeb8cdaHR0cHM6Ly93M3RlY2hzLmNvbS90ZWNobm9sb2dpZXMvb3ZlcnZpZXcvaW1hZ2VfZm9ybWF0">w3techs.com</a>）</p><p>为什么这三种图像文件格式最为受欢迎？</p><p><strong>PNG：屏幕截图，Banner横幅，信息图表，图片</strong></p><p>由于PNG作为一种更适合于附带文本的图像格式，因此它更常用于屏幕截图，横幅等。</p><p>并且由于采用了无损压缩，设计师和摄影师能够使用此格式图像在作品集网站上展示高质量的图片。</p><p>上述两个因素，加上其通用的浏览器和操作系统支持，使其成为网络上最受欢迎的图像文件类型。PNG在网站上的使用率高达77％。</p><p><strong>JPEG：图片</strong></p><p>有损压缩意味着JPEG是更好的选择，可用于在整个内容中展示图片。有限的质量损失对于普通的互联网用户几乎可以忽略不计，又可以节省大量的服务器磁盘空间和带宽。</p><p>这就是为什么它是互联网上第二受欢迎的格式，约72％的网站使用了此格式图像。一般情况下，大多数网站会同时使用PNG和JPEG。</p><p><strong>SVG：Logo，图标和插画</strong></p><p>SVG文件是可缩放的矢量文件，非常适合图标，Logo，图形和简单的插画。该图像甚至可以作为CSS代码直接插入到页面中。</p><p>这就是SVG排名第三的原因，有27％的网站使用了SVG。</p><p><strong>特别提名：GIF动画图片</strong></p><p>尽管很少使用此格式作为静态图像的选择，但不可否认GIF已成为共享动画的第一选择。</p><p>事实上，约有22％的网站在其页面上使用了GIF，即使这些网站也可能使用PNG和JPEG作为其标准格式。</p><h4 id="哪种图像格式质量最高？"><a href="#哪种图像格式质量最高？" class="headerlink" title="哪种图像格式质量最高？"></a>哪种图像格式质量最高？</h4><p>Raw图像格式的质量最佳，但文件体积超大，可能一个Raw格式的照片就高达几百MB。</p><p>对于Web图像，相同质量的情况下，WebP文件格式的文件大小比JPEG小25-35％，也就是说相同的存储空间可以上传更多更高质量的图像，有可以保证网站拥有很好的访问速度。</p><p>HEIF是另一种JPEG替代方案，提供更高的压缩效率，但遗憾的是目前主流浏览器均不兼容。</p><p>PNG文件提供无损压缩，但文件体积较大影响加载加载速度。单个PNG文件通常为数百KB甚至1MB +。但如果利用诸如延迟加载（WordPress 5.5+核心支持该功能 ）和CDN之类的一些策略，网站还是可以拥有一个较快的加载体验。</p><h4 id="哪些文件格式支持透明背景？"><a href="#哪些文件格式支持透明背景？" class="headerlink" title="哪些文件格式支持透明背景？"></a>哪些文件格式支持透明背景？</h4><p>目前网络上最常见的支持透明背景的的图像文件类型有PNG，WebP，GIF和SVG。</p><p>大多数计算机项目图像文件类型（如PSD，XCF和AI）也支持透明背景。</p><p>另一方面，流行的JPEG图像格式是不支持透明背景的。</p><h4 id="PNG和JPEG孰优孰劣"><a href="#PNG和JPEG孰优孰劣" class="headerlink" title="PNG和JPEG孰优孰劣?"></a>PNG和JPEG孰优孰劣?</h4><p>PNG和JPEG之间的主要区别是，PNG是一种无损图像格式，而JPEG是一种有损图像格式。换句话说，PNG使用压缩技术而不会牺牲图像的原始质量或细节。</p><p>对于附带文本的图像，教程屏幕截图，以及标志或其他精细元素需100％可见的照片，PNG才是最佳格式。</p><p>对于常规博客文章配图等其他无需关注细节的图片，JPEG可以实现足够好的质量，又能够大大减少文件体积。通常可以节省50％或更多的空间，一般人肉眼难以发现质量上的任何差异。</p>]]></content>
      
      
      <categories>
          
          <category> 图片格式（后缀） </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>try</title>
      <link href="/posts/9869cb72/"/>
      <url>/posts/9869cb72/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>哪个英文字母最酷？</p><span class="hide-inline"><button type="button" class="hide-button" style="background-color: #FF7242;color: #fff">查看答案  </button><span class="hide-content">因为西装裤(C装酷)</span></span><h2 id="门里站着一个人"><a href="#门里站着一个人" class="headerlink" title="门里站着一个人?"></a>门里站着一个人?</h2><span class="hide-inline"><button type="button" class="hide-button" style="">dongdong  </button><span class="hide-content">闪</span></span><div class="mermaid-wrap"><pre class="mermaid-src" hidden>  pie    title Key elements in Product X    &quot;Calcium&quot; : 42.96    &quot;Potassium&quot; : 50.05    &quot;Magnesium&quot; : 10.01    &quot;Iron&quot; :  5  </pre></div><hr><div class="tabs" id="test4"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test4-1">第一个Tab</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test4-1"><p><strong>tab名字为第一个Tab</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><p>This is my website, click the button <a class="btn-beautify block larger" href="http://www.baidu.com"   title="百度"><i class="far fa-hand-point-right"></i><span>百度</span></a></p><a class="btn-beautify blue block center larger" href="http://www.baidu.com"   title="百度"><i class="far fa-hand-point-right"></i><span>百度</span></a><a class="btn-beautify outline blue block right larger" href="http://www.baidu.com"   title="百度"><i class="far fa-hand-point-right"></i><span>百度</span></a><details class="toggle" style="border: 1px solid bg"><summary class="toggle-button" style="background-color: bg;color: color">display</summary><div class="toggle-content"><p>content</p></div></details>---]]></content>
      
      
      <categories>
          
          <category> gallery </category>
          
      </categories>
      
      
        <tags>
            
            <tag> jQuery </tag>
            
            <tag> 表格 </tag>
            
            <tag> 表单验证 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>语法-NodeJS</title>
      <link href="/posts/65e690f9/"/>
      <url>/posts/65e690f9/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><hr><p>Node 使前端 Jser 有了脱离浏览器工作的能力，要搁以前的话咱们写的 js 要么嵌到 html 页面里，然后用浏览器打开 html 页面才能运行js，要么就是在浏览器开发者工具的 Console 面板里编写运行代码片段。总之没了浏览器这个宿主，咱们的 js 就 run 不起来。Node 这货突发奇想，把开发者工具的 Console 给抠下来了，从此 js 可以脱离浏览器直接在 node 里运行。 <strong>相当于 js 现在有了两个宿主环境，一个是浏览器，一个是 node</strong> 。当然了，Node 可不是开发者工具里的 Console，那只是打个比方。它是基于Chrome V8 引擎实现的一个 JavaScript 运行环境，功能其实类似 Console 面板，但提供了大量实用的 API，感兴趣的同学可前往 <a href="https://nodejs.org/en/">Node官网</a> 详细了解，英文吃力的骚年 <a href="http://nodejs.cn/">戳这里</a>。Node 可以算是前端革命式的创新，随 node 一起发布的 node 包管理器 npm(node package manager) 也已经是全球最大的开源库生态系统。node&#x2F;npm 这对组合一出，前端生态迎来了大爆发，一时间为解决各种问题的 node 包层出不穷，遍地开花。</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> 语法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> NodeJS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo博客中关联自定义html页面</title>
      <link href="/posts/ddc6d292/"/>
      <url>/posts/ddc6d292/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Hexo博客技巧：添加自定义html页面"><a href="#Hexo博客技巧：添加自定义html页面" class="headerlink" title="Hexo博客技巧：添加自定义html页面"></a>Hexo博客技巧：添加自定义html页面</h1><h2 id="具体过程"><a href="#具体过程" class="headerlink" title="具体过程"></a>具体过程</h2><p>1.首先在博客根目录的source文件夹下，新建一个文件夹用于存放要部署的HTML文件：</p><p><img src="https://img-blog.csdnimg.cn/img_convert/a666785c4c0c7e435463e454d6369083.png#pic_center" alt="在这里插入图片描述"></p><p>我这里建了一个叫HTML的文件夹，里面的子文件夹可以存放各个HTML文件，当然也可以只创建一个主文件夹，直接在里面放HTML文件。</p><p>2.然后在博客根目录的配置文件_config.yml文件里，设置跳过渲染：</p><p>单个文件，就写：</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 跳过渲染</span></span><br><span class="line"><span class="symbol">skip_render:</span> <span class="string">&quot;xxxx.html&quot;</span></span><br></pre></td></tr></table></figure><ul><li>如果只创建了一个文件夹，要跳过它目录下所有文件的渲染，就写：</li></ul><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 跳过文件夹下所有文件</span></span><br><span class="line"><span class="attribute">skip_render</span> :<span class="string">&quot;文件夹名/*&quot;</span></span><br></pre></td></tr></table></figure><ul><li>如果父文件夹下还有子文件夹，就写：</li></ul><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 跳过子文件夹</span></span><br><span class="line"><span class="symbol">skip_render:</span><span class="string">&quot;文件夹名/子文件夹名/*&quot;</span></span><br></pre></td></tr></table></figure><ul><li>或更简单粗暴的方式：</li></ul><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 跳过文件夹下所有子文件夹和文件</span></span><br><span class="line"><span class="symbol">skip_render:</span> <span class="string">&quot;文件夹名/**&quot;</span></span><br></pre></td></tr></table></figure><ul><li>3.最后处理css、js文件</li></ul><p>因为hexo部署的是静态文件，所有文章的md文件会被渲染成html文件，<br>hexo会帮我们把所有css、js文件都加到文章里，我们之前跳过了渲染，所以就需要手动把css、js整合到html文件里</p><p>一般我们的代码就是这种结构：</p><p><img src="https://img-blog.csdnimg.cn/img_convert/9f947011dca4437d5789c4a1f48f6c42.png#pic_center" alt="在这里插入图片描述"></p><p>下面处理分两部分：</p><p>css：找到index.html文件里的语句,如：<br> <code>&lt;link rel=&quot;stylesheet&quot; href=&quot;css/xxx.css&quot;&gt;</code></p><p>然后在css文件夹中找到对应的文件xxx.css，复制文件内容，把上面的代码改为：</p><p><code>&lt;style&gt; css代码内容 &lt;/style&gt;</code></p><ul><li>js：找到 <code>index.html</code>文件里的语句，如：<br><code>&lt;script src=&quot;js/xxx.js&quot;&gt;&lt;/script&gt;</code></li></ul><p> 然后在js文件夹中找到对应的文件 <code>xxx.js</code>，复制文件内容，把上面的代码改为：</p><p><code>&lt;script&gt; js代码内容 &lt;/script&gt;</code></p><p>4.检验成果</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hexo clean</span></span><br><span class="line"><span class="attribute">hexo g</span></span><br><span class="line"><span class="attribute">hexo d</span></span><br></pre></td></tr></table></figure><p>部署后来到<a href="https://xxxxx.github.io/%E5%AD%98%E6%94%BEhtml%E6%96%87%E4%BB%B6%E7%9A%84%E6%96%87%E4%BB%B6%E5%A4%B9/xxx.html">https://xxxxx.github.io/存放html文件的文件夹/xxx.html</a></p><p>即可查看到你的自定义html页面了！</p>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Hexo初始化及使用方式</title>
      <link href="/posts/ecce7b25/"/>
      <url>/posts/ecce7b25/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://static.iots.vip/hexo%E4%BB%8E%E6%90%AD%E5%BB%BA%E5%88%B0%E4%BC%98%E5%8C%96%E8%AF%A6%E8%A7%A3%E5%86%85%E5%AE%B9%E5%9B%BE.png" alt="hexo从搭建到优化详解内容图"></p><h3 id="创建-md文件"><a href="#创建-md文件" class="headerlink" title="创建.md文件"></a>创建.md文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo new &lt;title&gt;</span><br><span class="line">hexo new <span class="string">&quot;新文章&quot;</span></span><br></pre></td></tr></table></figure><h3 id="发布文章"><a href="#发布文章" class="headerlink" title="发布文章"></a><strong>发布文章</strong></h3><p>进入博客所在目录，右键打开 Git Bash Here，创建博文：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new &quot;My New Post&quot;</span><br></pre></td></tr></table></figure><p>然后 source 文件夹中会出现一个 My New Post.md 文件，就可以使用 Markdown 编辑器在该文件中撰写文章了。</p><p>写完后运行下面代码将文章渲染并部署到 GitHub Pages 上完成发布。<strong>以后每次发布文章都是这两条命令。</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo g   # 生成页面</span><br><span class="line">hexo d   # 部署发布</span><br></pre></td></tr></table></figure><hr><p>也可以不使用命令自己创建 .md 文件，只需在文件开头手动加入如下格式 Front-matter 即可，写完后运行 <code>hexo g</code> 和 <code>hexo d</code> 发布。</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: Hello World # 标题</span><br><span class="line">date: 2019/3/26 hh:mm:ss # 时间</span><br><span class="line">categories: # 分类</span><br><span class="line">- Diary</span><br><span class="line">tags: # 标签</span><br><span class="line">- PS3</span><br><span class="line">- Games</span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">摘要</span><br><span class="line">&lt;!--more--&gt;</span><br><span class="line">正文</span><br></pre></td></tr></table></figure><h3 id="网站设置"><a href="#网站设置" class="headerlink" title="网站设置"></a><strong>网站设置</strong></h3><p>包括网站名称、描述、作者、链接样式等，全部在网站目录下的 _config.yml 文件中，参考<a href="https://link.zhihu.com/?target=https://hexo.io/zh-cn/docs/configuration">官方文档</a>按需要编辑。</p><p>注意：冒号后要加一个空格！</p><h3 id="更换主题"><a href="#更换主题" class="headerlink" title="更换主题"></a><strong>更换主题</strong></h3><p>在Hexo根目录中：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i hexo<span class="literal">-theme-butterfly</span></span><br></pre></td></tr></table></figure><blockquote><p>升級方法：在 Hexo 根目錄下，運行 <code>npm update hexo-theme-butterfly</code></p></blockquote><p>然后修改 _config.yml 中的 theme 为新主题名称 next，发布。</p><p>###應用主題<br>修改 Hexo 根目錄下的 _config.yml，把主題改為butterfly</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">theme:</span> <span class="string">butterfly</span></span><br></pre></td></tr></table></figure><h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a><strong>常用命令</strong></h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">hexo new &quot;name&quot;       # 新建文章</span><br><span class="line">hexo new page &quot;name&quot;  # 新建页面</span><br><span class="line">hexo g                # 生成页面</span><br><span class="line">hexo d                # 部署</span><br><span class="line">hexo g -d             # 生成页面并部署</span><br><span class="line">hexo s                # 本地预览</span><br><span class="line">hexo clean            # 清除缓存和已生成的静态文件</span><br><span class="line">hexo help             # 帮助</span><br></pre></td></tr></table></figure><h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><p><strong>1、Hexo 设置显示文章摘要，首页不显示全文</strong></p><p>Hexo 主页文章列表默认会显示文章全文，浏览时很不方便，可以在文章中插入 <code>&lt;!--more--&gt;</code> 进行分段。</p><p>该代码前面的内容会作为摘要显示，而后面的内容会替换为 “Read More” 隐藏起来。</p><p><img src="https://pic4.zhimg.com/80/v2-45701cf120ca77e6733ad30b40666f33_720w.jpg"></p><p><strong>2、设置网站图标</strong></p><p>进入 themes&#x2F;主题 文件夹，打开 _config.yml 配置文件，找到 favicon 修改，一般格式为：<code>favicon: 图标地址</code>。（不同主题可能略有差别）</p><p><strong>3、修改并部署后没有效果</strong></p><p>使用 <code>hexo clean</code> 清理后重新部署。</p><p><strong>4、开启 HTTPS 后访问网站显示连接不安全？</strong></p><p>证书还未部署生效，等待一会儿，清除浏览器缓存再试。</p><p><strong>5、Mac 安装 Hexo 报错无法安装</strong></p><p>Mac 用户需要管理员权限运行，使用 <code>sudo npm install -g hexo-cli</code> 命令安装。</p><p><strong>6、npm 下载速度慢，甚至完全没反应</strong></p><p>使用 npm 安装程序等待很久也没反应，或者下载速度很慢，可以更换 npm 源为国内 npm 镜像。</p><p>临时更换方法：在 npm 安装命令后面加上：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--registry https://registry.npm.taobao.org </span><br></pre></td></tr></table></figure><h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><h3 id="布局（layout）"><a href="#布局（layout）" class="headerlink" title="布局（layout）"></a>布局（layout）</h3><p>可以指定布局</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo <span class="keyword">new</span> <span class="type"></span>[layout] &lt;title&gt;</span><br><span class="line">hexo <span class="keyword">new</span> <span class="type">page</span> <span class="string">&quot;我的页面&quot;</span></span><br></pre></td></tr></table></figure><ul><li>布局有三种：<code>post</code>（文章）、<code>draft</code>（草稿）、<code>page</code>（页面）</li></ul><p>在新建文件时，Hexo 会根据 <code>scaffolds</code> 文件夹内相对应的文件（可以理解为模板）来建立md文件</p><h3 id="启动服务器"><a href="#启动服务器" class="headerlink" title="启动服务器"></a>启动服务器</h3><p>要能够在本地预览自己的博客，需要本地启动服务器。这里应先安装 hexo server 模块（hexo 3.0后版本，server 变成了独立的模块) 在命令提示符窗口执行:</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-<span class="keyword">server</span> <span class="comment">--save</span></span><br></pre></td></tr></table></figure><p>安装完毕后执行:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo server 或 hexo s 常用参数：-p（--port）重设端口</span><br></pre></td></tr></table></figure><p>浏览器输入<a href="">: </a><a href="http://localhost:4000/">http://localhost:4000</a> (IE浏览器必须需要http前缀才可打开) 即可实时预览（注意是实时，修改文章与修改配置，保存后刷新网页都能看到效果）。Ctrl+C 关闭服务器。</p><h3 id="清除缓存"><a href="#清除缓存" class="headerlink" title="清除缓存"></a><strong>清除缓存</strong></h3><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hexo clean</span></span><br></pre></td></tr></table></figure><p>缓存与 <code>public</code> 目录，推荐每次执行 <code>hexo s</code> 之前都执行一次 <code>hexo clean</code>，避免出现一些奇怪的问题(主页未同步等)。</p><h3 id="生成静态文件"><a href="#生成静态文件" class="headerlink" title="生成静态文件"></a>生成静态文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo generate可简写为 hexo g</span><br></pre></td></tr></table></figure><p>这里生成静态文件在根目录的 <code>public</code> 下，将此目录内的文件上传到服务器网站根目录即可。</p><h3 id="部署到服务器"><a href="#部署到服务器" class="headerlink" title="部署到服务器"></a>部署到服务器</h3><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo <span class="keyword">deploy</span>可简写为hexo d，用于将网站部署到服务器上。</span><br></pre></td></tr></table></figure><p>hexo提供了一键部署功能，通过简单的配置能够一键部署到网站服务器上。<br>开始之前需要修改根目录下的 配置文件，这里只举例 git:<br>使用git部署需要先安装 <code>hexo-deployer-git</code> 插件，执行:</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git <span class="comment">--save</span></span><br></pre></td></tr></table></figure><p>然后修改配置文件_config.xml中的</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">deploy:</span></span><br><span class="line"><span class="language-xml">    type: git//部署类型  </span></span><br><span class="line"><span class="language-xml">    repo: (Repository地址)</span></span><br><span class="line"><span class="language-xml">    branch: (分支名称)</span></span><br><span class="line"><span class="language-xml">    message: (自定义提交信息,默认为Site updated: </span><span class="template-variable">&#123;&#123; <span class="name">now</span>(<span class="name">&#x27;YYYY-MM-DD HH:mm:ss&#x27;</span>) &#125;&#125;</span><span class="language-xml">)</span></span><br></pre></td></tr></table></figure><h4 id="Hexo项目结构："><a href="#Hexo项目结构：" class="headerlink" title="Hexo项目结构："></a><strong>Hexo项目结构：</strong></h4><ul><li>.deploy_git：部署到Gitee的文件夹，存放生成的静态页面</li><li>node_modules: 依赖包</li><li>public：部署到本地的文件夹，存放生成的静态页面</li><li>scaffolds：生成文章的md模板</li><li>source：存放文章md文件、图片、样式文件等一些资源</li><li>themes：主题，Hexo 会根据主题来生成静态页面</li><li>_config.landscape.yml：主题配置文件，用来修改主题，landscape是Hexo主题其中之一</li><li>_config.yml：网站配置文件</li></ul>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Github制作个人网站</title>
      <link href="/posts/801c406d/"/>
      <url>/posts/801c406d/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>局限：只能是静态网站的个人网站</strong></p><h2 id="1、申请Github账号"><a href="#1、申请Github账号" class="headerlink" title="1、申请Github账号"></a><strong>1、申请Github账号</strong></h2><p>首先，注册自己的GitHub账号，注册网址：<a href="https://github.com/join">https://github.com/join</a></p><p>（如果有账号请直接登录然后跳转到教程下一步）</p><p><img src="https://pic2.zhimg.com/80/v2-8ea3f6182c6b5a788defb6866d02bda5_720w.jpg" alt="img"></p><p>点击Sign up按钮。</p><p>注册需要填写<strong>用户名，密码，邮箱</strong>。</p><p><img src="https://pic4.zhimg.com/80/v2-179e34784dc8c5ff533b292e1e769e37_720w.jpg" alt="img"></p><p>然后Github会向注册的邮箱发送一个确认链接， <strong>请点击链接确认</strong> ，激活注册的Github账号</p><p><img src="https://pic1.zhimg.com/80/v2-11d62fe1b74bda59a8f3207aed552414_720w.jpg" alt="img"></p><p>到这里注册就完成了。</p><h2 id="2、创建一个仓库"><a href="#2、创建一个仓库" class="headerlink" title="2、创建一个仓库"></a><strong>2、创建一个仓库</strong></h2><p>接下来，创建仓库，仓库就是保存代码的地方，也就是保存网站的地方。</p><p>1、点击“Your repositories”，查看个人全部仓库。</p><p><img src="https://pic3.zhimg.com/80/v2-f132244af4570e99ff40dc14727458fa_720w.jpg"></p><p>2、接着，点击“New”按钮，新建一个仓库</p><p><img src="https://pic1.zhimg.com/80/v2-328dfe93e5934c79ad8adcc6592a3644_720w.jpg"></p><p>3、命名仓库，仓库名称必须为：username.github.io，username是刚才注册填写的github用户名。</p><p>比如，这里注册的名字是 zhihu1，所以创建的仓库名称必须是：<a href="http://zhihu1.github.io/">http://zhihu1.github.io</a></p><p><img src="https://pic3.zhimg.com/80/v2-6a26d3e1d750f6653073df94cb4e028e_720w.jpg"></p><h3 id="直接创建新项目并填写内容"><a href="#直接创建新项目并填写内容" class="headerlink" title="直接创建新项目并填写内容"></a>直接创建新项目并填写内容</h3><p>这里，做一个最简单的网站：个人简历。</p><p>创建一个新文件</p><p><img src="https://pic2.zhimg.com/80/v2-f4df4721d35a10396ee1ad81423e5839_720w.jpg"></p><p>5，新文件的名称必须是 <strong>index.html</strong>（题外话：静态http文件托管服务的默认访问文件就是index.html）</p><p><img src="https://pic3.zhimg.com/80/v2-b4e6b1cf4e69526e1ef8abaa83874962_720w.jpg"></p><h3 id="搭建-Hexo-静态博客网站"><a href="#搭建-Hexo-静态博客网站" class="headerlink" title="搭建 Hexo 静态博客网站"></a>搭建 Hexo 静态博客网站</h3><p>在仓库中，点击“Settings”，找到下面的“GitHub Pages”，点进去选一个主题，这里选择 butterfly</p><p><a href="https://images2018.cnblogs.com/blog/1300767/201804/1300767-20180421001534664-1423313323.png"><img src="https://images2018.cnblogs.com/blog/1300767/201804/1300767-20180421001534664-1423313323.png"></a></p><p>选择主题后，可以看到一个博客地址。</p><p>地址格式：<a href="https://username.github.io/%E4%BB%93%E5%BA%93%E5%90%8D/">https://username.github.io/仓库名/</a><br>当放入自己文件上传后，访问该地址就能看到页面了。默认是访问index.html的，如果你文件叫abc.html，就需要访问：https:&#x2F;&#x2F;用户名.github.io&#x2F;仓库名&#x2F;abc.html</p><h2 id="3、查看个人网站的网址"><a href="#3、查看个人网站的网址" class="headerlink" title="3、查看个人网站的网址"></a><strong>3、查看个人网站的网址</strong></h2><p>接下来，需要知道网站链接，这样，别人才能访问我们的个人网站。</p><p>1，点击settings</p><p><img src="https://pic1.zhimg.com/80/v2-7e08bda1f87415454ba0e1944b4d48cc_720w.jpg"></p><p>2，然后往下翻找到 Github Pages， 看到绿色提示，后面的链接就是你的网站地址了，打开看看吧~</p><p> <strong>Tip：很多老铁评论说这里看不到绿色框框，没有URL。</strong> 那是因为你的仓库名称与用户名不一致，不过不用担心，也是有办法的，看下面的第二张图片。</p><p><img src="https://pic3.zhimg.com/80/v2-e337c927f03d6b82754909948032e1de_720w.jpg"><br>第一张图片</p><p><img src="https://pic1.zhimg.com/80/v2-5853ec09142aa91a84e941324a9d75b8_720w.jpg"><br>第二张图片(这里我设置成小图防止误导正常老铁, 点击可以放大图)</p><p>3，点开网站看一下</p><p>完成！</p><h2 id="hexo网站"><a href="#hexo网站" class="headerlink" title="hexo网站"></a>hexo网站</h2><p><strong>Git上传项目到仓库</strong></p><p>打开Git Bash操作界面</p><p><img src="https://img-blog.csdn.net/20180704090714111?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzM3NzI1MDAz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70"></p><p>第一步：cd进入你放项目文件的地址，我的地址在D:\MYFILE\graduation\study\项目程序</p><p><img src="https://img-blog.csdn.net/2018070409084062?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzM3NzI1MDAz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70"></p><p>第二步：输入git init</p><p>如下图所示，这个意思是在当前项目的目录中生成本地的git管理（会发现在当前目录下多了一个.git文件夹）</p><p><img src="https://img-blog.csdn.net/20180704090924641?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzM3NzI1MDAz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70"></p><p>第三步：输入git add .</p><p>这个是将项目上所有的文件添加到仓库中的意思，如果想添加某个特定的文件，只需把.换成这个特定的文件名即可。</p><p><img src="https://img-blog.csdn.net/20180704090958938?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzM3NzI1MDAz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70"></p><p>第四步：输入git commit -m “first commit”，表示你对这次提交的注释，双引号里面的内容可以根据个人的需要改。</p><p><img src="https://img-blog.csdn.net/20180704091251550?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzM3NzI1MDAz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70"></p><p>第五步：这里如果出现以下内容，则需要你输入自己的账号或名字</p><p><img src="https://img-blog.csdn.net/20180704091357264?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzM3NzI1MDAz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70"></p><p>第六步：用上面提示的代码输入自己的邮箱或名字</p><p><img src="https://img-blog.csdn.net/20180704091525296?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzM3NzI1MDAz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70"></p><p>第七步：再输入git commit -m “first commit”时就会成功</p><p><img src="https://img-blog.csdn.net/20180704091703608?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzM3NzI1MDAz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70"></p><p>第八步、输入git remote add origin https:&#x2F;&#x2F;自己的仓库url地址（上面有说到） 将本地的仓库关联到github上，<br>这里宝宝输入的是git remote add origin <a href="https://github.com/Vivianyuwei/Fabric-defect-classification-based-on-WLD.git">https://github.com/Vivianyuwei/Fabric-defect-classification-based-on-WLD.git</a><br><img src="https://img-blog.csdn.net/20180704091736861?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzM3NzI1MDAz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="img"></p><p>第九步、输入git push -u origin master，这是把代码上传到github仓库的意思。</p><p><img src="https://img-blog.csdn.net/20180704091936330?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzM3NzI1MDAz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70"></p><p>执行完后，如果没有异常，会等待几秒，然后跳出一个让你输入Username和Password 的窗口，你只要输人github的登录账号和密码就行了。</p><p><strong>第十步、通过Github Pages访问自己的网页</strong></p><p>在自己仓库那里找到Settings,配置Github Pages,如下图，就是你的网址了</p><p><img src="https://img-blog.csdn.net/20170227204933076"></p>]]></content>
      
      
      <categories>
          
          <category> Git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 制作个人网站（基于GitHub） </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VScode开发 配置C++环境</title>
      <link href="/posts/c36592a6/"/>
      <url>/posts/c36592a6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="1-安装MinGW编译器"><a href="#1-安装MinGW编译器" class="headerlink" title="1.安装MinGW编译器"></a>1.安装MinGW编译器</h1><p>C&#x2F;C++的编译器有很多种，大家可自行选择，笔者这里选择开源的MinGW编译器。大家可以从<a href="https://link.zhihu.com/?target=https://sourceforge.net/projects/mingw-w64/files/mingw-w64/mingw-w64-release/">sourceforge的mingw项目</a>上下载64位的编译器，直接打开进行安装，下图的笔者所选的选项。其中版本选最新版本，对语言的新特性有较好的支持；构架是32位和64位的选择，32位请选择x86；线程部分选择win32，如果是Linux请选择posix；异常模型部分选择默认的seh就好；最后一项只能选0。选好之后点击下一步。</p><p><img src="https://pic1.zhimg.com/80/v2-3aae1eb09e5b78b306706ee3ed8693ac_720w.jpg"></p><p>这里<strong>要求</strong>修改路径名称，确保路径中不包含<strong>空格</strong>和<strong>中文</strong>字符，尤其是空格，因为默认位置上有空格的，一定要修改相应安装的路径。因为官方文档中要求安装路径中不能含有空格，实际上也是如此，笔者之前有过编译器的路径存在空格字符，然后配置VScode会无法识别出路径而导致失败（就是因为路径中包含空格字符）。</p><p><img src="https://pic3.zhimg.com/80/v2-ccdc30f87b6ebcd77858122300c7c04a_720w.jpg"></p><p>这是笔者设置的安装路径。</p><p><img src="https://pic3.zhimg.com/80/v2-8b6b4bde7374140965ec691c95825516_720w.jpg"></p><p>设置好安装路径之后，点击下一步就开始安装了。因为这是在线安装的，根据网速的大小时间会有所不同。</p><p>安装好之后，就是熟悉的<strong>配置环境变量</strong>步骤，如下图：</p><h2 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h2><p>直接上图</p><p><img src="https://pic4.zhimg.com/80/v2-8964559c25f9a32fb2722cf487cd013b_720w.jpg"></p><p><img src="https://pic2.zhimg.com/80/v2-745319ef707afaa39197a5d5f155c6b1_720w.jpg"></p><p>然后打开cmd输入gcc -v，如果出现版本号，gcc version：8.1.0&lt;类似于这样的则为安装成功</p><p><img src="https://pic4.zhimg.com/80/v2-54e2f5cad1e2561ae1704450c11b9afb_720w.jpg"></p><p>最后，打开cmd，输入<em>gcc -v</em>验证是否成功即可。</p><h2 id="2-安装C-x2F-C-扩展"><a href="#2-安装C-x2F-C-扩展" class="headerlink" title="2.安装C&#x2F;C++扩展"></a>2.安装C&#x2F;C++扩展</h2><p>用VScode打开之前建立好的文件夹，可直接通过欢迎界面的<em>Open folder</em>打开，也可通过菜单栏的 <em>File</em> –&gt;<em>Open Folder</em>打开。笔者这里的文件夹目录是E:\Cpp。 在该文件夹下新建一个hello.cpp文件，马上右下角会出现安装C&#x2F;C++的提示，可直接点击install按钮进行安装。</p><p><img src="https://pic4.zhimg.com/80/v2-25abea771f3b4c197c5b66af4b1a44bb_720w.jpg"></p><p>当然也可自行搜索C&#x2F;C++扩展进行安装。</p><p><img src="https://pic1.zhimg.com/80/v2-dbbea9091e7ad31148e02d5a8940b134_720w.jpg"></p><p>下图是正在安装C&#x2F;C++扩展的过程，需要一段时间，请静心等待。等右下角的提示消失了，说明安装成功，此时最好重启VScode让扩展生效。</p><p><img src="https://pic2.zhimg.com/80/v2-b0e60d48a4d0111d6184870e03ac2db5_720w.jpg"></p><p>重启之后编写好hello.cpp文件后，如下图：</p><p><img src="https://pic1.zhimg.com/80/v2-cd6a0fed3e9250306f7c71e6eee7685c_720w.jpg"></p><h2 id="3-配置C-x2F-C-环境"><a href="#3-配置C-x2F-C-环境" class="headerlink" title="3.配置C&#x2F;C++环境"></a>3.配置C&#x2F;C++环境</h2><h3 id="1-配置编译器"><a href="#1-配置编译器" class="headerlink" title="(1).配置编译器"></a>(1).配置编译器</h3><p>接下来配置编译器路径，按快捷键Ctrl+Shift+P调出命令面板，输入C&#x2F;C++，选择“Edit Configurations(UI)”进入配置。这里配置两个选项： - 编译器路径：D:&#x2F;mingw-w64&#x2F;x86_64-8.1.0-win32-seh-rt_v6-rev0&#x2F;mingw64&#x2F;bin&#x2F;g++.exe</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这里的路径根据大家自己安装的Mingw编译器位置和配置的环境变量位置所决定。</span><br></pre></td></tr></table></figure><ul><li>IntelliSense 模式：gcc-x64</li></ul><p><img src="https://pic4.zhimg.com/80/v2-cc609819e54faaa011535b8a1d78729f_720w.jpg"></p><p><img src="https://pic2.zhimg.com/80/v2-dd25492f14ef601faff48615533f8f39_720w.jpg"></p><p><img src="https://pic2.zhimg.com/80/v2-6285c8669d61d80a9b72b255e7d5c915_720w.jpg"></p><p>配置完成后，此时在侧边栏可以发现多了一个.vscode文件夹，并且里面有一个c_cpp_properties.json文件，内容如下，说明上述配置成功。现在可以通过Ctrl+&lt;&#96;快捷键打开内置终端并进行编译运行了。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;configurations&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Win32&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;includePath&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;$&#123;workspaceFolder&#125;/**&quot;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;defines&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;_DEBUG&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;UNICODE&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;_UNICODE&quot;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="comment">//此处是编译器路径，以后可直接在此修改</span></span><br><span class="line">            <span class="attr">&quot;compilerPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;D:/mingw-w64/x86_64-8.1.0-win32-seh-rt_v6-rev0/mingw64/bin/g++.exe&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;cStandard&quot;</span><span class="punctuation">:</span> <span class="string">&quot;c11&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;cppStandard&quot;</span><span class="punctuation">:</span> <span class="string">&quot;c++17&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;intelliSenseMode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gcc-x64&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="number">4</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><img src="https://pic3.zhimg.com/80/v2-3e36e62f0afac74b0961d7dd74cb800e_720w.jpg"></p><p><img src="https://pic3.zhimg.com/80/v2-305226dc6bf7198f2cad2686b511cc02_720w.jpg"></p><h3 id="2-配置构建任务"><a href="#2-配置构建任务" class="headerlink" title="(2).配置构建任务"></a>(2).配置构建任务</h3><p>接下来，创建一个tasks.json文件来告诉VScode如何构建（编译）程序。该任务将调用g++编译器基于源代码创建可执行文件。 按快捷键Ctrl+Shift+P调出命令面板，输入tasks，选择“Tasks:Configure Default Build Task”：</p><p><img src="https://pic1.zhimg.com/80/v2-0f6d57783c5bfb9fe5c6c525ec2771e8_720w.jpg"></p><p>再选择“C&#x2F;C++: g++.exe build active file”：</p><p><img src="https://pic1.zhimg.com/80/v2-91eedecc78231abd8d85e19998b2c3a4_720w.jpg"></p><p>此时会出现一个名为tasks.json的配置文件，内容如下：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="comment">// See https://go.microsoft.com/fwlink/?LinkId=733558 </span></span><br><span class="line">    <span class="comment">// for the documentation about the tasks.json format</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;tasks&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;shell&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;label&quot;</span><span class="punctuation">:</span> <span class="string">&quot;g++.exe build active file&quot;</span><span class="punctuation">,</span><span class="comment">//任务的名字，就是刚才在命令面板中选择的时候所看到的，可以自己设置</span></span><br><span class="line">            <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;D:/mingw-w64/x86_64-8.1.0-win32-seh-rt_v6-rev0/mingw64/bin/g++.exe&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="comment">//编译时候的参数</span></span><br><span class="line">                <span class="string">&quot;-g&quot;</span><span class="punctuation">,</span><span class="comment">//添加gdb调试选项</span></span><br><span class="line">                <span class="string">&quot;$&#123;file&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;-o&quot;</span><span class="punctuation">,</span><span class="comment">//指定生成可执行文件的名称</span></span><br><span class="line">                <span class="string">&quot;$&#123;fileDirname&#125;\\$&#123;fileBasenameNoExtension&#125;.exe&quot;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;options&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;cwd&quot;</span><span class="punctuation">:</span> <span class="string">&quot;D:/mingw-w64/x86_64-8.1.0-win32-seh-rt_v6-rev0/mingw64/bin&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;problemMatcher&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;$gcc&quot;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;group&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;kind&quot;</span><span class="punctuation">:</span> <span class="string">&quot;build&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;isDefault&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="comment">//表示快捷键Ctrl+Shift+B可以运行该任务</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><img src="https://pic3.zhimg.com/80/v2-8a3cb801cbccd4b25edfed14690e3982_720w.jpg"></p><h3 id="3-配置调试设置"><a href="#3-配置调试设置" class="headerlink" title="(3).配置调试设置"></a>(3).配置调试设置</h3><p>这里主要是为了在.vscode文件夹中产生一个launch.json文件，用来配置调试的相关信息。点击菜单栏的 <em>Debug</em> –&gt; <em>Start Debugging</em> ：</p><p><img src="https://pic3.zhimg.com/80/v2-d3101a91ccf15d8313d670b204cecf1a_720w.jpg"></p><p>选择C++(GDB&#x2F;LLDB)：</p><p><img src="https://pic3.zhimg.com/80/v2-a17abdb3713ab16406b4a62fb286bdce_720w.jpg"></p><p>紧接着会产生一个launch.json的文件：</p><p><img src="https://pic3.zhimg.com/80/v2-80ceb20669ebf4f88b733a820228752e_720w.jpg"></p><p>这里笔者遇到一个问题，如果是在编写好的C++代码文件页面进行上述过程，会一直报”Unable to create ‘launch.json’ file inside the ‘.vscode’ folder (Cannot read property ‘name’ of undefined).”的错误，网上也没有找到相关的解决办法，就自己琢磨了半天，最后发现如果在之前已经创建好的json文件页面进行创建launch.json文件的过程，是可以正常进行的。笔者也没有弄懂这到底是什么原因。 <em>【注】如果大家在进行 tasks.json 和 launch.json 的配置时遇到问题，比如上述笔者所遇到的无法构建的问题，还请不要气馁，可以对所遇到的错误进行搜索查找，看看是否有解决方案，如果实在没有的话，大家可以直接在.vscode文件夹下手动创建这两个文件，并将相应内容复制进去，也可完成环境配置。</em></p><p>接下来读者可以点击Add Configuration按钮自己添加配置，也可以直接将笔者配置好的json文件内容复制过去，因为些配置对新手不是特别友好，相关具体细节还是需要参考官方文档。下面是笔者的launch.json文件的内容：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="comment">// Use IntelliSense to learn about possible attributes.</span></span><br><span class="line">    <span class="comment">// Hover to view descriptions of existing attributes.</span></span><br><span class="line">    <span class="comment">// For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.2.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;configurations&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line"></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;(gdb) Launch&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;preLaunchTask&quot;</span><span class="punctuation">:</span> <span class="string">&quot;g++.exe build active file&quot;</span><span class="punctuation">,</span><span class="comment">//调试前执行的任务，就是之前配置的tasks.json中的label字段</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cppdbg&quot;</span><span class="punctuation">,</span><span class="comment">//配置类型，只能为cppdbg</span></span><br><span class="line">            <span class="attr">&quot;request&quot;</span><span class="punctuation">:</span> <span class="string">&quot;launch&quot;</span><span class="punctuation">,</span><span class="comment">//请求配置类型，可以为launch（启动）或attach（附加）</span></span><br><span class="line">            <span class="attr">&quot;program&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$&#123;fileDirname&#125;\\$&#123;fileBasenameNoExtension&#125;.exe&quot;</span><span class="punctuation">,</span><span class="comment">//调试程序的路径名称</span></span><br><span class="line">            <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="comment">//调试传递参数</span></span><br><span class="line">            <span class="attr">&quot;stopAtEntry&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;cwd&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$&#123;workspaceFolder&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;environment&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;externalConsole&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span><span class="comment">//true显示外置的控制台窗口，false显示内置终端</span></span><br><span class="line">            <span class="attr">&quot;MIMode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gdb&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;miDebuggerPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;D:\\mingw-w64\\x86_64-8.1.0-win32-seh-rt_v6-rev0\\mingw64\\bin\\gdb.exe&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;setupCommands&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Enable pretty-printing for gdb&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;-enable-pretty-printing&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;ignoreFailures&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>现编写一个debug.cpp文件测试调试，设置断点后，按下F5进入调试，如图成功调试， 左侧为变量内容：</p><p><img src="https://pic4.zhimg.com/80/v2-cc066b77f8e4a60d4e3c7ed50fd10a0b_720w.jpg"></p><h2 id="六、结语"><a href="#六、结语" class="headerlink" title="六、结语"></a>六、结语</h2>]]></content>
      
      
      <categories>
          
          <category> 后端开发 </category>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> VSCode扩展插件 </tag>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
